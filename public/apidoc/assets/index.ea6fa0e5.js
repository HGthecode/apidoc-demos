var __defProp2=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp2=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,i)=>t in e?__defProp2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__spreadValues=(e,t)=>{for(var i in t||(t={}))__hasOwnProp2.call(t,i)&&__defNormalProp(e,i,t[i]);if(__getOwnPropSymbols)for(var i of __getOwnPropSymbols(t))__propIsEnum.call(t,i)&&__defNormalProp(e,i,t[i]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__publicField=(e,t,i)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,i),i),__async=(e,t,i)=>new Promise(((n,o)=>{var r=e=>{try{a(i.next(e))}catch(t){o(t)}},s=e=>{try{a(i.throw(e))}catch(t){o(t)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,s);a((i=i.apply(e,t)).next())}));import{d as defineComponent,u as useConfigInject,h as getPropsSlot,c as createVNode,X as _objectSpread2,P as PropTypes,a5 as DownOutlined,a6 as Dropdown,a as flattenChildren,a7 as Menu$2,a8 as warning,N as _typeof$1,a9 as cloneVNode,_ as _defineProperty$9,aa as _toConsumableArray$2,ab as AntdIcon,ac as inject,J as ref,Z as cloneElement,a0 as classNames,C as Col,ad as isStringElement,e as isEmptyElement,ae as initDefaultProps,af as provide,ag as toRef,j as computed,Q as watch,V as _extends,L as useBreakpoint,M as eagerComputed,O as responsiveArray,ah as Pagination,R as Row,ai as Spin,U as onMounted,aj as KeyCode$2,w as withInstall,ak as useDestroyed,al as isEmptyContent,W as ResizeObserver$1,am as filterEmpty,an as LocaleReceiver,ao as h,l as useI18n,ap as useSlots,s as openBlock,t as createElementBlock,H as createBlock,A as withCtx,r as renderSlot,z as createCommentVNode,x as unref,aq as normalizeProps,ar as mergeProps,F as Fragment,as as CheckOutlined,v as createBaseVNode,at as textToHtml,y as toDisplayString,B as createTextVNode,E as __unplugin_components_1,au as cloneDeep,o as reactive,av as __unplugin_components_3$1,T as Tabs,aw as commonjsGlobal,ax as createIdcard,ay as trim,az as __vitePreload,m as useAppStore,aA as shallowRef,aB as MonacoEditorThemeEnum,aC as onBeforeUnmount,k as _export_sfc,aD as normalizeClass,aE as copyTextToClipboard,aF as Button$1,aG as Modal,q as watchEffect,aH as EditTable,aI as createRandKey,aJ as useApidocOutsideStore,aK as getObjectValueByKey,aL as isArray$1,aM as isObject$1,aN as request,n as useApidocStore,aO as __unplugin_components_2$1,D as renderList,aP as firstToUpperCase,aQ as Badge,aR as __unplugin_components_0$2,p as __unplugin_components_0$3,aS as useRoute,G as normalizeStyle,aT as withDirectives,aU as vModelText,aV as message,aW as globalApi,aX as handleApidocHttpError,aY as __unplugin_components_2$2,aZ as Error$1,a_ as SelectOption}from"./index.122d1dde.js";import{A as Avatar,_ as __unplugin_components_0$1}from"./index.7098c4ad.js";import{m as mdModal,M as Markdown,S as Skeleton}from"./Skeleton.1e8f9381.js";var __rest$3=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},breadcrumbItemProps=function(){return{prefixCls:String,href:String,separator:PropTypes.any,overlay:PropTypes.any,onClick:Function}},BreadcrumbItem=defineComponent({name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:breadcrumbItemProps(),slots:["separator","overlay"],setup:function(e,t){var i=t.slots,n=t.attrs,o=useConfigInject("breadcrumb",e).prefixCls;return function(){var t,r,s,a,l,d=null!==(t=getPropsSlot(i,e,"separator"))&&void 0!==t?t:"/",c=getPropsSlot(i,e),h=n.class,u=n.style,g=__rest$3(n,["class","style"]);return r=void 0!==e.href?createVNode("a",_objectSpread2({class:"".concat(o.value,"-link"),onClick:e.onClick},g),[c]):createVNode("span",_objectSpread2({class:"".concat(o.value,"-link"),onClick:e.onClick},g),[c]),s=r,a=o.value,r=(l=getPropsSlot(i,e,"overlay"))?createVNode(Dropdown,{overlay:l,placement:"bottom"},{default:function(){return[createVNode("span",{class:"".concat(a,"-overlay-link")},[s,createVNode(DownOutlined,null,null)])]}}):s,c?createVNode("span",{class:h,style:u},[r,d&&createVNode("span",{class:"".concat(o.value,"-separator")},[d])]):null}}}),breadcrumbProps=function(){return{prefixCls:String,routes:{type:Array},params:PropTypes.any,separator:PropTypes.any,itemRender:{type:Function}}};function getBreadcrumbName(e,t){if(!e.breadcrumbName)return null;var i=Object.keys(t).join("|");return e.breadcrumbName.replace(new RegExp(":(".concat(i,")"),"g"),(function(e,i){return t[i]||e}))}function defaultItemRender(e){var t=e.route,i=e.params,n=e.routes,o=e.paths,r=n.indexOf(t)===n.length-1,s=getBreadcrumbName(t,i);return r?createVNode("span",null,[s]):createVNode("a",{href:"#/".concat(o.join("/"))},[s])}var Breadcrumb=defineComponent({name:"ABreadcrumb",props:breadcrumbProps(),slots:["separator","itemRender"],setup:function(e,t){var i=t.slots,n=useConfigInject("breadcrumb",e),o=n.prefixCls,r=n.direction,s=function(e,t){return e=(e||"").replace(/^\//,""),Object.keys(t).forEach((function(i){e=e.replace(":".concat(i),t[i])})),e},a=function(e,t,i){var n=_toConsumableArray$2(e),o=s(t||"",i);return o&&n.push(o),n};return function(){var t,n,l,d=e.routes,c=e.params,h=void 0===c?{}:c,u=flattenChildren(getPropsSlot(i,e)),g=null!==(n=getPropsSlot(i,e,"separator"))&&void 0!==n?n:"/",p=e.itemRender||i.itemRender||defaultItemRender;d&&d.length>0?l=function(e){var t=e.routes,i=void 0===t?[]:t,n=e.params,o=void 0===n?{}:n,r=e.separator,l=e.itemRender,d=void 0===l?defaultItemRender:l,c=[];return i.map((function(e){var t=s(e.path,o);t&&c.push(t);var n=[].concat(c),l=null;return e.children&&e.children.length&&(l=createVNode(Menu$2,null,{default:function(){return[e.children.map((function(e){return createVNode(Menu$2.Item,{key:e.path||e.breadcrumbName},{default:function(){return[d({route:e,params:o,routes:i,paths:a(n,e.path,o)})]}})}))]}})),createVNode(BreadcrumbItem,{overlay:l,separator:r,key:t||e.breadcrumbName},{default:function(){return[d({route:e,params:o,routes:i,paths:n})]}})}))}({routes:d,params:h,separator:g,itemRender:p}):u.length&&(l=u.map((function(e,t){return warning("object"===_typeof$1(e.type)&&(e.type.__ANT_BREADCRUMB_ITEM||e.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),cloneVNode(e,{separator:g,key:t})})));var m=(_defineProperty$9(t={},o.value,!0),_defineProperty$9(t,"".concat(o.value,"-rtl"),"rtl"===r.value),t);return createVNode("div",{class:m},[l])}}}),__rest$2=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},breadcrumbSeparatorProps=function(){return{prefixCls:String}},BreadcrumbSeparator=defineComponent({name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:breadcrumbSeparatorProps(),setup:function(e,t){var i=t.slots,n=t.attrs,o=useConfigInject("breadcrumb",e).prefixCls;return function(){var e;n.separator;var t=n.class,r=__rest$2(n,["separator","class"]),s=flattenChildren(null===(e=i.default)||void 0===e?void 0:e.call(i));return createVNode("span",_objectSpread2({class:["".concat(o.value,"-separator"),t]},r),[s.length>0?s:"/"])}}});Breadcrumb.Item=BreadcrumbItem,Breadcrumb.Separator=BreadcrumbSeparator,Breadcrumb.install=function(e){return e.component(Breadcrumb.name,Breadcrumb),e.component(BreadcrumbItem.name,BreadcrumbItem),e.component(BreadcrumbSeparator.name,BreadcrumbSeparator),e};var ClockCircleOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},ClockCircleOutlinedSvg=ClockCircleOutlined$2;function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$8(e,t,i[t])}))}return e}function _defineProperty$8(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ClockCircleOutlined=function(e,t){var i=_objectSpread$8({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$8({},i,{icon:ClockCircleOutlinedSvg}),null)};ClockCircleOutlined.displayName="ClockCircleOutlined",ClockCircleOutlined.inheritAttrs=!1;var ClockCircleOutlined$1=ClockCircleOutlined,listItemMetaProps=function(){return{avatar:PropTypes.any,description:PropTypes.any,prefixCls:String,title:PropTypes.any}},ItemMeta=defineComponent({name:"AListItemMeta",props:listItemMetaProps(),displayName:"AListItemMeta",__ANT_LIST_ITEM_META:!0,slots:["avatar","description","title"],setup:function(e,t){var i=t.slots,n=useConfigInject("list",e).prefixCls;return function(){var t,o,r,s,a,l,d="".concat(n.value,"-item-meta"),c=null!==(t=e.title)&&void 0!==t?t:null===(o=i.title)||void 0===o?void 0:o.call(i),h=null!==(r=e.description)&&void 0!==r?r:null===(s=i.description)||void 0===s?void 0:s.call(i),u=null!==(a=e.avatar)&&void 0!==a?a:null===(l=i.avatar)||void 0===l?void 0:l.call(i),g=createVNode("div",{class:"".concat(n.value,"-item-meta-content")},[c&&createVNode("h4",{class:"".concat(n.value,"-item-meta-title")},[c]),h&&createVNode("div",{class:"".concat(n.value,"-item-meta-description")},[h])]);return createVNode("div",{class:d},[u&&createVNode("div",{class:"".concat(n.value,"-item-meta-avatar")},[u]),(c||h)&&g])}}}),ListContextKey=Symbol("ListContextKey"),__rest$1=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},listItemProps=function(){return{prefixCls:String,extra:PropTypes.any,actions:PropTypes.array,grid:Object,colStyle:{type:Object,default:void 0}}},__unplugin_components_2=defineComponent({name:"AListItem",inheritAttrs:!1,Meta:ItemMeta,props:listItemProps(),slots:["actions","extra"],setup:function(e,t){var i=t.slots,n=t.attrs,o=inject(ListContextKey,{grid:ref(),itemLayout:ref()}),r=o.itemLayout,s=o.grid,a=useConfigInject("list",e).prefixCls,l=function(){var t,n,o=null!==(t=e.extra)&&void 0!==t?t:null===(n=i.extra)||void 0===n?void 0:n.call(i);return"vertical"===r.value?!!o:!function(){var e,t,n=(null===(e=i.default)||void 0===e?void 0:e.call(i))||[];return n.forEach((function(e){isStringElement(e)&&!isEmptyElement(e)&&(t=!0)})),t&&n.length>1}()};return function(){var t,o,d,c,h,u=n.class,g=__rest$1(n,["class"]),p=a.value,m=null!==(t=e.extra)&&void 0!==t?t:null===(o=i.extra)||void 0===o?void 0:o.call(i),f=null===(d=i.default)||void 0===d?void 0:d.call(i),_=null!==(c=e.actions)&&void 0!==c?c:flattenChildren(null===(h=i.actions)||void 0===h?void 0:h.call(i)),C=(_=_&&!Array.isArray(_)?[_]:_)&&_.length>0&&createVNode("ul",{class:"".concat(p,"-item-action"),key:"actions"},[_.map((function(e,t){return createVNode("li",{key:"".concat(p,"-item-action-").concat(t)},[e,t!==_.length-1&&createVNode("em",{class:"".concat(p,"-item-action-split")},null)])}))]),v=s.value?"div":"li",b=createVNode(v,_objectSpread2(_objectSpread2({},g),{},{class:classNames("".concat(p,"-item"),_defineProperty$9({},"".concat(p,"-item-no-flex"),!l()),u)}),{default:function(){return["vertical"===r.value&&m?[createVNode("div",{class:"".concat(p,"-item-main"),key:"content"},[f,C]),createVNode("div",{class:"".concat(p,"-item-extra"),key:"extra"},[m])]:[f,C,cloneElement(m,{key:"extra"})]]}});return s.value?createVNode(Col,{flex:1,style:e.colStyle},{default:function(){return[b]}}):b}}}),listProps=function(){return{bordered:{type:Boolean,default:void 0},dataSource:PropTypes.array,extra:PropTypes.any,grid:{type:Object,default:void 0},itemLayout:String,loading:{type:[Boolean,Object],default:void 0},loadMore:PropTypes.any,pagination:{type:[Boolean,Object],default:void 0},prefixCls:String,rowKey:[String,Number,Function],renderItem:Function,size:String,split:{type:Boolean,default:void 0},header:PropTypes.any,footer:PropTypes.any,locale:{type:Object}}},List$1=defineComponent({name:"AList",Item:__unplugin_components_2,props:initDefaultProps(listProps(),{dataSource:[],bordered:!1,split:!0,loading:!1,pagination:!1}),slots:["extra","loadMore","renderItem","header","footer"],setup:function(e,t){var i,n,o=t.slots;provide(ListContextKey,{grid:toRef(e,"grid"),itemLayout:toRef(e,"itemLayout")});var r={current:1,total:0},s=useConfigInject("list",e),a=s.prefixCls,l=s.direction,d=s.renderEmpty,c=computed((function(){return e.pagination&&"object"===_typeof$1(e.pagination)?e.pagination:{}})),h=ref(null!==(i=c.value.defaultCurrent)&&void 0!==i?i:1),u=ref(null!==(n=c.value.defaultPageSize)&&void 0!==n?n:10);watch(c,(function(){"current"in c.value&&(h.value=c.value.current),"pageSize"in c.value&&(u.value=c.value.pageSize)}));var g=[],p=function(e){return function(t,i){h.value=t,u.value=i,c.value[e]&&c.value[e](t,i)}},m=p("onChange"),f=p("onShowSizeChange"),_=computed((function(){return"boolean"==typeof e.loading?{spinning:e.loading}:e.loading})),C=computed((function(){return _.value&&_.value.spinning})),v=computed((function(){var t="";switch(e.size){case"large":t="lg";break;case"small":t="sm"}return t})),b=computed((function(){var t;return _defineProperty$9(t={},"".concat(a.value),!0),_defineProperty$9(t,"".concat(a.value,"-vertical"),"vertical"===e.itemLayout),_defineProperty$9(t,"".concat(a.value,"-").concat(v.value),v.value),_defineProperty$9(t,"".concat(a.value,"-split"),e.split),_defineProperty$9(t,"".concat(a.value,"-bordered"),e.bordered),_defineProperty$9(t,"".concat(a.value,"-loading"),C.value),_defineProperty$9(t,"".concat(a.value,"-grid"),!!e.grid),_defineProperty$9(t,"".concat(a.value,"-rtl"),"rtl"===l.value),t})),S=computed((function(){var t=_extends(_extends(_extends({},r),{total:e.dataSource.length,current:h.value,pageSize:u.value}),e.pagination||{}),i=Math.ceil(t.total/t.pageSize);return t.current>i&&(t.current=i),t})),y=computed((function(){var t=_toConsumableArray$2(e.dataSource);return e.pagination&&e.dataSource.length>(S.value.current-1)*S.value.pageSize&&(t=_toConsumableArray$2(e.dataSource).splice((S.value.current-1)*S.value.pageSize,S.value.pageSize)),t})),w=useBreakpoint(),E=eagerComputed((function(){for(var e=0;e<responsiveArray.length;e+=1){var t=responsiveArray[e];if(w.value[t])return t}})),L=computed((function(){if(e.grid){var t=E.value&&e.grid[E.value]?e.grid[E.value]:e.grid.column;return t?{width:"".concat(100/t,"%"),maxWidth:"".concat(100/t,"%")}:void 0}}));return function(){var t,i,n,r,s,l,c,h=null!==(t=e.loadMore)&&void 0!==t?t:null===(i=o.loadMore)||void 0===i?void 0:i.call(o),u=null!==(n=e.footer)&&void 0!==n?n:null===(r=o.footer)||void 0===r?void 0:r.call(o),p=null!==(s=e.header)&&void 0!==s?s:null===(l=o.header)||void 0===l?void 0:l.call(o),v=flattenChildren(null===(c=o.default)||void 0===c?void 0:c.call(o)),w=!!(h||e.pagination||u),E=_extends(_extends({},b.value),_defineProperty$9({},"".concat(a.value,"-something-after-last-item"),w)),x=e.pagination?createVNode("div",{class:"".concat(a.value,"-pagination")},[createVNode(Pagination,_objectSpread2(_objectSpread2({},S.value),{},{onChange:m,onShowSizeChange:f}),null)]):null,D=C.value&&createVNode("div",{style:{minHeight:"53px"}},null);if(y.value.length>0){g.length=0;var I=y.value.map((function(t,i){return function(t,i){var n,r,s=null!==(n=e.renderItem)&&void 0!==n?n:o.renderItem;if(!s)return null;var a=_typeof$1(e.rowKey);return(r="function"===a?e.rowKey(t):"string"===a||"number"===a?t[e.rowKey]:t.key)||(r="list-item-".concat(i)),g[i]=r,s({item:t,index:i})}(t,i)})),k=I.map((function(e,t){return createVNode("div",{key:g[t],style:L.value},[e])}));D=e.grid?createVNode(Row,{gutter:e.grid.gutter},{default:function(){return[k]}}):createVNode("ul",{class:"".concat(a.value,"-items")},[I])}else v.length||C.value||(D=function(t){var i;return createVNode("div",{class:"".concat(a.value,"-empty-text")},[(null===(i=e.locale)||void 0===i?void 0:i.emptyText)||t("List")])}(d.value));var T=S.value.position||"bottom";return createVNode("div",{class:E},[("top"===T||"both"===T)&&x,p&&createVNode("div",{class:"".concat(a.value,"-header")},[p]),createVNode(Spin,_.value,{default:function(){return[D,v]}}),u&&createVNode("div",{class:"".concat(a.value,"-footer")},[u]),h||("bottom"===T||"both"===T)&&x])}}});List$1.install=function(e){return e.component(List$1.name,List$1),e.component(List$1.Item.name,List$1.Item),e.component(List$1.Item.Meta.name,List$1.Item.Meta),e};var __unplugin_components_3=List$1,ArrowLeftOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},ArrowLeftOutlinedSvg=ArrowLeftOutlined$2;function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$7(e,t,i[t])}))}return e}function _defineProperty$7(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ArrowLeftOutlined=function(e,t){var i=_objectSpread$7({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$7({},i,{icon:ArrowLeftOutlinedSvg}),null)};ArrowLeftOutlined.displayName="ArrowLeftOutlined",ArrowLeftOutlined.inheritAttrs=!1;var ArrowLeftOutlined$1=ArrowLeftOutlined,ArrowRightOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},ArrowRightOutlinedSvg=ArrowRightOutlined$2;function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$6(e,t,i[t])}))}return e}function _defineProperty$6(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ArrowRightOutlined=function(e,t){var i=_objectSpread$6({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$6({},i,{icon:ArrowRightOutlinedSvg}),null)};ArrowRightOutlined.displayName="ArrowRightOutlined",ArrowRightOutlined.inheritAttrs=!1;var ArrowRightOutlined$1=ArrowRightOutlined,__rest=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i},inlineStyle={border:0,background:"transparent",padding:0,lineHeight:"inherit",display:"inline-block"},TransButton=defineComponent({name:"TransButton",inheritAttrs:!1,props:{noStyle:{type:Boolean,default:void 0},onClick:Function,disabled:{type:Boolean,default:void 0},autofocus:{type:Boolean,default:void 0}},setup:function(e,t){var i=t.slots,n=t.emit,o=t.attrs,r=t.expose,s=ref(),a=function(e){e.keyCode===KeyCode$2.ENTER&&e.preventDefault()},l=function(e){e.keyCode===KeyCode$2.ENTER&&n("click",e)},d=function(e){n("click",e)},c=function(){s.value&&s.value.focus()};return onMounted((function(){e.autofocus&&c()})),r({focus:c,blur:function(){s.value&&s.value.blur()}}),function(){var t,n=e.noStyle,r=e.disabled,c=__rest(e,["noStyle","disabled"]),h={};return n||(h=_extends({},inlineStyle)),r&&(h.pointerEvents="none"),createVNode("div",_objectSpread2(_objectSpread2(_objectSpread2({role:"button",tabindex:0,ref:s},c),o),{},{onClick:d,onKeydown:a,onKeyup:l,style:_extends(_extends({},h),o.style||{})}),[null===(t=i.default)||void 0===t?void 0:t.call(i)])}}}),TransButton$1=TransButton,pageHeaderProps=function(){return{backIcon:PropTypes.any,prefixCls:String,title:PropTypes.any,subTitle:PropTypes.any,breadcrumb:PropTypes.object,tags:PropTypes.any,footer:PropTypes.any,extra:PropTypes.any,avatar:PropTypes.object,ghost:{type:Boolean,default:void 0},onBack:Function}},PageHeader=defineComponent({name:"APageHeader",props:pageHeaderProps(),slots:["backIcon","avatar","breadcrumb","title","subTitle","tags","extra","footer"],setup:function(e,t){var i=t.emit,n=t.slots,o=useConfigInject("page-header",e),r=o.prefixCls,s=o.direction,a=o.pageHeader,l=ref(!1),d=useDestroyed(),c=function(e){var t=e.width;d.value||(l.value=t<768)},h=computed((function(){var t,i,n;return null===(n=null!==(t=e.ghost)&&void 0!==t?t:null===(i=a.value)||void 0===i?void 0:i.ghost)||void 0===n||n})),u=function(){var t;return e.breadcrumb?createVNode(Breadcrumb,e.breadcrumb,null):null===(t=n.breadcrumb)||void 0===t?void 0:t.call(n)},g=function(){var t,o,a,l,d,c,h,u,g,p=e.avatar,m=null!==(t=e.title)&&void 0!==t?t:null===(o=n.title)||void 0===o?void 0:o.call(n),f=null!==(a=e.subTitle)&&void 0!==a?a:null===(l=n.subTitle)||void 0===l?void 0:l.call(n),_=null!==(d=e.tags)&&void 0!==d?d:null===(c=n.tags)||void 0===c?void 0:c.call(n),C=null!==(h=e.extra)&&void 0!==h?h:null===(u=n.extra)||void 0===u?void 0:u.call(n),v="".concat(r.value,"-heading"),b=m||f||_||C;if(!b)return null;var S=function(){var t,i,o;return null!==(o=null!==(t=e.backIcon)&&void 0!==t?t:null===(i=n.backIcon)||void 0===i?void 0:i.call(n))&&void 0!==o?o:"rtl"===s.value?createVNode(ArrowRightOutlined$1,null,null):createVNode(ArrowLeftOutlined$1,null,null)}(),y=function(t){return t&&e.onBack?createVNode(LocaleReceiver,{componentName:"PageHeader",children:function(e){var n=e.back;return createVNode("div",{class:"".concat(r.value,"-back")},[createVNode(TransButton$1,{onClick:function(e){i("back",e)},class:"".concat(r.value,"-back-button"),"aria-label":n},{default:function(){return[t]}})])}},null):null}(S);return createVNode("div",{class:v},[(y||p||b)&&createVNode("div",{class:"".concat(v,"-left")},[y,p?createVNode(Avatar,p,null):null===(g=n.avatar)||void 0===g?void 0:g.call(n),m&&createVNode("span",{class:"".concat(v,"-title"),title:"string"==typeof m?m:void 0},[m]),f&&createVNode("span",{class:"".concat(v,"-sub-title"),title:"string"==typeof f?f:void 0},[f]),_&&createVNode("span",{class:"".concat(v,"-tags")},[_])]),C&&createVNode("span",{class:"".concat(v,"-extra")},[C])])},p=function(){var t,i,o=null!==(t=e.footer)&&void 0!==t?t:filterEmpty(null===(i=n.footer)||void 0===i?void 0:i.call(n));return isEmptyContent(o)?null:createVNode("div",{class:"".concat(r.value,"-footer")},[o])},m=function(e){return createVNode("div",{class:"".concat(r.value,"-content")},[e])};return function(){var t,i,o,a=(null===(i=e.breadcrumb)||void 0===i?void 0:i.routes)||n.breadcrumb,d=e.footer||n.footer,f=flattenChildren(null===(o=n.default)||void 0===o?void 0:o.call(n)),_=classNames(r.value,(_defineProperty$9(t={"has-breadcrumb":a,"has-footer":d},"".concat(r.value,"-ghost"),h.value),_defineProperty$9(t,"".concat(r.value,"-rtl"),"rtl"===s.value),_defineProperty$9(t,"".concat(r.value,"-compact"),l.value),t));return createVNode(ResizeObserver$1,{onResize:c},{default:function(){return[createVNode("div",{class:_},[u(),g(),f.length?m(f):null,p()])]}})}}}),__unplugin_components_0=withInstall(PageHeader),CopyOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},CopyOutlinedSvg=CopyOutlined$2;function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$5(e,t,i[t])}))}return e}function _defineProperty$5(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var CopyOutlined=function(e,t){var i=_objectSpread$5({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$5({},i,{icon:CopyOutlinedSvg}),null)};CopyOutlined.displayName="CopyOutlined",CopyOutlined.inheritAttrs=!1;var CopyOutlined$1=CopyOutlined,BookOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},BookOutlinedSvg=BookOutlined$2;function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$4(e,t,i[t])}))}return e}function _defineProperty$4(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var BookOutlined=function(e,t){var i=_objectSpread$4({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$4({},i,{icon:BookOutlinedSvg}),null)};BookOutlined.displayName="BookOutlined",BookOutlined.inheritAttrs=!1;var BookOutlined$1=BookOutlined,BugOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1a184.31 184.31 0 00-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9a184.31 184.31 0 00-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8a63 63 0 01-63 63H232a63 63 0 01-63-63c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5.2 13 .7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7a273 273 0 0022.7 49c24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2a281.38 281.38 0 00123.2-149.5A120 120 0 01836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7.4-6.4.7-12.8.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3C584 874.3 548.8 884 512 884s-72-9.7-102.9-27.8c-30.3-17.7-55.6-43-73.3-73.3A202.75 202.75 0 01308 680V412h408v268z"}}]},name:"bug",theme:"outlined"},BugOutlinedSvg=BugOutlined$2;function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$3(e,t,i[t])}))}return e}function _defineProperty$3(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var BugOutlined=function(e,t){var i=_objectSpread$3({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$3({},i,{icon:BugOutlinedSvg}),null)};BugOutlined.displayName="BugOutlined",BugOutlined.inheritAttrs=!1;var BugOutlined$1=BugOutlined,FullscreenOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"},FullscreenOutlinedSvg=FullscreenOutlined$2;function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$2(e,t,i[t])}))}return e}function _defineProperty$2(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var FullscreenOutlined=function(e,t){var i=_objectSpread$2({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$2({},i,{icon:FullscreenOutlinedSvg}),null)};FullscreenOutlined.displayName="FullscreenOutlined",FullscreenOutlined.inheritAttrs=!1;var FullscreenOutlined$1=FullscreenOutlined,HourglassOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M742 318V184h86c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H196c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h86v134c0 81.5 42.4 153.2 106.4 194-64 40.8-106.4 112.5-106.4 194v134h-86c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h632c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8h-86V706c0-81.5-42.4-153.2-106.4-194 64-40.8 106.4-112.5 106.4-194zm-72 388v134H354V706c0-42.2 16.4-81.9 46.3-111.7C430.1 564.4 469.8 548 512 548s81.9 16.4 111.7 46.3C653.6 624.1 670 663.8 670 706zm0-388c0 42.2-16.4 81.9-46.3 111.7C593.9 459.6 554.2 476 512 476s-81.9-16.4-111.7-46.3A156.63 156.63 0 01354 318V184h316v134z"}}]},name:"hourglass",theme:"outlined"},HourglassOutlinedSvg=HourglassOutlined$2;function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty$1(e,t,i[t])}))}return e}function _defineProperty$1(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var HourglassOutlined=function(e,t){var i=_objectSpread$1({},e,t.attrs);return createVNode(AntdIcon,_objectSpread$1({},i,{icon:HourglassOutlinedSvg}),null)};HourglassOutlined.displayName="HourglassOutlined",HourglassOutlined.inheritAttrs=!1;var HourglassOutlined$1=HourglassOutlined,ReloadOutlined$2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},ReloadOutlinedSvg=ReloadOutlined$2;function _objectSpread(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){_defineProperty(e,t,i[t])}))}return e}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ReloadOutlined=function(e,t){var i=_objectSpread({},e,t.attrs);return createVNode(AntdIcon,_objectSpread({},i,{icon:ReloadOutlinedSvg}),null)};ReloadOutlined.displayName="ReloadOutlined",ReloadOutlined.inheritAttrs=!1;var ReloadOutlined$1=ReloadOutlined,TextGrid$1="",TextGridComponent=defineComponent({components:{},props:{colspan:{type:Number,default:1},labelWidth:{type:[Number,String],default:""}},render(){const{$slots:e,colspan:t,labelWidth:i}=this;let n="";for(let r=0;r<t;r++)n+=" 1fr";let o=e.default&&e.default();return i&&o&&o.length&&(o=o.map((e=>(e.props&&!e.props.labelWidth&&(e.props.labelWidth=i),e)))),h("div",{class:["text-grid"],style:{"grid-template-columns":n}},{default:()=>o})}}),TextItemComponent=defineComponent({components:{},props:{title:{type:[Number,String],default:""},value:{type:[Number,String],default:""},labelWidth:{type:[Number,String],default:80}},render(){const{title:e,value:t,$slots:i,labelWidth:n}=this;let o=n;return"number"==typeof n&&(o=n+"px"),h("div",{class:["text-grid-item"]},[h("div",{class:["text-grid-item_label"],style:{width:o}},[e,i.title&&i.title()]),h("div",{class:["text-grid-item_value"]},[t,i.default&&i.default()])])}});const TextGrid=TextGridComponent,TextItem=TextItemComponent;var index$4="",index$3="";const _hoisted_1$a={class:"table-card"},_hoisted_2$8={key:2},_hoisted_3$7=["innerHTML"],_hoisted_4$5=createTextVNode("   "),_hoisted_5$4=["onClick"],_sfc_main$f=defineComponent({__name:"TableCard",props:{title:null,subTitle:null,columns:null,data:null,tableProps:null},setup(e){const t=e,{t:i}=useI18n(),n=useSlots();return(e,o)=>{const r=__unplugin_components_0,s=__unplugin_components_1;return openBlock(),createElementBlock("div",_hoisted_1$a,[t.title?(openBlock(),createBlock(r,{key:0,title:t.title,"sub-title":t.subTitle},{extra:withCtx((()=>[renderSlot(e.$slots,"extra")])),_:3},8,["title","sub-title"])):createCommentVNode("",!0),createVNode(s,mergeProps({bordered:"",pagination:!1,size:"small"},t.tableProps,{"data-source":t.data,columns:t.columns,rowKey:"name"}),{bodyCell:withCtx((t=>[unref(n).bodyCell?renderSlot(e.$slots,"bodyCell",normalizeProps(mergeProps({key:0},t))):"require"===t.column.dataIndex?(openBlock(),createElementBlock(Fragment,{key:1},[t.text&&1==t.text?(openBlock(),createBlock(unref(CheckOutlined),{key:0})):createCommentVNode("",!0)],64)):"desc"===t.column.dataIndex?(openBlock(),createElementBlock("div",_hoisted_2$8,[createBaseVNode("span",{innerHTML:unref(textToHtml)(t.text)},null,8,_hoisted_3$7),_hoisted_4$5,t.record.md||t.record.mdRef?(openBlock(),createElementBlock("a",{key:0,onClick:e=>{return n=t.record,void mdModal({title:i("apiPage.mdDetail.title",{name:n.name}),md:n.md});var n}},toDisplayString(unref(i)("common.view")),9,_hoisted_5$4)):createCommentVNode("",!0)])):(openBlock(),createElementBlock(Fragment,{key:3},[createTextVNode(toDisplayString(t.text),1)],64))])),_:3},16,["data-source","columns"])])}}}),_hoisted_1$9={class:"api-table"},_hoisted_2$7={class:"desc"},_hoisted_3$6=["innerHTML"],_hoisted_4$4={key:3},_sfc_main$e=defineComponent({__name:"Index",props:{detail:null},setup(e){const t=e,{t:i}=useI18n(),n=[{title:i("common.field"),dataIndex:"name",width:240},{title:i("common.method"),dataIndex:"type",align:"center",width:130,customRender:e=>{const{text:t,record:i}=e;return"array"==t&&i.childrenType?`${t}<${i.childrenType}>`:t}},{title:i("common.require"),dataIndex:"require",width:100,align:"center"},{title:i("common.defaultValue"),dataIndex:"default",align:"center",width:100},{title:i("common.desc"),dataIndex:"desc"}],o=cloneDeep(n),r=o.findIndex((e=>"require"===e.dataIndex));o[r].title=i("common.notEmpty");const s=reactive({paramsColumns:n,returnColumns:o,tableScroll:{x:"700px",y:"100%"}});return(e,n)=>{const o=__unplugin_components_0,r=__unplugin_components_3$1,a=Tabs;return openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("div",_hoisted_2$7,[t.detail.desc?(openBlock(),createElementBlock("div",{key:0,innerHTML:unref(textToHtml)(t.detail.desc)},null,8,_hoisted_3$6)):createCommentVNode("",!0),t.detail.md?(openBlock(),createBlock(unref(Markdown),{key:1,md:t.detail.md},null,8,["md"])):createCommentVNode("",!0)]),t.detail.header&&t.detail.header.length?(openBlock(),createBlock(_sfc_main$f,{key:0,title:unref(i)("apiPage.header.title"),columns:s.paramsColumns,data:t.detail.header,tableProps:{scroll:s.tableScroll}},null,8,["title","columns","data","tableProps"])):createCommentVNode("",!0),t.detail.query&&t.detail.query.length?(openBlock(),createBlock(_sfc_main$f,{key:1,title:unref(i)("apiPage.query.title"),columns:s.paramsColumns,data:t.detail.query,tableProps:{scroll:s.tableScroll}},null,8,["title","columns","data","tableProps"])):createCommentVNode("",!0),t.detail.param&&t.detail.param.length?(openBlock(),createBlock(_sfc_main$f,{key:2,title:unref(i)("apiPage.body.title"),columns:s.paramsColumns,data:t.detail.param,tableProps:{scroll:s.tableScroll}},null,8,["title","columns","data","tableProps"])):createCommentVNode("",!0),t.detail.responseSuccess&&t.detail.responseSuccess.length||t.detail.responseError&&t.detail.responseError.length?(openBlock(),createElementBlock("div",_hoisted_4$4,[createVNode(o,{title:unref(i)("apiPage.responses")},null,8,["title"]),createVNode(a,{type:"card",size:"small"},{default:withCtx((()=>[createVNode(r,{key:"success",tab:unref(i)("apiPage.responses.success")},{default:withCtx((()=>[createVNode(_sfc_main$f,{columns:s.returnColumns,data:t.detail.responseSuccess,tableProps:{scroll:s.tableScroll}},null,8,["columns","data","tableProps"])])),_:1},8,["tab"]),t.detail.responseError&&t.detail.responseError.length?(openBlock(),createBlock(r,{key:"error",tab:unref(i)("apiPage.responses.error")},{default:withCtx((()=>[createVNode(_sfc_main$f,{columns:s.returnColumns,data:t.detail.responseError,tableProps:{scroll:s.tableScroll}},null,8,["columns","data","tableProps"])])),_:1},8,["tab"])):createCommentVNode("",!0)])),_:1})])):createCommentVNode("",!0)])}}});var mock={exports:{}};(function(module,exports){var factory;factory=function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}([function(e,t,i){var n,o=i(1),r=i(3),s=i(5),a=i(20),l=i(23),d=i(25);"undefined"!=typeof window&&(n=i(27))
/*!
            Mock - 模拟请求 & 模拟数据
            https://github.com/nuysoft/Mock
            墨智 mozhi.gyy@taobao.com nuysoft@gmail.com
        */;var c={Handler:o,Random:s,Util:r,XHR:n,RE:a,toJSONSchema:l,valid:d,heredoc:r.heredoc,setup:function(e){return n.setup(e)},_mocked:{},version:"1.0.1-beta3"};n&&(n.Mock=c),c.mock=function(e,t,i){return 1===arguments.length?o.gen(e):(2===arguments.length&&(i=t,t=void 0),n&&(window.XMLHttpRequest=n),c._mocked[e+(t||"")]={rurl:e,rtype:t,template:i},c)},e.exports=c},function(module,exports,__webpack_require__){var Constant=__webpack_require__(2),Util=__webpack_require__(3),Parser=__webpack_require__(4),Random=__webpack_require__(5),RE=__webpack_require__(20),Handler={extend:Util.extend,gen:function(e,t,i){t=null==t?"":t+"",i={path:(i=i||{}).path||[Constant.GUID],templatePath:i.templatePath||[Constant.GUID++],currentContext:i.currentContext,templateCurrentContext:i.templateCurrentContext||e,root:i.root||i.currentContext,templateRoot:i.templateRoot||i.templateCurrentContext||e};var n,o=Parser.parse(t),r=Util.type(e);return Handler[r]?(n=Handler[r]({type:r,template:e,name:t,parsedName:t?t.replace(Constant.RE_KEY,"$1"):t,rule:o,context:i}),i.root||(i.root=n),n):e}};Handler.extend({array:function(e){var t,i,n=[];if(0===e.template.length)return n;if(e.rule.parameters)if(1===e.rule.min&&void 0===e.rule.max)e.context.path.push(e.name),e.context.templatePath.push(e.name),n=Random.pick(Handler.gen(e.template,void 0,{path:e.context.path,templatePath:e.context.templatePath,currentContext:n,templateCurrentContext:e.template,root:e.context.root||n,templateRoot:e.context.templateRoot||e.template})),e.context.path.pop(),e.context.templatePath.pop();else if(e.rule.parameters[2])e.template.__order_index=e.template.__order_index||0,e.context.path.push(e.name),e.context.templatePath.push(e.name),n=Handler.gen(e.template,void 0,{path:e.context.path,templatePath:e.context.templatePath,currentContext:n,templateCurrentContext:e.template,root:e.context.root||n,templateRoot:e.context.templateRoot||e.template})[e.template.__order_index%e.template.length],e.template.__order_index+=+e.rule.parameters[2],e.context.path.pop(),e.context.templatePath.pop();else for(t=0;t<e.rule.count;t++)for(i=0;i<e.template.length;i++)e.context.path.push(n.length),e.context.templatePath.push(i),n.push(Handler.gen(e.template[i],n.length,{path:e.context.path,templatePath:e.context.templatePath,currentContext:n,templateCurrentContext:e.template,root:e.context.root||n,templateRoot:e.context.templateRoot||e.template})),e.context.path.pop(),e.context.templatePath.pop();else for(t=0;t<e.template.length;t++)e.context.path.push(t),e.context.templatePath.push(t),n.push(Handler.gen(e.template[t],t,{path:e.context.path,templatePath:e.context.templatePath,currentContext:n,templateCurrentContext:e.template,root:e.context.root||n,templateRoot:e.context.templateRoot||e.template})),e.context.path.pop(),e.context.templatePath.pop();return n},object:function(e){var t,i,n,o,r,s,a={};if(null!=e.rule.min)for(t=Util.keys(e.template),t=(t=Random.shuffle(t)).slice(0,e.rule.count),s=0;s<t.length;s++)o=(n=t[s]).replace(Constant.RE_KEY,"$1"),e.context.path.push(o),e.context.templatePath.push(n),a[o]=Handler.gen(e.template[n],n,{path:e.context.path,templatePath:e.context.templatePath,currentContext:a,templateCurrentContext:e.template,root:e.context.root||a,templateRoot:e.context.templateRoot||e.template}),e.context.path.pop(),e.context.templatePath.pop();else{for(n in t=[],i=[],e.template)("function"==typeof e.template[n]?i:t).push(n);for(t=t.concat(i),s=0;s<t.length;s++)o=(n=t[s]).replace(Constant.RE_KEY,"$1"),e.context.path.push(o),e.context.templatePath.push(n),a[o]=Handler.gen(e.template[n],n,{path:e.context.path,templatePath:e.context.templatePath,currentContext:a,templateCurrentContext:e.template,root:e.context.root||a,templateRoot:e.context.templateRoot||e.template}),e.context.path.pop(),e.context.templatePath.pop(),(r=n.match(Constant.RE_KEY))&&r[2]&&"number"===Util.type(e.template[n])&&(e.template[n]+=parseInt(r[2],10))}return a},number:function(e){var t,i;if(e.rule.decimal){for(e.template+="",(i=e.template.split("."))[0]=e.rule.range?e.rule.count:i[0],i[1]=(i[1]||"").slice(0,e.rule.dcount);i[1].length<e.rule.dcount;)i[1]+=i[1].length<e.rule.dcount-1?Random.character("number"):Random.character("123456789");t=parseFloat(i.join("."),10)}else t=e.rule.range&&!e.rule.parameters[2]?e.rule.count:e.template;return t},boolean:function(e){return e.rule.parameters?Random.bool(e.rule.min,e.rule.max,e.template):e.template},string:function(e){var t,i,n,o,r="";if(e.template.length){for(null==e.rule.count&&(r+=e.template),t=0;t<e.rule.count;t++)r+=e.template;for(i=r.match(Constant.RE_PLACEHOLDER)||[],t=0;t<i.length;t++)if(n=i[t],/^\\/.test(n))i.splice(t--,1);else{if(o=Handler.placeholder(n,e.context.currentContext,e.context.templateCurrentContext,e),1===i.length&&n===r&&typeof o!=typeof r){r=o;break}r=r.replace(n,o)}}else r=e.rule.range?Random.string(e.rule.count):e.template;return r},function:function(e){return e.template.call(e.context.currentContext,e)},regexp:function(e){var t="";null==e.rule.count&&(t+=e.template.source);for(var i=0;i<e.rule.count;i++)t+=e.template.source;return RE.Handler.gen(RE.Parser.parse(t))}}),Handler.extend({_all:function(){var e={};for(var t in Random)e[t.toLowerCase()]=t;return e},placeholder:function(placeholder,obj,templateContext,options){Constant.RE_PLACEHOLDER.exec("");var parts=Constant.RE_PLACEHOLDER.exec(placeholder),key=parts&&parts[1],lkey=key&&key.toLowerCase(),okey=this._all()[lkey],params=parts&&parts[2]||"",pathParts=this.splitPathToArray(key);try{params=eval("(function(){ return [].splice.call(arguments, 0 ) })("+params+")")}catch(error){params=parts[2].split(/,\s*/)}if(obj&&key in obj)return obj[key];if("/"===key.charAt(0)||pathParts.length>1)return this.getValueByKeyPath(key,options);if(templateContext&&"object"==typeof templateContext&&key in templateContext&&placeholder!==templateContext[key])return templateContext[key]=Handler.gen(templateContext[key],key,{currentContext:obj,templateCurrentContext:templateContext}),templateContext[key];if(!(key in Random)&&!(lkey in Random)&&!(okey in Random))return placeholder;for(var i=0;i<params.length;i++)Constant.RE_PLACEHOLDER.exec(""),Constant.RE_PLACEHOLDER.test(params[i])&&(params[i]=Handler.placeholder(params[i],obj,templateContext,options));var handle=Random[key]||Random[lkey]||Random[okey];switch(Util.type(handle)){case"array":return Random.pick(handle);case"function":handle.options=options;var re=handle.apply(Random,params);return void 0===re&&(re=""),delete handle.options,re}},getValueByKeyPath:function(e,t){var i=e,n=this.splitPathToArray(e),o=[];"/"===e.charAt(0)?o=[t.context.path[0]].concat(this.normalizePath(n)):n.length>1&&((o=t.context.path.slice(0)).pop(),o=this.normalizePath(o.concat(n)));try{e=n[n.length-1];for(var r=t.context.root,s=t.context.templateRoot,a=1;a<o.length-1;a++)r=r[o[a]],s=s[o[a]];if(r&&e in r)return r[e];if(s&&"object"==typeof s&&e in s&&i!==s[e])return s[e]=Handler.gen(s[e],e,{currentContext:r,templateCurrentContext:s}),s[e]}catch(l){}return"@"+n.join("/")},normalizePath:function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i]){case"..":t.pop();break;case".":break;default:t.push(e[i])}return t},splitPathToArray:function(e){var t=e.split(/\/+/);return t[t.length-1]||(t=t.slice(0,-1)),t[0]||(t=t.slice(1)),t}}),module.exports=Handler},function(e,t){e.exports={GUID:1,RE_KEY:/(.+)\|(?:\+(\d+)|([\+\-]?\d+-?[\+\-]?\d*)?(?:\.(\d+-?\d*))?)/,RE_RANGE:/([\+\-]?\d+)-?([\+\-]?\d+)?/,RE_PLACEHOLDER:/\\*@([^@#%&()\?\s]+)(?:\((.*?)\))?/g}},function(e,t){var i={extend:function(){var e,t,n,o,r,s=arguments[0]||{},a=1,l=arguments.length;for(1===l&&(s=this,a=0);a<l;a++)if(e=arguments[a])for(t in e)n=s[t],s!==(o=e[t])&&void 0!==o&&(i.isArray(o)||i.isObject(o)?(i.isArray(o)&&(r=n&&i.isArray(n)?n:[]),i.isObject(o)&&(r=n&&i.isObject(n)?n:{}),s[t]=i.extend(r,o)):s[t]=o);return s},each:function(e,t,i){var n,o;if("number"===this.type(e))for(n=0;n<e;n++)t(n,n);else if(e.length===+e.length)for(n=0;n<e.length&&!1!==t.call(i,e[n],n,e);n++);else for(o in e)if(!1===t.call(i,e[o],o,e))break},type:function(e){return null==e?String(e):Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1].toLowerCase()}};i.each("String Object Array RegExp Function".split(" "),(function(e){i["is"+e]=function(t){return i.type(t)===e.toLowerCase()}})),i.isObjectOrArray=function(e){return i.isObject(e)||i.isArray(e)},i.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},i.keys=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t},i.values=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);return t},i.heredoc=function(e){return e.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"").replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")},i.noop=function(){},e.exports=i},function(e,t,i){var n=i(2),o=i(5);e.exports={parse:function(e){var t=((e=null==e?"":e+"")||"").match(n.RE_KEY),i=t&&t[3]&&t[3].match(n.RE_RANGE),r=i&&i[1]&&parseInt(i[1],10),s=i&&i[2]&&parseInt(i[2],10),a=i?i[2]?o.integer(r,s):parseInt(i[1],10):void 0,l=t&&t[4]&&t[4].match(n.RE_RANGE),d=l&&l[1]&&parseInt(l[1],10),c=l&&l[2]&&parseInt(l[2],10),h={parameters:t,range:i,min:r,max:s,count:a,decimal:l,dmin:d,dmax:c,dcount:l?!l[2]&&parseInt(l[1],10)||o.integer(d,c):void 0};for(var u in h)if(null!=h[u])return h;return{}}}},function(e,t,i){var n={extend:i(3).extend};n.extend(i(6)),n.extend(i(7)),n.extend(i(8)),n.extend(i(10)),n.extend(i(13)),n.extend(i(15)),n.extend(i(16)),n.extend(i(17)),n.extend(i(14)),n.extend(i(19)),e.exports=n},function(e,t){e.exports={boolean:function(e,t,i){return void 0!==i?(e=void 0===e||isNaN(e)?1:parseInt(e,10),t=void 0===t||isNaN(t)?1:parseInt(t,10),Math.random()>1/(e+t)*e?!i:i):Math.random()>=.5},bool:function(e,t,i){return this.boolean(e,t,i)},natural:function(e,t){return e=void 0!==e?parseInt(e,10):0,t=void 0!==t?parseInt(t,10):9007199254740992,Math.round(Math.random()*(t-e))+e},integer:function(e,t){return e=void 0!==e?parseInt(e,10):-9007199254740992,t=void 0!==t?parseInt(t,10):9007199254740992,Math.round(Math.random()*(t-e))+e},int:function(e,t){return this.integer(e,t)},float:function(e,t,i,n){i=void 0===i?0:i,i=Math.max(Math.min(i,17),0),n=void 0===n?17:n,n=Math.max(Math.min(n,17),0);for(var o=this.integer(e,t)+".",r=0,s=this.natural(i,n);r<s;r++)o+=r<s-1?this.character("number"):this.character("123456789");return parseFloat(o,10)},character:function(e){var t={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",number:"0123456789",symbol:"!@#$%^&*()[]"};return t.alpha=t.lower+t.upper,t[void 0]=t.lower+t.upper+t.number+t.symbol,(e=t[(""+e).toLowerCase()]||e).charAt(this.natural(0,e.length-1))},char:function(e){return this.character(e)},string:function(e,t,i){var n;switch(arguments.length){case 0:n=this.natural(3,7);break;case 1:n=e,e=void 0;break;case 2:"string"==typeof arguments[0]?n=t:(n=this.natural(e,t),e=void 0);break;case 3:n=this.natural(t,i)}for(var o="",r=0;r<n;r++)o+=this.character(e);return o},str:function(){return this.string.apply(this,arguments)},range:function(e,t,i){arguments.length<=1&&(t=e||0,e=0),e=+e,t=+t,i=+(i=arguments[2]||1);for(var n=Math.max(Math.ceil((t-e)/i),0),o=0,r=new Array(n);o<n;)r[o++]=e,e+=i;return r}}},function(e,t){var i={yyyy:"getFullYear",yy:function(e){return(""+e.getFullYear()).slice(2)},y:"yy",MM:function(e){var t=e.getMonth()+1;return t<10?"0"+t:t},M:function(e){return e.getMonth()+1},dd:function(e){var t=e.getDate();return t<10?"0"+t:t},d:"getDate",HH:function(e){var t=e.getHours();return t<10?"0"+t:t},H:"getHours",hh:function(e){var t=e.getHours()%12;return t<10?"0"+t:t},h:function(e){return e.getHours()%12},mm:function(e){var t=e.getMinutes();return t<10?"0"+t:t},m:"getMinutes",ss:function(e){var t=e.getSeconds();return t<10?"0"+t:t},s:"getSeconds",SS:function(e){var t=e.getMilliseconds();return t<10&&"00"+t||t<100&&"0"+t||t},S:"getMilliseconds",A:function(e){return e.getHours()<12?"AM":"PM"},a:function(e){return e.getHours()<12?"am":"pm"},T:"getTime"};e.exports={_patternLetters:i,_rformat:new RegExp(function(){var e=[];for(var t in i)e.push(t);return"("+e.join("|")+")"}(),"g"),_formatDate:function(e,t){return t.replace(this._rformat,(function t(n,o){return"function"==typeof i[o]?i[o](e):i[o]in i?t(n,i[o]):e[i[o]]()}))},_randomDate:function(e,t){return e=void 0===e?new Date(0):e,t=void 0===t?new Date:t,new Date(Math.random()*(t.getTime()-e.getTime()))},date:function(e){return e=e||"yyyy-MM-dd",this._formatDate(this._randomDate(),e)},time:function(e){return e=e||"HH:mm:ss",this._formatDate(this._randomDate(),e)},datetime:function(e){return e=e||"yyyy-MM-dd HH:mm:ss",this._formatDate(this._randomDate(),e)},now:function(e,t){1===arguments.length&&(/year|month|day|hour|minute|second|week/.test(e)||(t=e,e="")),e=(e||"").toLowerCase(),t=t||"yyyy-MM-dd HH:mm:ss";var i=new Date;switch(e){case"year":i.setMonth(0);case"month":i.setDate(1);case"week":case"day":i.setHours(0);case"hour":i.setMinutes(0);case"minute":i.setSeconds(0);case"second":i.setMilliseconds(0)}return"week"===e&&i.setDate(i.getDate()-i.getDay()),this._formatDate(i,t)}}},function(e,t,i){(function(e){e.exports={_adSize:["300x250","250x250","240x400","336x280","180x150","720x300","468x60","234x60","88x31","120x90","120x60","120x240","125x125","728x90","160x600","120x600","300x600"],_screenSize:["320x200","320x240","640x480","800x480","800x480","1024x600","1024x768","1280x800","1440x900","1920x1200","2560x1600"],_videoSize:["720x480","768x576","1280x720","1920x1080"],image:function(e,t,i,n,o){return 4===arguments.length&&(o=n,n=void 0),3===arguments.length&&(o=i,i=void 0),e||(e=this.pick(this._adSize)),t&&~t.indexOf("#")&&(t=t.slice(1)),i&&~i.indexOf("#")&&(i=i.slice(1)),"http://dummyimage.com/"+e+(t?"/"+t:"")+(i?"/"+i:"")+(n?"."+n:"")+(o?"&text="+o:"")},img:function(){return this.image.apply(this,arguments)},_brandColors:{"4ormat":"#fb0a2a","500px":"#02adea","About.me (blue)":"#00405d","About.me (yellow)":"#ffcc33",Addvocate:"#ff6138",Adobe:"#ff0000",Aim:"#fcd20b",Amazon:"#e47911",Android:"#a4c639","Angie's List":"#7fbb00",AOL:"#0060a3",Atlassian:"#003366",Behance:"#053eff","Big Cartel":"#97b538",bitly:"#ee6123",Blogger:"#fc4f08",Boeing:"#0039a6","Booking.com":"#003580",Carbonmade:"#613854",Cheddar:"#ff7243","Code School":"#3d4944",Delicious:"#205cc0",Dell:"#3287c1",Designmoo:"#e54a4f",Deviantart:"#4e6252","Designer News":"#2d72da",Devour:"#fd0001",DEWALT:"#febd17","Disqus (blue)":"#59a3fc","Disqus (orange)":"#db7132",Dribbble:"#ea4c89",Dropbox:"#3d9ae8",Drupal:"#0c76ab",Dunked:"#2a323a",eBay:"#89c507",Ember:"#f05e1b",Engadget:"#00bdf6",Envato:"#528036",Etsy:"#eb6d20",Evernote:"#5ba525","Fab.com":"#dd0017",Facebook:"#3b5998",Firefox:"#e66000","Flickr (blue)":"#0063dc","Flickr (pink)":"#ff0084",Forrst:"#5b9a68",Foursquare:"#25a0ca",Garmin:"#007cc3",GetGlue:"#2d75a2",Gimmebar:"#f70078",GitHub:"#171515","Google Blue":"#0140ca","Google Green":"#16a61e","Google Red":"#dd1812","Google Yellow":"#fcca03","Google+":"#dd4b39",Grooveshark:"#f77f00",Groupon:"#82b548","Hacker News":"#ff6600",HelloWallet:"#0085ca","Heroku (light)":"#c7c5e6","Heroku (dark)":"#6567a5",HootSuite:"#003366",Houzz:"#73ba37",HTML5:"#ec6231",IKEA:"#ffcc33",IMDb:"#f3ce13",Instagram:"#3f729b",Intel:"#0071c5",Intuit:"#365ebf",Kickstarter:"#76cc1e",kippt:"#e03500",Kodery:"#00af81",LastFM:"#c3000d",LinkedIn:"#0e76a8",Livestream:"#cf0005",Lumo:"#576396",Mixpanel:"#a086d3",Meetup:"#e51937",Nokia:"#183693",NVIDIA:"#76b900",Opera:"#cc0f16",Path:"#e41f11","PayPal (dark)":"#1e477a","PayPal (light)":"#3b7bbf",Pinboard:"#0000e6",Pinterest:"#c8232c",PlayStation:"#665cbe",Pocket:"#ee4056",Prezi:"#318bff",Pusha:"#0f71b4",Quora:"#a82400","QUOTE.fm":"#66ceff",Rdio:"#008fd5",Readability:"#9c0000","Red Hat":"#cc0000",Resource:"#7eb400",Rockpack:"#0ba6ab",Roon:"#62b0d9",RSS:"#ee802f",Salesforce:"#1798c1",Samsung:"#0c4da2",Shopify:"#96bf48",Skype:"#00aff0",Snagajob:"#f47a20",Softonic:"#008ace",SoundCloud:"#ff7700","Space Box":"#f86960",Spotify:"#81b71a",Sprint:"#fee100",Squarespace:"#121212",StackOverflow:"#ef8236",Staples:"#cc0000","Status Chart":"#d7584f",Stripe:"#008cdd",StudyBlue:"#00afe1",StumbleUpon:"#f74425","T-Mobile":"#ea0a8e",Technorati:"#40a800","The Next Web":"#ef4423",Treehouse:"#5cb868",Trulia:"#5eab1f",Tumblr:"#34526f","Twitch.tv":"#6441a5",Twitter:"#00acee",TYPO3:"#ff8700",Ubuntu:"#dd4814",Ustream:"#3388ff",Verizon:"#ef1d1d",Vimeo:"#86c9ef",Vine:"#00a478",Virb:"#06afd8","Virgin Media":"#cc0000",Wooga:"#5b009c","WordPress (blue)":"#21759b","WordPress (orange)":"#d54e21","WordPress (grey)":"#464646",Wunderlist:"#2b88d9",XBOX:"#9bc848",XING:"#126567","Yahoo!":"#720e9e",Yandex:"#ffcc00",Yelp:"#c41200",YouTube:"#c4302b",Zalongo:"#5498dc",Zendesk:"#78a300",Zerply:"#9dcc7a",Zootool:"#5e8b1d"},_brandNames:function(){var e=[];for(var t in this._brandColors)e.push(t);return e},dataImage:function(t,i){var n,o=(n="undefined"!=typeof document?document.createElement("canvas"):new(e.require("canvas")))&&n.getContext&&n.getContext("2d");if(!n||!o)return"";t||(t=this.pick(this._adSize)),i=void 0!==i?i:t,t=t.split("x");var r=parseInt(t[0],10),s=parseInt(t[1],10),a=this._brandColors[this.pick(this._brandNames())];return n.width=r,n.height=s,o.textAlign="center",o.textBaseline="middle",o.fillStyle=a,o.fillRect(0,0,r,s),o.fillStyle="#FFF",o.font="bold 14px sans-serif",o.fillText(i,r/2,s/2,r),n.toDataURL("image/png")}}}).call(t,i(9)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,i){var n=i(11),o=i(12);e.exports={color:function(e){return e||o[e]?o[e].nicer:this.hex()},hex:function(){var e=this._goldenRatioColor(),t=n.hsv2rgb(e);return n.rgb2hex(t[0],t[1],t[2])},rgb:function(){var e=this._goldenRatioColor(),t=n.hsv2rgb(e);return"rgb("+parseInt(t[0],10)+", "+parseInt(t[1],10)+", "+parseInt(t[2],10)+")"},rgba:function(){var e=this._goldenRatioColor(),t=n.hsv2rgb(e);return"rgba("+parseInt(t[0],10)+", "+parseInt(t[1],10)+", "+parseInt(t[2],10)+", "+Math.random().toFixed(2)+")"},hsl:function(){var e=this._goldenRatioColor(),t=n.hsv2hsl(e);return"hsl("+parseInt(t[0],10)+", "+parseInt(t[1],10)+", "+parseInt(t[2],10)+")"},_goldenRatioColor:function(e,t){return this._goldenRatio=.618033988749895,this._hue=this._hue||Math.random(),this._hue+=this._goldenRatio,this._hue%=1,"number"!=typeof e&&(e=.5),"number"!=typeof t&&(t=.95),[360*this._hue,100*e,100*t]}}},function(e,t){e.exports={rgb2hsl:function(e){var t,i,n=e[0]/255,o=e[1]/255,r=e[2]/255,s=Math.min(n,o,r),a=Math.max(n,o,r),l=a-s;return a==s?t=0:n==a?t=(o-r)/l:o==a?t=2+(r-n)/l:r==a&&(t=4+(n-o)/l),(t=Math.min(60*t,360))<0&&(t+=360),i=(s+a)/2,[t,100*(a==s?0:i<=.5?l/(a+s):l/(2-a-s)),100*i]},rgb2hsv:function(e){var t,i,n=e[0],o=e[1],r=e[2],s=Math.min(n,o,r),a=Math.max(n,o,r),l=a-s;return i=0===a?0:l/a*1e3/10,a==s?t=0:n==a?t=(o-r)/l:o==a?t=2+(r-n)/l:r==a&&(t=4+(n-o)/l),(t=Math.min(60*t,360))<0&&(t+=360),[t,i,a/255*1e3/10]},hsl2rgb:function(e){var t,i,n,o,r,s=e[0]/360,a=e[1]/100,l=e[2]/100;if(0===a)return[r=255*l,r,r];t=2*l-(i=l<.5?l*(1+a):l+a-l*a),o=[0,0,0];for(var d=0;d<3;d++)(n=s+1/3*-(d-1))<0&&n++,n>1&&n--,r=6*n<1?t+6*(i-t)*n:2*n<1?i:3*n<2?t+(i-t)*(2/3-n)*6:t,o[d]=255*r;return o},hsl2hsv:function(e){var t=e[0],i=e[1]/100,n=e[2]/100;return[t,2*(i*=(n*=2)<=1?n:2-n)/(n+i)*100,(n+i)/2*100]},hsv2rgb:function(e){var t=e[0]/60,i=e[1]/100,n=e[2]/100,o=Math.floor(t)%6,r=t-Math.floor(t),s=255*n*(1-i),a=255*n*(1-i*r),l=255*n*(1-i*(1-r));switch(n*=255,o){case 0:return[n,l,s];case 1:return[a,n,s];case 2:return[s,n,l];case 3:return[s,a,n];case 4:return[l,s,n];case 5:return[n,s,a]}},hsv2hsl:function(e){var t,i,n=e[0],o=e[1]/100,r=e[2]/100;return t=o*r,[n,100*(t/=(i=(2-o)*r)<=1?i:2-i),100*(i/=2)]},rgb2hex:function(e,t,i){return"#"+((256+e<<8|t)<<8|i).toString(16).slice(1)},hex2rgb:function(e){return[(e="0x"+e.slice(1).replace(e.length>4?e:/./g,"$&$&")|0)>>16,e>>8&255,255&e]}}},function(e,t){e.exports={navy:{value:"#000080",nicer:"#001F3F"},blue:{value:"#0000ff",nicer:"#0074D9"},aqua:{value:"#00ffff",nicer:"#7FDBFF"},teal:{value:"#008080",nicer:"#39CCCC"},olive:{value:"#008000",nicer:"#3D9970"},green:{value:"#008000",nicer:"#2ECC40"},lime:{value:"#00ff00",nicer:"#01FF70"},yellow:{value:"#ffff00",nicer:"#FFDC00"},orange:{value:"#ffa500",nicer:"#FF851B"},red:{value:"#ff0000",nicer:"#FF4136"},maroon:{value:"#800000",nicer:"#85144B"},fuchsia:{value:"#ff00ff",nicer:"#F012BE"},purple:{value:"#800080",nicer:"#B10DC9"},silver:{value:"#c0c0c0",nicer:"#DDDDDD"},gray:{value:"#808080",nicer:"#AAAAAA"},black:{value:"#000000",nicer:"#111111"},white:{value:"#FFFFFF",nicer:"#FFFFFF"}}},function(e,t,i){var n=i(6),o=i(14);function r(e,t,i,o){return void 0===i?n.natural(e,t):void 0===o?i:n.natural(parseInt(i,10),parseInt(o,10))}e.exports={paragraph:function(e,t){for(var i=r(3,7,e,t),n=[],o=0;o<i;o++)n.push(this.sentence());return n.join(" ")},cparagraph:function(e,t){for(var i=r(3,7,e,t),n=[],o=0;o<i;o++)n.push(this.csentence());return n.join("")},sentence:function(e,t){for(var i=r(12,18,e,t),n=[],s=0;s<i;s++)n.push(this.word());return o.capitalize(n.join(" "))+"."},csentence:function(e,t){for(var i=r(12,18,e,t),n=[],o=0;o<i;o++)n.push(this.cword());return n.join("")+"。"},word:function(e,t){for(var i=r(3,10,e,t),o="",s=0;s<i;s++)o+=n.character("lower");return o},cword:function(e,t,i){var n,o="的一是在不了有和人这中大为上个国我以要他时来用们生到作地于出就分对成会可主发年动同工也能下过子说产种面而方后多定行学法所民得经十三之进着等部度家电力里如水化高自二理起小物现实加量都两体制机当使点从业本去把性好应开它合还因由其些然前外天政四日那社义事平形相全表间样与关各重新线内数正心反你明看原又么利比或但质气第向道命此变条只没结解问意建月公无系军很情者最立代想已通并提直题党程展五果料象员革位入常文总次品式活设及管特件长求老头基资边流路级少图山统接知较将组见计别她手角期根论运农指几九区强放决西被干做必战先回则任取据处队南给色光门即保治北造百规热领七海口东导器压志世金增争济阶油思术极交受联什认六共权收证改清己美再采转更单风切打白教速花带安场身车例真务具万每目至达走积示议声报斗完类八离华名确才科张信马节话米整空元况今集温传土许步群广石记需段研界拉林律叫且究观越织装影算低持音众书布复容儿须际商非验连断深难近矿千周委素技备半办青省列习响约支般史感劳便团往酸历市克何除消构府称太准精值号率族维划选标写存候毛亲快效斯院查江型眼王按格养易置派层片始却专状育厂京识适属圆包火住调满县局照参红细引听该铁价严龙飞";switch(arguments.length){case 0:e=o,n=1;break;case 1:"string"==typeof arguments[0]?n=1:(n=e,e=o);break;case 2:"string"==typeof arguments[0]?n=t:(n=this.natural(e,t),e=o);break;case 3:n=this.natural(t,i)}for(var r="",s=0;s<n;s++)r+=e.charAt(this.natural(0,e.length-1));return r},title:function(e,t){for(var i=r(3,7,e,t),n=[],o=0;o<i;o++)n.push(this.capitalize(this.word()));return n.join(" ")},ctitle:function(e,t){for(var i=r(3,7,e,t),n=[],o=0;o<i;o++)n.push(this.cword());return n.join("")}}},function(e,t,i){var n=i(3);e.exports={capitalize:function(e){return(e+"").charAt(0).toUpperCase()+(e+"").substr(1)},upper:function(e){return(e+"").toUpperCase()},lower:function(e){return(e+"").toLowerCase()},pick:function(e,t,i){return n.isArray(e)?(void 0===t&&(t=1),void 0===i&&(i=t)):(e=[].slice.call(arguments),t=1,i=1),1===t&&1===i?e[this.natural(0,e.length-1)]:this.shuffle(e,t,i)},shuffle:function(e,t,i){for(var n=(e=e||[]).slice(0),o=[],r=0,s=n.length,a=0;a<s;a++)r=this.natural(0,n.length-1),o.push(n[r]),n.splice(r,1);switch(arguments.length){case 0:case 1:return o;case 2:i=t;case 3:return t=parseInt(t,10),i=parseInt(i,10),o.slice(0,this.natural(t,i))}},order:function e(t){e.cache=e.cache||{},arguments.length>1&&(t=[].slice.call(arguments,0));var i=e.options,n=i.context.templatePath.join("."),o=e.cache[n]=e.cache[n]||{index:0,array:t};return o.array[o.index++%o.array.length]}}},function(e,t){e.exports={first:function(){var e=["James","John","Robert","Michael","William","David","Richard","Charles","Joseph","Thomas","Christopher","Daniel","Paul","Mark","Donald","George","Kenneth","Steven","Edward","Brian","Ronald","Anthony","Kevin","Jason","Matthew","Gary","Timothy","Jose","Larry","Jeffrey","Frank","Scott","Eric"].concat(["Mary","Patricia","Linda","Barbara","Elizabeth","Jennifer","Maria","Susan","Margaret","Dorothy","Lisa","Nancy","Karen","Betty","Helen","Sandra","Donna","Carol","Ruth","Sharon","Michelle","Laura","Sarah","Kimberly","Deborah","Jessica","Shirley","Cynthia","Angela","Melissa","Brenda","Amy","Anna"]);return this.pick(e)},last:function(){return this.pick(["Smith","Johnson","Williams","Brown","Jones","Miller","Davis","Garcia","Rodriguez","Wilson","Martinez","Anderson","Taylor","Thomas","Hernandez","Moore","Martin","Jackson","Thompson","White","Lopez","Lee","Gonzalez","Harris","Clark","Lewis","Robinson","Walker","Perez","Hall","Young","Allen"])},name:function(e){return this.first()+" "+(e?this.first()+" ":"")+this.last()},cfirst:function(){var e="王 李 张 刘 陈 杨 赵 黄 周 吴 徐 孙 胡 朱 高 林 何 郭 马 罗 梁 宋 郑 谢 韩 唐 冯 于 董 萧 程 曹 袁 邓 许 傅 沈 曾 彭 吕 苏 卢 蒋 蔡 贾 丁 魏 薛 叶 阎 余 潘 杜 戴 夏 锺 汪 田 任 姜 范 方 石 姚 谭 廖 邹 熊 金 陆 郝 孔 白 崔 康 毛 邱 秦 江 史 顾 侯 邵 孟 龙 万 段 雷 钱 汤 尹 黎 易 常 武 乔 贺 赖 龚 文".split(" ");return this.pick(e)},clast:function(){var e="伟 芳 娜 秀英 敏 静 丽 强 磊 军 洋 勇 艳 杰 娟 涛 明 超 秀兰 霞 平 刚 桂英".split(" ");return this.pick(e)},cname:function(){return this.cfirst()+this.clast()}}},function(e,t){e.exports={url:function(e,t){return(e||this.protocol())+"://"+(t||this.domain())+"/"+this.word()},protocol:function(){return this.pick("http ftp gopher mailto mid cid news nntp prospero telnet rlogin tn3270 wais".split(" "))},domain:function(e){return this.word()+"."+(e||this.tld())},tld:function(){return this.pick("com net org edu gov int mil cn com.cn net.cn gov.cn org.cn 中国 中国互联.公司 中国互联.网络 tel biz cc tv info name hk mobi asia cd travel pro museum coop aero ad ae af ag ai al am an ao aq ar as at au aw az ba bb bd be bf bg bh bi bj bm bn bo br bs bt bv bw by bz ca cc cf cg ch ci ck cl cm cn co cq cr cu cv cx cy cz de dj dk dm do dz ec ee eg eh es et ev fi fj fk fm fo fr ga gb gd ge gf gh gi gl gm gn gp gr gt gu gw gy hk hm hn hr ht hu id ie il in io iq ir is it jm jo jp ke kg kh ki km kn kp kr kw ky kz la lb lc li lk lr ls lt lu lv ly ma mc md mg mh ml mm mn mo mp mq mr ms mt mv mw mx my mz na nc ne nf ng ni nl no np nr nt nu nz om qa pa pe pf pg ph pk pl pm pn pr pt pw py re ro ru rw sa sb sc sd se sg sh si sj sk sl sm sn so sr st su sy sz tc td tf tg th tj tk tm tn to tp tr tt tv tw tz ua ug uk us uy va vc ve vg vn vu wf ws ye yu za zm zr zw".split(" "))},email:function(e){return this.character("lower")+"."+this.word()+"@"+(e||this.word()+"."+this.tld())},ip:function(){return this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)}}},function(e,t,i){var n=i(18),o=["东北","华北","华东","华中","华南","西南","西北"];e.exports={region:function(){return this.pick(o)},province:function(){return this.pick(n).name},city:function(e){var t=this.pick(n),i=this.pick(t.children);return e?[t.name,i.name].join(" "):i.name},county:function(e){var t=this.pick(n),i=this.pick(t.children),o=this.pick(i.children)||{name:"-"};return e?[t.name,i.name,o.name].join(" "):o.name},zip:function(e){for(var t="",i=0;i<(e||6);i++)t+=this.natural(0,9);return t}}},function(e,t){var i={11e4:"北京",110100:"北京市",110101:"东城区",110102:"西城区",110105:"朝阳区",110106:"丰台区",110107:"石景山区",110108:"海淀区",110109:"门头沟区",110111:"房山区",110112:"通州区",110113:"顺义区",110114:"昌平区",110115:"大兴区",110116:"怀柔区",110117:"平谷区",110228:"密云县",110229:"延庆县",110230:"其它区",12e4:"天津",120100:"天津市",120101:"和平区",120102:"河东区",120103:"河西区",120104:"南开区",120105:"河北区",120106:"红桥区",120110:"东丽区",120111:"西青区",120112:"津南区",120113:"北辰区",120114:"武清区",120115:"宝坻区",120116:"滨海新区",120221:"宁河县",120223:"静海县",120225:"蓟县",120226:"其它区",13e4:"河北省",130100:"石家庄市",130102:"长安区",130103:"桥东区",130104:"桥西区",130105:"新华区",130107:"井陉矿区",130108:"裕华区",130121:"井陉县",130123:"正定县",130124:"栾城县",130125:"行唐县",130126:"灵寿县",130127:"高邑县",130128:"深泽县",130129:"赞皇县",130130:"无极县",130131:"平山县",130132:"元氏县",130133:"赵县",130181:"辛集市",130182:"藁城市",130183:"晋州市",130184:"新乐市",130185:"鹿泉市",130186:"其它区",130200:"唐山市",130202:"路南区",130203:"路北区",130204:"古冶区",130205:"开平区",130207:"丰南区",130208:"丰润区",130223:"滦县",130224:"滦南县",130225:"乐亭县",130227:"迁西县",130229:"玉田县",130230:"曹妃甸区",130281:"遵化市",130283:"迁安市",130284:"其它区",130300:"秦皇岛市",130302:"海港区",130303:"山海关区",130304:"北戴河区",130321:"青龙满族自治县",130322:"昌黎县",130323:"抚宁县",130324:"卢龙县",130398:"其它区",130400:"邯郸市",130402:"邯山区",130403:"丛台区",130404:"复兴区",130406:"峰峰矿区",130421:"邯郸县",130423:"临漳县",130424:"成安县",130425:"大名县",130426:"涉县",130427:"磁县",130428:"肥乡县",130429:"永年县",130430:"邱县",130431:"鸡泽县",130432:"广平县",130433:"馆陶县",130434:"魏县",130435:"曲周县",130481:"武安市",130482:"其它区",130500:"邢台市",130502:"桥东区",130503:"桥西区",130521:"邢台县",130522:"临城县",130523:"内丘县",130524:"柏乡县",130525:"隆尧县",130526:"任县",130527:"南和县",130528:"宁晋县",130529:"巨鹿县",130530:"新河县",130531:"广宗县",130532:"平乡县",130533:"威县",130534:"清河县",130535:"临西县",130581:"南宫市",130582:"沙河市",130583:"其它区",130600:"保定市",130602:"新市区",130603:"北市区",130604:"南市区",130621:"满城县",130622:"清苑县",130623:"涞水县",130624:"阜平县",130625:"徐水县",130626:"定兴县",130627:"唐县",130628:"高阳县",130629:"容城县",130630:"涞源县",130631:"望都县",130632:"安新县",130633:"易县",130634:"曲阳县",130635:"蠡县",130636:"顺平县",130637:"博野县",130638:"雄县",130681:"涿州市",130682:"定州市",130683:"安国市",130684:"高碑店市",130699:"其它区",130700:"张家口市",130702:"桥东区",130703:"桥西区",130705:"宣化区",130706:"下花园区",130721:"宣化县",130722:"张北县",130723:"康保县",130724:"沽源县",130725:"尚义县",130726:"蔚县",130727:"阳原县",130728:"怀安县",130729:"万全县",130730:"怀来县",130731:"涿鹿县",130732:"赤城县",130733:"崇礼县",130734:"其它区",130800:"承德市",130802:"双桥区",130803:"双滦区",130804:"鹰手营子矿区",130821:"承德县",130822:"兴隆县",130823:"平泉县",130824:"滦平县",130825:"隆化县",130826:"丰宁满族自治县",130827:"宽城满族自治县",130828:"围场满族蒙古族自治县",130829:"其它区",130900:"沧州市",130902:"新华区",130903:"运河区",130921:"沧县",130922:"青县",130923:"东光县",130924:"海兴县",130925:"盐山县",130926:"肃宁县",130927:"南皮县",130928:"吴桥县",130929:"献县",130930:"孟村回族自治县",130981:"泊头市",130982:"任丘市",130983:"黄骅市",130984:"河间市",130985:"其它区",131e3:"廊坊市",131002:"安次区",131003:"广阳区",131022:"固安县",131023:"永清县",131024:"香河县",131025:"大城县",131026:"文安县",131028:"大厂回族自治县",131081:"霸州市",131082:"三河市",131083:"其它区",131100:"衡水市",131102:"桃城区",131121:"枣强县",131122:"武邑县",131123:"武强县",131124:"饶阳县",131125:"安平县",131126:"故城县",131127:"景县",131128:"阜城县",131181:"冀州市",131182:"深州市",131183:"其它区",14e4:"山西省",140100:"太原市",140105:"小店区",140106:"迎泽区",140107:"杏花岭区",140108:"尖草坪区",140109:"万柏林区",140110:"晋源区",140121:"清徐县",140122:"阳曲县",140123:"娄烦县",140181:"古交市",140182:"其它区",140200:"大同市",140202:"城区",140203:"矿区",140211:"南郊区",140212:"新荣区",140221:"阳高县",140222:"天镇县",140223:"广灵县",140224:"灵丘县",140225:"浑源县",140226:"左云县",140227:"大同县",140228:"其它区",140300:"阳泉市",140302:"城区",140303:"矿区",140311:"郊区",140321:"平定县",140322:"盂县",140323:"其它区",140400:"长治市",140421:"长治县",140423:"襄垣县",140424:"屯留县",140425:"平顺县",140426:"黎城县",140427:"壶关县",140428:"长子县",140429:"武乡县",140430:"沁县",140431:"沁源县",140481:"潞城市",140482:"城区",140483:"郊区",140485:"其它区",140500:"晋城市",140502:"城区",140521:"沁水县",140522:"阳城县",140524:"陵川县",140525:"泽州县",140581:"高平市",140582:"其它区",140600:"朔州市",140602:"朔城区",140603:"平鲁区",140621:"山阴县",140622:"应县",140623:"右玉县",140624:"怀仁县",140625:"其它区",140700:"晋中市",140702:"榆次区",140721:"榆社县",140722:"左权县",140723:"和顺县",140724:"昔阳县",140725:"寿阳县",140726:"太谷县",140727:"祁县",140728:"平遥县",140729:"灵石县",140781:"介休市",140782:"其它区",140800:"运城市",140802:"盐湖区",140821:"临猗县",140822:"万荣县",140823:"闻喜县",140824:"稷山县",140825:"新绛县",140826:"绛县",140827:"垣曲县",140828:"夏县",140829:"平陆县",140830:"芮城县",140881:"永济市",140882:"河津市",140883:"其它区",140900:"忻州市",140902:"忻府区",140921:"定襄县",140922:"五台县",140923:"代县",140924:"繁峙县",140925:"宁武县",140926:"静乐县",140927:"神池县",140928:"五寨县",140929:"岢岚县",140930:"河曲县",140931:"保德县",140932:"偏关县",140981:"原平市",140982:"其它区",141e3:"临汾市",141002:"尧都区",141021:"曲沃县",141022:"翼城县",141023:"襄汾县",141024:"洪洞县",141025:"古县",141026:"安泽县",141027:"浮山县",141028:"吉县",141029:"乡宁县",141030:"大宁县",141031:"隰县",141032:"永和县",141033:"蒲县",141034:"汾西县",141081:"侯马市",141082:"霍州市",141083:"其它区",141100:"吕梁市",141102:"离石区",141121:"文水县",141122:"交城县",141123:"兴县",141124:"临县",141125:"柳林县",141126:"石楼县",141127:"岚县",141128:"方山县",141129:"中阳县",141130:"交口县",141181:"孝义市",141182:"汾阳市",141183:"其它区",15e4:"内蒙古自治区",150100:"呼和浩特市",150102:"新城区",150103:"回民区",150104:"玉泉区",150105:"赛罕区",150121:"土默特左旗",150122:"托克托县",150123:"和林格尔县",150124:"清水河县",150125:"武川县",150126:"其它区",150200:"包头市",150202:"东河区",150203:"昆都仑区",150204:"青山区",150205:"石拐区",150206:"白云鄂博矿区",150207:"九原区",150221:"土默特右旗",150222:"固阳县",150223:"达尔罕茂明安联合旗",150224:"其它区",150300:"乌海市",150302:"海勃湾区",150303:"海南区",150304:"乌达区",150305:"其它区",150400:"赤峰市",150402:"红山区",150403:"元宝山区",150404:"松山区",150421:"阿鲁科尔沁旗",150422:"巴林左旗",150423:"巴林右旗",150424:"林西县",150425:"克什克腾旗",150426:"翁牛特旗",150428:"喀喇沁旗",150429:"宁城县",150430:"敖汉旗",150431:"其它区",150500:"通辽市",150502:"科尔沁区",150521:"科尔沁左翼中旗",150522:"科尔沁左翼后旗",150523:"开鲁县",150524:"库伦旗",150525:"奈曼旗",150526:"扎鲁特旗",150581:"霍林郭勒市",150582:"其它区",150600:"鄂尔多斯市",150602:"东胜区",150621:"达拉特旗",150622:"准格尔旗",150623:"鄂托克前旗",150624:"鄂托克旗",150625:"杭锦旗",150626:"乌审旗",150627:"伊金霍洛旗",150628:"其它区",150700:"呼伦贝尔市",150702:"海拉尔区",150703:"扎赉诺尔区",150721:"阿荣旗",150722:"莫力达瓦达斡尔族自治旗",150723:"鄂伦春自治旗",150724:"鄂温克族自治旗",150725:"陈巴尔虎旗",150726:"新巴尔虎左旗",150727:"新巴尔虎右旗",150781:"满洲里市",150782:"牙克石市",150783:"扎兰屯市",150784:"额尔古纳市",150785:"根河市",150786:"其它区",150800:"巴彦淖尔市",150802:"临河区",150821:"五原县",150822:"磴口县",150823:"乌拉特前旗",150824:"乌拉特中旗",150825:"乌拉特后旗",150826:"杭锦后旗",150827:"其它区",150900:"乌兰察布市",150902:"集宁区",150921:"卓资县",150922:"化德县",150923:"商都县",150924:"兴和县",150925:"凉城县",150926:"察哈尔右翼前旗",150927:"察哈尔右翼中旗",150928:"察哈尔右翼后旗",150929:"四子王旗",150981:"丰镇市",150982:"其它区",152200:"兴安盟",152201:"乌兰浩特市",152202:"阿尔山市",152221:"科尔沁右翼前旗",152222:"科尔沁右翼中旗",152223:"扎赉特旗",152224:"突泉县",152225:"其它区",152500:"锡林郭勒盟",152501:"二连浩特市",152502:"锡林浩特市",152522:"阿巴嘎旗",152523:"苏尼特左旗",152524:"苏尼特右旗",152525:"东乌珠穆沁旗",152526:"西乌珠穆沁旗",152527:"太仆寺旗",152528:"镶黄旗",152529:"正镶白旗",152530:"正蓝旗",152531:"多伦县",152532:"其它区",152900:"阿拉善盟",152921:"阿拉善左旗",152922:"阿拉善右旗",152923:"额济纳旗",152924:"其它区",21e4:"辽宁省",210100:"沈阳市",210102:"和平区",210103:"沈河区",210104:"大东区",210105:"皇姑区",210106:"铁西区",210111:"苏家屯区",210112:"东陵区",210113:"新城子区",210114:"于洪区",210122:"辽中县",210123:"康平县",210124:"法库县",210181:"新民市",210184:"沈北新区",210185:"其它区",210200:"大连市",210202:"中山区",210203:"西岗区",210204:"沙河口区",210211:"甘井子区",210212:"旅顺口区",210213:"金州区",210224:"长海县",210281:"瓦房店市",210282:"普兰店市",210283:"庄河市",210298:"其它区",210300:"鞍山市",210302:"铁东区",210303:"铁西区",210304:"立山区",210311:"千山区",210321:"台安县",210323:"岫岩满族自治县",210381:"海城市",210382:"其它区",210400:"抚顺市",210402:"新抚区",210403:"东洲区",210404:"望花区",210411:"顺城区",210421:"抚顺县",210422:"新宾满族自治县",210423:"清原满族自治县",210424:"其它区",210500:"本溪市",210502:"平山区",210503:"溪湖区",210504:"明山区",210505:"南芬区",210521:"本溪满族自治县",210522:"桓仁满族自治县",210523:"其它区",210600:"丹东市",210602:"元宝区",210603:"振兴区",210604:"振安区",210624:"宽甸满族自治县",210681:"东港市",210682:"凤城市",210683:"其它区",210700:"锦州市",210702:"古塔区",210703:"凌河区",210711:"太和区",210726:"黑山县",210727:"义县",210781:"凌海市",210782:"北镇市",210783:"其它区",210800:"营口市",210802:"站前区",210803:"西市区",210804:"鲅鱼圈区",210811:"老边区",210881:"盖州市",210882:"大石桥市",210883:"其它区",210900:"阜新市",210902:"海州区",210903:"新邱区",210904:"太平区",210905:"清河门区",210911:"细河区",210921:"阜新蒙古族自治县",210922:"彰武县",210923:"其它区",211e3:"辽阳市",211002:"白塔区",211003:"文圣区",211004:"宏伟区",211005:"弓长岭区",211011:"太子河区",211021:"辽阳县",211081:"灯塔市",211082:"其它区",211100:"盘锦市",211102:"双台子区",211103:"兴隆台区",211121:"大洼县",211122:"盘山县",211123:"其它区",211200:"铁岭市",211202:"银州区",211204:"清河区",211221:"铁岭县",211223:"西丰县",211224:"昌图县",211281:"调兵山市",211282:"开原市",211283:"其它区",211300:"朝阳市",211302:"双塔区",211303:"龙城区",211321:"朝阳县",211322:"建平县",211324:"喀喇沁左翼蒙古族自治县",211381:"北票市",211382:"凌源市",211383:"其它区",211400:"葫芦岛市",211402:"连山区",211403:"龙港区",211404:"南票区",211421:"绥中县",211422:"建昌县",211481:"兴城市",211482:"其它区",22e4:"吉林省",220100:"长春市",220102:"南关区",220103:"宽城区",220104:"朝阳区",220105:"二道区",220106:"绿园区",220112:"双阳区",220122:"农安县",220181:"九台市",220182:"榆树市",220183:"德惠市",220188:"其它区",220200:"吉林市",220202:"昌邑区",220203:"龙潭区",220204:"船营区",220211:"丰满区",220221:"永吉县",220281:"蛟河市",220282:"桦甸市",220283:"舒兰市",220284:"磐石市",220285:"其它区",220300:"四平市",220302:"铁西区",220303:"铁东区",220322:"梨树县",220323:"伊通满族自治县",220381:"公主岭市",220382:"双辽市",220383:"其它区",220400:"辽源市",220402:"龙山区",220403:"西安区",220421:"东丰县",220422:"东辽县",220423:"其它区",220500:"通化市",220502:"东昌区",220503:"二道江区",220521:"通化县",220523:"辉南县",220524:"柳河县",220581:"梅河口市",220582:"集安市",220583:"其它区",220600:"白山市",220602:"浑江区",220621:"抚松县",220622:"靖宇县",220623:"长白朝鲜族自治县",220625:"江源区",220681:"临江市",220682:"其它区",220700:"松原市",220702:"宁江区",220721:"前郭尔罗斯蒙古族自治县",220722:"长岭县",220723:"乾安县",220724:"扶余市",220725:"其它区",220800:"白城市",220802:"洮北区",220821:"镇赉县",220822:"通榆县",220881:"洮南市",220882:"大安市",220883:"其它区",222400:"延边朝鲜族自治州",222401:"延吉市",222402:"图们市",222403:"敦化市",222404:"珲春市",222405:"龙井市",222406:"和龙市",222424:"汪清县",222426:"安图县",222427:"其它区",23e4:"黑龙江省",230100:"哈尔滨市",230102:"道里区",230103:"南岗区",230104:"道外区",230106:"香坊区",230108:"平房区",230109:"松北区",230111:"呼兰区",230123:"依兰县",230124:"方正县",230125:"宾县",230126:"巴彦县",230127:"木兰县",230128:"通河县",230129:"延寿县",230181:"阿城区",230182:"双城市",230183:"尚志市",230184:"五常市",230186:"其它区",230200:"齐齐哈尔市",230202:"龙沙区",230203:"建华区",230204:"铁锋区",230205:"昂昂溪区",230206:"富拉尔基区",230207:"碾子山区",230208:"梅里斯达斡尔族区",230221:"龙江县",230223:"依安县",230224:"泰来县",230225:"甘南县",230227:"富裕县",230229:"克山县",230230:"克东县",230231:"拜泉县",230281:"讷河市",230282:"其它区",230300:"鸡西市",230302:"鸡冠区",230303:"恒山区",230304:"滴道区",230305:"梨树区",230306:"城子河区",230307:"麻山区",230321:"鸡东县",230381:"虎林市",230382:"密山市",230383:"其它区",230400:"鹤岗市",230402:"向阳区",230403:"工农区",230404:"南山区",230405:"兴安区",230406:"东山区",230407:"兴山区",230421:"萝北县",230422:"绥滨县",230423:"其它区",230500:"双鸭山市",230502:"尖山区",230503:"岭东区",230505:"四方台区",230506:"宝山区",230521:"集贤县",230522:"友谊县",230523:"宝清县",230524:"饶河县",230525:"其它区",230600:"大庆市",230602:"萨尔图区",230603:"龙凤区",230604:"让胡路区",230605:"红岗区",230606:"大同区",230621:"肇州县",230622:"肇源县",230623:"林甸县",230624:"杜尔伯特蒙古族自治县",230625:"其它区",230700:"伊春市",230702:"伊春区",230703:"南岔区",230704:"友好区",230705:"西林区",230706:"翠峦区",230707:"新青区",230708:"美溪区",230709:"金山屯区",230710:"五营区",230711:"乌马河区",230712:"汤旺河区",230713:"带岭区",230714:"乌伊岭区",230715:"红星区",230716:"上甘岭区",230722:"嘉荫县",230781:"铁力市",230782:"其它区",230800:"佳木斯市",230803:"向阳区",230804:"前进区",230805:"东风区",230811:"郊区",230822:"桦南县",230826:"桦川县",230828:"汤原县",230833:"抚远县",230881:"同江市",230882:"富锦市",230883:"其它区",230900:"七台河市",230902:"新兴区",230903:"桃山区",230904:"茄子河区",230921:"勃利县",230922:"其它区",231e3:"牡丹江市",231002:"东安区",231003:"阳明区",231004:"爱民区",231005:"西安区",231024:"东宁县",231025:"林口县",231081:"绥芬河市",231083:"海林市",231084:"宁安市",231085:"穆棱市",231086:"其它区",231100:"黑河市",231102:"爱辉区",231121:"嫩江县",231123:"逊克县",231124:"孙吴县",231181:"北安市",231182:"五大连池市",231183:"其它区",231200:"绥化市",231202:"北林区",231221:"望奎县",231222:"兰西县",231223:"青冈县",231224:"庆安县",231225:"明水县",231226:"绥棱县",231281:"安达市",231282:"肇东市",231283:"海伦市",231284:"其它区",232700:"大兴安岭地区",232702:"松岭区",232703:"新林区",232704:"呼中区",232721:"呼玛县",232722:"塔河县",232723:"漠河县",232724:"加格达奇区",232725:"其它区",31e4:"上海",310100:"上海市",310101:"黄浦区",310104:"徐汇区",310105:"长宁区",310106:"静安区",310107:"普陀区",310108:"闸北区",310109:"虹口区",310110:"杨浦区",310112:"闵行区",310113:"宝山区",310114:"嘉定区",310115:"浦东新区",310116:"金山区",310117:"松江区",310118:"青浦区",310120:"奉贤区",310230:"崇明县",310231:"其它区",32e4:"江苏省",320100:"南京市",320102:"玄武区",320104:"秦淮区",320105:"建邺区",320106:"鼓楼区",320111:"浦口区",320113:"栖霞区",320114:"雨花台区",320115:"江宁区",320116:"六合区",320124:"溧水区",320125:"高淳区",320126:"其它区",320200:"无锡市",320202:"崇安区",320203:"南长区",320204:"北塘区",320205:"锡山区",320206:"惠山区",320211:"滨湖区",320281:"江阴市",320282:"宜兴市",320297:"其它区",320300:"徐州市",320302:"鼓楼区",320303:"云龙区",320305:"贾汪区",320311:"泉山区",320321:"丰县",320322:"沛县",320323:"铜山区",320324:"睢宁县",320381:"新沂市",320382:"邳州市",320383:"其它区",320400:"常州市",320402:"天宁区",320404:"钟楼区",320405:"戚墅堰区",320411:"新北区",320412:"武进区",320481:"溧阳市",320482:"金坛市",320483:"其它区",320500:"苏州市",320505:"虎丘区",320506:"吴中区",320507:"相城区",320508:"姑苏区",320581:"常熟市",320582:"张家港市",320583:"昆山市",320584:"吴江区",320585:"太仓市",320596:"其它区",320600:"南通市",320602:"崇川区",320611:"港闸区",320612:"通州区",320621:"海安县",320623:"如东县",320681:"启东市",320682:"如皋市",320684:"海门市",320694:"其它区",320700:"连云港市",320703:"连云区",320705:"新浦区",320706:"海州区",320721:"赣榆县",320722:"东海县",320723:"灌云县",320724:"灌南县",320725:"其它区",320800:"淮安市",320802:"清河区",320803:"淮安区",320804:"淮阴区",320811:"清浦区",320826:"涟水县",320829:"洪泽县",320830:"盱眙县",320831:"金湖县",320832:"其它区",320900:"盐城市",320902:"亭湖区",320903:"盐都区",320921:"响水县",320922:"滨海县",320923:"阜宁县",320924:"射阳县",320925:"建湖县",320981:"东台市",320982:"大丰市",320983:"其它区",321e3:"扬州市",321002:"广陵区",321003:"邗江区",321023:"宝应县",321081:"仪征市",321084:"高邮市",321088:"江都区",321093:"其它区",321100:"镇江市",321102:"京口区",321111:"润州区",321112:"丹徒区",321181:"丹阳市",321182:"扬中市",321183:"句容市",321184:"其它区",321200:"泰州市",321202:"海陵区",321203:"高港区",321281:"兴化市",321282:"靖江市",321283:"泰兴市",321284:"姜堰区",321285:"其它区",321300:"宿迁市",321302:"宿城区",321311:"宿豫区",321322:"沭阳县",321323:"泗阳县",321324:"泗洪县",321325:"其它区",33e4:"浙江省",330100:"杭州市",330102:"上城区",330103:"下城区",330104:"江干区",330105:"拱墅区",330106:"西湖区",330108:"滨江区",330109:"萧山区",330110:"余杭区",330122:"桐庐县",330127:"淳安县",330182:"建德市",330183:"富阳市",330185:"临安市",330186:"其它区",330200:"宁波市",330203:"海曙区",330204:"江东区",330205:"江北区",330206:"北仑区",330211:"镇海区",330212:"鄞州区",330225:"象山县",330226:"宁海县",330281:"余姚市",330282:"慈溪市",330283:"奉化市",330284:"其它区",330300:"温州市",330302:"鹿城区",330303:"龙湾区",330304:"瓯海区",330322:"洞头县",330324:"永嘉县",330326:"平阳县",330327:"苍南县",330328:"文成县",330329:"泰顺县",330381:"瑞安市",330382:"乐清市",330383:"其它区",330400:"嘉兴市",330402:"南湖区",330411:"秀洲区",330421:"嘉善县",330424:"海盐县",330481:"海宁市",330482:"平湖市",330483:"桐乡市",330484:"其它区",330500:"湖州市",330502:"吴兴区",330503:"南浔区",330521:"德清县",330522:"长兴县",330523:"安吉县",330524:"其它区",330600:"绍兴市",330602:"越城区",330621:"绍兴县",330624:"新昌县",330681:"诸暨市",330682:"上虞市",330683:"嵊州市",330684:"其它区",330700:"金华市",330702:"婺城区",330703:"金东区",330723:"武义县",330726:"浦江县",330727:"磐安县",330781:"兰溪市",330782:"义乌市",330783:"东阳市",330784:"永康市",330785:"其它区",330800:"衢州市",330802:"柯城区",330803:"衢江区",330822:"常山县",330824:"开化县",330825:"龙游县",330881:"江山市",330882:"其它区",330900:"舟山市",330902:"定海区",330903:"普陀区",330921:"岱山县",330922:"嵊泗县",330923:"其它区",331e3:"台州市",331002:"椒江区",331003:"黄岩区",331004:"路桥区",331021:"玉环县",331022:"三门县",331023:"天台县",331024:"仙居县",331081:"温岭市",331082:"临海市",331083:"其它区",331100:"丽水市",331102:"莲都区",331121:"青田县",331122:"缙云县",331123:"遂昌县",331124:"松阳县",331125:"云和县",331126:"庆元县",331127:"景宁畲族自治县",331181:"龙泉市",331182:"其它区",34e4:"安徽省",340100:"合肥市",340102:"瑶海区",340103:"庐阳区",340104:"蜀山区",340111:"包河区",340121:"长丰县",340122:"肥东县",340123:"肥西县",340192:"其它区",340200:"芜湖市",340202:"镜湖区",340203:"弋江区",340207:"鸠江区",340208:"三山区",340221:"芜湖县",340222:"繁昌县",340223:"南陵县",340224:"其它区",340300:"蚌埠市",340302:"龙子湖区",340303:"蚌山区",340304:"禹会区",340311:"淮上区",340321:"怀远县",340322:"五河县",340323:"固镇县",340324:"其它区",340400:"淮南市",340402:"大通区",340403:"田家庵区",340404:"谢家集区",340405:"八公山区",340406:"潘集区",340421:"凤台县",340422:"其它区",340500:"马鞍山市",340503:"花山区",340504:"雨山区",340506:"博望区",340521:"当涂县",340522:"其它区",340600:"淮北市",340602:"杜集区",340603:"相山区",340604:"烈山区",340621:"濉溪县",340622:"其它区",340700:"铜陵市",340702:"铜官山区",340703:"狮子山区",340711:"郊区",340721:"铜陵县",340722:"其它区",340800:"安庆市",340802:"迎江区",340803:"大观区",340811:"宜秀区",340822:"怀宁县",340823:"枞阳县",340824:"潜山县",340825:"太湖县",340826:"宿松县",340827:"望江县",340828:"岳西县",340881:"桐城市",340882:"其它区",341e3:"黄山市",341002:"屯溪区",341003:"黄山区",341004:"徽州区",341021:"歙县",341022:"休宁县",341023:"黟县",341024:"祁门县",341025:"其它区",341100:"滁州市",341102:"琅琊区",341103:"南谯区",341122:"来安县",341124:"全椒县",341125:"定远县",341126:"凤阳县",341181:"天长市",341182:"明光市",341183:"其它区",341200:"阜阳市",341202:"颍州区",341203:"颍东区",341204:"颍泉区",341221:"临泉县",341222:"太和县",341225:"阜南县",341226:"颍上县",341282:"界首市",341283:"其它区",341300:"宿州市",341302:"埇桥区",341321:"砀山县",341322:"萧县",341323:"灵璧县",341324:"泗县",341325:"其它区",341400:"巢湖市",341421:"庐江县",341422:"无为县",341423:"含山县",341424:"和县",341500:"六安市",341502:"金安区",341503:"裕安区",341521:"寿县",341522:"霍邱县",341523:"舒城县",341524:"金寨县",341525:"霍山县",341526:"其它区",341600:"亳州市",341602:"谯城区",341621:"涡阳县",341622:"蒙城县",341623:"利辛县",341624:"其它区",341700:"池州市",341702:"贵池区",341721:"东至县",341722:"石台县",341723:"青阳县",341724:"其它区",341800:"宣城市",341802:"宣州区",341821:"郎溪县",341822:"广德县",341823:"泾县",341824:"绩溪县",341825:"旌德县",341881:"宁国市",341882:"其它区",35e4:"福建省",350100:"福州市",350102:"鼓楼区",350103:"台江区",350104:"仓山区",350105:"马尾区",350111:"晋安区",350121:"闽侯县",350122:"连江县",350123:"罗源县",350124:"闽清县",350125:"永泰县",350128:"平潭县",350181:"福清市",350182:"长乐市",350183:"其它区",350200:"厦门市",350203:"思明区",350205:"海沧区",350206:"湖里区",350211:"集美区",350212:"同安区",350213:"翔安区",350214:"其它区",350300:"莆田市",350302:"城厢区",350303:"涵江区",350304:"荔城区",350305:"秀屿区",350322:"仙游县",350323:"其它区",350400:"三明市",350402:"梅列区",350403:"三元区",350421:"明溪县",350423:"清流县",350424:"宁化县",350425:"大田县",350426:"尤溪县",350427:"沙县",350428:"将乐县",350429:"泰宁县",350430:"建宁县",350481:"永安市",350482:"其它区",350500:"泉州市",350502:"鲤城区",350503:"丰泽区",350504:"洛江区",350505:"泉港区",350521:"惠安县",350524:"安溪县",350525:"永春县",350526:"德化县",350527:"金门县",350581:"石狮市",350582:"晋江市",350583:"南安市",350584:"其它区",350600:"漳州市",350602:"芗城区",350603:"龙文区",350622:"云霄县",350623:"漳浦县",350624:"诏安县",350625:"长泰县",350626:"东山县",350627:"南靖县",350628:"平和县",350629:"华安县",350681:"龙海市",350682:"其它区",350700:"南平市",350702:"延平区",350721:"顺昌县",350722:"浦城县",350723:"光泽县",350724:"松溪县",350725:"政和县",350781:"邵武市",350782:"武夷山市",350783:"建瓯市",350784:"建阳市",350785:"其它区",350800:"龙岩市",350802:"新罗区",350821:"长汀县",350822:"永定县",350823:"上杭县",350824:"武平县",350825:"连城县",350881:"漳平市",350882:"其它区",350900:"宁德市",350902:"蕉城区",350921:"霞浦县",350922:"古田县",350923:"屏南县",350924:"寿宁县",350925:"周宁县",350926:"柘荣县",350981:"福安市",350982:"福鼎市",350983:"其它区",36e4:"江西省",360100:"南昌市",360102:"东湖区",360103:"西湖区",360104:"青云谱区",360105:"湾里区",360111:"青山湖区",360121:"南昌县",360122:"新建县",360123:"安义县",360124:"进贤县",360128:"其它区",360200:"景德镇市",360202:"昌江区",360203:"珠山区",360222:"浮梁县",360281:"乐平市",360282:"其它区",360300:"萍乡市",360302:"安源区",360313:"湘东区",360321:"莲花县",360322:"上栗县",360323:"芦溪县",360324:"其它区",360400:"九江市",360402:"庐山区",360403:"浔阳区",360421:"九江县",360423:"武宁县",360424:"修水县",360425:"永修县",360426:"德安县",360427:"星子县",360428:"都昌县",360429:"湖口县",360430:"彭泽县",360481:"瑞昌市",360482:"其它区",360483:"共青城市",360500:"新余市",360502:"渝水区",360521:"分宜县",360522:"其它区",360600:"鹰潭市",360602:"月湖区",360622:"余江县",360681:"贵溪市",360682:"其它区",360700:"赣州市",360702:"章贡区",360721:"赣县",360722:"信丰县",360723:"大余县",360724:"上犹县",360725:"崇义县",360726:"安远县",360727:"龙南县",360728:"定南县",360729:"全南县",360730:"宁都县",360731:"于都县",360732:"兴国县",360733:"会昌县",360734:"寻乌县",360735:"石城县",360781:"瑞金市",360782:"南康市",360783:"其它区",360800:"吉安市",360802:"吉州区",360803:"青原区",360821:"吉安县",360822:"吉水县",360823:"峡江县",360824:"新干县",360825:"永丰县",360826:"泰和县",360827:"遂川县",360828:"万安县",360829:"安福县",360830:"永新县",360881:"井冈山市",360882:"其它区",360900:"宜春市",360902:"袁州区",360921:"奉新县",360922:"万载县",360923:"上高县",360924:"宜丰县",360925:"靖安县",360926:"铜鼓县",360981:"丰城市",360982:"樟树市",360983:"高安市",360984:"其它区",361e3:"抚州市",361002:"临川区",361021:"南城县",361022:"黎川县",361023:"南丰县",361024:"崇仁县",361025:"乐安县",361026:"宜黄县",361027:"金溪县",361028:"资溪县",361029:"东乡县",361030:"广昌县",361031:"其它区",361100:"上饶市",361102:"信州区",361121:"上饶县",361122:"广丰县",361123:"玉山县",361124:"铅山县",361125:"横峰县",361126:"弋阳县",361127:"余干县",361128:"鄱阳县",361129:"万年县",361130:"婺源县",361181:"德兴市",361182:"其它区",37e4:"山东省",370100:"济南市",370102:"历下区",370103:"市中区",370104:"槐荫区",370105:"天桥区",370112:"历城区",370113:"长清区",370124:"平阴县",370125:"济阳县",370126:"商河县",370181:"章丘市",370182:"其它区",370200:"青岛市",370202:"市南区",370203:"市北区",370211:"黄岛区",370212:"崂山区",370213:"李沧区",370214:"城阳区",370281:"胶州市",370282:"即墨市",370283:"平度市",370285:"莱西市",370286:"其它区",370300:"淄博市",370302:"淄川区",370303:"张店区",370304:"博山区",370305:"临淄区",370306:"周村区",370321:"桓台县",370322:"高青县",370323:"沂源县",370324:"其它区",370400:"枣庄市",370402:"市中区",370403:"薛城区",370404:"峄城区",370405:"台儿庄区",370406:"山亭区",370481:"滕州市",370482:"其它区",370500:"东营市",370502:"东营区",370503:"河口区",370521:"垦利县",370522:"利津县",370523:"广饶县",370591:"其它区",370600:"烟台市",370602:"芝罘区",370611:"福山区",370612:"牟平区",370613:"莱山区",370634:"长岛县",370681:"龙口市",370682:"莱阳市",370683:"莱州市",370684:"蓬莱市",370685:"招远市",370686:"栖霞市",370687:"海阳市",370688:"其它区",370700:"潍坊市",370702:"潍城区",370703:"寒亭区",370704:"坊子区",370705:"奎文区",370724:"临朐县",370725:"昌乐县",370781:"青州市",370782:"诸城市",370783:"寿光市",370784:"安丘市",370785:"高密市",370786:"昌邑市",370787:"其它区",370800:"济宁市",370802:"市中区",370811:"任城区",370826:"微山县",370827:"鱼台县",370828:"金乡县",370829:"嘉祥县",370830:"汶上县",370831:"泗水县",370832:"梁山县",370881:"曲阜市",370882:"兖州市",370883:"邹城市",370884:"其它区",370900:"泰安市",370902:"泰山区",370903:"岱岳区",370921:"宁阳县",370923:"东平县",370982:"新泰市",370983:"肥城市",370984:"其它区",371e3:"威海市",371002:"环翠区",371081:"文登市",371082:"荣成市",371083:"乳山市",371084:"其它区",371100:"日照市",371102:"东港区",371103:"岚山区",371121:"五莲县",371122:"莒县",371123:"其它区",371200:"莱芜市",371202:"莱城区",371203:"钢城区",371204:"其它区",371300:"临沂市",371302:"兰山区",371311:"罗庄区",371312:"河东区",371321:"沂南县",371322:"郯城县",371323:"沂水县",371324:"苍山县",371325:"费县",371326:"平邑县",371327:"莒南县",371328:"蒙阴县",371329:"临沭县",371330:"其它区",371400:"德州市",371402:"德城区",371421:"陵县",371422:"宁津县",371423:"庆云县",371424:"临邑县",371425:"齐河县",371426:"平原县",371427:"夏津县",371428:"武城县",371481:"乐陵市",371482:"禹城市",371483:"其它区",371500:"聊城市",371502:"东昌府区",371521:"阳谷县",371522:"莘县",371523:"茌平县",371524:"东阿县",371525:"冠县",371526:"高唐县",371581:"临清市",371582:"其它区",371600:"滨州市",371602:"滨城区",371621:"惠民县",371622:"阳信县",371623:"无棣县",371624:"沾化县",371625:"博兴县",371626:"邹平县",371627:"其它区",371700:"菏泽市",371702:"牡丹区",371721:"曹县",371722:"单县",371723:"成武县",371724:"巨野县",371725:"郓城县",371726:"鄄城县",371727:"定陶县",371728:"东明县",371729:"其它区",41e4:"河南省",410100:"郑州市",410102:"中原区",410103:"二七区",410104:"管城回族区",410105:"金水区",410106:"上街区",410108:"惠济区",410122:"中牟县",410181:"巩义市",410182:"荥阳市",410183:"新密市",410184:"新郑市",410185:"登封市",410188:"其它区",410200:"开封市",410202:"龙亭区",410203:"顺河回族区",410204:"鼓楼区",410205:"禹王台区",410211:"金明区",410221:"杞县",410222:"通许县",410223:"尉氏县",410224:"开封县",410225:"兰考县",410226:"其它区",410300:"洛阳市",410302:"老城区",410303:"西工区",410304:"瀍河回族区",410305:"涧西区",410306:"吉利区",410307:"洛龙区",410322:"孟津县",410323:"新安县",410324:"栾川县",410325:"嵩县",410326:"汝阳县",410327:"宜阳县",410328:"洛宁县",410329:"伊川县",410381:"偃师市",410400:"平顶山市",410402:"新华区",410403:"卫东区",410404:"石龙区",410411:"湛河区",410421:"宝丰县",410422:"叶县",410423:"鲁山县",410425:"郏县",410481:"舞钢市",410482:"汝州市",410483:"其它区",410500:"安阳市",410502:"文峰区",410503:"北关区",410505:"殷都区",410506:"龙安区",410522:"安阳县",410523:"汤阴县",410526:"滑县",410527:"内黄县",410581:"林州市",410582:"其它区",410600:"鹤壁市",410602:"鹤山区",410603:"山城区",410611:"淇滨区",410621:"浚县",410622:"淇县",410623:"其它区",410700:"新乡市",410702:"红旗区",410703:"卫滨区",410704:"凤泉区",410711:"牧野区",410721:"新乡县",410724:"获嘉县",410725:"原阳县",410726:"延津县",410727:"封丘县",410728:"长垣县",410781:"卫辉市",410782:"辉县市",410783:"其它区",410800:"焦作市",410802:"解放区",410803:"中站区",410804:"马村区",410811:"山阳区",410821:"修武县",410822:"博爱县",410823:"武陟县",410825:"温县",410881:"济源市",410882:"沁阳市",410883:"孟州市",410884:"其它区",410900:"濮阳市",410902:"华龙区",410922:"清丰县",410923:"南乐县",410926:"范县",410927:"台前县",410928:"濮阳县",410929:"其它区",411e3:"许昌市",411002:"魏都区",411023:"许昌县",411024:"鄢陵县",411025:"襄城县",411081:"禹州市",411082:"长葛市",411083:"其它区",411100:"漯河市",411102:"源汇区",411103:"郾城区",411104:"召陵区",411121:"舞阳县",411122:"临颍县",411123:"其它区",411200:"三门峡市",411202:"湖滨区",411221:"渑池县",411222:"陕县",411224:"卢氏县",411281:"义马市",411282:"灵宝市",411283:"其它区",411300:"南阳市",411302:"宛城区",411303:"卧龙区",411321:"南召县",411322:"方城县",411323:"西峡县",411324:"镇平县",411325:"内乡县",411326:"淅川县",411327:"社旗县",411328:"唐河县",411329:"新野县",411330:"桐柏县",411381:"邓州市",411382:"其它区",411400:"商丘市",411402:"梁园区",411403:"睢阳区",411421:"民权县",411422:"睢县",411423:"宁陵县",411424:"柘城县",411425:"虞城县",411426:"夏邑县",411481:"永城市",411482:"其它区",411500:"信阳市",411502:"浉河区",411503:"平桥区",411521:"罗山县",411522:"光山县",411523:"新县",411524:"商城县",411525:"固始县",411526:"潢川县",411527:"淮滨县",411528:"息县",411529:"其它区",411600:"周口市",411602:"川汇区",411621:"扶沟县",411622:"西华县",411623:"商水县",411624:"沈丘县",411625:"郸城县",411626:"淮阳县",411627:"太康县",411628:"鹿邑县",411681:"项城市",411682:"其它区",411700:"驻马店市",411702:"驿城区",411721:"西平县",411722:"上蔡县",411723:"平舆县",411724:"正阳县",411725:"确山县",411726:"泌阳县",411727:"汝南县",411728:"遂平县",411729:"新蔡县",411730:"其它区",42e4:"湖北省",420100:"武汉市",420102:"江岸区",420103:"江汉区",420104:"硚口区",420105:"汉阳区",420106:"武昌区",420107:"青山区",420111:"洪山区",420112:"东西湖区",420113:"汉南区",420114:"蔡甸区",420115:"江夏区",420116:"黄陂区",420117:"新洲区",420118:"其它区",420200:"黄石市",420202:"黄石港区",420203:"西塞山区",420204:"下陆区",420205:"铁山区",420222:"阳新县",420281:"大冶市",420282:"其它区",420300:"十堰市",420302:"茅箭区",420303:"张湾区",420321:"郧县",420322:"郧西县",420323:"竹山县",420324:"竹溪县",420325:"房县",420381:"丹江口市",420383:"其它区",420500:"宜昌市",420502:"西陵区",420503:"伍家岗区",420504:"点军区",420505:"猇亭区",420506:"夷陵区",420525:"远安县",420526:"兴山县",420527:"秭归县",420528:"长阳土家族自治县",420529:"五峰土家族自治县",420581:"宜都市",420582:"当阳市",420583:"枝江市",420584:"其它区",420600:"襄阳市",420602:"襄城区",420606:"樊城区",420607:"襄州区",420624:"南漳县",420625:"谷城县",420626:"保康县",420682:"老河口市",420683:"枣阳市",420684:"宜城市",420685:"其它区",420700:"鄂州市",420702:"梁子湖区",420703:"华容区",420704:"鄂城区",420705:"其它区",420800:"荆门市",420802:"东宝区",420804:"掇刀区",420821:"京山县",420822:"沙洋县",420881:"钟祥市",420882:"其它区",420900:"孝感市",420902:"孝南区",420921:"孝昌县",420922:"大悟县",420923:"云梦县",420981:"应城市",420982:"安陆市",420984:"汉川市",420985:"其它区",421e3:"荆州市",421002:"沙市区",421003:"荆州区",421022:"公安县",421023:"监利县",421024:"江陵县",421081:"石首市",421083:"洪湖市",421087:"松滋市",421088:"其它区",421100:"黄冈市",421102:"黄州区",421121:"团风县",421122:"红安县",421123:"罗田县",421124:"英山县",421125:"浠水县",421126:"蕲春县",421127:"黄梅县",421181:"麻城市",421182:"武穴市",421183:"其它区",421200:"咸宁市",421202:"咸安区",421221:"嘉鱼县",421222:"通城县",421223:"崇阳县",421224:"通山县",421281:"赤壁市",421283:"其它区",421300:"随州市",421302:"曾都区",421321:"随县",421381:"广水市",421382:"其它区",422800:"恩施土家族苗族自治州",422801:"恩施市",422802:"利川市",422822:"建始县",422823:"巴东县",422825:"宣恩县",422826:"咸丰县",422827:"来凤县",422828:"鹤峰县",422829:"其它区",429004:"仙桃市",429005:"潜江市",429006:"天门市",429021:"神农架林区",43e4:"湖南省",430100:"长沙市",430102:"芙蓉区",430103:"天心区",430104:"岳麓区",430105:"开福区",430111:"雨花区",430121:"长沙县",430122:"望城区",430124:"宁乡县",430181:"浏阳市",430182:"其它区",430200:"株洲市",430202:"荷塘区",430203:"芦淞区",430204:"石峰区",430211:"天元区",430221:"株洲县",430223:"攸县",430224:"茶陵县",430225:"炎陵县",430281:"醴陵市",430282:"其它区",430300:"湘潭市",430302:"雨湖区",430304:"岳塘区",430321:"湘潭县",430381:"湘乡市",430382:"韶山市",430383:"其它区",430400:"衡阳市",430405:"珠晖区",430406:"雁峰区",430407:"石鼓区",430408:"蒸湘区",430412:"南岳区",430421:"衡阳县",430422:"衡南县",430423:"衡山县",430424:"衡东县",430426:"祁东县",430481:"耒阳市",430482:"常宁市",430483:"其它区",430500:"邵阳市",430502:"双清区",430503:"大祥区",430511:"北塔区",430521:"邵东县",430522:"新邵县",430523:"邵阳县",430524:"隆回县",430525:"洞口县",430527:"绥宁县",430528:"新宁县",430529:"城步苗族自治县",430581:"武冈市",430582:"其它区",430600:"岳阳市",430602:"岳阳楼区",430603:"云溪区",430611:"君山区",430621:"岳阳县",430623:"华容县",430624:"湘阴县",430626:"平江县",430681:"汨罗市",430682:"临湘市",430683:"其它区",430700:"常德市",430702:"武陵区",430703:"鼎城区",430721:"安乡县",430722:"汉寿县",430723:"澧县",430724:"临澧县",430725:"桃源县",430726:"石门县",430781:"津市市",430782:"其它区",430800:"张家界市",430802:"永定区",430811:"武陵源区",430821:"慈利县",430822:"桑植县",430823:"其它区",430900:"益阳市",430902:"资阳区",430903:"赫山区",430921:"南县",430922:"桃江县",430923:"安化县",430981:"沅江市",430982:"其它区",431e3:"郴州市",431002:"北湖区",431003:"苏仙区",431021:"桂阳县",431022:"宜章县",431023:"永兴县",431024:"嘉禾县",431025:"临武县",431026:"汝城县",431027:"桂东县",431028:"安仁县",431081:"资兴市",431082:"其它区",431100:"永州市",431102:"零陵区",431103:"冷水滩区",431121:"祁阳县",431122:"东安县",431123:"双牌县",431124:"道县",431125:"江永县",431126:"宁远县",431127:"蓝山县",431128:"新田县",431129:"江华瑶族自治县",431130:"其它区",431200:"怀化市",431202:"鹤城区",431221:"中方县",431222:"沅陵县",431223:"辰溪县",431224:"溆浦县",431225:"会同县",431226:"麻阳苗族自治县",431227:"新晃侗族自治县",431228:"芷江侗族自治县",431229:"靖州苗族侗族自治县",431230:"通道侗族自治县",431281:"洪江市",431282:"其它区",431300:"娄底市",431302:"娄星区",431321:"双峰县",431322:"新化县",431381:"冷水江市",431382:"涟源市",431383:"其它区",433100:"湘西土家族苗族自治州",433101:"吉首市",433122:"泸溪县",433123:"凤凰县",433124:"花垣县",433125:"保靖县",433126:"古丈县",433127:"永顺县",433130:"龙山县",433131:"其它区",44e4:"广东省",440100:"广州市",440103:"荔湾区",440104:"越秀区",440105:"海珠区",440106:"天河区",440111:"白云区",440112:"黄埔区",440113:"番禺区",440114:"花都区",440115:"南沙区",440116:"萝岗区",440183:"增城市",440184:"从化市",440189:"其它区",440200:"韶关市",440203:"武江区",440204:"浈江区",440205:"曲江区",440222:"始兴县",440224:"仁化县",440229:"翁源县",440232:"乳源瑶族自治县",440233:"新丰县",440281:"乐昌市",440282:"南雄市",440283:"其它区",440300:"深圳市",440303:"罗湖区",440304:"福田区",440305:"南山区",440306:"宝安区",440307:"龙岗区",440308:"盐田区",440309:"其它区",440320:"光明新区",440321:"坪山新区",440322:"大鹏新区",440323:"龙华新区",440400:"珠海市",440402:"香洲区",440403:"斗门区",440404:"金湾区",440488:"其它区",440500:"汕头市",440507:"龙湖区",440511:"金平区",440512:"濠江区",440513:"潮阳区",440514:"潮南区",440515:"澄海区",440523:"南澳县",440524:"其它区",440600:"佛山市",440604:"禅城区",440605:"南海区",440606:"顺德区",440607:"三水区",440608:"高明区",440609:"其它区",440700:"江门市",440703:"蓬江区",440704:"江海区",440705:"新会区",440781:"台山市",440783:"开平市",440784:"鹤山市",440785:"恩平市",440786:"其它区",440800:"湛江市",440802:"赤坎区",440803:"霞山区",440804:"坡头区",440811:"麻章区",440823:"遂溪县",440825:"徐闻县",440881:"廉江市",440882:"雷州市",440883:"吴川市",440884:"其它区",440900:"茂名市",440902:"茂南区",440903:"茂港区",440923:"电白县",440981:"高州市",440982:"化州市",440983:"信宜市",440984:"其它区",441200:"肇庆市",441202:"端州区",441203:"鼎湖区",441223:"广宁县",441224:"怀集县",441225:"封开县",441226:"德庆县",441283:"高要市",441284:"四会市",441285:"其它区",441300:"惠州市",441302:"惠城区",441303:"惠阳区",441322:"博罗县",441323:"惠东县",441324:"龙门县",441325:"其它区",441400:"梅州市",441402:"梅江区",441421:"梅县",441422:"大埔县",441423:"丰顺县",441424:"五华县",441426:"平远县",441427:"蕉岭县",441481:"兴宁市",441482:"其它区",441500:"汕尾市",441502:"城区",441521:"海丰县",441523:"陆河县",441581:"陆丰市",441582:"其它区",441600:"河源市",441602:"源城区",441621:"紫金县",441622:"龙川县",441623:"连平县",441624:"和平县",441625:"东源县",441626:"其它区",441700:"阳江市",441702:"江城区",441721:"阳西县",441723:"阳东县",441781:"阳春市",441782:"其它区",441800:"清远市",441802:"清城区",441821:"佛冈县",441823:"阳山县",441825:"连山壮族瑶族自治县",441826:"连南瑶族自治县",441827:"清新区",441881:"英德市",441882:"连州市",441883:"其它区",441900:"东莞市",442e3:"中山市",442101:"东沙群岛",445100:"潮州市",445102:"湘桥区",445121:"潮安区",445122:"饶平县",445186:"其它区",445200:"揭阳市",445202:"榕城区",445221:"揭东区",445222:"揭西县",445224:"惠来县",445281:"普宁市",445285:"其它区",445300:"云浮市",445302:"云城区",445321:"新兴县",445322:"郁南县",445323:"云安县",445381:"罗定市",445382:"其它区",45e4:"广西壮族自治区",450100:"南宁市",450102:"兴宁区",450103:"青秀区",450105:"江南区",450107:"西乡塘区",450108:"良庆区",450109:"邕宁区",450122:"武鸣县",450123:"隆安县",450124:"马山县",450125:"上林县",450126:"宾阳县",450127:"横县",450128:"其它区",450200:"柳州市",450202:"城中区",450203:"鱼峰区",450204:"柳南区",450205:"柳北区",450221:"柳江县",450222:"柳城县",450223:"鹿寨县",450224:"融安县",450225:"融水苗族自治县",450226:"三江侗族自治县",450227:"其它区",450300:"桂林市",450302:"秀峰区",450303:"叠彩区",450304:"象山区",450305:"七星区",450311:"雁山区",450321:"阳朔县",450322:"临桂区",450323:"灵川县",450324:"全州县",450325:"兴安县",450326:"永福县",450327:"灌阳县",450328:"龙胜各族自治县",450329:"资源县",450330:"平乐县",450331:"荔浦县",450332:"恭城瑶族自治县",450333:"其它区",450400:"梧州市",450403:"万秀区",450405:"长洲区",450406:"龙圩区",450421:"苍梧县",450422:"藤县",450423:"蒙山县",450481:"岑溪市",450482:"其它区",450500:"北海市",450502:"海城区",450503:"银海区",450512:"铁山港区",450521:"合浦县",450522:"其它区",450600:"防城港市",450602:"港口区",450603:"防城区",450621:"上思县",450681:"东兴市",450682:"其它区",450700:"钦州市",450702:"钦南区",450703:"钦北区",450721:"灵山县",450722:"浦北县",450723:"其它区",450800:"贵港市",450802:"港北区",450803:"港南区",450804:"覃塘区",450821:"平南县",450881:"桂平市",450882:"其它区",450900:"玉林市",450902:"玉州区",450903:"福绵区",450921:"容县",450922:"陆川县",450923:"博白县",450924:"兴业县",450981:"北流市",450982:"其它区",451e3:"百色市",451002:"右江区",451021:"田阳县",451022:"田东县",451023:"平果县",451024:"德保县",451025:"靖西县",451026:"那坡县",451027:"凌云县",451028:"乐业县",451029:"田林县",451030:"西林县",451031:"隆林各族自治县",451032:"其它区",451100:"贺州市",451102:"八步区",451119:"平桂管理区",451121:"昭平县",451122:"钟山县",451123:"富川瑶族自治县",451124:"其它区",451200:"河池市",451202:"金城江区",451221:"南丹县",451222:"天峨县",451223:"凤山县",451224:"东兰县",451225:"罗城仫佬族自治县",451226:"环江毛南族自治县",451227:"巴马瑶族自治县",451228:"都安瑶族自治县",451229:"大化瑶族自治县",451281:"宜州市",451282:"其它区",451300:"来宾市",451302:"兴宾区",451321:"忻城县",451322:"象州县",451323:"武宣县",451324:"金秀瑶族自治县",451381:"合山市",451382:"其它区",451400:"崇左市",451402:"江州区",451421:"扶绥县",451422:"宁明县",451423:"龙州县",451424:"大新县",451425:"天等县",451481:"凭祥市",451482:"其它区",46e4:"海南省",460100:"海口市",460105:"秀英区",460106:"龙华区",460107:"琼山区",460108:"美兰区",460109:"其它区",460200:"三亚市",460300:"三沙市",460321:"西沙群岛",460322:"南沙群岛",460323:"中沙群岛的岛礁及其海域",469001:"五指山市",469002:"琼海市",469003:"儋州市",469005:"文昌市",469006:"万宁市",469007:"东方市",469025:"定安县",469026:"屯昌县",469027:"澄迈县",469028:"临高县",469030:"白沙黎族自治县",469031:"昌江黎族自治县",469033:"乐东黎族自治县",469034:"陵水黎族自治县",469035:"保亭黎族苗族自治县",469036:"琼中黎族苗族自治县",471005:"其它区",5e5:"重庆",500100:"重庆市",500101:"万州区",500102:"涪陵区",500103:"渝中区",500104:"大渡口区",500105:"江北区",500106:"沙坪坝区",500107:"九龙坡区",500108:"南岸区",500109:"北碚区",500110:"万盛区",500111:"双桥区",500112:"渝北区",500113:"巴南区",500114:"黔江区",500115:"长寿区",500222:"綦江区",500223:"潼南县",500224:"铜梁县",500225:"大足区",500226:"荣昌县",500227:"璧山县",500228:"梁平县",500229:"城口县",500230:"丰都县",500231:"垫江县",500232:"武隆县",500233:"忠县",500234:"开县",500235:"云阳县",500236:"奉节县",500237:"巫山县",500238:"巫溪县",500240:"石柱土家族自治县",500241:"秀山土家族苗族自治县",500242:"酉阳土家族苗族自治县",500243:"彭水苗族土家族自治县",500381:"江津区",500382:"合川区",500383:"永川区",500384:"南川区",500385:"其它区",51e4:"四川省",510100:"成都市",510104:"锦江区",510105:"青羊区",510106:"金牛区",510107:"武侯区",510108:"成华区",510112:"龙泉驿区",510113:"青白江区",510114:"新都区",510115:"温江区",510121:"金堂县",510122:"双流县",510124:"郫县",510129:"大邑县",510131:"蒲江县",510132:"新津县",510181:"都江堰市",510182:"彭州市",510183:"邛崃市",510184:"崇州市",510185:"其它区",510300:"自贡市",510302:"自流井区",510303:"贡井区",510304:"大安区",510311:"沿滩区",510321:"荣县",510322:"富顺县",510323:"其它区",510400:"攀枝花市",510402:"东区",510403:"西区",510411:"仁和区",510421:"米易县",510422:"盐边县",510423:"其它区",510500:"泸州市",510502:"江阳区",510503:"纳溪区",510504:"龙马潭区",510521:"泸县",510522:"合江县",510524:"叙永县",510525:"古蔺县",510526:"其它区",510600:"德阳市",510603:"旌阳区",510623:"中江县",510626:"罗江县",510681:"广汉市",510682:"什邡市",510683:"绵竹市",510684:"其它区",510700:"绵阳市",510703:"涪城区",510704:"游仙区",510722:"三台县",510723:"盐亭县",510724:"安县",510725:"梓潼县",510726:"北川羌族自治县",510727:"平武县",510781:"江油市",510782:"其它区",510800:"广元市",510802:"利州区",510811:"昭化区",510812:"朝天区",510821:"旺苍县",510822:"青川县",510823:"剑阁县",510824:"苍溪县",510825:"其它区",510900:"遂宁市",510903:"船山区",510904:"安居区",510921:"蓬溪县",510922:"射洪县",510923:"大英县",510924:"其它区",511e3:"内江市",511002:"市中区",511011:"东兴区",511024:"威远县",511025:"资中县",511028:"隆昌县",511029:"其它区",511100:"乐山市",511102:"市中区",511111:"沙湾区",511112:"五通桥区",511113:"金口河区",511123:"犍为县",511124:"井研县",511126:"夹江县",511129:"沐川县",511132:"峨边彝族自治县",511133:"马边彝族自治县",511181:"峨眉山市",511182:"其它区",511300:"南充市",511302:"顺庆区",511303:"高坪区",511304:"嘉陵区",511321:"南部县",511322:"营山县",511323:"蓬安县",511324:"仪陇县",511325:"西充县",511381:"阆中市",511382:"其它区",511400:"眉山市",511402:"东坡区",511421:"仁寿县",511422:"彭山县",511423:"洪雅县",511424:"丹棱县",511425:"青神县",511426:"其它区",511500:"宜宾市",511502:"翠屏区",511521:"宜宾县",511522:"南溪区",511523:"江安县",511524:"长宁县",511525:"高县",511526:"珙县",511527:"筠连县",511528:"兴文县",511529:"屏山县",511530:"其它区",511600:"广安市",511602:"广安区",511603:"前锋区",511621:"岳池县",511622:"武胜县",511623:"邻水县",511681:"华蓥市",511683:"其它区",511700:"达州市",511702:"通川区",511721:"达川区",511722:"宣汉县",511723:"开江县",511724:"大竹县",511725:"渠县",511781:"万源市",511782:"其它区",511800:"雅安市",511802:"雨城区",511821:"名山区",511822:"荥经县",511823:"汉源县",511824:"石棉县",511825:"天全县",511826:"芦山县",511827:"宝兴县",511828:"其它区",511900:"巴中市",511902:"巴州区",511903:"恩阳区",511921:"通江县",511922:"南江县",511923:"平昌县",511924:"其它区",512e3:"资阳市",512002:"雁江区",512021:"安岳县",512022:"乐至县",512081:"简阳市",512082:"其它区",513200:"阿坝藏族羌族自治州",513221:"汶川县",513222:"理县",513223:"茂县",513224:"松潘县",513225:"九寨沟县",513226:"金川县",513227:"小金县",513228:"黑水县",513229:"马尔康县",513230:"壤塘县",513231:"阿坝县",513232:"若尔盖县",513233:"红原县",513234:"其它区",513300:"甘孜藏族自治州",513321:"康定县",513322:"泸定县",513323:"丹巴县",513324:"九龙县",513325:"雅江县",513326:"道孚县",513327:"炉霍县",513328:"甘孜县",513329:"新龙县",513330:"德格县",513331:"白玉县",513332:"石渠县",513333:"色达县",513334:"理塘县",513335:"巴塘县",513336:"乡城县",513337:"稻城县",513338:"得荣县",513339:"其它区",513400:"凉山彝族自治州",513401:"西昌市",513422:"木里藏族自治县",513423:"盐源县",513424:"德昌县",513425:"会理县",513426:"会东县",513427:"宁南县",513428:"普格县",513429:"布拖县",513430:"金阳县",513431:"昭觉县",513432:"喜德县",513433:"冕宁县",513434:"越西县",513435:"甘洛县",513436:"美姑县",513437:"雷波县",513438:"其它区",52e4:"贵州省",520100:"贵阳市",520102:"南明区",520103:"云岩区",520111:"花溪区",520112:"乌当区",520113:"白云区",520121:"开阳县",520122:"息烽县",520123:"修文县",520151:"观山湖区",520181:"清镇市",520182:"其它区",520200:"六盘水市",520201:"钟山区",520203:"六枝特区",520221:"水城县",520222:"盘县",520223:"其它区",520300:"遵义市",520302:"红花岗区",520303:"汇川区",520321:"遵义县",520322:"桐梓县",520323:"绥阳县",520324:"正安县",520325:"道真仡佬族苗族自治县",520326:"务川仡佬族苗族自治县",520327:"凤冈县",520328:"湄潭县",520329:"余庆县",520330:"习水县",520381:"赤水市",520382:"仁怀市",520383:"其它区",520400:"安顺市",520402:"西秀区",520421:"平坝县",520422:"普定县",520423:"镇宁布依族苗族自治县",520424:"关岭布依族苗族自治县",520425:"紫云苗族布依族自治县",520426:"其它区",522200:"铜仁市",522201:"碧江区",522222:"江口县",522223:"玉屏侗族自治县",522224:"石阡县",522225:"思南县",522226:"印江土家族苗族自治县",522227:"德江县",522228:"沿河土家族自治县",522229:"松桃苗族自治县",522230:"万山区",522231:"其它区",522300:"黔西南布依族苗族自治州",522301:"兴义市",522322:"兴仁县",522323:"普安县",522324:"晴隆县",522325:"贞丰县",522326:"望谟县",522327:"册亨县",522328:"安龙县",522329:"其它区",522400:"毕节市",522401:"七星关区",522422:"大方县",522423:"黔西县",522424:"金沙县",522425:"织金县",522426:"纳雍县",522427:"威宁彝族回族苗族自治县",522428:"赫章县",522429:"其它区",522600:"黔东南苗族侗族自治州",522601:"凯里市",522622:"黄平县",522623:"施秉县",522624:"三穗县",522625:"镇远县",522626:"岑巩县",522627:"天柱县",522628:"锦屏县",522629:"剑河县",522630:"台江县",522631:"黎平县",522632:"榕江县",522633:"从江县",522634:"雷山县",522635:"麻江县",522636:"丹寨县",522637:"其它区",522700:"黔南布依族苗族自治州",522701:"都匀市",522702:"福泉市",522722:"荔波县",522723:"贵定县",522725:"瓮安县",522726:"独山县",522727:"平塘县",522728:"罗甸县",522729:"长顺县",522730:"龙里县",522731:"惠水县",522732:"三都水族自治县",522733:"其它区",53e4:"云南省",530100:"昆明市",530102:"五华区",530103:"盘龙区",530111:"官渡区",530112:"西山区",530113:"东川区",530121:"呈贡区",530122:"晋宁县",530124:"富民县",530125:"宜良县",530126:"石林彝族自治县",530127:"嵩明县",530128:"禄劝彝族苗族自治县",530129:"寻甸回族彝族自治县",530181:"安宁市",530182:"其它区",530300:"曲靖市",530302:"麒麟区",530321:"马龙县",530322:"陆良县",530323:"师宗县",530324:"罗平县",530325:"富源县",530326:"会泽县",530328:"沾益县",530381:"宣威市",530382:"其它区",530400:"玉溪市",530402:"红塔区",530421:"江川县",530422:"澄江县",530423:"通海县",530424:"华宁县",530425:"易门县",530426:"峨山彝族自治县",530427:"新平彝族傣族自治县",530428:"元江哈尼族彝族傣族自治县",530429:"其它区",530500:"保山市",530502:"隆阳区",530521:"施甸县",530522:"腾冲县",530523:"龙陵县",530524:"昌宁县",530525:"其它区",530600:"昭通市",530602:"昭阳区",530621:"鲁甸县",530622:"巧家县",530623:"盐津县",530624:"大关县",530625:"永善县",530626:"绥江县",530627:"镇雄县",530628:"彝良县",530629:"威信县",530630:"水富县",530631:"其它区",530700:"丽江市",530702:"古城区",530721:"玉龙纳西族自治县",530722:"永胜县",530723:"华坪县",530724:"宁蒗彝族自治县",530725:"其它区",530800:"普洱市",530802:"思茅区",530821:"宁洱哈尼族彝族自治县",530822:"墨江哈尼族自治县",530823:"景东彝族自治县",530824:"景谷傣族彝族自治县",530825:"镇沅彝族哈尼族拉祜族自治县",530826:"江城哈尼族彝族自治县",530827:"孟连傣族拉祜族佤族自治县",530828:"澜沧拉祜族自治县",530829:"西盟佤族自治县",530830:"其它区",530900:"临沧市",530902:"临翔区",530921:"凤庆县",530922:"云县",530923:"永德县",530924:"镇康县",530925:"双江拉祜族佤族布朗族傣族自治县",530926:"耿马傣族佤族自治县",530927:"沧源佤族自治县",530928:"其它区",532300:"楚雄彝族自治州",532301:"楚雄市",532322:"双柏县",532323:"牟定县",532324:"南华县",532325:"姚安县",532326:"大姚县",532327:"永仁县",532328:"元谋县",532329:"武定县",532331:"禄丰县",532332:"其它区",532500:"红河哈尼族彝族自治州",532501:"个旧市",532502:"开远市",532522:"蒙自市",532523:"屏边苗族自治县",532524:"建水县",532525:"石屏县",532526:"弥勒市",532527:"泸西县",532528:"元阳县",532529:"红河县",532530:"金平苗族瑶族傣族自治县",532531:"绿春县",532532:"河口瑶族自治县",532533:"其它区",532600:"文山壮族苗族自治州",532621:"文山市",532622:"砚山县",532623:"西畴县",532624:"麻栗坡县",532625:"马关县",532626:"丘北县",532627:"广南县",532628:"富宁县",532629:"其它区",532800:"西双版纳傣族自治州",532801:"景洪市",532822:"勐海县",532823:"勐腊县",532824:"其它区",532900:"大理白族自治州",532901:"大理市",532922:"漾濞彝族自治县",532923:"祥云县",532924:"宾川县",532925:"弥渡县",532926:"南涧彝族自治县",532927:"巍山彝族回族自治县",532928:"永平县",532929:"云龙县",532930:"洱源县",532931:"剑川县",532932:"鹤庆县",532933:"其它区",533100:"德宏傣族景颇族自治州",533102:"瑞丽市",533103:"芒市",533122:"梁河县",533123:"盈江县",533124:"陇川县",533125:"其它区",533300:"怒江傈僳族自治州",533321:"泸水县",533323:"福贡县",533324:"贡山独龙族怒族自治县",533325:"兰坪白族普米族自治县",533326:"其它区",533400:"迪庆藏族自治州",533421:"香格里拉县",533422:"德钦县",533423:"维西傈僳族自治县",533424:"其它区",54e4:"西藏自治区",540100:"拉萨市",540102:"城关区",540121:"林周县",540122:"当雄县",540123:"尼木县",540124:"曲水县",540125:"堆龙德庆县",540126:"达孜县",540127:"墨竹工卡县",540128:"其它区",542100:"昌都地区",542121:"昌都县",542122:"江达县",542123:"贡觉县",542124:"类乌齐县",542125:"丁青县",542126:"察雅县",542127:"八宿县",542128:"左贡县",542129:"芒康县",542132:"洛隆县",542133:"边坝县",542134:"其它区",542200:"山南地区",542221:"乃东县",542222:"扎囊县",542223:"贡嘎县",542224:"桑日县",542225:"琼结县",542226:"曲松县",542227:"措美县",542228:"洛扎县",542229:"加查县",542231:"隆子县",542232:"错那县",542233:"浪卡子县",542234:"其它区",542300:"日喀则地区",542301:"日喀则市",542322:"南木林县",542323:"江孜县",542324:"定日县",542325:"萨迦县",542326:"拉孜县",542327:"昂仁县",542328:"谢通门县",542329:"白朗县",542330:"仁布县",542331:"康马县",542332:"定结县",542333:"仲巴县",542334:"亚东县",542335:"吉隆县",542336:"聂拉木县",542337:"萨嘎县",542338:"岗巴县",542339:"其它区",542400:"那曲地区",542421:"那曲县",542422:"嘉黎县",542423:"比如县",542424:"聂荣县",542425:"安多县",542426:"申扎县",542427:"索县",542428:"班戈县",542429:"巴青县",542430:"尼玛县",542431:"其它区",542432:"双湖县",542500:"阿里地区",542521:"普兰县",542522:"札达县",542523:"噶尔县",542524:"日土县",542525:"革吉县",542526:"改则县",542527:"措勤县",542528:"其它区",542600:"林芝地区",542621:"林芝县",542622:"工布江达县",542623:"米林县",542624:"墨脱县",542625:"波密县",542626:"察隅县",542627:"朗县",542628:"其它区",61e4:"陕西省",610100:"西安市",610102:"新城区",610103:"碑林区",610104:"莲湖区",610111:"灞桥区",610112:"未央区",610113:"雁塔区",610114:"阎良区",610115:"临潼区",610116:"长安区",610122:"蓝田县",610124:"周至县",610125:"户县",610126:"高陵县",610127:"其它区",610200:"铜川市",610202:"王益区",610203:"印台区",610204:"耀州区",610222:"宜君县",610223:"其它区",610300:"宝鸡市",610302:"渭滨区",610303:"金台区",610304:"陈仓区",610322:"凤翔县",610323:"岐山县",610324:"扶风县",610326:"眉县",610327:"陇县",610328:"千阳县",610329:"麟游县",610330:"凤县",610331:"太白县",610332:"其它区",610400:"咸阳市",610402:"秦都区",610403:"杨陵区",610404:"渭城区",610422:"三原县",610423:"泾阳县",610424:"乾县",610425:"礼泉县",610426:"永寿县",610427:"彬县",610428:"长武县",610429:"旬邑县",610430:"淳化县",610431:"武功县",610481:"兴平市",610482:"其它区",610500:"渭南市",610502:"临渭区",610521:"华县",610522:"潼关县",610523:"大荔县",610524:"合阳县",610525:"澄城县",610526:"蒲城县",610527:"白水县",610528:"富平县",610581:"韩城市",610582:"华阴市",610583:"其它区",610600:"延安市",610602:"宝塔区",610621:"延长县",610622:"延川县",610623:"子长县",610624:"安塞县",610625:"志丹县",610626:"吴起县",610627:"甘泉县",610628:"富县",610629:"洛川县",610630:"宜川县",610631:"黄龙县",610632:"黄陵县",610633:"其它区",610700:"汉中市",610702:"汉台区",610721:"南郑县",610722:"城固县",610723:"洋县",610724:"西乡县",610725:"勉县",610726:"宁强县",610727:"略阳县",610728:"镇巴县",610729:"留坝县",610730:"佛坪县",610731:"其它区",610800:"榆林市",610802:"榆阳区",610821:"神木县",610822:"府谷县",610823:"横山县",610824:"靖边县",610825:"定边县",610826:"绥德县",610827:"米脂县",610828:"佳县",610829:"吴堡县",610830:"清涧县",610831:"子洲县",610832:"其它区",610900:"安康市",610902:"汉滨区",610921:"汉阴县",610922:"石泉县",610923:"宁陕县",610924:"紫阳县",610925:"岚皋县",610926:"平利县",610927:"镇坪县",610928:"旬阳县",610929:"白河县",610930:"其它区",611e3:"商洛市",611002:"商州区",611021:"洛南县",611022:"丹凤县",611023:"商南县",611024:"山阳县",611025:"镇安县",611026:"柞水县",611027:"其它区",62e4:"甘肃省",620100:"兰州市",620102:"城关区",620103:"七里河区",620104:"西固区",620105:"安宁区",620111:"红古区",620121:"永登县",620122:"皋兰县",620123:"榆中县",620124:"其它区",620200:"嘉峪关市",620300:"金昌市",620302:"金川区",620321:"永昌县",620322:"其它区",620400:"白银市",620402:"白银区",620403:"平川区",620421:"靖远县",620422:"会宁县",620423:"景泰县",620424:"其它区",620500:"天水市",620502:"秦州区",620503:"麦积区",620521:"清水县",620522:"秦安县",620523:"甘谷县",620524:"武山县",620525:"张家川回族自治县",620526:"其它区",620600:"武威市",620602:"凉州区",620621:"民勤县",620622:"古浪县",620623:"天祝藏族自治县",620624:"其它区",620700:"张掖市",620702:"甘州区",620721:"肃南裕固族自治县",620722:"民乐县",620723:"临泽县",620724:"高台县",620725:"山丹县",620726:"其它区",620800:"平凉市",620802:"崆峒区",620821:"泾川县",620822:"灵台县",620823:"崇信县",620824:"华亭县",620825:"庄浪县",620826:"静宁县",620827:"其它区",620900:"酒泉市",620902:"肃州区",620921:"金塔县",620922:"瓜州县",620923:"肃北蒙古族自治县",620924:"阿克塞哈萨克族自治县",620981:"玉门市",620982:"敦煌市",620983:"其它区",621e3:"庆阳市",621002:"西峰区",621021:"庆城县",621022:"环县",621023:"华池县",621024:"合水县",621025:"正宁县",621026:"宁县",621027:"镇原县",621028:"其它区",621100:"定西市",621102:"安定区",621121:"通渭县",621122:"陇西县",621123:"渭源县",621124:"临洮县",621125:"漳县",621126:"岷县",621127:"其它区",621200:"陇南市",621202:"武都区",621221:"成县",621222:"文县",621223:"宕昌县",621224:"康县",621225:"西和县",621226:"礼县",621227:"徽县",621228:"两当县",621229:"其它区",622900:"临夏回族自治州",622901:"临夏市",622921:"临夏县",622922:"康乐县",622923:"永靖县",622924:"广河县",622925:"和政县",622926:"东乡族自治县",622927:"积石山保安族东乡族撒拉族自治县",622928:"其它区",623e3:"甘南藏族自治州",623001:"合作市",623021:"临潭县",623022:"卓尼县",623023:"舟曲县",623024:"迭部县",623025:"玛曲县",623026:"碌曲县",623027:"夏河县",623028:"其它区",63e4:"青海省",630100:"西宁市",630102:"城东区",630103:"城中区",630104:"城西区",630105:"城北区",630121:"大通回族土族自治县",630122:"湟中县",630123:"湟源县",630124:"其它区",632100:"海东市",632121:"平安县",632122:"民和回族土族自治县",632123:"乐都区",632126:"互助土族自治县",632127:"化隆回族自治县",632128:"循化撒拉族自治县",632129:"其它区",632200:"海北藏族自治州",632221:"门源回族自治县",632222:"祁连县",632223:"海晏县",632224:"刚察县",632225:"其它区",632300:"黄南藏族自治州",632321:"同仁县",632322:"尖扎县",632323:"泽库县",632324:"河南蒙古族自治县",632325:"其它区",632500:"海南藏族自治州",632521:"共和县",632522:"同德县",632523:"贵德县",632524:"兴海县",632525:"贵南县",632526:"其它区",632600:"果洛藏族自治州",632621:"玛沁县",632622:"班玛县",632623:"甘德县",632624:"达日县",632625:"久治县",632626:"玛多县",632627:"其它区",632700:"玉树藏族自治州",632721:"玉树市",632722:"杂多县",632723:"称多县",632724:"治多县",632725:"囊谦县",632726:"曲麻莱县",632727:"其它区",632800:"海西蒙古族藏族自治州",632801:"格尔木市",632802:"德令哈市",632821:"乌兰县",632822:"都兰县",632823:"天峻县",632824:"其它区",64e4:"宁夏回族自治区",640100:"银川市",640104:"兴庆区",640105:"西夏区",640106:"金凤区",640121:"永宁县",640122:"贺兰县",640181:"灵武市",640182:"其它区",640200:"石嘴山市",640202:"大武口区",640205:"惠农区",640221:"平罗县",640222:"其它区",640300:"吴忠市",640302:"利通区",640303:"红寺堡区",640323:"盐池县",640324:"同心县",640381:"青铜峡市",640382:"其它区",640400:"固原市",640402:"原州区",640422:"西吉县",640423:"隆德县",640424:"泾源县",640425:"彭阳县",640426:"其它区",640500:"中卫市",640502:"沙坡头区",640521:"中宁县",640522:"海原县",640523:"其它区",65e4:"新疆维吾尔自治区",650100:"乌鲁木齐市",650102:"天山区",650103:"沙依巴克区",650104:"新市区",650105:"水磨沟区",650106:"头屯河区",650107:"达坂城区",650109:"米东区",650121:"乌鲁木齐县",650122:"其它区",650200:"克拉玛依市",650202:"独山子区",650203:"克拉玛依区",650204:"白碱滩区",650205:"乌尔禾区",650206:"其它区",652100:"吐鲁番地区",652101:"吐鲁番市",652122:"鄯善县",652123:"托克逊县",652124:"其它区",652200:"哈密地区",652201:"哈密市",652222:"巴里坤哈萨克自治县",652223:"伊吾县",652224:"其它区",652300:"昌吉回族自治州",652301:"昌吉市",652302:"阜康市",652323:"呼图壁县",652324:"玛纳斯县",652325:"奇台县",652327:"吉木萨尔县",652328:"木垒哈萨克自治县",652329:"其它区",652700:"博尔塔拉蒙古自治州",652701:"博乐市",652702:"阿拉山口市",652722:"精河县",652723:"温泉县",652724:"其它区",652800:"巴音郭楞蒙古自治州",652801:"库尔勒市",652822:"轮台县",652823:"尉犁县",652824:"若羌县",652825:"且末县",652826:"焉耆回族自治县",652827:"和静县",652828:"和硕县",652829:"博湖县",652830:"其它区",652900:"阿克苏地区",652901:"阿克苏市",652922:"温宿县",652923:"库车县",652924:"沙雅县",652925:"新和县",652926:"拜城县",652927:"乌什县",652928:"阿瓦提县",652929:"柯坪县",652930:"其它区",653e3:"克孜勒苏柯尔克孜自治州",653001:"阿图什市",653022:"阿克陶县",653023:"阿合奇县",653024:"乌恰县",653025:"其它区",653100:"喀什地区",653101:"喀什市",653121:"疏附县",653122:"疏勒县",653123:"英吉沙县",653124:"泽普县",653125:"莎车县",653126:"叶城县",653127:"麦盖提县",653128:"岳普湖县",653129:"伽师县",653130:"巴楚县",653131:"塔什库尔干塔吉克自治县",653132:"其它区",653200:"和田地区",653201:"和田市",653221:"和田县",653222:"墨玉县",653223:"皮山县",653224:"洛浦县",653225:"策勒县",653226:"于田县",653227:"民丰县",653228:"其它区",654e3:"伊犁哈萨克自治州",654002:"伊宁市",654003:"奎屯市",654021:"伊宁县",654022:"察布查尔锡伯自治县",654023:"霍城县",654024:"巩留县",654025:"新源县",654026:"昭苏县",654027:"特克斯县",654028:"尼勒克县",654029:"其它区",654200:"塔城地区",654201:"塔城市",654202:"乌苏市",654221:"额敏县",654223:"沙湾县",654224:"托里县",654225:"裕民县",654226:"和布克赛尔蒙古自治县",654227:"其它区",654300:"阿勒泰地区",654301:"阿勒泰市",654321:"布尔津县",654322:"富蕴县",654323:"福海县",654324:"哈巴河县",654325:"青河县",654326:"吉木乃县",654327:"其它区",659001:"石河子市",659002:"阿拉尔市",659003:"图木舒克市",659004:"五家渠市",71e4:"台湾",710100:"台北市",710101:"中正区",710102:"大同区",710103:"中山区",710104:"松山区",710105:"大安区",710106:"万华区",710107:"信义区",710108:"士林区",710109:"北投区",710110:"内湖区",710111:"南港区",710112:"文山区",710113:"其它区",710200:"高雄市",710201:"新兴区",710202:"前金区",710203:"芩雅区",710204:"盐埕区",710205:"鼓山区",710206:"旗津区",710207:"前镇区",710208:"三民区",710209:"左营区",710210:"楠梓区",710211:"小港区",710212:"其它区",710241:"苓雅区",710242:"仁武区",710243:"大社区",710244:"冈山区",710245:"路竹区",710246:"阿莲区",710247:"田寮区",710248:"燕巢区",710249:"桥头区",710250:"梓官区",710251:"弥陀区",710252:"永安区",710253:"湖内区",710254:"凤山区",710255:"大寮区",710256:"林园区",710257:"鸟松区",710258:"大树区",710259:"旗山区",710260:"美浓区",710261:"六龟区",710262:"内门区",710263:"杉林区",710264:"甲仙区",710265:"桃源区",710266:"那玛夏区",710267:"茂林区",710268:"茄萣区",710300:"台南市",710301:"中西区",710302:"东区",710303:"南区",710304:"北区",710305:"安平区",710306:"安南区",710307:"其它区",710339:"永康区",710340:"归仁区",710341:"新化区",710342:"左镇区",710343:"玉井区",710344:"楠西区",710345:"南化区",710346:"仁德区",710347:"关庙区",710348:"龙崎区",710349:"官田区",710350:"麻豆区",710351:"佳里区",710352:"西港区",710353:"七股区",710354:"将军区",710355:"学甲区",710356:"北门区",710357:"新营区",710358:"后壁区",710359:"白河区",710360:"东山区",710361:"六甲区",710362:"下营区",710363:"柳营区",710364:"盐水区",710365:"善化区",710366:"大内区",710367:"山上区",710368:"新市区",710369:"安定区",710400:"台中市",710401:"中区",710402:"东区",710403:"南区",710404:"西区",710405:"北区",710406:"北屯区",710407:"西屯区",710408:"南屯区",710409:"其它区",710431:"太平区",710432:"大里区",710433:"雾峰区",710434:"乌日区",710435:"丰原区",710436:"后里区",710437:"石冈区",710438:"东势区",710439:"和平区",710440:"新社区",710441:"潭子区",710442:"大雅区",710443:"神冈区",710444:"大肚区",710445:"沙鹿区",710446:"龙井区",710447:"梧栖区",710448:"清水区",710449:"大甲区",710450:"外埔区",710451:"大安区",710500:"金门县",710507:"金沙镇",710508:"金湖镇",710509:"金宁乡",710510:"金城镇",710511:"烈屿乡",710512:"乌坵乡",710600:"南投县",710614:"南投市",710615:"中寮乡",710616:"草屯镇",710617:"国姓乡",710618:"埔里镇",710619:"仁爱乡",710620:"名间乡",710621:"集集镇",710622:"水里乡",710623:"鱼池乡",710624:"信义乡",710625:"竹山镇",710626:"鹿谷乡",710700:"基隆市",710701:"仁爱区",710702:"信义区",710703:"中正区",710704:"中山区",710705:"安乐区",710706:"暖暖区",710707:"七堵区",710708:"其它区",710800:"新竹市",710801:"东区",710802:"北区",710803:"香山区",710804:"其它区",710900:"嘉义市",710901:"东区",710902:"西区",710903:"其它区",711100:"新北市",711130:"万里区",711131:"金山区",711132:"板桥区",711133:"汐止区",711134:"深坑区",711135:"石碇区",711136:"瑞芳区",711137:"平溪区",711138:"双溪区",711139:"贡寮区",711140:"新店区",711141:"坪林区",711142:"乌来区",711143:"永和区",711144:"中和区",711145:"土城区",711146:"三峡区",711147:"树林区",711148:"莺歌区",711149:"三重区",711150:"新庄区",711151:"泰山区",711152:"林口区",711153:"芦洲区",711154:"五股区",711155:"八里区",711156:"淡水区",711157:"三芝区",711158:"石门区",711200:"宜兰县",711214:"宜兰市",711215:"头城镇",711216:"礁溪乡",711217:"壮围乡",711218:"员山乡",711219:"罗东镇",711220:"三星乡",711221:"大同乡",711222:"五结乡",711223:"冬山乡",711224:"苏澳镇",711225:"南澳乡",711226:"钓鱼台",711300:"新竹县",711314:"竹北市",711315:"湖口乡",711316:"新丰乡",711317:"新埔镇",711318:"关西镇",711319:"芎林乡",711320:"宝山乡",711321:"竹东镇",711322:"五峰乡",711323:"横山乡",711324:"尖石乡",711325:"北埔乡",711326:"峨眉乡",711400:"桃园县",711414:"中坜市",711415:"平镇市",711416:"龙潭乡",711417:"杨梅市",711418:"新屋乡",711419:"观音乡",711420:"桃园市",711421:"龟山乡",711422:"八德市",711423:"大溪镇",711424:"复兴乡",711425:"大园乡",711426:"芦竹乡",711500:"苗栗县",711519:"竹南镇",711520:"头份镇",711521:"三湾乡",711522:"南庄乡",711523:"狮潭乡",711524:"后龙镇",711525:"通霄镇",711526:"苑里镇",711527:"苗栗市",711528:"造桥乡",711529:"头屋乡",711530:"公馆乡",711531:"大湖乡",711532:"泰安乡",711533:"铜锣乡",711534:"三义乡",711535:"西湖乡",711536:"卓兰镇",711700:"彰化县",711727:"彰化市",711728:"芬园乡",711729:"花坛乡",711730:"秀水乡",711731:"鹿港镇",711732:"福兴乡",711733:"线西乡",711734:"和美镇",711735:"伸港乡",711736:"员林镇",711737:"社头乡",711738:"永靖乡",711739:"埔心乡",711740:"溪湖镇",711741:"大村乡",711742:"埔盐乡",711743:"田中镇",711744:"北斗镇",711745:"田尾乡",711746:"埤头乡",711747:"溪州乡",711748:"竹塘乡",711749:"二林镇",711750:"大城乡",711751:"芳苑乡",711752:"二水乡",711900:"嘉义县",711919:"番路乡",711920:"梅山乡",711921:"竹崎乡",711922:"阿里山乡",711923:"中埔乡",711924:"大埔乡",711925:"水上乡",711926:"鹿草乡",711927:"太保市",711928:"朴子市",711929:"东石乡",711930:"六脚乡",711931:"新港乡",711932:"民雄乡",711933:"大林镇",711934:"溪口乡",711935:"义竹乡",711936:"布袋镇",712100:"云林县",712121:"斗南镇",712122:"大埤乡",712123:"虎尾镇",712124:"土库镇",712125:"褒忠乡",712126:"东势乡",712127:"台西乡",712128:"仑背乡",712129:"麦寮乡",712130:"斗六市",712131:"林内乡",712132:"古坑乡",712133:"莿桐乡",712134:"西螺镇",712135:"二仑乡",712136:"北港镇",712137:"水林乡",712138:"口湖乡",712139:"四湖乡",712140:"元长乡",712400:"屏东县",712434:"屏东市",712435:"三地门乡",712436:"雾台乡",712437:"玛家乡",712438:"九如乡",712439:"里港乡",712440:"高树乡",712441:"盐埔乡",712442:"长治乡",712443:"麟洛乡",712444:"竹田乡",712445:"内埔乡",712446:"万丹乡",712447:"潮州镇",712448:"泰武乡",712449:"来义乡",712450:"万峦乡",712451:"崁顶乡",712452:"新埤乡",712453:"南州乡",712454:"林边乡",712455:"东港镇",712456:"琉球乡",712457:"佳冬乡",712458:"新园乡",712459:"枋寮乡",712460:"枋山乡",712461:"春日乡",712462:"狮子乡",712463:"车城乡",712464:"牡丹乡",712465:"恒春镇",712466:"满州乡",712500:"台东县",712517:"台东市",712518:"绿岛乡",712519:"兰屿乡",712520:"延平乡",712521:"卑南乡",712522:"鹿野乡",712523:"关山镇",712524:"海端乡",712525:"池上乡",712526:"东河乡",712527:"成功镇",712528:"长滨乡",712529:"金峰乡",712530:"大武乡",712531:"达仁乡",712532:"太麻里乡",712600:"花莲县",712615:"花莲市",712616:"新城乡",712617:"太鲁阁",712618:"秀林乡",712619:"吉安乡",712620:"寿丰乡",712621:"凤林镇",712622:"光复乡",712623:"丰滨乡",712624:"瑞穗乡",712625:"万荣乡",712626:"玉里镇",712627:"卓溪乡",712628:"富里乡",712700:"澎湖县",712707:"马公市",712708:"西屿乡",712709:"望安乡",712710:"七美乡",712711:"白沙乡",712712:"湖西乡",712800:"连江县",712805:"南竿乡",712806:"北竿乡",712807:"莒光乡",712808:"东引乡",81e4:"香港特别行政区",810100:"香港岛",810101:"中西区",810102:"湾仔",810103:"东区",810104:"南区",810200:"九龙",810201:"九龙城区",810202:"油尖旺区",810203:"深水埗区",810204:"黄大仙区",810205:"观塘区",810300:"新界",810301:"北区",810302:"大埔区",810303:"沙田区",810304:"西贡区",810305:"元朗区",810306:"屯门区",810307:"荃湾区",810308:"葵青区",810309:"离岛区",82e4:"澳门特别行政区",820100:"澳门半岛",820200:"离岛",99e4:"海外",990100:"海外"},n=function(){var e=[];for(var t in i){var n="0000"===t.slice(2,6)?void 0:"00"==t.slice(4,6)?t.slice(0,2)+"0000":t.slice(0,4)+"00";e.push({id:t,pid:n,name:i[t]})}return function(e){for(var t,i={},n=0;n<e.length;n++)(t=e[n])&&t.id&&(i[t.id]=t);for(var o=[],r=0;r<e.length;r++)if(t=e[r])if(null!=t.pid||null!=t.parentId){var s=i[t.pid]||i[t.parentId];s&&(s.children||(s.children=[]),s.children.push(t))}else o.push(t);return o}(e)}();e.exports=n},function(e,t,i){var n,o=i(18);e.exports={d4:function(){return this.natural(1,4)},d6:function(){return this.natural(1,6)},d8:function(){return this.natural(1,8)},d12:function(){return this.natural(1,12)},d20:function(){return this.natural(1,20)},d100:function(){return this.natural(1,100)},guid:function(){var e="abcdefABCDEF1234567890";return this.string(e,8)+"-"+this.string(e,4)+"-"+this.string(e,4)+"-"+this.string(e,4)+"-"+this.string(e,12)},uuid:function(){return this.guid()},id:function(){var e,t=0,i=["7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2"];e=this.pick(o).id+this.date("yyyyMMdd")+this.string("number",3);for(var n=0;n<e.length;n++)t+=e[n]*i[n];return e+=["1","0","X","9","8","7","6","5","4","3","2"][t%11]},increment:(n=0,function(e){return n+=+e||1}),inc:function(e){return this.increment(e)}}},function(e,t,i){var n=i(21),o=i(22);e.exports={Parser:n,Handler:o}},function(e,t){function i(e){this.type=e,this.offset=i.offset(),this.text=i.text()}function n(e,t){i.call(this,"alternate"),this.left=e,this.right=t}function o(e){i.call(this,"match"),this.body=e.filter(Boolean)}function r(e,t){i.call(this,e),this.body=t}function s(e){r.call(this,"capture-group"),this.index=v[this.offset]||(v[this.offset]=C++),this.body=e}function a(e,t){i.call(this,"quantified"),this.body=e,this.quantifier=t}function l(e,t){i.call(this,"quantifier"),this.min=e,this.max=t,this.greedy=!0}function d(e,t){i.call(this,"charset"),this.invert=e,this.body=t}function c(e,t){i.call(this,"range"),this.start=e,this.end=t}function h(e){i.call(this,"literal"),this.body=e,this.escaped=this.body!=this.text}function u(e){i.call(this,"unicode"),this.code=e.toUpperCase()}function g(e){i.call(this,"hex"),this.code=e.toUpperCase()}function p(e){i.call(this,"octal"),this.code=e.toUpperCase()}function m(e){i.call(this,"back-reference"),this.code=e.toUpperCase()}function f(e){i.call(this,"control-character"),this.code=e.toUpperCase()}var _=function(){function e(e,t,i,n,o){this.expected=e,this.found=t,this.offset=i,this.line=n,this.column=o,this.name="SyntaxError",this.message=function(e,t){var i;switch(e.length){case 0:i="end of input";break;case 1:i=e[0];break;default:i=e.slice(0,-1).join(", ")+" or "+e[e.length-1]}return"Expected "+i+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(e){return"\\x0"+t(e)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(e){return"\\x"+t(e)})).replace(/[\u0180-\u0FFF]/g,(function(e){return"\\u0"+t(e)})).replace(/[\u1080-\uFFFF]/g,(function(e){return"\\u"+t(e)}))}(t)+'"':"end of input")+" found."}(e,t)}return function(e,t){function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i}(e,Error),{SyntaxError:e,parse:function(t){function _(){return t.substring(Qi,Xi)}function C(){return Qi}function v(e){return Ji!==e&&(Ji>e&&(Ji=0,en={line:1,column:1,seenCR:!1}),function(e,i,n){var o,r;for(o=i;n>o;o++)"\n"===(r=t.charAt(o))?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(en,Ji,e),Ji=e),en}function b(e){tn>Xi||(Xi>tn&&(tn=Xi,nn=[]),nn.push(e))}function S(e){var t=0;for(e.sort();t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function y(){var e,i,n,o,r;return e=Xi,null!==(i=w())?(n=Xi,124===t.charCodeAt(Xi)?(o=Le,Xi++):(o=null,0===on&&b(xe)),null!==o&&null!==(r=y())?n=o=[o,r]:(Xi=n,n=we),null===n&&(n=Ee),null!==n?(Qi=e,null===(i=De(i,n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}function w(){var e,t,i,n,o;if(e=Xi,null===(t=L())&&(t=Ee),null!==t)if(i=Xi,on++,n=I(),on--,null===n?i=Ee:(Xi=i,i=we),null!==i){for(n=[],null===(o=D())&&(o=E());null!==o;)n.push(o),null===(o=D())&&(o=E());null!==n?(null===(o=x())&&(o=Ee),null!==o?(Qi=e,null===(t=Ie(t,n,o))?(Xi=e,e=t):e=t):(Xi=e,e=we)):(Xi=e,e=we)}else Xi=e,e=we;else Xi=e,e=we;return e}function E(){var e;return null===(e=B())&&null===(e=H())&&(e=q()),e}function L(){var e,i;return e=Xi,94===t.charCodeAt(Xi)?(i=ke,Xi++):(i=null,0===on&&b(Te)),null!==i&&(Qi=e,i=Ne()),null===i?(Xi=e,e=i):e=i,e}function x(){var e,i;return e=Xi,36===t.charCodeAt(Xi)?(i=Me,Xi++):(i=null,0===on&&b(Re)),null!==i&&(Qi=e,i=Ae()),null===i?(Xi=e,e=i):e=i,e}function D(){var e,t,i;return e=Xi,null!==(t=E())&&null!==(i=I())?(Qi=e,null===(t=Oe(t,i))?(Xi=e,e=t):e=t):(Xi=e,e=we),e}function I(){var e,t,i;return on++,e=Xi,null!==(t=k())?(null===(i=P())&&(i=Ee),null!==i?(Qi=e,null===(t=Fe(t,i))?(Xi=e,e=t):e=t):(Xi=e,e=we)):(Xi=e,e=we),on--,null===e&&(t=null,0===on&&b(Pe)),e}function k(){var e;return null===(e=T())&&null===(e=N())&&null===(e=M())&&null===(e=R())&&null===(e=A())&&(e=O()),e}function T(){var e,i,n,o,r,s;return e=Xi,123===t.charCodeAt(Xi)?(i=Be,Xi++):(i=null,0===on&&b($e)),null!==i&&null!==(n=F())?(44===t.charCodeAt(Xi)?(o=We,Xi++):(o=null,0===on&&b(Ve)),null!==o&&null!==(r=F())?(125===t.charCodeAt(Xi)?(s=ze,Xi++):(s=null,0===on&&b(He)),null!==s?(Qi=e,null===(i=Ke(n,r))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we)):(Xi=e,e=we),e}function N(){var e,i,n,o;return e=Xi,123===t.charCodeAt(Xi)?(i=Be,Xi++):(i=null,0===on&&b($e)),null!==i&&null!==(n=F())?(t.substr(Xi,2)===Ue?(o=Ue,Xi+=2):(o=null,0===on&&b(je)),null!==o?(Qi=e,null===(i=Ge(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}function M(){var e,i,n,o;return e=Xi,123===t.charCodeAt(Xi)?(i=Be,Xi++):(i=null,0===on&&b($e)),null!==i&&null!==(n=F())?(125===t.charCodeAt(Xi)?(o=ze,Xi++):(o=null,0===on&&b(He)),null!==o?(Qi=e,null===(i=qe(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}function R(){var e,i;return e=Xi,43===t.charCodeAt(Xi)?(i=Ze,Xi++):(i=null,0===on&&b(Ye)),null!==i&&(Qi=e,i=Xe()),null===i?(Xi=e,e=i):e=i,e}function A(){var e,i;return e=Xi,42===t.charCodeAt(Xi)?(i=Qe,Xi++):(i=null,0===on&&b(Je)),null!==i&&(Qi=e,i=et()),null===i?(Xi=e,e=i):e=i,e}function O(){var e,i;return e=Xi,63===t.charCodeAt(Xi)?(i=tt,Xi++):(i=null,0===on&&b(it)),null!==i&&(Qi=e,i=nt()),null===i?(Xi=e,e=i):e=i,e}function P(){var e;return 63===t.charCodeAt(Xi)?(e=tt,Xi++):(e=null,0===on&&b(it)),e}function F(){var e,i,n;if(e=Xi,i=[],ot.test(t.charAt(Xi))?(n=t.charAt(Xi),Xi++):(n=null,0===on&&b(rt)),null!==n)for(;null!==n;)i.push(n),ot.test(t.charAt(Xi))?(n=t.charAt(Xi),Xi++):(n=null,0===on&&b(rt));else i=we;return null!==i&&(Qi=e,i=st(i)),null===i?(Xi=e,e=i):e=i,e}function B(){var e,i,n,o;return e=Xi,40===t.charCodeAt(Xi)?(i=at,Xi++):(i=null,0===on&&b(lt)),null!==i?(null===(n=V())&&null===(n=z())&&null===(n=W())&&(n=$()),null!==n?(41===t.charCodeAt(Xi)?(o=dt,Xi++):(o=null,0===on&&b(ct)),null!==o?(Qi=e,null===(i=ht(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we)):(Xi=e,e=we),e}function $(){var e,t;return e=Xi,null!==(t=y())&&(Qi=e,t=ut(t)),null===t?(Xi=e,e=t):e=t,e}function W(){var e,i,n;return e=Xi,t.substr(Xi,2)===gt?(i=gt,Xi+=2):(i=null,0===on&&b(pt)),null!==i&&null!==(n=y())?(Qi=e,null===(i=mt(n))?(Xi=e,e=i):e=i):(Xi=e,e=we),e}function V(){var e,i,n;return e=Xi,t.substr(Xi,2)===ft?(i=ft,Xi+=2):(i=null,0===on&&b(_t)),null!==i&&null!==(n=y())?(Qi=e,null===(i=Ct(n))?(Xi=e,e=i):e=i):(Xi=e,e=we),e}function z(){var e,i,n;return e=Xi,t.substr(Xi,2)===vt?(i=vt,Xi+=2):(i=null,0===on&&b(bt)),null!==i&&null!==(n=y())?(Qi=e,null===(i=St(n))?(Xi=e,e=i):e=i):(Xi=e,e=we),e}function H(){var e,i,n,o,r;if(on++,e=Xi,91===t.charCodeAt(Xi)?(i=wt,Xi++):(i=null,0===on&&b(Et)),null!==i)if(94===t.charCodeAt(Xi)?(n=ke,Xi++):(n=null,0===on&&b(Te)),null===n&&(n=Ee),null!==n){for(o=[],null===(r=K())&&(r=U());null!==r;)o.push(r),null===(r=K())&&(r=U());null!==o?(93===t.charCodeAt(Xi)?(r=Lt,Xi++):(r=null,0===on&&b(xt)),null!==r?(Qi=e,null===(i=Dt(n,o))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we)}else Xi=e,e=we;else Xi=e,e=we;return on--,null===e&&(i=null,0===on&&b(yt)),e}function K(){var e,i,n,o;return on++,e=Xi,null!==(i=U())?(45===t.charCodeAt(Xi)?(n=kt,Xi++):(n=null,0===on&&b(Tt)),null!==n&&null!==(o=U())?(Qi=e,null===(i=Nt(i,o))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),on--,null===e&&(i=null,0===on&&b(It)),e}function U(){var e;return on++,null===(e=G())&&(e=j()),on--,null===e&&0===on&&b(Mt),e}function j(){var e,i;return e=Xi,Rt.test(t.charAt(Xi))?(i=t.charAt(Xi),Xi++):(i=null,0===on&&b(At)),null!==i&&(Qi=e,i=Ot(i)),null===i?(Xi=e,e=i):e=i,e}function G(){var e;return null===(e=Q())&&null===(e=ue())&&null===(e=te())&&null===(e=ie())&&null===(e=ne())&&null===(e=oe())&&null===(e=re())&&null===(e=se())&&null===(e=ae())&&null===(e=le())&&null===(e=de())&&null===(e=ce())&&null===(e=he())&&null===(e=pe())&&null===(e=me())&&null===(e=fe())&&null===(e=_e())&&(e=Ce()),e}function q(){var e;return null===(e=Z())&&null===(e=X())&&(e=Y()),e}function Z(){var e,i;return e=Xi,46===t.charCodeAt(Xi)?(i=Pt,Xi++):(i=null,0===on&&b(Ft)),null!==i&&(Qi=e,i=Bt()),null===i?(Xi=e,e=i):e=i,e}function Y(){var e,i;return on++,e=Xi,Wt.test(t.charAt(Xi))?(i=t.charAt(Xi),Xi++):(i=null,0===on&&b(Vt)),null!==i&&(Qi=e,i=Ot(i)),null===i?(Xi=e,e=i):e=i,on--,null===e&&(i=null,0===on&&b($t)),e}function X(){var e;return null===(e=J())&&null===(e=ee())&&null===(e=ue())&&null===(e=te())&&null===(e=ie())&&null===(e=ne())&&null===(e=oe())&&null===(e=re())&&null===(e=se())&&null===(e=ae())&&null===(e=le())&&null===(e=de())&&null===(e=ce())&&null===(e=he())&&null===(e=ge())&&null===(e=pe())&&null===(e=me())&&null===(e=fe())&&null===(e=_e())&&(e=Ce()),e}function Q(){var e,i;return e=Xi,t.substr(Xi,2)===zt?(i=zt,Xi+=2):(i=null,0===on&&b(Ht)),null!==i&&(Qi=e,i=Kt()),null===i?(Xi=e,e=i):e=i,e}function J(){var e,i;return e=Xi,t.substr(Xi,2)===zt?(i=zt,Xi+=2):(i=null,0===on&&b(Ht)),null!==i&&(Qi=e,i=Ut()),null===i?(Xi=e,e=i):e=i,e}function ee(){var e,i;return e=Xi,t.substr(Xi,2)===jt?(i=jt,Xi+=2):(i=null,0===on&&b(Gt)),null!==i&&(Qi=e,i=qt()),null===i?(Xi=e,e=i):e=i,e}function te(){var e,i;return e=Xi,t.substr(Xi,2)===Zt?(i=Zt,Xi+=2):(i=null,0===on&&b(Yt)),null!==i&&(Qi=e,i=Xt()),null===i?(Xi=e,e=i):e=i,e}function ie(){var e,i;return e=Xi,t.substr(Xi,2)===Qt?(i=Qt,Xi+=2):(i=null,0===on&&b(Jt)),null!==i&&(Qi=e,i=ei()),null===i?(Xi=e,e=i):e=i,e}function ne(){var e,i;return e=Xi,t.substr(Xi,2)===ti?(i=ti,Xi+=2):(i=null,0===on&&b(ii)),null!==i&&(Qi=e,i=ni()),null===i?(Xi=e,e=i):e=i,e}function oe(){var e,i;return e=Xi,t.substr(Xi,2)===oi?(i=oi,Xi+=2):(i=null,0===on&&b(ri)),null!==i&&(Qi=e,i=si()),null===i?(Xi=e,e=i):e=i,e}function re(){var e,i;return e=Xi,t.substr(Xi,2)===ai?(i=ai,Xi+=2):(i=null,0===on&&b(li)),null!==i&&(Qi=e,i=di()),null===i?(Xi=e,e=i):e=i,e}function se(){var e,i;return e=Xi,t.substr(Xi,2)===ci?(i=ci,Xi+=2):(i=null,0===on&&b(hi)),null!==i&&(Qi=e,i=ui()),null===i?(Xi=e,e=i):e=i,e}function ae(){var e,i;return e=Xi,t.substr(Xi,2)===gi?(i=gi,Xi+=2):(i=null,0===on&&b(pi)),null!==i&&(Qi=e,i=mi()),null===i?(Xi=e,e=i):e=i,e}function le(){var e,i;return e=Xi,t.substr(Xi,2)===fi?(i=fi,Xi+=2):(i=null,0===on&&b(_i)),null!==i&&(Qi=e,i=Ci()),null===i?(Xi=e,e=i):e=i,e}function de(){var e,i;return e=Xi,t.substr(Xi,2)===vi?(i=vi,Xi+=2):(i=null,0===on&&b(bi)),null!==i&&(Qi=e,i=Si()),null===i?(Xi=e,e=i):e=i,e}function ce(){var e,i;return e=Xi,t.substr(Xi,2)===yi?(i=yi,Xi+=2):(i=null,0===on&&b(wi)),null!==i&&(Qi=e,i=Ei()),null===i?(Xi=e,e=i):e=i,e}function he(){var e,i;return e=Xi,t.substr(Xi,2)===Li?(i=Li,Xi+=2):(i=null,0===on&&b(xi)),null!==i&&(Qi=e,i=Di()),null===i?(Xi=e,e=i):e=i,e}function ue(){var e,i,n;return e=Xi,t.substr(Xi,2)===Ii?(i=Ii,Xi+=2):(i=null,0===on&&b(ki)),null!==i?(t.length>Xi?(n=t.charAt(Xi),Xi++):(n=null,0===on&&b(Ti)),null!==n?(Qi=e,null===(i=Ni(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}function ge(){var e,i,n;return e=Xi,92===t.charCodeAt(Xi)?(i=Mi,Xi++):(i=null,0===on&&b(Ri)),null!==i?(Ai.test(t.charAt(Xi))?(n=t.charAt(Xi),Xi++):(n=null,0===on&&b(Oi)),null!==n?(Qi=e,null===(i=Pi(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}function pe(){var e,i,n,o;if(e=Xi,t.substr(Xi,2)===Fi?(i=Fi,Xi+=2):(i=null,0===on&&b(Bi)),null!==i){if(n=[],$i.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Wi)),null!==o)for(;null!==o;)n.push(o),$i.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Wi));else n=we;null!==n?(Qi=e,null===(i=Vi(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)}else Xi=e,e=we;return e}function me(){var e,i,n,o;if(e=Xi,t.substr(Xi,2)===zi?(i=zi,Xi+=2):(i=null,0===on&&b(Hi)),null!==i){if(n=[],Ki.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Ui)),null!==o)for(;null!==o;)n.push(o),Ki.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Ui));else n=we;null!==n?(Qi=e,null===(i=ji(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)}else Xi=e,e=we;return e}function fe(){var e,i,n,o;if(e=Xi,t.substr(Xi,2)===Gi?(i=Gi,Xi+=2):(i=null,0===on&&b(qi)),null!==i){if(n=[],Ki.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Ui)),null!==o)for(;null!==o;)n.push(o),Ki.test(t.charAt(Xi))?(o=t.charAt(Xi),Xi++):(o=null,0===on&&b(Ui));else n=we;null!==n?(Qi=e,null===(i=Zi(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)}else Xi=e,e=we;return e}function _e(){var e,i;return e=Xi,t.substr(Xi,2)===Fi?(i=Fi,Xi+=2):(i=null,0===on&&b(Bi)),null!==i&&(Qi=e,i=Yi()),null===i?(Xi=e,e=i):e=i,e}function Ce(){var e,i,n;return e=Xi,92===t.charCodeAt(Xi)?(i=Mi,Xi++):(i=null,0===on&&b(Ri)),null!==i?(t.length>Xi?(n=t.charAt(Xi),Xi++):(n=null,0===on&&b(Ti)),null!==n?(Qi=e,null===(i=Ot(n))?(Xi=e,e=i):e=i):(Xi=e,e=we)):(Xi=e,e=we),e}var ve,be=arguments.length>1?arguments[1]:{},Se={regexp:y},ye=y,we=null,Ee="",Le="|",xe='"|"',De=function(e,t){return t?new n(e,t[1]):e},Ie=function(e,t,i){return new o([e].concat(t).concat([i]))},ke="^",Te='"^"',Ne=function(){return new i("start")},Me="$",Re='"$"',Ae=function(){return new i("end")},Oe=function(e,t){return new a(e,t)},Pe="Quantifier",Fe=function(e,t){return t&&(e.greedy=!1),e},Be="{",$e='"{"',We=",",Ve='","',ze="}",He='"}"',Ke=function(e,t){return new l(e,t)},Ue=",}",je='",}"',Ge=function(e){return new l(e,1/0)},qe=function(e){return new l(e,e)},Ze="+",Ye='"+"',Xe=function(){return new l(1,1/0)},Qe="*",Je='"*"',et=function(){return new l(0,1/0)},tt="?",it='"?"',nt=function(){return new l(0,1)},ot=/^[0-9]/,rt="[0-9]",st=function(e){return+e.join("")},at="(",lt='"("',dt=")",ct='")"',ht=function(e){return e},ut=function(e){return new s(e)},gt="?:",pt='"?:"',mt=function(e){return new r("non-capture-group",e)},ft="?=",_t='"?="',Ct=function(e){return new r("positive-lookahead",e)},vt="?!",bt='"?!"',St=function(e){return new r("negative-lookahead",e)},yt="CharacterSet",wt="[",Et='"["',Lt="]",xt='"]"',Dt=function(e,t){return new d(!!e,t)},It="CharacterRange",kt="-",Tt='"-"',Nt=function(e,t){return new c(e,t)},Mt="Character",Rt=/^[^\\\]]/,At="[^\\\\\\]]",Ot=function(e){return new h(e)},Pt=".",Ft='"."',Bt=function(){return new i("any-character")},$t="Literal",Wt=/^[^|\\\/.[()?+*$\^]/,Vt="[^|\\\\\\/.[()?+*$\\^]",zt="\\b",Ht='"\\\\b"',Kt=function(){return new i("backspace")},Ut=function(){return new i("word-boundary")},jt="\\B",Gt='"\\\\B"',qt=function(){return new i("non-word-boundary")},Zt="\\d",Yt='"\\\\d"',Xt=function(){return new i("digit")},Qt="\\D",Jt='"\\\\D"',ei=function(){return new i("non-digit")},ti="\\f",ii='"\\\\f"',ni=function(){return new i("form-feed")},oi="\\n",ri='"\\\\n"',si=function(){return new i("line-feed")},ai="\\r",li='"\\\\r"',di=function(){return new i("carriage-return")},ci="\\s",hi='"\\\\s"',ui=function(){return new i("white-space")},gi="\\S",pi='"\\\\S"',mi=function(){return new i("non-white-space")},fi="\\t",_i='"\\\\t"',Ci=function(){return new i("tab")},vi="\\v",bi='"\\\\v"',Si=function(){return new i("vertical-tab")},yi="\\w",wi='"\\\\w"',Ei=function(){return new i("word")},Li="\\W",xi='"\\\\W"',Di=function(){return new i("non-word")},Ii="\\c",ki='"\\\\c"',Ti="any character",Ni=function(e){return new f(e)},Mi="\\",Ri='"\\\\"',Ai=/^[1-9]/,Oi="[1-9]",Pi=function(e){return new m(e)},Fi="\\0",Bi='"\\\\0"',$i=/^[0-7]/,Wi="[0-7]",Vi=function(e){return new p(e.join(""))},zi="\\x",Hi='"\\\\x"',Ki=/^[0-9a-fA-F]/,Ui="[0-9a-fA-F]",ji=function(e){return new g(e.join(""))},Gi="\\u",qi='"\\\\u"',Zi=function(e){return new u(e.join(""))},Yi=function(){return new i("null-character")},Xi=0,Qi=0,Ji=0,en={line:1,column:1,seenCR:!1},tn=0,nn=[],on=0;if("startRule"in be){if(!(be.startRule in Se))throw new Error("Can't start parsing from rule \""+be.startRule+'".');ye=Se[be.startRule]}if(i.offset=C,i.text=_,null!==(ve=ye())&&Xi===t.length)return ve;throw S(nn),Qi=Math.max(Xi,tn),new e(nn,Qi<t.length?t.charAt(Qi):null,Qi,v(Qi).line,v(Qi).column)}}}(),C=1,v={};e.exports=_},function(e,t,i){var n=i(3),o=i(5),r={extend:n.extend},s=g(97,122),a=g(65,90),l=g(48,57),d=g(32,47)+g(58,64)+g(91,96)+g(123,126),c=g(32,126),h=" \f\n\r\t\v \u2028\u2029",u={"\\w":s+a+l+"_","\\W":d.replace("_",""),"\\s":h,"\\S":function(){for(var e=c,t=0;t<h.length;t++)e=e.replace(h[t],"");return e}(),"\\d":l,"\\D":s+a+d};function g(e,t){for(var i="",n=e;n<=t;n++)i+=String.fromCharCode(n);return i}r.gen=function(e,t,i){return i=i||{guid:1},r[e.type]?r[e.type](e,t,i):r.token(e,t,i)},r.extend({token:function(e,t,i){switch(e.type){case"start":case"end":case"backspace":case"word-boundary":return"";case"any-character":return o.character();case"non-word-boundary":case"form-feed":case"carriage-return":case"tab":case"vertical-tab":break;case"digit":return o.pick(l.split(""));case"non-digit":return o.pick((s+a+d).split(""));case"line-feed":return e.body||e.text;case"white-space":return o.pick(h.split(""));case"non-white-space":case"word":return o.pick((s+a+l).split(""));case"non-word":return o.pick(d.replace("_","").split(""))}return e.body||e.text},alternate:function(e,t,i){return this.gen(o.boolean()?e.left:e.right,t,i)},match:function(e,t,i){t="";for(var n=0;n<e.body.length;n++)t+=this.gen(e.body[n],t,i);return t},"capture-group":function(e,t,i){return t=this.gen(e.body,t,i),i[i.guid++]=t,t},"non-capture-group":function(e,t,i){return this.gen(e.body,t,i)},"positive-lookahead":function(e,t,i){return this.gen(e.body,t,i)},"negative-lookahead":function(e,t,i){return""},quantified:function(e,t,i){t="";for(var n=this.quantifier(e.quantifier),o=0;o<n;o++)t+=this.gen(e.body,t,i);return t},quantifier:function(e,t,i){var n=Math.max(e.min,0),r=isFinite(e.max)?e.max:n+o.integer(3,7);return o.integer(n,r)},charset:function(e,t,i){if(e.invert)return this["invert-charset"](e,t,i);var n=o.pick(e.body);return this.gen(n,t,i)},"invert-charset":function(e,t,i){for(var n,r=c,s=0;s<e.body.length;s++)switch((n=e.body[s]).type){case"literal":r=r.replace(n.body,"");break;case"range":for(var a=this.gen(n.start,t,i).charCodeAt(),l=this.gen(n.end,t,i).charCodeAt(),d=a;d<=l;d++)r=r.replace(String.fromCharCode(d),"");default:var h=u[n.text];if(h)for(var g=0;g<=h.length;g++)r=r.replace(h[g],"")}return o.pick(r.split(""))},range:function(e,t,i){var n=this.gen(e.start,t,i).charCodeAt(),r=this.gen(e.end,t,i).charCodeAt();return String.fromCharCode(o.integer(n,r))},literal:function(e,t,i){return e.escaped?e.body:e.text},unicode:function(e,t,i){return String.fromCharCode(parseInt(e.code,16))},hex:function(e,t,i){return String.fromCharCode(parseInt(e.code,16))},octal:function(e,t,i){return String.fromCharCode(parseInt(e.code,8))},"back-reference":function(e,t,i){return i[e.code]||""},CONTROL_CHARACTER_MAP:function(){for(var e="@ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \\ ] ^ _".split(" "),t="\0        \b \t \n \v \f \r                  ".split(" "),i={},n=0;n<e.length;n++)i[e[n]]=t[n];return i}(),"control-character":function(e,t,i){return this.CONTROL_CHARACTER_MAP[e.code]}}),e.exports=r},function(e,t,i){e.exports=i(24)},function(e,t,i){var n=i(2),o=i(3),r=i(4);e.exports=function e(t,i,s){s=s||[];var a={name:"string"==typeof i?i.replace(n.RE_KEY,"$1"):i,template:t,type:o.type(t),rule:r.parse(i)};switch(a.path=s.slice(0),a.path.push(void 0===i?"ROOT":a.name),a.type){case"array":a.items=[],o.each(t,(function(t,i){a.items.push(e(t,i,a.path))}));break;case"object":a.properties=[],o.each(t,(function(t,i){a.properties.push(e(t,i,a.path))}))}return a}},function(e,t,i){e.exports=i(26)},function(e,t,i){var n=i(2),o=i(3),r=i(23);function s(e,t){for(var i=r(e),n=a.diff(i,t),o=0;o<n.length;o++);return n}var a={diff:function(e,t,i){var n=[];return this.name(e,t,i,n)&&this.type(e,t,i,n)&&(this.value(e,t,i,n),this.properties(e,t,i,n),this.items(e,t,i,n)),n},name:function(e,t,i,n){var o=n.length;return l.equal("name",e.path,i+"",e.name+"",n),n.length===o},type:function(e,t,i,r){var s=r.length;switch(e.type){case"string":if(e.template.match(n.RE_PLACEHOLDER))return!0;break;case"array":if(e.rule.parameters){if(void 0!==e.rule.min&&void 0===e.rule.max&&1===e.rule.count)return!0;if(e.rule.parameters[2])return!0}break;case"function":return!0}return l.equal("type",e.path,o.type(t),e.type,r),r.length===s},value:function(e,t,i,o){var r,s=o.length,a=e.rule,d=e.type;if("object"===d||"array"===d||"function"===d)return!0;if(!a.parameters){switch(d){case"regexp":return l.match("value",e.path,t,e.template,o),o.length===s;case"string":if(e.template.match(n.RE_PLACEHOLDER))return o.length===s}return l.equal("value",e.path,t,e.template,o),o.length===s}switch(d){case"number":var c=(t+"").split(".");c[0]=+c[0],void 0!==a.min&&void 0!==a.max&&(l.greaterThanOrEqualTo("value",e.path,c[0],Math.min(a.min,a.max),o),l.lessThanOrEqualTo("value",e.path,c[0],Math.max(a.min,a.max),o)),void 0!==a.min&&void 0===a.max&&l.equal("value",e.path,c[0],a.min,o,"[value] "+i),a.decimal&&(void 0!==a.dmin&&void 0!==a.dmax&&(l.greaterThanOrEqualTo("value",e.path,c[1].length,a.dmin,o),l.lessThanOrEqualTo("value",e.path,c[1].length,a.dmax,o)),void 0!==a.dmin&&void 0===a.dmax&&l.equal("value",e.path,c[1].length,a.dmin,o));break;case"boolean":break;case"string":r=(r=t.match(new RegExp(e.template,"g")))?r.length:0,void 0!==a.min&&void 0!==a.max&&(l.greaterThanOrEqualTo("repeat count",e.path,r,a.min,o),l.lessThanOrEqualTo("repeat count",e.path,r,a.max,o)),void 0!==a.min&&void 0===a.max&&l.equal("repeat count",e.path,r,a.min,o);break;case"regexp":r=(r=t.match(new RegExp(e.template.source.replace(/^\^|\$$/g,""),"g")))?r.length:0,void 0!==a.min&&void 0!==a.max&&(l.greaterThanOrEqualTo("repeat count",e.path,r,a.min,o),l.lessThanOrEqualTo("repeat count",e.path,r,a.max,o)),void 0!==a.min&&void 0===a.max&&l.equal("repeat count",e.path,r,a.min,o)}return o.length===s},properties:function(e,t,i,n){var r=n.length,s=e.rule,a=o.keys(t);if(e.properties){if(e.rule.parameters?(void 0!==s.min&&void 0!==s.max&&(l.greaterThanOrEqualTo("properties length",e.path,a.length,Math.min(s.min,s.max),n),l.lessThanOrEqualTo("properties length",e.path,a.length,Math.max(s.min,s.max),n)),void 0!==s.min&&void 0===s.max&&1!==s.count&&l.equal("properties length",e.path,a.length,s.min,n)):l.equal("properties length",e.path,a.length,e.properties.length,n),n.length!==r)return!1;for(var d=0;d<a.length;d++)n.push.apply(n,this.diff(function(){var t;return o.each(e.properties,(function(e){e.name===a[d]&&(t=e)})),t||e.properties[d]}(),t[a[d]],a[d]));return n.length===r}},items:function(e,t,i,n){var o=n.length;if(e.items){var r=e.rule;if(e.rule.parameters){if(void 0!==r.min&&void 0!==r.max&&(l.greaterThanOrEqualTo("items",e.path,t.length,Math.min(r.min,r.max)*e.items.length,n,"[{utype}] array is too short: {path} must have at least {expected} elements but instance has {actual} elements"),l.lessThanOrEqualTo("items",e.path,t.length,Math.max(r.min,r.max)*e.items.length,n,"[{utype}] array is too long: {path} must have at most {expected} elements but instance has {actual} elements")),void 0!==r.min&&void 0===r.max){if(1===r.count)return n.length===o;l.equal("items length",e.path,t.length,r.min*e.items.length,n)}if(r.parameters[2])return n.length===o}else l.equal("items length",e.path,t.length,e.items.length,n);if(n.length!==o)return!1;for(var s=0;s<t.length;s++)n.push.apply(n,this.diff(e.items[s%e.items.length],t[s],s%e.items.length));return n.length===o}}},l={message:function(e){return(e.message||"[{utype}] Expect {path}'{ltype} {action} {expected}, but is {actual}").replace("{utype}",e.type.toUpperCase()).replace("{ltype}",e.type.toLowerCase()).replace("{path}",o.isArray(e.path)&&e.path.join(".")||e.path).replace("{action}",e.action).replace("{expected}",e.expected).replace("{actual}",e.actual)},equal:function(e,t,i,n,o,r){if(i===n)return!0;if("type"===e&&"regexp"===n&&"string"===i)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is equal to",message:r};return s.message=l.message(s),o.push(s),!1},match:function(e,t,i,n,o,r){if(n.test(i))return!0;var s={path:t,type:e,actual:i,expected:n,action:"matches",message:r};return s.message=l.message(s),o.push(s),!1},notEqual:function(e,t,i,n,o,r){if(i!==n)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is not equal to",message:r};return s.message=l.message(s),o.push(s),!1},greaterThan:function(e,t,i,n,o,r){if(i>n)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is greater than",message:r};return s.message=l.message(s),o.push(s),!1},lessThan:function(e,t,i,n,o,r){if(i<n)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is less to",message:r};return s.message=l.message(s),o.push(s),!1},greaterThanOrEqualTo:function(e,t,i,n,o,r){if(i>=n)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is greater than or equal to",message:r};return s.message=l.message(s),o.push(s),!1},lessThanOrEqualTo:function(e,t,i,n,o,r){if(i<=n)return!0;var s={path:t,type:e,actual:i,expected:n,action:"is less than or equal to",message:r};return s.message=l.message(s),o.push(s),!1}};s.Diff=a,s.Assert=l,e.exports=s},function(e,t,i){e.exports=i(28)},function(e,t,i){var n=i(3);window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("custom")}catch(c){window.Event=function(e,t,i,n){var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t,i,n),o}}var o={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r="readystatechange loadstart progress abort error load timeout loadend".split(" "),s="timeout withCredentials".split(" "),a="readyState responseURL status statusText responseType response responseText responseXML".split(" "),l="OK";function d(){this.custom={events:{},requestHeaders:{},responseHeaders:{}}}d._settings={timeout:"10-100"},d.setup=function(e){return n.extend(d._settings,e),d._settings},n.extend(d,o),n.extend(d.prototype,o),d.prototype.mock=!0,d.prototype.match=!1,n.extend(d.prototype,{open:function(e,t,i,o,l){var c=this;n.extend(this.custom,{method:e,url:t,async:"boolean"!=typeof i||i,username:o,password:l,options:{url:t,type:e}}),this.custom.timeout=function(e){if("number"==typeof e)return e;if("string"==typeof e&&!~e.indexOf("-"))return parseInt(e,10);if("string"==typeof e&&~e.indexOf("-")){var t=e.split("-"),i=parseInt(t[0],10),n=parseInt(t[1],10);return Math.round(Math.random()*(n-i))+i}}(d._settings.timeout);var h=function(e){for(var t in d.Mock._mocked){var i=d.Mock._mocked[t];if((!i.rurl||o(i.rurl,e.url))&&(!i.rtype||o(i.rtype,e.type.toLowerCase())))return i}function o(e,t){return"string"===n.type(e)?e===t:"regexp"===n.type(e)?e.test(t):void 0}}(this.custom.options);function u(e){for(var t=0;t<a.length;t++)try{c[a[t]]=g[a[t]]}catch(i){}c.dispatchEvent(new Event(e.type))}if(h)this.match=!0,this.custom.template=h,this.readyState=d.OPENED,this.dispatchEvent(new Event("readystatechange"));else{var g=function(){var e,t,i,n,o=(e=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,t=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,i=location.href,n=t.exec(i.toLowerCase())||[],e.test(n[1]));return window.ActiveXObject?!o&&r()||s():r();function r(){try{return new window._XMLHttpRequest}catch(e){}}function s(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}();this.custom.xhr=g;for(var p=0;p<r.length;p++)g.addEventListener(r[p],u);o?g.open(e,t,i,o,l):g.open(e,t,i);for(var m=0;m<s.length;m++)try{g[s[m]]=c[s[m]]}catch(f){}}},setRequestHeader:function(e,t){if(this.match){var i=this.custom.requestHeaders;i[e]?i[e]+=","+t:i[e]=t}else this.custom.xhr.setRequestHeader(e,t)},timeout:0,withCredentials:!1,upload:{},send:function(e){var t=this;function i(){var e,i;t.readyState=d.HEADERS_RECEIVED,t.dispatchEvent(new Event("readystatechange")),t.readyState=d.LOADING,t.dispatchEvent(new Event("readystatechange")),t.status=200,t.statusText=l,t.response=t.responseText=JSON.stringify((e=t.custom.template,i=t.custom.options,n.isFunction(e.template)?e.template(i):d.Mock.mock(e.template)),null,4),t.readyState=d.DONE,t.dispatchEvent(new Event("readystatechange")),t.dispatchEvent(new Event("load")),t.dispatchEvent(new Event("loadend"))}this.custom.options.body=e,this.match?(this.setRequestHeader("X-Requested-With","MockXMLHttpRequest"),this.dispatchEvent(new Event("loadstart")),this.custom.async?setTimeout(i,this.custom.timeout):i()):this.custom.xhr.send(e)},abort:function(){this.match?(this.readyState=d.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this))):this.custom.xhr.abort()}}),n.extend(d.prototype,{responseURL:"",status:d.UNSENT,statusText:"",getResponseHeader:function(e){return this.match?this.custom.responseHeaders[e.toLowerCase()]:this.custom.xhr.getResponseHeader(e)},getAllResponseHeaders:function(){if(!this.match)return this.custom.xhr.getAllResponseHeaders();var e=this.custom.responseHeaders,t="";for(var i in e)e.hasOwnProperty(i)&&(t+=i+": "+e[i]+"\r\n");return t},overrideMimeType:function(){},responseType:"",response:null,responseText:"",responseXML:null}),n.extend(d.prototype,{addEventListener:function(e,t){var i=this.custom.events;i[e]||(i[e]=[]),i[e].push(t)},removeEventListener:function(e,t){for(var i=this.custom.events[e]||[],n=0;n<i.length;n++)i[n]===t&&i.splice(n--,1)},dispatchEvent:function(e){for(var t=this.custom.events[e.type]||[],i=0;i<t.length;i++)t[i].call(this,e);var n="on"+e.type;this[n]&&this[n](e)}}),e.exports=d}])},module.exports=factory()})(mock);var Mock=mock.exports;const config=apidocFeConfig,mockExtends=config.MOCK_EXTENDS?config.MOCK_EXTENDS:{};function renderCodeJsonByParams(e,t){const i={};return e&&e.length&&e.forEach((e=>{let n=e.default;if(t&&e.mock&&(n=Mock.mock(e.mock)),null===n||null==n)switch(e.type){case"int":n=0;break;case"boolean":n=!1}"array"!==e.type||"array"!==n&&n||(n=[]);let o=["int","float","boolean","array"].includes(e.type)?n:`${trim(n)}`;if("object"==e.type&&e.children&&e.children.length)o=renderCodeJsonByParams(e.children,t);else if("array"==e.type&&e.children&&e.children.length){const i=renderCodeJsonByParams(e.children,t);let n=null;if("array"==e.childrenType){const e=[];for(const t in i)e.push(i[t]);n=e}else n="string"==e.childrenType?"":"int"==e.childrenType?0:i;o=[n]}else if("tree"==e.type&&e.children&&e.children.length){o=[renderCodeJsonByParams(e.children,t)]}i[e.name]=o})),i}function formatJsonCode(e){return JSON.stringify(e,null,"\t")}function _format$1(e,t){let i;return i=0===t.length?e:e.replace(/\{(\d+)\}/g,(function(e,i){const n=i[0];return void 0!==t[n]?t[n]:e})),i}function localize(e,t,...i){return _format$1(t,i)}Mock.Random.extend(__spreadValues({phone:function(){return this.pick(["130","131","132","133","135","137","138","152","155","157","159","170","177","180","182","183","185","187","188","189","191"])+Mock.mock(/\d{8}/)},idcard:function(){return createIdcard()},regexp:function(e,n){let key="regexp";n&&(key=key+"|"+n);const res=Mock.mock({[key]:eval(e)});return res.regexp}},mockExtends));class ErrorHandler{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout((()=>{if(e.stack)throw new Error(e.message+"\n\n"+e.stack);throw e}),0)}}emit(e){this.listeners.forEach((t=>{t(e)}))}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const errorHandler=new ErrorHandler;function onUnexpectedError(e){isCancellationError(e)||errorHandler.onUnexpectedError(e)}function onUnexpectedExternalError(e){isCancellationError(e)||errorHandler.onUnexpectedExternalError(e)}function transformErrorForSerialization(e){if(e instanceof Error){let{name:t,message:i}=e;return{$isError:!0,name:t,message:i,stack:e.stacktrace||e.stack}}return e}const canceledName="Canceled";function isCancellationError(e){return e instanceof CancellationError||e instanceof Error&&e.name===canceledName&&e.message===canceledName}class CancellationError extends Error{constructor(){super(canceledName),this.name=this.message}}function canceled(){const e=new Error(canceledName);return e.name=e.message,e}function illegalArgument(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}function illegalState(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}class NotSupportedError extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}function once$1(e){const t=this;let i,n=!1;return function(){return n||(n=!0,i=e.apply(t,arguments)),i}}var Iterable,_a$d;function trackDisposable(e){return e}function setParentOfDisposable(e,t){}function markAsSingleton(e){return e}!function(e){e.is=function(e){return e&&"object"==typeof e&&"function"==typeof e[Symbol.iterator]};const t=Object.freeze([]);e.empty=function(){return t},e.single=function*(e){yield e},e.from=function(e){return e||t},e.isEmpty=function(e){return!e||!0===e[Symbol.iterator]().next().done},e.first=function(e){return e[Symbol.iterator]().next().value},e.some=function(e,t){for(const i of e)if(t(i))return!0;return!1},e.find=function(e,t){for(const i of e)if(t(i))return i},e.filter=function*(e,t){for(const i of e)t(i)&&(yield i)},e.map=function*(e,t){let i=0;for(const n of e)yield t(n,i++)},e.concat=function*(...e){for(const t of e)for(const e of t)yield e},e.concatNested=function*(e){for(const t of e)for(const e of t)yield e},e.reduce=function(e,t,i){let n=i;for(const o of e)n=t(n,o);return n},e.slice=function*(e,t,i=e.length){for(t<0&&(t+=e.length),i<0?i+=e.length:i>e.length&&(i=e.length);t<i;t++)yield e[t]},e.consume=function(t,i=Number.POSITIVE_INFINITY){const n=[];if(0===i)return[n,t];const o=t[Symbol.iterator]();for(let r=0;r<i;r++){const t=o.next();if(t.done)return[n,e.empty()];n.push(t.value)}return[n,{[Symbol.iterator]:()=>o}]},e.equals=function(e,t,i=((e,t)=>e===t)){const n=e[Symbol.iterator](),o=t[Symbol.iterator]();for(;;){const e=n.next(),t=o.next();if(e.done!==t.done)return!1;if(e.done)return!0;if(!i(e.value,t.value))return!1}}}(Iterable||(Iterable={}));class MultiDisposeError extends Error{constructor(e){super(`Encountered errors while disposing of store. Errors: [${e.join(", ")}]`),this.errors=e}}function isDisposable(e){return"function"==typeof e.dispose&&0===e.dispose.length}function dispose(e){if(Iterable.is(e)){let i=[];for(const n of e)if(n)try{n.dispose()}catch(t){i.push(t)}if(1===i.length)throw i[0];if(i.length>1)throw new MultiDisposeError(i);return Array.isArray(e)?[]:e}if(e)return e.dispose(),e}function combinedDisposable(...e){return toDisposable((()=>dispose(e)))}function toDisposable(e){return trackDisposable({dispose:once$1((()=>{e()}))})}class DisposableStore{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){try{dispose(this._toDispose.values())}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?DisposableStore.DISABLE_DISPOSED_WARNING:this._toDispose.add(e),e}}DisposableStore.DISABLE_DISPOSED_WARNING=!1;class Disposable{constructor(){this._store=new DisposableStore,setParentOfDisposable(this._store)}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}}Disposable.None=Object.freeze({dispose(){}});class MutableDisposable{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class SafeDisposable{constructor(){this.dispose=()=>{},this.unset=()=>{},this.isset=()=>!1}set(e){let t=e;return this.unset=()=>t=void 0,this.isset=()=>void 0!==t,this.dispose=()=>{t&&(t(),t=void 0)},this}}class ImmortalReference{constructor(e){this.object=e}dispose(){}}class Node$2{constructor(e){this.element=e,this.next=Node$2.Undefined,this.prev=Node$2.Undefined}}Node$2.Undefined=new Node$2(void 0);class LinkedList{constructor(){this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Node$2.Undefined}clear(){let e=this._first;for(;e!==Node$2.Undefined;){const t=e.next;e.prev=Node$2.Undefined,e.next=Node$2.Undefined,e=t}this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Node$2(e);if(this._first===Node$2.Undefined)this._first=i,this._last=i;else if(t){const e=this._last;this._last=i,i.prev=e,e.next=i}else{const e=this._first;this._first=i,i.next=e,e.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==Node$2.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Node$2.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Node$2.Undefined&&e.next!==Node$2.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Node$2.Undefined&&e.next===Node$2.Undefined?(this._first=Node$2.Undefined,this._last=Node$2.Undefined):e.next===Node$2.Undefined?(this._last=this._last.prev,this._last.next=Node$2.Undefined):e.prev===Node$2.Undefined&&(this._first=this._first.next,this._first.prev=Node$2.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Node$2.Undefined;)yield e.element,e=e.next}}const LANGUAGE_DEFAULT="en";let _isWindows=!1,_isMacintosh=!1,_isLinux=!1,_isNative=!1,_isWeb=!1,_isIOS=!1,_locale,_language=LANGUAGE_DEFAULT,_translationsConfigFile,_userAgent;const globals="object"==typeof self?self:"object"==typeof global?global:{};let nodeProcess;void 0!==globals.vscode&&void 0!==globals.vscode.process?nodeProcess=globals.vscode.process:"undefined"!=typeof process&&(nodeProcess=process);const isElectronProcess="string"==typeof(null===(_a$d=null==nodeProcess?void 0:nodeProcess.versions)||void 0===_a$d?void 0:_a$d.electron),isElectronRenderer=isElectronProcess&&"renderer"===(null==nodeProcess?void 0:nodeProcess.type);if("object"!=typeof navigator||isElectronRenderer){if("object"==typeof nodeProcess){_isWindows="win32"===nodeProcess.platform,_isMacintosh="darwin"===nodeProcess.platform,_isLinux="linux"===nodeProcess.platform,_isLinux&&nodeProcess.env.SNAP&&nodeProcess.env.SNAP_REVISION,nodeProcess.env.CI||nodeProcess.env.BUILD_ARTIFACTSTAGINGDIRECTORY,_locale=LANGUAGE_DEFAULT,_language=LANGUAGE_DEFAULT;const e=nodeProcess.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e),i=t.availableLanguages["*"];_locale=t.locale,_language=i||LANGUAGE_DEFAULT,_translationsConfigFile=t._translationsConfigFile}catch(e2){}_isNative=!0}}else _userAgent=navigator.userAgent,_isWindows=_userAgent.indexOf("Windows")>=0,_isMacintosh=_userAgent.indexOf("Macintosh")>=0,_isIOS=(_userAgent.indexOf("Macintosh")>=0||_userAgent.indexOf("iPad")>=0||_userAgent.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_isLinux=_userAgent.indexOf("Linux")>=0,_isWeb=!0,_locale=navigator.language,_language=_locale;const isWindows=_isWindows,isMacintosh=_isMacintosh,isLinux=_isLinux,isNative=_isNative,isWeb=_isWeb,isWebWorker=_isWeb&&"function"==typeof globals.importScripts,isIOS=_isIOS,userAgent$1=_userAgent,language=_language,setTimeout0=(()=>{if("function"==typeof globals.postMessage&&!globals.importScripts){let e=[];globals.addEventListener("message",(t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=e.length;i<n;i++){const n=e[i];if(n.id===t.data.vscodeScheduleAsyncWork)return e.splice(i,1),void n.callback()}}));let t=0;return i=>{const n=++t;e.push({id:n,callback:i}),globals.postMessage({vscodeScheduleAsyncWork:n},"*")}}return e=>setTimeout(e)})(),OS=_isMacintosh||_isIOS?2:_isWindows?1:3;let _isLittleEndian=!0,_isLittleEndianComputed=!1;function isLittleEndian(){if(!_isLittleEndianComputed){_isLittleEndianComputed=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2;const t=new Uint16Array(e.buffer);_isLittleEndian=513===t[0]}return _isLittleEndian}const isChrome$1=!!(userAgent$1&&userAgent$1.indexOf("Chrome")>=0),isFirefox$1=!!(userAgent$1&&userAgent$1.indexOf("Firefox")>=0),isSafari$1=!!(!isChrome$1&&userAgent$1&&userAgent$1.indexOf("Safari")>=0),isEdge=!!(userAgent$1&&userAgent$1.indexOf("Edg/")>=0);userAgent$1&&userAgent$1.indexOf("Android");const hasPerformanceNow=globals.performance&&"function"==typeof globals.performance.now;class StopWatch{constructor(e){this._highResolution=hasPerformanceNow&&e,this._startTime=this._now(),this._stopTime=-1}static create(e=!0){return new StopWatch(e)}stop(){this._stopTime=this._now()}elapsed(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime}_now(){return this._highResolution?globals.performance.now():Date.now()}}var Event$1;!function(e){function t(e){return(t,i=null,n)=>{let o,r=!1;return o=e((e=>{if(!r)return o?o.dispose():r=!0,t.call(i,e)}),null,n),r&&o.dispose(),o}}function i(e,t,i){return s(((i,n=null,o)=>e((e=>i.call(n,t(e))),null,o)),i)}function n(e,t,i){return s(((i,n=null,o)=>e((e=>{t(e),i.call(n,e)}),null,o)),i)}function o(e,t,i){return s(((i,n=null,o)=>e((e=>t(e)&&i.call(n,e)),null,o)),i)}function r(e,t,n,o){let r=n;return i(e,(e=>(r=t(r,e),r)),o)}function s(e,t){let i;const n=new Emitter$1({onFirstListenerAdd(){i=e(n.fire,n)},onLastListenerRemove(){i.dispose()}});return t&&t.add(n),n.event}function a(e,t,i=100,n=!1,o,r){let s,a,l,d=0;const c=new Emitter$1({leakWarningThreshold:o,onFirstListenerAdd(){s=e((e=>{d++,a=t(a,e),n&&!l&&(c.fire(a),a=void 0),clearTimeout(l),l=setTimeout((()=>{const e=a;a=void 0,l=void 0,(!n||d>1)&&c.fire(e),d=0}),i)}))},onLastListenerRemove(){s.dispose()}});return r&&r.add(c),c.event}function l(e,t=((e,t)=>e===t),i){let n,r=!0;return o(e,(e=>{const i=r||!t(e,n);return r=!1,n=e,i}),i)}e.None=()=>Disposable.None,e.once=t,e.map=i,e.forEach=n,e.filter=o,e.signal=function(e){return e},e.any=function(...e){return(t,i=null,n)=>combinedDisposable(...e.map((e=>e((e=>t.call(i,e)),null,n))))},e.reduce=r,e.debounce=a,e.latch=l,e.split=function(t,i,n){return[e.filter(t,i,n),e.filter(t,(e=>!i(e)),n)]},e.buffer=function(e,t=!1,i=[]){let n=i.slice(),o=e((e=>{n?n.push(e):s.fire(e)}));const r=()=>{n&&n.forEach((e=>s.fire(e))),n=null},s=new Emitter$1({onFirstListenerAdd(){o||(o=e((e=>s.fire(e))))},onFirstListenerDidAdd(){n&&(t?setTimeout(r):r())},onLastListenerRemove(){o&&o.dispose(),o=null}});return s.event};class d{constructor(e){this.event=e}map(e){return new d(i(this.event,e))}forEach(e){return new d(n(this.event,e))}filter(e){return new d(o(this.event,e))}reduce(e,t){return new d(r(this.event,e,t))}latch(){return new d(l(this.event))}debounce(e,t=100,i=!1,n){return new d(a(this.event,e,t,i,n))}on(e,t,i){return this.event(e,t,i)}once(e,i,n){return t(this.event)(e,i,n)}}e.chain=function(e){return new d(e)},e.fromNodeEventEmitter=function(e,t,i=(e=>e)){const n=(...e)=>o.fire(i(...e)),o=new Emitter$1({onFirstListenerAdd:()=>e.on(t,n),onLastListenerRemove:()=>e.removeListener(t,n)});return o.event},e.fromDOMEventEmitter=function(e,t,i=(e=>e)){const n=(...e)=>o.fire(i(...e)),o=new Emitter$1({onFirstListenerAdd:()=>e.addEventListener(t,n),onLastListenerRemove:()=>e.removeEventListener(t,n)});return o.event},e.toPromise=function(e){return new Promise((i=>t(e)(i)))},e.runAndSubscribe=function(e,t){return t(void 0),e((e=>t(e)))},e.runAndSubscribeWithStore=function(e,t){let i=null;function n(e){null==i||i.dispose(),i=new DisposableStore,t(e,i)}n(void 0);const o=e((e=>n(e)));return toDisposable((()=>{o.dispose(),null==i||i.dispose()}))}}(Event$1||(Event$1={}));class EventProfiling{constructor(e){this._listenerCount=0,this._invocationCount=0,this._elapsedOverall=0,this._name=`${e}_${EventProfiling._idPool++}`}start(e){this._stopWatch=new StopWatch(!0),this._listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this._elapsedOverall+=e,this._invocationCount+=1,this._stopWatch=void 0}}}EventProfiling._idPool=0;class Stacktrace{constructor(e){this.value=e}static create(){var e;return new Stacktrace(null!==(e=(new Error).stack)&&void 0!==e?e:"")}print(){}}class Listener{constructor(e,t,i){this.callback=e,this.callbackThis=t,this.stack=i,this.subscription=new SafeDisposable}invoke(e){this.callback.call(this.callbackThis,e)}}class Emitter$1{constructor(e){var t;this._disposed=!1,this._options=e,this._leakageMon=void 0,this._perfMon=(null===(t=this._options)||void 0===t?void 0:t._profName)?new EventProfiling(this._options._profName):void 0}dispose(){var e,t,i,n;this._disposed||(this._disposed=!0,this._listeners&&this._listeners.clear(),null===(e=this._deliveryQueue)||void 0===e||e.clear(),null===(i=null===(t=this._options)||void 0===t?void 0:t.onLastListenerRemove)||void 0===i||i.call(t),null===(n=this._leakageMon)||void 0===n||n.dispose())}get event(){return this._event||(this._event=(e,t,i)=>{var n,o,r;this._listeners||(this._listeners=new LinkedList);const s=this._listeners.isEmpty();let a,l;s&&(null===(n=this._options)||void 0===n?void 0:n.onFirstListenerAdd)&&this._options.onFirstListenerAdd(this),this._leakageMon&&this._listeners.size>=30&&(l=Stacktrace.create(),a=this._leakageMon.check(l,this._listeners.size+1));const d=new Listener(e,t,l),c=this._listeners.push(d);s&&(null===(o=this._options)||void 0===o?void 0:o.onFirstListenerDidAdd)&&this._options.onFirstListenerDidAdd(this),(null===(r=this._options)||void 0===r?void 0:r.onListenerDidAdd)&&this._options.onListenerDidAdd(this,e,t);const h=d.subscription.set((()=>{if(a&&a(),!this._disposed&&(c(),this._options&&this._options.onLastListenerRemove)){this._listeners&&!this._listeners.isEmpty()||this._options.onLastListenerRemove(this)}}));return i instanceof DisposableStore?i.add(h):Array.isArray(i)&&i.push(h),h}),this._event}fire(e){var t,i;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new LinkedList);for(let t of this._listeners)this._deliveryQueue.push([t,e]);for(null===(t=this._perfMon)||void 0===t||t.start(this._deliveryQueue.size);this._deliveryQueue.size>0;){const[e,t]=this._deliveryQueue.shift();try{e.invoke(t)}catch(e2){onUnexpectedError(e2)}}null===(i=this._perfMon)||void 0===i||i.stop()}}}class PauseableEmitter extends Emitter$1{constructor(e){super(e),this._isPaused=0,this._eventQueue=new LinkedList,this._mergeFn=null==e?void 0:e.merge}pause(){this._isPaused++}resume(){if(0!==this._isPaused&&0==--this._isPaused)if(this._mergeFn){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}else for(;!this._isPaused&&0!==this._eventQueue.size;)super.fire(this._eventQueue.shift())}fire(e){this._listeners&&(0!==this._isPaused?this._eventQueue.push(e):super.fire(e))}}class DebounceEmitter extends PauseableEmitter{constructor(e){var t;super(e),this._delay=null!==(t=e.delay)&&void 0!==t?t:100}fire(e){this._handle||(this.pause(),this._handle=setTimeout((()=>{this._handle=void 0,this.resume()}),this._delay)),super.fire(e)}}class EventBufferer{constructor(){this.buffers=[]}wrapEvent(e){return(t,i,n)=>e((e=>{const n=this.buffers[this.buffers.length-1];n?n.push((()=>t.call(i,e))):t.call(i,e)}),void 0,n)}bufferEvents(e){const t=[];this.buffers.push(t);const i=e();return this.buffers.pop(),t.forEach((e=>e())),i}}class Relay{constructor(){this.listening=!1,this.inputEvent=Event$1.None,this.inputEventListener=Disposable.None,this.emitter=new Emitter$1({onFirstListenerDidAdd:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onLastListenerRemove:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}class WindowManager{constructor(){this._zoomFactor=1}getZoomFactor(){return this._zoomFactor}}WindowManager.INSTANCE=new WindowManager;class DevicePixelRatioMonitor extends Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(!0),this._mediaQueryList=null,this._handleChange(!1)}_handleChange(e){this._mediaQueryList&&this._mediaQueryList.removeEventListener("change",this._listener),this._mediaQueryList=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),e&&this._onDidChange.fire()}}class PixelRatioImpl extends Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio();const e=this._register(new DevicePixelRatioMonitor);this._register(e.onDidChange((()=>{this._value=this._getPixelRatio(),this._onDidChange.fire(this._value)})))}get value(){return this._value}_getPixelRatio(){const e=document.createElement("canvas").getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}}class PixelRatioFacade{constructor(){this._pixelRatioMonitor=null}_getOrCreatePixelRatioMonitor(){return this._pixelRatioMonitor||(this._pixelRatioMonitor=new PixelRatioImpl),this._pixelRatioMonitor}get value(){return this._getOrCreatePixelRatioMonitor().value}get onDidChange(){return this._getOrCreatePixelRatioMonitor().onDidChange}}const PixelRatio=new PixelRatioFacade;function getZoomFactor(){return WindowManager.INSTANCE.getZoomFactor()}const userAgent=navigator.userAgent,isFirefox=userAgent.indexOf("Firefox")>=0,isWebKit=userAgent.indexOf("AppleWebKit")>=0,isChrome=userAgent.indexOf("Chrome")>=0,isSafari=!isChrome&&userAgent.indexOf("Safari")>=0,isWebkitWebView=!isChrome&&!isSafari&&isWebKit,isElectron=userAgent.indexOf("Electron/")>=0,isAndroid=userAgent.indexOf("Android")>=0,isStandalone=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches;var browser=Object.freeze(Object.defineProperty({__proto__:null,PixelRatio:PixelRatio,getZoomFactor:getZoomFactor,isFirefox:isFirefox,isWebKit:isWebKit,isChrome:isChrome,isSafari:isSafari,isWebkitWebView:isWebkitWebView,isElectron:isElectron,isAndroid:isAndroid,isStandalone:isStandalone},Symbol.toStringTag,{value:"Module"}));function isArray(e){return Array.isArray(e)}function isString$1(e){return"string"==typeof e}function isObject(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function isNumber$1(e){return"number"==typeof e&&!isNaN(e)}function isIterable(e){return!!e&&"function"==typeof e[Symbol.iterator]}function isBoolean(e){return!0===e||!1===e}function isUndefined(e){return void 0===e}function isDefined(e){return!isUndefinedOrNull(e)}function isUndefinedOrNull(e){return isUndefined(e)||null===e}function assertType(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function assertIsDefined(e){if(isUndefinedOrNull(e))throw new Error("Assertion Failed: argument is undefined or null");return e}function isFunction(e){return"function"==typeof e}function validateConstraints(e,t){const i=Math.min(e.length,t.length);for(let n=0;n<i;n++)validateConstraint(e[n],t[n])}function validateConstraint(e,t){if(isString$1(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(isFunction(t)){try{if(e instanceof t)return}catch(i){}if(!isUndefinedOrNull(e)&&e.constructor===t)return;if(1===t.length&&!0===t.call(void 0,e))return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function getAllPropertyNames(e){let t=[],i=Object.getPrototypeOf(e);for(;Object.prototype!==i;)t=t.concat(Object.getOwnPropertyNames(i)),i=Object.getPrototypeOf(i);return t}function getAllMethodNames(e){const t=[];for(const i of getAllPropertyNames(e))"function"==typeof e[i]&&t.push(i);return t}function createProxyObject$1(e,t){const i=e=>function(){const i=Array.prototype.slice.call(arguments,0);return t(e,i)};let n={};for(const o of e)n[o]=i(o);return n}function withNullAsUndefined(e){return null===e?void 0:e}function assertNever(e,t="Unreachable"){throw new Error(t)}const BrowserFeatures={clipboard:{writeText:isNative||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:isNative||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},keyboard:isNative||isStandalone?0:navigator.keyboard||isSafari?1:2,touch:"ontouchstart"in window||navigator.maxTouchPoints>0,pointerEvents:window.PointerEvent&&("ontouchstart"in window||window.navigator.maxTouchPoints>0||navigator.maxTouchPoints>0)};class KeyCodeStrMap{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const uiMap=new KeyCodeStrMap,userSettingsUSMap=new KeyCodeStrMap,userSettingsGeneralMap=new KeyCodeStrMap,EVENT_KEY_CODE_MAP=new Array(230),scanCodeStrToInt=Object.create(null),scanCodeLowerCaseStrToInt=Object.create(null),IMMUTABLE_CODE_TO_KEY_CODE=[];for(let e=0;e<=193;e++)IMMUTABLE_CODE_TO_KEY_CODE[e]=-1;var KeyCodeUtils,KeyCodeUtils2;function KeyChord(e,t){return(e|(65535&t)<<16>>>0)>>>0}function createKeybinding(e,t){if(0===e)return null;const i=(65535&e)>>>0,n=(4294901760&e)>>>16;return new ChordKeybinding(0!==n?[createSimpleKeybinding(i,t),createSimpleKeybinding(n,t)]:[createSimpleKeybinding(i,t)])}function createSimpleKeybinding(e,t){const i=!!(2048&e),n=!!(256&e);return new SimpleKeybinding(2===t?n:i,!!(1024&e),!!(512&e),2===t?i:n,255&e)}!function(){const e="",t=[[0,1,0,"None",0,"unknown",0,"VK_UNKNOWN",e,e],[0,1,1,"Hyper",0,e,0,e,e,e],[0,1,2,"Super",0,e,0,e,e,e],[0,1,3,"Fn",0,e,0,e,e,e],[0,1,4,"FnLock",0,e,0,e,e,e],[0,1,5,"Suspend",0,e,0,e,e,e],[0,1,6,"Resume",0,e,0,e,e,e],[0,1,7,"Turbo",0,e,0,e,e,e],[0,1,8,"Sleep",0,e,0,"VK_SLEEP",e,e],[0,1,9,"WakeUp",0,e,0,e,e,e],[31,0,10,"KeyA",31,"A",65,"VK_A",e,e],[32,0,11,"KeyB",32,"B",66,"VK_B",e,e],[33,0,12,"KeyC",33,"C",67,"VK_C",e,e],[34,0,13,"KeyD",34,"D",68,"VK_D",e,e],[35,0,14,"KeyE",35,"E",69,"VK_E",e,e],[36,0,15,"KeyF",36,"F",70,"VK_F",e,e],[37,0,16,"KeyG",37,"G",71,"VK_G",e,e],[38,0,17,"KeyH",38,"H",72,"VK_H",e,e],[39,0,18,"KeyI",39,"I",73,"VK_I",e,e],[40,0,19,"KeyJ",40,"J",74,"VK_J",e,e],[41,0,20,"KeyK",41,"K",75,"VK_K",e,e],[42,0,21,"KeyL",42,"L",76,"VK_L",e,e],[43,0,22,"KeyM",43,"M",77,"VK_M",e,e],[44,0,23,"KeyN",44,"N",78,"VK_N",e,e],[45,0,24,"KeyO",45,"O",79,"VK_O",e,e],[46,0,25,"KeyP",46,"P",80,"VK_P",e,e],[47,0,26,"KeyQ",47,"Q",81,"VK_Q",e,e],[48,0,27,"KeyR",48,"R",82,"VK_R",e,e],[49,0,28,"KeyS",49,"S",83,"VK_S",e,e],[50,0,29,"KeyT",50,"T",84,"VK_T",e,e],[51,0,30,"KeyU",51,"U",85,"VK_U",e,e],[52,0,31,"KeyV",52,"V",86,"VK_V",e,e],[53,0,32,"KeyW",53,"W",87,"VK_W",e,e],[54,0,33,"KeyX",54,"X",88,"VK_X",e,e],[55,0,34,"KeyY",55,"Y",89,"VK_Y",e,e],[56,0,35,"KeyZ",56,"Z",90,"VK_Z",e,e],[22,0,36,"Digit1",22,"1",49,"VK_1",e,e],[23,0,37,"Digit2",23,"2",50,"VK_2",e,e],[24,0,38,"Digit3",24,"3",51,"VK_3",e,e],[25,0,39,"Digit4",25,"4",52,"VK_4",e,e],[26,0,40,"Digit5",26,"5",53,"VK_5",e,e],[27,0,41,"Digit6",27,"6",54,"VK_6",e,e],[28,0,42,"Digit7",28,"7",55,"VK_7",e,e],[29,0,43,"Digit8",29,"8",56,"VK_8",e,e],[30,0,44,"Digit9",30,"9",57,"VK_9",e,e],[21,0,45,"Digit0",21,"0",48,"VK_0",e,e],[3,1,46,"Enter",3,"Enter",13,"VK_RETURN",e,e],[9,1,47,"Escape",9,"Escape",27,"VK_ESCAPE",e,e],[1,1,48,"Backspace",1,"Backspace",8,"VK_BACK",e,e],[2,1,49,"Tab",2,"Tab",9,"VK_TAB",e,e],[10,1,50,"Space",10,"Space",32,"VK_SPACE",e,e],[83,0,51,"Minus",83,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[81,0,52,"Equal",81,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[87,0,53,"BracketLeft",87,"[",219,"VK_OEM_4","[","OEM_4"],[89,0,54,"BracketRight",89,"]",221,"VK_OEM_6","]","OEM_6"],[88,0,55,"Backslash",88,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,0,56,"IntlHash",0,e,0,e,e,e],[80,0,57,"Semicolon",80,";",186,"VK_OEM_1",";","OEM_1"],[90,0,58,"Quote",90,"'",222,"VK_OEM_7","'","OEM_7"],[86,0,59,"Backquote",86,"`",192,"VK_OEM_3","`","OEM_3"],[82,0,60,"Comma",82,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[84,0,61,"Period",84,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[85,0,62,"Slash",85,"/",191,"VK_OEM_2","/","OEM_2"],[8,1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",e,e],[59,1,64,"F1",59,"F1",112,"VK_F1",e,e],[60,1,65,"F2",60,"F2",113,"VK_F2",e,e],[61,1,66,"F3",61,"F3",114,"VK_F3",e,e],[62,1,67,"F4",62,"F4",115,"VK_F4",e,e],[63,1,68,"F5",63,"F5",116,"VK_F5",e,e],[64,1,69,"F6",64,"F6",117,"VK_F6",e,e],[65,1,70,"F7",65,"F7",118,"VK_F7",e,e],[66,1,71,"F8",66,"F8",119,"VK_F8",e,e],[67,1,72,"F9",67,"F9",120,"VK_F9",e,e],[68,1,73,"F10",68,"F10",121,"VK_F10",e,e],[69,1,74,"F11",69,"F11",122,"VK_F11",e,e],[70,1,75,"F12",70,"F12",123,"VK_F12",e,e],[0,1,76,"PrintScreen",0,e,0,e,e,e],[79,1,77,"ScrollLock",79,"ScrollLock",145,"VK_SCROLL",e,e],[7,1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",e,e],[19,1,79,"Insert",19,"Insert",45,"VK_INSERT",e,e],[14,1,80,"Home",14,"Home",36,"VK_HOME",e,e],[11,1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",e,e],[20,1,82,"Delete",20,"Delete",46,"VK_DELETE",e,e],[13,1,83,"End",13,"End",35,"VK_END",e,e],[12,1,84,"PageDown",12,"PageDown",34,"VK_NEXT",e,e],[17,1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",e],[15,1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",e],[18,1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",e],[16,1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",e],[78,1,89,"NumLock",78,"NumLock",144,"VK_NUMLOCK",e,e],[108,1,90,"NumpadDivide",108,"NumPad_Divide",111,"VK_DIVIDE",e,e],[103,1,91,"NumpadMultiply",103,"NumPad_Multiply",106,"VK_MULTIPLY",e,e],[106,1,92,"NumpadSubtract",106,"NumPad_Subtract",109,"VK_SUBTRACT",e,e],[104,1,93,"NumpadAdd",104,"NumPad_Add",107,"VK_ADD",e,e],[3,1,94,"NumpadEnter",3,e,0,e,e,e],[94,1,95,"Numpad1",94,"NumPad1",97,"VK_NUMPAD1",e,e],[95,1,96,"Numpad2",95,"NumPad2",98,"VK_NUMPAD2",e,e],[96,1,97,"Numpad3",96,"NumPad3",99,"VK_NUMPAD3",e,e],[97,1,98,"Numpad4",97,"NumPad4",100,"VK_NUMPAD4",e,e],[98,1,99,"Numpad5",98,"NumPad5",101,"VK_NUMPAD5",e,e],[99,1,100,"Numpad6",99,"NumPad6",102,"VK_NUMPAD6",e,e],[100,1,101,"Numpad7",100,"NumPad7",103,"VK_NUMPAD7",e,e],[101,1,102,"Numpad8",101,"NumPad8",104,"VK_NUMPAD8",e,e],[102,1,103,"Numpad9",102,"NumPad9",105,"VK_NUMPAD9",e,e],[93,1,104,"Numpad0",93,"NumPad0",96,"VK_NUMPAD0",e,e],[107,1,105,"NumpadDecimal",107,"NumPad_Decimal",110,"VK_DECIMAL",e,e],[92,0,106,"IntlBackslash",92,"OEM_102",226,"VK_OEM_102",e,e],[58,1,107,"ContextMenu",58,"ContextMenu",93,e,e,e],[0,1,108,"Power",0,e,0,e,e,e],[0,1,109,"NumpadEqual",0,e,0,e,e,e],[71,1,110,"F13",71,"F13",124,"VK_F13",e,e],[72,1,111,"F14",72,"F14",125,"VK_F14",e,e],[73,1,112,"F15",73,"F15",126,"VK_F15",e,e],[74,1,113,"F16",74,"F16",127,"VK_F16",e,e],[75,1,114,"F17",75,"F17",128,"VK_F17",e,e],[76,1,115,"F18",76,"F18",129,"VK_F18",e,e],[77,1,116,"F19",77,"F19",130,"VK_F19",e,e],[0,1,117,"F20",0,e,0,"VK_F20",e,e],[0,1,118,"F21",0,e,0,"VK_F21",e,e],[0,1,119,"F22",0,e,0,"VK_F22",e,e],[0,1,120,"F23",0,e,0,"VK_F23",e,e],[0,1,121,"F24",0,e,0,"VK_F24",e,e],[0,1,122,"Open",0,e,0,e,e,e],[0,1,123,"Help",0,e,0,e,e,e],[0,1,124,"Select",0,e,0,e,e,e],[0,1,125,"Again",0,e,0,e,e,e],[0,1,126,"Undo",0,e,0,e,e,e],[0,1,127,"Cut",0,e,0,e,e,e],[0,1,128,"Copy",0,e,0,e,e,e],[0,1,129,"Paste",0,e,0,e,e,e],[0,1,130,"Find",0,e,0,e,e,e],[0,1,131,"AudioVolumeMute",112,"AudioVolumeMute",173,"VK_VOLUME_MUTE",e,e],[0,1,132,"AudioVolumeUp",113,"AudioVolumeUp",175,"VK_VOLUME_UP",e,e],[0,1,133,"AudioVolumeDown",114,"AudioVolumeDown",174,"VK_VOLUME_DOWN",e,e],[105,1,134,"NumpadComma",105,"NumPad_Separator",108,"VK_SEPARATOR",e,e],[110,0,135,"IntlRo",110,"ABNT_C1",193,"VK_ABNT_C1",e,e],[0,1,136,"KanaMode",0,e,0,e,e,e],[0,0,137,"IntlYen",0,e,0,e,e,e],[0,1,138,"Convert",0,e,0,e,e,e],[0,1,139,"NonConvert",0,e,0,e,e,e],[0,1,140,"Lang1",0,e,0,e,e,e],[0,1,141,"Lang2",0,e,0,e,e,e],[0,1,142,"Lang3",0,e,0,e,e,e],[0,1,143,"Lang4",0,e,0,e,e,e],[0,1,144,"Lang5",0,e,0,e,e,e],[0,1,145,"Abort",0,e,0,e,e,e],[0,1,146,"Props",0,e,0,e,e,e],[0,1,147,"NumpadParenLeft",0,e,0,e,e,e],[0,1,148,"NumpadParenRight",0,e,0,e,e,e],[0,1,149,"NumpadBackspace",0,e,0,e,e,e],[0,1,150,"NumpadMemoryStore",0,e,0,e,e,e],[0,1,151,"NumpadMemoryRecall",0,e,0,e,e,e],[0,1,152,"NumpadMemoryClear",0,e,0,e,e,e],[0,1,153,"NumpadMemoryAdd",0,e,0,e,e,e],[0,1,154,"NumpadMemorySubtract",0,e,0,e,e,e],[0,1,155,"NumpadClear",126,"Clear",12,"VK_CLEAR",e,e],[0,1,156,"NumpadClearEntry",0,e,0,e,e,e],[5,1,0,e,5,"Ctrl",17,"VK_CONTROL",e,e],[4,1,0,e,4,"Shift",16,"VK_SHIFT",e,e],[6,1,0,e,6,"Alt",18,"VK_MENU",e,e],[57,1,0,e,57,"Meta",0,"VK_COMMAND",e,e],[5,1,157,"ControlLeft",5,e,0,"VK_LCONTROL",e,e],[4,1,158,"ShiftLeft",4,e,0,"VK_LSHIFT",e,e],[6,1,159,"AltLeft",6,e,0,"VK_LMENU",e,e],[57,1,160,"MetaLeft",57,e,0,"VK_LWIN",e,e],[5,1,161,"ControlRight",5,e,0,"VK_RCONTROL",e,e],[4,1,162,"ShiftRight",4,e,0,"VK_RSHIFT",e,e],[6,1,163,"AltRight",6,e,0,"VK_RMENU",e,e],[57,1,164,"MetaRight",57,e,0,"VK_RWIN",e,e],[0,1,165,"BrightnessUp",0,e,0,e,e,e],[0,1,166,"BrightnessDown",0,e,0,e,e,e],[0,1,167,"MediaPlay",0,e,0,e,e,e],[0,1,168,"MediaRecord",0,e,0,e,e,e],[0,1,169,"MediaFastForward",0,e,0,e,e,e],[0,1,170,"MediaRewind",0,e,0,e,e,e],[114,1,171,"MediaTrackNext",119,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",e,e],[115,1,172,"MediaTrackPrevious",120,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",e,e],[116,1,173,"MediaStop",121,"MediaStop",178,"VK_MEDIA_STOP",e,e],[0,1,174,"Eject",0,e,0,e,e,e],[117,1,175,"MediaPlayPause",122,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",e,e],[0,1,176,"MediaSelect",123,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",e,e],[0,1,177,"LaunchMail",124,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",e,e],[0,1,178,"LaunchApp2",125,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",e,e],[0,1,179,"LaunchApp1",0,e,0,"VK_MEDIA_LAUNCH_APP1",e,e],[0,1,180,"SelectTask",0,e,0,e,e,e],[0,1,181,"LaunchScreenSaver",0,e,0,e,e,e],[0,1,182,"BrowserSearch",115,"BrowserSearch",170,"VK_BROWSER_SEARCH",e,e],[0,1,183,"BrowserHome",116,"BrowserHome",172,"VK_BROWSER_HOME",e,e],[112,1,184,"BrowserBack",117,"BrowserBack",166,"VK_BROWSER_BACK",e,e],[113,1,185,"BrowserForward",118,"BrowserForward",167,"VK_BROWSER_FORWARD",e,e],[0,1,186,"BrowserStop",0,e,0,"VK_BROWSER_STOP",e,e],[0,1,187,"BrowserRefresh",0,e,0,"VK_BROWSER_REFRESH",e,e],[0,1,188,"BrowserFavorites",0,e,0,"VK_BROWSER_FAVORITES",e,e],[0,1,189,"ZoomToggle",0,e,0,e,e,e],[0,1,190,"MailReply",0,e,0,e,e,e],[0,1,191,"MailForward",0,e,0,e,e,e],[0,1,192,"MailSend",0,e,0,e,e,e],[109,1,0,e,109,"KeyInComposition",229,e,e,e],[111,1,0,e,111,"ABNT_C2",194,"VK_ABNT_C2",e,e],[91,1,0,e,91,"OEM_8",223,"VK_OEM_8",e,e],[0,1,0,e,0,e,0,"VK_KANA",e,e],[0,1,0,e,0,e,0,"VK_HANGUL",e,e],[0,1,0,e,0,e,0,"VK_JUNJA",e,e],[0,1,0,e,0,e,0,"VK_FINAL",e,e],[0,1,0,e,0,e,0,"VK_HANJA",e,e],[0,1,0,e,0,e,0,"VK_KANJI",e,e],[0,1,0,e,0,e,0,"VK_CONVERT",e,e],[0,1,0,e,0,e,0,"VK_NONCONVERT",e,e],[0,1,0,e,0,e,0,"VK_ACCEPT",e,e],[0,1,0,e,0,e,0,"VK_MODECHANGE",e,e],[0,1,0,e,0,e,0,"VK_SELECT",e,e],[0,1,0,e,0,e,0,"VK_PRINT",e,e],[0,1,0,e,0,e,0,"VK_EXECUTE",e,e],[0,1,0,e,0,e,0,"VK_SNAPSHOT",e,e],[0,1,0,e,0,e,0,"VK_HELP",e,e],[0,1,0,e,0,e,0,"VK_APPS",e,e],[0,1,0,e,0,e,0,"VK_PROCESSKEY",e,e],[0,1,0,e,0,e,0,"VK_PACKET",e,e],[0,1,0,e,0,e,0,"VK_DBE_SBCSCHAR",e,e],[0,1,0,e,0,e,0,"VK_DBE_DBCSCHAR",e,e],[0,1,0,e,0,e,0,"VK_ATTN",e,e],[0,1,0,e,0,e,0,"VK_CRSEL",e,e],[0,1,0,e,0,e,0,"VK_EXSEL",e,e],[0,1,0,e,0,e,0,"VK_EREOF",e,e],[0,1,0,e,0,e,0,"VK_PLAY",e,e],[0,1,0,e,0,e,0,"VK_ZOOM",e,e],[0,1,0,e,0,e,0,"VK_NONAME",e,e],[0,1,0,e,0,e,0,"VK_PA1",e,e],[0,1,0,e,0,e,0,"VK_OEM_CLEAR",e,e]];let i=[],n=[];for(const o of t){const[e,t,r,s,a,l,d,c,h,u]=o;if(n[r]||(n[r]=!0,scanCodeStrToInt[s]=r,scanCodeLowerCaseStrToInt[s.toLowerCase()]=r,t&&(IMMUTABLE_CODE_TO_KEY_CODE[r]=a)),!i[a]){if(i[a]=!0,!l)throw new Error(`String representation missing for key code ${a} around scan code ${s}`);uiMap.define(a,l),userSettingsUSMap.define(a,h||l),userSettingsGeneralMap.define(a,u||h||l)}d&&(EVENT_KEY_CODE_MAP[d]=a)}}(),KeyCodeUtils2=KeyCodeUtils||(KeyCodeUtils={}),KeyCodeUtils2.toString=function(e){return uiMap.keyCodeToStr(e)},KeyCodeUtils2.fromString=function(e){return uiMap.strToKeyCode(e)},KeyCodeUtils2.toUserSettingsUS=function(e){return userSettingsUSMap.keyCodeToStr(e)},KeyCodeUtils2.toUserSettingsGeneral=function(e){return userSettingsGeneralMap.keyCodeToStr(e)},KeyCodeUtils2.fromUserSettings=function(e){return userSettingsUSMap.strToKeyCode(e)||userSettingsGeneralMap.strToKeyCode(e)},KeyCodeUtils2.toElectronAccelerator=function(e){if(e>=93&&e<=108)return null;switch(e){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return uiMap.keyCodeToStr(e)};class SimpleKeybinding{constructor(e,t,i,n,o){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=o}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return 0===this.keyCode||5===this.keyCode||57===this.keyCode||6===this.keyCode||4===this.keyCode}toChord(){return new ChordKeybinding([this])}isDuplicateModifierCase(){return this.ctrlKey&&5===this.keyCode||this.shiftKey&&4===this.keyCode||this.altKey&&6===this.keyCode||this.metaKey&&57===this.keyCode}}class ChordKeybinding{constructor(e){if(0===e.length)throw illegalArgument("parts");this.parts=e}}class ResolvedKeybindingPart{constructor(e,t,i,n,o,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=o,this.keyAriaLabel=r}}class ResolvedKeybinding{}function extractKeyCode(e){if(e.charCode){let t=String.fromCharCode(e.charCode).toUpperCase();return KeyCodeUtils.fromString(t)}const t=e.keyCode;if(3===t)return 7;if(isFirefox){if(59===t)return 80;if(107===t)return 81;if(109===t)return 83;if(isMacintosh&&224===t)return 57}else if(isWebKit){if(91===t)return 57;if(isMacintosh&&93===t)return 57;if(!isMacintosh&&92===t)return 57}return EVENT_KEY_CODE_MAP[t]||0}const ctrlKeyMod$1=isMacintosh?256:2048,altKeyMod=512,shiftKeyMod=1024,metaKeyMod=isMacintosh?2048:256;class StandardKeyboardEvent{constructor(e){this._standardKeyboardEventBrand=!0;let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.keyCode=extractKeyCode(t),this.code=t.code,this.ctrlKey=this.ctrlKey||5===this.keyCode,this.altKey=this.altKey||6===this.keyCode,this.shiftKey=this.shiftKey||4===this.keyCode,this.metaKey=this.metaKey||57===this.keyCode,this._asKeybinding=this._computeKeybinding(),this._asRuntimeKeybinding=this._computeRuntimeKeybinding()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeybinding(){return this._asRuntimeKeybinding}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=ctrlKeyMod$1),this.altKey&&(t|=altKeyMod),this.shiftKey&&(t|=shiftKeyMod),this.metaKey&&(t|=metaKeyMod),t|=e,t}_computeRuntimeKeybinding(){let e=0;return 5!==this.keyCode&&4!==this.keyCode&&6!==this.keyCode&&57!==this.keyCode&&(e=this.keyCode),new SimpleKeybinding(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}let hasDifferentOriginAncestorFlag=!1,sameOriginWindowChainCache=null;function getParentWindowIfSameOrigin(e){if(!e.parent||e.parent===e)return null;try{let t=e.location,i=e.parent.location;if("null"!==t.origin&&"null"!==i.origin&&t.origin!==i.origin)return hasDifferentOriginAncestorFlag=!0,null}catch(e2){return hasDifferentOriginAncestorFlag=!0,null}return e.parent}class IframeUtils{static getSameOriginWindowChain(){if(!sameOriginWindowChainCache){sameOriginWindowChainCache=[];let e,t=window;do{e=getParentWindowIfSameOrigin(t),e?sameOriginWindowChainCache.push({window:t,iframeElement:t.frameElement||null}):sameOriginWindowChainCache.push({window:t,iframeElement:null}),t=e}while(t)}return sameOriginWindowChainCache.slice(0)}static hasDifferentOriginAncestor(){return sameOriginWindowChainCache||this.getSameOriginWindowChain(),hasDifferentOriginAncestorFlag}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0,o=this.getSameOriginWindowChain();for(const r of o){if(i+=r.window.scrollY,n+=r.window.scrollX,r.window===t)break;if(!r.iframeElement)break;let e=r.iframeElement.getBoundingClientRect();i+=e.top,n+=e.left}return{top:i,left:n}}}class StandardMouseEvent{constructor(e){this.timestamp=Date.now(),this.browserEvent=e,this.leftButton=0===e.button,this.middleButton=1===e.button,this.rightButton=2===e.button,this.buttons=e.buttons,this.target=e.target,this.detail=e.detail||1,"dblclick"===e.type&&(this.detail=2),this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey,"number"==typeof e.pageX?(this.posx=e.pageX,this.posy=e.pageY):(this.posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);let t=IframeUtils.getPositionOfChildWindowRelativeToAncestorWindow(self,e.view);this.posx-=t.left,this.posy-=t.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class StandardWheelEvent{constructor(e,t=0,i=0){if(this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t,e){let t=e,i=e;if(void 0!==t.wheelDeltaY)this.deltaY=t.wheelDeltaY/120;else if(void 0!==i.VERTICAL_AXIS&&i.axis===i.VERTICAL_AXIS)this.deltaY=-i.detail/3;else if("wheel"===e.type){const t=e;t.deltaMode===t.DOM_DELTA_LINE?this.deltaY=isFirefox&&!isMacintosh?-e.deltaY/3:-e.deltaY:this.deltaY=-e.deltaY/40}if(void 0!==t.wheelDeltaX)this.deltaX=isSafari&&isWindows?-t.wheelDeltaX/120:t.wheelDeltaX/120;else if(void 0!==i.HORIZONTAL_AXIS&&i.axis===i.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if("wheel"===e.type){const t=e;t.deltaMode===t.DOM_DELTA_LINE?this.deltaX=isFirefox&&!isMacintosh?-e.deltaX/3:-e.deltaX:this.deltaX=-e.deltaX/40}0===this.deltaY&&0===this.deltaX&&e.wheelDelta&&(this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation()}}const shortcutEvent=Object.freeze((function(e,t){const i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}));var CancellationToken,CancellationToken2;CancellationToken2=CancellationToken||(CancellationToken={}),CancellationToken2.isCancellationToken=function(e){return e===CancellationToken2.None||e===CancellationToken2.Cancelled||e instanceof MutableToken||!(!e||"object"!=typeof e)&&"boolean"==typeof e.isCancellationRequested&&"function"==typeof e.onCancellationRequested},CancellationToken2.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Event$1.None}),CancellationToken2.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:shortcutEvent});class MutableToken{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?shortcutEvent:(this._emitter||(this._emitter=new Emitter$1),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class CancellationTokenSource$1{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=CancellationToken.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener&&this._parentListener.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=CancellationToken.None}}var __awaiter$16=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__asyncValues$2=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};function isThenable$1(e){return!!e&&"function"==typeof e.then}function createCancelablePromise(e){const t=new CancellationTokenSource$1,i=e(t.token),n=new Promise(((e,n)=>{const o=t.token.onCancellationRequested((()=>{o.dispose(),t.dispose(),n(new CancellationError)}));Promise.resolve(i).then((i=>{o.dispose(),t.dispose(),e(i)}),(e=>{o.dispose(),t.dispose(),n(e)}))}));return new class{cancel(){t.cancel()}then(e,t){return n.then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return n.finally(e)}}}function raceCancellation(e,t,i){return new Promise(((n,o)=>{const r=t.onCancellationRequested((()=>{r.dispose(),n(i)}));e.then(n,o).finally((()=>r.dispose()))}))}class Throttler{constructor(){this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const e=()=>{this.queuedPromise=null;const e=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,e};this.queuedPromise=new Promise((t=>{this.activePromise.then(e,e).then(t)}))}return new Promise(((e,t)=>{this.queuedPromise.then(e,t)}))}return this.activePromise=e(),new Promise(((e,t)=>{this.activePromise.then((t=>{this.activePromise=null,e(t)}),(e=>{this.activePromise=null,t(e)}))}))}}const timeoutDeferred=(e,t)=>{let i=!0;const n=setTimeout((()=>{i=!1,t()}),e);return{isTriggered:()=>i,dispose:()=>{clearTimeout(n),i=!1}}},microtaskDeferred=e=>{let t=!0;return queueMicrotask((()=>{t&&(t=!1,e())})),{isTriggered:()=>t,dispose:()=>{t=!1}}},MicrotaskDelay=Symbol("MicrotaskDelay");class Delayer{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(((e,t)=>{this.doResolve=e,this.doReject=t})).then((()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const e=this.task;return this.task=null,e()}})));const i=()=>{var e;this.deferred=null,null===(e=this.doResolve)||void 0===e||e.call(this,null)};return this.deferred=t===MicrotaskDelay?microtaskDeferred(i):timeoutDeferred(t,i),this.completionPromise}isTriggered(){var e;return!!(null===(e=this.deferred)||void 0===e?void 0:e.isTriggered())}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject&&this.doReject(new CancellationError),this.completionPromise=null)}cancelTimeout(){var e;null===(e=this.deferred)||void 0===e||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class ThrottledDelayer{constructor(e){this.delayer=new Delayer(e),this.throttler=new Throttler}trigger(e,t){return this.delayer.trigger((()=>this.throttler.queue(e)),t)}dispose(){this.delayer.dispose()}}function timeout(e,t){return t?new Promise(((i,n)=>{const o=setTimeout((()=>{r.dispose(),i()}),e),r=t.onCancellationRequested((()=>{clearTimeout(o),r.dispose(),n(new CancellationError)}))})):createCancelablePromise((t=>timeout(e,t)))}function disposableTimeout(e,t=0){const i=setTimeout(e,t);return toDisposable((()=>clearTimeout(i)))}function first(e,t=(e=>!!e),i=null){let n=0;const o=e.length,r=()=>{if(n>=o)return Promise.resolve(i);const s=e[n++];return Promise.resolve(s()).then((e=>t(e)?Promise.resolve(e):r()))};return r()}class TimeoutTimer{constructor(e,t){this._token=-1,"function"==typeof e&&"number"==typeof t&&this.setIfNotSet(e,t)}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setTimeout((()=>{this._token=-1,e()}),t)}setIfNotSet(e,t){-1===this._token&&(this._token=setTimeout((()=>{this._token=-1,e()}),t))}}class IntervalTimer{constructor(){this._token=-1}dispose(){this.cancel()}cancel(){-1!==this._token&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval((()=>{e()}),t)}}class RunOnceScheduler{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return-1!==this.timeoutToken}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner&&this.runner()}}let runWhenIdle;runWhenIdle="function"!=typeof requestIdleCallback||"function"!=typeof cancelIdleCallback?e=>{setTimeout0((()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining:()=>Math.max(0,i-Date.now())}))}));let t=!1;return{dispose(){t||(t=!0)}}}:(e,t)=>{const i=requestIdleCallback(e,"number"==typeof t?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,cancelIdleCallback(i))}}};class IdleValue{constructor(e){this._didRun=!1,this._executor=()=>{try{this._value=e()}catch(t){this._error=t}finally{this._didRun=!0}},this._handle=runWhenIdle((()=>this._executor()))}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class DeferredPromise{constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}get isRejected(){return this.rejected}get isSettled(){return this.rejected||this.resolved}complete(e){return new Promise((t=>{this.completeCallback(e),this.resolved=!0,t()}))}cancel(){new Promise((e=>{this.errorCallback(new CancellationError),this.rejected=!0,e()}))}}var Promises,Promises2;Promises2=Promises||(Promises={}),Promises2.settled=function(e){return __awaiter$16(this,void 0,void 0,(function*(){let t;const i=yield Promise.all(e.map((e=>e.then((e=>e),(e=>{t||(t=e)})))));if(void 0!==t)throw t;return i}))},Promises2.withAsyncBody=function(e){return new Promise(((t,i)=>__awaiter$16(this,void 0,void 0,(function*(){try{yield e(t,i)}catch(n){i(n)}}))))};class AsyncIterableObject{constructor(e){this._state=0,this._results=[],this._error=null,this._onStateChanged=new Emitter$1,queueMicrotask((()=>__awaiter$16(this,void 0,void 0,(function*(){const t={emitOne:e=>this.emitOne(e),emitMany:e=>this.emitMany(e),reject:e=>this.reject(e)};try{yield Promise.resolve(e(t)),this.resolve()}catch(i){this.reject(i)}finally{t.emitOne=void 0,t.emitMany=void 0,t.reject=void 0}}))))}static fromArray(e){return new AsyncIterableObject((t=>{t.emitMany(e)}))}static fromPromise(e){return new AsyncIterableObject((t=>__awaiter$16(this,void 0,void 0,(function*(){t.emitMany(yield e)}))))}static fromPromises(e){return new AsyncIterableObject((t=>__awaiter$16(this,void 0,void 0,(function*(){yield Promise.all(e.map((e=>__awaiter$16(this,void 0,void 0,(function*(){return t.emitOne(yield e)})))))}))))}static merge(e){return new AsyncIterableObject((t=>__awaiter$16(this,void 0,void 0,(function*(){yield Promise.all(e.map((e=>{var i,n;return __awaiter$16(this,void 0,void 0,(function*(){var o,r;try{for(i=__asyncValues$2(e);!(n=yield i.next()).done;){const e=n.value;t.emitOne(e)}}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&(yield r.call(i))}finally{if(o)throw o.error}}}))})))}))))}[Symbol.asyncIterator](){let e=0;return{next:()=>__awaiter$16(this,void 0,void 0,(function*(){for(;;){if(2===this._state)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(1===this._state)return{done:!0,value:void 0};yield Event$1.toPromise(this._onStateChanged.event)}}))}}static map(e,t){return new AsyncIterableObject((i=>__awaiter$16(this,void 0,void 0,(function*(){var n,o;try{for(var r,s=__asyncValues$2(e);!(r=yield s.next()).done;){const e=r.value;i.emitOne(t(e))}}catch(a){n={error:a}}finally{try{r&&!r.done&&(o=s.return)&&(yield o.call(s))}finally{if(n)throw n.error}}}))))}map(e){return AsyncIterableObject.map(this,e)}static filter(e,t){return new AsyncIterableObject((i=>__awaiter$16(this,void 0,void 0,(function*(){var n,o;try{for(var r,s=__asyncValues$2(e);!(r=yield s.next()).done;){const e=r.value;t(e)&&i.emitOne(e)}}catch(a){n={error:a}}finally{try{r&&!r.done&&(o=s.return)&&(yield o.call(s))}finally{if(n)throw n.error}}}))))}filter(e){return AsyncIterableObject.filter(this,e)}static coalesce(e){return AsyncIterableObject.filter(e,(e=>!!e))}coalesce(){return AsyncIterableObject.coalesce(this)}static toPromise(e){var t,i,n,o;return __awaiter$16(this,void 0,void 0,(function*(){const r=[];try{for(t=__asyncValues$2(e);!(i=yield t.next()).done;){const e=i.value;r.push(e)}}catch(s){n={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(n)throw n.error}}return r}))}toPromise(){return AsyncIterableObject.toPromise(this)}emitOne(e){0===this._state&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){0===this._state&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){0===this._state&&(this._state=1,this._onStateChanged.fire())}reject(e){0===this._state&&(this._state=2,this._error=e,this._onStateChanged.fire())}}AsyncIterableObject.EMPTY=AsyncIterableObject.fromArray([]);class CancelableAsyncIterableObject extends AsyncIterableObject{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function createCancelableAsyncIterable(e){const t=new CancellationTokenSource$1,i=e(t.token);return new CancelableAsyncIterableObject(t,(e=>__awaiter$16(this,void 0,void 0,(function*(){var n,o;const r=t.token.onCancellationRequested((()=>{r.dispose(),t.dispose(),e.reject(new CancellationError)}));try{try{for(var s,a=__asyncValues$2(i);!(s=yield a.next()).done;){const i=s.value;if(t.token.isCancellationRequested)return;e.emitOne(i)}}catch(l){n={error:l}}finally{try{s&&!s.done&&(o=a.return)&&(yield o.call(a))}finally{if(n)throw n.error}}r.dispose(),t.dispose()}catch(d){r.dispose(),t.dispose(),e.reject(d)}}))))}let safeProcess;if(void 0!==globals.vscode&&void 0!==globals.vscode.process){const e=globals.vscode.process;safeProcess={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd:()=>e.cwd()}}else safeProcess="undefined"!=typeof process?{get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd:()=>process.env.VSCODE_CWD||process.cwd()}:{get platform(){return isWindows?"win32":isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd:()=>"/"};const cwd=safeProcess.cwd,env=safeProcess.env,platform=safeProcess.platform,CHAR_UPPERCASE_A=65,CHAR_LOWERCASE_A=97,CHAR_UPPERCASE_Z=90,CHAR_LOWERCASE_Z=122,CHAR_DOT=46,CHAR_FORWARD_SLASH=47,CHAR_BACKWARD_SLASH=92,CHAR_COLON=58,CHAR_QUESTION_MARK=63;class ErrorInvalidArgType extends Error{constructor(e,t,i){let n;"string"==typeof t&&0===t.indexOf("not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be";const o=-1!==e.indexOf(".")?"property":"argument";let r=`The "${e}" ${o} ${n} of type ${t}`;r+=". Received type "+typeof i,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function validateString(e,t){if("string"!=typeof e)throw new ErrorInvalidArgType(t,"string",e)}function isPathSeparator$1(e){return e===CHAR_FORWARD_SLASH||e===CHAR_BACKWARD_SLASH}function isPosixPathSeparator(e){return e===CHAR_FORWARD_SLASH}function isWindowsDeviceRoot(e){return e>=CHAR_UPPERCASE_A&&e<=CHAR_UPPERCASE_Z||e>=CHAR_LOWERCASE_A&&e<=CHAR_LOWERCASE_Z}function normalizeString(e,t,i,n){let o="",r=0,s=-1,a=0,l=0;for(let d=0;d<=e.length;++d){if(d<e.length)l=e.charCodeAt(d);else{if(n(l))break;l=CHAR_FORWARD_SLASH}if(n(l)){if(s===d-1||1===a);else if(2===a){if(o.length<2||2!==r||o.charCodeAt(o.length-1)!==CHAR_DOT||o.charCodeAt(o.length-2)!==CHAR_DOT){if(o.length>2){const e=o.lastIndexOf(i);-1===e?(o="",r=0):(o=o.slice(0,e),r=o.length-1-o.lastIndexOf(i)),s=d,a=0;continue}if(0!==o.length){o="",r=0,s=d,a=0;continue}}t&&(o+=o.length>0?`${i}..`:"..",r=2)}else o.length>0?o+=`${i}${e.slice(s+1,d)}`:o=e.slice(s+1,d),r=d-s-1;s=d,a=0}else l===CHAR_DOT&&-1!==a?++a:a=-1}return o}function _format(e,t){if(null===t||"object"!=typeof t)throw new ErrorInvalidArgType("pathObject","Object",t);const i=t.dir||t.root,n=t.base||`${t.name||""}${t.ext||""}`;return i?i===t.root?`${i}${n}`:`${i}${e}${n}`:n}const win32={resolve(...e){let t="",i="",n=!1;for(let o=e.length-1;o>=-1;o--){let r;if(o>=0){if(r=e[o],validateString(r,"path"),0===r.length)continue}else 0===t.length?r=cwd():(r=env[`=${t}`]||cwd(),(void 0===r||r.slice(0,2).toLowerCase()!==t.toLowerCase()&&r.charCodeAt(2)===CHAR_BACKWARD_SLASH)&&(r=`${t}\\`));const s=r.length;let a=0,l="",d=!1;const c=r.charCodeAt(0);if(1===s)isPathSeparator$1(c)&&(a=1,d=!0);else if(isPathSeparator$1(c))if(d=!0,isPathSeparator$1(r.charCodeAt(1))){let e=2,t=e;for(;e<s&&!isPathSeparator$1(r.charCodeAt(e));)e++;if(e<s&&e!==t){const i=r.slice(t,e);for(t=e;e<s&&isPathSeparator$1(r.charCodeAt(e));)e++;if(e<s&&e!==t){for(t=e;e<s&&!isPathSeparator$1(r.charCodeAt(e));)e++;e!==s&&e===t||(l=`\\\\${i}\\${r.slice(t,e)}`,a=e)}}}else a=1;else isWindowsDeviceRoot(c)&&r.charCodeAt(1)===CHAR_COLON&&(l=r.slice(0,2),a=2,s>2&&isPathSeparator$1(r.charCodeAt(2))&&(d=!0,a=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(n){if(t.length>0)break}else if(i=`${r.slice(a)}\\${i}`,n=d,d&&t.length>0)break}return i=normalizeString(i,!n,"\\",isPathSeparator$1),n?`${t}\\${i}`:`${t}${i}`||"."},normalize(e){validateString(e,"path");const t=e.length;if(0===t)return".";let i,n=0,o=!1;const r=e.charCodeAt(0);if(1===t)return isPosixPathSeparator(r)?"\\":e;if(isPathSeparator$1(r))if(o=!0,isPathSeparator$1(e.charCodeAt(1))){let o=2,r=o;for(;o<t&&!isPathSeparator$1(e.charCodeAt(o));)o++;if(o<t&&o!==r){const s=e.slice(r,o);for(r=o;o<t&&isPathSeparator$1(e.charCodeAt(o));)o++;if(o<t&&o!==r){for(r=o;o<t&&!isPathSeparator$1(e.charCodeAt(o));)o++;if(o===t)return`\\\\${s}\\${e.slice(r)}\\`;o!==r&&(i=`\\\\${s}\\${e.slice(r,o)}`,n=o)}}}else n=1;else isWindowsDeviceRoot(r)&&e.charCodeAt(1)===CHAR_COLON&&(i=e.slice(0,2),n=2,t>2&&isPathSeparator$1(e.charCodeAt(2))&&(o=!0,n=3));let s=n<t?normalizeString(e.slice(n),!o,"\\",isPathSeparator$1):"";return 0!==s.length||o||(s="."),s.length>0&&isPathSeparator$1(e.charCodeAt(t-1))&&(s+="\\"),void 0===i?o?`\\${s}`:s:o?`${i}\\${s}`:`${i}${s}`},isAbsolute(e){validateString(e,"path");const t=e.length;if(0===t)return!1;const i=e.charCodeAt(0);return isPathSeparator$1(i)||t>2&&isWindowsDeviceRoot(i)&&e.charCodeAt(1)===CHAR_COLON&&isPathSeparator$1(e.charCodeAt(2))},join(...e){if(0===e.length)return".";let t,i;for(let r=0;r<e.length;++r){const n=e[r];validateString(n,"path"),n.length>0&&(void 0===t?t=i=n:t+=`\\${n}`)}if(void 0===t)return".";let n=!0,o=0;if("string"==typeof i&&isPathSeparator$1(i.charCodeAt(0))){++o;const e=i.length;e>1&&isPathSeparator$1(i.charCodeAt(1))&&(++o,e>2&&(isPathSeparator$1(i.charCodeAt(2))?++o:n=!1))}if(n){for(;o<t.length&&isPathSeparator$1(t.charCodeAt(o));)o++;o>=2&&(t=`\\${t.slice(o)}`)}return win32.normalize(t)},relative(e,t){if(validateString(e,"from"),validateString(t,"to"),e===t)return"";const i=win32.resolve(e),n=win32.resolve(t);if(i===n)return"";if((e=i.toLowerCase())===(t=n.toLowerCase()))return"";let o=0;for(;o<e.length&&e.charCodeAt(o)===CHAR_BACKWARD_SLASH;)o++;let r=e.length;for(;r-1>o&&e.charCodeAt(r-1)===CHAR_BACKWARD_SLASH;)r--;const s=r-o;let a=0;for(;a<t.length&&t.charCodeAt(a)===CHAR_BACKWARD_SLASH;)a++;let l=t.length;for(;l-1>a&&t.charCodeAt(l-1)===CHAR_BACKWARD_SLASH;)l--;const d=l-a,c=s<d?s:d;let h=-1,u=0;for(;u<c;u++){const i=e.charCodeAt(o+u);if(i!==t.charCodeAt(a+u))break;i===CHAR_BACKWARD_SLASH&&(h=u)}if(u!==c){if(-1===h)return n}else{if(d>c){if(t.charCodeAt(a+u)===CHAR_BACKWARD_SLASH)return n.slice(a+u+1);if(2===u)return n.slice(a+u)}s>c&&(e.charCodeAt(o+u)===CHAR_BACKWARD_SLASH?h=u:2===u&&(h=3)),-1===h&&(h=0)}let g="";for(u=o+h+1;u<=r;++u)u!==r&&e.charCodeAt(u)!==CHAR_BACKWARD_SLASH||(g+=0===g.length?"..":"\\..");return a+=h,g.length>0?`${g}${n.slice(a,l)}`:(n.charCodeAt(a)===CHAR_BACKWARD_SLASH&&++a,n.slice(a,l))},toNamespacedPath(e){if("string"!=typeof e)return e;if(0===e.length)return"";const t=win32.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===CHAR_BACKWARD_SLASH){if(t.charCodeAt(1)===CHAR_BACKWARD_SLASH){const e=t.charCodeAt(2);if(e!==CHAR_QUESTION_MARK&&e!==CHAR_DOT)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(isWindowsDeviceRoot(t.charCodeAt(0))&&t.charCodeAt(1)===CHAR_COLON&&t.charCodeAt(2)===CHAR_BACKWARD_SLASH)return`\\\\?\\${t}`;return e},dirname(e){validateString(e,"path");const t=e.length;if(0===t)return".";let i=-1,n=0;const o=e.charCodeAt(0);if(1===t)return isPathSeparator$1(o)?e:".";if(isPathSeparator$1(o)){if(i=n=1,isPathSeparator$1(e.charCodeAt(1))){let o=2,r=o;for(;o<t&&!isPathSeparator$1(e.charCodeAt(o));)o++;if(o<t&&o!==r){for(r=o;o<t&&isPathSeparator$1(e.charCodeAt(o));)o++;if(o<t&&o!==r){for(r=o;o<t&&!isPathSeparator$1(e.charCodeAt(o));)o++;if(o===t)return e;o!==r&&(i=n=o+1)}}}}else isWindowsDeviceRoot(o)&&e.charCodeAt(1)===CHAR_COLON&&(i=t>2&&isPathSeparator$1(e.charCodeAt(2))?3:2,n=i);let r=-1,s=!0;for(let a=t-1;a>=n;--a)if(isPathSeparator$1(e.charCodeAt(a))){if(!s){r=a;break}}else s=!1;if(-1===r){if(-1===i)return".";r=i}return e.slice(0,r)},basename(e,t){void 0!==t&&validateString(t,"ext"),validateString(e,"path");let i,n=0,o=-1,r=!0;if(e.length>=2&&isWindowsDeviceRoot(e.charCodeAt(0))&&e.charCodeAt(1)===CHAR_COLON&&(n=2),void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let s=t.length-1,a=-1;for(i=e.length-1;i>=n;--i){const l=e.charCodeAt(i);if(isPathSeparator$1(l)){if(!r){n=i+1;break}}else-1===a&&(r=!1,a=i+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(o=i):(s=-1,o=a))}return n===o?o=a:-1===o&&(o=e.length),e.slice(n,o)}for(i=e.length-1;i>=n;--i)if(isPathSeparator$1(e.charCodeAt(i))){if(!r){n=i+1;break}}else-1===o&&(r=!1,o=i+1);return-1===o?"":e.slice(n,o)},extname(e){validateString(e,"path");let t=0,i=-1,n=0,o=-1,r=!0,s=0;e.length>=2&&e.charCodeAt(1)===CHAR_COLON&&isWindowsDeviceRoot(e.charCodeAt(0))&&(t=n=2);for(let a=e.length-1;a>=t;--a){const t=e.charCodeAt(a);if(isPathSeparator$1(t)){if(!r){n=a+1;break}}else-1===o&&(r=!1,o=a+1),t===CHAR_DOT?-1===i?i=a:1!==s&&(s=1):-1!==i&&(s=-1)}return-1===i||-1===o||0===s||1===s&&i===o-1&&i===n+1?"":e.slice(i,o)},format:_format.bind(null,"\\"),parse(e){validateString(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const i=e.length;let n=0,o=e.charCodeAt(0);if(1===i)return isPathSeparator$1(o)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(isPathSeparator$1(o)){if(n=1,isPathSeparator$1(e.charCodeAt(1))){let t=2,o=t;for(;t<i&&!isPathSeparator$1(e.charCodeAt(t));)t++;if(t<i&&t!==o){for(o=t;t<i&&isPathSeparator$1(e.charCodeAt(t));)t++;if(t<i&&t!==o){for(o=t;t<i&&!isPathSeparator$1(e.charCodeAt(t));)t++;t===i?n=t:t!==o&&(n=t+1)}}}}else if(isWindowsDeviceRoot(o)&&e.charCodeAt(1)===CHAR_COLON){if(i<=2)return t.root=t.dir=e,t;if(n=2,isPathSeparator$1(e.charCodeAt(2))){if(3===i)return t.root=t.dir=e,t;n=3}}n>0&&(t.root=e.slice(0,n));let r=-1,s=n,a=-1,l=!0,d=e.length-1,c=0;for(;d>=n;--d)if(o=e.charCodeAt(d),isPathSeparator$1(o)){if(!l){s=d+1;break}}else-1===a&&(l=!1,a=d+1),o===CHAR_DOT?-1===r?r=d:1!==c&&(c=1):-1!==r&&(c=-1);return-1!==a&&(-1===r||0===c||1===c&&r===a-1&&r===s+1?t.base=t.name=e.slice(s,a):(t.name=e.slice(s,r),t.base=e.slice(s,a),t.ext=e.slice(r,a))),t.dir=s>0&&s!==n?e.slice(0,s-1):t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},posix={resolve(...e){let t="",i=!1;for(let n=e.length-1;n>=-1&&!i;n--){const o=n>=0?e[n]:cwd();validateString(o,"path"),0!==o.length&&(t=`${o}/${t}`,i=o.charCodeAt(0)===CHAR_FORWARD_SLASH)}return t=normalizeString(t,!i,"/",isPosixPathSeparator),i?`/${t}`:t.length>0?t:"."},normalize(e){if(validateString(e,"path"),0===e.length)return".";const t=e.charCodeAt(0)===CHAR_FORWARD_SLASH,i=e.charCodeAt(e.length-1)===CHAR_FORWARD_SLASH;return 0===(e=normalizeString(e,!t,"/",isPosixPathSeparator)).length?t?"/":i?"./":".":(i&&(e+="/"),t?`/${e}`:e)},isAbsolute:e=>(validateString(e,"path"),e.length>0&&e.charCodeAt(0)===CHAR_FORWARD_SLASH),join(...e){if(0===e.length)return".";let t;for(let i=0;i<e.length;++i){const n=e[i];validateString(n,"path"),n.length>0&&(void 0===t?t=n:t+=`/${n}`)}return void 0===t?".":posix.normalize(t)},relative(e,t){if(validateString(e,"from"),validateString(t,"to"),e===t)return"";if((e=posix.resolve(e))===(t=posix.resolve(t)))return"";const i=e.length,n=i-1,o=t.length-1,r=n<o?n:o;let s=-1,a=0;for(;a<r;a++){const i=e.charCodeAt(1+a);if(i!==t.charCodeAt(1+a))break;i===CHAR_FORWARD_SLASH&&(s=a)}if(a===r)if(o>r){if(t.charCodeAt(1+a)===CHAR_FORWARD_SLASH)return t.slice(1+a+1);if(0===a)return t.slice(1+a)}else n>r&&(e.charCodeAt(1+a)===CHAR_FORWARD_SLASH?s=a:0===a&&(s=0));let l="";for(a=1+s+1;a<=i;++a)a!==i&&e.charCodeAt(a)!==CHAR_FORWARD_SLASH||(l+=0===l.length?"..":"/..");return`${l}${t.slice(1+s)}`},toNamespacedPath:e=>e,dirname(e){if(validateString(e,"path"),0===e.length)return".";const t=e.charCodeAt(0)===CHAR_FORWARD_SLASH;let i=-1,n=!0;for(let o=e.length-1;o>=1;--o)if(e.charCodeAt(o)===CHAR_FORWARD_SLASH){if(!n){i=o;break}}else n=!1;return-1===i?t?"/":".":t&&1===i?"//":e.slice(0,i)},basename(e,t){void 0!==t&&validateString(t,"ext"),validateString(e,"path");let i,n=0,o=-1,r=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let s=t.length-1,a=-1;for(i=e.length-1;i>=0;--i){const l=e.charCodeAt(i);if(l===CHAR_FORWARD_SLASH){if(!r){n=i+1;break}}else-1===a&&(r=!1,a=i+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(o=i):(s=-1,o=a))}return n===o?o=a:-1===o&&(o=e.length),e.slice(n,o)}for(i=e.length-1;i>=0;--i)if(e.charCodeAt(i)===CHAR_FORWARD_SLASH){if(!r){n=i+1;break}}else-1===o&&(r=!1,o=i+1);return-1===o?"":e.slice(n,o)},extname(e){validateString(e,"path");let t=-1,i=0,n=-1,o=!0,r=0;for(let s=e.length-1;s>=0;--s){const a=e.charCodeAt(s);if(a!==CHAR_FORWARD_SLASH)-1===n&&(o=!1,n=s+1),a===CHAR_DOT?-1===t?t=s:1!==r&&(r=1):-1!==t&&(r=-1);else if(!o){i=s+1;break}}return-1===t||-1===n||0===r||1===r&&t===n-1&&t===i+1?"":e.slice(t,n)},format:_format.bind(null,"/"),parse(e){validateString(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const i=e.charCodeAt(0)===CHAR_FORWARD_SLASH;let n;i?(t.root="/",n=1):n=0;let o=-1,r=0,s=-1,a=!0,l=e.length-1,d=0;for(;l>=n;--l){const t=e.charCodeAt(l);if(t!==CHAR_FORWARD_SLASH)-1===s&&(a=!1,s=l+1),t===CHAR_DOT?-1===o?o=l:1!==d&&(d=1):-1!==o&&(d=-1);else if(!a){r=l+1;break}}if(-1!==s){const n=0===r&&i?1:r;-1===o||0===d||1===d&&o===s-1&&o===r+1?t.base=t.name=e.slice(n,s):(t.name=e.slice(n,o),t.base=e.slice(n,s),t.ext=e.slice(o,s))}return r>0?t.dir=e.slice(0,r-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};posix.win32=win32.win32=win32,posix.posix=win32.posix=posix;const normalize="win32"===platform?win32.normalize:posix.normalize,resolve="win32"===platform?win32.resolve:posix.resolve,relative="win32"===platform?win32.relative:posix.relative,dirname$1="win32"===platform?win32.dirname:posix.dirname,basename$1="win32"===platform?win32.basename:posix.basename,extname$1="win32"===platform?win32.extname:posix.extname,sep="win32"===platform?win32.sep:posix.sep,_schemePattern=/^\w[\w\d+.-]*$/,_singleSlashStart=/^\//,_doubleSlashStart=/^\/\//;function _validateUri(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!_schemePattern.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!_singleSlashStart.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(_doubleSlashStart.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}function _schemeFix(e,t){return e||t?e:"file"}function _referenceResolution(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==_slash&&(t=_slash+t):t=_slash}return t}const _empty="",_slash="/",_regexp=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class URI{constructor(e,t,i,n,o,r=!1){"object"==typeof e?(this.scheme=e.scheme||_empty,this.authority=e.authority||_empty,this.path=e.path||_empty,this.query=e.query||_empty,this.fragment=e.fragment||_empty):(this.scheme=_schemeFix(e,r),this.authority=t||_empty,this.path=_referenceResolution(this.scheme,i||_empty),this.query=n||_empty,this.fragment=o||_empty,_validateUri(this,r))}static isUri(e){return e instanceof URI||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString)}get fsPath(){return uriToFsPath(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:o,fragment:r}=e;return void 0===t?t=this.scheme:null===t&&(t=_empty),void 0===i?i=this.authority:null===i&&(i=_empty),void 0===n?n=this.path:null===n&&(n=_empty),void 0===o?o=this.query:null===o&&(o=_empty),void 0===r?r=this.fragment:null===r&&(r=_empty),t===this.scheme&&i===this.authority&&n===this.path&&o===this.query&&r===this.fragment?this:new Uri$1(t,i,n,o,r)}static parse(e,t=!1){const i=_regexp.exec(e);return i?new Uri$1(i[2]||_empty,percentDecode(i[4]||_empty),percentDecode(i[5]||_empty),percentDecode(i[7]||_empty),percentDecode(i[9]||_empty),t):new Uri$1(_empty,_empty,_empty,_empty,_empty)}static file(e){let t=_empty;if(isWindows&&(e=e.replace(/\\/g,_slash)),e[0]===_slash&&e[1]===_slash){const i=e.indexOf(_slash,2);-1===i?(t=e.substring(2),e=_slash):(t=e.substring(2,i),e=e.substring(i)||_slash)}return new Uri$1("file",t,e,_empty,_empty)}static from(e){const t=new Uri$1(e.scheme,e.authority,e.path,e.query,e.fragment);return _validateUri(t,!0),t}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return i=isWindows&&"file"===e.scheme?URI.file(win32.join(uriToFsPath(e,!0),...t)).path:posix.join(e.path,...t),e.with({path:i})}toString(e=!1){return _asFormatted(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof URI)return e;{const t=new Uri$1(e);return t._formatted=e.external,t._fsPath=e._sep===_pathSepMarker?e.fsPath:null,t}}return e}}const _pathSepMarker=isWindows?1:void 0;class Uri$1 extends URI{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=uriToFsPath(this,!1)),this._fsPath}toString(e=!1){return e?_asFormatted(this,!0):(this._formatted||(this._formatted=_asFormatted(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=_pathSepMarker),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const encodeTable={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function encodeURIComponentFast(e,t){let i,n=-1;for(let o=0;o<e.length;o++){const r=e.charCodeAt(o);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||45===r||46===r||95===r||126===r||t&&47===r)-1!==n&&(i+=encodeURIComponent(e.substring(n,o)),n=-1),void 0!==i&&(i+=e.charAt(o));else{void 0===i&&(i=e.substr(0,o));const t=encodeTable[r];void 0!==t?(-1!==n&&(i+=encodeURIComponent(e.substring(n,o)),n=-1),i+=t):-1===n&&(n=o)}}return-1!==n&&(i+=encodeURIComponent(e.substring(n))),void 0!==i?i:e}function encodeURIComponentMinimal(e){let t;for(let i=0;i<e.length;i++){const n=e.charCodeAt(i);35===n||63===n?(void 0===t&&(t=e.substr(0,i)),t+=encodeTable[n]):void 0!==t&&(t+=e[i])}return void 0!==t?t:e}function uriToFsPath(e,t){let i;return i=e.authority&&e.path.length>1&&"file"===e.scheme?`//${e.authority}${e.path}`:47===e.path.charCodeAt(0)&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&58===e.path.charCodeAt(2)?t?e.path.substr(1):e.path[1].toLowerCase()+e.path.substr(2):e.path,isWindows&&(i=i.replace(/\//g,"\\")),i}function _asFormatted(e,t){const i=t?encodeURIComponentMinimal:encodeURIComponentFast;let n="",{scheme:o,authority:r,path:s,query:a,fragment:l}=e;if(o&&(n+=o,n+=":"),(r||"file"===o)&&(n+=_slash,n+=_slash),r){let e=r.indexOf("@");if(-1!==e){const t=r.substr(0,e);r=r.substr(e+1),e=t.indexOf(":"),-1===e?n+=i(t,!1):(n+=i(t.substr(0,e),!1),n+=":",n+=i(t.substr(e+1),!1)),n+="@"}r=r.toLowerCase(),e=r.indexOf(":"),-1===e?n+=i(r,!1):(n+=i(r.substr(0,e),!1),n+=r.substr(e))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2)){const e=s.charCodeAt(1);e>=65&&e<=90&&(s=`/${String.fromCharCode(e+32)}:${s.substr(3)}`)}else if(s.length>=2&&58===s.charCodeAt(1)){const e=s.charCodeAt(0);e>=65&&e<=90&&(s=`${String.fromCharCode(e+32)}:${s.substr(2)}`)}n+=i(s,!0)}return a&&(n+="?",n+=i(a,!1)),l&&(n+="#",n+=t?l:encodeURIComponentFast(l,!1)),n}function decodeURIComponentGraceful(e){try{return decodeURIComponent(e)}catch(t){return e.length>3?e.substr(0,3)+decodeURIComponentGraceful(e.substr(3)):e}}const _rEncodedAsHex=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function percentDecode(e){return e.match(_rEncodedAsHex)?e.replace(_rEncodedAsHex,(e=>decodeURIComponentGraceful(e))):e}var Schemas,Schemas2;Schemas2=Schemas||(Schemas={}),Schemas2.inMemory="inmemory",Schemas2.vscode="vscode",Schemas2.internal="private",Schemas2.walkThrough="walkThrough",Schemas2.walkThroughSnippet="walkThroughSnippet",Schemas2.http="http",Schemas2.https="https",Schemas2.file="file",Schemas2.mailto="mailto",Schemas2.untitled="untitled",Schemas2.data="data",Schemas2.command="command",Schemas2.vscodeRemote="vscode-remote",Schemas2.vscodeRemoteResource="vscode-remote-resource",Schemas2.userData="vscode-userdata",Schemas2.vscodeCustomEditor="vscode-custom-editor",Schemas2.vscodeNotebook="vscode-notebook",Schemas2.vscodeNotebookCell="vscode-notebook-cell",Schemas2.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Schemas2.vscodeNotebookCellOutput="vscode-notebook-cell-output",Schemas2.vscodeInteractive="vscode-interactive",Schemas2.vscodeInteractiveInput="vscode-interactive-input",Schemas2.vscodeSettings="vscode-settings",Schemas2.vscodeWorkspaceTrust="vscode-workspace-trust",Schemas2.vscodeTerminal="vscode-terminal",Schemas2.webviewPanel="webview-panel",Schemas2.vscodeWebview="vscode-webview",Schemas2.extension="extension",Schemas2.vscodeFileResource="vscode-file",Schemas2.tmp="tmp",Schemas2.vsls="vsls";const connectionTokenQueryName="tkn";class RemoteAuthoritiesImpl{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null}setPreferredWebSchema(e){this._preferredWebSchema=e}rewrite(e){if(this._delegate)return this._delegate(e);const t=e.authority;let i=this._hosts[t];i&&-1!==i.indexOf(":")&&(i=`[${i}]`);const n=this._ports[t],o=this._connectionTokens[t];let r=`path=${encodeURIComponent(e.path)}`;return"string"==typeof o&&(r+=`&${connectionTokenQueryName}=${encodeURIComponent(o)}`),URI.from({scheme:isWeb?this._preferredWebSchema:Schemas.vscodeRemoteResource,authority:`${i}:${n}`,path:"/vscode-remote-resource",query:r})}}const RemoteAuthorities=new RemoteAuthoritiesImpl;class FileAccessImpl{asBrowserUri(e,t){const i=this.toUri(e,t);return i.scheme===Schemas.vscodeRemote?RemoteAuthorities.rewrite(i):i.scheme===Schemas.file&&(isNative||isWebWorker&&globals.origin===`${Schemas.vscodeFileResource}://${FileAccessImpl.FALLBACK_AUTHORITY}`)?i.with({scheme:Schemas.vscodeFileResource,authority:i.authority||FileAccessImpl.FALLBACK_AUTHORITY,query:null,fragment:null}):i}toUri(e,t){return URI.isUri(e)?e:URI.parse(t.toUrl(e))}}FileAccessImpl.FALLBACK_AUTHORITY="vscode-app";const FileAccess=new FileAccessImpl;function clearNode(e){for(;e.firstChild;)e.firstChild.remove()}function isInDOM(e){var t;return null!==(t=null==e?void 0:e.isConnected)&&void 0!==t&&t}class DomListener{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(e,t,i,n){return new DomListener(e,t,i,n)}function _wrapAsStandardMouseEvent(e){return function(t){return e(new StandardMouseEvent(t))}}function _wrapAsStandardKeyboardEvent(e){return function(t){return e(new StandardKeyboardEvent(t))}}let addStandardDisposableListener=function(e,t,i,n){let o=i;return"click"===t||"mousedown"===t?o=_wrapAsStandardMouseEvent(i):"keydown"!==t&&"keypress"!==t&&"keyup"!==t||(o=_wrapAsStandardKeyboardEvent(i)),addDisposableListener(e,t,o,n)},addStandardDisposableGenericMouseDownListener=function(e,t,i){return addDisposableGenericMouseDownListener(e,_wrapAsStandardMouseEvent(t),i)};function addDisposableGenericMouseDownListener(e,t,i){return addDisposableListener(e,isIOS&&BrowserFeatures.pointerEvents?EventType$1.POINTER_DOWN:EventType$1.MOUSE_DOWN,t,i)}function addDisposableGenericMouseUpListener(e,t,i){return addDisposableListener(e,isIOS&&BrowserFeatures.pointerEvents?EventType$1.POINTER_UP:EventType$1.MOUSE_UP,t,i)}function addDisposableNonBubblingMouseOutListener(e,t){return addDisposableListener(e,"mouseout",(i=>{let n=i.relatedTarget;for(;n&&n!==e;)n=n.parentNode;n!==e&&t(i)}))}function addDisposableNonBubblingPointerOutListener(e,t){return addDisposableListener(e,"pointerout",(i=>{let n=i.relatedTarget;for(;n&&n!==e;)n=n.parentNode;n!==e&&t(i)}))}function createEventEmitter(e,t,i){let n=null;const o=e=>r.fire(e),r=new Emitter$1({onFirstListenerAdd:()=>{n||(n=new DomListener(e,t,o,i))},onLastListenerRemove:()=>{n&&(n.dispose(),n=null)}});return r}let _animationFrame=null,runAtThisOrScheduleAtNextAnimationFrame,scheduleAtNextAnimationFrame;function doRequestAnimationFrame(e){if(!_animationFrame){const e=e=>setTimeout((()=>e((new Date).getTime())),0);_animationFrame=self.requestAnimationFrame||self.msRequestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||e}return _animationFrame.call(self,e)}class AnimationFrameQueueItem{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e2){onUnexpectedError(e2)}}static sort(e,t){return t.priority-e.priority}}!function(){let e=[],t=null,i=!1,n=!1,o=()=>{for(i=!1,t=e,e=[],n=!0;t.length>0;){t.sort(AnimationFrameQueueItem.sort),t.shift().execute()}n=!1};scheduleAtNextAnimationFrame=(t,n=0)=>{let r=new AnimationFrameQueueItem(t,n);return e.push(r),i||(i=!0,doRequestAnimationFrame(o)),r},runAtThisOrScheduleAtNextAnimationFrame=(e,i)=>{if(n){let n=new AnimationFrameQueueItem(e,i);return t.push(n),n}return scheduleAtNextAnimationFrame(e,i)}}();const MINIMUM_TIME_MS=8,DEFAULT_EVENT_MERGER=function(e,t){return t};class TimeoutThrottledDomListener extends Disposable{constructor(e,t,i,n=DEFAULT_EVENT_MERGER,o=MINIMUM_TIME_MS){super();let r=null,s=0,a=this._register(new TimeoutTimer),l=()=>{s=(new Date).getTime(),i(r),r=null};this._register(addDisposableListener(e,t,(e=>{r=n(r,e);let t=(new Date).getTime()-s;t>=o?(a.cancel(),l()):a.setIfNotSet(l,o-t)})))}}function addDisposableThrottledListener(e,t,i,n,o){return new TimeoutThrottledDomListener(e,t,i,n,o)}function getComputedStyle$1(e){return document.defaultView.getComputedStyle(e,null)}function getClientArea(e){if(e!==document.body)return new Dimension(e.clientWidth,e.clientHeight);if(isIOS&&window.visualViewport)return new Dimension(window.visualViewport.width,window.visualViewport.height);if(window.innerWidth&&window.innerHeight)return new Dimension(window.innerWidth,window.innerHeight);if(document.body&&document.body.clientWidth&&document.body.clientHeight)return new Dimension(document.body.clientWidth,document.body.clientHeight);if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientHeight)return new Dimension(document.documentElement.clientWidth,document.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class SizeUtils{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){let n=getComputedStyle$1(e),o="0";return n&&(o=n.getPropertyValue?n.getPropertyValue(t):n.getAttribute(i)),SizeUtils.convertToPixels(e,o)}static getBorderLeftWidth(e){return SizeUtils.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return SizeUtils.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return SizeUtils.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return SizeUtils.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return SizeUtils.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return SizeUtils.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return SizeUtils.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return SizeUtils.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return SizeUtils.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return SizeUtils.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return SizeUtils.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return SizeUtils.getDimension(e,"margin-bottom","marginBottom")}}class Dimension{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new Dimension(e,t):this}static is(e){return"object"==typeof e&&"number"==typeof e.height&&"number"==typeof e.width}static lift(e){return e instanceof Dimension?e:new Dimension(e.width,e.height)}static equals(e,t){return e===t||!(!e||!t)&&(e.width===t.width&&e.height===t.height)}}function getTopLeftOffset(e){let t=e.offsetParent,i=e.offsetTop,n=e.offsetLeft;for(;null!==(e=e.parentNode)&&e!==document.body&&e!==document.documentElement;){i-=e.scrollTop;const o=isShadowRoot(e)?null:getComputedStyle$1(e);o&&(n-="rtl"!==o.direction?e.scrollLeft:-e.scrollLeft),e===t&&(n+=SizeUtils.getBorderLeftWidth(e),i+=SizeUtils.getBorderTopWidth(e),i+=e.offsetTop,n+=e.offsetLeft,t=e.offsetParent)}return{left:n,top:i}}function size(e,t,i){"number"==typeof t&&(e.style.width=`${t}px`),"number"==typeof i&&(e.style.height=`${i}px`)}function getDomNodePagePosition(e){let t=e.getBoundingClientRect();return{left:t.left+StandardWindow.scrollX,top:t.top+StandardWindow.scrollY,width:t.width,height:t.height}}Dimension.None=new Dimension(0,0);const StandardWindow=new class{get scrollX(){return"number"==typeof window.scrollX?window.scrollX:document.body.scrollLeft+document.documentElement.scrollLeft}get scrollY(){return"number"==typeof window.scrollY?window.scrollY:document.body.scrollTop+document.documentElement.scrollTop}};function getTotalWidth(e){let t=SizeUtils.getMarginLeft(e)+SizeUtils.getMarginRight(e);return e.offsetWidth+t}function getContentWidth(e){let t=SizeUtils.getBorderLeftWidth(e)+SizeUtils.getBorderRightWidth(e),i=SizeUtils.getPaddingLeft(e)+SizeUtils.getPaddingRight(e);return e.offsetWidth-t-i}function getContentHeight(e){let t=SizeUtils.getBorderTopWidth(e)+SizeUtils.getBorderBottomWidth(e),i=SizeUtils.getPaddingTop(e)+SizeUtils.getPaddingBottom(e);return e.offsetHeight-t-i}function getTotalHeight(e){let t=SizeUtils.getMarginTop(e)+SizeUtils.getMarginBottom(e);return e.offsetHeight+t}function isAncestor$1(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function findParentWithClass(e,t,i){for(;e&&e.nodeType===e.ELEMENT_NODE;){if(e.classList.contains(t))return e;if(i)if("string"==typeof i){if(e.classList.contains(i))return null}else if(e===i)return null;e=e.parentNode}return null}function hasParentWithClass(e,t,i){return!!findParentWithClass(e,t,i)}function isShadowRoot(e){return e&&!!e.host&&!!e.mode}function isInShadowDOM(e){return!!getShadowRoot(e)}function getShadowRoot(e){for(;e.parentNode;){if(e===document.body)return null;e=e.parentNode}return isShadowRoot(e)?e:null}function getActiveElement(){let e=document.activeElement;for(;null==e?void 0:e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function createStyleSheet(e=document.getElementsByTagName("head")[0]){let t=document.createElement("style");return t.type="text/css",t.media="screen",e.appendChild(t),t}let _sharedStyleSheet=null;function getSharedStyleSheet(){return _sharedStyleSheet||(_sharedStyleSheet=createStyleSheet()),_sharedStyleSheet}function getDynamicStyleSheetRules(e){var t,i;return(null===(t=null==e?void 0:e.sheet)||void 0===t?void 0:t.rules)?e.sheet.rules:(null===(i=null==e?void 0:e.sheet)||void 0===i?void 0:i.cssRules)?e.sheet.cssRules:[]}function createCSSRule(e,t,i=getSharedStyleSheet()){i&&t&&i.sheet.insertRule(e+"{"+t+"}",0)}function removeCSSRulesContainingSelector(e,t=getSharedStyleSheet()){if(!t)return;let i=getDynamicStyleSheetRules(t),n=[];for(let o=0;o<i.length;o++){-1!==i[o].selectorText.indexOf(e)&&n.push(o)}for(let o=n.length-1;o>=0;o--)t.sheet.deleteRule(n[o])}function isHTMLElement(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}const EventType$1={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",CONTEXT_MENU:"contextmenu",WHEEL:"wheel",KEY_DOWN:"keydown",KEY_PRESS:"keypress",KEY_UP:"keyup",LOAD:"load",BEFORE_UNLOAD:"beforeunload",UNLOAD:"unload",PAGE_SHOW:"pageshow",PAGE_HIDE:"pagehide",ABORT:"abort",ERROR:"error",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_CHANGE:"fullscreenchange",WK_FULLSCREEN_CHANGE:"webkitfullscreenchange",SELECT:"select",CHANGE:"change",SUBMIT:"submit",RESET:"reset",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",STORAGE:"storage",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend",ANIMATION_START:isWebKit?"webkitAnimationStart":"animationstart",ANIMATION_END:isWebKit?"webkitAnimationEnd":"animationend",ANIMATION_ITERATION:isWebKit?"webkitAnimationIteration":"animationiteration"},EventHelper={stop:function(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}};function saveParentsScrollTop(e){let t=[];for(let i=0;e&&e.nodeType===e.ELEMENT_NODE;i++)t[i]=e.scrollTop,e=e.parentNode;return t}function restoreParentsScrollTop(e,t){for(let i=0;e&&e.nodeType===e.ELEMENT_NODE;i++)e.scrollTop!==t[i]&&(e.scrollTop=t[i]),e=e.parentNode}class FocusTracker extends Disposable{constructor(e){super(),this._onDidFocus=this._register(new Emitter$1),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new Emitter$1),this.onDidBlur=this._onDidBlur.event;let t=FocusTracker.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},o=()=>{t&&(i=!0,window.setTimeout((()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())}),0))};this._refreshStateHandler=()=>{FocusTracker.hasFocusWithin(e)!==t&&(t?o():n())},this._register(addDisposableListener(e,EventType$1.FOCUS,n,!0)),this._register(addDisposableListener(e,EventType$1.BLUR,o,!0)),this._register(addDisposableListener(e,EventType$1.FOCUS_IN,(()=>this._refreshStateHandler()))),this._register(addDisposableListener(e,EventType$1.FOCUS_OUT,(()=>this._refreshStateHandler())))}static hasFocusWithin(e){const t=getShadowRoot(e);return isAncestor$1(t?t.activeElement:document.activeElement,e)}}function trackFocus(e){return new FocusTracker(e)}function append$1(e,...t){if(e.append(...t),1===t.length&&"string"!=typeof t[0])return t[0]}function prepend$1(e,t){return e.insertBefore(t,e.firstChild),t}function reset(e,...t){e.innerText="",append$1(e,...t)}const SELECTOR_REGEX=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var Namespace,Namespace2;function _$(e,t,i,...n){let o=SELECTOR_REGEX.exec(t);if(!o)throw new Error("Bad use of emmet");i=Object.assign({},i||{});let r,s=o[1]||"div";return r=e!==Namespace.HTML?document.createElementNS(e,s):document.createElement(s),o[3]&&(r.id=o[3]),o[4]&&(r.className=o[4].replace(/\./g," ").trim()),Object.keys(i).forEach((e=>{const t=i[e];void 0!==t&&(/^on\w+$/.test(e)?r[e]=t:"selected"===e?t&&r.setAttribute(e,"true"):r.setAttribute(e,t))})),r.append(...n),r}function $$c(e,t,...i){return _$(Namespace.HTML,e,t,...i)}function show(...e){for(let t of e)t.style.display="",t.removeAttribute("aria-hidden")}function hide(...e){for(let t of e)t.style.display="none",t.setAttribute("aria-hidden","true")}function getElementsByTagName(e){return Array.prototype.slice.call(document.getElementsByTagName(e),0)}function computeScreenAwareSize(e){const t=window.devicePixelRatio*e;return Math.max(1,Math.floor(t))/window.devicePixelRatio}function windowOpenNoOpener(e){window.open(e,"_blank","noopener")}function animate(e){const t=()=>{e(),i=scheduleAtNextAnimationFrame(t)};let i=scheduleAtNextAnimationFrame(t);return toDisposable((()=>i.dispose()))}function asCSSUrl(e){return e?`url('${FileAccess.asBrowserUri(e).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function asCSSPropertyValue(e){return`'${e.replace(/'/g,"%27")}'`}Namespace2=Namespace||(Namespace={}),Namespace2.HTML="http://www.w3.org/1999/xhtml",Namespace2.SVG="http://www.w3.org/2000/svg",$$c.SVG=function(e,t,...i){return _$(Namespace.SVG,e,t,...i)},RemoteAuthorities.setPreferredWebSchema(/^https:/.test(window.location.href)?"https":"http");class ModifierKeyEmitter extends Emitter$1{constructor(){super(),this._subscriptions=new DisposableStore,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(addDisposableListener(window,"keydown",(e=>{if(e.defaultPrevented)return;const t=new StandardKeyboardEvent(e);if(6!==t.keyCode||!e.repeat){if(e.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(e.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(e.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(e.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else{if(6===t.keyCode)return;this._keyStatus.lastKeyPressed=void 0}this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=e,this.fire(this._keyStatus))}}),!0)),this._subscriptions.add(addDisposableListener(window,"keyup",(e=>{e.defaultPrevented||(!e.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!e.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!e.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!e.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=e.altKey,this._keyStatus.ctrlKey=e.ctrlKey,this._keyStatus.metaKey=e.metaKey,this._keyStatus.shiftKey=e.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=e,this.fire(this._keyStatus)))}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mousedown",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mouseup",(()=>{this._keyStatus.lastKeyPressed=void 0}),!0)),this._subscriptions.add(addDisposableListener(document.body,"mousemove",(e=>{e.buttons&&(this._keyStatus.lastKeyPressed=void 0)}),!0)),this._subscriptions.add(addDisposableListener(window,"blur",(()=>{this.resetKeyStatus()})))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return ModifierKeyEmitter.instance||(ModifierKeyEmitter.instance=new ModifierKeyEmitter),ModifierKeyEmitter.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}function addMatchMediaChangeListener(e,t){window.matchMedia(e).addEventListener("change",t)}var aria="";const MAX_MESSAGE_LENGTH=2e4;let ariaContainer,alertContainer,alertContainer2,statusContainer,statusContainer2;function setARIAContainer(e){ariaContainer=document.createElement("div"),ariaContainer.className="monaco-aria-container";const t=()=>{const e=document.createElement("div");return e.className="monaco-alert",e.setAttribute("role","alert"),e.setAttribute("aria-atomic","true"),ariaContainer.appendChild(e),e};alertContainer=t(),alertContainer2=t();const i=()=>{const e=document.createElement("div");return e.className="monaco-status",e.setAttribute("role","complementary"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),ariaContainer.appendChild(e),e};statusContainer=i(),statusContainer2=i(),e.appendChild(ariaContainer)}function alert(e){ariaContainer&&(alertContainer.textContent!==e?(clearNode(alertContainer2),insertMessage(alertContainer,e)):(clearNode(alertContainer),insertMessage(alertContainer2,e)))}function status(e){ariaContainer&&(isMacintosh?alert(e):statusContainer.textContent!==e?(clearNode(statusContainer2),insertMessage(statusContainer,e)):(clearNode(statusContainer),insertMessage(statusContainer2,e)))}function insertMessage(e,t){clearNode(e),t.length>MAX_MESSAGE_LENGTH&&(t=t.substr(0,MAX_MESSAGE_LENGTH)),e.textContent=t,e.style.visibility="hidden",e.style.visibility="visible"}var _util,_util2;_util2=_util||(_util={}),_util2.serviceIds=new Map,_util2.DI_TARGET="$di$target",_util2.DI_DEPENDENCIES="$di$dependencies",_util2.getServiceDependencies=function(e){return e[_util2.DI_DEPENDENCIES]||[]};const IInstantiationService=createDecorator("instantiationService");function storeServiceDependency(e,t,i){t[_util.DI_TARGET]===t?t[_util.DI_DEPENDENCIES].push({id:e,index:i}):(t[_util.DI_DEPENDENCIES]=[{id:e,index:i}],t[_util.DI_TARGET]=t)}function createDecorator(e){if(_util.serviceIds.has(e))return _util.serviceIds.get(e);const t=function(e,i,n){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");storeServiceDependency(t,e,n)};return t.toString=()=>e,_util.serviceIds.set(e,t),t}const ICodeEditorService=createDecorator("codeEditorService");class Position$1{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Position$1(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Position$1.equals(this,e)}static equals(e,t){return!e&&!t||!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Position$1.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<t.column}isBeforeOrEqual(e){return Position$1.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber||!(t.lineNumber<e.lineNumber)&&e.column<=t.column}static compare(e,t){const i=0|e.lineNumber,n=0|t.lineNumber;if(i===n){return(0|e.column)-(0|t.column)}return i-n}clone(){return new Position$1(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Position$1(e.lineNumber,e.column)}static isIPosition(e){return e&&"number"==typeof e.lineNumber&&"number"==typeof e.column}}const IModelService=createDecorator("modelService"),ITextModelService=createDecorator("textModelService");var __awaiter$15=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},CSSIcon;class Action extends Disposable{constructor(e,t="",i="",n=!0,o){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=o}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}run(e,t){return __awaiter$15(this,void 0,void 0,(function*(){this._actionCallback&&(yield this._actionCallback(e))}))}}class ActionRunner extends Disposable{constructor(){super(...arguments),this._onBeforeRun=this._register(new Emitter$1),this.onBeforeRun=this._onBeforeRun.event,this._onDidRun=this._register(new Emitter$1),this.onDidRun=this._onDidRun.event}run(e,t){return __awaiter$15(this,void 0,void 0,(function*(){if(!e.enabled)return;let i;this._onBeforeRun.fire({action:e});try{yield this.runAction(e,t)}catch(e2){i=e2}this._onDidRun.fire({action:e,error:i})}))}runAction(e,t){return __awaiter$15(this,void 0,void 0,(function*(){yield e.run(t)}))}}class Separator extends Action{constructor(e){super(Separator.ID,e,e?"separator text":"separator"),this.checked=!1,this.enabled=!1}}Separator.ID="vs.actions.separator";class SubmenuAction{constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}get actions(){return this._actions}dispose(){}run(){return __awaiter$15(this,void 0,void 0,(function*(){}))}}class EmptySubmenuAction extends Action{constructor(){super(EmptySubmenuAction.ID,localize("submenu.empty","(empty)"),void 0,!1)}}function getCodiconAriaLabel(e){return e?e.replace(/\$\((.*?)\)/g,((e,t)=>` ${t} `)).trim():""}EmptySubmenuAction.ID="vs.actions.empty";class Codicon{constructor(e,t,i){this.id=e,this.definition=t,this.description=i,Codicon._allCodicons.push(this)}get classNames(){return"codicon codicon-"+this.id}get classNamesArray(){return["codicon","codicon-"+this.id]}get cssSelector(){return".codicon.codicon-"+this.id}static getAll(){return Codicon._allCodicons}}Codicon._allCodicons=[],Codicon.add=new Codicon("add",{fontCharacter:"\\ea60"}),Codicon.plus=new Codicon("plus",Codicon.add.definition),Codicon.gistNew=new Codicon("gist-new",Codicon.add.definition),Codicon.repoCreate=new Codicon("repo-create",Codicon.add.definition),Codicon.lightbulb=new Codicon("lightbulb",{fontCharacter:"\\ea61"}),Codicon.lightBulb=new Codicon("light-bulb",{fontCharacter:"\\ea61"}),Codicon.repo=new Codicon("repo",{fontCharacter:"\\ea62"}),Codicon.repoDelete=new Codicon("repo-delete",{fontCharacter:"\\ea62"}),Codicon.gistFork=new Codicon("gist-fork",{fontCharacter:"\\ea63"}),Codicon.repoForked=new Codicon("repo-forked",{fontCharacter:"\\ea63"}),Codicon.gitPullRequest=new Codicon("git-pull-request",{fontCharacter:"\\ea64"}),Codicon.gitPullRequestAbandoned=new Codicon("git-pull-request-abandoned",{fontCharacter:"\\ea64"}),Codicon.recordKeys=new Codicon("record-keys",{fontCharacter:"\\ea65"}),Codicon.keyboard=new Codicon("keyboard",{fontCharacter:"\\ea65"}),Codicon.tag=new Codicon("tag",{fontCharacter:"\\ea66"}),Codicon.tagAdd=new Codicon("tag-add",{fontCharacter:"\\ea66"}),Codicon.tagRemove=new Codicon("tag-remove",{fontCharacter:"\\ea66"}),Codicon.person=new Codicon("person",{fontCharacter:"\\ea67"}),Codicon.personFollow=new Codicon("person-follow",{fontCharacter:"\\ea67"}),Codicon.personOutline=new Codicon("person-outline",{fontCharacter:"\\ea67"}),Codicon.personFilled=new Codicon("person-filled",{fontCharacter:"\\ea67"}),Codicon.gitBranch=new Codicon("git-branch",{fontCharacter:"\\ea68"}),Codicon.gitBranchCreate=new Codicon("git-branch-create",{fontCharacter:"\\ea68"}),Codicon.gitBranchDelete=new Codicon("git-branch-delete",{fontCharacter:"\\ea68"}),Codicon.sourceControl=new Codicon("source-control",{fontCharacter:"\\ea68"}),Codicon.mirror=new Codicon("mirror",{fontCharacter:"\\ea69"}),Codicon.mirrorPublic=new Codicon("mirror-public",{fontCharacter:"\\ea69"}),Codicon.star=new Codicon("star",{fontCharacter:"\\ea6a"}),Codicon.starAdd=new Codicon("star-add",{fontCharacter:"\\ea6a"}),Codicon.starDelete=new Codicon("star-delete",{fontCharacter:"\\ea6a"}),Codicon.starEmpty=new Codicon("star-empty",{fontCharacter:"\\ea6a"}),Codicon.comment=new Codicon("comment",{fontCharacter:"\\ea6b"}),Codicon.commentAdd=new Codicon("comment-add",{fontCharacter:"\\ea6b"}),Codicon.alert=new Codicon("alert",{fontCharacter:"\\ea6c"}),Codicon.warning=new Codicon("warning",{fontCharacter:"\\ea6c"}),Codicon.search=new Codicon("search",{fontCharacter:"\\ea6d"}),Codicon.searchSave=new Codicon("search-save",{fontCharacter:"\\ea6d"}),Codicon.logOut=new Codicon("log-out",{fontCharacter:"\\ea6e"}),Codicon.signOut=new Codicon("sign-out",{fontCharacter:"\\ea6e"}),Codicon.logIn=new Codicon("log-in",{fontCharacter:"\\ea6f"}),Codicon.signIn=new Codicon("sign-in",{fontCharacter:"\\ea6f"}),Codicon.eye=new Codicon("eye",{fontCharacter:"\\ea70"}),Codicon.eyeUnwatch=new Codicon("eye-unwatch",{fontCharacter:"\\ea70"}),Codicon.eyeWatch=new Codicon("eye-watch",{fontCharacter:"\\ea70"}),Codicon.circleFilled=new Codicon("circle-filled",{fontCharacter:"\\ea71"}),Codicon.primitiveDot=new Codicon("primitive-dot",{fontCharacter:"\\ea71"}),Codicon.closeDirty=new Codicon("close-dirty",{fontCharacter:"\\ea71"}),Codicon.debugBreakpoint=new Codicon("debug-breakpoint",{fontCharacter:"\\ea71"}),Codicon.debugBreakpointDisabled=new Codicon("debug-breakpoint-disabled",{fontCharacter:"\\ea71"}),Codicon.debugHint=new Codicon("debug-hint",{fontCharacter:"\\ea71"}),Codicon.primitiveSquare=new Codicon("primitive-square",{fontCharacter:"\\ea72"}),Codicon.edit=new Codicon("edit",{fontCharacter:"\\ea73"}),Codicon.pencil=new Codicon("pencil",{fontCharacter:"\\ea73"}),Codicon.info=new Codicon("info",{fontCharacter:"\\ea74"}),Codicon.issueOpened=new Codicon("issue-opened",{fontCharacter:"\\ea74"}),Codicon.gistPrivate=new Codicon("gist-private",{fontCharacter:"\\ea75"}),Codicon.gitForkPrivate=new Codicon("git-fork-private",{fontCharacter:"\\ea75"}),Codicon.lock=new Codicon("lock",{fontCharacter:"\\ea75"}),Codicon.mirrorPrivate=new Codicon("mirror-private",{fontCharacter:"\\ea75"}),Codicon.close=new Codicon("close",{fontCharacter:"\\ea76"}),Codicon.removeClose=new Codicon("remove-close",{fontCharacter:"\\ea76"}),Codicon.x=new Codicon("x",{fontCharacter:"\\ea76"}),Codicon.repoSync=new Codicon("repo-sync",{fontCharacter:"\\ea77"}),Codicon.sync=new Codicon("sync",{fontCharacter:"\\ea77"}),Codicon.clone=new Codicon("clone",{fontCharacter:"\\ea78"}),Codicon.desktopDownload=new Codicon("desktop-download",{fontCharacter:"\\ea78"}),Codicon.beaker=new Codicon("beaker",{fontCharacter:"\\ea79"}),Codicon.microscope=new Codicon("microscope",{fontCharacter:"\\ea79"}),Codicon.vm=new Codicon("vm",{fontCharacter:"\\ea7a"}),Codicon.deviceDesktop=new Codicon("device-desktop",{fontCharacter:"\\ea7a"}),Codicon.file=new Codicon("file",{fontCharacter:"\\ea7b"}),Codicon.fileText=new Codicon("file-text",{fontCharacter:"\\ea7b"}),Codicon.more=new Codicon("more",{fontCharacter:"\\ea7c"}),Codicon.ellipsis=new Codicon("ellipsis",{fontCharacter:"\\ea7c"}),Codicon.kebabHorizontal=new Codicon("kebab-horizontal",{fontCharacter:"\\ea7c"}),Codicon.mailReply=new Codicon("mail-reply",{fontCharacter:"\\ea7d"}),Codicon.reply=new Codicon("reply",{fontCharacter:"\\ea7d"}),Codicon.organization=new Codicon("organization",{fontCharacter:"\\ea7e"}),Codicon.organizationFilled=new Codicon("organization-filled",{fontCharacter:"\\ea7e"}),Codicon.organizationOutline=new Codicon("organization-outline",{fontCharacter:"\\ea7e"}),Codicon.newFile=new Codicon("new-file",{fontCharacter:"\\ea7f"}),Codicon.fileAdd=new Codicon("file-add",{fontCharacter:"\\ea7f"}),Codicon.newFolder=new Codicon("new-folder",{fontCharacter:"\\ea80"}),Codicon.fileDirectoryCreate=new Codicon("file-directory-create",{fontCharacter:"\\ea80"}),Codicon.trash=new Codicon("trash",{fontCharacter:"\\ea81"}),Codicon.trashcan=new Codicon("trashcan",{fontCharacter:"\\ea81"}),Codicon.history=new Codicon("history",{fontCharacter:"\\ea82"}),Codicon.clock=new Codicon("clock",{fontCharacter:"\\ea82"}),Codicon.folder=new Codicon("folder",{fontCharacter:"\\ea83"}),Codicon.fileDirectory=new Codicon("file-directory",{fontCharacter:"\\ea83"}),Codicon.symbolFolder=new Codicon("symbol-folder",{fontCharacter:"\\ea83"}),Codicon.logoGithub=new Codicon("logo-github",{fontCharacter:"\\ea84"}),Codicon.markGithub=new Codicon("mark-github",{fontCharacter:"\\ea84"}),Codicon.github=new Codicon("github",{fontCharacter:"\\ea84"}),Codicon.terminal=new Codicon("terminal",{fontCharacter:"\\ea85"}),Codicon.console=new Codicon("console",{fontCharacter:"\\ea85"}),Codicon.repl=new Codicon("repl",{fontCharacter:"\\ea85"}),Codicon.zap=new Codicon("zap",{fontCharacter:"\\ea86"}),Codicon.symbolEvent=new Codicon("symbol-event",{fontCharacter:"\\ea86"}),Codicon.error=new Codicon("error",{fontCharacter:"\\ea87"}),Codicon.stop=new Codicon("stop",{fontCharacter:"\\ea87"}),Codicon.variable=new Codicon("variable",{fontCharacter:"\\ea88"}),Codicon.symbolVariable=new Codicon("symbol-variable",{fontCharacter:"\\ea88"}),Codicon.array=new Codicon("array",{fontCharacter:"\\ea8a"}),Codicon.symbolArray=new Codicon("symbol-array",{fontCharacter:"\\ea8a"}),Codicon.symbolModule=new Codicon("symbol-module",{fontCharacter:"\\ea8b"}),Codicon.symbolPackage=new Codicon("symbol-package",{fontCharacter:"\\ea8b"}),Codicon.symbolNamespace=new Codicon("symbol-namespace",{fontCharacter:"\\ea8b"}),Codicon.symbolObject=new Codicon("symbol-object",{fontCharacter:"\\ea8b"}),Codicon.symbolMethod=new Codicon("symbol-method",{fontCharacter:"\\ea8c"}),Codicon.symbolFunction=new Codicon("symbol-function",{fontCharacter:"\\ea8c"}),Codicon.symbolConstructor=new Codicon("symbol-constructor",{fontCharacter:"\\ea8c"}),Codicon.symbolBoolean=new Codicon("symbol-boolean",{fontCharacter:"\\ea8f"}),Codicon.symbolNull=new Codicon("symbol-null",{fontCharacter:"\\ea8f"}),Codicon.symbolNumeric=new Codicon("symbol-numeric",{fontCharacter:"\\ea90"}),Codicon.symbolNumber=new Codicon("symbol-number",{fontCharacter:"\\ea90"}),Codicon.symbolStructure=new Codicon("symbol-structure",{fontCharacter:"\\ea91"}),Codicon.symbolStruct=new Codicon("symbol-struct",{fontCharacter:"\\ea91"}),Codicon.symbolParameter=new Codicon("symbol-parameter",{fontCharacter:"\\ea92"}),Codicon.symbolTypeParameter=new Codicon("symbol-type-parameter",{fontCharacter:"\\ea92"}),Codicon.symbolKey=new Codicon("symbol-key",{fontCharacter:"\\ea93"}),Codicon.symbolText=new Codicon("symbol-text",{fontCharacter:"\\ea93"}),Codicon.symbolReference=new Codicon("symbol-reference",{fontCharacter:"\\ea94"}),Codicon.goToFile=new Codicon("go-to-file",{fontCharacter:"\\ea94"}),Codicon.symbolEnum=new Codicon("symbol-enum",{fontCharacter:"\\ea95"}),Codicon.symbolValue=new Codicon("symbol-value",{fontCharacter:"\\ea95"}),Codicon.symbolRuler=new Codicon("symbol-ruler",{fontCharacter:"\\ea96"}),Codicon.symbolUnit=new Codicon("symbol-unit",{fontCharacter:"\\ea96"}),Codicon.activateBreakpoints=new Codicon("activate-breakpoints",{fontCharacter:"\\ea97"}),Codicon.archive=new Codicon("archive",{fontCharacter:"\\ea98"}),Codicon.arrowBoth=new Codicon("arrow-both",{fontCharacter:"\\ea99"}),Codicon.arrowDown=new Codicon("arrow-down",{fontCharacter:"\\ea9a"}),Codicon.arrowLeft=new Codicon("arrow-left",{fontCharacter:"\\ea9b"}),Codicon.arrowRight=new Codicon("arrow-right",{fontCharacter:"\\ea9c"}),Codicon.arrowSmallDown=new Codicon("arrow-small-down",{fontCharacter:"\\ea9d"}),Codicon.arrowSmallLeft=new Codicon("arrow-small-left",{fontCharacter:"\\ea9e"}),Codicon.arrowSmallRight=new Codicon("arrow-small-right",{fontCharacter:"\\ea9f"}),Codicon.arrowSmallUp=new Codicon("arrow-small-up",{fontCharacter:"\\eaa0"}),Codicon.arrowUp=new Codicon("arrow-up",{fontCharacter:"\\eaa1"}),Codicon.bell=new Codicon("bell",{fontCharacter:"\\eaa2"}),Codicon.bold=new Codicon("bold",{fontCharacter:"\\eaa3"}),Codicon.book=new Codicon("book",{fontCharacter:"\\eaa4"}),Codicon.bookmark=new Codicon("bookmark",{fontCharacter:"\\eaa5"}),Codicon.debugBreakpointConditionalUnverified=new Codicon("debug-breakpoint-conditional-unverified",{fontCharacter:"\\eaa6"}),Codicon.debugBreakpointConditional=new Codicon("debug-breakpoint-conditional",{fontCharacter:"\\eaa7"}),Codicon.debugBreakpointConditionalDisabled=new Codicon("debug-breakpoint-conditional-disabled",{fontCharacter:"\\eaa7"}),Codicon.debugBreakpointDataUnverified=new Codicon("debug-breakpoint-data-unverified",{fontCharacter:"\\eaa8"}),Codicon.debugBreakpointData=new Codicon("debug-breakpoint-data",{fontCharacter:"\\eaa9"}),Codicon.debugBreakpointDataDisabled=new Codicon("debug-breakpoint-data-disabled",{fontCharacter:"\\eaa9"}),Codicon.debugBreakpointLogUnverified=new Codicon("debug-breakpoint-log-unverified",{fontCharacter:"\\eaaa"}),Codicon.debugBreakpointLog=new Codicon("debug-breakpoint-log",{fontCharacter:"\\eaab"}),Codicon.debugBreakpointLogDisabled=new Codicon("debug-breakpoint-log-disabled",{fontCharacter:"\\eaab"}),Codicon.briefcase=new Codicon("briefcase",{fontCharacter:"\\eaac"}),Codicon.broadcast=new Codicon("broadcast",{fontCharacter:"\\eaad"}),Codicon.browser=new Codicon("browser",{fontCharacter:"\\eaae"}),Codicon.bug=new Codicon("bug",{fontCharacter:"\\eaaf"}),Codicon.calendar=new Codicon("calendar",{fontCharacter:"\\eab0"}),Codicon.caseSensitive=new Codicon("case-sensitive",{fontCharacter:"\\eab1"}),Codicon.check=new Codicon("check",{fontCharacter:"\\eab2"}),Codicon.checklist=new Codicon("checklist",{fontCharacter:"\\eab3"}),Codicon.chevronDown=new Codicon("chevron-down",{fontCharacter:"\\eab4"}),Codicon.dropDownButton=new Codicon("drop-down-button",Codicon.chevronDown.definition),Codicon.chevronLeft=new Codicon("chevron-left",{fontCharacter:"\\eab5"}),Codicon.chevronRight=new Codicon("chevron-right",{fontCharacter:"\\eab6"}),Codicon.chevronUp=new Codicon("chevron-up",{fontCharacter:"\\eab7"}),Codicon.chromeClose=new Codicon("chrome-close",{fontCharacter:"\\eab8"}),Codicon.chromeMaximize=new Codicon("chrome-maximize",{fontCharacter:"\\eab9"}),Codicon.chromeMinimize=new Codicon("chrome-minimize",{fontCharacter:"\\eaba"}),Codicon.chromeRestore=new Codicon("chrome-restore",{fontCharacter:"\\eabb"}),Codicon.circleOutline=new Codicon("circle-outline",{fontCharacter:"\\eabc"}),Codicon.debugBreakpointUnverified=new Codicon("debug-breakpoint-unverified",{fontCharacter:"\\eabc"}),Codicon.circleSlash=new Codicon("circle-slash",{fontCharacter:"\\eabd"}),Codicon.circuitBoard=new Codicon("circuit-board",{fontCharacter:"\\eabe"}),Codicon.clearAll=new Codicon("clear-all",{fontCharacter:"\\eabf"}),Codicon.clippy=new Codicon("clippy",{fontCharacter:"\\eac0"}),Codicon.closeAll=new Codicon("close-all",{fontCharacter:"\\eac1"}),Codicon.cloudDownload=new Codicon("cloud-download",{fontCharacter:"\\eac2"}),Codicon.cloudUpload=new Codicon("cloud-upload",{fontCharacter:"\\eac3"}),Codicon.code=new Codicon("code",{fontCharacter:"\\eac4"}),Codicon.collapseAll=new Codicon("collapse-all",{fontCharacter:"\\eac5"}),Codicon.colorMode=new Codicon("color-mode",{fontCharacter:"\\eac6"}),Codicon.commentDiscussion=new Codicon("comment-discussion",{fontCharacter:"\\eac7"}),Codicon.compareChanges=new Codicon("compare-changes",{fontCharacter:"\\eafd"}),Codicon.creditCard=new Codicon("credit-card",{fontCharacter:"\\eac9"}),Codicon.dash=new Codicon("dash",{fontCharacter:"\\eacc"}),Codicon.dashboard=new Codicon("dashboard",{fontCharacter:"\\eacd"}),Codicon.database=new Codicon("database",{fontCharacter:"\\eace"}),Codicon.debugContinue=new Codicon("debug-continue",{fontCharacter:"\\eacf"}),Codicon.debugDisconnect=new Codicon("debug-disconnect",{fontCharacter:"\\ead0"}),Codicon.debugPause=new Codicon("debug-pause",{fontCharacter:"\\ead1"}),Codicon.debugRestart=new Codicon("debug-restart",{fontCharacter:"\\ead2"}),Codicon.debugStart=new Codicon("debug-start",{fontCharacter:"\\ead3"}),Codicon.debugStepInto=new Codicon("debug-step-into",{fontCharacter:"\\ead4"}),Codicon.debugStepOut=new Codicon("debug-step-out",{fontCharacter:"\\ead5"}),Codicon.debugStepOver=new Codicon("debug-step-over",{fontCharacter:"\\ead6"}),Codicon.debugStop=new Codicon("debug-stop",{fontCharacter:"\\ead7"}),Codicon.debug=new Codicon("debug",{fontCharacter:"\\ead8"}),Codicon.deviceCameraVideo=new Codicon("device-camera-video",{fontCharacter:"\\ead9"}),Codicon.deviceCamera=new Codicon("device-camera",{fontCharacter:"\\eada"}),Codicon.deviceMobile=new Codicon("device-mobile",{fontCharacter:"\\eadb"}),Codicon.diffAdded=new Codicon("diff-added",{fontCharacter:"\\eadc"}),Codicon.diffIgnored=new Codicon("diff-ignored",{fontCharacter:"\\eadd"}),Codicon.diffModified=new Codicon("diff-modified",{fontCharacter:"\\eade"}),Codicon.diffRemoved=new Codicon("diff-removed",{fontCharacter:"\\eadf"}),Codicon.diffRenamed=new Codicon("diff-renamed",{fontCharacter:"\\eae0"}),Codicon.diff=new Codicon("diff",{fontCharacter:"\\eae1"}),Codicon.discard=new Codicon("discard",{fontCharacter:"\\eae2"}),Codicon.editorLayout=new Codicon("editor-layout",{fontCharacter:"\\eae3"}),Codicon.emptyWindow=new Codicon("empty-window",{fontCharacter:"\\eae4"}),Codicon.exclude=new Codicon("exclude",{fontCharacter:"\\eae5"}),Codicon.extensions=new Codicon("extensions",{fontCharacter:"\\eae6"}),Codicon.eyeClosed=new Codicon("eye-closed",{fontCharacter:"\\eae7"}),Codicon.fileBinary=new Codicon("file-binary",{fontCharacter:"\\eae8"}),Codicon.fileCode=new Codicon("file-code",{fontCharacter:"\\eae9"}),Codicon.fileMedia=new Codicon("file-media",{fontCharacter:"\\eaea"}),Codicon.filePdf=new Codicon("file-pdf",{fontCharacter:"\\eaeb"}),Codicon.fileSubmodule=new Codicon("file-submodule",{fontCharacter:"\\eaec"}),Codicon.fileSymlinkDirectory=new Codicon("file-symlink-directory",{fontCharacter:"\\eaed"}),Codicon.fileSymlinkFile=new Codicon("file-symlink-file",{fontCharacter:"\\eaee"}),Codicon.fileZip=new Codicon("file-zip",{fontCharacter:"\\eaef"}),Codicon.files=new Codicon("files",{fontCharacter:"\\eaf0"}),Codicon.filter=new Codicon("filter",{fontCharacter:"\\eaf1"}),Codicon.flame=new Codicon("flame",{fontCharacter:"\\eaf2"}),Codicon.foldDown=new Codicon("fold-down",{fontCharacter:"\\eaf3"}),Codicon.foldUp=new Codicon("fold-up",{fontCharacter:"\\eaf4"}),Codicon.fold=new Codicon("fold",{fontCharacter:"\\eaf5"}),Codicon.folderActive=new Codicon("folder-active",{fontCharacter:"\\eaf6"}),Codicon.folderOpened=new Codicon("folder-opened",{fontCharacter:"\\eaf7"}),Codicon.gear=new Codicon("gear",{fontCharacter:"\\eaf8"}),Codicon.gift=new Codicon("gift",{fontCharacter:"\\eaf9"}),Codicon.gistSecret=new Codicon("gist-secret",{fontCharacter:"\\eafa"}),Codicon.gist=new Codicon("gist",{fontCharacter:"\\eafb"}),Codicon.gitCommit=new Codicon("git-commit",{fontCharacter:"\\eafc"}),Codicon.gitCompare=new Codicon("git-compare",{fontCharacter:"\\eafd"}),Codicon.gitMerge=new Codicon("git-merge",{fontCharacter:"\\eafe"}),Codicon.githubAction=new Codicon("github-action",{fontCharacter:"\\eaff"}),Codicon.githubAlt=new Codicon("github-alt",{fontCharacter:"\\eb00"}),Codicon.globe=new Codicon("globe",{fontCharacter:"\\eb01"}),Codicon.grabber=new Codicon("grabber",{fontCharacter:"\\eb02"}),Codicon.graph=new Codicon("graph",{fontCharacter:"\\eb03"}),Codicon.gripper=new Codicon("gripper",{fontCharacter:"\\eb04"}),Codicon.heart=new Codicon("heart",{fontCharacter:"\\eb05"}),Codicon.home=new Codicon("home",{fontCharacter:"\\eb06"}),Codicon.horizontalRule=new Codicon("horizontal-rule",{fontCharacter:"\\eb07"}),Codicon.hubot=new Codicon("hubot",{fontCharacter:"\\eb08"}),Codicon.inbox=new Codicon("inbox",{fontCharacter:"\\eb09"}),Codicon.issueClosed=new Codicon("issue-closed",{fontCharacter:"\\eba4"}),Codicon.issueReopened=new Codicon("issue-reopened",{fontCharacter:"\\eb0b"}),Codicon.issues=new Codicon("issues",{fontCharacter:"\\eb0c"}),Codicon.italic=new Codicon("italic",{fontCharacter:"\\eb0d"}),Codicon.jersey=new Codicon("jersey",{fontCharacter:"\\eb0e"}),Codicon.json=new Codicon("json",{fontCharacter:"\\eb0f"}),Codicon.kebabVertical=new Codicon("kebab-vertical",{fontCharacter:"\\eb10"}),Codicon.key=new Codicon("key",{fontCharacter:"\\eb11"}),Codicon.law=new Codicon("law",{fontCharacter:"\\eb12"}),Codicon.lightbulbAutofix=new Codicon("lightbulb-autofix",{fontCharacter:"\\eb13"}),Codicon.linkExternal=new Codicon("link-external",{fontCharacter:"\\eb14"}),Codicon.link=new Codicon("link",{fontCharacter:"\\eb15"}),Codicon.listOrdered=new Codicon("list-ordered",{fontCharacter:"\\eb16"}),Codicon.listUnordered=new Codicon("list-unordered",{fontCharacter:"\\eb17"}),Codicon.liveShare=new Codicon("live-share",{fontCharacter:"\\eb18"}),Codicon.loading=new Codicon("loading",{fontCharacter:"\\eb19"}),Codicon.location=new Codicon("location",{fontCharacter:"\\eb1a"}),Codicon.mailRead=new Codicon("mail-read",{fontCharacter:"\\eb1b"}),Codicon.mail=new Codicon("mail",{fontCharacter:"\\eb1c"}),Codicon.markdown=new Codicon("markdown",{fontCharacter:"\\eb1d"}),Codicon.megaphone=new Codicon("megaphone",{fontCharacter:"\\eb1e"}),Codicon.mention=new Codicon("mention",{fontCharacter:"\\eb1f"}),Codicon.milestone=new Codicon("milestone",{fontCharacter:"\\eb20"}),Codicon.mortarBoard=new Codicon("mortar-board",{fontCharacter:"\\eb21"}),Codicon.move=new Codicon("move",{fontCharacter:"\\eb22"}),Codicon.multipleWindows=new Codicon("multiple-windows",{fontCharacter:"\\eb23"}),Codicon.mute=new Codicon("mute",{fontCharacter:"\\eb24"}),Codicon.noNewline=new Codicon("no-newline",{fontCharacter:"\\eb25"}),Codicon.note=new Codicon("note",{fontCharacter:"\\eb26"}),Codicon.octoface=new Codicon("octoface",{fontCharacter:"\\eb27"}),Codicon.openPreview=new Codicon("open-preview",{fontCharacter:"\\eb28"}),Codicon.package_=new Codicon("package",{fontCharacter:"\\eb29"}),Codicon.paintcan=new Codicon("paintcan",{fontCharacter:"\\eb2a"}),Codicon.pin=new Codicon("pin",{fontCharacter:"\\eb2b"}),Codicon.play=new Codicon("play",{fontCharacter:"\\eb2c"}),Codicon.run=new Codicon("run",{fontCharacter:"\\eb2c"}),Codicon.plug=new Codicon("plug",{fontCharacter:"\\eb2d"}),Codicon.preserveCase=new Codicon("preserve-case",{fontCharacter:"\\eb2e"}),Codicon.preview=new Codicon("preview",{fontCharacter:"\\eb2f"}),Codicon.project=new Codicon("project",{fontCharacter:"\\eb30"}),Codicon.pulse=new Codicon("pulse",{fontCharacter:"\\eb31"}),Codicon.question=new Codicon("question",{fontCharacter:"\\eb32"}),Codicon.quote=new Codicon("quote",{fontCharacter:"\\eb33"}),Codicon.radioTower=new Codicon("radio-tower",{fontCharacter:"\\eb34"}),Codicon.reactions=new Codicon("reactions",{fontCharacter:"\\eb35"}),Codicon.references=new Codicon("references",{fontCharacter:"\\eb36"}),Codicon.refresh=new Codicon("refresh",{fontCharacter:"\\eb37"}),Codicon.regex=new Codicon("regex",{fontCharacter:"\\eb38"}),Codicon.remoteExplorer=new Codicon("remote-explorer",{fontCharacter:"\\eb39"}),Codicon.remote=new Codicon("remote",{fontCharacter:"\\eb3a"}),Codicon.remove=new Codicon("remove",{fontCharacter:"\\eb3b"}),Codicon.replaceAll=new Codicon("replace-all",{fontCharacter:"\\eb3c"}),Codicon.replace=new Codicon("replace",{fontCharacter:"\\eb3d"}),Codicon.repoClone=new Codicon("repo-clone",{fontCharacter:"\\eb3e"}),Codicon.repoForcePush=new Codicon("repo-force-push",{fontCharacter:"\\eb3f"}),Codicon.repoPull=new Codicon("repo-pull",{fontCharacter:"\\eb40"}),Codicon.repoPush=new Codicon("repo-push",{fontCharacter:"\\eb41"}),Codicon.report=new Codicon("report",{fontCharacter:"\\eb42"}),Codicon.requestChanges=new Codicon("request-changes",{fontCharacter:"\\eb43"}),Codicon.rocket=new Codicon("rocket",{fontCharacter:"\\eb44"}),Codicon.rootFolderOpened=new Codicon("root-folder-opened",{fontCharacter:"\\eb45"}),Codicon.rootFolder=new Codicon("root-folder",{fontCharacter:"\\eb46"}),Codicon.rss=new Codicon("rss",{fontCharacter:"\\eb47"}),Codicon.ruby=new Codicon("ruby",{fontCharacter:"\\eb48"}),Codicon.saveAll=new Codicon("save-all",{fontCharacter:"\\eb49"}),Codicon.saveAs=new Codicon("save-as",{fontCharacter:"\\eb4a"}),Codicon.save=new Codicon("save",{fontCharacter:"\\eb4b"}),Codicon.screenFull=new Codicon("screen-full",{fontCharacter:"\\eb4c"}),Codicon.screenNormal=new Codicon("screen-normal",{fontCharacter:"\\eb4d"}),Codicon.searchStop=new Codicon("search-stop",{fontCharacter:"\\eb4e"}),Codicon.server=new Codicon("server",{fontCharacter:"\\eb50"}),Codicon.settingsGear=new Codicon("settings-gear",{fontCharacter:"\\eb51"}),Codicon.settings=new Codicon("settings",{fontCharacter:"\\eb52"}),Codicon.shield=new Codicon("shield",{fontCharacter:"\\eb53"}),Codicon.smiley=new Codicon("smiley",{fontCharacter:"\\eb54"}),Codicon.sortPrecedence=new Codicon("sort-precedence",{fontCharacter:"\\eb55"}),Codicon.splitHorizontal=new Codicon("split-horizontal",{fontCharacter:"\\eb56"}),Codicon.splitVertical=new Codicon("split-vertical",{fontCharacter:"\\eb57"}),Codicon.squirrel=new Codicon("squirrel",{fontCharacter:"\\eb58"}),Codicon.starFull=new Codicon("star-full",{fontCharacter:"\\eb59"}),Codicon.starHalf=new Codicon("star-half",{fontCharacter:"\\eb5a"}),Codicon.symbolClass=new Codicon("symbol-class",{fontCharacter:"\\eb5b"}),Codicon.symbolColor=new Codicon("symbol-color",{fontCharacter:"\\eb5c"}),Codicon.symbolCustomColor=new Codicon("symbol-customcolor",{fontCharacter:"\\eb5c"}),Codicon.symbolConstant=new Codicon("symbol-constant",{fontCharacter:"\\eb5d"}),Codicon.symbolEnumMember=new Codicon("symbol-enum-member",{fontCharacter:"\\eb5e"}),Codicon.symbolField=new Codicon("symbol-field",{fontCharacter:"\\eb5f"}),Codicon.symbolFile=new Codicon("symbol-file",{fontCharacter:"\\eb60"}),Codicon.symbolInterface=new Codicon("symbol-interface",{fontCharacter:"\\eb61"}),Codicon.symbolKeyword=new Codicon("symbol-keyword",{fontCharacter:"\\eb62"}),Codicon.symbolMisc=new Codicon("symbol-misc",{fontCharacter:"\\eb63"}),Codicon.symbolOperator=new Codicon("symbol-operator",{fontCharacter:"\\eb64"}),Codicon.symbolProperty=new Codicon("symbol-property",{fontCharacter:"\\eb65"}),Codicon.wrench=new Codicon("wrench",{fontCharacter:"\\eb65"}),Codicon.wrenchSubaction=new Codicon("wrench-subaction",{fontCharacter:"\\eb65"}),Codicon.symbolSnippet=new Codicon("symbol-snippet",{fontCharacter:"\\eb66"}),Codicon.tasklist=new Codicon("tasklist",{fontCharacter:"\\eb67"}),Codicon.telescope=new Codicon("telescope",{fontCharacter:"\\eb68"}),Codicon.textSize=new Codicon("text-size",{fontCharacter:"\\eb69"}),Codicon.threeBars=new Codicon("three-bars",{fontCharacter:"\\eb6a"}),Codicon.thumbsdown=new Codicon("thumbsdown",{fontCharacter:"\\eb6b"}),Codicon.thumbsup=new Codicon("thumbsup",{fontCharacter:"\\eb6c"}),Codicon.tools=new Codicon("tools",{fontCharacter:"\\eb6d"}),Codicon.triangleDown=new Codicon("triangle-down",{fontCharacter:"\\eb6e"}),Codicon.triangleLeft=new Codicon("triangle-left",{fontCharacter:"\\eb6f"}),Codicon.triangleRight=new Codicon("triangle-right",{fontCharacter:"\\eb70"}),Codicon.triangleUp=new Codicon("triangle-up",{fontCharacter:"\\eb71"}),Codicon.twitter=new Codicon("twitter",{fontCharacter:"\\eb72"}),Codicon.unfold=new Codicon("unfold",{fontCharacter:"\\eb73"}),Codicon.unlock=new Codicon("unlock",{fontCharacter:"\\eb74"}),Codicon.unmute=new Codicon("unmute",{fontCharacter:"\\eb75"}),Codicon.unverified=new Codicon("unverified",{fontCharacter:"\\eb76"}),Codicon.verified=new Codicon("verified",{fontCharacter:"\\eb77"}),Codicon.versions=new Codicon("versions",{fontCharacter:"\\eb78"}),Codicon.vmActive=new Codicon("vm-active",{fontCharacter:"\\eb79"}),Codicon.vmOutline=new Codicon("vm-outline",{fontCharacter:"\\eb7a"}),Codicon.vmRunning=new Codicon("vm-running",{fontCharacter:"\\eb7b"}),Codicon.watch=new Codicon("watch",{fontCharacter:"\\eb7c"}),Codicon.whitespace=new Codicon("whitespace",{fontCharacter:"\\eb7d"}),Codicon.wholeWord=new Codicon("whole-word",{fontCharacter:"\\eb7e"}),Codicon.window=new Codicon("window",{fontCharacter:"\\eb7f"}),Codicon.wordWrap=new Codicon("word-wrap",{fontCharacter:"\\eb80"}),Codicon.zoomIn=new Codicon("zoom-in",{fontCharacter:"\\eb81"}),Codicon.zoomOut=new Codicon("zoom-out",{fontCharacter:"\\eb82"}),Codicon.listFilter=new Codicon("list-filter",{fontCharacter:"\\eb83"}),Codicon.listFlat=new Codicon("list-flat",{fontCharacter:"\\eb84"}),Codicon.listSelection=new Codicon("list-selection",{fontCharacter:"\\eb85"}),Codicon.selection=new Codicon("selection",{fontCharacter:"\\eb85"}),Codicon.listTree=new Codicon("list-tree",{fontCharacter:"\\eb86"}),Codicon.debugBreakpointFunctionUnverified=new Codicon("debug-breakpoint-function-unverified",{fontCharacter:"\\eb87"}),Codicon.debugBreakpointFunction=new Codicon("debug-breakpoint-function",{fontCharacter:"\\eb88"}),Codicon.debugBreakpointFunctionDisabled=new Codicon("debug-breakpoint-function-disabled",{fontCharacter:"\\eb88"}),Codicon.debugStackframeActive=new Codicon("debug-stackframe-active",{fontCharacter:"\\eb89"}),Codicon.debugStackframeDot=new Codicon("debug-stackframe-dot",{fontCharacter:"\\eb8a"}),Codicon.debugStackframe=new Codicon("debug-stackframe",{fontCharacter:"\\eb8b"}),Codicon.debugStackframeFocused=new Codicon("debug-stackframe-focused",{fontCharacter:"\\eb8b"}),Codicon.debugBreakpointUnsupported=new Codicon("debug-breakpoint-unsupported",{fontCharacter:"\\eb8c"}),Codicon.symbolString=new Codicon("symbol-string",{fontCharacter:"\\eb8d"}),Codicon.debugReverseContinue=new Codicon("debug-reverse-continue",{fontCharacter:"\\eb8e"}),Codicon.debugStepBack=new Codicon("debug-step-back",{fontCharacter:"\\eb8f"}),Codicon.debugRestartFrame=new Codicon("debug-restart-frame",{fontCharacter:"\\eb90"}),Codicon.callIncoming=new Codicon("call-incoming",{fontCharacter:"\\eb92"}),Codicon.callOutgoing=new Codicon("call-outgoing",{fontCharacter:"\\eb93"}),Codicon.menu=new Codicon("menu",{fontCharacter:"\\eb94"}),Codicon.expandAll=new Codicon("expand-all",{fontCharacter:"\\eb95"}),Codicon.feedback=new Codicon("feedback",{fontCharacter:"\\eb96"}),Codicon.groupByRefType=new Codicon("group-by-ref-type",{fontCharacter:"\\eb97"}),Codicon.ungroupByRefType=new Codicon("ungroup-by-ref-type",{fontCharacter:"\\eb98"}),Codicon.account=new Codicon("account",{fontCharacter:"\\eb99"}),Codicon.bellDot=new Codicon("bell-dot",{fontCharacter:"\\eb9a"}),Codicon.debugConsole=new Codicon("debug-console",{fontCharacter:"\\eb9b"}),Codicon.library=new Codicon("library",{fontCharacter:"\\eb9c"}),Codicon.output=new Codicon("output",{fontCharacter:"\\eb9d"}),Codicon.runAll=new Codicon("run-all",{fontCharacter:"\\eb9e"}),Codicon.syncIgnored=new Codicon("sync-ignored",{fontCharacter:"\\eb9f"}),Codicon.pinned=new Codicon("pinned",{fontCharacter:"\\eba0"}),Codicon.githubInverted=new Codicon("github-inverted",{fontCharacter:"\\eba1"}),Codicon.debugAlt=new Codicon("debug-alt",{fontCharacter:"\\eb91"}),Codicon.serverProcess=new Codicon("server-process",{fontCharacter:"\\eba2"}),Codicon.serverEnvironment=new Codicon("server-environment",{fontCharacter:"\\eba3"}),Codicon.pass=new Codicon("pass",{fontCharacter:"\\eba4"}),Codicon.stopCircle=new Codicon("stop-circle",{fontCharacter:"\\eba5"}),Codicon.playCircle=new Codicon("play-circle",{fontCharacter:"\\eba6"}),Codicon.record=new Codicon("record",{fontCharacter:"\\eba7"}),Codicon.debugAltSmall=new Codicon("debug-alt-small",{fontCharacter:"\\eba8"}),Codicon.vmConnect=new Codicon("vm-connect",{fontCharacter:"\\eba9"}),Codicon.cloud=new Codicon("cloud",{fontCharacter:"\\ebaa"}),Codicon.merge=new Codicon("merge",{fontCharacter:"\\ebab"}),Codicon.exportIcon=new Codicon("export",{fontCharacter:"\\ebac"}),Codicon.graphLeft=new Codicon("graph-left",{fontCharacter:"\\ebad"}),Codicon.magnet=new Codicon("magnet",{fontCharacter:"\\ebae"}),Codicon.notebook=new Codicon("notebook",{fontCharacter:"\\ebaf"}),Codicon.redo=new Codicon("redo",{fontCharacter:"\\ebb0"}),Codicon.checkAll=new Codicon("check-all",{fontCharacter:"\\ebb1"}),Codicon.pinnedDirty=new Codicon("pinned-dirty",{fontCharacter:"\\ebb2"}),Codicon.passFilled=new Codicon("pass-filled",{fontCharacter:"\\ebb3"}),Codicon.circleLargeFilled=new Codicon("circle-large-filled",{fontCharacter:"\\ebb4"}),Codicon.circleLargeOutline=new Codicon("circle-large-outline",{fontCharacter:"\\ebb5"}),Codicon.combine=new Codicon("combine",{fontCharacter:"\\ebb6"}),Codicon.gather=new Codicon("gather",{fontCharacter:"\\ebb6"}),Codicon.table=new Codicon("table",{fontCharacter:"\\ebb7"}),Codicon.variableGroup=new Codicon("variable-group",{fontCharacter:"\\ebb8"}),Codicon.typeHierarchy=new Codicon("type-hierarchy",{fontCharacter:"\\ebb9"}),Codicon.typeHierarchySub=new Codicon("type-hierarchy-sub",{fontCharacter:"\\ebba"}),Codicon.typeHierarchySuper=new Codicon("type-hierarchy-super",{fontCharacter:"\\ebbb"}),Codicon.gitPullRequestCreate=new Codicon("git-pull-request-create",{fontCharacter:"\\ebbc"}),Codicon.runAbove=new Codicon("run-above",{fontCharacter:"\\ebbd"}),Codicon.runBelow=new Codicon("run-below",{fontCharacter:"\\ebbe"}),Codicon.notebookTemplate=new Codicon("notebook-template",{fontCharacter:"\\ebbf"}),Codicon.debugRerun=new Codicon("debug-rerun",{fontCharacter:"\\ebc0"}),Codicon.workspaceTrusted=new Codicon("workspace-trusted",{fontCharacter:"\\ebc1"}),Codicon.workspaceUntrusted=new Codicon("workspace-untrusted",{fontCharacter:"\\ebc2"}),Codicon.workspaceUnspecified=new Codicon("workspace-unspecified",{fontCharacter:"\\ebc3"}),Codicon.terminalCmd=new Codicon("terminal-cmd",{fontCharacter:"\\ebc4"}),Codicon.terminalDebian=new Codicon("terminal-debian",{fontCharacter:"\\ebc5"}),Codicon.terminalLinux=new Codicon("terminal-linux",{fontCharacter:"\\ebc6"}),Codicon.terminalPowershell=new Codicon("terminal-powershell",{fontCharacter:"\\ebc7"}),Codicon.terminalTmux=new Codicon("terminal-tmux",{fontCharacter:"\\ebc8"}),Codicon.terminalUbuntu=new Codicon("terminal-ubuntu",{fontCharacter:"\\ebc9"}),Codicon.terminalBash=new Codicon("terminal-bash",{fontCharacter:"\\ebca"}),Codicon.arrowSwap=new Codicon("arrow-swap",{fontCharacter:"\\ebcb"}),Codicon.copy=new Codicon("copy",{fontCharacter:"\\ebcc"}),Codicon.personAdd=new Codicon("person-add",{fontCharacter:"\\ebcd"}),Codicon.filterFilled=new Codicon("filter-filled",{fontCharacter:"\\ebce"}),Codicon.wand=new Codicon("wand",{fontCharacter:"\\ebcf"}),Codicon.debugLineByLine=new Codicon("debug-line-by-line",{fontCharacter:"\\ebd0"}),Codicon.inspect=new Codicon("inspect",{fontCharacter:"\\ebd1"}),Codicon.layers=new Codicon("layers",{fontCharacter:"\\ebd2"}),Codicon.layersDot=new Codicon("layers-dot",{fontCharacter:"\\ebd3"}),Codicon.layersActive=new Codicon("layers-active",{fontCharacter:"\\ebd4"}),Codicon.compass=new Codicon("compass",{fontCharacter:"\\ebd5"}),Codicon.compassDot=new Codicon("compass-dot",{fontCharacter:"\\ebd6"}),Codicon.compassActive=new Codicon("compass-active",{fontCharacter:"\\ebd7"}),Codicon.azure=new Codicon("azure",{fontCharacter:"\\ebd8"}),Codicon.issueDraft=new Codicon("issue-draft",{fontCharacter:"\\ebd9"}),Codicon.gitPullRequestClosed=new Codicon("git-pull-request-closed",{fontCharacter:"\\ebda"}),Codicon.gitPullRequestDraft=new Codicon("git-pull-request-draft",{fontCharacter:"\\ebdb"}),Codicon.debugAll=new Codicon("debug-all",{fontCharacter:"\\ebdc"}),Codicon.debugCoverage=new Codicon("debug-coverage",{fontCharacter:"\\ebdd"}),Codicon.runErrors=new Codicon("run-errors",{fontCharacter:"\\ebde"}),Codicon.folderLibrary=new Codicon("folder-library",{fontCharacter:"\\ebdf"}),Codicon.debugContinueSmall=new Codicon("debug-continue-small",{fontCharacter:"\\ebe0"}),Codicon.beakerStop=new Codicon("beaker-stop",{fontCharacter:"\\ebe1"}),Codicon.graphLine=new Codicon("graph-line",{fontCharacter:"\\ebe2"}),Codicon.graphScatter=new Codicon("graph-scatter",{fontCharacter:"\\ebe3"}),Codicon.pieChart=new Codicon("pie-chart",{fontCharacter:"\\ebe4"}),Codicon.bracket=new Codicon("bracket",Codicon.json.definition),Codicon.bracketDot=new Codicon("bracket-dot",{fontCharacter:"\\ebe5"}),Codicon.bracketError=new Codicon("bracket-error",{fontCharacter:"\\ebe6"}),Codicon.lockSmall=new Codicon("lock-small",{fontCharacter:"\\ebe7"}),Codicon.azureDevops=new Codicon("azure-devops",{fontCharacter:"\\ebe8"}),Codicon.verifiedFilled=new Codicon("verified-filled",{fontCharacter:"\\ebe9"}),Codicon.newLine=new Codicon("newline",{fontCharacter:"\\ebea"}),Codicon.layout=new Codicon("layout",{fontCharacter:"\\ebeb"}),Codicon.layoutActivitybarLeft=new Codicon("layout-activitybar-left",{fontCharacter:"\\ebec"}),Codicon.layoutActivitybarRight=new Codicon("layout-activitybar-right",{fontCharacter:"\\ebed"}),Codicon.layoutPanelLeft=new Codicon("layout-panel-left",{fontCharacter:"\\ebee"}),Codicon.layoutPanelCenter=new Codicon("layout-panel-center",{fontCharacter:"\\ebef"}),Codicon.layoutPanelJustify=new Codicon("layout-panel-justify",{fontCharacter:"\\ebf0"}),Codicon.layoutPanelRight=new Codicon("layout-panel-right",{fontCharacter:"\\ebf1"}),Codicon.layoutPanel=new Codicon("layout-panel",{fontCharacter:"\\ebf2"}),Codicon.layoutSidebarLeft=new Codicon("layout-sidebar-left",{fontCharacter:"\\ebf3"}),Codicon.layoutSidebarRight=new Codicon("layout-sidebar-right",{fontCharacter:"\\ebf4"}),Codicon.layoutStatusbar=new Codicon("layout-statusbar",{fontCharacter:"\\ebf5"}),Codicon.layoutMenubar=new Codicon("layout-menubar",{fontCharacter:"\\ebf6"}),Codicon.layoutCentered=new Codicon("layout-centered",{fontCharacter:"\\ebf7"}),Codicon.target=new Codicon("target",{fontCharacter:"\\ebf8"}),Codicon.indent=new Codicon("indent",{fontCharacter:"\\ebf9"}),Codicon.recordSmall=new Codicon("record-small",{fontCharacter:"\\ebfa"}),Codicon.errorSmall=new Codicon("error-small",{fontCharacter:"\\ebfb"}),Codicon.arrowCircleDown=new Codicon("arrow-circle-down",{fontCharacter:"\\ebfc"}),Codicon.arrowCircleLeft=new Codicon("arrow-circle-left",{fontCharacter:"\\ebfd"}),Codicon.arrowCircleRight=new Codicon("arrow-circle-right",{fontCharacter:"\\ebfe"}),Codicon.arrowCircleUp=new Codicon("arrow-circle-up",{fontCharacter:"\\ebff"}),Codicon.dialogError=new Codicon("dialog-error",Codicon.error.definition),Codicon.dialogWarning=new Codicon("dialog-warning",Codicon.warning.definition),Codicon.dialogInfo=new Codicon("dialog-info",Codicon.info.definition),Codicon.dialogClose=new Codicon("dialog-close",Codicon.close.definition),Codicon.treeItemExpanded=new Codicon("tree-item-expanded",Codicon.chevronDown.definition),Codicon.treeFilterOnTypeOn=new Codicon("tree-filter-on-type-on",Codicon.listFilter.definition),Codicon.treeFilterOnTypeOff=new Codicon("tree-filter-on-type-off",Codicon.listSelection.definition),Codicon.treeFilterClear=new Codicon("tree-filter-clear",Codicon.close.definition),Codicon.treeItemLoading=new Codicon("tree-item-loading",Codicon.loading.definition),Codicon.menuSelection=new Codicon("menu-selection",Codicon.check.definition),Codicon.menuSubmenu=new Codicon("menu-submenu",Codicon.chevronRight.definition),Codicon.menuBarMore=new Codicon("menubar-more",Codicon.more.definition),Codicon.scrollbarButtonLeft=new Codicon("scrollbar-button-left",Codicon.triangleLeft.definition),Codicon.scrollbarButtonRight=new Codicon("scrollbar-button-right",Codicon.triangleRight.definition),Codicon.scrollbarButtonUp=new Codicon("scrollbar-button-up",Codicon.triangleUp.definition),Codicon.scrollbarButtonDown=new Codicon("scrollbar-button-down",Codicon.triangleDown.definition),Codicon.toolBarMore=new Codicon("toolbar-more",Codicon.more.definition),Codicon.quickInputBack=new Codicon("quick-input-back",Codicon.arrowLeft.definition),function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9-]+",e.iconModifierExpression="~[A-Za-z]+",e.iconNameCharacter="[A-Za-z0-9~-]";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function i(e){if(e instanceof Codicon)return["codicon","codicon-"+e.id];const n=t.exec(e.id);if(!n)return i(Codicon.error);let[,o,r]=n;const s=["codicon","codicon-"+o];return r&&s.push("codicon-modifier-"+r.substr(1)),s}e.asClassNameArray=i,e.asClassName=function(e){return i(e).join(" ")},e.asCSSSelector=function(e){return"."+i(e).join(".")}}(CSSIcon||(CSSIcon={}));const ICommandService=createDecorator("commandService"),CommandsRegistry=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new Emitter$1,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if("string"==typeof e){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.description){const t=[];for(let n of e.description.args)t.push(n.constraint);const i=e.handler;e.handler=function(e,...n){return validateConstraints(n,t),i(e,...n)}}const{id:i}=e;let n=this._commands.get(i);n||(n=new LinkedList,this._commands.set(i,n));let o=n.unshift(e),r=toDisposable((()=>{o();const e=this._commands.get(i);(null==e?void 0:e.isEmpty())&&this._commands.delete(i)}));return this._onDidRegisterCommand.fire(i),r}registerCommandAlias(e,t){return CommandsRegistry.registerCommand(e,((e,...i)=>e.get(ICommandService).executeCommand(t,...i)))}getCommand(e){const t=this._commands.get(e);if(t&&!t.isEmpty())return Iterable.first(t)}getCommands(){const e=new Map;for(const t of this._commands.keys()){const i=this.getCommand(t);i&&e.set(t,i)}return e}};CommandsRegistry.registerCommand("noop",(()=>{}));class LRUCachedComputed{constructor(e){this.computeFn=e,this.lastCache=void 0,this.lastArgKey=void 0}get(e){const t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}}class Lazy{constructor(e){this.executor=e,this._didRun=!1}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}var _a$c;function isFalsyOrWhitespace(e){return!e||"string"!=typeof e||0===e.trim().length}const _formatRegexp=/{(\d+)}/g;function format(e,...t){return 0===t.length?e:e.replace(_formatRegexp,(function(e,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=t.length?e:t[n]}))}function escape(e){return e.replace(/[<>&]/g,(function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}}))}function escapeRegExpCharacters(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function ltrim(e,t){if(!e||!t)return e;const i=t.length;if(0===i||0===e.length)return e;let n=0;for(;e.indexOf(t,n)===n;)n+=i;return e.substring(n)}function rtrim(e,t){if(!e||!t)return e;const i=t.length,n=e.length;if(0===i||0===n)return e;let o=n,r=-1;for(;r=e.lastIndexOf(t,o-1),-1!==r&&r+i===o;){if(0===r)return"";o=r}return e.substring(0,o)}function convertSimple2RegExpPattern(e){return e.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function createRegExp(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=escapeRegExpCharacters(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e+="\\b"));let n="";return i.global&&(n+="g"),i.matchCase||(n+="i"),i.multiline&&(n+="m"),i.unicode&&(n+="u"),new RegExp(e,n)}function regExpLeadsToEndlessLoop(e){if("^"===e.source||"^$"===e.source||"$"===e.source||"^\\s*$"===e.source)return!1;return!(!e.exec("")||0!==e.lastIndex)}function regExpFlags(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")}function splitLines(e){return e.split(/\r\n|\r|\n/)}function firstNonWhitespaceIndex(e){for(let t=0,i=e.length;t<i;t++){const i=e.charCodeAt(t);if(32!==i&&9!==i)return t}return-1}function getLeadingWhitespace(e,t=0,i=e.length){for(let n=t;n<i;n++){const i=e.charCodeAt(n);if(32!==i&&9!==i)return e.substring(t,n)}return e.substring(t,i)}function lastNonWhitespaceIndex(e,t=e.length-1){for(let i=t;i>=0;i--){const t=e.charCodeAt(i);if(32!==t&&9!==t)return i}return-1}function compare(e,t){return e<t?-1:e>t?1:0}function compareSubstring(e,t,i=0,n=e.length,o=0,r=t.length){for(;i<n&&o<r;i++,o++){let n=e.charCodeAt(i),r=t.charCodeAt(o);if(n<r)return-1;if(n>r)return 1}const s=n-i,a=r-o;return s<a?-1:s>a?1:0}function compareIgnoreCase(e,t){return compareSubstringIgnoreCase(e,t,0,e.length,0,t.length)}function compareSubstringIgnoreCase(e,t,i=0,n=e.length,o=0,r=t.length){for(;i<n&&o<r;i++,o++){let s=e.charCodeAt(i),a=t.charCodeAt(o);if(s===a)continue;if(s>=128||a>=128)return compareSubstring(e.toLowerCase(),t.toLowerCase(),i,n,o,r);isLowerAsciiLetter(s)&&(s-=32),isLowerAsciiLetter(a)&&(a-=32);const l=s-a;if(0!==l)return l}const s=n-i,a=r-o;return s<a?-1:s>a?1:0}function isLowerAsciiLetter(e){return e>=97&&e<=122}function isUpperAsciiLetter(e){return e>=65&&e<=90}function equalsIgnoreCase(e,t){return e.length===t.length&&0===compareSubstringIgnoreCase(e,t)}function startsWithIgnoreCase(e,t){const i=t.length;return!(t.length>e.length)&&0===compareSubstringIgnoreCase(e,t,0,i)}function commonPrefixLength(e,t){let i,n=Math.min(e.length,t.length);for(i=0;i<n;i++)if(e.charCodeAt(i)!==t.charCodeAt(i))return i;return n}function commonSuffixLength(e,t){let i,n=Math.min(e.length,t.length);const o=e.length-1,r=t.length-1;for(i=0;i<n;i++)if(e.charCodeAt(o-i)!==t.charCodeAt(r-i))return i;return n}function isHighSurrogate(e){return 55296<=e&&e<=56319}function isLowSurrogate(e){return 56320<=e&&e<=57343}function computeCodePoint(e,t){return t-56320+(e-55296<<10)+65536}function getNextCodePoint(e,t,i){const n=e.charCodeAt(i);if(isHighSurrogate(n)&&i+1<t){const t=e.charCodeAt(i+1);if(isLowSurrogate(t))return computeCodePoint(n,t)}return n}function getPrevCodePoint(e,t){const i=e.charCodeAt(t-1);if(isLowSurrogate(i)&&t>1){const n=e.charCodeAt(t-2);if(isHighSurrogate(n))return computeCodePoint(n,i)}return i}class CodePointIterator{constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}get offset(){return this._offset}setOffset(e){this._offset=e}prevCodePoint(){const e=getPrevCodePoint(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=getNextCodePoint(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class GraphemeIterator{constructor(e,t=0){this._iterator=new CodePointIterator(e,t)}get offset(){return this._iterator.offset}nextGraphemeLength(){const e=GraphemeBreakTree.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const i=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(breakBetweenGraphemeBreakType(n,o)){t.setOffset(i);break}n=o}return t.offset-i}prevGraphemeLength(){const e=GraphemeBreakTree.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const i=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(breakBetweenGraphemeBreakType(o,n)){t.setOffset(i);break}n=o}return i-t.offset}eol(){return this._iterator.eol()}}function nextCharLength(e,t){return new GraphemeIterator(e,t).nextGraphemeLength()}function prevCharLength(e,t){return new GraphemeIterator(e,t).prevGraphemeLength()}function getCharContainingOffset(e,t){t>0&&isLowSurrogate(e.charCodeAt(t))&&t--;const i=t+nextCharLength(e,t);return[i-prevCharLength(e,i),i]}const CONTAINS_RTL=/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/;function containsRTL(e){return CONTAINS_RTL.test(e)}const IS_BASIC_ASCII=/^[\t\n\r\x20-\x7E]*$/;function isBasicASCII(e){return IS_BASIC_ASCII.test(e)}const UNUSUAL_LINE_TERMINATORS=/[\u2028\u2029]/;function containsUnusualLineTerminators(e){return UNUSUAL_LINE_TERMINATORS.test(e)}function isFullWidthCharacter(e){return e>=11904&&e<=55215||e>=63744&&e<=64255||e>=65281&&e<=65374}function isEmojiImprecise(e){return e>=127462&&e<=127487||8986===e||8987===e||9200===e||9203===e||e>=9728&&e<=10175||11088===e||11093===e||e>=127744&&e<=128591||e>=128640&&e<=128764||e>=128992&&e<=129008||e>=129280&&e<=129535||e>=129648&&e<=129782}const UTF8_BOM_CHARACTER=String.fromCharCode(65279);function startsWithUTF8BOM(e){return!!(e&&e.length>0&&65279===e.charCodeAt(0))}function containsUppercaseCharacter(e,t=!1){return!!e&&(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e)}function singleLetterHash(e){return(e%=52)<26?String.fromCharCode(97+e):String.fromCharCode(65+e-26)}function breakBetweenGraphemeBreakType(e,t){return 0===e?5!==t&&7!==t:(2!==e||3!==t)&&(4===e||2===e||3===e||(4===t||2===t||3===t||(8!==e||8!==t&&9!==t&&11!==t&&12!==t)&&((11!==e&&9!==e||9!==t&&10!==t)&&((12!==e&&10!==e||10!==t)&&(5!==t&&13!==t&&(7!==t&&(1!==e&&((13!==e||14!==t)&&(6!==e||6!==t)))))))))}class GraphemeBreakTree{constructor(){this._data=getGraphemeBreakRawData()}static getInstance(){return GraphemeBreakTree._INSTANCE||(GraphemeBreakTree._INSTANCE=new GraphemeBreakTree),GraphemeBreakTree._INSTANCE}getGraphemeBreakType(e){if(e<32)return 10===e?3:13===e?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n*=2;else{if(!(e>t[3*n+1]))return t[3*n+2];n=2*n+1}return 0}}function getGraphemeBreakRawData(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function getLeftDeleteOffset(e,t){if(0===e)return 0;const i=getOffsetBeforeLastEmojiComponent(e,t);if(void 0!==i)return i;const n=new CodePointIterator(t,e);return n.prevCodePoint(),n.offset}function getOffsetBeforeLastEmojiComponent(e,t){const i=new CodePointIterator(t,e);let n=i.prevCodePoint();for(;isEmojiModifier(n)||65039===n||8419===n;){if(0===i.offset)return;n=i.prevCodePoint()}if(!isEmojiImprecise(n))return;let o=i.offset;if(o>0){8205===i.prevCodePoint()&&(o=i.offset)}return o}function isEmojiModifier(e){return 127995<=e&&e<=127999}GraphemeBreakTree._INSTANCE=null;const noBreakWhitespace=" ";class AmbiguousCharacters{constructor(e){this.confusableDictionary=e}static getInstance(e){return AmbiguousCharacters.cache.get(Array.from(e))}static getLocales(){return AmbiguousCharacters._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}_a$c=AmbiguousCharacters,AmbiguousCharacters.ambiguousCharacterData=new Lazy((()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))),AmbiguousCharacters.cache=new LRUCachedComputed((e=>{function t(e){const t=new Map;for(let i=0;i<e.length;i+=2)t.set(e[i],e[i+1]);return t}function i(e,t){if(!e)return t;const i=new Map;for(const[n,o]of e)t.has(n)&&i.set(n,o);return i}const n=_a$c.ambiguousCharacterData.getValue();let o,r=e.filter((e=>!e.startsWith("_")&&e in n));0===r.length&&(r=["_default"]);for(const a of r){o=i(o,t(n[a]))}const s=function(e,t){const i=new Map(e);for(const[n,o]of t)i.set(n,o);return i}(t(n._common),o);return new AmbiguousCharacters(s)})),AmbiguousCharacters._locales=new Lazy((()=>Object.keys(AmbiguousCharacters.ambiguousCharacterData.getValue()).filter((e=>!e.startsWith("_")))));class InvisibleCharacters{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(InvisibleCharacters.getRawData())),this._data}static isInvisibleCharacter(e){return InvisibleCharacters.getData().has(e)}static get codePoints(){return InvisibleCharacters.getData()}}InvisibleCharacters._data=void 0;const CONSTANT_VALUES=new Map;CONSTANT_VALUES.set("false",!1),CONSTANT_VALUES.set("true",!0),CONSTANT_VALUES.set("isMac",isMacintosh),CONSTANT_VALUES.set("isLinux",isLinux),CONSTANT_VALUES.set("isWindows",isWindows),CONSTANT_VALUES.set("isWeb",isWeb),CONSTANT_VALUES.set("isMacNative",isMacintosh&&!isWeb),CONSTANT_VALUES.set("isEdge",isEdge),CONSTANT_VALUES.set("isFirefox",isFirefox$1),CONSTANT_VALUES.set("isChrome",isChrome$1),CONSTANT_VALUES.set("isSafari",isSafari$1);const hasOwnProperty$3=Object.prototype.hasOwnProperty;class ContextKeyExpr{static has(e){return ContextKeyDefinedExpr.create(e)}static equals(e,t){return ContextKeyEqualsExpr.create(e,t)}static regex(e,t){return ContextKeyRegexExpr.create(e,t)}static not(e){return ContextKeyNotExpr.create(e)}static and(...e){return ContextKeyAndExpr.create(e,null)}static or(...e){return ContextKeyOrExpr.create(e,null,!0)}static deserialize(e,t=!1){if(e)return this._deserializeOrExpression(e,t)}static _deserializeOrExpression(e,t){let i=e.split("||");return ContextKeyOrExpr.create(i.map((e=>this._deserializeAndExpression(e,t))),null,!0)}static _deserializeAndExpression(e,t){let i=e.split("&&");return ContextKeyAndExpr.create(i.map((e=>this._deserializeOne(e,t))),null)}static _deserializeOne(e,t){if((e=e.trim()).indexOf("!=")>=0){let i=e.split("!=");return ContextKeyNotEqualsExpr.create(i[0].trim(),this._deserializeValue(i[1],t))}if(e.indexOf("==")>=0){let i=e.split("==");return ContextKeyEqualsExpr.create(i[0].trim(),this._deserializeValue(i[1],t))}if(e.indexOf("=~")>=0){let i=e.split("=~");return ContextKeyRegexExpr.create(i[0].trim(),this._deserializeRegexValue(i[1],t))}if(e.indexOf(" in ")>=0){let t=e.split(" in ");return ContextKeyInExpr.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+>=[^<=>]+$/.test(e)){const t=e.split(">=");return ContextKeyGreaterEqualsExpr.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+>[^<=>]+$/.test(e)){const t=e.split(">");return ContextKeyGreaterExpr.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+<=[^<=>]+$/.test(e)){const t=e.split("<=");return ContextKeySmallerEqualsExpr.create(t[0].trim(),t[1].trim())}if(/^[^<=>]+<[^<=>]+$/.test(e)){const t=e.split("<");return ContextKeySmallerExpr.create(t[0].trim(),t[1].trim())}return/^\!\s*/.test(e)?ContextKeyNotExpr.create(e.substr(1).trim()):ContextKeyDefinedExpr.create(e)}static _deserializeValue(e,t){if("true"===(e=e.trim()))return!0;if("false"===e)return!1;let i=/^'([^']*)'$/.exec(e);return i?i[1].trim():e}static _deserializeRegexValue(e,t){if(isFalsyOrWhitespace(e)){if(t)throw new Error("missing regexp-value for =~-expression");return null}let i=e.indexOf("/"),n=e.lastIndexOf("/");if(i===n||i<0){if(t)throw new Error(`bad regexp-value '${e}', missing /-enclosure`);return null}let o=e.slice(i+1,n),r="i"===e[n+1]?"i":"";try{return new RegExp(o,r)}catch(e2){if(t)throw new Error(`bad regexp-value '${e}', parse error: ${e2}`);return null}}}function expressionsAreEqualWithConstantSubstitution(e,t){const i=e?e.substituteConstants():void 0,n=t?t.substituteConstants():void 0;return!i&&!n||!(!i||!n)&&i.equals(n)}function cmp(e,t){return e.cmp(t)}class ContextKeyFalseExpr{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return ContextKeyTrueExpr.INSTANCE}}ContextKeyFalseExpr.INSTANCE=new ContextKeyFalseExpr;class ContextKeyTrueExpr{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return ContextKeyFalseExpr.INSTANCE}}ContextKeyTrueExpr.INSTANCE=new ContextKeyTrueExpr;class ContextKeyDefinedExpr{constructor(e,t){this.key=e,this.negated=t,this.type=2}static create(e,t=null){const i=CONSTANT_VALUES.get(e);return"boolean"==typeof i?i?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:new ContextKeyDefinedExpr(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:cmp1(this.key,e.key)}equals(e){return e.type===this.type&&this.key===e.key}substituteConstants(){const e=CONSTANT_VALUES.get(this.key);return"boolean"==typeof e?e?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotExpr.create(this.key,this)),this.negated}}class ContextKeyEqualsExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}static create(e,t,i=null){if("boolean"==typeof t)return t?ContextKeyDefinedExpr.create(e,i):ContextKeyNotExpr.create(e,i);const n=CONSTANT_VALUES.get(e);if("boolean"==typeof n){return t===(n?"true":"false")?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return new ContextKeyEqualsExpr(e,t,i)}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){const e=CONSTANT_VALUES.get(this.key);if("boolean"==typeof e){const t=e?"true":"false";return this.value===t?ContextKeyTrueExpr.INSTANCE:ContextKeyFalseExpr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyInExpr{constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}static create(e,t){return new ContextKeyInExpr(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type&&(this.key===e.key&&this.valueKey===e.valueKey)}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.indexOf(i)>=0:"string"==typeof i&&"object"==typeof t&&null!==t&&hasOwnProperty$3.call(t,i)}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=ContextKeyNotInExpr.create(this)),this.negated}}class ContextKeyNotInExpr{constructor(e){this._actual=e,this.type=11}static create(e){return new ContextKeyNotInExpr(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type&&this._actual.equals(e._actual)}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}class ContextKeyNotEqualsExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}static create(e,t,i=null){if("boolean"==typeof t)return t?ContextKeyNotExpr.create(e,i):ContextKeyDefinedExpr.create(e,i);const n=CONSTANT_VALUES.get(e);if("boolean"==typeof n){return t===(n?"true":"false")?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return new ContextKeyNotEqualsExpr(e,t,i)}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){const e=CONSTANT_VALUES.get(this.key);if("boolean"==typeof e){const t=e?"true":"false";return this.value===t?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyNotExpr{constructor(e,t){this.key=e,this.negated=t,this.type=3}static create(e,t=null){const i=CONSTANT_VALUES.get(e);return"boolean"==typeof i?i?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:new ContextKeyNotExpr(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:cmp1(this.key,e.key)}equals(e){return e.type===this.type&&this.key===e.key}substituteConstants(){const e=CONSTANT_VALUES.get(this.key);return"boolean"==typeof e?e?ContextKeyFalseExpr.INSTANCE:ContextKeyTrueExpr.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyDefinedExpr.create(this.key,this)),this.negated}}function withFloatOrStr(e,t){if("string"==typeof e){const t=parseFloat(e);isNaN(t)||(e=t)}return"string"==typeof e||"number"==typeof e?t(e):ContextKeyFalseExpr.INSTANCE}class ContextKeyGreaterExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}static create(e,t,i=null){return withFloatOrStr(t,(t=>new ContextKeyGreaterExpr(e,t,i)))}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){return this}evaluate(e){return"string"!=typeof this.value&&parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyGreaterEqualsExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}static create(e,t,i=null){return withFloatOrStr(t,(t=>new ContextKeyGreaterEqualsExpr(e,t,i)))}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){return this}evaluate(e){return"string"!=typeof this.value&&parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeySmallerExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}static create(e,t,i=null){return withFloatOrStr(t,(t=>new ContextKeySmallerExpr(e,t,i)))}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){return this}evaluate(e){return"string"!=typeof this.value&&parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterEqualsExpr.create(this.key,this.value,this)),this.negated}}class ContextKeySmallerEqualsExpr{constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}static create(e,t,i=null){return withFloatOrStr(t,(t=>new ContextKeySmallerEqualsExpr(e,t,i)))}cmp(e){return e.type!==this.type?this.type-e.type:cmp2(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type&&(this.key===e.key&&this.value===e.value)}substituteConstants(){return this}evaluate(e){return"string"!=typeof this.value&&parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyGreaterExpr.create(this.key,this.value,this)),this.negated}}class ContextKeyRegexExpr{constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}static create(e,t){return new ContextKeyRegexExpr(e,t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){let t=e.getValue(this.key);return!!this.regexp&&this.regexp.test(t)}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.ignoreCase?"i":""}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=ContextKeyNotRegexExpr.create(this)),this.negated}}class ContextKeyNotRegexExpr{constructor(e){this._actual=e,this.type=8}static create(e){return new ContextKeyNotRegexExpr(e)}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type&&this._actual.equals(e._actual)}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){throw new Error("Method not implemented.")}keys(){return this._actual.keys()}negate(){return this._actual}}function eliminateConstantsInArray(e){let t=null;for(let i=0,n=e.length;i<n;i++){const n=e[i].substituteConstants();if(e[i]!==n&&null===t){t=[];for(let n=0;n<i;n++)t[n]=e[n]}null!==t&&(t[i]=n)}return null===t?e:t}class ContextKeyAndExpr{constructor(e,t){this.expr=e,this.negated=t,this.type=6}static create(e,t){return ContextKeyAndExpr._normalizeArr(e,t)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const i=cmp(this.expr[t],e.expr[t]);if(0!==i)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=eliminateConstantsInArray(this.expr);return e===this.expr?this:ContextKeyAndExpr.create(e,this.negated)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t){const i=[];let n=!1;for(const o of e)if(o)if(1!==o.type){if(0===o.type)return ContextKeyFalseExpr.INSTANCE;6!==o.type?i.push(o):i.push(...o.expr)}else n=!0;if(0===i.length&&n)return ContextKeyTrueExpr.INSTANCE;if(0!==i.length){if(1===i.length)return i[0];i.sort(cmp);for(let e=1;e<i.length;e++)i[e-1].equals(i[e])&&(i.splice(e,1),e--);if(1===i.length)return i[0];for(;i.length>1;){const e=i[i.length-1];if(9!==e.type)break;i.pop();const t=i.pop(),n=0===i.length,o=ContextKeyOrExpr.create(e.expr.map((e=>ContextKeyAndExpr.create([e,t],null))),null,n);o&&(i.push(o),i.sort(cmp))}return 1===i.length?i[0]:new ContextKeyAndExpr(i,t)}}serialize(){return this.expr.map((e=>e.serialize())).join(" && ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(let t of this.expr)e.push(t.negate());this.negated=ContextKeyOrExpr.create(e,this,!0)}return this.negated}}class ContextKeyOrExpr{constructor(e,t){this.expr=e,this.negated=t,this.type=9}static create(e,t,i){return ContextKeyOrExpr._normalizeArr(e,t,i)}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const i=cmp(this.expr[t],e.expr[t]);if(0!==i)return i}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=eliminateConstantsInArray(this.expr);return e===this.expr?this:ContextKeyOrExpr.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],o=!1;if(e){for(let t=0,i=e.length;t<i;t++){const i=e[t];if(i)if(0!==i.type){if(1===i.type)return ContextKeyTrueExpr.INSTANCE;9!==i.type?n.push(i):n=n.concat(i.expr)}else o=!0}if(0===n.length&&o)return ContextKeyFalseExpr.INSTANCE;n.sort(cmp)}if(0!==n.length){if(1===n.length)return n[0];for(let e=1;e<n.length;e++)n[e-1].equals(n[e])&&(n.splice(e,1),e--);if(1===n.length)return n[0];if(i){for(let e=0;e<n.length;e++)for(let t=e+1;t<n.length;t++)implies(n[e],n[t])&&(n.splice(t,1),t--);if(1===n.length)return n[0]}return new ContextKeyOrExpr(n,t)}}serialize(){return this.expr.map((e=>e.serialize())).join(" || ")}keys(){const e=[];for(let t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){let e=[];for(let t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const e of getTerminals(t))for(const t of getTerminals(i))n.push(ContextKeyAndExpr.create([e,t],null));const o=0===e.length;e.unshift(ContextKeyOrExpr.create(n,null,o))}this.negated=e[0]}return this.negated}}class RawContextKey extends ContextKeyDefinedExpr{constructor(e,t,i){super(e,null),this._defaultValue=t,"object"==typeof i?RawContextKey._info.push(Object.assign(Object.assign({},i),{key:e})):!0!==i&&RawContextKey._info.push({key:e,description:i,type:null!=t?typeof t:void 0})}static all(){return RawContextKey._info.values()}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return ContextKeyEqualsExpr.create(this.key,e)}}RawContextKey._info=[];const IContextKeyService=createDecorator("contextKeyService"),SET_CONTEXT_COMMAND_ID="setContext";function cmp1(e,t){return e<t?-1:e>t?1:0}function cmp2(e,t,i,n){return e<i?-1:e>i?1:t<n?-1:t>n?1:0}function implies(e,t){if(6===t.type&&9!==e.type&&6!==e.type)for(const n of t.expr)if(e.equals(n))return!0;const i=getTerminals(e.negate()).concat(getTerminals(t));i.sort(cmp);for(let n=0;n<i.length;n++){const e=i[n].negate();for(let t=n+1;t<i.length;t++){const n=i[t];if(e.equals(n))return!0}}return!1}function getTerminals(e){return 9===e.type?e.expr:[e]}function ok(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}class RegistryImpl{constructor(){this.data=new Map}add(e,t){ok(isString$1(e)),ok(isObject(t)),ok(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const Registry=new RegistryImpl;var ColorScheme,ColorScheme2;ColorScheme2=ColorScheme||(ColorScheme={}),ColorScheme2.DARK="dark",ColorScheme2.LIGHT="light",ColorScheme2.HIGH_CONTRAST="hc";const IThemeService=createDecorator("themeService");var ThemeColor,ThemeIcon;function themeColorFromId(e){return{id:e}}function getThemeTypeSelector(e){switch(e){case ColorScheme.DARK:return"vs-dark";case ColorScheme.HIGH_CONTRAST:return"hc-black";default:return"vs"}}(ThemeColor||(ThemeColor={})).isThemeColor=function(e){return e&&"object"==typeof e&&"string"==typeof e.id},function(e){e.isThemeIcon=function(e){return e&&"object"==typeof e&&"string"==typeof e.id&&(void 0===e.color||ThemeColor.isThemeColor(e.color))};const t=new RegExp(`^\\$\\((${CSSIcon.iconNameExpression}(?:${CSSIcon.iconModifierExpression})?)\\)$`);e.fromString=function(e){const i=t.exec(e);if(!i)return;let[,n]=i;return{id:n}},e.fromId=function(e){return{id:e}},e.modify=function(e,t){let i=e.id;const n=i.lastIndexOf("~");return-1!==n&&(i=i.substring(0,n)),t&&(i=`${i}~${t}`),{id:i}},e.getModifier=function(e){const t=e.id.lastIndexOf("~");if(-1!==t)return e.id.substring(t+1)},e.isEqual=function(e,t){var i,n;return e.id===t.id&&(null===(i=e.color)||void 0===i?void 0:i.id)===(null===(n=t.color)||void 0===n?void 0:n.id)},e.asThemeIcon=function(e,t){return{id:e.id,color:t?themeColorFromId(t):void 0}},e.asClassNameArray=CSSIcon.asClassNameArray,e.asClassName=CSSIcon.asClassName,e.asCSSSelector=CSSIcon.asCSSSelector}(ThemeIcon||(ThemeIcon={}));const Extensions$8={ThemingContribution:"base.contributions.theming"};class ThemingRegistry{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new Emitter$1}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),toDisposable((()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)}))}getThemingParticipants(){return this.themingParticipants}}let themingRegistry$1=new ThemingRegistry;function registerThemingParticipant(e){return themingRegistry$1.onColorThemeChange(e)}Registry.add(Extensions$8.ThemingContribution,themingRegistry$1);class Themable extends Disposable{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange((e=>this.onThemeChange(e))))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var __decorate$1B=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1v=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};function isIMenuItem(e){return void 0!==e.command}class MenuId{constructor(e){this.id=MenuId._idPool++,this._debugName=e}}MenuId._idPool=0,MenuId.CommandPalette=new MenuId("CommandPalette"),MenuId.DebugBreakpointsContext=new MenuId("DebugBreakpointsContext"),MenuId.DebugCallStackContext=new MenuId("DebugCallStackContext"),MenuId.DebugConsoleContext=new MenuId("DebugConsoleContext"),MenuId.DebugVariablesContext=new MenuId("DebugVariablesContext"),MenuId.DebugWatchContext=new MenuId("DebugWatchContext"),MenuId.DebugToolBar=new MenuId("DebugToolBar"),MenuId.EditorContext=new MenuId("EditorContext"),MenuId.SimpleEditorContext=new MenuId("SimpleEditorContext"),MenuId.EditorContextCopy=new MenuId("EditorContextCopy"),MenuId.EditorContextPeek=new MenuId("EditorContextPeek"),MenuId.EditorTitle=new MenuId("EditorTitle"),MenuId.EditorTitleRun=new MenuId("EditorTitleRun"),MenuId.EditorTitleContext=new MenuId("EditorTitleContext"),MenuId.EmptyEditorGroup=new MenuId("EmptyEditorGroup"),MenuId.EmptyEditorGroupContext=new MenuId("EmptyEditorGroupContext"),MenuId.ExplorerContext=new MenuId("ExplorerContext"),MenuId.ExtensionContext=new MenuId("ExtensionContext"),MenuId.GlobalActivity=new MenuId("GlobalActivity"),MenuId.LayoutControlMenuSubmenu=new MenuId("LayoutControlMenuSubmenu"),MenuId.LayoutControlMenu=new MenuId("LayoutControlMenu"),MenuId.MenubarMainMenu=new MenuId("MenubarMainMenu"),MenuId.MenubarAppearanceMenu=new MenuId("MenubarAppearanceMenu"),MenuId.MenubarDebugMenu=new MenuId("MenubarDebugMenu"),MenuId.MenubarEditMenu=new MenuId("MenubarEditMenu"),MenuId.MenubarCopy=new MenuId("MenubarCopy"),MenuId.MenubarFileMenu=new MenuId("MenubarFileMenu"),MenuId.MenubarGoMenu=new MenuId("MenubarGoMenu"),MenuId.MenubarHelpMenu=new MenuId("MenubarHelpMenu"),MenuId.MenubarLayoutMenu=new MenuId("MenubarLayoutMenu"),MenuId.MenubarNewBreakpointMenu=new MenuId("MenubarNewBreakpointMenu"),MenuId.MenubarPanelAlignmentMenu=new MenuId("MenubarPanelAlignmentMenu"),MenuId.MenubarPanelPositionMenu=new MenuId("MenubarPanelPositionMenu"),MenuId.MenubarPreferencesMenu=new MenuId("MenubarPreferencesMenu"),MenuId.MenubarRecentMenu=new MenuId("MenubarRecentMenu"),MenuId.MenubarSelectionMenu=new MenuId("MenubarSelectionMenu"),MenuId.MenubarSwitchEditorMenu=new MenuId("MenubarSwitchEditorMenu"),MenuId.MenubarSwitchGroupMenu=new MenuId("MenubarSwitchGroupMenu"),MenuId.MenubarTerminalMenu=new MenuId("MenubarTerminalMenu"),MenuId.MenubarViewMenu=new MenuId("MenubarViewMenu"),MenuId.MenubarHomeMenu=new MenuId("MenubarHomeMenu"),MenuId.OpenEditorsContext=new MenuId("OpenEditorsContext"),MenuId.ProblemsPanelContext=new MenuId("ProblemsPanelContext"),MenuId.SCMChangeContext=new MenuId("SCMChangeContext"),MenuId.SCMResourceContext=new MenuId("SCMResourceContext"),MenuId.SCMResourceFolderContext=new MenuId("SCMResourceFolderContext"),MenuId.SCMResourceGroupContext=new MenuId("SCMResourceGroupContext"),MenuId.SCMSourceControl=new MenuId("SCMSourceControl"),MenuId.SCMTitle=new MenuId("SCMTitle"),MenuId.SearchContext=new MenuId("SearchContext"),MenuId.StatusBarWindowIndicatorMenu=new MenuId("StatusBarWindowIndicatorMenu"),MenuId.StatusBarRemoteIndicatorMenu=new MenuId("StatusBarRemoteIndicatorMenu"),MenuId.TestItem=new MenuId("TestItem"),MenuId.TestItemGutter=new MenuId("TestItemGutter"),MenuId.TestPeekElement=new MenuId("TestPeekElement"),MenuId.TestPeekTitle=new MenuId("TestPeekTitle"),MenuId.TouchBarContext=new MenuId("TouchBarContext"),MenuId.TitleBarContext=new MenuId("TitleBarContext"),MenuId.TunnelContext=new MenuId("TunnelContext"),MenuId.TunnelPrivacy=new MenuId("TunnelPrivacy"),MenuId.TunnelProtocol=new MenuId("TunnelProtocol"),MenuId.TunnelPortInline=new MenuId("TunnelInline"),MenuId.TunnelTitle=new MenuId("TunnelTitle"),MenuId.TunnelLocalAddressInline=new MenuId("TunnelLocalAddressInline"),MenuId.TunnelOriginInline=new MenuId("TunnelOriginInline"),MenuId.ViewItemContext=new MenuId("ViewItemContext"),MenuId.ViewContainerTitle=new MenuId("ViewContainerTitle"),MenuId.ViewContainerTitleContext=new MenuId("ViewContainerTitleContext"),MenuId.ViewTitle=new MenuId("ViewTitle"),MenuId.ViewTitleContext=new MenuId("ViewTitleContext"),MenuId.CommentThreadTitle=new MenuId("CommentThreadTitle"),MenuId.CommentThreadActions=new MenuId("CommentThreadActions"),MenuId.CommentTitle=new MenuId("CommentTitle"),MenuId.CommentActions=new MenuId("CommentActions"),MenuId.InteractiveToolbar=new MenuId("InteractiveToolbar"),MenuId.InteractiveCellTitle=new MenuId("InteractiveCellTitle"),MenuId.InteractiveCellExecute=new MenuId("InteractiveCellExecute"),MenuId.InteractiveInputExecute=new MenuId("InteractiveInputExecute"),MenuId.NotebookToolbar=new MenuId("NotebookToolbar"),MenuId.NotebookCellTitle=new MenuId("NotebookCellTitle"),MenuId.NotebookCellInsert=new MenuId("NotebookCellInsert"),MenuId.NotebookCellBetween=new MenuId("NotebookCellBetween"),MenuId.NotebookCellListTop=new MenuId("NotebookCellTop"),MenuId.NotebookCellExecute=new MenuId("NotebookCellExecute"),MenuId.NotebookCellExecutePrimary=new MenuId("NotebookCellExecutePrimary"),MenuId.NotebookDiffCellInputTitle=new MenuId("NotebookDiffCellInputTitle"),MenuId.NotebookDiffCellMetadataTitle=new MenuId("NotebookDiffCellMetadataTitle"),MenuId.NotebookDiffCellOutputsTitle=new MenuId("NotebookDiffCellOutputsTitle"),MenuId.NotebookOutputToolbar=new MenuId("NotebookOutputToolbar"),MenuId.NotebookEditorLayoutConfigure=new MenuId("NotebookEditorLayoutConfigure"),MenuId.BulkEditTitle=new MenuId("BulkEditTitle"),MenuId.BulkEditContext=new MenuId("BulkEditContext"),MenuId.TimelineItemContext=new MenuId("TimelineItemContext"),MenuId.TimelineTitle=new MenuId("TimelineTitle"),MenuId.TimelineTitleContext=new MenuId("TimelineTitleContext"),MenuId.AccountsContext=new MenuId("AccountsContext"),MenuId.PanelTitle=new MenuId("PanelTitle"),MenuId.AuxiliaryBarTitle=new MenuId("AuxiliaryBarTitle"),MenuId.TerminalInstanceContext=new MenuId("TerminalInstanceContext"),MenuId.TerminalEditorInstanceContext=new MenuId("TerminalEditorInstanceContext"),MenuId.TerminalNewDropdownContext=new MenuId("TerminalNewDropdownContext"),MenuId.TerminalTabContext=new MenuId("TerminalTabContext"),MenuId.TerminalTabEmptyAreaContext=new MenuId("TerminalTabEmptyAreaContext"),MenuId.TerminalInlineTabContext=new MenuId("TerminalInlineTabContext"),MenuId.WebviewContext=new MenuId("WebviewContext"),MenuId.InlineCompletionsActions=new MenuId("InlineCompletionsActions"),MenuId.NewFile=new MenuId("NewFile");const IMenuService=createDecorator("menuService"),MenuRegistry=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new Emitter$1,this.onDidChangeMenu=this._onDidChangeMenu.event,this._commandPaletteChangeEvent={has:e=>e===MenuId.CommandPalette}}addCommand(e){return this.addCommands(Iterable.single(e))}addCommands(e){for(const t of e)this._commands.set(t.id,t);return this._onDidChangeMenu.fire(this._commandPaletteChangeEvent),toDisposable((()=>{let t=!1;for(const i of e)t=this._commands.delete(i.id)||t;t&&this._onDidChangeMenu.fire(this._commandPaletteChangeEvent)}))}getCommand(e){return this._commands.get(e)}getCommands(){const e=new Map;return this._commands.forEach(((t,i)=>e.set(i,t))),e}appendMenuItem(e,t){return this.appendMenuItems(Iterable.single({id:e,item:t}))}appendMenuItems(e){const t=new Set,i=new LinkedList;for(const{id:n,item:o}of e){let e=this._menuItems.get(n);e||(e=new LinkedList,this._menuItems.set(n,e)),i.push(e.push(o)),t.add(n)}return this._onDidChangeMenu.fire(t),toDisposable((()=>{if(i.size>0){for(let e of i)e();this._onDidChangeMenu.fire(t),i.clear()}}))}getMenuItems(e){let t;return t=this._menuItems.has(e)?[...this._menuItems.get(e)]:[],e===MenuId.CommandPalette&&this._appendImplicitItems(t),t}_appendImplicitItems(e){const t=new Set;for(const i of e)isIMenuItem(i)&&(t.add(i.command.id),i.alt&&t.add(i.alt.id));this._commands.forEach(((i,n)=>{t.has(n)||e.push({command:i})}))}};class SubmenuItemAction extends SubmenuAction{constructor(e,t,i,n){super(`submenuitem.${e.submenu.id}`,"string"==typeof e.title?e.title:e.title.value,[],"submenu"),this.item=e,this._menuService=t,this._contextKeyService=i,this._options=n}get actions(){const e=[],t=this._menuService.createMenu(this.item.submenu,this._contextKeyService),i=t.getActions(this._options);t.dispose();for(const[,n]of i)n.length>0&&(e.push(...n),e.push(new Separator));return e.length&&e.pop(),e}}let MenuItemAction=class e{constructor(t,i,n,o,r){var s,a;if(this._commandService=r,this.id=t.id,this.label=(null==n?void 0:n.renderShortTitle)&&t.shortTitle?"string"==typeof t.shortTitle?t.shortTitle:t.shortTitle.value:"string"==typeof t.title?t.title:t.title.value,this.tooltip=null!==(a="string"==typeof t.tooltip?t.tooltip:null===(s=t.tooltip)||void 0===s?void 0:s.value)&&void 0!==a?a:"",this.enabled=!t.precondition||o.contextMatchesRules(t.precondition),this.checked=void 0,t.toggled){const e=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=o.contextMatchesRules(e.condition),this.checked&&e.tooltip&&(this.tooltip="string"==typeof e.tooltip?e.tooltip:e.tooltip.value),e.title&&(this.label="string"==typeof e.title?e.title:e.title.value)}this.item=t,this.alt=i?new e(i,void 0,n,o,r):void 0,this._options=n,ThemeIcon.isThemeIcon(t.icon)&&(this.class=CSSIcon.asClassName(t.icon))}dispose(){}run(...e){var t,i;let n=[];return(null===(t=this._options)||void 0===t?void 0:t.arg)&&(n=[...n,this._options.arg]),(null===(i=this._options)||void 0===i?void 0:i.shouldForwardArgs)&&(n=[...n,...e]),this._commandService.executeCommand(this.id,...n)}};MenuItemAction=__decorate$1B([__param$1v(3,IContextKeyService),__param$1v(4,ICommandService)],MenuItemAction);class KeybindingsRegistryImpl{constructor(){this._coreKeybindings=[],this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(1===OS){if(e&&e.win)return e.win}else if(2===OS){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=KeybindingsRegistryImpl.bindToCurrentPlatform(e);if(t&&t.primary){const i=createKeybinding(t.primary,OS);i&&this._registerDefaultKeybinding(i,e.id,e.args,e.weight,0,e.when)}if(t&&Array.isArray(t.secondary))for(let i=0,n=t.secondary.length;i<n;i++){const n=createKeybinding(t.secondary[i],OS);n&&this._registerDefaultKeybinding(n,e.id,e.args,e.weight,-i-1,e.when)}}registerCommandAndKeybindingRule(e){this.registerKeybindingRule(e),CommandsRegistry.registerCommand(e)}static _mightProduceChar(e){return e>=21&&e<=30||(e>=31&&e<=56||(80===e||81===e||82===e||83===e||84===e||85===e||86===e||110===e||111===e||87===e||88===e||89===e||90===e||91===e||92===e))}_assertNoCtrlAlt(e,t){e.ctrlKey&&e.altKey&&!e.metaKey&&KeybindingsRegistryImpl._mightProduceChar(e.keyCode)}_registerDefaultKeybinding(e,t,i,n,o,r){1===OS&&this._assertNoCtrlAlt(e.parts[0],t),this._coreKeybindings.push({keybinding:e.parts,command:t,commandArgs:i,when:r,weight1:n,weight2:o,extensionId:null,isBuiltinExtension:!1}),this._cachedMergedKeybindings=null}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=[].concat(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(sorter)),this._cachedMergedKeybindings.slice(0)}}const KeybindingsRegistry=new KeybindingsRegistryImpl,Extensions$7={EditorModes:"platform.keybindingsRegistry"};function sorter(e,t){return e.weight1!==t.weight1?e.weight1-t.weight1:e.command<t.command?-1:e.command>t.command?1:e.weight2-t.weight2}Registry.add(Extensions$7.EditorModes,KeybindingsRegistry);const ITelemetryService=createDecorator("telemetryService"),ILogService=createDecorator("logService");var LogLevel,LogLevel2;LogLevel2=LogLevel||(LogLevel={}),LogLevel2[LogLevel2.Trace=0]="Trace",LogLevel2[LogLevel2.Debug=1]="Debug",LogLevel2[LogLevel2.Info=2]="Info",LogLevel2[LogLevel2.Warning=3]="Warning",LogLevel2[LogLevel2.Error=4]="Error",LogLevel2[LogLevel2.Critical=5]="Critical",LogLevel2[LogLevel2.Off=6]="Off";const DEFAULT_LOG_LEVEL=LogLevel.Info;class AbstractLogger extends Disposable{constructor(){super(...arguments),this.level=DEFAULT_LOG_LEVEL,this._onDidChangeLogLevel=this._register(new Emitter$1)}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}class ConsoleLogger extends AbstractLogger{constructor(e=DEFAULT_LOG_LEVEL){super(),this.setLevel(e)}trace(e,...t){this.getLevel(),LogLevel.Trace}debug(e,...t){this.getLevel(),LogLevel.Debug}info(e,...t){this.getLevel(),LogLevel.Info}error(e,...t){this.getLevel(),LogLevel.Error}dispose(){}}class LogService extends Disposable{constructor(e){super(),this.logger=e,this._register(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}error(e,...t){this.logger.error(e,...t)}}class Command$1{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this._description=e.description}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let e=t.kbExpr;this.precondition&&(e=e?ContextKeyExpr.and(e,this.precondition):this.precondition);const i={id:this.id,weight:t.weight,args:t.args,when:e,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};KeybindingsRegistry.registerKeybindingRule(i)}}CommandsRegistry.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),description:this._description})}_registerMenuItem(e){MenuRegistry.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class MultiCommand extends Command$1{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i){return this._implementations.push({priority:e,name:t,implementation:i}),this._implementations.sort(((e,t)=>t.priority-e.priority)),{dispose:()=>{for(let e=0;e<this._implementations.length;e++)if(this._implementations[e].implementation===i)return void this._implementations.splice(e,1)}}}runCommand(e,t){const i=e.get(ILogService);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const n of this._implementations){const o=n.implementation(e,t);if(o){if(i.trace(`Command '${this.id}' was handled by '${n.name}'.`),"boolean"==typeof o)return;return o}}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class ProxyCommand extends Command$1{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class EditorCommand extends Command$1{static bindToContribution(e){return class extends EditorCommand{constructor(e){super(e),this._callback=e.handler}runEditorCommand(t,i,n){const o=e(i);o&&this._callback(o,n)}}}runCommand(e,t){const i=e.get(ICodeEditorService),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext((e=>{if(e.get(IContextKeyService).contextMatchesRules(withNullAsUndefined(this.precondition)))return this.runEditorCommand(e,n,t)}))}}class EditorAction extends EditorCommand{constructor(e){super(EditorAction.convertOptions(e)),this.label=e.label,this.alias=e.alias}static convertOptions(e){let t;function i(t){return t.menuId||(t.menuId=MenuId.EditorContext),t.title||(t.title=e.label),t.when=ContextKeyExpr.and(e.precondition,t.when),t}return t=Array.isArray(e.menuOpts)?e.menuOpts:e.menuOpts?[e.menuOpts]:[],Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(ITelemetryService).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class MultiEditorAction extends EditorAction{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort(((e,t)=>t[0]-e[0])),{dispose:()=>{for(let e=0;e<this._implementations.length;e++)if(this._implementations[e][1]===t)return void this._implementations.splice(e,1)}}}run(e,t,i){for(const n of this._implementations){const o=n[1](e,t,i);if(o){if("boolean"==typeof o)return;return o}}}}function registerModelAndPositionCommand(e,t){CommandsRegistry.registerCommand(e,(function(e,...i){const n=e.get(IInstantiationService),[o,r]=i;assertType(URI.isUri(o)),assertType(Position$1.isIPosition(r));const s=e.get(IModelService).getModel(o);if(s){const e=Position$1.lift(r);return n.invokeFunction(t,s,e,...i.slice(2))}return e.get(ITextModelService).createModelReference(o).then((e=>new Promise(((o,s)=>{try{o(n.invokeFunction(t,e.object.textEditorModel,Position$1.lift(r),i.slice(2)))}catch(a){s(a)}})).finally((()=>{e.dispose()}))))}))}function registerEditorCommand(e){return EditorContributionRegistry.INSTANCE.registerEditorCommand(e),e}function registerEditorAction(e){const t=new e;return EditorContributionRegistry.INSTANCE.registerEditorAction(t),t}function registerMultiEditorAction(e){return EditorContributionRegistry.INSTANCE.registerEditorAction(e),e}function registerInstantiatedEditorAction(e){EditorContributionRegistry.INSTANCE.registerEditorAction(e)}function registerEditorContribution(e,t){EditorContributionRegistry.INSTANCE.registerEditorContribution(e,t)}var EditorExtensionsRegistry,EditorExtensionsRegistry2;EditorExtensionsRegistry2=EditorExtensionsRegistry||(EditorExtensionsRegistry={}),EditorExtensionsRegistry2.getEditorCommand=function(e){return EditorContributionRegistry.INSTANCE.getEditorCommand(e)},EditorExtensionsRegistry2.getEditorActions=function(){return EditorContributionRegistry.INSTANCE.getEditorActions()},EditorExtensionsRegistry2.getEditorContributions=function(){return EditorContributionRegistry.INSTANCE.getEditorContributions()},EditorExtensionsRegistry2.getSomeEditorContributions=function(e){return EditorContributionRegistry.INSTANCE.getEditorContributions().filter((t=>e.indexOf(t.id)>=0))},EditorExtensionsRegistry2.getDiffEditorContributions=function(){return EditorContributionRegistry.INSTANCE.getDiffEditorContributions()};const Extensions$6={EditorCommonContributions:"editor.contributions"};class EditorContributionRegistry{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t){this.editorContributions.push({id:e,ctor:t})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions.slice(0)}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}}function registerCommand$3(e){return e.register(),e}EditorContributionRegistry.INSTANCE=new EditorContributionRegistry,Registry.add(Extensions$6.EditorCommonContributions,EditorContributionRegistry.INSTANCE);const UndoCommand=registerCommand$3(new MultiCommand({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("undo","Undo"),order:1}]}));registerCommand$3(new ProxyCommand(UndoCommand,{id:"default:undo",precondition:void 0}));const RedoCommand=registerCommand$3(new MultiCommand({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"1_do",title:localize({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:MenuId.CommandPalette,group:"",title:localize("redo","Redo"),order:1}]}));registerCommand$3(new ProxyCommand(RedoCommand,{id:"default:redo",precondition:void 0}));const SelectAllCommand=registerCommand$3(new MultiCommand({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("selectAll","Select All"),order:1}]}));class Range$2{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return Range$2.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Range$2.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>e.endColumn))}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber)&&(!(t.lineNumber===e.startLineNumber&&t.column<=e.startColumn)&&!(t.lineNumber===e.endLineNumber&&t.column>=e.endColumn))}containsRange(e){return Range$2.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)))}strictContainsRange(e){return Range$2.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber)&&(!(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber)&&(!(t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn)&&!(t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)))}plusRange(e){return Range$2.plusRange(this,e)}static plusRange(e,t){let i,n,o,r;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(o=t.endLineNumber,r=t.endColumn):t.endLineNumber===e.endLineNumber?(o=t.endLineNumber,r=Math.max(t.endColumn,e.endColumn)):(o=e.endLineNumber,r=e.endColumn),new Range$2(i,n,o,r)}intersectRanges(e){return Range$2.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn,s=t.startLineNumber,a=t.startColumn,l=t.endLineNumber,d=t.endColumn;return i<s?(i=s,n=a):i===s&&(n=Math.max(n,a)),o>l?(o=l,r=d):o===l&&(r=Math.min(r,d)),i>o||i===o&&n>r?null:new Range$2(i,n,o,r)}equalsRange(e){return Range$2.equalsRange(this,e)}static equalsRange(e,t){return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Range$2.getEndPosition(this)}static getEndPosition(e){return new Position$1(e.endLineNumber,e.endColumn)}getStartPosition(){return Range$2.getStartPosition(this)}static getStartPosition(e){return new Position$1(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Range$2(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Range$2(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Range$2.collapseToStart(this)}static collapseToStart(e){return new Range$2(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}static fromPositions(e,t=e){return new Range$2(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Range$2(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&"number"==typeof e.startLineNumber&&"number"==typeof e.startColumn&&"number"==typeof e.endLineNumber&&"number"==typeof e.endColumn}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn)&&!(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const i=0|e.startLineNumber,n=0|t.startLineNumber;if(i===n){const i=0|e.startColumn,n=0|t.startColumn;if(i===n){const i=0|e.endLineNumber,n=0|t.endLineNumber;if(i===n){return(0|e.endColumn)-(0|t.endColumn)}return i-n}return i-n}return i-n}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}}class Selection$1 extends Range$2{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return Selection$1.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return 0===this.getDirection()?new Selection$1(this.startLineNumber,this.startColumn,e,t):new Selection$1(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new Position$1(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Position$1(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return 0===this.getDirection()?new Selection$1(e,t,this.endLineNumber,this.endColumn):new Selection$1(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new Selection$1(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return 0===t?new Selection$1(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new Selection$1(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new Selection$1(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&"number"==typeof e.selectionStartLineNumber&&"number"==typeof e.selectionStartColumn&&"number"==typeof e.positionLineNumber&&"number"==typeof e.positionColumn}static createWithDirection(e,t,i,n,o){return 0===o?new Selection$1(e,t,i,n):new Selection$1(i,n,e,t)}}function createScopedLineTokens(e,t){const i=e.getCount(),n=e.findTokenIndexAtOffset(t),o=e.getLanguageId(n);let r=n;for(;r+1<i&&e.getLanguageId(r+1)===o;)r++;let s=n;for(;s>0&&e.getLanguageId(s-1)===o;)s--;return new ScopedLineTokens(e,o,s,r+1,e.getStartOffset(s),e.getEndOffset(r))}class ScopedLineTokens{constructor(e,t,i,n,o,r){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=o,this._lastCharOffset=r}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}}function ignoreBracketsInToken(e){return 0!=(3&e)}class CursorColumns{static _nextVisibleColumn(e,t,i){return 9===e?CursorColumns.nextRenderTabStop(t,i):isFullWidthCharacter(e)||isEmojiImprecise(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),o=e.substring(0,n),r=new GraphemeIterator(o);let s=0;for(;!r.eol();){const e=getNextCodePoint(o,n,r.offset);r.nextGraphemeLength(),s=this._nextVisibleColumn(e,s,i)}return s}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,o=new GraphemeIterator(e);let r=0,s=1;for(;!o.eol();){const a=getNextCodePoint(e,n,o.offset);o.nextGraphemeLength();const l=this._nextVisibleColumn(a,r,i),d=o.offset+1;if(l>=t){return l-t<t-r?d:s}r=l,s=d}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}function _normalizeIndentationFromWhitespace(e,t,i){let n=0;for(let r=0;r<e.length;r++)"\t"===e.charAt(r)?n+=t:n++;let o="";if(!i){const e=Math.floor(n/t);n%=t;for(let t=0;t<e;t++)o+="\t"}for(let r=0;r<n;r++)o+=" ";return o}function normalizeIndentation(e,t,i){let n=firstNonWhitespaceIndex(e);return-1===n&&(n=e.length),_normalizeIndentationFromWhitespace(e.substring(0,n),t,i)+e.substring(n)}const autoCloseAlways=()=>!0,autoCloseNever=()=>!1,autoCloseBeforeWhitespace=e=>" "===e||"\t"===e;class CursorConfiguration{constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const o=i.options,r=o.get(131);this.readOnly=o.get(81),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=o.get(104),this.lineHeight=o.get(59),this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=o.get(116),this.wordSeparators=o.get(117),this.emptySelectionClipboard=o.get(32),this.copyWithSyntaxHighlighting=o.get(21),this.multiCursorMergeOverlapping=o.get(69),this.multiCursorPaste=o.get(71),this.autoClosingBrackets=o.get(5),this.autoClosingQuotes=o.get(8),this.autoClosingDelete=o.get(6),this.autoClosingOvertype=o.get(7),this.autoSurround=o.get(11),this.autoIndent=o.get(9),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const s=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(s)for(const a of s)this.surroundingPairs[a.open]=a.close}static shouldRecreate(e){return e.hasChanged(131)||e.hasChanged(117)||e.hasChanged(32)||e.hasChanged(69)||e.hasChanged(71)||e.hasChanged(5)||e.hasChanged(8)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(116)||e.hasChanged(59)||e.hasChanged(81)}get electricChars(){var e;if(!this._electricChars){this._electricChars={};const t=null===(e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter)||void 0===e?void 0:e.getElectricCharacters();if(t)for(const e of t)this._electricChars[e]=!0}return this._electricChars}onElectricCharacter(e,t,i){const n=createScopedLineTokens(t,i-1),o=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return o?o.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return normalizeIndentation(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t){switch(t){case"beforeWhitespace":return autoCloseBeforeWhitespace;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e);case"always":return autoCloseAlways;case"never":return autoCloseNever}}_getLanguageDefinedShouldAutoClose(e){const t=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet();return e=>-1!==t.indexOf(e)}visibleColumnFromColumn(e,t){return CursorColumns.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=CursorColumns.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),o=e.getLineMinColumn(t);if(n<o)return o;const r=e.getLineMaxColumn(t);return n>r?r:n}}class CursorState$1{constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}static fromModelState(e){return new PartialModelCursorState(e)}static fromViewState(e){return new PartialViewCursorState(e)}static fromModelSelection(e){const t=Selection$1.liftSelection(e),i=new SingleCursorState(Range$2.fromPositions(t.getSelectionStart()),0,t.getPosition(),0);return CursorState$1.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}}class PartialModelCursorState{constructor(e){this.modelState=e,this.viewState=null}}class PartialViewCursorState{constructor(e){this.modelState=null,this.viewState=e}}class SingleCursorState{constructor(e,t,i,n){this._singleCursorStateBrand=void 0,this.selectionStart=e,this.selectionStartLeftoverVisibleColumns=t,this.position=i,this.leftoverVisibleColumns=n,this.selection=SingleCursorState._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new SingleCursorState(this.selectionStart,this.selectionStartLeftoverVisibleColumns,new Position$1(t,i),n):new SingleCursorState(new Range$2(t,i,t,i),n,new Position$1(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?Selection$1.fromPositions(e.getStartPosition(),t):Selection$1.fromPositions(e.getEndPosition(),t)}}class EditOperationResult{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function isQuote(e){return"'"===e||'"'===e||"`"===e}class ColumnSelection{static columnSelect(e,t,i,n,o,r){const s=Math.abs(o-i)+1,a=i>o,l=n>r,d=n<r,c=[];for(let h=0;h<s;h++){const o=i+(a?-h:h),s=e.columnFromVisibleColumn(t,o,n),u=e.columnFromVisibleColumn(t,o,r),g=e.visibleColumnFromColumn(t,new Position$1(o,s)),p=e.visibleColumnFromColumn(t,new Position$1(o,u));if(d){if(g>r)continue;if(p<n)continue}if(l){if(p>n)continue;if(g<r)continue}c.push(new SingleCursorState(new Range$2(o,s,o,s),0,new Position$1(o,u),0))}if(0===c.length)for(let h=0;h<s;h++){const e=i+(a?-h:h),n=t.getLineMaxColumn(e);c.push(new SingleCursorState(new Range$2(e,n,e,n),0,new Position$1(e,n),0))}return{viewStates:c,reversed:a,fromLineNumber:i,fromVisualColumn:n,toLineNumber:o,toVisualColumn:r}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,ColumnSelection.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const o=Math.min(i.fromViewLineNumber,i.toViewLineNumber),r=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let a=o;a<=r;a++){const i=t.getLineMaxColumn(a),o=e.visibleColumnFromColumn(t,new Position$1(a,i));n=Math.max(n,o)}let s=i.toViewVisualColumn;return s<n&&s++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,s)}static columnSelectUp(e,t,i,n){const o=n?e.pageSize:1,r=Math.max(1,i.toViewLineNumber-o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const o=n?e.pageSize:1,r=Math.min(t.getLineCount(),i.toViewLineNumber+o);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}}class ReplaceCommand{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return Selection$1.fromPositions(i.getEndPosition())}}class ReplaceCommandThatSelectsText{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return Selection$1.fromRange(i,0)}}class ReplaceCommandWithoutChangingPosition{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return Selection$1.fromPositions(i.getStartPosition())}}class ReplaceCommandWithOffsetCursorState{constructor(e,t,i,n,o=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=o}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return Selection$1.fromPositions(i.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class ReplaceCommandThatPreservesSelection{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class AtomicTabMoveOperations{static whitespaceVisibleColumn(e,t,i){const n=e.length;let o=0,r=-1,s=-1;for(let a=0;a<n;a++){if(a===t)return[r,s,o];o%i==0&&(r=a,s=o);switch(e.charCodeAt(a)){case 32:o+=1;break;case 9:o=CursorColumns.nextRenderTabStop(o,i);break;default:return[-1,-1,-1]}}return t===n?[r,s,o]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const o=e.length,[r,s,a]=AtomicTabMoveOperations.whitespaceVisibleColumn(e,t,i);if(-1===a)return-1;let l;switch(n){case 0:l=!0;break;case 1:l=!1;break;case 2:if(a%i==0)return t;l=a%i<=i/2}if(l){if(-1===r)return-1;let t=s;for(let n=r;n<o;++n){if(t===s+i)return r;switch(e.charCodeAt(n)){case 32:t+=1;break;case 9:t=CursorColumns.nextRenderTabStop(t,i);break;default:return-1}}return t===s+i?r:-1}const d=CursorColumns.nextRenderTabStop(a,i);let c=a;for(let h=t;h<o;h++){if(c===d)return h;switch(e.charCodeAt(h)){case 32:c+=1;break;case 9:c=CursorColumns.nextRenderTabStop(c,i);break;default:return-1}}return c===d?o:-1}}class CursorPosition{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class MoveOperations{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-prevCharLength(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new Position$1(i,e.getLineMaxColumn(i))}return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),o=e.getLineContent(t.lineNumber),r=AtomicTabMoveOperations.atomicPosition(o,t.column-1,i,0);if(-1!==r&&r+1>=n)return new Position$1(t.lineNumber,r+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?MoveOperations.leftPositionAtomicSoftTabs(t,i,e.tabSize):MoveOperations.leftPosition(t,i);return new CursorPosition(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,o){let r,s;if(i.hasSelection()&&!n)r=i.selection.startLineNumber,s=i.selection.startColumn;else{const n=i.position.delta(void 0,-(o-1)),a=t.normalizePosition(MoveOperations.clipPositionColumn(n,t),0),l=MoveOperations.left(e,t,a);r=l.lineNumber,s=l.column}return i.move(n,r,s,0)}static clipPositionColumn(e,t){return new Position$1(e.lineNumber,MoveOperations.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i+=nextCharLength(e.getLineContent(t),i-1):t<e.getLineCount()&&(t+=1,i=e.getLineMinColumn(t)),new Position$1(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,o){if(i<e.getLineIndentColumn(t)){const o=e.getLineContent(t),r=AtomicTabMoveOperations.atomicPosition(o,i-1,n,1);if(-1!==r)return new Position$1(t,r+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?MoveOperations.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):MoveOperations.rightPosition(t,i.lineNumber,i.column);return new CursorPosition(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,o){let r,s;if(i.hasSelection()&&!n)r=i.selection.endLineNumber,s=i.selection.endColumn;else{const n=i.position.delta(void 0,o-1),a=t.normalizePosition(MoveOperations.clipPositionColumn(n,t),1),l=MoveOperations.right(e,t,a);r=l.lineNumber,s=l.column}return i.move(n,r,s,0)}static vertical(e,t,i,n,o,r,s,a){const l=CursorColumns.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+o,d=t.getLineCount(),c=1===i&&1===n,h=i===d&&n===t.getLineMaxColumn(i),u=r<i?c:h;if((i=r)<1?(i=1,n=s?t.getLineMinColumn(i):Math.min(t.getLineMaxColumn(i),n)):i>d?(i=d,n=s?t.getLineMaxColumn(i):Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,l),o=u?0:l-CursorColumns.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),void 0!==a){const e=new Position$1(i,n),r=t.normalizePosition(e,a);o+=n-r.column,i=r.lineNumber,n=r.column}return new CursorPosition(i,n,o)}static down(e,t,i,n,o,r,s){return this.vertical(e,t,i,n,o,i+r,s,1)}static moveDown(e,t,i,n,o){let r,s;i.hasSelection()&&!n?(r=i.selection.endLineNumber,s=i.selection.endColumn):(r=i.position.lineNumber,s=i.position.column);const a=MoveOperations.down(e,t,r,s,i.leftoverVisibleColumns,o,!0);return i.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,o=MoveOperations.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=MoveOperations.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(o.lineNumber,o.column,o.lineNumber,o.column),o.leftoverVisibleColumns,new Position$1(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(e,t,i,n,o,r,s){return this.vertical(e,t,i,n,o,i-r,s,0)}static moveUp(e,t,i,n,o){let r,s;i.hasSelection()&&!n?(r=i.selection.startLineNumber,s=i.selection.startColumn):(r=i.position.lineNumber,s=i.position.column);const a=MoveOperations.up(e,t,r,s,i.leftoverVisibleColumns,o,!0);return i.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,o=MoveOperations.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=MoveOperations.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new SingleCursorState(new Range$2(o.lineNumber,o.column,o.lineNumber,o.column),o.leftoverVisibleColumns,new Position$1(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(e,t){return 0===e.getLineFirstNonWhitespaceColumn(t)}static moveToPrevBlankLine(e,t,i,n){let o=i.position.lineNumber;for(;o>1&&this._isBlankLine(t,o);)o--;for(;o>1&&!this._isBlankLine(t,o);)o--;return i.move(n,o,t.getLineMinColumn(o),0)}static moveToNextBlankLine(e,t,i,n){const o=t.getLineCount();let r=i.position.lineNumber;for(;r<o&&this._isBlankLine(t,r);)r++;for(;r<o&&!this._isBlankLine(t,r);)r++;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToBeginningOfLine(e,t,i,n){const o=i.position.lineNumber,r=t.getLineMinColumn(o),s=t.getLineFirstNonWhitespaceColumn(o)||r;let a;return a=i.position.column===s?r:s,i.move(n,o,a,0)}static moveToEndOfLine(e,t,i,n,o){const r=i.position.lineNumber,s=t.getLineMaxColumn(r);return i.move(n,r,s,o?1073741824-s:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const o=t.getLineCount(),r=t.getLineMaxColumn(o);return i.move(n,o,r,0)}}class DeleteOperations{static deleteRight(e,t,i,n){const o=[];let r=3!==e;for(let s=0,a=n.length;s<a;s++){const e=n[s];let a=e;if(a.isEmpty()){const n=e.getPosition(),o=MoveOperations.right(t,i,n);a=new Range$2(o.lineNumber,o.column,n.lineNumber,n.column)}a.isEmpty()?o[s]=null:(a.startLineNumber!==a.endLineNumber&&(r=!0),o[s]=new ReplaceCommand(a,""))}return[r,o]}static isAutoClosingPairDelete(e,t,i,n,o,r,s){if("never"===t&&"never"===i)return!1;if("never"===e)return!1;for(let a=0,l=r.length;a<l;a++){const l=r[a],d=l.getPosition();if(!l.isEmpty())return!1;const c=o.getLineContent(d.lineNumber);if(d.column<2||d.column>=c.length+1)return!1;const h=c.charAt(d.column-2),u=n.get(h);if(!u)return!1;if(isQuote(h)){if("never"===i)return!1}else if("never"===t)return!1;const g=c.charAt(d.column-1);let p=!1;for(const e of u)e.open===h&&e.close===g&&(p=!0);if(!p)return!1;if("auto"===e){let e=!1;for(let t=0,i=s.length;t<i;t++){const i=s[t];if(d.lineNumber===i.startLineNumber&&d.column===i.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const e=i[o].getPosition(),t=new Range$2(e.lineNumber,e.column-1,e.lineNumber,e.column+1);n[o]=new ReplaceCommand(t,"")}return[!0,n]}static deleteLeft(e,t,i,n,o){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,o))return this._runAutoClosingPairDelete(t,i,n);const r=[];let s=2!==e;for(let a=0,l=n.length;a<l;a++){const e=DeleteOperations.getDeleteRange(n[a],i,t);e.isEmpty()?r[a]=null:(e.startLineNumber!==e.endLineNumber&&(s=!0),r[a]=new ReplaceCommand(e,""))}return[s,r]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const e=t.getLineContent(n.lineNumber),o=firstNonWhitespaceIndex(e),r=-1===o?e.length+1:o+1;if(n.column<=r){const e=i.visibleColumnFromColumn(t,n),o=CursorColumns.prevIndentTabStop(e,i.indentSize),r=i.columnFromVisibleColumn(t,n.lineNumber,o);return new Range$2(n.lineNumber,r,n.lineNumber,n.column)}}return Range$2.fromPositions(DeleteOperations.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=getLeftDeleteOffset(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}if(e.lineNumber>1){const i=e.lineNumber-1;return new Position$1(i,t.getLineMaxColumn(i))}return e}static cut(e,t,i){const n=[];let o=null;i.sort(((e,t)=>Position$1.compare(e.getStartPosition(),t.getEndPosition())));for(let r=0,s=i.length;r<s;r++){const s=i[r];if(s.isEmpty())if(e.emptySelectionClipboard){const e=s.getPosition();let i,a,l,d;e.lineNumber<t.getLineCount()?(i=e.lineNumber,a=1,l=e.lineNumber+1,d=1):e.lineNumber>1&&(null==o?void 0:o.endLineNumber)!==e.lineNumber?(i=e.lineNumber-1,a=t.getLineMaxColumn(e.lineNumber-1),l=e.lineNumber,d=t.getLineMaxColumn(e.lineNumber)):(i=e.lineNumber,a=1,l=e.lineNumber,d=t.getLineMaxColumn(e.lineNumber));const c=new Range$2(i,a,l,d);o=c,c.isEmpty()?n[r]=null:n[r]=new ReplaceCommand(c,"")}else n[r]=null;else n[r]=new ReplaceCommand(s,"")}return new EditOperationResult(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}function toUint8(e){return e<0?0:e>255?255:0|e}function toUint32(e){return e<0?0:e>4294967295?4294967295:0|e}class CharacterClassifier{constructor(e){const t=toUint8(e);this._defaultValue=t,this._asciiMap=CharacterClassifier._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);for(let i=0;i<256;i++)t[i]=e;return t}set(e,t){const i=toUint8(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}}class CharacterSet{constructor(){this._actual=new CharacterClassifier(0)}add(e){this._actual.set(e,1)}has(e){return 1===this._actual.get(e)}}class WordCharacterClassifier extends CharacterClassifier{constructor(e){super(0);for(let t=0,i=e.length;t<i;t++)this.set(e.charCodeAt(t),2);this.set(32,1),this.set(9,1)}}function once(e){const t={};return i=>(t.hasOwnProperty(i)||(t[i]=e(i)),t[i])}const getMapForWordSeparators=once((e=>new WordCharacterClassifier(e)));class WordOperations{static _createWord(e,t,i,n,o){return{start:n,end:o,wordType:t,nextCharClass:i}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;for(let o=i.column-2;o>=0;o--){const i=e.charCodeAt(o),r=t.get(i);if(0===r){if(2===n)return this._createWord(e,n,r,o+1,this._findEndOfWord(e,t,n,o+1));n=1}else if(2===r){if(1===n)return this._createWord(e,n,r,o+1,this._findEndOfWord(e,t,n,o+1));n=2}else if(1===r&&0!==n)return this._createWord(e,n,r,o+1,this._findEndOfWord(e,t,n,o+1))}return 0!==n?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const o=e.length;for(let r=n;r<o;r++){const n=e.charCodeAt(r),o=t.get(n);if(1===o)return r;if(1===i&&2===o)return r;if(2===i&&0===o)return r}return o}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const o=e.length;for(let r=i.column-1;r<o;r++){const i=e.charCodeAt(r),o=t.get(i);if(0===o){if(2===n)return this._createWord(e,n,o,this._findStartOfWord(e,t,n,r-1),r);n=1}else if(2===o){if(1===n)return this._createWord(e,n,o,this._findStartOfWord(e,t,n,r-1),r);n=2}else if(1===o&&0!==n)return this._createWord(e,n,o,this._findStartOfWord(e,t,n,r-1),r)}return 0!==n?this._createWord(e,n,1,this._findStartOfWord(e,t,n,o-1),o):null}static _findStartOfWord(e,t,i,n){for(let o=n;o>=0;o--){const n=e.charCodeAt(o),r=t.get(n);if(1===r)return o+1;if(1===i&&2===r)return o+1;if(2===i&&0===r)return o+1}return 0}static moveWordLeft(e,t,i,n){let o=i.lineNumber,r=i.column;1===r&&o>1&&(o-=1,r=t.getLineMaxColumn(o));let s=WordOperations._findPreviousWordOnLine(e,t,new Position$1(o,r));if(0===n)return new Position$1(o,s?s.start+1:1);if(1===n)return s&&2===s.wordType&&s.end-s.start==1&&0===s.nextCharClass&&(s=WordOperations._findPreviousWordOnLine(e,t,new Position$1(o,s.start+1))),new Position$1(o,s?s.start+1:1);if(3===n){for(;s&&2===s.wordType;)s=WordOperations._findPreviousWordOnLine(e,t,new Position$1(o,s.start+1));return new Position$1(o,s?s.start+1:1)}return s&&r<=s.end+1&&(s=WordOperations._findPreviousWordOnLine(e,t,new Position$1(o,s.start+1))),new Position$1(o,s?s.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(1===t.column)return i>1?new Position$1(i-1,e.getLineMaxColumn(i-1)):t;const o=e.getLineContent(i);for(let r=t.column-1;r>1;r--){const e=o.charCodeAt(r-2),t=o.charCodeAt(r-1);if(95===e&&95!==t)return new Position$1(i,r);if(isLowerAsciiLetter(e)&&isUpperAsciiLetter(t))return new Position$1(i,r);if(isUpperAsciiLetter(e)&&isUpperAsciiLetter(t)&&r+1<n){if(isLowerAsciiLetter(o.charCodeAt(r)))return new Position$1(i,r)}}return new Position$1(i,1)}static moveWordRight(e,t,i,n){let o=i.lineNumber,r=i.column,s=!1;r===t.getLineMaxColumn(o)&&o<t.getLineCount()&&(s=!0,o+=1,r=1);let a=WordOperations._findNextWordOnLine(e,t,new Position$1(o,r));if(2===n)a&&2===a.wordType&&a.end-a.start==1&&0===a.nextCharClass&&(a=WordOperations._findNextWordOnLine(e,t,new Position$1(o,a.end+1))),r=a?a.end+1:t.getLineMaxColumn(o);else if(3===n){for(s&&(r=0);a&&(2===a.wordType||a.start+1<=r);)a=WordOperations._findNextWordOnLine(e,t,new Position$1(o,a.end+1));r=a?a.start+1:t.getLineMaxColumn(o)}else a&&!s&&r>=a.start+1&&(a=WordOperations._findNextWordOnLine(e,t,new Position$1(o,a.end+1))),r=a?a.start+1:t.getLineMaxColumn(o);return new Position$1(o,r)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new Position$1(i+1,1):t;const o=e.getLineContent(i);for(let r=t.column+1;r<n;r++){const e=o.charCodeAt(r-2),t=o.charCodeAt(r-1);if(95!==e&&95===t)return new Position$1(i,r);if(isLowerAsciiLetter(e)&&isUpperAsciiLetter(t))return new Position$1(i,r);if(isUpperAsciiLetter(e)&&isUpperAsciiLetter(t)&&r+1<n){if(isLowerAsciiLetter(o.charCodeAt(r)))return new Position$1(i,r)}}return new Position$1(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,o=lastNonWhitespaceIndex(i,n);return o+1<n?new Range$2(t.lineNumber,o+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;if(DeleteOperations.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const t=e.selection.getPosition();return new Range$2(t.lineNumber,t.column-1,t.lineNumber,t.column+1)}const s=new Position$1(o.positionLineNumber,o.positionColumn);let a=s.lineNumber,l=s.column;if(1===a&&1===l)return null;if(r){const e=this._deleteWordLeftWhitespace(n,s);if(e)return e}let d=WordOperations._findPreviousWordOnLine(i,n,s);return 0===t?d?l=d.start+1:l>1?l=1:(a--,l=n.getLineMaxColumn(a)):(d&&l<=d.end+1&&(d=WordOperations._findPreviousWordOnLine(i,n,new Position$1(a,d.start+1))),d?l=d.end+1:l>1?l=1:(a--,l=n.getLineMaxColumn(a))),new Range$2(a,l,s.lineNumber,s.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new Position$1(i.positionLineNumber,i.positionColumn),o=this._deleteInsideWordWhitespace(t,n);return o||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return 32===i||9===i}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(0===n)return null;let o=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,o))return null;let r=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,r))return null;for(;o>0&&this._charAtIsWhitespace(i,o-1);)o--;for(;r+1<n&&this._charAtIsWhitespace(i,r+1);)r++;return new Range$2(t.lineNumber,o+1,t.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),o=n.length;if(0===o)return i.lineNumber>1?new Range$2(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new Range$2(i.lineNumber,1,i.lineNumber+1,1):new Range$2(i.lineNumber,1,i.lineNumber,1);const r=e=>e.start+1<=i.column&&i.column<=e.end+1,s=(e,t)=>(e=Math.min(e,i.column),t=Math.max(t,i.column),new Range$2(i.lineNumber,e,i.lineNumber,t)),a=e=>{let t=e.start+1,i=e.end+1,r=!1;for(;i-1<o&&this._charAtIsWhitespace(n,i-1);)r=!0,i++;if(!r)for(;t>1&&this._charAtIsWhitespace(n,t-2);)t--;return s(t,i)},l=WordOperations._findPreviousWordOnLine(e,t,i);if(l&&r(l))return a(l);const d=WordOperations._findNextWordOnLine(e,t,i);return d&&r(d)?a(d):l&&d?s(l.end+1,d.start+1):l?s(l.start+1,l.end+1):d?s(d.start+1,d.end+1):s(1,o+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=WordOperations._moveWordPartLeft(e,i);return new Range$2(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const t=e.charAt(n);if(" "!==t&&"\t"!==t)return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,o=this._findFirstNonWhitespaceChar(i,n);return n+1<o?new Range$2(t.lineNumber,t.column,t.lineNumber,o+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,o=e.selection,r=e.whitespaceHeuristics;if(!o.isEmpty())return o;const s=new Position$1(o.positionLineNumber,o.positionColumn);let a=s.lineNumber,l=s.column;const d=n.getLineCount(),c=n.getLineMaxColumn(a);if(a===d&&l===c)return null;if(r){const e=this._deleteWordRightWhitespace(n,s);if(e)return e}let h=WordOperations._findNextWordOnLine(i,n,s);return 2===t?h?l=h.end+1:l<c||a===d?l=c:(a++,h=WordOperations._findNextWordOnLine(i,n,new Position$1(a,1)),l=h?h.start+1:n.getLineMaxColumn(a)):(h&&l>=h.start+1&&(h=WordOperations._findNextWordOnLine(i,n,new Position$1(a,h.end+1))),h?l=h.start+1:l<c||a===d?l=c:(a++,h=WordOperations._findNextWordOnLine(i,n,new Position$1(a,1)),l=h?h.start+1:n.getLineMaxColumn(a))),new Range$2(a,l,s.lineNumber,s.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=WordOperations._moveWordPartRight(e,i);return new Range$2(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new Range$2(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i){const n=getMapForWordSeparators(t),o=WordOperations._findPreviousWordOnLine(n,e,i);if(o&&1===o.wordType&&o.start<=i.column-1&&i.column-1<=o.end)return WordOperations._createWordAtPosition(e,i.lineNumber,o);const r=WordOperations._findNextWordOnLine(n,e,i);return r&&1===r.wordType&&r.start<=i.column-1&&i.column-1<=r.end?WordOperations._createWordAtPosition(e,i.lineNumber,r):null}static word(e,t,i,n,o){const r=getMapForWordSeparators(e.wordSeparators),s=WordOperations._findPreviousWordOnLine(r,t,o),a=WordOperations._findNextWordOnLine(r,t,o);if(!n){let e,i;return s&&1===s.wordType&&s.start<=o.column-1&&o.column-1<=s.end?(e=s.start+1,i=s.end+1):a&&1===a.wordType&&a.start<=o.column-1&&o.column-1<=a.end?(e=a.start+1,i=a.end+1):(e=s?s.end+1:1,i=a?a.start+1:t.getLineMaxColumn(o.lineNumber)),new SingleCursorState(new Range$2(o.lineNumber,e,o.lineNumber,i),0,new Position$1(o.lineNumber,i),0)}let l,d;s&&1===s.wordType&&s.start<o.column-1&&o.column-1<s.end?(l=s.start+1,d=s.end+1):a&&1===a.wordType&&a.start<o.column-1&&o.column-1<a.end?(l=a.start+1,d=a.end+1):(l=o.column,d=o.column);const c=o.lineNumber;let h;if(i.selectionStart.containsPosition(o))h=i.selectionStart.endColumn;else if(o.isBeforeOrEqual(i.selectionStart.getStartPosition())){h=l;const e=new Position$1(c,h);i.selectionStart.containsPosition(e)&&(h=i.selectionStart.endColumn)}else{h=d;const e=new Position$1(c,h);i.selectionStart.containsPosition(e)&&(h=i.selectionStart.startColumn)}return i.move(!0,c,h,0)}}class WordPartOperations extends WordOperations{static deleteWordPartLeft(e){const t=enforceDefined([WordOperations.deleteWordLeft(e,0),WordOperations.deleteWordLeft(e,2),WordOperations._deleteWordPartLeft(e.model,e.selection)]);return t.sort(Range$2.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=enforceDefined([WordOperations.deleteWordRight(e,0),WordOperations.deleteWordRight(e,2),WordOperations._deleteWordPartRight(e.model,e.selection)]);return t.sort(Range$2.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,i){const n=enforceDefined([WordOperations.moveWordLeft(e,t,i,0),WordOperations.moveWordLeft(e,t,i,2),WordOperations._moveWordPartLeft(t,i)]);return n.sort(Position$1.compare),n[2]}static moveWordPartRight(e,t,i){const n=enforceDefined([WordOperations.moveWordRight(e,t,i,0),WordOperations.moveWordRight(e,t,i,2),WordOperations._moveWordPartRight(t,i)]);return n.sort(Position$1.compare),n[0]}}function enforceDefined(e){return e.filter((e=>Boolean(e)))}class CursorMoveCommands{static addCursorDown(e,t,i){const n=[];let o=0;for(let r=0,s=t.length;r<s;r++){const s=t[r];n[o++]=new CursorState$1(s.modelState,s.viewState),n[o++]=i?CursorState$1.fromModelState(MoveOperations.translateDown(e.cursorConfig,e.model,s.modelState)):CursorState$1.fromViewState(MoveOperations.translateDown(e.cursorConfig,e,s.viewState))}return n}static addCursorUp(e,t,i){const n=[];let o=0;for(let r=0,s=t.length;r<s;r++){const s=t[r];n[o++]=new CursorState$1(s.modelState,s.viewState),n[o++]=i?CursorState$1.fromModelState(MoveOperations.translateUp(e.cursorConfig,e.model,s.modelState)):CursorState$1.fromViewState(MoveOperations.translateUp(e.cursorConfig,e,s.viewState))}return n}static moveToBeginningOfLine(e,t,i){let n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o];n[o]=this._moveToLineStart(e,r,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,o=n===t.modelState.position.column,r=t.viewState.position.lineNumber,s=e.getLineFirstNonWhitespaceColumn(r);return o||n===s?this._moveToLineStartByModel(e,t,i):this._moveToLineStartByView(e,t,i)}static _moveToLineStartByView(e,t,i){return CursorState$1.fromViewState(MoveOperations.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return CursorState$1.fromModelState(MoveOperations.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const o=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];o[r]=this._moveToLineEnd(e,s,i,n)}return o}static _moveToLineEnd(e,t,i,n){const o=t.viewState.position,r=e.getLineMaxColumn(o.lineNumber),s=o.column===r,a=t.modelState.position,l=e.model.getLineMaxColumn(a.lineNumber),d=r-o.column==l-a.column;return s||d?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return CursorState$1.fromViewState(MoveOperations.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return CursorState$1.fromModelState(MoveOperations.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const o=t[n],r=o.modelState.selection.startLineNumber,s=e.model.getLineCount();let a,l=o.modelState.selection.endLineNumber;l===s?a=e.model.getLineMaxColumn(s):(l++,a=1),i[n]=CursorState$1.fromModelState(new SingleCursorState(new Range$2(r,1,r,1),0,new Position$1(l,a),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o];n[o]=CursorState$1.fromModelState(MoveOperations.moveToBeginningOfBuffer(e.cursorConfig,e.model,r.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o];n[o]=CursorState$1.fromModelState(MoveOperations.moveToEndOfBuffer(e.cursorConfig,e.model,r.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return CursorState$1.fromModelState(new SingleCursorState(new Range$2(1,1,1,1),0,new Position$1(i,n),0))}static line(e,t,i,n,o){const r=e.model.validatePosition(n),s=o?e.coordinatesConverter.validateViewPosition(new Position$1(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);if(!i||!t.modelState.hasSelection()){const t=e.model.getLineCount();let i=r.lineNumber+1,n=1;return i>t&&(i=t,n=e.model.getLineMaxColumn(i)),CursorState$1.fromModelState(new SingleCursorState(new Range$2(r.lineNumber,1,i,n),0,new Position$1(i,n),0))}const a=t.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<a)return CursorState$1.fromViewState(t.viewState.move(t.modelState.hasSelection(),s.lineNumber,1,0));if(r.lineNumber>a){const i=e.getLineCount();let n=s.lineNumber+1,o=1;return n>i&&(n=i,o=e.getLineMaxColumn(n)),CursorState$1.fromViewState(t.viewState.move(t.modelState.hasSelection(),n,o,0))}{const e=t.modelState.selectionStart.getEndPosition();return CursorState$1.fromModelState(t.modelState.move(t.modelState.hasSelection(),e.lineNumber,e.column,0))}}static word(e,t,i,n){const o=e.model.validatePosition(n);return CursorState$1.fromModelState(WordOperations.word(e.cursorConfig,e.model,t.modelState,i,o))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new CursorState$1(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return CursorState$1.fromViewState(new SingleCursorState(new Range$2(i,n,i,n),0,new Position$1(i,n),0))}static moveTo(e,t,i,n,o){const r=e.model.validatePosition(n),s=o?e.coordinatesConverter.validateViewPosition(new Position$1(o.lineNumber,o.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);return CursorState$1.fromViewState(t.viewState.move(i,s.lineNumber,s.column,0))}static simpleMove(e,t,i,n,o,r){switch(i){case 0:return 4===r?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,o);case 1:return 4===r?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,o);case 2:return 2===r?this._moveUpByViewLines(e,t,n,o):this._moveUpByModelLines(e,t,n,o);case 3:return 2===r?this._moveDownByViewLines(e,t,n,o):this._moveDownByModelLines(e,t,n,o);case 4:return 2===r?t.map((t=>CursorState$1.fromViewState(MoveOperations.moveToPrevBlankLine(e.cursorConfig,e,t.viewState,n)))):t.map((t=>CursorState$1.fromModelState(MoveOperations.moveToPrevBlankLine(e.cursorConfig,e.model,t.modelState,n))));case 5:return 2===r?t.map((t=>CursorState$1.fromViewState(MoveOperations.moveToNextBlankLine(e.cursorConfig,e,t.viewState,n)))):t.map((t=>CursorState$1.fromModelState(MoveOperations.moveToNextBlankLine(e.cursorConfig,e.model,t.modelState,n))));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,o){const r=e.getCompletelyVisibleViewRange(),s=e.coordinatesConverter.convertViewRangeToModelRange(r);switch(i){case 11:{const i=this._firstLineNumberInRange(e.model,s,o),r=e.model.getLineFirstNonWhitespaceColumn(i);return[this._moveToModelPosition(e,t[0],n,i,r)]}case 13:{const i=this._lastLineNumberInRange(e.model,s,o),r=e.model.getLineFirstNonWhitespaceColumn(i);return[this._moveToModelPosition(e,t[0],n,i,r)]}case 12:{const i=Math.round((s.startLineNumber+s.endLineNumber)/2),o=e.model.getLineFirstNonWhitespaceColumn(i);return[this._moveToModelPosition(e,t[0],n,i,o)]}case 14:{const i=[];for(let o=0,s=t.length;o<s;o++){const s=t[o];i[o]=this.findPositionInViewportIfOutside(e,s,r,n)}return i}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const o=t.viewState.position.lineNumber;if(i.startLineNumber<=o&&o<=i.endLineNumber-1)return new CursorState$1(t.modelState,t.viewState);{let r;r=o>i.endLineNumber-1?i.endLineNumber-1:o<i.startLineNumber?i.startLineNumber:o;const s=MoveOperations.vertical(e.cursorConfig,e,o,t.viewState.position.column,t.viewState.leftoverVisibleColumns,r,!1);return CursorState$1.fromViewState(t.viewState.move(n,s.lineNumber,s.column,s.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map((t=>CursorState$1.fromViewState(MoveOperations.moveLeft(e.cursorConfig,e,t.viewState,i,n))))}static _moveHalfLineLeft(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=Math.round(e.getLineContent(s).length/2);n[o]=CursorState$1.fromViewState(MoveOperations.moveLeft(e.cursorConfig,e,r.viewState,i,a))}return n}static _moveRight(e,t,i,n){return t.map((t=>CursorState$1.fromViewState(MoveOperations.moveRight(e.cursorConfig,e,t.viewState,i,n))))}static _moveHalfLineRight(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=Math.round(e.getLineContent(s).length/2);n[o]=CursorState$1.fromViewState(MoveOperations.moveRight(e.cursorConfig,e,r.viewState,i,a))}return n}static _moveDownByViewLines(e,t,i,n){const o=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];o[r]=CursorState$1.fromViewState(MoveOperations.moveDown(e.cursorConfig,e,s.viewState,i,n))}return o}static _moveDownByModelLines(e,t,i,n){const o=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];o[r]=CursorState$1.fromModelState(MoveOperations.moveDown(e.cursorConfig,e.model,s.modelState,i,n))}return o}static _moveUpByViewLines(e,t,i,n){const o=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];o[r]=CursorState$1.fromViewState(MoveOperations.moveUp(e.cursorConfig,e,s.viewState,i,n))}return o}static _moveUpByModelLines(e,t,i,n){const o=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];o[r]=CursorState$1.fromModelState(MoveOperations.moveUp(e.cursorConfig,e.model,s.modelState,i,n))}return o}static _moveToViewPosition(e,t,i,n,o){return CursorState$1.fromViewState(t.viewState.move(i,n,o,0))}static _moveToModelPosition(e,t,i,n,o){return CursorState$1.fromModelState(t.modelState.move(i,n,o,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=e.getLineMinColumn(s);n[o]=this._moveToViewPosition(e,r,i,s,a)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=e.getLineFirstNonWhitespaceColumn(s);n[o]=this._moveToViewPosition(e,r,i,s,a)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=Math.round((e.getLineMaxColumn(s)+e.getLineMinColumn(s))/2);n[o]=this._moveToViewPosition(e,r,i,s,a)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=e.getLineMaxColumn(s);n[o]=this._moveToViewPosition(e,r,i,s,a)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=r.viewState.position.lineNumber,a=e.getLineLastNonWhitespaceColumn(s);n[o]=this._moveToViewPosition(e,r,i,s,a)}return n}}var CursorMove,CursorMove2;CursorMove2=CursorMove||(CursorMove={}),CursorMove2.description={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory logical position value providing where to move the cursor.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',\n\t\t\t\t\t\t'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n\t\t\t\t\t\t'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n\t\t\t\t\t\t'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'character', 'halfLine'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'select': If 'true' makes the selection. Default is 'false'.\n\t\t\t\t",constraint:function(e){if(!isObject(e))return!1;const t=e;return!(!isString$1(t.to)||!isUndefined(t.select)&&!isBoolean(t.select)||!isUndefined(t.by)&&!isString$1(t.by)||!isUndefined(t.value)&&!isNumber$1(t.value))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},CursorMove2.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},CursorMove2.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"},CursorMove2.parse=function(e){if(!e.to)return null;let t;switch(e.to){case CursorMove2.RawDirection.Left:t=0;break;case CursorMove2.RawDirection.Right:t=1;break;case CursorMove2.RawDirection.Up:t=2;break;case CursorMove2.RawDirection.Down:t=3;break;case CursorMove2.RawDirection.PrevBlankLine:t=4;break;case CursorMove2.RawDirection.NextBlankLine:t=5;break;case CursorMove2.RawDirection.WrappedLineStart:t=6;break;case CursorMove2.RawDirection.WrappedLineFirstNonWhitespaceCharacter:t=7;break;case CursorMove2.RawDirection.WrappedLineColumnCenter:t=8;break;case CursorMove2.RawDirection.WrappedLineEnd:t=9;break;case CursorMove2.RawDirection.WrappedLineLastNonWhitespaceCharacter:t=10;break;case CursorMove2.RawDirection.ViewPortTop:t=11;break;case CursorMove2.RawDirection.ViewPortBottom:t=13;break;case CursorMove2.RawDirection.ViewPortCenter:t=12;break;case CursorMove2.RawDirection.ViewPortIfOutside:t=14;break;default:return null}let i=0;switch(e.by){case CursorMove2.RawUnit.Line:i=1;break;case CursorMove2.RawUnit.WrappedLine:i=2;break;case CursorMove2.RawUnit.Character:i=3;break;case CursorMove2.RawUnit.HalfLine:i=4}return{direction:t,unit:i,select:!!e.select,value:e.value||1}};const USUAL_WORD_SEPARATORS="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function createWordRegExp(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const i of USUAL_WORD_SEPARATORS)e.indexOf(i)>=0||(t+="\\"+i);return t+="\\s]+)",new RegExp(t,"g")}const DEFAULT_WORD_REGEXP=createWordRegExp();function ensureValidWordDefinition(e){let t=DEFAULT_WORD_REGEXP;if(e&&e instanceof RegExp)if(e.global)t=e;else{let i="g";e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}const _defaultConfig={maxLen:1e3,windowSize:15,timeBudget:150};function getWordAtText(e,t,i,n,o=_defaultConfig){if(i.length>o.maxLen){let r=e-o.maxLen/2;return r<0?r=0:n+=r,getWordAtText(e,t,i=i.substring(r,e+o.maxLen/2),n,o)}const r=Date.now(),s=e-1-n;let a=-1,l=null;for(let d=1;!(Date.now()-r>=o.timeBudget);d++){const e=s-o.windowSize*d;t.lastIndex=Math.max(0,e);const n=_findRegexMatchEnclosingPosition(t,i,s,a);if(!n&&l)break;if(l=n,e<=0)break;a=e}if(l){const e={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};return t.lastIndex=0,e}return null}function _findRegexMatchEnclosingPosition(e,t,i,n){let o;for(;o=e.exec(t);){const t=o.index||0;if(t<=i&&e.lastIndex>=i)return o;if(n>0&&t>n)return null}return null}var IndentAction$1,IndentAction2;IndentAction2=IndentAction$1||(IndentAction$1={}),IndentAction2[IndentAction2.None=0]="None",IndentAction2[IndentAction2.Indent=1]="Indent",IndentAction2[IndentAction2.IndentOutdent=2]="IndentOutdent",IndentAction2[IndentAction2.Outdent=3]="Outdent";class StandardAutoClosingPairConditional{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++){switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1}}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(0===e.getTokenCount())return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const e=String.fromCharCode(i);if(!this.open.includes(e)&&!this.close.includes(e))return e}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class AutoClosingPairs{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)appendEntry(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),appendEntry(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),appendEntry(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),appendEntry(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),1===t.close.length&&1===t.open.length&&appendEntry(this.autoClosingPairsCloseSingleChar,t.close,t)}}function appendEntry(e,t,i){e.has(t)?e.get(t).push(i):e.set(t,[i])}class CharacterPairSupport{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map((e=>new StandardAutoClosingPairConditional(e))):e.brackets?this._autoClosingPairs=e.brackets.map((e=>new StandardAutoClosingPairConditional({open:e[0],close:e[1]}))):this._autoClosingPairs=[],e.colorizedBracketPairs?this._colorizedBracketPairs=filterValidBrackets(e.colorizedBracketPairs.map((e=>[e[0],e[1]]))):e.brackets?this._colorizedBracketPairs=filterValidBrackets(e.brackets.map((e=>[e[0],e[1]])).filter((e=>!("<"===e[0]&&">"===e[1])))):this._colorizedBracketPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new StandardAutoClosingPairConditional({open:t.open,close:t.close||""}))}this._autoCloseBefore="string"==typeof e.autoCloseBefore?e.autoCloseBefore:CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(){return this._autoCloseBefore}getSurroundingPairs(){return this._surroundingPairs}getColorizedBrackets(){return this._colorizedBracketPairs}}function filterValidBrackets(e){return e.filter((([e,t])=>""!==e&&""!==t))}function tail(e,t=0){return e[e.length-(1+t)]}function tail2(e){if(0===e.length)throw new Error("Invalid tail call");return[e.slice(0,e.length-1),e[e.length-1]]}function equals$1(e,t,i=((e,t)=>e===t)){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let n=0,o=e.length;n<o;n++)if(!i(e[n],t[n]))return!1;return!0}function binarySearch(e,t,i){let n=0,o=e.length-1;for(;n<=o;){const r=(n+o)/2|0,s=i(e[r],t);if(s<0)n=r+1;else{if(!(s>0))return r;o=r-1}}return-(n+1)}function findFirstInSorted(e,t){let i=0,n=e.length;if(0===n)return 0;for(;i<n;){const o=Math.floor((i+n)/2);t(e[o])?n=o:i=o+1}return i}function quickSelect(e,t,i){if((e|=0)>=t.length)throw new TypeError("invalid index");let n=t[Math.floor(t.length*Math.random())],o=[],r=[],s=[];for(let a of t){const e=i(a,n);e<0?o.push(a):e>0?r.push(a):s.push(a)}return e<o.length?quickSelect(e,o,i):e<o.length+s.length?s[0]:quickSelect(e-(o.length+s.length),r,i)}function groupBy(e,t){const i=[];let n;for(const o of e.slice(0).sort(t))n&&0===t(n[0],o)?n.push(o):(n=[o],i.push(n));return i}function coalesce(e){return e.filter((e=>!!e))}function isFalsyOrEmpty(e){return!Array.isArray(e)||0===e.length}function isNonEmptyArray(e){return Array.isArray(e)&&e.length>0}function distinct(e,t=(e=>e)){const i=new Set;return e.filter((e=>{const n=t(e);return!i.has(n)&&(i.add(n),!0)}))}function findLast(e,t){const i=lastIndex(e,t);if(-1!==i)return e[i]}function lastIndex(e,t){for(let i=e.length-1;i>=0;i--){if(t(e[i]))return i}return-1}function firstOrDefault(e,t){return e.length>0?e[0]:t}function flatten(e){return[].concat(...e)}function range(e,t){let i="number"==typeof t?e:0;"number"==typeof t?i=e:(i=0,t=e);const n=[];if(i<=t)for(let o=i;o<t;o++)n.push(o);else for(let o=i;o>t;o--)n.push(o);return n}function arrayInsert(e,t,i){const n=e.slice(0,t),o=e.slice(t);return n.concat(i,o)}function pushToStart(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.unshift(t))}function pushToEnd(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.push(t))}function asArray(e){return Array.isArray(e)?e:[e]}function insertInto(e,t,i){const n=getActualStartIndex(e,t),o=e.length,r=i.length;e.length=o+r;for(let s=o-1;s>=n;s--)e[s+r]=e[s];for(let s=0;s<r;s++)e[s+n]=i[s]}function splice$1(e,t,i,n){const o=getActualStartIndex(e,t),r=e.splice(o,i);return insertInto(e,o,n),r}function getActualStartIndex(e,t){return t<0?Math.max(t+e.length,0):Math.min(t,e.length)}function compareBy(e,t){return(i,n)=>t(e(i),e(n))}CharacterPairSupport.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED=";:.,=}])> \n\t";const numberComparator=(e,t)=>e-t;function findMaxBy(e,t){if(0===e.length)return;let i=e[0];for(let n=1;n<e.length;n++){const o=e[n];t(o,i)>0&&(i=o)}return i}function findLastMaxBy(e,t){if(0===e.length)return;let i=e[0];for(let n=1;n<e.length;n++){const o=e[n];t(o,i)>=0&&(i=o)}return i}function findMinBy(e,t){return findMaxBy(e,((e,i)=>-t(e,i)))}class ArrayQueue{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const hasBuffer="undefined"!=typeof Buffer;let textDecoder,_utf16LE_TextDecoder,_utf16BE_TextDecoder,_platformTextDecoder;class VSBuffer{constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}static wrap(e){return hasBuffer&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new VSBuffer(e)}toString(){return hasBuffer?this.buffer.toString():(textDecoder||(textDecoder=new TextDecoder),textDecoder.decode(this.buffer))}}function readUInt16LE(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function writeUInt16LE(e,t,i){e[i+0]=255&t,t>>>=8,e[i+1]=255&t}function readUInt32BE(e,t){return e[t]*Math.pow(2,24)+e[t+1]*Math.pow(2,16)+e[t+2]*Math.pow(2,8)+e[t+3]}function writeUInt32BE(e,t,i){e[i+3]=t,t>>>=8,e[i+2]=t,t>>>=8,e[i+1]=t,t>>>=8,e[i]=t}function readUInt8(e,t){return e[t]}function writeUInt8(e,t,i){e[i]=t}function getUTF16LE_TextDecoder(){return _utf16LE_TextDecoder||(_utf16LE_TextDecoder=new TextDecoder("UTF-16LE")),_utf16LE_TextDecoder}function getUTF16BE_TextDecoder(){return _utf16BE_TextDecoder||(_utf16BE_TextDecoder=new TextDecoder("UTF-16BE")),_utf16BE_TextDecoder}function getPlatformTextDecoder(){return _platformTextDecoder||(_platformTextDecoder=isLittleEndian()?getUTF16LE_TextDecoder():getUTF16BE_TextDecoder()),_platformTextDecoder}const hasTextDecoder="undefined"!=typeof TextDecoder;let createStringBuilder,decodeUTF16LE;function standardDecodeUTF16LE(e,t,i){const n=new Uint16Array(e.buffer,t,i);return i>0&&(65279===n[0]||65534===n[0])?compatDecodeUTF16LE(e,t,i):getUTF16LE_TextDecoder().decode(n)}function compatDecodeUTF16LE(e,t,i){const n=[];let o=0;for(let r=0;r<i;r++){const i=readUInt16LE(e,t);t+=2,n[o++]=String.fromCharCode(i)}return n.join("")}hasTextDecoder?(createStringBuilder=e=>new StringBuilder(e),decodeUTF16LE=standardDecodeUTF16LE):(createStringBuilder=e=>new CompatStringBuilder,decodeUTF16LE=compatDecodeUTF16LE);class StringBuilder{constructor(e){this._capacity=0|e,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return null!==this._completedStrings?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(0===this._bufferLength)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return getPlatformTextDecoder().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,null===this._completedStrings?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}write1(e){const t=this._capacity-this._bufferLength;t<=1&&(0===t||isHighSurrogate(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCII(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIIString(e){const t=e.length;if(this._bufferLength+t>=this._capacity)return this._flushBuffer(),void(this._completedStrings[this._completedStrings.length]=e);for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class CompatStringBuilder{constructor(){this._pieces=[],this._piecesLen=0}reset(){this._pieces=[],this._piecesLen=0}build(){return this._pieces.join("")}write1(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCII(e){this._pieces[this._piecesLen++]=String.fromCharCode(e)}appendASCIIString(e){this._pieces[this._piecesLen++]=e}}class RichEditBracket{constructor(e,t,i,n,o,r){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=o,this.reversedRegex=r,this._openSet=RichEditBracket._toSet(this.open),this._closeSet=RichEditBracket._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function groupFuzzyBrackets(e){const t=e.length;e=e.map((e=>[e[0].toLowerCase(),e[1].toLowerCase()]));const i=[];for(let s=0;s<t;s++)i[s]=s;const n=(e,t)=>{const[i,n]=e,[o,r]=t;return i===o||i===r||n===o||n===r},o=(e,n)=>{const o=Math.min(e,n),r=Math.max(e,n);for(let s=0;s<t;s++)i[s]===r&&(i[s]=o)};for(let s=0;s<t;s++){const r=e[s];for(let a=s+1;a<t;a++){n(r,e[a])&&o(i[s],i[a])}}const r=[];for(let s=0;s<t;s++){const n=[],o=[];for(let r=0;r<t;r++)if(i[r]===s){const[t,i]=e[r];n.push(t),o.push(i)}n.length>0&&r.push({open:n,close:o})}return r}class RichEditBrackets{constructor(e,t){this._richEditBracketsBrand=void 0;const i=groupFuzzyBrackets(t);this.brackets=i.map(((t,n)=>new RichEditBracket(e,n,t.open,t.close,getRegexForBracketPair(t.open,t.close,i,n),getReversedRegexForBracketPair(t.open,t.close,i,n)))),this.forwardRegex=getRegexForBrackets(this.brackets),this.reversedRegex=getReversedRegexForBrackets(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const e of n.open)this.textIsBracket[e]=n,this.textIsOpenBracket[e]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,e.length);for(const e of n.close)this.textIsBracket[e]=n,this.textIsOpenBracket[e]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,e.length)}}}function collectSuperstrings(e,t,i,n){for(let o=0,r=t.length;o<r;o++){if(o===i)continue;const r=t[o];for(const t of r.open)t.indexOf(e)>=0&&n.push(t);for(const t of r.close)t.indexOf(e)>=0&&n.push(t)}}function lengthcmp(e,t){return e.length-t.length}function unique(e){if(e.length<=1)return e;const t=[],i=new Set;for(const n of e)i.has(n)||(t.push(n),i.add(n));return t}function getRegexForBracketPair(e,t,i,n){let o=[];o=o.concat(e),o=o.concat(t);for(let r=0,s=o.length;r<s;r++)collectSuperstrings(o[r],i,n,o);return o=unique(o),o.sort(lengthcmp),o.reverse(),createBracketOrRegExp(o)}function getReversedRegexForBracketPair(e,t,i,n){let o=[];o=o.concat(e),o=o.concat(t);for(let r=0,s=o.length;r<s;r++)collectSuperstrings(o[r],i,n,o);return o=unique(o),o.sort(lengthcmp),o.reverse(),createBracketOrRegExp(o.map(toReversedString))}function getRegexForBrackets(e){let t=[];for(const i of e){for(const e of i.open)t.push(e);for(const e of i.close)t.push(e)}return t=unique(t),createBracketOrRegExp(t)}function getReversedRegexForBrackets(e){let t=[];for(const i of e){for(const e of i.open)t.push(e);for(const e of i.close)t.push(e)}return t=unique(t),createBracketOrRegExp(t.map(toReversedString))}function prepareBracketForRegExp$1(e){const t=/^[\w ]+$/.test(e);return e=escapeRegExpCharacters(e),t?`\\b${e}\\b`:e}function createBracketOrRegExp(e){return createRegExp(`(${e.map(prepareBracketForRegExp$1).join(")|(")})`,!0)}const toReversedString=function(){let e=null,t=null;return function(i){return e!==i&&(e=i,t=function(e){if(hasTextDecoder){const t=new Uint16Array(e.length);let i=0;for(let n=e.length-1;n>=0;n--)t[i++]=e.charCodeAt(n);return getPlatformTextDecoder().decode(t)}{const t=[];let i=0;for(let n=e.length-1;n>=0;n--)t[i++]=e.charAt(n);return t.join("")}}(e)),t}}();class BracketsUtils{static _findPrevBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=i.length-(o.index||0),s=o[0].length,a=n+r;return new Range$2(t,a-s+1,t,a+1)}static findPrevBracketInRange(e,t,i,n,o){const r=toReversedString(i).substring(i.length-o,i.length-n);return this._findPrevBracketInText(e,t,r,n)}static findNextBracketInText(e,t,i,n){const o=i.match(e);if(!o)return null;const r=o.index||0,s=o[0].length;if(0===s)return null;const a=n+r;return new Range$2(t,a+1,t,a+1+s)}static findNextBracketInRange(e,t,i,n,o){const r=i.substring(n,o);return this.findNextBracketInText(e,t,r,n)}}class BracketElectricCharacterSupport{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const t=i.charAt(i.length-1);e.push(t)}return distinct(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||0===this._richEditBrackets.brackets.length)return null;const n=t.findTokenIndexAtOffset(i-1);if(ignoreBracketsInToken(t.getStandardTokenType(n)))return null;const o=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,s=BracketsUtils.findPrevBracketInRange(o,1,r,0,r.length);if(!s)return null;const a=r.substring(s.startColumn-1,s.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[a])return null;const l=t.getActualLineContentBefore(s.startColumn-1);return/^\s*$/.test(l)?{matchOpenBracket:a}:null}}function resetGlobalRegex(e){return e.global&&(e.lastIndex=0),!0}class IndentRulesSupport{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&resetGlobalRegex(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&resetGlobalRegex(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&resetGlobalRegex(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&resetGlobalRegex(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class OnEnterSupport{constructor(e){(e=e||{}).brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach((e=>{const t=OnEnterSupport._createOpenBracketRegExp(e[0]),i=OnEnterSupport._createCloseBracketRegExp(e[1]);t&&i&&this._brackets.push({open:e[0],openRegExp:t,close:e[1],closeRegExp:i})})),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let o=0,r=this._regExpRules.length;o<r;o++){const e=this._regExpRules[o];if([{reg:e.beforeText,text:i},{reg:e.afterText,text:n},{reg:e.previousLineText,text:t}].every((e=>!e.reg||(e.reg.lastIndex=0,e.reg.test(e.text)))))return e.action}if(e>=2&&i.length>0&&n.length>0)for(let o=0,r=this._brackets.length;o<r;o++){const e=this._brackets[o];if(e.openRegExp.test(i)&&e.closeRegExp.test(n))return{indentAction:IndentAction$1.IndentOutdent}}if(e>=2&&i.length>0)for(let o=0,r=this._brackets.length;o<r;o++){if(this._brackets[o].openRegExp.test(i))return{indentAction:IndentAction$1.Indent}}return null}static _createOpenBracketRegExp(e){let t=escapeRegExpCharacters(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",OnEnterSupport._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=escapeRegExpCharacters(e);return/\B/.test(t.charAt(t.length-1))||(t+="\\b"),t="^\\s*"+t,OnEnterSupport._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return onUnexpectedError(t),null}}}const IConfigurationService=createDecorator("configurationService");function toValuesTree(e,t){const i=Object.create(null);for(let n in e)addToValueTree(i,n,e[n],t);return i}function addToValueTree(e,t,i,n){const o=t.split("."),r=o.pop();let s=e;for(let a=0;a<o.length;a++){let e=o[a],i=s[e];switch(typeof i){case"undefined":i=s[e]=Object.create(null);break;case"object":break;default:return void n(`Ignoring ${t} as ${o.slice(0,a+1).join(".")} is ${JSON.stringify(i)}`)}s=i}if("object"==typeof s&&null!==s)try{s[r]=i}catch(e2){n(`Ignoring ${t} as ${o.join(".")} is ${JSON.stringify(s)}`)}else n(`Ignoring ${t} as ${o.join(".")} is ${JSON.stringify(s)}`)}function removeFromValueTree(e,t){doRemoveFromValueTree(e,t.split("."))}function doRemoveFromValueTree(e,t){const i=t.shift();if(0!==t.length){if(-1!==Object.keys(e).indexOf(i)){const n=e[i];"object"!=typeof n||Array.isArray(n)||(doRemoveFromValueTree(n,t),0===Object.keys(n).length&&delete e[i])}}else delete e[i]}function getConfigurationValue(e,t,i){const n=function(e,t){let i=e;for(const n of t){if("object"!=typeof i||null===i)return;i=i[n]}return i}(e,t.split("."));return void 0===n?i:n}const ILanguageService=createDecorator("languageService");class SyncDescriptor{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const _registry=[];function registerSingleton(e,t,i){t instanceof SyncDescriptor||(t=new SyncDescriptor(t,[],i)),_registry.push([e,t])}function getSingletonServiceDescriptors(){return _registry}var __decorate$1A=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1u=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class LanguageConfigurationServiceChangeEvent{constructor(e){this.languageId=e}affects(e){return!this.languageId||this.languageId===e}}const ILanguageConfigurationService=createDecorator("languageConfigurationService");let LanguageConfigurationService=class extends Disposable{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this.onDidChangeEmitter=this._register(new Emitter$1),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(customizedLanguageConfigKeys));this._register(this.configurationService.onDidChangeConfiguration((e=>{const t=e.change.keys.some((e=>i.has(e))),n=e.change.overrides.filter((([e,t])=>t.some((e=>i.has(e))))).map((([e])=>e));if(t)this.configurations.clear(),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(void 0));else for(const i of n)this.languageService.isRegisteredLanguageId(i)&&(this.configurations.delete(i),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(i)))}))),this._register(LanguageConfigurationRegistry.onDidChange((e=>{this.configurations.delete(e.languageId),this.onDidChangeEmitter.fire(new LanguageConfigurationServiceChangeEvent(e.languageId))})))}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=computeConfig(e,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};function computeConfig(e,t,i){let n=LanguageConfigurationRegistry.getLanguageConfiguration(e);if(!n){if(!i.isRegisteredLanguageId(e))throw new Error(`Language id "${e}" is not configured nor known`);n=new ResolvedLanguageConfiguration(e,{})}const o=getCustomizedLanguageConfig(n.languageId,t),r=combineLanguageConfigurations([n.underlyingConfig,o]);return new ResolvedLanguageConfiguration(n.languageId,r)}LanguageConfigurationService=__decorate$1A([__param$1u(0,IConfigurationService),__param$1u(1,ILanguageService)],LanguageConfigurationService);const customizedLanguageConfigKeys={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function getCustomizedLanguageConfig(e,t){const i=t.getValue(customizedLanguageConfigKeys.brackets,{overrideIdentifier:e}),n=t.getValue(customizedLanguageConfigKeys.colorizedBracketPairs,{overrideIdentifier:e});return{brackets:validateBracketPairs(i),colorizedBracketPairs:validateBracketPairs(n)}}function validateBracketPairs(e){if(Array.isArray(e))return e.map((e=>{if(Array.isArray(e)&&2===e.length)return[e[0],e[1]]})).filter((e=>!!e))}class LanguageConfigurationChangeEvent{constructor(e){this.languageId=e}}class LanguageConfigurationRegistryImpl{constructor(){this._entries=new Map,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event}register(e,t,i=0){let n=this._entries.get(e);n||(n=new ComposedLanguageConfiguration(e),this._entries.set(e,n));const o=n.register(t,i);return this._onDidChange.fire(new LanguageConfigurationChangeEvent(e)),toDisposable((()=>{o.dispose(),this._onDidChange.fire(new LanguageConfigurationChangeEvent(e))}))}getLanguageConfiguration(e){const t=this._entries.get(e);return(null==t?void 0:t.getResolvedConfiguration())||null}getComments(e){const t=this.getLanguageConfiguration(e);return t&&t.comments||null}getIndentRulesSupport(e){const t=this.getLanguageConfiguration(e);return t&&t.indentRulesSupport||null}getPrecedingValidLine(e,t,i){const n=e.getLanguageIdAtPosition(t,0);if(t>1){let o,r=-1;for(o=t-1;o>=1;o--){if(e.getLanguageIdAtPosition(o,0)!==n)return r;const t=e.getLineContent(o);if(!i.shouldIgnore(t)&&!/^\s+$/.test(t)&&""!==t)return o;r=o}}return-1}getInheritIndentForLine(e,t,i,n=!0){if(e<4)return null;const o=this.getIndentRulesSupport(t.getLanguageId());if(!o)return null;if(i<=1)return{indentation:"",action:null};const r=this.getPrecedingValidLine(t,i,o);if(r<0)return null;if(r<1)return{indentation:"",action:null};const s=t.getLineContent(r);if(o.shouldIncrease(s)||o.shouldIndentNextLine(s))return{indentation:getLeadingWhitespace(s),action:IndentAction$1.Indent,line:r};if(o.shouldDecrease(s))return{indentation:getLeadingWhitespace(s),action:null,line:r};{if(1===r)return{indentation:getLeadingWhitespace(t.getLineContent(r)),action:null,line:r};const e=r-1,i=o.getIndentMetadata(t.getLineContent(e));if(!(3&i)&&4&i){let i=0;for(let n=e-1;n>0;n--)if(!o.shouldIndentNextLine(t.getLineContent(n))){i=n;break}return{indentation:getLeadingWhitespace(t.getLineContent(i+1)),action:null,line:i+1}}if(n)return{indentation:getLeadingWhitespace(t.getLineContent(r)),action:null,line:r};for(let n=r;n>0;n--){const e=t.getLineContent(n);if(o.shouldIncrease(e))return{indentation:getLeadingWhitespace(e),action:IndentAction$1.Indent,line:n};if(o.shouldIndentNextLine(e)){let e=0;for(let i=n-1;i>0;i--)if(!o.shouldIndentNextLine(t.getLineContent(n))){e=i;break}return{indentation:getLeadingWhitespace(t.getLineContent(e+1)),action:null,line:e+1}}if(o.shouldDecrease(e))return{indentation:getLeadingWhitespace(e),action:null,line:n}}return{indentation:getLeadingWhitespace(t.getLineContent(1)),action:null,line:1}}}getGoodIndentForLine(e,t,i,n,o){if(e<4)return null;const r=this.getLanguageConfiguration(i);if(!r)return null;const s=this.getIndentRulesSupport(i);if(!s)return null;const a=this.getInheritIndentForLine(e,t,n),l=t.getLineContent(n);if(a){const i=a.line;if(void 0!==i){const n=r.onEnter(e,"",t.getLineContent(i),"");if(n){let e=getLeadingWhitespace(t.getLineContent(i));return n.removeText&&(e=e.substring(0,e.length-n.removeText)),n.indentAction===IndentAction$1.Indent||n.indentAction===IndentAction$1.IndentOutdent?e=o.shiftIndent(e):n.indentAction===IndentAction$1.Outdent&&(e=o.unshiftIndent(e)),s.shouldDecrease(l)&&(e=o.unshiftIndent(e)),n.appendText&&(e+=n.appendText),getLeadingWhitespace(e)}}return s.shouldDecrease(l)?a.action===IndentAction$1.Indent?a.indentation:o.unshiftIndent(a.indentation):a.action===IndentAction$1.Indent?o.shiftIndent(a.indentation):a.indentation}return null}getIndentForEnter(e,t,i,n){if(e<4)return null;t.forceTokenization(i.startLineNumber);const o=t.getLineTokens(i.startLineNumber),r=createScopedLineTokens(o,i.startColumn-1),s=r.getLineContent();let a,l,d=!1;if(r.firstCharOffset>0&&o.getLanguageId(0)!==r.languageId?(d=!0,a=s.substr(0,i.startColumn-1-r.firstCharOffset)):a=o.getLineContent().substring(0,i.startColumn-1),i.isEmpty())l=s.substr(i.startColumn-1-r.firstCharOffset);else{l=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-r.firstCharOffset)}const c=this.getIndentRulesSupport(r.languageId);if(!c)return null;const h=a,u=getLeadingWhitespace(a),g={getLineTokens:e=>t.getLineTokens(e),getLanguageId:()=>t.getLanguageId(),getLanguageIdAtPosition:(e,i)=>t.getLanguageIdAtPosition(e,i),getLineContent:e=>e===i.startLineNumber?h:t.getLineContent(e)},p=getLeadingWhitespace(o.getLineContent()),m=this.getInheritIndentForLine(e,g,i.startLineNumber+1);if(!m){const e=d?p:u;return{beforeEnter:e,afterEnter:e}}let f=d?p:m.indentation;return m.action===IndentAction$1.Indent&&(f=n.shiftIndent(f)),c.shouldDecrease(l)&&(f=n.unshiftIndent(f)),{beforeEnter:d?p:u,afterEnter:f}}getIndentActionForType(e,t,i,n,o){if(e<4)return null;const r=this.getScopedLineTokens(t,i.startLineNumber,i.startColumn);if(r.firstCharOffset)return null;const s=this.getIndentRulesSupport(r.languageId);if(!s)return null;const a=r.getLineContent(),l=a.substr(0,i.startColumn-1-r.firstCharOffset);let d;if(i.isEmpty())d=a.substr(i.startColumn-1-r.firstCharOffset);else{d=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-r.firstCharOffset)}if(!s.shouldDecrease(l+d)&&s.shouldDecrease(l+n+d)){const n=this.getInheritIndentForLine(e,t,i.startLineNumber,!1);if(!n)return null;let r=n.indentation;return n.action!==IndentAction$1.Indent&&(r=o.unshiftIndent(r)),r}return null}getIndentMetadata(e,t){const i=this.getIndentRulesSupport(e.getLanguageId());return i?t<1||t>e.getLineCount()?null:i.getIndentMetadata(e.getLineContent(t)):null}getEnterAction(e,t,i){const n=this.getScopedLineTokens(t,i.startLineNumber,i.startColumn),o=this.getLanguageConfiguration(n.languageId);if(!o)return null;const r=n.getLineContent(),s=r.substr(0,i.startColumn-1-n.firstCharOffset);let a;if(i.isEmpty())a=r.substr(i.startColumn-1-n.firstCharOffset);else{a=this.getScopedLineTokens(t,i.endLineNumber,i.endColumn).getLineContent().substr(i.endColumn-1-n.firstCharOffset)}let l="";if(i.startLineNumber>1&&0===n.firstCharOffset){const e=this.getScopedLineTokens(t,i.startLineNumber-1);e.languageId===n.languageId&&(l=e.getLineContent())}const d=o.onEnter(e,l,s,a);if(!d)return null;const c=d.indentAction;let h=d.appendText;const u=d.removeText||0;h?c===IndentAction$1.Indent&&(h="\t"+h):h=c===IndentAction$1.Indent||c===IndentAction$1.IndentOutdent?"\t":"";let g=this.getIndentationAtPosition(t,i.startLineNumber,i.startColumn);return u&&(g=g.substring(0,g.length-u)),{indentAction:c,appendText:h,removeText:u,indentation:g}}getIndentationAtPosition(e,t,i){let n=getLeadingWhitespace(e.getLineContent(t));return n.length>i-1&&(n=n.substring(0,i-1)),n}getScopedLineTokens(e,t,i){e.forceTokenization(t);return createScopedLineTokens(e.getLineTokens(t),void 0===i?e.getLineMaxColumn(t)-1:i-1)}}const LanguageConfigurationRegistry=new LanguageConfigurationRegistryImpl;class ComposedLanguageConfiguration{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new LanguageConfigurationContribution(e,t,++this._order);return this._entries.push(i),this._resolved=null,toDisposable((()=>{for(let e=0;e<this._entries.length;e++)if(this._entries[e]===i){this._entries.splice(e,1),this._resolved=null;break}}))}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new ResolvedLanguageConfiguration(this.languageId,e))}return this._resolved}_resolve(){return 0===this._entries.length?null:(this._entries.sort(LanguageConfigurationContribution.cmp),combineLanguageConfigurations(this._entries.map((e=>e.configuration))))}}function combineLanguageConfigurations(e){let t={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const i of e)t={comments:i.comments||t.comments,brackets:i.brackets||t.brackets,wordPattern:i.wordPattern||t.wordPattern,indentationRules:i.indentationRules||t.indentationRules,onEnterRules:i.onEnterRules||t.onEnterRules,autoClosingPairs:i.autoClosingPairs||t.autoClosingPairs,surroundingPairs:i.surroundingPairs||t.surroundingPairs,autoCloseBefore:i.autoCloseBefore||t.autoCloseBefore,folding:i.folding||t.folding,colorizedBracketPairs:i.colorizedBracketPairs||t.colorizedBracketPairs,__electricCharacterSupport:i.__electricCharacterSupport||t.__electricCharacterSupport};return t}class LanguageConfigurationContribution{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class ResolvedLanguageConfiguration{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new OnEnterSupport(this.underlyingConfig):null,this.comments=ResolvedLanguageConfiguration._handleComments(this.underlyingConfig),this.characterPair=new CharacterPairSupport(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||DEFAULT_WORD_REGEXP,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new IndentRulesSupport(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{}}getWordDefinition(){return ensureValidWordDefinition(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new RichEditBrackets(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new BracketElectricCharacterSupport(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new AutoClosingPairs(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(){return this.characterPair.getAutoCloseBeforeSet()}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[e,n]=t.blockComment;i.blockCommentStartToken=e,i.blockCommentEndToken=n}return i}}registerSingleton(ILanguageConfigurationService,LanguageConfigurationService);const repeatCache=Object.create(null);function cachedStringRepeat(e,t){if(t<=0)return"";repeatCache[e]||(repeatCache[e]=["",e]);const i=repeatCache[e];for(let n=i.length;n<=t;n++)i[n]=i[n-1]+e;return i[t]}class ShiftCommand{constructor(e,t){this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}static unshiftIndent(e,t,i,n,o){const r=CursorColumns.visibleColumnFromColumn(e,t,i);if(o){const e=cachedStringRepeat(" ",n);return cachedStringRepeat(e,CursorColumns.prevIndentTabStop(r,n)/n)}return cachedStringRepeat("\t",CursorColumns.prevRenderTabStop(r,i)/i)}static shiftIndent(e,t,i,n,o){const r=CursorColumns.visibleColumnFromColumn(e,t,i);if(o){const e=cachedStringRepeat(" ",n);return cachedStringRepeat(e,CursorColumns.nextIndentTabStop(r,n)/n)}return cachedStringRepeat("\t",CursorColumns.nextRenderTabStop(r,i)/i)}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;1===this._selection.endColumn&&i!==n&&(n-=1);const{tabSize:o,indentSize:r,insertSpaces:s}=this._opts,a=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let l=0,d=0;for(let c=i;c<=n;c++,l=d){d=0;const n=e.getLineContent(c);let h,u=firstNonWhitespaceIndex(n);if((!this._opts.isUnshift||0!==n.length&&0!==u)&&(a||this._opts.isUnshift||0!==n.length)){if(-1===u&&(u=n.length),c>1){if(CursorColumns.visibleColumnFromColumn(n,u+1,o)%r!=0&&e.isCheapToTokenize(c-1)){const t=LanguageConfigurationRegistry.getEnterAction(this._opts.autoIndent,e,new Range$2(c-1,e.getLineMaxColumn(c-1),c-1,e.getLineMaxColumn(c-1)));if(t){if(d=l,t.appendText)for(let e=0,i=t.appendText.length;e<i&&d<r&&32===t.appendText.charCodeAt(e);e++)d++;t.removeText&&(d=Math.max(0,d-t.removeText));for(let e=0;e<d&&(0!==u&&32===n.charCodeAt(u-1));e++)u--}}}this._opts.isUnshift&&0===u||(h=this._opts.isUnshift?ShiftCommand.unshiftIndent(n,u+1,o,r,s):ShiftCommand.shiftIndent(n,u+1,o,r,s),this._addEditOperation(t,new Range$2(c,1,c,u+1),h),c!==i||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=this._selection.startColumn<=u+1))}}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&0===e.getLineLength(i)&&(this._useLastEditRangeForCursorEndPosition=!0);const o=s?cachedStringRepeat(" ",r):"\t";for(let s=i;s<=n;s++){const n=e.getLineContent(s);let l=firstNonWhitespaceIndex(n);if((!this._opts.isUnshift||0!==n.length&&0!==l)&&((a||this._opts.isUnshift||0!==n.length)&&(-1===l&&(l=n.length),!this._opts.isUnshift||0!==l)))if(this._opts.isUnshift){l=Math.min(l,r);for(let e=0;e<l;e++){if(9===n.charCodeAt(e)){l=e+1;break}}this._addEditOperation(t,new Range$2(s,1,s,l+1),"")}else this._addEditOperation(t,new Range$2(s,1,s,1),o),s!==i||this._selection.isEmpty()||(this._selectionStartColumnStaysPut=1===this._selection.startColumn)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const e=t.getInverseEditOperations()[0];return new Selection$1(e.range.endLineNumber,e.range.endColumn,e.range.endLineNumber,e.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const e=this._selection.startColumn;return i.startColumn<=e?i:0===i.getDirection()?new Selection$1(i.startLineNumber,e,i.endLineNumber,i.endColumn):new Selection$1(i.endLineNumber,i.endColumn,i.startLineNumber,e)}return i}}class SurroundSelectionCommand{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new Range$2(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new Range$2(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,o=i[1].range;return new Selection$1(n.endLineNumber,n.endColumn,o.endLineNumber,o.endColumn-this._charAfterSelection.length)}}class TypeOperations{static indent(e,t,i){if(null===t||null===i)return[];const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new ShiftCommand(i[o],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return n}static outdent(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new ShiftCommand(i[o],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent});return n}static shiftIndent(e,t,i){return i=i||1,ShiftCommand.shiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static unshiftIndent(e,t,i){return i=i||1,ShiftCommand.unshiftIndent(t,t.length+i,e.tabSize,e.indentSize,e.insertSpaces)}static _distributedPaste(e,t,i,n){const o=[];for(let r=0,s=i.length;r<s;r++)o[r]=new ReplaceCommand(i[r],n[r]);return new EditOperationResult(0,o,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,o){const r=[];for(let s=0,a=i.length;s<a;s++){const e=i[s],t=e.getPosition();if(o&&!e.isEmpty()&&(o=!1),o&&n.indexOf("\n")!==n.length-1&&(o=!1),o){const i=new Range$2(t.lineNumber,1,t.lineNumber,1);r[s]=new ReplaceCommandThatPreservesSelection(i,n,e,!0)}else r[s]=new ReplaceCommand(e,n)}return new EditOperationResult(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _distributePasteToCursors(e,t,i,n,o){if(n)return null;if(1===t.length)return null;if(o&&o.length===t.length)return o;if("spread"===e.multiCursorPaste){10===i.charCodeAt(i.length-1)&&(i=i.substr(0,i.length-1)),13===i.charCodeAt(i.length-1)&&(i=i.substr(0,i.length-1));const e=splitLines(i);if(e.length===t.length)return e}return null}static paste(e,t,i,n,o,r){const s=this._distributePasteToCursors(e,i,n,o,r);return s?(i=i.sort(Range$2.compareRangesUsingStarts),this._distributedPaste(e,t,i,s)):this._simplePaste(e,t,i,n,o)}static _goodIndentForLine(e,t,i){let n=null,o="";const r=LanguageConfigurationRegistry.getInheritIndentForLine(e.autoIndent,t,i,!1);if(r)n=r.action,o=r.indentation;else if(i>1){let n;for(n=i-1;n>=1;n--){if(lastNonWhitespaceIndex(t.getLineContent(n))>=0)break}if(n<1)return null;const r=t.getLineMaxColumn(n),s=LanguageConfigurationRegistry.getEnterAction(e.autoIndent,t,new Range$2(n,r,n,r));s&&(o=s.indentation+s.appendText)}return n&&(n===IndentAction$1.Indent&&(o=TypeOperations.shiftIndent(e,o)),n===IndentAction$1.Outdent&&(o=TypeOperations.unshiftIndent(e,o)),o=e.normalizeIndentation(o)),o||null}static _replaceJumpToNextIndent(e,t,i,n){let o="";const r=i.getStartPosition();if(e.insertSpaces){const i=e.visibleColumnFromColumn(t,r),n=e.indentSize,s=n-i%n;for(let e=0;e<s;e++)o+=" "}else o="\t";return new ReplaceCommand(i,o,n)}static tab(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++){const r=i[o];if(r.isEmpty()){const i=t.getLineContent(r.startLineNumber);if(/^\s*$/.test(i)&&t.isCheapToTokenize(r.startLineNumber)){let s=this._goodIndentForLine(e,t,r.startLineNumber);s=s||"\t";const a=e.normalizeIndentation(s);if(!i.startsWith(a)){n[o]=new ReplaceCommand(new Range$2(r.startLineNumber,1,r.startLineNumber,i.length+1),a,!0);continue}}n[o]=this._replaceJumpToNextIndent(e,t,r,!0)}else{if(r.startLineNumber===r.endLineNumber){const i=t.getLineMaxColumn(r.startLineNumber);if(1!==r.startColumn||r.endColumn!==i){n[o]=this._replaceJumpToNextIndent(e,t,r,!1);continue}}n[o]=new ShiftCommand(r,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent})}}return n}static compositionType(e,t,i,n,o,r,s,a){const l=n.map((e=>this._compositionType(i,e,o,r,s,a)));return new EditOperationResult(4,l,{shouldPushStackElementBefore:shouldPushStackElementBetween(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,o,r){if(!t.isEmpty())return null;const s=t.getPosition(),a=Math.max(1,s.column-n),l=Math.min(e.getLineMaxColumn(s.lineNumber),s.column+o),d=new Range$2(s.lineNumber,a,s.lineNumber,l);return e.getValueInRange(d)===i&&0===r?null:new ReplaceCommandWithOffsetCursorState(d,i,0,r)}static _typeCommand(e,t,i){return i?new ReplaceCommandWithoutChangingPosition(e,t,!0):new ReplaceCommand(e,t,!0)}static _enter(e,t,i,n){if(0===e.autoIndent)return TypeOperations._typeCommand(n,"\n",i);if(!t.isCheapToTokenize(n.getStartPosition().lineNumber)||1===e.autoIndent){const o=getLeadingWhitespace(t.getLineContent(n.startLineNumber)).substring(0,n.startColumn-1);return TypeOperations._typeCommand(n,"\n"+e.normalizeIndentation(o),i)}const o=LanguageConfigurationRegistry.getEnterAction(e.autoIndent,t,n);if(o){if(o.indentAction===IndentAction$1.None)return TypeOperations._typeCommand(n,"\n"+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===IndentAction$1.Indent)return TypeOperations._typeCommand(n,"\n"+e.normalizeIndentation(o.indentation+o.appendText),i);if(o.indentAction===IndentAction$1.IndentOutdent){const t=e.normalizeIndentation(o.indentation),r=e.normalizeIndentation(o.indentation+o.appendText),s="\n"+r+"\n"+t;return i?new ReplaceCommandWithoutChangingPosition(n,s,!0):new ReplaceCommandWithOffsetCursorState(n,s,-1,r.length-t.length,!0)}if(o.indentAction===IndentAction$1.Outdent){const t=TypeOperations.unshiftIndent(e,o.indentation);return TypeOperations._typeCommand(n,"\n"+e.normalizeIndentation(t+o.appendText),i)}}const r=getLeadingWhitespace(t.getLineContent(n.startLineNumber)).substring(0,n.startColumn-1);if(e.autoIndent>=4){const o=LanguageConfigurationRegistry.getIndentForEnter(e.autoIndent,t,n,{unshiftIndent:t=>TypeOperations.unshiftIndent(e,t),shiftIndent:t=>TypeOperations.shiftIndent(e,t),normalizeIndentation:t=>e.normalizeIndentation(t)});if(o){let r=e.visibleColumnFromColumn(t,n.getEndPosition());const s=n.endColumn,a=firstNonWhitespaceIndex(t.getLineContent(n.endLineNumber));if(n=a>=0?n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,a+1)):n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new ReplaceCommandWithoutChangingPosition(n,"\n"+e.normalizeIndentation(o.afterEnter),!0);{let t=0;return s<=a+1&&(e.insertSpaces||(r=Math.ceil(r/e.indentSize)),t=Math.min(r+1-e.normalizeIndentation(o.afterEnter).length-1,0)),new ReplaceCommandWithOffsetCursorState(n,"\n"+e.normalizeIndentation(o.afterEnter),0,t,!0)}}}return TypeOperations._typeCommand(n,"\n"+e.normalizeIndentation(r),i)}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,o=i.length;n<o;n++)if(!t.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _runAutoIndentType(e,t,i,n){const o=LanguageConfigurationRegistry.getIndentationAtPosition(t,i.startLineNumber,i.startColumn),r=LanguageConfigurationRegistry.getIndentActionForType(e.autoIndent,t,i,n,{shiftIndent:t=>TypeOperations.shiftIndent(e,t),unshiftIndent:t=>TypeOperations.unshiftIndent(e,t)});if(null===r)return null;if(r!==e.normalizeIndentation(o)){const o=t.getLineFirstNonWhitespaceColumn(i.startLineNumber);return 0===o?TypeOperations._typeCommand(new Range$2(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(r)+n,!1):TypeOperations._typeCommand(new Range$2(i.startLineNumber,1,i.endLineNumber,i.endColumn),e.normalizeIndentation(r)+t.getLineContent(i.startLineNumber).substring(o-1,i.startColumn-1)+n,!1)}return null}static _isAutoClosingOvertype(e,t,i,n,o){if("never"===e.autoClosingOvertype)return!1;if(!e.autoClosingPairs.autoClosingPairsCloseSingleChar.has(o))return!1;for(let r=0,s=i.length;r<s;r++){const s=i[r];if(!s.isEmpty())return!1;const a=s.getPosition(),l=t.getLineContent(a.lineNumber);if(l.charAt(a.column-1)!==o)return!1;const d=isQuote(o);if(92===(a.column>2?l.charCodeAt(a.column-2):0)&&d)return!1;if("auto"===e.autoClosingOvertype){let e=!1;for(let t=0,i=n.length;t<i;t++){const i=n[t];if(a.lineNumber===i.startLineNumber&&a.column===i.startColumn){e=!0;break}}if(!e)return!1}}return!0}static _runAutoClosingOvertype(e,t,i,n,o){const r=[];for(let s=0,a=n.length;s<a;s++){const e=n[s].getPosition(),t=new Range$2(e.lineNumber,e.column,e.lineNumber,e.column+1);r[s]=new ReplaceCommand(t,o)}return new EditOperationResult(4,r,{shouldPushStackElementBefore:shouldPushStackElementBetween(e,4),shouldPushStackElementAfter:!1})}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],o=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],r=n.some((e=>t.startsWith(e.open))),s=o.some((e=>t.startsWith(e.close)));return!r&&s}static _findAutoClosingPairOpen(e,t,i,n){const o=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!o)return null;let r=null;for(const s of o)if(null===r||s.open.length>r.open.length){let e=!0;for(const o of i){if(t.getValueInRange(new Range$2(o.lineNumber,o.column-s.open.length+1,o.lineNumber,o.column))+n!==s.open){e=!1;break}}e&&(r=s)}return r}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let o=null;for(const r of n)r.open!==t.open&&t.open.includes(r.open)&&t.close.endsWith(r.close)&&(!o||r.open.length>o.open.length)&&(o=r);return o}static _getAutoClosingPairClose(e,t,i,n,o){const r=isQuote(n),s=r?e.autoClosingQuotes:e.autoClosingBrackets,a=r?e.shouldAutoCloseBefore.quote:e.shouldAutoCloseBefore.bracket;if("never"===s)return null;for(const g of i)if(!g.isEmpty())return null;const l=i.map((e=>{const t=e.getPosition();return o?{lineNumber:t.lineNumber,beforeColumn:t.column-n.length,afterColumn:t.column}:{lineNumber:t.lineNumber,beforeColumn:t.column,afterColumn:t.column}})),d=this._findAutoClosingPairOpen(e,t,l.map((e=>new Position$1(e.lineNumber,e.beforeColumn))),n);if(!d)return null;const c=this._findContainedAutoClosingPair(e,d),h=c?c.close:"";let u=!0;for(const g of l){const{lineNumber:i,beforeColumn:o,afterColumn:r}=g,l=t.getLineContent(i),c=l.substring(0,o-1),p=l.substring(r-1);if(p.startsWith(h)||(u=!1),p.length>0){const t=p.charAt(0);if(!TypeOperations._isBeforeClosingBrace(e,p)&&!a(t))return null}if(1===d.open.length&&("'"===n||'"'===n)&&"always"!==s){const t=getMapForWordSeparators(e.wordSeparators);if(c.length>0){const e=c.charCodeAt(c.length-1);if(0===t.get(e))return null}}if(!t.isCheapToTokenize(i))return null;t.forceTokenization(i);const m=createScopedLineTokens(t.getLineTokens(i),o-1);if(!d.shouldAutoClose(m,o-m.firstCharOffset))return null;const f=d.findNeutralCharacter();if(f){const e=t.getTokenTypeIfInsertingCharacter(i,o,f);if(!d.isOK(e))return null}}return u?d.close.substring(0,d.close.length-h.length):d.close}static _runAutoClosingOpenCharType(e,t,i,n,o,r,s){const a=[];for(let l=0,d=n.length;l<d;l++){const e=n[l];a[l]=new TypeWithAutoClosingCommand(e,o,!r,s)}return new EditOperationResult(4,a,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static _shouldSurroundChar(e,t){return isQuote(t)?"quotes"===e.autoSurround||"languageDefined"===e.autoSurround:"brackets"===e.autoSurround||"languageDefined"===e.autoSurround}static _isSurroundSelectionType(e,t,i,n){if(!TypeOperations._shouldSurroundChar(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const o=isQuote(n);for(let r=0,s=i.length;r<s;r++){const e=i[r];if(e.isEmpty())return!1;let n=!0;for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const o=t.getLineContent(i),r=i===e.startLineNumber?e.startColumn-1:0,s=i===e.endLineNumber?e.endColumn-1:o.length,a=o.substring(r,s);if(/[^ \t]/.test(a)){n=!1;break}}if(n)return!1;if(o&&e.startLineNumber===e.endLineNumber&&e.startColumn+1===e.endColumn){if(isQuote(t.getValueInRange(e)))return!1}}return!0}static _runSurroundSelectionType(e,t,i,n,o){const r=[];for(let s=0,a=n.length;s<a;s++){const e=n[s],i=t.surroundingPairs[o];r[s]=new SurroundSelectionCommand(e,o,i)}return new EditOperationResult(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isTypeInterceptorElectricChar(e,t,i){return!(1!==i.length||!t.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,o){if(!t.electricChars.hasOwnProperty(o)||!n.isEmpty())return null;const r=n.getPosition();i.forceTokenization(r.lineNumber);const s=i.getLineTokens(r.lineNumber);let a;try{a=t.onElectricCharacter(o,s,r.column)}catch(e2){return onUnexpectedError(e2),null}if(!a)return null;if(a.matchOpenBracket){const n=(s.getLineContent()+o).lastIndexOf(a.matchOpenBracket)+1,l=i.bracketPairs.findMatchingBracketUp(a.matchOpenBracket,{lineNumber:r.lineNumber,column:n},500);if(l){if(l.startLineNumber===r.lineNumber)return null;const n=getLeadingWhitespace(i.getLineContent(l.startLineNumber)),s=t.normalizeIndentation(n),a=i.getLineContent(r.lineNumber),d=i.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,c=s+a.substring(d-1,r.column-1)+o,h=new Range$2(r.lineNumber,1,r.lineNumber,r.column),u=new ReplaceCommand(h,c);return new EditOperationResult(getTypingOperation(c,e),[u],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}static compositionEndWithInterceptors(e,t,i,n,o,r){if(!n||Selection$1.selectionsArrEqual(n,o))return null;let s=null;for(const l of o){if(!l.isEmpty())return null;const e=l.getPosition(),t=i.getValueInRange(new Range$2(e.lineNumber,e.column-1,e.lineNumber,e.column));if(null===s)s=t;else if(s!==t)return null}if(!s)return null;if(this._isAutoClosingOvertype(t,i,o,r,s)){const e=o.map((e=>new ReplaceCommand(new Range$2(e.positionLineNumber,e.positionColumn,e.positionLineNumber,e.positionColumn+1),"",!1)));return new EditOperationResult(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const a=this._getAutoClosingPairClose(t,i,o,s,!0);return null!==a?this._runAutoClosingOpenCharType(e,t,i,o,s,!0,a):null}static typeWithInterceptors(e,t,i,n,o,r,s){if(!e&&"\n"===s){const e=[];for(let t=0,r=o.length;t<r;t++)e[t]=TypeOperations._enter(i,n,!1,o[t]);return new EditOperationResult(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoIndentType(i,n,o)){const e=[];let t=!1;for(let r=0,a=o.length;r<a;r++)if(e[r]=this._runAutoIndentType(i,n,o[r],s),!e[r]){t=!0;break}if(!t)return new EditOperationResult(4,e,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}if(!e&&this._isAutoClosingOvertype(i,n,o,r,s))return this._runAutoClosingOvertype(t,i,n,o,s);if(!e){const e=this._getAutoClosingPairClose(i,n,o,s,!1);if(e)return this._runAutoClosingOpenCharType(t,i,n,o,s,!1,e)}if(this._isSurroundSelectionType(i,n,o,s))return this._runSurroundSelectionType(t,i,n,o,s);if(!e&&this._isTypeInterceptorElectricChar(i,n,o)){const e=this._typeInterceptorElectricChar(t,i,n,o[0],s);if(e)return e}const a=[];for(let d=0,c=o.length;d<c;d++)a[d]=new ReplaceCommand(o[d],s);const l=getTypingOperation(s,t);return new EditOperationResult(l,a,{shouldPushStackElementBefore:shouldPushStackElementBetween(t,l),shouldPushStackElementAfter:!1})}static typeWithoutInterceptors(e,t,i,n,o){const r=[];for(let a=0,l=n.length;a<l;a++)r[a]=new ReplaceCommand(n[a],o);const s=getTypingOperation(o,e);return new EditOperationResult(s,r,{shouldPushStackElementBefore:shouldPushStackElementBetween(e,s),shouldPushStackElementAfter:!1})}static lineInsertBefore(e,t,i){if(null===t||null===i)return[];const n=[];for(let o=0,r=i.length;o<r;o++){let r=i[o].positionLineNumber;if(1===r)n[o]=new ReplaceCommandWithoutChangingPosition(new Range$2(1,1,1,1),"\n");else{r--;const i=t.getLineMaxColumn(r);n[o]=this._enter(e,t,!1,new Range$2(r,i,r,i))}}return n}static lineInsertAfter(e,t,i){if(null===t||null===i)return[];const n=[];for(let o=0,r=i.length;o<r;o++){const r=i[o].positionLineNumber,s=t.getLineMaxColumn(r);n[o]=this._enter(e,t,!1,new Range$2(r,s,r,s))}return n}static lineBreakInsert(e,t,i){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=this._enter(e,t,!0,i[o]);return n}}class TypeWithAutoClosingCommand extends ReplaceCommandWithOffsetCursorState{constructor(e,t,i,n){super(e,(i?t:"")+n,0,-n.length),this._openCharacter=t,this._closeCharacter=n,this.closeCharacterRange=null,this.enclosingRange=null}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return this.closeCharacterRange=new Range$2(i.startLineNumber,i.endColumn-this._closeCharacter.length,i.endLineNumber,i.endColumn),this.enclosingRange=new Range$2(i.startLineNumber,i.endColumn-this._openCharacter.length-this._closeCharacter.length,i.endLineNumber,i.endColumn),super.computeCursorState(e,t)}}function getTypingOperation(e,t){return" "===e?5===t||6===t?6:5:4}function shouldPushStackElementBetween(e,t){return!(!isTypingOperation(e)||isTypingOperation(t))||5!==e&&normalizeOperationType(e)!==normalizeOperationType(t)}function normalizeOperationType(e){return 6===e||5===e?"space":e}function isTypingOperation(e){return 4===e||5===e||6===e}var EditorContextKeys,EditorContextKeys2;EditorContextKeys2=EditorContextKeys||(EditorContextKeys={}),EditorContextKeys2.editorSimpleInput=new RawContextKey("editorSimpleInput",!1,!0),EditorContextKeys2.editorTextFocus=new RawContextKey("editorTextFocus",!1,localize("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),EditorContextKeys2.focus=new RawContextKey("editorFocus",!1,localize("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),EditorContextKeys2.textInputFocus=new RawContextKey("textInputFocus",!1,localize("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),EditorContextKeys2.readOnly=new RawContextKey("editorReadonly",!1,localize("editorReadonly","Whether the editor is read only")),EditorContextKeys2.inDiffEditor=new RawContextKey("inDiffEditor",!1,localize("inDiffEditor","Whether the context is a diff editor")),EditorContextKeys2.columnSelection=new RawContextKey("editorColumnSelection",!1,localize("editorColumnSelection","Whether `editor.columnSelection` is enabled")),EditorContextKeys2.writable=EditorContextKeys2.readOnly.toNegated(),EditorContextKeys2.hasNonEmptySelection=new RawContextKey("editorHasSelection",!1,localize("editorHasSelection","Whether the editor has text selected")),EditorContextKeys2.hasOnlyEmptySelection=EditorContextKeys2.hasNonEmptySelection.toNegated(),EditorContextKeys2.hasMultipleSelections=new RawContextKey("editorHasMultipleSelections",!1,localize("editorHasMultipleSelections","Whether the editor has multiple selections")),EditorContextKeys2.hasSingleSelection=EditorContextKeys2.hasMultipleSelections.toNegated(),EditorContextKeys2.tabMovesFocus=new RawContextKey("editorTabMovesFocus",!1,localize("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),EditorContextKeys2.tabDoesNotMoveFocus=EditorContextKeys2.tabMovesFocus.toNegated(),EditorContextKeys2.isInWalkThroughSnippet=new RawContextKey("isInEmbeddedEditor",!1,!0),EditorContextKeys2.canUndo=new RawContextKey("canUndo",!1,!0),EditorContextKeys2.canRedo=new RawContextKey("canRedo",!1,!0),EditorContextKeys2.hoverVisible=new RawContextKey("editorHoverVisible",!1,localize("editorHoverVisible","Whether the editor hover is visible")),EditorContextKeys2.inCompositeEditor=new RawContextKey("inCompositeEditor",void 0,localize("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),EditorContextKeys2.notInCompositeEditor=EditorContextKeys2.inCompositeEditor.toNegated(),EditorContextKeys2.languageId=new RawContextKey("editorLangId","",localize("editorLangId","The language identifier of the editor")),EditorContextKeys2.hasCompletionItemProvider=new RawContextKey("editorHasCompletionItemProvider",!1,localize("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),EditorContextKeys2.hasCodeActionsProvider=new RawContextKey("editorHasCodeActionsProvider",!1,localize("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),EditorContextKeys2.hasCodeLensProvider=new RawContextKey("editorHasCodeLensProvider",!1,localize("editorHasCodeLensProvider","Whether the editor has a code lens provider")),EditorContextKeys2.hasDefinitionProvider=new RawContextKey("editorHasDefinitionProvider",!1,localize("editorHasDefinitionProvider","Whether the editor has a definition provider")),EditorContextKeys2.hasDeclarationProvider=new RawContextKey("editorHasDeclarationProvider",!1,localize("editorHasDeclarationProvider","Whether the editor has a declaration provider")),EditorContextKeys2.hasImplementationProvider=new RawContextKey("editorHasImplementationProvider",!1,localize("editorHasImplementationProvider","Whether the editor has an implementation provider")),EditorContextKeys2.hasTypeDefinitionProvider=new RawContextKey("editorHasTypeDefinitionProvider",!1,localize("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),EditorContextKeys2.hasHoverProvider=new RawContextKey("editorHasHoverProvider",!1,localize("editorHasHoverProvider","Whether the editor has a hover provider")),EditorContextKeys2.hasDocumentHighlightProvider=new RawContextKey("editorHasDocumentHighlightProvider",!1,localize("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),EditorContextKeys2.hasDocumentSymbolProvider=new RawContextKey("editorHasDocumentSymbolProvider",!1,localize("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),EditorContextKeys2.hasReferenceProvider=new RawContextKey("editorHasReferenceProvider",!1,localize("editorHasReferenceProvider","Whether the editor has a reference provider")),EditorContextKeys2.hasRenameProvider=new RawContextKey("editorHasRenameProvider",!1,localize("editorHasRenameProvider","Whether the editor has a rename provider")),EditorContextKeys2.hasSignatureHelpProvider=new RawContextKey("editorHasSignatureHelpProvider",!1,localize("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),EditorContextKeys2.hasInlayHintsProvider=new RawContextKey("editorHasInlayHintsProvider",!1,localize("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),EditorContextKeys2.hasDocumentFormattingProvider=new RawContextKey("editorHasDocumentFormattingProvider",!1,localize("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),EditorContextKeys2.hasDocumentSelectionFormattingProvider=new RawContextKey("editorHasDocumentSelectionFormattingProvider",!1,localize("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),EditorContextKeys2.hasMultipleDocumentFormattingProvider=new RawContextKey("editorHasMultipleDocumentFormattingProvider",!1,localize("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),EditorContextKeys2.hasMultipleDocumentSelectionFormattingProvider=new RawContextKey("editorHasMultipleDocumentSelectionFormattingProvider",!1,localize("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"));const CORE_WEIGHT=0;class CoreEditorCommand extends EditorCommand{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var EditorScroll_,EditorScroll_2,RevealLine_,RevealLine_2,CoreNavigationCommands;EditorScroll_2=EditorScroll_||(EditorScroll_={}),EditorScroll_2.description={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage'\n\t\t\t\t\t\t```\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t",constraint:function(e){if(!isObject(e))return!1;const t=e;return!(!isString$1(t.to)||!isUndefined(t.by)&&!isString$1(t.by)||!isUndefined(t.value)&&!isNumber$1(t.value)||!isUndefined(t.revealCursor)&&!isBoolean(t.revealCursor))},schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},EditorScroll_2.RawDirection={Up:"up",Down:"down"},EditorScroll_2.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage"},EditorScroll_2.parse=function(e){let t,i;switch(e.to){case EditorScroll_2.RawDirection.Up:t=1;break;case EditorScroll_2.RawDirection.Down:t=2;break;default:return null}switch(e.by){case EditorScroll_2.RawUnit.Line:i=1;break;case EditorScroll_2.RawUnit.WrappedLine:i=2;break;case EditorScroll_2.RawUnit.Page:i=3;break;case EditorScroll_2.RawUnit.HalfPage:i=4;break;default:i=2}return{direction:t,unit:i,value:Math.floor(e.value||1),revealCursor:!!e.revealCursor,select:!!e.select}},RevealLine_2=RevealLine_||(RevealLine_={}),RevealLine_2.description={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t```\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t```\n\t\t\t\t",constraint:function(e){if(!isObject(e))return!1;const t=e;return!(!isNumber$1(t.lineNumber)&&!isString$1(t.lineNumber)||!isUndefined(t.at)&&!isString$1(t.at))},schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},RevealLine_2.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"};class EditorOrNativeTextInputCommand{constructor(e){e.addImplementation(1e4,"code-editor",((e,t)=>{const i=e.get(ICodeEditorService).getFocusedCodeEditor();return!(!i||!i.hasTextFocus())&&this._runEditorCommand(e,i,t)})),e.addImplementation(1e3,"generic-dom-input-textarea",((e,t)=>{const i=document.activeElement;return!!(i&&["input","textarea"].indexOf(i.tagName.toLowerCase())>=0)&&(this.runDOMCommand(),!0)})),e.addImplementation(0,"generic-dom",((e,t)=>{const i=e.get(ICodeEditorService).getActiveCodeEditor();return!!i&&(i.focus(),this._runEditorCommand(e,i,t))}))}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}!function(e){class t extends CoreEditorCommand{constructor(e){super(e),this._minimalReveal=e.minimalReveal,this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement();e.setCursorStates(t.source,3,[CursorMoveCommands.moveTo(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position,t.viewPosition)])&&e.revealPrimaryCursor(t.source,!0,this._minimalReveal)}}e.MoveTo=registerEditorCommand(new t({id:"_moveTo",minimalReveal:!0,inSelectionMode:!1,precondition:void 0})),e.MoveToSelect=registerEditorCommand(new t({id:"_moveToSelect",minimalReveal:!1,inSelectionMode:!0,precondition:void 0}));class i extends CoreEditorCommand{runCoreEditorCommand(e,t){e.model.pushStackElement();const i=this._getColumnSelectResult(e,e.getPrimaryCursorState(),e.getCursorColumnSelectData(),t);e.setCursorStates(t.source,3,i.viewStates.map((e=>CursorState$1.fromViewState(e)))),e.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:i.fromLineNumber,fromViewVisualColumn:i.fromVisualColumn,toViewLineNumber:i.toLineNumber,toViewVisualColumn:i.toVisualColumn}),i.reversed?e.revealTopMostCursor(t.source):e.revealBottomMostCursor(t.source)}}e.ColumnSelect=registerEditorCommand(new class extends i{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(e,t,i,n){const o=e.model.validatePosition(n.position),r=e.coordinatesConverter.validateViewPosition(new Position$1(n.viewPosition.lineNumber,n.viewPosition.column),o),s=n.doColumnSelect?i.fromViewLineNumber:r.lineNumber,a=n.doColumnSelect?i.fromViewVisualColumn:n.mouseColumn-1;return ColumnSelection.columnSelect(e.cursorConfig,e,s,a,r.lineNumber,n.mouseColumn-1)}}),e.CursorColumnSelectLeft=registerEditorCommand(new class extends i{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(e,t,i,n){return ColumnSelection.columnSelectLeft(e.cursorConfig,e,i)}}),e.CursorColumnSelectRight=registerEditorCommand(new class extends i{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(e,t,i,n){return ColumnSelection.columnSelectRight(e.cursorConfig,e,i)}});class n extends i{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,i,n){return ColumnSelection.columnSelectUp(e.cursorConfig,e,i,this._isPaged)}}e.CursorColumnSelectUp=registerEditorCommand(new n({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3600,linux:{primary:0}}})),e.CursorColumnSelectPageUp=registerEditorCommand(new n({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3595,linux:{primary:0}}}));class o extends i{constructor(e){super(e),this._isPaged=e.isPaged}_getColumnSelectResult(e,t,i,n){return ColumnSelection.columnSelectDown(e.cursorConfig,e,i,this._isPaged)}}e.CursorColumnSelectDown=registerEditorCommand(new o({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3602,linux:{primary:0}}})),e.CursorColumnSelectPageDown=registerEditorCommand(new o({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3596,linux:{primary:0}}}));class r extends CoreEditorCommand{constructor(){super({id:"cursorMove",precondition:void 0,description:CursorMove.description})}runCoreEditorCommand(e,t){const i=CursorMove.parse(t);i&&this._runCursorMove(e,t.source,i)}_runCursorMove(e,t,i){e.model.pushStackElement(),e.setCursorStates(t,3,r._move(e,e.getCursorStates(),i)),e.revealPrimaryCursor(t,!0)}static _move(e,t,i){const n=i.select,o=i.value;switch(i.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return CursorMoveCommands.simpleMove(e,t,i.direction,n,o,i.unit);case 11:case 13:case 12:case 14:return CursorMoveCommands.viewportMove(e,t,i.direction,n,o);default:return null}}}e.CursorMoveImpl=r,e.CursorMove=registerEditorCommand(new r);class s extends CoreEditorCommand{constructor(e){super(e),this._staticArgs=e.args}runCoreEditorCommand(e,t){let i=this._staticArgs;-1===this._staticArgs.value&&(i={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:t.pageSize||e.cursorConfig.pageSize}),e.model.pushStackElement(),e.setCursorStates(t.source,3,CursorMoveCommands.simpleMove(e,e.getCursorStates(),i.direction,i.select,i.value,i.unit)),e.revealPrimaryCursor(t.source,!0)}}e.CursorLeft=registerEditorCommand(new s({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),e.CursorLeftSelect=registerEditorCommand(new s({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1039}})),e.CursorRight=registerEditorCommand(new s({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),e.CursorRightSelect=registerEditorCommand(new s({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1041}})),e.CursorUp=registerEditorCommand(new s({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),e.CursorUpSelect=registerEditorCommand(new s({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),e.CursorPageUp=registerEditorCommand(new s({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:11}})),e.CursorPageUpSelect=registerEditorCommand(new s({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1035}})),e.CursorDown=registerEditorCommand(new s({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),e.CursorDownSelect=registerEditorCommand(new s({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),e.CursorPageDown=registerEditorCommand(new s({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:12}})),e.CursorPageDownSelect=registerEditorCommand(new s({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1036}})),e.CreateCursor=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(e,t){let i;i=t.wholeLine?CursorMoveCommands.line(e,e.getPrimaryCursorState(),!1,t.position,t.viewPosition):CursorMoveCommands.moveTo(e,e.getPrimaryCursorState(),!1,t.position,t.viewPosition);const n=e.getCursorStates();if(n.length>1){const o=i.modelState?i.modelState.position:null,r=i.viewState?i.viewState.position:null;for(let i=0,s=n.length;i<s;i++){const s=n[i];if((!o||s.modelState.selection.containsPosition(o))&&(!r||s.viewState.selection.containsPosition(r)))return n.splice(i,1),e.model.pushStackElement(),void e.setCursorStates(t.source,3,n)}}n.push(i),e.model.pushStackElement(),e.setCursorStates(t.source,3,n)}}),e.LastCursorMoveToSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(e,t){const i=e.getLastAddedCursorIndex(),n=e.getCursorStates(),o=n.slice(0);o[i]=CursorMoveCommands.moveTo(e,n[i],!0,t.position,t.viewPosition),e.model.pushStackElement(),e.setCursorStates(t.source,3,o)}});class a extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,CursorMoveCommands.moveToBeginningOfLine(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorHome=registerEditorCommand(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),e.CursorHomeSelect=registerEditorCommand(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,this._exec(e.getCursorStates())),e.revealPrimaryCursor(t.source,!0)}_exec(e){const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i],o=n.modelState.position.lineNumber;t[i]=CursorState$1.fromModelState(n.modelState.move(this._inSelectionMode,o,1,0))}return t}}e.CursorLineStart=registerEditorCommand(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:287}}})),e.CursorLineStartSelect=registerEditorCommand(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1311}}}));class d extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,CursorMoveCommands.moveToEndOfLine(e,e.getCursorStates(),this._inSelectionMode,t.sticky||!1)),e.revealPrimaryCursor(t.source,!0)}}e.CursorEnd=registerEditorCommand(new d({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},description:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),e.CursorEndSelect=registerEditorCommand(new d({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},description:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:localize("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class c extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,this._exec(e,e.getCursorStates())),e.revealPrimaryCursor(t.source,!0)}_exec(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const o=t[n],r=o.modelState.position.lineNumber,s=e.model.getLineMaxColumn(r);i[n]=CursorState$1.fromModelState(o.modelState.move(this._inSelectionMode,r,s,0))}return i}}e.CursorLineEnd=registerEditorCommand(new c({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:291}}})),e.CursorLineEndSelect=registerEditorCommand(new c({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,CursorMoveCommands.moveToBeginningOfBuffer(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorTop=registerEditorCommand(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2062,mac:{primary:2064}}})),e.CursorTopSelect=registerEditorCommand(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3086,mac:{primary:3088}}}));class u extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,CursorMoveCommands.moveToEndOfBuffer(e,e.getCursorStates(),this._inSelectionMode)),e.revealPrimaryCursor(t.source,!0)}}e.CursorBottom=registerEditorCommand(new u({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2061,mac:{primary:2066}}})),e.CursorBottomSelect=registerEditorCommand(new u({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:3085,mac:{primary:3090}}}));class g extends CoreEditorCommand{constructor(){super({id:"editorScroll",precondition:void 0,description:EditorScroll_.description})}runCoreEditorCommand(e,t){const i=EditorScroll_.parse(t);i&&this._runEditorScroll(e,t.source,i)}_runEditorScroll(e,t,i){const n=this._computeDesiredScrollTop(e,i);if(i.revealCursor){const o=e.getCompletelyVisibleViewRangeAtScrollTop(n);e.setCursorStates(t,3,[CursorMoveCommands.findPositionInViewportIfOutside(e,e.getPrimaryCursorState(),o,i.select)])}e.viewLayout.setScrollPosition({scrollTop:n},0)}_computeDesiredScrollTop(e,t){if(1===t.unit){const i=e.getCompletelyVisibleViewRange(),n=e.coordinatesConverter.convertViewRangeToModelRange(i);let o;o=1===t.direction?Math.max(1,n.startLineNumber-t.value):Math.min(e.model.getLineCount(),n.startLineNumber+t.value);const r=e.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(o,1));return e.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber)}let i;i=3===t.unit?e.cursorConfig.pageSize*t.value:4===t.unit?Math.round(e.cursorConfig.pageSize/2)*t.value:t.value;const n=(1===t.direction?-1:1)*i;return e.viewLayout.getCurrentScrollTop()+n*e.cursorConfig.lineHeight}}e.EditorScrollImpl=g,e.EditorScroll=registerEditorCommand(new g),e.ScrollLineUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(t,i){e.EditorScroll._runEditorScroll(t,i.source,{direction:1,unit:2,value:1,revealCursor:!1,select:!1})}}),e.ScrollPageUp=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(t,i){e.EditorScroll._runEditorScroll(t,i.source,{direction:1,unit:3,value:1,revealCursor:!1,select:!1})}}),e.ScrollLineDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(t,i){e.EditorScroll._runEditorScroll(t,i.source,{direction:2,unit:2,value:1,revealCursor:!1,select:!1})}}),e.ScrollPageDown=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(t,i){e.EditorScroll._runEditorScroll(t,i.source,{direction:2,unit:3,value:1,revealCursor:!1,select:!1})}});class p extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[CursorMoveCommands.word(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position)]),e.revealPrimaryCursor(t.source,!0)}}e.WordSelect=registerEditorCommand(new p({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),e.WordSelectDrag=registerEditorCommand(new p({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),e.LastCursorWordSelect=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(e,t){const i=e.getLastAddedCursorIndex(),n=e.getCursorStates(),o=n.slice(0),r=n[i];o[i]=CursorMoveCommands.word(e,r,r.modelState.hasSelection(),t.position),e.model.pushStackElement(),e.setCursorStates(t.source,3,o)}});class m extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[CursorMoveCommands.line(e,e.getPrimaryCursorState(),this._inSelectionMode,t.position,t.viewPosition)]),e.revealPrimaryCursor(t.source,!1)}}e.LineSelect=registerEditorCommand(new m({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),e.LineSelectDrag=registerEditorCommand(new m({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class f extends CoreEditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode}runCoreEditorCommand(e,t){const i=e.getLastAddedCursorIndex(),n=e.getCursorStates(),o=n.slice(0);o[i]=CursorMoveCommands.line(e,n[i],this._inSelectionMode,t.position,t.viewPosition),e.model.pushStackElement(),e.setCursorStates(t.source,3,o)}}e.LastCursorLineSelect=registerEditorCommand(new f({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),e.LastCursorLineSelectDrag=registerEditorCommand(new f({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),e.CancelSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"cancelSelection",precondition:EditorContextKeys.hasNonEmptySelection,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[CursorMoveCommands.cancelSelection(e,e.getPrimaryCursorState())]),e.revealPrimaryCursor(t.source,!0)}}),e.RemoveSecondaryCursors=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"removeSecondaryCursors",precondition:EditorContextKeys.hasMultipleSelections,kbOpts:{weight:CORE_WEIGHT+1,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[e.getPrimaryCursorState()]),e.revealPrimaryCursor(t.source,!0),status(localize("removedCursor","Removed secondary cursors"))}}),e.RevealLine=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"revealLine",precondition:void 0,description:RevealLine_.description})}runCoreEditorCommand(e,t){const i=t,n=i.lineNumber||0;let o="number"==typeof n?n+1:parseInt(n)+1;o<1&&(o=1);const r=e.model.getLineCount();o>r&&(o=r);const s=new Range$2(o,1,o,e.model.getLineMaxColumn(o));let a=0;if(i.at)switch(i.at){case RevealLine_.RawAtArgument.Top:a=3;break;case RevealLine_.RawAtArgument.Center:a=1;break;case RevealLine_.RawAtArgument.Bottom:a=4}const l=e.coordinatesConverter.convertModelRangeToViewRange(s);e.revealRange(t.source,!1,l,a,0)}}),e.SelectAll=new class extends EditorOrNativeTextInputCommand{constructor(){super(SelectAllCommand)}runDOMCommand(){isFirefox&&(document.activeElement.focus(),document.activeElement.select()),document.execCommand("selectAll")}runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i)}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates("keyboard",3,[CursorMoveCommands.selectAll(e,e.getPrimaryCursorState())])}},e.SetSelection=registerEditorCommand(new class extends CoreEditorCommand{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(e,t){e.model.pushStackElement(),e.setCursorStates(t.source,3,[CursorState$1.fromModelSelection(t.selection)])}})}(CoreNavigationCommands||(CoreNavigationCommands={}));const columnSelectionCondition=ContextKeyExpr.and(EditorContextKeys.textInputFocus,EditorContextKeys.columnSelection);function registerColumnSelection(e,t){KeybindingsRegistry.registerKeybindingRule({id:e,primary:t,when:columnSelectionCondition,weight:CORE_WEIGHT+1})}function registerCommand$2(e){return e.register(),e}var CoreEditingCommands;registerColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id,1039),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id,1041),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id,1040),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id,1035),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id,1042),registerColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id,1036),function(e){class t extends EditorCommand{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditingCommand(t,n,i||{})}}e.CoreEditingCommand=t,e.LineBreakInsert=registerEditorCommand(new class extends t{constructor(){super({id:"lineBreakInsert",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(e,t,i){e.pushUndoStop(),e.executeCommands(this.id,TypeOperations.lineBreakInsert(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection))))}}),e.Outdent=registerEditorCommand(new class extends t{constructor(){super({id:"outdent",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(e,t,i){e.pushUndoStop(),e.executeCommands(this.id,TypeOperations.outdent(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)))),e.pushUndoStop()}}),e.Tab=registerEditorCommand(new class extends t{constructor(){super({id:"tab",precondition:EditorContextKeys.writable,kbOpts:{weight:CORE_WEIGHT,kbExpr:ContextKeyExpr.and(EditorContextKeys.editorTextFocus,EditorContextKeys.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(e,t,i){e.pushUndoStop(),e.executeCommands(this.id,TypeOperations.tab(t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)))),e.pushUndoStop()}}),e.DeleteLeft=registerEditorCommand(new class extends t{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(e,t,i){const[n,o]=DeleteOperations.deleteLeft(t.getPrevEditOperationType(),t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)),t.getCursorAutoClosedCharacters());n&&e.pushUndoStop(),e.executeCommands(this.id,o),t.setPrevEditOperationType(2)}}),e.DeleteRight=registerEditorCommand(new class extends t{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:CORE_WEIGHT,kbExpr:EditorContextKeys.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(e,t,i){const[n,o]=DeleteOperations.deleteRight(t.getPrevEditOperationType(),t.cursorConfig,t.model,t.getCursorStates().map((e=>e.modelState.selection)));n&&e.pushUndoStop(),e.executeCommands(this.id,o),t.setPrevEditOperationType(3)}}),e.Undo=new class extends EditorOrNativeTextInputCommand{constructor(){super(UndoCommand)}runDOMCommand(){document.execCommand("undo")}runEditorCommand(e,t,i){if(t.hasModel()&&!0!==t.getOption(81))return t.getModel().undo()}},e.Redo=new class extends EditorOrNativeTextInputCommand{constructor(){super(RedoCommand)}runDOMCommand(){document.execCommand("redo")}runEditorCommand(e,t,i){if(t.hasModel()&&!0!==t.getOption(81))return t.getModel().redo()}}}(CoreEditingCommands||(CoreEditingCommands={}));class EditorHandlerCommand extends Command$1{constructor(e,t,i){super({id:e,precondition:void 0,description:i}),this._handlerId=t}runCommand(e,t){const i=e.get(ICodeEditorService).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function registerOverwritableCommand(e,t){registerCommand$2(new EditorHandlerCommand("default:"+e,e)),registerCommand$2(new EditorHandlerCommand(e,e,t))}registerOverwritableCommand("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]}),registerOverwritableCommand("replacePreviousChar"),registerOverwritableCommand("compositionType"),registerOverwritableCommand("compositionStart"),registerOverwritableCommand("compositionEnd"),registerOverwritableCommand("paste"),registerOverwritableCommand("cut");const IMarkerDecorationsService=createDecorator("markerDecorationsService");var __decorate$1z=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1t=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let MarkerDecorationsContribution=class{constructor(e,t){}dispose(){}};MarkerDecorationsContribution.ID="editor.contrib.markerDecorations",MarkerDecorationsContribution=__decorate$1z([__param$1t(1,IMarkerDecorationsService)],MarkerDecorationsContribution),registerEditorContribution(MarkerDecorationsContribution.ID,MarkerDecorationsContribution);var editor$1="";function deepClone(e){if(!e||"object"!=typeof e)return e;if(e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.keys(e).forEach((i=>{e[i]&&"object"==typeof e[i]?t[i]=deepClone(e[i]):t[i]=e[i]})),t}function deepFreeze(e){if(!e||"object"!=typeof e)return e;const t=[e];for(;t.length>0;){const e=t.shift();Object.freeze(e);for(const i in e)if(_hasOwnProperty.call(e,i)){const n=e[i];"object"!=typeof n||Object.isFrozen(n)||t.push(n)}}return e}const _hasOwnProperty=Object.prototype.hasOwnProperty;function cloneAndChange(e,t){return _cloneAndChange(e,t,new Set)}function _cloneAndChange(e,t,i){if(isUndefinedOrNull(e))return e;const n=t(e);if(void 0!==n)return n;if(isArray(e)){const n=[];for(const o of e)n.push(_cloneAndChange(o,t,i));return n}if(isObject(e)){if(i.has(e))throw new Error("Cannot clone recursive data-structure");i.add(e);const n={};for(let o in e)_hasOwnProperty.call(e,o)&&(n[o]=_cloneAndChange(e[o],t,i));return i.delete(e),n}return e}function mixin(e,t,i=!0){return isObject(e)?(isObject(t)&&Object.keys(t).forEach((n=>{n in e?i&&(isObject(e[n])&&isObject(t[n])?mixin(e[n],t[n],i):e[n]=t[n]):e[n]=t[n]})),e):t}function equals(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;if(Array.isArray(e)!==Array.isArray(t))return!1;let i,n;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!equals(e[i],t[i]))return!1}else{const o=[];for(n in e)o.push(n);o.sort();const r=[];for(n in t)r.push(n);if(r.sort(),!equals(o,r))return!1;for(i=0;i<o.length;i++)if(!equals(e[o[i]],t[o[i]]))return!1}return!0}function getOrDefault(e,t,i){const n=t(e);return void 0===n?i:n}class ElementSizeObserver extends Disposable{constructor(e,t){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){!this._resizeObserver&&this._referenceDomElement&&(this._resizeObserver=new ResizeObserver((e=>{e&&e[0]&&e[0].contentRect?this.observe({width:e[0].contentRect.width,height:e[0].contentRect.height}):this.observe()})),this._resizeObserver.observe(this._referenceDomElement))}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),this._width===i&&this._height===n||(this._width=i,this._height=n,e&&this._onDidChange.fire())}}class FastDomNode{constructor(e){this.domNode=e,this._maxWidth=-1,this._width=-1,this._height=-1,this._top=-1,this._left=-1,this._bottom=-1,this._right=-1,this._fontFamily="",this._fontWeight="",this._fontSize=-1,this._fontStyle="",this._fontFeatureSettings="",this._textDecoration="",this._lineHeight=-1,this._letterSpacing=-100,this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.domNode.style.maxWidth=this._maxWidth+"px")}setWidth(e){this._width!==e&&(this._width=e,this.domNode.style.width=this._width+"px")}setHeight(e){this._height!==e&&(this._height=e,this.domNode.style.height=this._height+"px")}setTop(e){this._top!==e&&(this._top=e,this.domNode.style.top=this._top+"px")}unsetTop(){-1!==this._top&&(this._top=-1,this.domNode.style.top="")}setLeft(e){this._left!==e&&(this._left=e,this.domNode.style.left=this._left+"px")}setBottom(e){this._bottom!==e&&(this._bottom=e,this.domNode.style.bottom=this._bottom+"px")}setRight(e){this._right!==e&&(this._right=e,this.domNode.style.right=this._right+"px")}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){this._fontSize!==e&&(this._fontSize=e,this.domNode.style.fontSize=this._fontSize+"px")}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.domNode.style.lineHeight=this._lineHeight+"px")}setLetterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.domNode.style.letterSpacing=this._letterSpacing+"px")}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function createFastDomNode(e){return new FastDomNode(e)}const EDITOR_MODEL_DEFAULTS={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!1}},MINIMAP_GUTTER_WIDTH=8;class ConfigurationChangedEvent{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class ComputeOptionsMemory{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class BaseEditorOption{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return applyUpdate(e,t)}compute(e,t,i){return i}}class ApplyUpdateResult{constructor(e,t){this.newValue=e,this.didChange=t}}function applyUpdate(e,t){if("object"!=typeof e||"object"!=typeof t||!e||!t)return new ApplyUpdateResult(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){const i=Array.isArray(e)&&Array.isArray(t)&&equals$1(e,t);return new ApplyUpdateResult(t,i)}let i=!1;for(const n in t)if(t.hasOwnProperty(n)){const o=applyUpdate(e[n],t[n]);o.didChange&&(e[n]=o.newValue,i=!0)}return new ApplyUpdateResult(e,i)}class ComputedEditorOption{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return applyUpdate(e,t)}validate(e){return this.defaultValue}}class SimpleEditorOption{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return applyUpdate(e,t)}validate(e){return void 0===e?this.defaultValue:e}compute(e,t,i){return i}}function boolean(e,t){return void 0===e?t:"false"!==e&&Boolean(e)}class EditorBooleanOption extends SimpleEditorOption{constructor(e,t,i,n){void 0!==n&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return boolean(e,this.defaultValue)}}function clampedInt(e,t,i,n){if(void 0===e)return t;let o=parseInt(e,10);return isNaN(o)?t:(o=Math.max(i,o),o=Math.min(n,o),0|o)}class EditorIntOption extends SimpleEditorOption{constructor(e,t,i,n,o,r){void 0!==r&&(r.type="integer",r.default=i,r.minimum=n,r.maximum=o),super(e,t,i,r),this.minimum=n,this.maximum=o}static clampedInt(e,t,i,n){return clampedInt(e,t,i,n)}validate(e){return EditorIntOption.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class EditorFloatOption extends SimpleEditorOption{constructor(e,t,i,n,o){void 0!==o&&(o.type="number",o.default=i),super(e,t,i,o),this.validationFn=n}static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if("number"==typeof e)return e;if(void 0===e)return t;const i=parseFloat(e);return isNaN(i)?t:i}validate(e){return this.validationFn(EditorFloatOption.float(e,this.defaultValue))}}class EditorStringOption extends SimpleEditorOption{static string(e,t){return"string"!=typeof e?t:e}constructor(e,t,i,n){void 0!==n&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return EditorStringOption.string(e,this.defaultValue)}}function stringSet(e,t,i){return"string"!=typeof e||-1===i.indexOf(e)?t:e}class EditorStringEnumOption extends SimpleEditorOption{constructor(e,t,i,n,o){void 0!==o&&(o.type="string",o.enum=n,o.default=i),super(e,t,i,o),this._allowedValues=n}validate(e){return stringSet(e,this.defaultValue,this._allowedValues)}}class EditorEnumOption extends BaseEditorOption{constructor(e,t,i,n,o,r,s){void 0!==s&&(s.type="string",s.enum=o,s.default=n),super(e,t,i,s),this._allowedValues=o,this._convert=r}validate(e){return"string"!=typeof e||-1===this._allowedValues.indexOf(e)?this.defaultValue:this._convert(e)}}function _autoIndentFromString(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class EditorAccessibilitySupport extends BaseEditorOption{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[localize("accessibilitySupport.auto","The editor will use platform APIs to detect when a Screen Reader is attached."),localize("accessibilitySupport.on","The editor will be permanently optimized for usage with a Screen Reader. Word wrapping will be disabled."),localize("accessibilitySupport.off","The editor will never be optimized for usage with a Screen Reader.")],default:"auto",description:localize("accessibilitySupport","Controls whether the editor should run in a mode where it is optimized for screen readers. Setting to on will disable word wrapping.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return 0===i?e.accessibilitySupport:i}}class EditorComments extends BaseEditorOption{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(19,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:localize("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:localize("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{insertSpace:boolean(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:boolean(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function _cursorBlinkingStyleFromString(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var TextEditorCursorStyle$1,TextEditorCursorStyle2;function _cursorStyleFromString(e){switch(e){case"line":return TextEditorCursorStyle$1.Line;case"block":return TextEditorCursorStyle$1.Block;case"underline":return TextEditorCursorStyle$1.Underline;case"line-thin":return TextEditorCursorStyle$1.LineThin;case"block-outline":return TextEditorCursorStyle$1.BlockOutline;case"underline-thin":return TextEditorCursorStyle$1.UnderlineThin}}TextEditorCursorStyle2=TextEditorCursorStyle$1||(TextEditorCursorStyle$1={}),TextEditorCursorStyle2[TextEditorCursorStyle2.Line=1]="Line",TextEditorCursorStyle2[TextEditorCursorStyle2.Block=2]="Block",TextEditorCursorStyle2[TextEditorCursorStyle2.Underline=3]="Underline",TextEditorCursorStyle2[TextEditorCursorStyle2.LineThin=4]="LineThin",TextEditorCursorStyle2[TextEditorCursorStyle2.BlockOutline=5]="BlockOutline",TextEditorCursorStyle2[TextEditorCursorStyle2.UnderlineThin=6]="UnderlineThin";class EditorClassName extends ComputedEditorOption{constructor(){super(128)}compute(e,t,i){const n=["monaco-editor"];return t.get(33)&&n.push(t.get(33)),e.extraEditorClassName&&n.push(e.extraEditorClassName),"default"===t.get(66)?n.push("mouse-default"):"copy"===t.get(66)&&n.push("mouse-copy"),t.get(100)&&n.push("showUnused"),t.get(126)&&n.push("showDeprecated"),n.join(" ")}}class EditorEmptySelectionClipboard extends EditorBooleanOption{constructor(){super(32,"emptySelectionClipboard",!0,{description:localize("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class EditorFind extends BaseEditorOption{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(35,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:localize("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[localize("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),localize("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),localize("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:localize("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[localize("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),localize("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),localize("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:localize("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:localize("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:isMacintosh},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:localize("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:localize("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{cursorMoveOnType:boolean(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:"boolean"==typeof e.seedSearchStringFromSelection?e.seedSearchStringFromSelection?"always":"never":stringSet(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:"boolean"==typeof e.autoFindInSelection?e.autoFindInSelection?"always":"never":stringSet(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:boolean(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:boolean(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:boolean(t.loop,this.defaultValue.loop)}}}class EditorFontLigatures extends BaseEditorOption{constructor(){super(45,"fontLigatures",EditorFontLigatures.OFF,{anyOf:[{type:"boolean",description:localize("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:localize("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:localize("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return void 0===e?this.defaultValue:"string"==typeof e?"false"===e?EditorFontLigatures.OFF:"true"===e?EditorFontLigatures.ON:e:Boolean(e)?EditorFontLigatures.ON:EditorFontLigatures.OFF}}EditorFontLigatures.OFF='"liga" off, "calt" off',EditorFontLigatures.ON='"liga" on, "calt" on';class EditorFontInfo extends ComputedEditorOption{constructor(){super(44)}compute(e,t,i){return e.fontInfo}}class EditorFontSize extends SimpleEditorOption{constructor(){super(46,"fontSize",EDITOR_FONT_DEFAULTS.fontSize,{type:"number",minimum:6,maximum:100,default:EDITOR_FONT_DEFAULTS.fontSize,description:localize("fontSize","Controls the font size in pixels.")})}validate(e){const t=EditorFloatOption.float(e,this.defaultValue);return 0===t?EDITOR_FONT_DEFAULTS.fontSize:EditorFloatOption.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}class EditorFontWeight extends BaseEditorOption{constructor(){super(47,"fontWeight",EDITOR_FONT_DEFAULTS.fontWeight,{anyOf:[{type:"number",minimum:EditorFontWeight.MINIMUM_VALUE,maximum:EditorFontWeight.MAXIMUM_VALUE,errorMessage:localize("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:EditorFontWeight.SUGGESTION_VALUES}],default:EDITOR_FONT_DEFAULTS.fontWeight,description:localize("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return"normal"===e||"bold"===e?e:String(EditorIntOption.clampedInt(e,EDITOR_FONT_DEFAULTS.fontWeight,EditorFontWeight.MINIMUM_VALUE,EditorFontWeight.MAXIMUM_VALUE))}}EditorFontWeight.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],EditorFontWeight.MINIMUM_VALUE=1,EditorFontWeight.MAXIMUM_VALUE=1e3;class EditorGoToLocation extends BaseEditorOption{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[localize("editor.gotoLocation.multiple.peek","Show peek view of the results (default)"),localize("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a peek view"),localize("editor.gotoLocation.multiple.goto","Go to the primary result and enable peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(51,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:localize("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":Object.assign({description:localize("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleTypeDefinitions":Object.assign({description:localize("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleDeclarations":Object.assign({description:localize("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleImplementations":Object.assign({description:localize("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.")},t),"editor.gotoLocation.multipleReferences":Object.assign({description:localize("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist.")},t),"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:localize("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:localize("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:localize("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:localize("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:localize("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){var t,i,n,o,r;if(!e||"object"!=typeof e)return this.defaultValue;const s=e;return{multiple:stringSet(s.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:null!==(t=s.multipleDefinitions)&&void 0!==t?t:stringSet(s.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:null!==(i=s.multipleTypeDefinitions)&&void 0!==i?i:stringSet(s.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:null!==(n=s.multipleDeclarations)&&void 0!==n?n:stringSet(s.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:null!==(o=s.multipleImplementations)&&void 0!==o?o:stringSet(s.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:null!==(r=s.multipleReferences)&&void 0!==r?r:stringSet(s.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:EditorStringOption.string(s.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:EditorStringOption.string(s.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:EditorStringOption.string(s.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:EditorStringOption.string(s.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:EditorStringOption.string(s.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand)}}}class EditorHover extends BaseEditorOption{constructor(){const e={enabled:!0,delay:300,sticky:!0,above:!0};super(53,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:localize("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:localize("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:localize("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.above":{type:"boolean",default:e.above,description:localize("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:boolean(t.enabled,this.defaultValue.enabled),delay:EditorIntOption.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:boolean(t.sticky,this.defaultValue.sticky),above:boolean(t.above,this.defaultValue.above)}}}class EditorLayoutInfoComputer extends ComputedEditorOption{constructor(){super(131)}compute(e,t,i){return EditorLayoutInfoComputer.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=e.scrollBeyondLastLine?t-1:0,n=(e.viewLineCount+i)/(e.pixelRatio*e.height);return{typicalViewportLineCount:t,extraLinesBeyondLastLine:i,desiredRatio:n,minimapLineCount:Math.floor(e.viewLineCount/n)}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,o=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(o*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const r=t.stableMinimapLayoutInput,s=r&&e.outerHeight===r.outerHeight&&e.lineHeight===r.lineHeight&&e.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&e.pixelRatio===r.pixelRatio&&e.scrollBeyondLastLine===r.scrollBeyondLastLine&&e.minimap.enabled===r.minimap.enabled&&e.minimap.side===r.minimap.side&&e.minimap.size===r.minimap.size&&e.minimap.showSlider===r.minimap.showSlider&&e.minimap.renderCharacters===r.minimap.renderCharacters&&e.minimap.maxColumn===r.minimap.maxColumn&&e.minimap.scale===r.minimap.scale&&e.verticalScrollbarWidth===r.verticalScrollbarWidth&&e.isViewportWrapping===r.isViewportWrapping,a=e.lineHeight,l=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,c=e.minimap.renderCharacters;let h=o>=2?Math.round(2*e.minimap.scale):e.minimap.scale;const u=e.minimap.maxColumn,g=e.minimap.size,p=e.minimap.side,m=e.verticalScrollbarWidth,f=e.viewLineCount,_=e.remainingWidth,C=e.isViewportWrapping,v=c?2:3;let b=Math.floor(o*n);const S=b/o;let y=!1,w=!1,E=v*h,L=h/o,x=1;if("fill"===g||"fit"===g){const{typicalViewportLineCount:i,extraLinesBeyondLastLine:r,desiredRatio:l,minimapLineCount:c}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:f,scrollBeyondLastLine:d,height:n,lineHeight:a,pixelRatio:o});if(f/c>1)y=!0,w=!0,h=1,E=1,L=h/o;else{let n=!1,d=h+1;if("fit"===g){const e=Math.ceil((f+r)*E);C&&s&&_<=t.stableFitRemainingWidth?(n=!0,d=t.stableFitMaxMinimapScale):n=e>b}if("fill"===g||n){y=!0;const n=h;E=Math.min(a*o,Math.max(1,Math.floor(1/l))),C&&s&&_<=t.stableFitRemainingWidth&&(d=t.stableFitMaxMinimapScale),h=Math.min(d,Math.max(1,Math.floor(E/v))),h>n&&(x=Math.min(2,h/n)),L=h/o/x,b=Math.ceil(Math.max(i,f+r)*E),C?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=_,t.stableFitMaxMinimapScale=h):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const D=Math.floor(u*L),I=Math.min(D,Math.max(0,Math.floor((_-m-2)*L/(l+L)))+MINIMAP_GUTTER_WIDTH);let k=Math.floor(o*I);const T=k/o;k=Math.floor(k*x);return{renderMinimap:c?1:2,minimapLeft:"left"===p?0:i-I-m,minimapWidth:I,minimapHeightIsEditorHeight:y,minimapIsSampling:w,minimapScale:h,minimapLineHeight:E,minimapCanvasInnerWidth:k,minimapCanvasInnerHeight:b,minimapCanvasOuterWidth:T,minimapCanvasOuterHeight:S}}static computeLayout(e,t){const i=0|t.outerWidth,n=0|t.outerHeight,o=0|t.lineHeight,r=0|t.lineNumbersDigitCount,s=t.typicalHalfwidthCharacterWidth,a=t.maxDigitWidth,l=t.pixelRatio,d=t.viewLineCount,c=e.get(123),h="inherit"===c?e.get(122):c,u="inherit"===h?e.get(118):h,g=e.get(121),p=e.get(2),m=t.isDominatedByLongLines,f=e.get(50),_=0!==e.get(60).renderType,C=e.get(61),v=e.get(94),b=e.get(65),S=e.get(92),y=S.verticalScrollbarSize,w=S.verticalHasArrows,E=S.arrowSize,L=S.horizontalScrollbarSize,x=e.get(58),D=e.get(37);let I;if("string"==typeof x&&/^\d+(\.\d+)?ch$/.test(x)){const e=parseFloat(x.substr(0,x.length-2));I=EditorIntOption.clampedInt(e*s,0,0,1e3)}else I=EditorIntOption.clampedInt(x,0,0,1e3);D&&(I+=16);let k=0;if(_){const e=Math.max(r,C);k=Math.round(e*a)}let T=0;f&&(T=o);let N=0,M=N+T,R=M+k,A=R+I;const O=i-T-k-I;let P=!1,F=!1,B=-1;2!==p&&("inherit"===h&&m?(P=!0,F=!0):"on"===u||"bounded"===u?F=!0:"wordWrapColumn"===u&&(B=g));const $=EditorLayoutInfoComputer._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:o,typicalHalfwidthCharacterWidth:s,pixelRatio:l,scrollBeyondLastLine:v,minimap:b,verticalScrollbarWidth:y,viewLineCount:d,remainingWidth:O,isViewportWrapping:F},t.memory||new ComputeOptionsMemory);0!==$.renderMinimap&&0===$.minimapLeft&&(N+=$.minimapWidth,M+=$.minimapWidth,R+=$.minimapWidth,A+=$.minimapWidth);const W=O-$.minimapWidth,V=Math.max(1,Math.floor((W-y-2)/s)),z=w?E:0;return F&&(B=Math.max(1,V),"bounded"===u&&(B=Math.min(B,g))),{width:i,height:n,glyphMarginLeft:N,glyphMarginWidth:T,lineNumbersLeft:M,lineNumbersWidth:k,decorationsLeft:R,decorationsWidth:I,contentLeft:A,contentWidth:W,minimap:$,viewportColumn:V,isWordWrapMinified:P,isViewportWrapping:F,wrappingColumn:B,verticalScrollbarWidth:y,horizontalScrollbarHeight:L,overviewRuler:{top:z,width:y,height:n-2*z,right:0}}}}class EditorLightbulb extends BaseEditorOption{constructor(){const e={enabled:!0};super(57,"lightbulb",e,{"editor.lightbulb.enabled":{type:"boolean",default:e.enabled,description:localize("codeActions","Enables the code action lightbulb in the editor.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;return{enabled:boolean(e.enabled,this.defaultValue.enabled)}}}class EditorInlayHints extends BaseEditorOption{constructor(){const e={enabled:!0,fontSize:0,fontFamily:""};super(127,"inlayHints",e,{"editor.inlayHints.enabled":{type:"boolean",default:e.enabled,description:localize("inlayHints.enable","Enables the inlay hints in the editor.")},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:localize("inlayHints.fontSize","Controls font size of inlay hints in the editor. A default of 90% of `#editor.fontSize#` is used when the configured value is less than `5` or greater than the editor font size.")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:localize("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the `#editor.fontFamily#` is used.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:boolean(t.enabled,this.defaultValue.enabled),fontSize:EditorIntOption.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:EditorStringOption.string(t.fontFamily,this.defaultValue.fontFamily)}}}class EditorLineHeight extends EditorFloatOption{constructor(){super(59,"lineHeight",EDITOR_FONT_DEFAULTS.lineHeight,(e=>EditorFloatOption.clamp(e,0,150)),{markdownDescription:localize("lineHeight","Controls the line height. \n - Use 0 to automatically compute the line height from the font size.\n - Values between 0 and 8 will be used as a multiplier with the font size.\n - Values greater than or equal to 8 will be used as effective values.")})}compute(e,t,i){return e.fontInfo.lineHeight}}class EditorMinimap extends BaseEditorOption{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",renderCharacters:!0,maxColumn:120,scale:1};super(65,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:localize("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[localize("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),localize("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),localize("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:localize("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:localize("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:localize("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:localize("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:localize("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:localize("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:boolean(t.enabled,this.defaultValue.enabled),size:stringSet(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:stringSet(t.side,this.defaultValue.side,["right","left"]),showSlider:stringSet(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:boolean(t.renderCharacters,this.defaultValue.renderCharacters),scale:EditorIntOption.clampedInt(t.scale,1,1,3),maxColumn:EditorIntOption.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4)}}}function _multiCursorModifierFromString(e){return"ctrlCmd"===e?isMacintosh?"metaKey":"ctrlKey":"altKey"}class EditorPadding extends BaseEditorOption{constructor(){super(75,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:localize("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{top:EditorIntOption.clampedInt(t.top,0,0,1e3),bottom:EditorIntOption.clampedInt(t.bottom,0,0,1e3)}}}class EditorParameterHints extends BaseEditorOption{constructor(){const e={enabled:!0,cycle:!1};super(76,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:localize("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:localize("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:boolean(t.enabled,this.defaultValue.enabled),cycle:boolean(t.cycle,this.defaultValue.cycle)}}}class EditorPixelRatio extends ComputedEditorOption{constructor(){super(129)}compute(e,t,i){return e.pixelRatio}}class EditorQuickSuggestions extends BaseEditorOption{constructor(){const e={other:!0,comments:!1,strings:!1};super(79,"quickSuggestions",e,{anyOf:[{type:"boolean"},{type:"object",properties:{strings:{type:"boolean",default:e.strings,description:localize("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{type:"boolean",default:e.comments,description:localize("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{type:"boolean",default:e.other,description:localize("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}}}],default:e,description:localize("quickSuggestions","Controls whether suggestions should automatically show up while typing.")}),this.defaultValue=e}validate(e){if("boolean"==typeof e)return e;if(e&&"object"==typeof e){const t=e,i={other:boolean(t.other,this.defaultValue.other),comments:boolean(t.comments,this.defaultValue.comments),strings:boolean(t.strings,this.defaultValue.strings)};return!!(i.other&&i.comments&&i.strings)||!!(i.other||i.comments||i.strings)&&i}return this.defaultValue}}class EditorRenderLineNumbersOption extends BaseEditorOption{constructor(){super(60,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[localize("lineNumbers.off","Line numbers are not rendered."),localize("lineNumbers.on","Line numbers are rendered as absolute number."),localize("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),localize("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:localize("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return void 0!==e&&("function"==typeof e?(t=4,i=e):t="interval"===e?3:"relative"===e?2:"on"===e?1:0),{renderType:t,renderFn:i}}}function filterValidationDecorations(e){const t=e.get(87);return"editable"===t?e.get(81):"on"!==t}class EditorRulers extends BaseEditorOption{constructor(){const e=[],t={type:"number",description:localize("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(91,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:localize("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:localize("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(let i of e)if("number"==typeof i)t.push({column:EditorIntOption.clampedInt(i,0,0,1e4),color:null});else if(i&&"object"==typeof i){const e=i;t.push({column:EditorIntOption.clampedInt(e.column,0,0,1e4),color:e.color})}return t.sort(((e,t)=>e.column-t.column)),t}return this.defaultValue}}function _scrollbarVisibilityFromString(e,t){if("string"!=typeof e)return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}class EditorScrollbar$1 extends BaseEditorOption{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1};super(92,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),localize("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),localize("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[localize("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),localize("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),localize("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:localize("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:localize("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:localize("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:localize("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e,i=EditorIntOption.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=EditorIntOption.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:EditorIntOption.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:_scrollbarVisibilityFromString(t.vertical,this.defaultValue.vertical),horizontal:_scrollbarVisibilityFromString(t.horizontal,this.defaultValue.horizontal),useShadows:boolean(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:boolean(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:boolean(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:boolean(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:boolean(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:EditorIntOption.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:EditorIntOption.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:boolean(t.scrollByPage,this.defaultValue.scrollByPage)}}}const inUntrustedWorkspace="inUntrustedWorkspace",unicodeHighlightConfigKeys={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class UnicodeHighlight extends BaseEditorOption{constructor(){const e={nonBasicASCII:inUntrustedWorkspace,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:inUntrustedWorkspace,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(113,"unicodeHighlight",e,{[unicodeHighlightConfigKeys.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:e.nonBasicASCII,description:localize("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[unicodeHighlightConfigKeys.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:localize("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[unicodeHighlightConfigKeys.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:localize("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[unicodeHighlightConfigKeys.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:e.includeComments,description:localize("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to unicode highlighting.")},[unicodeHighlightConfigKeys.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,inUntrustedWorkspace],default:e.includeStrings,description:localize("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to unicode highlighting.")},[unicodeHighlightConfigKeys.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:localize("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[unicodeHighlightConfigKeys.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:localize("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&(equals(e.allowedCharacters,t.allowedCharacters)||(e=Object.assign(Object.assign({},e),{allowedCharacters:t.allowedCharacters}),i=!0)),t.allowedLocales&&(equals(e.allowedLocales,t.allowedLocales)||(e=Object.assign(Object.assign({},e),{allowedLocales:t.allowedLocales}),i=!0));const n=super.applyUpdate(e,t);return i?new ApplyUpdateResult(n.newValue,!0):n}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{nonBasicASCII:primitiveSet(t.nonBasicASCII,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),invisibleCharacters:boolean(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:boolean(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:primitiveSet(t.includeComments,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),includeStrings:primitiveSet(t.includeStrings,inUntrustedWorkspace,[!0,!1,inUntrustedWorkspace]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if("object"!=typeof e||!e)return t;const i={};for(const[n,o]of Object.entries(e))!0===o&&(i[n]=!0);return i}}class InlineEditorSuggest extends BaseEditorOption{constructor(){const e={enabled:!0,mode:"subwordSmart"};super(55,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:localize("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{enabled:boolean(t.enabled,this.defaultValue.enabled),mode:stringSet(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"])}}}class BracketPairColorization extends BaseEditorOption{constructor(){const e={enabled:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.enabled};super(12,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,description:localize("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use 'workbench.colorCustomizations' to override the bracket highlight colors.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;return{enabled:boolean(e.enabled,this.defaultValue.enabled)}}}class GuideOptions extends BaseEditorOption{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(13,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairs.true","Enables bracket pair guides."),localize("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),localize("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:localize("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[localize("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),localize("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),localize("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:localize("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:localize("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:localize("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:"boolean",default:e.highlightActiveIndentation,description:localize("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{bracketPairs:primitiveSet(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:primitiveSet(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:boolean(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:boolean(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:boolean(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation)}}}function primitiveSet(e,t,i){const n=i.indexOf(e);return-1===n?t:i[n]}class EditorSuggest extends BaseEditorOption{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!0,localityBonus:!1,shareSuggestSelections:!1,showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(106,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[localize("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),localize("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:localize("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:localize("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:localize("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:localize("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:localize("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:localize("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:localize("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:localize("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:localize("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:localize("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:localize("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:localize("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||"object"!=typeof e)return this.defaultValue;const t=e;return{insertMode:stringSet(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:boolean(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:boolean(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:boolean(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:boolean(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),showIcons:boolean(t.showIcons,this.defaultValue.showIcons),showStatusBar:boolean(t.showStatusBar,this.defaultValue.showStatusBar),preview:boolean(t.preview,this.defaultValue.preview),previewMode:stringSet(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:boolean(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:boolean(t.showMethods,this.defaultValue.showMethods),showFunctions:boolean(t.showFunctions,this.defaultValue.showFunctions),showConstructors:boolean(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:boolean(t.showDeprecated,this.defaultValue.showDeprecated),showFields:boolean(t.showFields,this.defaultValue.showFields),showVariables:boolean(t.showVariables,this.defaultValue.showVariables),showClasses:boolean(t.showClasses,this.defaultValue.showClasses),showStructs:boolean(t.showStructs,this.defaultValue.showStructs),showInterfaces:boolean(t.showInterfaces,this.defaultValue.showInterfaces),showModules:boolean(t.showModules,this.defaultValue.showModules),showProperties:boolean(t.showProperties,this.defaultValue.showProperties),showEvents:boolean(t.showEvents,this.defaultValue.showEvents),showOperators:boolean(t.showOperators,this.defaultValue.showOperators),showUnits:boolean(t.showUnits,this.defaultValue.showUnits),showValues:boolean(t.showValues,this.defaultValue.showValues),showConstants:boolean(t.showConstants,this.defaultValue.showConstants),showEnums:boolean(t.showEnums,this.defaultValue.showEnums),showEnumMembers:boolean(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:boolean(t.showKeywords,this.defaultValue.showKeywords),showWords:boolean(t.showWords,this.defaultValue.showWords),showColors:boolean(t.showColors,this.defaultValue.showColors),showFiles:boolean(t.showFiles,this.defaultValue.showFiles),showReferences:boolean(t.showReferences,this.defaultValue.showReferences),showFolders:boolean(t.showFolders,this.defaultValue.showFolders),showTypeParameters:boolean(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:boolean(t.showSnippets,this.defaultValue.showSnippets),showUsers:boolean(t.showUsers,this.defaultValue.showUsers),showIssues:boolean(t.showIssues,this.defaultValue.showIssues)}}}class SmartSelect extends BaseEditorOption{constructor(){super(102,"smartSelect",{selectLeadingAndTrailingWhitespace:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:localize("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"}})}validate(e){return e&&"object"==typeof e?{selectLeadingAndTrailingWhitespace:boolean(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace)}:this.defaultValue}}class EditorTabFocusMode extends ComputedEditorOption{constructor(){super(130)}compute(e,t,i){return!!t.get(81)||e.tabFocusMode}}function _wrappingIndentFromString(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}}class EditorWrappingInfoComputer extends ComputedEditorOption{constructor(){super(132)}compute(e,t,i){const n=t.get(131);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}const DEFAULT_WINDOWS_FONT_FAMILY="Consolas, 'Courier New', monospace",DEFAULT_MAC_FONT_FAMILY="Menlo, Monaco, 'Courier New', monospace",DEFAULT_LINUX_FONT_FAMILY="'Droid Sans Mono', 'monospace', monospace",EDITOR_FONT_DEFAULTS={fontFamily:isMacintosh?DEFAULT_MAC_FONT_FAMILY:isLinux?DEFAULT_LINUX_FONT_FAMILY:DEFAULT_WINDOWS_FONT_FAMILY,fontWeight:"normal",fontSize:isMacintosh?12:14,lineHeight:0,letterSpacing:0},editorOptionsRegistry=[];function register$1(e){return editorOptionsRegistry[e.id]=e,e}const EditorOptions={acceptSuggestionOnCommitCharacter:register$1(new EditorBooleanOption(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:localize("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:register$1(new EditorStringEnumOption(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",localize("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:localize("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:register$1(new EditorAccessibilitySupport),accessibilityPageSize:register$1(new EditorIntOption(3,"accessibilityPageSize",10,1,1073741824,{description:localize("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default.")})),ariaLabel:register$1(new EditorStringOption(4,"ariaLabel",localize("editorViewAccessibleLabel","Editor content"))),autoClosingBrackets:register$1(new EditorStringEnumOption(5,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),localize("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:localize("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingDelete:register$1(new EditorStringEnumOption(6,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:register$1(new EditorStringEnumOption(7,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",localize("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:localize("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:register$1(new EditorStringEnumOption(8,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",localize("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),localize("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:localize("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:register$1(new EditorEnumOption(9,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],_autoIndentFromString,{enumDescriptions:[localize("editor.autoIndent.none","The editor will not insert indentation automatically."),localize("editor.autoIndent.keep","The editor will keep the current line's indentation."),localize("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),localize("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),localize("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:localize("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:register$1(new EditorBooleanOption(10,"automaticLayout",!1)),autoSurround:register$1(new EditorStringEnumOption(11,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[localize("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),localize("editor.autoSurround.quotes","Surround with quotes but not brackets."),localize("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:localize("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:register$1(new BracketPairColorization),bracketPairGuides:register$1(new GuideOptions),stickyTabStops:register$1(new EditorBooleanOption(104,"stickyTabStops",!1,{description:localize("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:register$1(new EditorBooleanOption(14,"codeLens",!0,{description:localize("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:register$1(new EditorStringOption(15,"codeLensFontFamily","",{description:localize("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:register$1(new EditorIntOption(16,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:localize("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to `0`, 90% of `#editor.fontSize#` is used.")})),colorDecorators:register$1(new EditorBooleanOption(17,"colorDecorators",!0,{description:localize("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),columnSelection:register$1(new EditorBooleanOption(18,"columnSelection",!1,{description:localize("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:register$1(new EditorComments),contextmenu:register$1(new EditorBooleanOption(20,"contextmenu",!0)),copyWithSyntaxHighlighting:register$1(new EditorBooleanOption(21,"copyWithSyntaxHighlighting",!0,{description:localize("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:register$1(new EditorEnumOption(22,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],_cursorBlinkingStyleFromString,{description:localize("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:register$1(new EditorBooleanOption(23,"cursorSmoothCaretAnimation",!1,{description:localize("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:register$1(new EditorEnumOption(24,"cursorStyle",TextEditorCursorStyle$1.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],_cursorStyleFromString,{description:localize("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:register$1(new EditorIntOption(25,"cursorSurroundingLines",0,0,1073741824,{description:localize("cursorSurroundingLines","Controls the minimal number of visible leading and trailing lines surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:register$1(new EditorStringEnumOption(26,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[localize("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),localize("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],description:localize("cursorSurroundingLinesStyle","Controls when `cursorSurroundingLines` should be enforced.")})),cursorWidth:register$1(new EditorIntOption(27,"cursorWidth",0,0,1073741824,{markdownDescription:localize("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:register$1(new EditorBooleanOption(28,"disableLayerHinting",!1)),disableMonospaceOptimizations:register$1(new EditorBooleanOption(29,"disableMonospaceOptimizations",!1)),domReadOnly:register$1(new EditorBooleanOption(30,"domReadOnly",!1)),dragAndDrop:register$1(new EditorBooleanOption(31,"dragAndDrop",!0,{description:localize("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:register$1(new EditorEmptySelectionClipboard),extraEditorClassName:register$1(new EditorStringOption(33,"extraEditorClassName","")),fastScrollSensitivity:register$1(new EditorFloatOption(34,"fastScrollSensitivity",5,(e=>e<=0?5:e),{markdownDescription:localize("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:register$1(new EditorFind),fixedOverflowWidgets:register$1(new EditorBooleanOption(36,"fixedOverflowWidgets",!1)),folding:register$1(new EditorBooleanOption(37,"folding",!0,{description:localize("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:register$1(new EditorStringEnumOption(38,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[localize("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),localize("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:localize("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:register$1(new EditorBooleanOption(39,"foldingHighlight",!0,{description:localize("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:register$1(new EditorBooleanOption(40,"foldingImportsByDefault",!1,{description:localize("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:register$1(new EditorIntOption(41,"foldingMaximumRegions",5e3,10,65e3,{description:localize("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:register$1(new EditorBooleanOption(42,"unfoldOnClickAfterEndOfLine",!1,{description:localize("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:register$1(new EditorStringOption(43,"fontFamily",EDITOR_FONT_DEFAULTS.fontFamily,{description:localize("fontFamily","Controls the font family.")})),fontInfo:register$1(new EditorFontInfo),fontLigatures2:register$1(new EditorFontLigatures),fontSize:register$1(new EditorFontSize),fontWeight:register$1(new EditorFontWeight),formatOnPaste:register$1(new EditorBooleanOption(48,"formatOnPaste",!1,{description:localize("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:register$1(new EditorBooleanOption(49,"formatOnType",!1,{description:localize("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:register$1(new EditorBooleanOption(50,"glyphMargin",!0,{description:localize("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:register$1(new EditorGoToLocation),hideCursorInOverviewRuler:register$1(new EditorBooleanOption(52,"hideCursorInOverviewRuler",!1,{description:localize("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:register$1(new EditorHover),inDiffEditor:register$1(new EditorBooleanOption(54,"inDiffEditor",!1)),letterSpacing:register$1(new EditorFloatOption(56,"letterSpacing",EDITOR_FONT_DEFAULTS.letterSpacing,(e=>EditorFloatOption.clamp(e,-5,20)),{description:localize("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:register$1(new EditorLightbulb),lineDecorationsWidth:register$1(new SimpleEditorOption(58,"lineDecorationsWidth",10)),lineHeight:register$1(new EditorLineHeight),lineNumbers:register$1(new EditorRenderLineNumbersOption),lineNumbersMinChars:register$1(new EditorIntOption(61,"lineNumbersMinChars",5,1,300)),linkedEditing:register$1(new EditorBooleanOption(62,"linkedEditing",!1,{description:localize("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols, e.g. HTML tags, are updated while editing.")})),links:register$1(new EditorBooleanOption(63,"links",!0,{description:localize("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:register$1(new EditorStringEnumOption(64,"matchBrackets","always",["always","near","never"],{description:localize("matchBrackets","Highlight matching brackets.")})),minimap:register$1(new EditorMinimap),mouseStyle:register$1(new EditorStringEnumOption(66,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:register$1(new EditorFloatOption(67,"mouseWheelScrollSensitivity",1,(e=>0===e?1:e),{markdownDescription:localize("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:register$1(new EditorBooleanOption(68,"mouseWheelZoom",!1,{markdownDescription:localize("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:register$1(new EditorBooleanOption(69,"multiCursorMergeOverlapping",!0,{description:localize("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:register$1(new EditorEnumOption(70,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],_multiCursorModifierFromString,{markdownEnumDescriptions:[localize("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:localize({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the multicursor modifier. [Read more](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:register$1(new EditorStringEnumOption(71,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[localize("multiCursorPaste.spread","Each cursor pastes a single line of the text."),localize("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:localize("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),occurrencesHighlight:register$1(new EditorBooleanOption(72,"occurrencesHighlight",!0,{description:localize("occurrencesHighlight","Controls whether the editor should highlight semantic symbol occurrences.")})),overviewRulerBorder:register$1(new EditorBooleanOption(73,"overviewRulerBorder",!0,{description:localize("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:register$1(new EditorIntOption(74,"overviewRulerLanes",3,0,3)),padding:register$1(new EditorPadding),parameterHints:register$1(new EditorParameterHints),peekWidgetDefaultFocus:register$1(new EditorStringEnumOption(77,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[localize("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),localize("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:localize("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),definitionLinkOpensInPeek:register$1(new EditorBooleanOption(78,"definitionLinkOpensInPeek",!1,{description:localize("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:register$1(new EditorQuickSuggestions),quickSuggestionsDelay:register$1(new EditorIntOption(80,"quickSuggestionsDelay",10,0,1073741824,{description:localize("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:register$1(new EditorBooleanOption(81,"readOnly",!1)),renameOnType:register$1(new EditorBooleanOption(82,"renameOnType",!1,{description:localize("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:localize("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:register$1(new EditorBooleanOption(83,"renderControlCharacters",!0,{description:localize("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:register$1(new EditorBooleanOption(84,"renderFinalNewline",!0,{description:localize("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:register$1(new EditorStringEnumOption(85,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",localize("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:localize("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:register$1(new EditorBooleanOption(86,"renderLineHighlightOnlyWhenFocus",!1,{description:localize("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:register$1(new EditorStringEnumOption(87,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:register$1(new EditorStringEnumOption(88,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",localize("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),localize("renderWhitespace.selection","Render whitespace characters only on selected text."),localize("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:localize("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:register$1(new EditorIntOption(89,"revealHorizontalRightPadding",30,0,1e3)),roundedSelection:register$1(new EditorBooleanOption(90,"roundedSelection",!0,{description:localize("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:register$1(new EditorRulers),scrollbar:register$1(new EditorScrollbar$1),scrollBeyondLastColumn:register$1(new EditorIntOption(93,"scrollBeyondLastColumn",5,0,1073741824,{description:localize("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:register$1(new EditorBooleanOption(94,"scrollBeyondLastLine",!0,{description:localize("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:register$1(new EditorBooleanOption(95,"scrollPredominantAxis",!0,{description:localize("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:register$1(new EditorBooleanOption(96,"selectionClipboard",!0,{description:localize("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:isLinux})),selectionHighlight:register$1(new EditorBooleanOption(97,"selectionHighlight",!0,{description:localize("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:register$1(new EditorBooleanOption(98,"selectOnLineNumbers",!0)),showFoldingControls:register$1(new EditorStringEnumOption(99,"showFoldingControls","mouseover",["always","mouseover"],{enumDescriptions:[localize("showFoldingControls.always","Always show the folding controls."),localize("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:localize("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:register$1(new EditorBooleanOption(100,"showUnused",!0,{description:localize("showUnused","Controls fading out of unused code.")})),showDeprecated:register$1(new EditorBooleanOption(126,"showDeprecated",!0,{description:localize("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:register$1(new EditorInlayHints),snippetSuggestions:register$1(new EditorStringEnumOption(101,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[localize("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),localize("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),localize("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),localize("snippetSuggestions.none","Do not show snippet suggestions.")],description:localize("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:register$1(new SmartSelect),smoothScrolling:register$1(new EditorBooleanOption(103,"smoothScrolling",!1,{description:localize("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:register$1(new EditorIntOption(105,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:register$1(new EditorSuggest),inlineSuggest:register$1(new InlineEditorSuggest),suggestFontSize:register$1(new EditorIntOption(107,"suggestFontSize",0,0,1e3,{markdownDescription:localize("suggestFontSize","Font size for the suggest widget. When set to `0`, the value of `#editor.fontSize#` is used.")})),suggestLineHeight:register$1(new EditorIntOption(108,"suggestLineHeight",0,0,1e3,{markdownDescription:localize("suggestLineHeight","Line height for the suggest widget. When set to `0`, the value of `#editor.lineHeight#` is used. The minimum value is 8.")})),suggestOnTriggerCharacters:register$1(new EditorBooleanOption(109,"suggestOnTriggerCharacters",!0,{description:localize("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:register$1(new EditorStringEnumOption(110,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[localize("suggestSelection.first","Always select the first suggestion."),localize("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),localize("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:localize("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:register$1(new EditorStringEnumOption(111,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[localize("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),localize("tabCompletion.off","Disable tab completions."),localize("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:localize("tabCompletion","Enables tab completions.")})),tabIndex:register$1(new EditorIntOption(112,"tabIndex",0,-1,1073741824)),unicodeHighlight:register$1(new UnicodeHighlight),unusualLineTerminators:register$1(new EditorStringEnumOption(114,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[localize("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),localize("unusualLineTerminators.off","Unusual line terminators are ignored."),localize("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:localize("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:register$1(new EditorBooleanOption(115,"useShadowDOM",!0)),useTabStops:register$1(new EditorBooleanOption(116,"useTabStops",!0,{description:localize("useTabStops","Inserting and deleting whitespace follows tab stops.")})),wordSeparators:register$1(new EditorStringOption(117,"wordSeparators",USUAL_WORD_SEPARATORS,{description:localize("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:register$1(new EditorStringEnumOption(118,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),localize({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:localize({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:register$1(new EditorStringOption(119,"wordWrapBreakAfterCharacters"," \t})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:register$1(new EditorStringOption(120,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:register$1(new EditorIntOption(121,"wordWrapColumn",80,1,1073741824,{markdownDescription:localize({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:register$1(new EditorStringEnumOption(122,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:register$1(new EditorStringEnumOption(123,"wordWrapOverride2","inherit",["off","on","inherit"])),wrappingIndent:register$1(new EditorEnumOption(124,"wrappingIndent",1,"same",["none","same","indent","deepIndent"],_wrappingIndentFromString,{enumDescriptions:[localize("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),localize("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),localize("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),localize("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:localize("wrappingIndent","Controls the indentation of wrapped lines.")})),wrappingStrategy:register$1(new EditorStringEnumOption(125,"wrappingStrategy","simple",["simple","advanced"],{enumDescriptions:[localize("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),localize("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],description:localize("wrappingStrategy","Controls the algorithm that computes wrapping points.")})),editorClassName:register$1(new EditorClassName),pixelRatio:register$1(new EditorPixelRatio),tabFocusMode:register$1(new EditorTabFocusMode),layoutInfo:register$1(new EditorLayoutInfoComputer),wrappingInfo:register$1(new EditorWrappingInfoComputer)};function applyFontInfo(e,t){e instanceof FastDomNode?(e.setFontFamily(t.getMassagedFontFamily(isSafari?EDITOR_FONT_DEFAULTS.fontFamily:null)),e.setFontWeight(t.fontWeight),e.setFontSize(t.fontSize),e.setFontFeatureSettings(t.fontFeatureSettings),e.setLineHeight(t.lineHeight),e.setLetterSpacing(t.letterSpacing)):(e.style.fontFamily=t.getMassagedFontFamily(isSafari?EDITOR_FONT_DEFAULTS.fontFamily:null),e.style.fontWeight=t.fontWeight,e.style.fontSize=t.fontSize+"px",e.style.fontFeatureSettings=t.fontFeatureSettings,e.style.lineHeight=t.lineHeight+"px",e.style.letterSpacing=t.letterSpacing+"px")}class CharWidthRequest{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class DomCharWidthReader{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(){this._createDomElements(),document.body.appendChild(this._container),this._readFromDomElements(),document.body.removeChild(this._container),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");applyFontInfo(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");applyFontInfo(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");applyFontInfo(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const o=[];for(const r of this._requests){let e;0===r.type&&(e=t),2===r.type&&(e=i),1===r.type&&(e=n),e.appendChild(document.createElement("br"));const s=document.createElement("span");DomCharWidthReader._render(s,r),e.appendChild(s),o.push(s)}this._container=e,this._testElements=o}static _render(e,t){if(" "===t.chr){let t=" ";for(let e=0;e<8;e++)t+=t;e.innerText=t}else{let i=t.chr;for(let e=0;e<8;e++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const t=this._requests[e],i=this._testElements[e];t.fulfill(i.offsetWidth/256)}}}function readCharWidths(e,t){new DomCharWidthReader(e,t).read()}const EditorZoom=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new Emitter$1,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(e){e=Math.min(Math.max(-5,e),20),this._zoomLevel!==e&&(this._zoomLevel=e,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},GOLDEN_LINE_HEIGHT_RATIO=isMacintosh?1.5:1.35,MINIMUM_LINE_HEIGHT=8;class BareFontInfo{constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.lineHeight=0|e.lineHeight,this.letterSpacing=e.letterSpacing}static createFromValidatedSettings(e,t,i){const n=e.get(43),o=e.get(47),r=e.get(46),s=e.get(45),a=e.get(59),l=e.get(56);return BareFontInfo._create(n,o,r,s,a,l,t,i)}static _create(e,t,i,n,o,r,s,a){0===o?o=GOLDEN_LINE_HEIGHT_RATIO*i:o<MINIMUM_LINE_HEIGHT&&(o*=i),(o=Math.round(o))<MINIMUM_LINE_HEIGHT&&(o=MINIMUM_LINE_HEIGHT);const l=1+(a?0:.1*EditorZoom.getZoomLevel());return new BareFontInfo({pixelRatio:s,fontFamily:e,fontWeight:t,fontSize:i*=l,fontFeatureSettings:n,lineHeight:o*=l,letterSpacing:r})}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(e){const t=BareFontInfo._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const SERIALIZED_FONT_INFO_VERSION=1;class FontInfo extends BareFontInfo{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=SERIALIZED_FONT_INFO_VERSION,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class FontMeasurementsImpl extends Disposable{constructor(){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._cache=new FontMeasurementsCache,this._evictUntrustedReadingsTimeout=-1}dispose(){-1!==this._evictUntrustedReadingsTimeout&&(window.clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache=new FontMeasurementsCache,this._onDidChange.fire()}_writeToCache(e,t){this._cache.put(e,t),t.isTrusted||-1!==this._evictUntrustedReadingsTimeout||(this._evictUntrustedReadingsTimeout=window.setTimeout((()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings()}),5e3))}_evictUntrustedReadings(){const e=this._cache.getValues();let t=!1;for(const i of e)i.isTrusted||(t=!0,this._cache.remove(i));t&&this._onDidChange.fire()}readFontInfo(e){if(!this._cache.has(e)){let t=this._actualReadFontInfo(e);(t.typicalHalfwidthCharacterWidth<=2||t.typicalFullwidthCharacterWidth<=2||t.spaceWidth<=2||t.maxDigitWidth<=2)&&(t=new FontInfo({pixelRatio:PixelRatio.value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:t.isMonospace,typicalHalfwidthCharacterWidth:Math.max(t.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(t.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:t.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(t.spaceWidth,5),middotWidth:Math.max(t.middotWidth,5),wsmiddotWidth:Math.max(t.wsmiddotWidth,5),maxDigitWidth:Math.max(t.maxDigitWidth,5)},!1)),this._writeToCache(e,t)}return this._cache.get(e)}_createRequest(e,t,i,n){const o=new CharWidthRequest(e,t);return i.push(o),n&&n.push(o),o}_actualReadFontInfo(e){const t=[],i=[],n=this._createRequest("n",0,t,i),o=this._createRequest("ｍ",0,t,null),r=this._createRequest(" ",0,t,i),s=this._createRequest("0",0,t,i),a=this._createRequest("1",0,t,i),l=this._createRequest("2",0,t,i),d=this._createRequest("3",0,t,i),c=this._createRequest("4",0,t,i),h=this._createRequest("5",0,t,i),u=this._createRequest("6",0,t,i),g=this._createRequest("7",0,t,i),p=this._createRequest("8",0,t,i),m=this._createRequest("9",0,t,i),f=this._createRequest("→",0,t,i),_=this._createRequest("￫",0,t,null),C=this._createRequest("·",0,t,i),v=this._createRequest(String.fromCharCode(11825),0,t,null),b="|/-_ilm%";for(let L=0,x=b.length;L<x;L++)this._createRequest(b.charAt(L),0,t,i),this._createRequest(b.charAt(L),1,t,i),this._createRequest(b.charAt(L),2,t,i);readCharWidths(e,t);const S=Math.max(s.width,a.width,l.width,d.width,c.width,h.width,u.width,g.width,p.width,m.width);let y=e.fontFeatureSettings===EditorFontLigatures.OFF;const w=i[0].width;for(let L=1,x=i.length;y&&L<x;L++){const e=w-i[L].width;if(e<-.001||e>.001){y=!1;break}}let E=!0;return y&&_.width!==w&&(E=!1),_.width>f.width&&(E=!1),new FontInfo({pixelRatio:PixelRatio.value,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontSize:e.fontSize,fontFeatureSettings:e.fontFeatureSettings,lineHeight:e.lineHeight,letterSpacing:e.letterSpacing,isMonospace:y,typicalHalfwidthCharacterWidth:n.width,typicalFullwidthCharacterWidth:o.width,canUseHalfwidthRightwardsArrow:E,spaceWidth:r.width,middotWidth:C.width,wsmiddotWidth:v.width,maxDigitWidth:S},!0)}}class FontMeasurementsCache{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map((e=>this._values[e]))}}const FontMeasurements=new FontMeasurementsImpl,hasOwnProperty$2=Object.prototype.hasOwnProperty;function forEach(e,t){for(let i in e)if(hasOwnProperty$2.call(e,i)){if(!1===t({key:i,value:e[i]},(function(){delete e[i]})))return}}class SetMap{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),0===i.size&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}}function migrateOptions(e){const t=e.wordWrap;!0===t?e.wordWrap="on":!1===t&&(e.wordWrap="off");const i=e.lineNumbers;!0===i?e.lineNumbers="on":!1===i&&(e.lineNumbers="off");!1===e.autoClosingBrackets&&(e.autoClosingBrackets="never",e.autoClosingQuotes="never",e.autoSurround="never");"visible"===e.cursorBlinking&&(e.cursorBlinking="solid");const n=e.renderWhitespace;!0===n?e.renderWhitespace="boundary":!1===n&&(e.renderWhitespace="none");const o=e.renderLineHighlight;!0===o?e.renderLineHighlight="line":!1===o&&(e.renderLineHighlight="none");const r=e.acceptSuggestionOnEnter;!0===r?e.acceptSuggestionOnEnter="on":!1===r&&(e.acceptSuggestionOnEnter="off");const s=e.tabCompletion;!1===s?e.tabCompletion="off":!0===s&&(e.tabCompletion="onlySnippets");const a=e.suggest;if(a&&"object"==typeof a.filteredTypes&&a.filteredTypes){const e={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};forEach(e,(e=>{const t=a.filteredTypes[e.key];!1===t&&(a[e.value]=t)}))}const l=e.hover;!0===l?e.hover={enabled:!0}:!1===l&&(e.hover={enabled:!1});const d=e.parameterHints;!0===d?e.parameterHints={enabled:!0}:!1===d&&(e.parameterHints={enabled:!1});const c=e.autoIndent;!0===c?e.autoIndent="full":!1===c&&(e.autoIndent="advanced");const h=e.matchBrackets;!0===h?e.matchBrackets="always":!1===h&&(e.matchBrackets="never");const{renderIndentGuides:u,highlightActiveIndentGuide:g}=e;e.guides||(e.guides={}),void 0!==u&&(e.guides.indentation=!!u),void 0!==g&&(e.guides.highlightActiveIndentation=!!g)}class TabFocusImpl{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new Emitter$1,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus!==e&&(this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus))}}const TabFocus=new TabFocusImpl,IAccessibilityService=createDecorator("accessibilityService"),CONTEXT_ACCESSIBILITY_MODE_ENABLED=new RawContextKey("accessibilityModeEnabled",!1);var __decorate$1y=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1s=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let EditorConfiguration=class extends Disposable{constructor(e,t,i,n){super(),this._accessibilityService=n,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new Emitter$1),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._computeOptionsMemory=new ComputeOptionsMemory,this.isSimpleWidget=e,this._containerObserver=this._register(new ElementSizeObserver(i,t.dimension)),this._rawOptions=deepCloneAndMigrateOptions(t),this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(10)&&this._containerObserver.startObserving(),this._register(EditorZoom.onDidChangeZoomLevel((()=>this._recomputeOptions()))),this._register(TabFocus.onDidChangeTabFocus((()=>this._recomputeOptions()))),this._register(this._containerObserver.onDidChange((()=>this._recomputeOptions()))),this._register(FontMeasurements.onDidChange((()=>this._recomputeOptions()))),this._register(PixelRatio.onDidChange((()=>this._recomputeOptions()))),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized((()=>this._recomputeOptions())))}_recomputeOptions(){const e=this._computeOptions(),t=EditorOptionsUtil.checkEquals(this.options,e);null!==t&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=BareFontInfo.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:TabFocus.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport};return EditorOptionsUtil.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:getExtraEditorClassName(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:isWebKit||isFirefox,pixelRatio:PixelRatio.value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return FontMeasurements.readFontInfo(e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=deepCloneAndMigrateOptions(e);EditorOptionsUtil.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=EditorOptionsUtil.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=digitCount(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}};function digitCount(e){let t=0;for(;e;)e=Math.floor(e/10),t++;return t||1}function getExtraEditorClassName(){let e="";return isSafari||isWebkitWebView||(e+="no-user-select "),isSafari&&(e+="no-minimap-shadow "),isMacintosh&&(e+="mac "),e}EditorConfiguration=__decorate$1y([__param$1s(3,IAccessibilityService)],EditorConfiguration);class ValidatedEditorOptions{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class ComputedEditorOptions{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class EditorOptionsUtil{static validateOptions(e){const t=new ValidatedEditorOptions;for(const i of editorOptionsRegistry){const n="_never_"===i.name?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new ComputedEditorOptions;for(const n of editorOptionsRegistry)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if("object"!=typeof e||"object"!=typeof t||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return!(!Array.isArray(e)||!Array.isArray(t))&&equals$1(e,t);if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!EditorOptionsUtil._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const o of editorOptionsRegistry){const r=!EditorOptionsUtil._deepEquals(e._read(o.id),t._read(o.id));i[o.id]=r,r&&(n=!0)}return n?new ConfigurationChangedEvent(i):null}static applyUpdate(e,t){let i=!1;for(const n of editorOptionsRegistry)if(t.hasOwnProperty(n.name)){const o=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=o.newValue,i=i||o.didChange}return i}}function deepCloneAndMigrateOptions(e){const t=deepClone(e);return migrateOptions(t),t}function memoize(e,t,i){let n=null,o=null;if("function"==typeof i.value?(n="value",o=i.value,o.length):"function"==typeof i.get&&(n="get",o=i.get),!o)throw new Error("not supported");const r=`$memoize$${t}`;i[n]=function(...e){return this.hasOwnProperty(r)||Object.defineProperty(this,r,{configurable:!1,enumerable:!1,writable:!1,value:o.apply(this,e)}),this[r]}}var __decorate$1x=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},EventType,EventType2,Color2,Format;EventType2=EventType||(EventType={}),EventType2.Tap="-monaco-gesturetap",EventType2.Change="-monaco-gesturechange",EventType2.Start="-monaco-gesturestart",EventType2.End="-monaco-gesturesend",EventType2.Contextmenu="-monaco-gesturecontextmenu";class Gesture extends Disposable{constructor(){super(),this.dispatched=!1,this.activeTouches={},this.handle=null,this.targets=[],this.ignoreTargets=[],this._lastSetTapCountTime=0,this._register(addDisposableListener(document,"touchstart",(e=>this.onTouchStart(e)),{passive:!1})),this._register(addDisposableListener(document,"touchend",(e=>this.onTouchEnd(e)))),this._register(addDisposableListener(document,"touchmove",(e=>this.onTouchMove(e)),{passive:!1}))}static addTarget(e){return Gesture.isTouchDevice()?(Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture),Gesture.INSTANCE.targets.push(e),{dispose:()=>{Gesture.INSTANCE.targets=Gesture.INSTANCE.targets.filter((t=>t!==e))}}):Disposable.None}static ignoreTarget(e){return Gesture.isTouchDevice()?(Gesture.INSTANCE||(Gesture.INSTANCE=new Gesture),Gesture.INSTANCE.ignoreTargets.push(e),{dispose:()=>{Gesture.INSTANCE.ignoreTargets=Gesture.INSTANCE.ignoreTargets.filter((t=>t!==e))}}):Disposable.None}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){let t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){let n=e.targetTouches.item(i);this.activeTouches[n.identifier]={id:n.identifier,initialTarget:n.target,initialTimeStamp:t,initialPageX:n.pageX,initialPageY:n.pageY,rollingTimestamps:[t],rollingPageX:[n.pageX],rollingPageY:[n.pageY]};let o=this.newGestureEvent(EventType.Start,n.target);o.pageX=n.pageX,o.pageY=n.pageY,this.dispatchEvent(o)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e){let t=Date.now(),i=Object.keys(this.activeTouches).length;for(let n=0,o=e.changedTouches.length;n<o;n++){let o=e.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(o.identifier)))continue;let r=this.activeTouches[o.identifier],s=Date.now()-r.initialTimeStamp;if(s<Gesture.HOLD_DELAY&&Math.abs(r.initialPageX-tail(r.rollingPageX))<30&&Math.abs(r.initialPageY-tail(r.rollingPageY))<30){let e=this.newGestureEvent(EventType.Tap,r.initialTarget);e.pageX=tail(r.rollingPageX),e.pageY=tail(r.rollingPageY),this.dispatchEvent(e)}else if(s>=Gesture.HOLD_DELAY&&Math.abs(r.initialPageX-tail(r.rollingPageX))<30&&Math.abs(r.initialPageY-tail(r.rollingPageY))<30){let e=this.newGestureEvent(EventType.Contextmenu,r.initialTarget);e.pageX=tail(r.rollingPageX),e.pageY=tail(r.rollingPageY),this.dispatchEvent(e)}else if(1===i){let e=tail(r.rollingPageX),i=tail(r.rollingPageY),n=tail(r.rollingTimestamps)-r.rollingTimestamps[0],o=e-r.rollingPageX[0],s=i-r.rollingPageY[0];const a=this.targets.filter((e=>r.initialTarget instanceof Node&&e.contains(r.initialTarget)));this.inertia(a,t,Math.abs(o)/n,o>0?1:-1,e,Math.abs(s)/n,s>0?1:-1,i)}this.dispatchEvent(this.newGestureEvent(EventType.End,r.initialTarget)),delete this.activeTouches[o.identifier]}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){let i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===EventType.Tap){const t=(new Date).getTime();let i=0;i=t-this._lastSetTapCountTime>Gesture.CLEAR_TAP_COUNT_TIME?1:2,this._lastSetTapCountTime=t,e.tapCount=i}else e.type!==EventType.Change&&e.type!==EventType.Contextmenu||(this._lastSetTapCountTime=0);for(let t=0;t<this.ignoreTargets.length;t++)if(e.initialTarget instanceof Node&&this.ignoreTargets[t].contains(e.initialTarget))return;this.targets.forEach((t=>{e.initialTarget instanceof Node&&t.contains(e.initialTarget)&&(t.dispatchEvent(e),this.dispatched=!0)}))}inertia(e,t,i,n,o,r,s,a){this.handle=scheduleAtNextAnimationFrame((()=>{let l=Date.now(),d=l-t,c=0,h=0,u=!0;i+=Gesture.SCROLL_FRICTION*d,r+=Gesture.SCROLL_FRICTION*d,i>0&&(u=!1,c=n*i*d),r>0&&(u=!1,h=s*r*d);let g=this.newGestureEvent(EventType.Change);g.translationX=c,g.translationY=h,e.forEach((e=>e.dispatchEvent(g))),u||this.inertia(e,l,i,n,o+c,r,s,a+h)}))}onTouchMove(e){let t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){let n=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(n.identifier)))continue;let o=this.activeTouches[n.identifier],r=this.newGestureEvent(EventType.Change,o.initialTarget);r.translationX=n.pageX-tail(o.rollingPageX),r.translationY=n.pageY-tail(o.rollingPageY),r.pageX=n.pageX,r.pageY=n.pageY,this.dispatchEvent(r),o.rollingPageX.length>3&&(o.rollingPageX.shift(),o.rollingPageY.shift(),o.rollingTimestamps.shift()),o.rollingPageX.push(n.pageX),o.rollingPageY.push(n.pageY),o.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}}function standardMouseMoveMerger(e,t){let i=new StandardMouseEvent(t);return i.preventDefault(),{leftButton:i.leftButton,buttons:i.buttons,posx:i.posx,posy:i.posy}}Gesture.SCROLL_FRICTION=-.005,Gesture.HOLD_DELAY=700,Gesture.CLEAR_TAP_COUNT_TIME=400,__decorate$1x([memoize],Gesture,"isTouchDevice",null);class GlobalMouseMoveMonitor{constructor(){this._hooks=new DisposableStore,this._mouseMoveEventMerger=null,this._mouseMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._mouseMoveEventMerger=null,this._mouseMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._mouseMoveEventMerger}startMonitoring(e,t,i,n,o){if(this.isMonitoring())return;this._mouseMoveEventMerger=i,this._mouseMoveCallback=n,this._onStopCallback=o;const r=IframeUtils.getSameOriginWindowChain(),s=isIOS?"pointermove":"mousemove",a=r.map((e=>e.window.document)),l=getShadowRoot(e);l&&a.unshift(l);for(const d of a)this._hooks.add(addDisposableThrottledListener(d,s,(e=>{e.buttons===t?this._mouseMoveCallback(e):this.stopMonitoring(!0)}),((e,t)=>this._mouseMoveEventMerger(e,t)))),this._hooks.add(addDisposableListener(d,"mouseup",(e=>this.stopMonitoring(!0))));if(IframeUtils.hasDifferentOriginAncestor()){let e=r[r.length-1];this._hooks.add(addDisposableListener(e.window.document,"mouseout",(e=>{"html"===new StandardMouseEvent(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(addDisposableListener(e.window.document,"mouseover",(e=>{"html"===new StandardMouseEvent(e).target.tagName.toLowerCase()&&this.stopMonitoring(!0)}))),this._hooks.add(addDisposableListener(e.window.document.body,"mouseleave",(e=>{this.stopMonitoring(!0)})))}}}function roundFloat(e,t){const i=Math.pow(10,t);return Math.round(e*i)/i}class RGBA{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=0|Math.min(255,Math.max(0,e)),this.g=0|Math.min(255,Math.max(0,t)),this.b=0|Math.min(255,Math.max(0,i)),this.a=roundFloat(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class HSLA{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=roundFloat(Math.max(Math.min(1,t),0),3),this.l=roundFloat(Math.max(Math.min(1,i),0),3),this.a=roundFloat(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=e.a,r=Math.max(t,i,n),s=Math.min(t,i,n);let a=0,l=0;const d=(s+r)/2,c=r-s;if(c>0){switch(l=Math.min(d<=.5?c/(2*d):c/(2-2*d),1),r){case t:a=(i-n)/c+(i<n?6:0);break;case i:a=(n-t)/c+2;break;case n:a=(t-i)/c+4}a*=60,a=Math.round(a)}return new HSLA(a,l,d,o)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:o}=e;let r,s,a;if(0===i)r=s=a=n;else{const e=n<.5?n*(1+i):n+i-n*i,o=2*n-e;r=HSLA._hue2rgb(o,e,t+1/3),s=HSLA._hue2rgb(o,e,t),a=HSLA._hue2rgb(o,e,t-1/3)}return new RGBA(Math.round(255*r),Math.round(255*s),Math.round(255*a),o)}}class HSVA{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=0|Math.max(Math.min(360,e),0),this.s=roundFloat(Math.max(Math.min(1,t),0),3),this.v=roundFloat(Math.max(Math.min(1,i),0),3),this.a=roundFloat(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,o=Math.max(t,i,n),r=o-Math.min(t,i,n),s=0===o?0:r/o;let a;return a=0===r?0:o===t?((i-n)/r%6+6)%6:o===i?(n-t)/r+2:(t-i)/r+4,new HSVA(Math.round(60*a),s,o,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:o}=e,r=n*i,s=r*(1-Math.abs(t/60%2-1)),a=n-r;let[l,d,c]=[0,0,0];return t<60?(l=r,d=s):t<120?(l=s,d=r):t<180?(d=r,c=s):t<240?(d=s,c=r):t<300?(l=s,c=r):t<=360&&(l=r,c=s),l=Math.round(255*(l+a)),d=Math.round(255*(d+a)),c=Math.round(255*(c+a)),new RGBA(l,d,c,o)}}class Color{constructor(e){if(!e)throw new Error("Color needs a value");if(e instanceof RGBA)this.rgba=e;else if(e instanceof HSLA)this._hsla=e,this.rgba=HSLA.toRGBA(e);else{if(!(e instanceof HSVA))throw new Error("Invalid color ctor argument");this._hsva=e,this.rgba=HSVA.toRGBA(e)}}static fromHex(e){return Color.Format.CSS.parseHex(e)||Color.red}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}equals(e){return!!e&&RGBA.equals(this.rgba,e.rgba)&&HSLA.equals(this.hsla,e.hsla)&&HSVA.equals(this.hsva,e.hsva)}getRelativeLuminance(){return roundFloat(.2126*Color._relativeLuminanceForComponent(this.rgba.r)+.7152*Color._relativeLuminanceForComponent(this.rgba.g)+.0722*Color._relativeLuminanceForComponent(this.rgba.b),4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(299*this.rgba.r+587*this.rgba.g+114*this.rgba.b)/1e3>=128}isLighterThan(e){return this.getRelativeLuminance()>e.getRelativeLuminance()}isDarkerThan(e){return this.getRelativeLuminance()<e.getRelativeLuminance()}lighten(e){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new Color(new HSLA(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:o}=this.rgba;return new Color(new RGBA(t,i,n,o*e))}isTransparent(){return 0===this.rgba.a}isOpaque(){return 1===this.rgba.a}opposite(){return new Color(new RGBA(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}toString(){return this._toString||(this._toString=Color.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),o=t.getRelativeLuminance();return i=i*(o-n)/o,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance();return i=i*(n-t.getRelativeLuminance())/n,e.darken(i)}}Color.white=new Color(new RGBA(255,255,255,1)),Color.black=new Color(new RGBA(0,0,0,1)),Color.red=new Color(new RGBA(255,0,0,1)),Color.blue=new Color(new RGBA(0,0,255,1)),Color.green=new Color(new RGBA(0,255,0,1)),Color.cyan=new Color(new RGBA(0,255,255,1)),Color.lightgrey=new Color(new RGBA(211,211,211,1)),Color.transparent=new Color(new RGBA(0,0,0,0)),Color2=Color||(Color={}),function(e){function t(e){const t=e.toString(16);return 2!==t.length?"0"+t:t}function i(e){switch(e){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:case 65:return 10;case 98:case 66:return 11;case 99:case 67:return 12;case 100:case 68:return 13;case 101:case 69:return 14;case 102:case 70:return 15}return 0}e.formatRGB=function(e){return 1===e.rgba.a?`rgb(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b})`:Color2.Format.CSS.formatRGBA(e)},e.formatRGBA=function(e){return`rgba(${e.rgba.r}, ${e.rgba.g}, ${e.rgba.b}, ${+e.rgba.a.toFixed(2)})`},e.formatHSL=function(e){return 1===e.hsla.a?`hsl(${e.hsla.h}, ${(100*e.hsla.s).toFixed(2)}%, ${(100*e.hsla.l).toFixed(2)}%)`:Color2.Format.CSS.formatHSLA(e)},e.formatHSLA=function(e){return`hsla(${e.hsla.h}, ${(100*e.hsla.s).toFixed(2)}%, ${(100*e.hsla.l).toFixed(2)}%, ${e.hsla.a.toFixed(2)})`},e.formatHex=function(e){return`#${t(e.rgba.r)}${t(e.rgba.g)}${t(e.rgba.b)}`},e.formatHexA=function(e,i=!1){return i&&1===e.rgba.a?Color2.Format.CSS.formatHex(e):`#${t(e.rgba.r)}${t(e.rgba.g)}${t(e.rgba.b)}${t(Math.round(255*e.rgba.a))}`},e.format=function(e){return e.isOpaque()?Color2.Format.CSS.formatHex(e):Color2.Format.CSS.formatRGBA(e)},e.parseHex=function(e){const t=e.length;if(0===t)return null;if(35!==e.charCodeAt(0))return null;if(7===t){const t=16*i(e.charCodeAt(1))+i(e.charCodeAt(2)),n=16*i(e.charCodeAt(3))+i(e.charCodeAt(4)),o=16*i(e.charCodeAt(5))+i(e.charCodeAt(6));return new Color2(new RGBA(t,n,o,1))}if(9===t){const t=16*i(e.charCodeAt(1))+i(e.charCodeAt(2)),n=16*i(e.charCodeAt(3))+i(e.charCodeAt(4)),o=16*i(e.charCodeAt(5))+i(e.charCodeAt(6)),r=16*i(e.charCodeAt(7))+i(e.charCodeAt(8));return new Color2(new RGBA(t,n,o,r/255))}if(4===t){const t=i(e.charCodeAt(1)),n=i(e.charCodeAt(2)),o=i(e.charCodeAt(3));return new Color2(new RGBA(16*t+t,16*n+n,16*o+o))}if(5===t){const t=i(e.charCodeAt(1)),n=i(e.charCodeAt(2)),o=i(e.charCodeAt(3)),r=i(e.charCodeAt(4));return new Color2(new RGBA(16*t+t,16*n+n,16*o+o,(16*r+r)/255))}return null}}((Format=Color2.Format||(Color2.Format={})).CSS||(Format.CSS={}));const Extensions$5={JSONContribution:"base.contributions.json"};function normalizeId(e){return e.length>0&&"#"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}class JSONContributionRegistry{constructor(){this._onDidChangeSchema=new Emitter$1,this.schemasById={}}registerSchema(e,t){this.schemasById[normalizeId(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const jsonContributionRegistry=new JSONContributionRegistry;function asCssVariableName(e){return`--vscode-${e.replace(/\./g,"-")}`}Registry.add(Extensions$5.JSONContribution,jsonContributionRegistry);const Extensions$4={ColorContribution:"base.contributions.colors"};class ColorRegistry{constructor(){this._onDidChangeSchema=new Emitter$1,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,o){let r={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:o};this.colorsById[e]=r;let s={type:"string",description:i,format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return o&&(s.deprecationMessage=o),this.colorSchema.properties[e]=s,this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map((e=>this.colorsById[e]))}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i&&i.defaults){return resolveColorValue(i.defaults[t.type],t)}}getColorSchema(){return this.colorSchema}toString(){return Object.keys(this.colorsById).sort(((e,t)=>{let i=-1===e.indexOf(".")?0:1,n=-1===t.indexOf(".")?0:1;return i!==n?i-n:e.localeCompare(t)})).map((e=>`- \`${e}\`: ${this.colorsById[e].description}`)).join("\n")}}const colorRegistry$1=new ColorRegistry;function registerColor(e,t,i,n,o){return colorRegistry$1.registerColor(e,t,i,n,o)}Registry.add(Extensions$4.ColorContribution,colorRegistry$1);const foreground=registerColor("foreground",{dark:"#CCCCCC",light:"#616161",hc:"#FFFFFF"},localize("foreground","Overall foreground color. This color is only used if not overridden by a component.")),errorForeground=registerColor("errorForeground",{dark:"#F48771",light:"#A1260D",hc:"#F48771"},localize("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));registerColor("descriptionForeground",{light:"#717171",dark:transparent(foreground,.7),hc:transparent(foreground,.7)},localize("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const iconForeground=registerColor("icon.foreground",{dark:"#C5C5C5",light:"#424242",hc:"#FFFFFF"},localize("iconForeground","The default color for icons in the workbench.")),focusBorder=registerColor("focusBorder",{dark:"#007FD4",light:"#0090F1",hc:"#F38518"},localize("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),contrastBorder=registerColor("contrastBorder",{light:null,dark:null,hc:"#6FC3DF"},localize("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),activeContrastBorder=registerColor("contrastActiveBorder",{light:null,dark:null,hc:focusBorder},localize("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));registerColor("selection.background",{light:null,dark:null,hc:null},localize("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor.")),registerColor("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hc:Color.black},localize("textSeparatorForeground","Color for text separators."));const textLinkForeground=registerColor("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},localize("textLinkForeground","Foreground color for links in text.")),textLinkActiveForeground=registerColor("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hc:"#3794FF"},localize("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));registerColor("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hc:"#D7BA7D"},localize("textPreformatForeground","Foreground color for preformatted text segments.")),registerColor("textBlockQuote.background",{light:"#7f7f7f1a",dark:"#7f7f7f1a",hc:null},localize("textBlockQuoteBackground","Background color for block quotes in text.")),registerColor("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hc:Color.white},localize("textBlockQuoteBorder","Border color for block quotes in text."));const textCodeBlockBackground=registerColor("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hc:Color.black},localize("textCodeBlockBackground","Background color for code blocks in text.")),widgetShadow=registerColor("widget.shadow",{dark:transparent(Color.black,.36),light:transparent(Color.black,.16),hc:null},localize("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),inputBackground=registerColor("input.background",{dark:"#3C3C3C",light:Color.white,hc:Color.black},localize("inputBoxBackground","Input box background.")),inputForeground=registerColor("input.foreground",{dark:foreground,light:foreground,hc:foreground},localize("inputBoxForeground","Input box foreground.")),inputBorder=registerColor("input.border",{dark:null,light:null,hc:contrastBorder},localize("inputBoxBorder","Input box border.")),inputActiveOptionBorder=registerColor("inputOption.activeBorder",{dark:"#007ACC00",light:"#007ACC00",hc:contrastBorder},localize("inputBoxActiveOptionBorder","Border color of activated options in input fields."));registerColor("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hc:null},localize("inputOption.hoverBackground","Background color of activated options in input fields."));const inputActiveOptionBackground=registerColor("inputOption.activeBackground",{dark:transparent(focusBorder,.4),light:transparent(focusBorder,.2),hc:Color.transparent},localize("inputOption.activeBackground","Background hover color of options in input fields.")),inputActiveOptionForeground=registerColor("inputOption.activeForeground",{dark:Color.white,light:Color.black,hc:null},localize("inputOption.activeForeground","Foreground color of activated options in input fields."));registerColor("input.placeholderForeground",{light:transparent(foreground,.5),dark:transparent(foreground,.5),hc:transparent(foreground,.7)},localize("inputPlaceholderForeground","Input box foreground color for placeholder text."));const inputValidationInfoBackground=registerColor("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hc:Color.black},localize("inputValidationInfoBackground","Input validation background color for information severity.")),inputValidationInfoForeground=registerColor("inputValidation.infoForeground",{dark:null,light:null,hc:null},localize("inputValidationInfoForeground","Input validation foreground color for information severity.")),inputValidationInfoBorder=registerColor("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hc:contrastBorder},localize("inputValidationInfoBorder","Input validation border color for information severity.")),inputValidationWarningBackground=registerColor("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hc:Color.black},localize("inputValidationWarningBackground","Input validation background color for warning severity.")),inputValidationWarningForeground=registerColor("inputValidation.warningForeground",{dark:null,light:null,hc:null},localize("inputValidationWarningForeground","Input validation foreground color for warning severity.")),inputValidationWarningBorder=registerColor("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hc:contrastBorder},localize("inputValidationWarningBorder","Input validation border color for warning severity.")),inputValidationErrorBackground=registerColor("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hc:Color.black},localize("inputValidationErrorBackground","Input validation background color for error severity.")),inputValidationErrorForeground=registerColor("inputValidation.errorForeground",{dark:null,light:null,hc:null},localize("inputValidationErrorForeground","Input validation foreground color for error severity.")),inputValidationErrorBorder=registerColor("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hc:contrastBorder},localize("inputValidationErrorBorder","Input validation border color for error severity.")),selectBackground=registerColor("dropdown.background",{dark:"#3C3C3C",light:Color.white,hc:Color.black},localize("dropdownBackground","Dropdown background."));registerColor("dropdown.listBackground",{dark:null,light:null,hc:Color.black},localize("dropdownListBackground","Dropdown list background."));const selectForeground=registerColor("dropdown.foreground",{dark:"#F0F0F0",light:null,hc:Color.white},localize("dropdownForeground","Dropdown foreground.")),selectBorder=registerColor("dropdown.border",{dark:selectBackground,light:"#CECECE",hc:contrastBorder},localize("dropdownBorder","Dropdown border."));registerColor("checkbox.background",{dark:selectBackground,light:selectBackground,hc:selectBackground},localize("checkbox.background","Background color of checkbox widget.")),registerColor("checkbox.foreground",{dark:selectForeground,light:selectForeground,hc:selectForeground},localize("checkbox.foreground","Foreground color of checkbox widget.")),registerColor("checkbox.border",{dark:selectBorder,light:selectBorder,hc:selectBorder},localize("checkbox.border","Border color of checkbox widget."));const buttonForeground=registerColor("button.foreground",{dark:Color.white,light:Color.white,hc:Color.white},localize("buttonForeground","Button foreground color.")),buttonBackground=registerColor("button.background",{dark:"#0E639C",light:"#007ACC",hc:null},localize("buttonBackground","Button background color.")),buttonHoverBackground=registerColor("button.hoverBackground",{dark:lighten(buttonBackground,.2),light:darken(buttonBackground,.2),hc:null},localize("buttonHoverBackground","Button background color when hovering."));registerColor("button.border",{dark:contrastBorder,light:contrastBorder,hc:contrastBorder},localize("buttonBorder","Button border color.")),registerColor("button.secondaryForeground",{dark:Color.white,light:Color.white,hc:Color.white},localize("buttonSecondaryForeground","Secondary button foreground color."));const buttonSecondaryBackground=registerColor("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hc:null},localize("buttonSecondaryBackground","Secondary button background color."));registerColor("button.secondaryHoverBackground",{dark:lighten(buttonSecondaryBackground,.2),light:darken(buttonSecondaryBackground,.2),hc:null},localize("buttonSecondaryHoverBackground","Secondary button background color when hovering."));const badgeBackground=registerColor("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hc:Color.black},localize("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),badgeForeground=registerColor("badge.foreground",{dark:Color.white,light:"#333",hc:Color.white},localize("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),scrollbarShadow=registerColor("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hc:null},localize("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),scrollbarSliderBackground=registerColor("scrollbarSlider.background",{dark:Color.fromHex("#797979").transparent(.4),light:Color.fromHex("#646464").transparent(.4),hc:transparent(contrastBorder,.6)},localize("scrollbarSliderBackground","Scrollbar slider background color.")),scrollbarSliderHoverBackground=registerColor("scrollbarSlider.hoverBackground",{dark:Color.fromHex("#646464").transparent(.7),light:Color.fromHex("#646464").transparent(.7),hc:transparent(contrastBorder,.8)},localize("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),scrollbarSliderActiveBackground=registerColor("scrollbarSlider.activeBackground",{dark:Color.fromHex("#BFBFBF").transparent(.4),light:Color.fromHex("#000000").transparent(.6),hc:contrastBorder},localize("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),progressBarBackground=registerColor("progressBar.background",{dark:Color.fromHex("#0E70C0"),light:Color.fromHex("#0E70C0"),hc:contrastBorder},localize("progressBarBackground","Background color of the progress bar that can show for long running operations.")),editorErrorBackground=registerColor("editorError.background",{dark:null,light:null,hc:null},localize("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorErrorForeground=registerColor("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hc:null},localize("editorError.foreground","Foreground color of error squigglies in the editor.")),editorErrorBorder=registerColor("editorError.border",{dark:null,light:null,hc:Color.fromHex("#E47777").transparent(.8)},localize("errorBorder","Border color of error boxes in the editor.")),editorWarningBackground=registerColor("editorWarning.background",{dark:null,light:null,hc:null},localize("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorWarningForeground=registerColor("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hc:null},localize("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),editorWarningBorder=registerColor("editorWarning.border",{dark:null,light:null,hc:Color.fromHex("#FFCC00").transparent(.8)},localize("warningBorder","Border color of warning boxes in the editor.")),editorInfoBackground=registerColor("editorInfo.background",{dark:null,light:null,hc:null},localize("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorInfoForeground=registerColor("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hc:"#3794FF"},localize("editorInfo.foreground","Foreground color of info squigglies in the editor.")),editorInfoBorder=registerColor("editorInfo.border",{dark:null,light:null,hc:Color.fromHex("#3794FF").transparent(.8)},localize("infoBorder","Border color of info boxes in the editor.")),editorHintForeground=registerColor("editorHint.foreground",{dark:Color.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hc:null},localize("editorHint.foreground","Foreground color of hint squigglies in the editor.")),editorHintBorder=registerColor("editorHint.border",{dark:null,light:null,hc:Color.fromHex("#eeeeee").transparent(.8)},localize("hintBorder","Border color of hint boxes in the editor."));registerColor("sash.hoverBorder",{dark:focusBorder,light:focusBorder,hc:focusBorder},localize("sashActiveBorder","Border color of active sashes."));const editorBackground=registerColor("editor.background",{light:"#fffffe",dark:"#1E1E1E",hc:Color.black},localize("editorBackground","Editor background color.")),editorForeground=registerColor("editor.foreground",{light:"#333333",dark:"#BBBBBB",hc:Color.white},localize("editorForeground","Editor default foreground color.")),editorWidgetBackground=registerColor("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hc:"#0C141F"},localize("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),editorWidgetForeground=registerColor("editorWidget.foreground",{dark:foreground,light:foreground,hc:foreground},localize("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),editorWidgetBorder=registerColor("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hc:contrastBorder},localize("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget.")),editorWidgetResizeBorder=registerColor("editorWidget.resizeBorder",{light:null,dark:null,hc:null},localize("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget.")),quickInputBackground=registerColor("quickInput.background",{dark:editorWidgetBackground,light:editorWidgetBackground,hc:editorWidgetBackground},localize("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),quickInputForeground=registerColor("quickInput.foreground",{dark:editorWidgetForeground,light:editorWidgetForeground,hc:editorWidgetForeground},localize("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),quickInputTitleBackground=registerColor("quickInputTitle.background",{dark:new Color(new RGBA(255,255,255,.105)),light:new Color(new RGBA(0,0,0,.06)),hc:"#000000"},localize("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),pickerGroupForeground=registerColor("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hc:Color.white},localize("pickerGroupForeground","Quick picker color for grouping labels.")),pickerGroupBorder=registerColor("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hc:Color.white},localize("pickerGroupBorder","Quick picker color for grouping borders.")),keybindingLabelBackground=registerColor("keybindingLabel.background",{dark:new Color(new RGBA(128,128,128,.17)),light:new Color(new RGBA(221,221,221,.4)),hc:Color.transparent},localize("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelForeground=registerColor("keybindingLabel.foreground",{dark:Color.fromHex("#CCCCCC"),light:Color.fromHex("#555555"),hc:Color.white},localize("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBorder=registerColor("keybindingLabel.border",{dark:new Color(new RGBA(51,51,51,.6)),light:new Color(new RGBA(204,204,204,.4)),hc:new Color(new RGBA(111,195,223))},localize("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),keybindingLabelBottomBorder=registerColor("keybindingLabel.bottomBorder",{dark:new Color(new RGBA(68,68,68,.6)),light:new Color(new RGBA(187,187,187,.4)),hc:new Color(new RGBA(111,195,223))},localize("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),editorSelectionBackground=registerColor("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hc:"#f3f518"},localize("editorSelectionBackground","Color of the editor selection.")),editorSelectionForeground=registerColor("editor.selectionForeground",{light:null,dark:null,hc:"#000000"},localize("editorSelectionForeground","Color of the selected text for high contrast.")),editorInactiveSelection=registerColor("editor.inactiveSelectionBackground",{light:transparent(editorSelectionBackground,.5),dark:transparent(editorSelectionBackground,.5),hc:transparent(editorSelectionBackground,.5)},localize("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),editorSelectionHighlight=registerColor("editor.selectionHighlightBackground",{light:lessProminent(editorSelectionBackground,editorBackground,.3,.6),dark:lessProminent(editorSelectionBackground,editorBackground,.3,.6),hc:null},localize("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0),editorSelectionHighlightBorder=registerColor("editor.selectionHighlightBorder",{light:null,dark:null,hc:activeContrastBorder},localize("editorSelectionHighlightBorder","Border color for regions with the same content as the selection.")),editorFindMatch=registerColor("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hc:null},localize("editorFindMatch","Color of the current search match.")),editorFindMatchHighlight=registerColor("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hc:null},localize("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),editorFindRangeHighlight=registerColor("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hc:null},localize("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0),editorFindMatchBorder=registerColor("editor.findMatchBorder",{light:null,dark:null,hc:activeContrastBorder},localize("editorFindMatchBorder","Border color of the current search match.")),editorFindMatchHighlightBorder=registerColor("editor.findMatchHighlightBorder",{light:null,dark:null,hc:activeContrastBorder},localize("findMatchHighlightBorder","Border color of the other search matches.")),editorFindRangeHighlightBorder=registerColor("editor.findRangeHighlightBorder",{dark:null,light:null,hc:transparent(activeContrastBorder,.4)},localize("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("searchEditor.findMatchBackground",{light:transparent(editorFindMatchHighlight,.66),dark:transparent(editorFindMatchHighlight,.66),hc:editorFindMatchHighlight},localize("searchEditor.queryMatch","Color of the Search Editor query matches.")),registerColor("searchEditor.findMatchBorder",{light:transparent(editorFindMatchHighlightBorder,.66),dark:transparent(editorFindMatchHighlightBorder,.66),hc:editorFindMatchHighlightBorder},localize("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));const editorHoverHighlight=registerColor("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hc:"#ADD6FF26"},localize("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0),editorHoverBackground=registerColor("editorHoverWidget.background",{light:editorWidgetBackground,dark:editorWidgetBackground,hc:editorWidgetBackground},localize("hoverBackground","Background color of the editor hover.")),editorHoverForeground=registerColor("editorHoverWidget.foreground",{light:editorWidgetForeground,dark:editorWidgetForeground,hc:editorWidgetForeground},localize("hoverForeground","Foreground color of the editor hover.")),editorHoverBorder=registerColor("editorHoverWidget.border",{light:editorWidgetBorder,dark:editorWidgetBorder,hc:editorWidgetBorder},localize("hoverBorder","Border color of the editor hover.")),editorHoverStatusBarBackground=registerColor("editorHoverWidget.statusBarBackground",{dark:lighten(editorHoverBackground,.2),light:darken(editorHoverBackground,.05),hc:editorWidgetBackground},localize("statusBarBackground","Background color of the editor hover status bar.")),editorActiveLinkForeground=registerColor("editorLink.activeForeground",{dark:"#4E94CE",light:Color.blue,hc:Color.cyan},localize("activeLinkForeground","Color of active links.")),editorInlayHintForeground=registerColor("editorInlayHint.foreground",{dark:transparent(badgeForeground,.8),light:transparent(badgeForeground,.8),hc:badgeForeground},localize("editorInlayHintForeground","Foreground color of inline hints")),editorInlayHintBackground=registerColor("editorInlayHint.background",{dark:transparent(badgeBackground,.6),light:transparent(badgeBackground,.3),hc:badgeBackground},localize("editorInlayHintBackground","Background color of inline hints")),editorInlayHintTypeForeground=registerColor("editorInlayHint.typeForeground",{dark:editorInlayHintForeground,light:editorInlayHintForeground,hc:editorInlayHintForeground},localize("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),editorInlayHintTypeBackground=registerColor("editorInlayHint.typeBackground",{dark:editorInlayHintBackground,light:editorInlayHintBackground,hc:editorInlayHintBackground},localize("editorInlayHintBackgroundTypes","Background color of inline hints for types")),editorInlayHintParameterForeground=registerColor("editorInlayHint.parameterForeground",{dark:editorInlayHintForeground,light:editorInlayHintForeground,hc:editorInlayHintForeground},localize("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),editorInlayHintParameterBackground=registerColor("editorInlayHint.parameterBackground",{dark:editorInlayHintBackground,light:editorInlayHintBackground,hc:editorInlayHintBackground},localize("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),editorLightBulbForeground=registerColor("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hc:"#FFCC00"},localize("editorLightBulbForeground","The color used for the lightbulb actions icon.")),editorLightBulbAutoFixForeground=registerColor("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},localize("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon.")),defaultInsertColor=new Color(new RGBA(155,185,85,.2)),defaultRemoveColor=new Color(new RGBA(255,0,0,.2)),diffInserted=registerColor("diffEditor.insertedTextBackground",{dark:defaultInsertColor,light:defaultInsertColor,hc:null},localize("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),diffRemoved=registerColor("diffEditor.removedTextBackground",{dark:defaultRemoveColor,light:defaultRemoveColor,hc:null},localize("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),diffInsertedLine=registerColor("diffEditor.insertedLineBackground",{dark:null,light:null,hc:null},localize("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),diffRemovedLine=registerColor("diffEditor.removedLineBackground",{dark:null,light:null,hc:null},localize("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0),diffInsertedLineGutter=registerColor("diffEditorGutter.insertedLineBackground",{dark:null,light:null,hc:null},localize("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted.")),diffRemovedLineGutter=registerColor("diffEditorGutter.removedLineBackground",{dark:null,light:null,hc:null},localize("diffEditorRemovedLineGutter","Background color for the margin where lines got removed.")),diffOverviewRulerInserted=registerColor("diffEditorOverview.insertedForeground",{dark:null,light:null,hc:null},localize("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),diffOverviewRulerRemoved=registerColor("diffEditorOverview.removedForeground",{dark:null,light:null,hc:null},localize("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content.")),diffInsertedOutline=registerColor("diffEditor.insertedTextBorder",{dark:null,light:null,hc:"#33ff2eff"},localize("diffEditorInsertedOutline","Outline color for the text that got inserted.")),diffRemovedOutline=registerColor("diffEditor.removedTextBorder",{dark:null,light:null,hc:"#FF008F"},localize("diffEditorRemovedOutline","Outline color for text that got removed.")),diffBorder=registerColor("diffEditor.border",{dark:null,light:null,hc:contrastBorder},localize("diffEditorBorder","Border color between the two text editors.")),diffDiagonalFill=registerColor("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hc:null},localize("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views.")),listFocusBackground=registerColor("list.focusBackground",{dark:null,light:null,hc:null},localize("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusForeground=registerColor("list.focusForeground",{dark:null,light:null,hc:null},localize("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listFocusOutline=registerColor("list.focusOutline",{dark:focusBorder,light:focusBorder,hc:activeContrastBorder},localize("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionBackground=registerColor("list.activeSelectionBackground",{dark:"#094771",light:"#0060C0",hc:null},localize("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionForeground=registerColor("list.activeSelectionForeground",{dark:Color.white,light:Color.white,hc:null},localize("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listActiveSelectionIconForeground=registerColor("list.activeSelectionIconForeground",{dark:null,light:null,hc:null},localize("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionBackground=registerColor("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hc:null},localize("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionForeground=registerColor("list.inactiveSelectionForeground",{dark:null,light:null,hc:null},localize("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveSelectionIconForeground=registerColor("list.inactiveSelectionIconForeground",{dark:null,light:null,hc:null},localize("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusBackground=registerColor("list.inactiveFocusBackground",{dark:null,light:null,hc:null},localize("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listInactiveFocusOutline=registerColor("list.inactiveFocusOutline",{dark:null,light:null,hc:null},localize("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),listHoverBackground=registerColor("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hc:null},localize("listHoverBackground","List/Tree background when hovering over items using the mouse.")),listHoverForeground=registerColor("list.hoverForeground",{dark:null,light:null,hc:null},localize("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),listDropBackground=registerColor("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hc:null},localize("listDropBackground","List/Tree drag and drop background when moving items around using the mouse.")),listHighlightForeground=registerColor("list.highlightForeground",{dark:"#18A3FF",light:"#0066BF",hc:focusBorder},localize("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),listFocusHighlightForeground=registerColor("list.focusHighlightForeground",{dark:listHighlightForeground,light:ifDefinedThenElse(listActiveSelectionBackground,listHighlightForeground,"#9DDDFF"),hc:listHighlightForeground},localize("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));registerColor("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hc:"#B89500"},localize("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer.")),registerColor("list.errorForeground",{dark:"#F88070",light:"#B01011",hc:null},localize("listErrorForeground","Foreground color of list items containing errors.")),registerColor("list.warningForeground",{dark:"#CCA700",light:"#855F00",hc:null},localize("listWarningForeground","Foreground color of list items containing warnings."));const listFilterWidgetBackground=registerColor("listFilterWidget.background",{light:"#efc1ad",dark:"#653723",hc:Color.black},localize("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),listFilterWidgetOutline=registerColor("listFilterWidget.outline",{dark:Color.transparent,light:Color.transparent,hc:"#f38518"},localize("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),listFilterWidgetNoMatchesOutline=registerColor("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hc:contrastBorder},localize("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches."));registerColor("list.filterMatchBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hc:null},localize("listFilterMatchHighlight","Background color of the filtered match.")),registerColor("list.filterMatchBorder",{dark:editorFindMatchHighlightBorder,light:editorFindMatchHighlightBorder,hc:contrastBorder},localize("listFilterMatchHighlightBorder","Border color of the filtered match."));const treeIndentGuidesStroke=registerColor("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hc:"#a9a9a9"},localize("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),tableColumnsBorder=registerColor("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hc:null},localize("tableColumnsBorder","Table border color between columns.")),tableOddRowsBackgroundColor=registerColor("tree.tableOddRowsBackground",{dark:transparent(foreground,.04),light:transparent(foreground,.04),hc:null},localize("tableOddRowsBackgroundColor","Background color for odd table rows."));registerColor("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hc:"#A7A8A9"},localize("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized. "));const _deprecatedQuickInputListFocusBackground=registerColor("quickInput.list.focusBackground",{dark:null,light:null,hc:null},"",void 0,localize("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),quickInputListFocusForeground=registerColor("quickInputList.focusForeground",{dark:listActiveSelectionForeground,light:listActiveSelectionForeground,hc:listActiveSelectionForeground},localize("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),quickInputListFocusIconForeground=registerColor("quickInputList.focusIconForeground",{dark:listActiveSelectionIconForeground,light:listActiveSelectionIconForeground,hc:listActiveSelectionIconForeground},localize("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),quickInputListFocusBackground=registerColor("quickInputList.focusBackground",{dark:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),light:oneOf(_deprecatedQuickInputListFocusBackground,listActiveSelectionBackground),hc:null},localize("quickInput.listFocusBackground","Quick picker background color for the focused item.")),menuBorder=registerColor("menu.border",{dark:null,light:null,hc:contrastBorder},localize("menuBorder","Border color of menus.")),menuForeground=registerColor("menu.foreground",{dark:selectForeground,light:foreground,hc:selectForeground},localize("menuForeground","Foreground color of menu items.")),menuBackground=registerColor("menu.background",{dark:selectBackground,light:selectBackground,hc:selectBackground},localize("menuBackground","Background color of menu items.")),menuSelectionForeground=registerColor("menu.selectionForeground",{dark:listActiveSelectionForeground,light:listActiveSelectionForeground,hc:listActiveSelectionForeground},localize("menuSelectionForeground","Foreground color of the selected menu item in menus.")),menuSelectionBackground=registerColor("menu.selectionBackground",{dark:listActiveSelectionBackground,light:listActiveSelectionBackground,hc:listActiveSelectionBackground},localize("menuSelectionBackground","Background color of the selected menu item in menus.")),menuSelectionBorder=registerColor("menu.selectionBorder",{dark:null,light:null,hc:activeContrastBorder},localize("menuSelectionBorder","Border color of the selected menu item in menus.")),menuSeparatorBackground=registerColor("menu.separatorBackground",{dark:"#BBBBBB",light:"#888888",hc:contrastBorder},localize("menuSeparatorBackground","Color of a separator menu item in menus.")),toolbarHoverBackground=registerColor("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hc:null},localize("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));registerColor("toolbar.hoverOutline",{dark:null,light:null,hc:activeContrastBorder},localize("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse")),registerColor("toolbar.activeBackground",{dark:lighten(toolbarHoverBackground,.1),light:darken(toolbarHoverBackground,.1),hc:null},localize("toolbarActiveBackground","Toolbar background when holding the mouse over actions")),registerColor("editor.snippetTabstopHighlightBackground",{dark:new Color(new RGBA(124,124,124,.3)),light:new Color(new RGBA(10,50,100,.2)),hc:new Color(new RGBA(124,124,124,.3))},localize("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop.")),registerColor("editor.snippetTabstopHighlightBorder",{dark:null,light:null,hc:null},localize("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop.")),registerColor("editor.snippetFinalTabstopHighlightBackground",{dark:null,light:null,hc:null},localize("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet.")),registerColor("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new Color(new RGBA(10,50,100,.5)),hc:"#525252"},localize("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet.")),registerColor("breadcrumb.foreground",{light:transparent(foreground,.8),dark:transparent(foreground,.8),hc:transparent(foreground,.8)},localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),registerColor("breadcrumb.background",{light:editorBackground,dark:editorBackground,hc:editorBackground},localize("breadcrumbsBackground","Background color of breadcrumb items.")),registerColor("breadcrumb.focusForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hc:lighten(foreground,.1)},localize("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),registerColor("breadcrumb.activeSelectionForeground",{light:darken(foreground,.2),dark:lighten(foreground,.1),hc:lighten(foreground,.1)},localize("breadcrumbsSelectedForegound","Color of selected breadcrumb items.")),registerColor("breadcrumbPicker.background",{light:editorWidgetBackground,dark:editorWidgetBackground,hc:editorWidgetBackground},localize("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const headerTransparency=.5,currentBaseColor=Color.fromHex("#40C8AE").transparent(headerTransparency),incomingBaseColor=Color.fromHex("#40A6FF").transparent(headerTransparency),commonBaseColor=Color.fromHex("#606060").transparent(.4),contentTransparency=.4,rulerTransparency=1,mergeCurrentHeaderBackground=registerColor("merge.currentHeaderBackground",{dark:currentBaseColor,light:currentBaseColor,hc:null},localize("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.currentContentBackground",{dark:transparent(mergeCurrentHeaderBackground,contentTransparency),light:transparent(mergeCurrentHeaderBackground,contentTransparency),hc:transparent(mergeCurrentHeaderBackground,contentTransparency)},localize("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeIncomingHeaderBackground=registerColor("merge.incomingHeaderBackground",{dark:incomingBaseColor,light:incomingBaseColor,hc:null},localize("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.incomingContentBackground",{dark:transparent(mergeIncomingHeaderBackground,contentTransparency),light:transparent(mergeIncomingHeaderBackground,contentTransparency),hc:transparent(mergeIncomingHeaderBackground,contentTransparency)},localize("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeCommonHeaderBackground=registerColor("merge.commonHeaderBackground",{dark:commonBaseColor,light:commonBaseColor,hc:null},localize("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);registerColor("merge.commonContentBackground",{dark:transparent(mergeCommonHeaderBackground,contentTransparency),light:transparent(mergeCommonHeaderBackground,contentTransparency),hc:transparent(mergeCommonHeaderBackground,contentTransparency)},localize("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const mergeBorder=registerColor("merge.border",{dark:null,light:null,hc:"#C3DF6F"},localize("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));registerColor("editorOverviewRuler.currentContentForeground",{dark:transparent(mergeCurrentHeaderBackground,rulerTransparency),light:transparent(mergeCurrentHeaderBackground,rulerTransparency),hc:mergeBorder},localize("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts.")),registerColor("editorOverviewRuler.incomingContentForeground",{dark:transparent(mergeIncomingHeaderBackground,rulerTransparency),light:transparent(mergeIncomingHeaderBackground,rulerTransparency),hc:mergeBorder},localize("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts.")),registerColor("editorOverviewRuler.commonContentForeground",{dark:transparent(mergeCommonHeaderBackground,rulerTransparency),light:transparent(mergeCommonHeaderBackground,rulerTransparency),hc:mergeBorder},localize("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const overviewRulerFindMatchForeground=registerColor("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hc:"#AB5A00"},localize("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerSelectionHighlightForeground=registerColor("editorOverviewRuler.selectionHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},localize("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),minimapFindMatch=registerColor("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hc:"#AB5A00"},localize("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),minimapSelectionOccurrenceHighlight=registerColor("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hc:"#ffffff"},localize("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),minimapSelection=registerColor("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hc:"#ffffff"},localize("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),minimapError=registerColor("minimap.errorHighlight",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hc:new Color(new RGBA(255,50,50,1))},localize("minimapError","Minimap marker color for errors.")),minimapWarning=registerColor("minimap.warningHighlight",{dark:editorWarningForeground,light:editorWarningForeground,hc:editorWarningBorder},localize("overviewRuleWarning","Minimap marker color for warnings.")),minimapBackground=registerColor("minimap.background",{dark:null,light:null,hc:null},localize("minimapBackground","Minimap background color.")),minimapForegroundOpacity=registerColor("minimap.foregroundOpacity",{dark:Color.fromHex("#000f"),light:Color.fromHex("#000f"),hc:Color.fromHex("#000f")},localize("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.')),minimapSliderBackground=registerColor("minimapSlider.background",{light:transparent(scrollbarSliderBackground,.5),dark:transparent(scrollbarSliderBackground,.5),hc:transparent(scrollbarSliderBackground,.5)},localize("minimapSliderBackground","Minimap slider background color.")),minimapSliderHoverBackground=registerColor("minimapSlider.hoverBackground",{light:transparent(scrollbarSliderHoverBackground,.5),dark:transparent(scrollbarSliderHoverBackground,.5),hc:transparent(scrollbarSliderHoverBackground,.5)},localize("minimapSliderHoverBackground","Minimap slider background color when hovering.")),minimapSliderActiveBackground=registerColor("minimapSlider.activeBackground",{light:transparent(scrollbarSliderActiveBackground,.5),dark:transparent(scrollbarSliderActiveBackground,.5),hc:transparent(scrollbarSliderActiveBackground,.5)},localize("minimapSliderActiveBackground","Minimap slider background color when clicked on.")),problemsErrorIconForeground=registerColor("problemsErrorIcon.foreground",{dark:editorErrorForeground,light:editorErrorForeground,hc:editorErrorForeground},localize("problemsErrorIconForeground","The color used for the problems error icon.")),problemsWarningIconForeground=registerColor("problemsWarningIcon.foreground",{dark:editorWarningForeground,light:editorWarningForeground,hc:editorWarningForeground},localize("problemsWarningIconForeground","The color used for the problems warning icon.")),problemsInfoIconForeground=registerColor("problemsInfoIcon.foreground",{dark:editorInfoForeground,light:editorInfoForeground,hc:editorInfoForeground},localize("problemsInfoIconForeground","The color used for the problems info icon."));function executeTransform(e,t){var i,n,o;switch(e.op){case 0:return null===(i=resolveColorValue(e.value,t))||void 0===i?void 0:i.darken(e.factor);case 1:return null===(n=resolveColorValue(e.value,t))||void 0===n?void 0:n.lighten(e.factor);case 2:return null===(o=resolveColorValue(e.value,t))||void 0===o?void 0:o.transparent(e.factor);case 3:for(const i of e.values){const e=resolveColorValue(i,t);if(e)return e}return;case 5:return resolveColorValue(t.defines(e.if)?e.then:e.else,t);case 4:{const i=resolveColorValue(e.value,t);if(!i)return;const n=resolveColorValue(e.background,t);return n?i.isDarkerThan(n)?Color.getLighterColor(i,n,e.factor).transparent(e.transparency):Color.getDarkerColor(i,n,e.factor).transparent(e.transparency):i.transparent(e.factor*e.transparency)}default:throw assertNever()}}function darken(e,t){return{op:0,value:e,factor:t}}function lighten(e,t){return{op:1,value:e,factor:t}}function transparent(e,t){return{op:2,value:e,factor:t}}function oneOf(...e){return{op:3,values:e}}function ifDefinedThenElse(e,t,i){return{op:5,if:e,then:t,else:i}}function lessProminent(e,t,i,n){return{op:4,value:e,background:t,factor:i,transparency:n}}function resolveColorValue(e,t){if(null!==e)return"string"==typeof e?"#"===e[0]?Color.fromHex(e):t.getColor(e):e instanceof Color?e:"object"==typeof e?executeTransform(e,t):void 0}registerColor("charts.foreground",{dark:foreground,light:foreground,hc:foreground},localize("chartsForeground","The foreground color used in charts.")),registerColor("charts.lines",{dark:transparent(foreground,.5),light:transparent(foreground,.5),hc:transparent(foreground,.5)},localize("chartsLines","The color used for horizontal lines in charts.")),registerColor("charts.red",{dark:editorErrorForeground,light:editorErrorForeground,hc:editorErrorForeground},localize("chartsRed","The red color used in chart visualizations.")),registerColor("charts.blue",{dark:editorInfoForeground,light:editorInfoForeground,hc:editorInfoForeground},localize("chartsBlue","The blue color used in chart visualizations.")),registerColor("charts.yellow",{dark:editorWarningForeground,light:editorWarningForeground,hc:editorWarningForeground},localize("chartsYellow","The yellow color used in chart visualizations.")),registerColor("charts.orange",{dark:minimapFindMatch,light:minimapFindMatch,hc:minimapFindMatch},localize("chartsOrange","The orange color used in chart visualizations.")),registerColor("charts.green",{dark:"#89D185",light:"#388A34",hc:"#89D185"},localize("chartsGreen","The green color used in chart visualizations.")),registerColor("charts.purple",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},localize("chartsPurple","The purple color used in chart visualizations."));const workbenchColorsSchemaId="vscode://schemas/workbench-colors";let schemaRegistry$1=Registry.as(Extensions$5.JSONContribution);schemaRegistry$1.registerSchema(workbenchColorsSchemaId,colorRegistry$1.getColorSchema());const delayer$1=new RunOnceScheduler((()=>schemaRegistry$1.notifySchemaChanged(workbenchColorsSchemaId)),200);colorRegistry$1.onDidChangeSchema((()=>{delayer$1.isScheduled()||delayer$1.schedule()}));class PageCoordinates{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(){return new ClientCoordinates(this.x-StandardWindow.scrollX,this.y-StandardWindow.scrollY)}}class ClientCoordinates{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(){return new PageCoordinates(this.clientX+StandardWindow.scrollX,this.clientY+StandardWindow.scrollY)}}class EditorPagePosition{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class CoordinatesRelativeToEditor{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function createEditorPagePosition(e){const t=getDomNodePagePosition(e);return new EditorPagePosition(t.left,t.top,t.width,t.height)}function createCoordinatesRelativeToEditor(e,t,i){const n=t.width/e.offsetWidth,o=t.height/e.offsetHeight,r=(i.x-t.x)/n,s=(i.y-t.y)/o;return new CoordinatesRelativeToEditor(r,s)}class EditorMouseEvent extends StandardMouseEvent{constructor(e,t){super(e),this._editorMouseEventBrand=void 0,this.pos=new PageCoordinates(this.posx,this.posy),this.editorPos=createEditorPagePosition(t),this.relativePos=createCoordinatesRelativeToEditor(t,this.editorPos,this.pos)}}class EditorMouseEventFactory{constructor(e){this._editorViewDomNode=e}_create(e){return new EditorMouseEvent(e,this._editorViewDomNode)}onContextMenu(e,t){return addDisposableListener(e,"contextmenu",(e=>{t(this._create(e))}))}onMouseUp(e,t){return addDisposableListener(e,"mouseup",(e=>{t(this._create(e))}))}onMouseDown(e,t){return addDisposableListener(e,"mousedown",(e=>{t(this._create(e))}))}onMouseLeave(e,t){return addDisposableNonBubblingMouseOutListener(e,(e=>{t(this._create(e))}))}onMouseMoveThrottled(e,t,i,n){return addDisposableThrottledListener(e,"mousemove",t,((e,t)=>i(e,this._create(t))),n)}}class EditorPointerEventFactory{constructor(e){this._editorViewDomNode=e}_create(e){return new EditorMouseEvent(e,this._editorViewDomNode)}onPointerUp(e,t){return addDisposableListener(e,"pointerup",(e=>{t(this._create(e))}))}onPointerDown(e,t){return addDisposableListener(e,"pointerdown",(e=>{t(this._create(e))}))}onPointerLeave(e,t){return addDisposableNonBubblingPointerOutListener(e,(e=>{t(this._create(e))}))}onPointerMoveThrottled(e,t,i,n){return addDisposableThrottledListener(e,"pointermove",t,((e,t)=>i(e,this._create(t))),n)}}class GlobalEditorMouseMoveMonitor extends Disposable{constructor(e){super(),this._editorViewDomNode=e,this._globalMouseMoveMonitor=this._register(new GlobalMouseMoveMonitor),this._keydownListener=null}startMonitoring(e,t,i,n,o){this._keydownListener=addStandardDisposableListener(document,"keydown",(e=>{e.toKeybinding().isModifierKey()||this._globalMouseMoveMonitor.stopMonitoring(!0,e.browserEvent)}),!0);this._globalMouseMoveMonitor.startMonitoring(e,t,((e,t)=>i(e,new EditorMouseEvent(t,this._editorViewDomNode))),n,(e=>{this._keydownListener.dispose(),o(e)}))}stopMonitoring(){this._globalMouseMoveMonitor.stopMonitoring(!0)}}class DynamicCssRules{constructor(e){this._editor=e,this._instanceId=++DynamicCssRules._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new RunOnceScheduler((()=>this.garbageCollect()),1e3)}createClassNameRef(e){const t=this.getOrCreateRule(e);return t.increaseRefCount(),{className:t.className,dispose:()=>{t.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(e){const t=this.computeUniqueKey(e);let i=this._rules.get(t);if(!i){const n=this._counter++;i=new RefCountedCssRule(t,`dyn-rule-${this._instanceId}-${n}`,isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,e),this._rules.set(t,i)}return i}computeUniqueKey(e){return JSON.stringify(e)}garbageCollect(){for(const e of this._rules.values())e.hasReferences()||(this._rules.delete(e.key),e.dispose())}}DynamicCssRules._idPool=0;class RefCountedCssRule{constructor(e,t,i,n){this.key=e,this.className=t,this.properties=n,this._referenceCount=0,this._styleElement=createStyleSheet(i),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(e,t){let i=`.${e} {`;for(const n in t){const e=t[n];let o;o="object"==typeof e?`var(${asCssVariableName(e.id)})`:e;i+=`\n\t${camelToDashes(n)}: ${o};`}return i+="\n}",i}dispose(){this._styleElement.remove()}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function camelToDashes(e){return e.replace(/(^[A-Z])/,(([e])=>e.toLowerCase())).replace(/([A-Z])/g,(([e])=>`-${e.toLowerCase()}`))}class ViewEventHandler extends Disposable{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const n=e[i];switch(n.type){case 0:this.onCompositionStart(n)&&(t=!0);break;case 1:this.onCompositionEnd(n)&&(t=!0);break;case 2:this.onConfigurationChanged(n)&&(t=!0);break;case 3:this.onCursorStateChanged(n)&&(t=!0);break;case 4:this.onDecorationsChanged(n)&&(t=!0);break;case 5:this.onFlushed(n)&&(t=!0);break;case 6:this.onFocusChanged(n)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(n)&&(t=!0);break;case 8:this.onLineMappingChanged(n)&&(t=!0);break;case 9:this.onLinesChanged(n)&&(t=!0);break;case 10:this.onLinesDeleted(n)&&(t=!0);break;case 11:this.onLinesInserted(n)&&(t=!0);break;case 12:this.onRevealRangeRequest(n)&&(t=!0);break;case 13:this.onScrollChanged(n)&&(t=!0);break;case 15:this.onTokensChanged(n)&&(t=!0);break;case 14:this.onThemeChanged(n)&&(t=!0);break;case 16:this.onTokensColorsChanged(n)&&(t=!0);break;case 17:this.onZonesChanged(n)&&(t=!0)}}t&&(this._shouldRender=!0)}}class ViewPart extends ViewEventHandler{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class PartFingerprints{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return null===t?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==document.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const o=new Uint8Array(n);for(let r=0;r<n;r++)o[r]=i[n-r-1];return o}}class RestrictedRenderingContext{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e){return this._viewLayout.getVerticalOffsetForLineNumber(e)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class RenderingContext extends RestrictedRenderingContext{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class LineVisibleRanges{constructor(e,t,i){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i}}class HorizontalRange{constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const n=e[i];t[i]=new HorizontalRange(n.left,n.width)}return t}toString(){return`[${this.left},${this.width}]`}}class FloatHorizontalRange{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class HorizontalPosition{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class VisibleRanges{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class RangeUtil{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,o){const r=this._createRange();try{return r.setStart(e,t),r.setEnd(i,n),r.getClientRects()}catch(e2){return null}finally{this._detachRange(r,o)}}static _mergeAdjacentRanges(e){if(1===e.length)return e;e.sort(FloatHorizontalRange.compare);const t=[];let i=0,n=e[0];for(let o=1,r=e.length;o<r;o++){const r=e[o];n.left+n.width+.9>=r.left?n.width=Math.max(n.width,r.left+r.width-n.left):(t[i++]=n,n=r)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||0===e.length)return null;const n=[];for(let o=0,r=e.length;o<r;o++){const r=e[o];n[o]=new FloatHorizontalRange(Math.max(0,(r.left-t)/i),r.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,o,r,s,a){const l=e.children.length-1;if(0>l)return null;if((t=Math.min(l,Math.max(0,t)))===(n=Math.min(l,Math.max(0,n)))&&i===o&&0===i&&!e.children[t].firstChild){const i=e.children[t].getClientRects();return this._createHorizontalRangesFromClientRects(i,r,s)}t!==n&&n>0&&0===o&&(n--,o=1073741824);let d=e.children[t].firstChild,c=e.children[n].firstChild;if(d&&c||(!d&&0===i&&t>0&&(d=e.children[t-1].firstChild,i=1073741824),!c&&0===o&&n>0&&(c=e.children[n-1].firstChild,o=1073741824)),!d||!c)return null;i=Math.min(d.textContent.length,Math.max(0,i)),o=Math.min(c.textContent.length,Math.max(0,o));const h=this._readClientRects(d,i,c,o,a);return this._createHorizontalRangesFromClientRects(h,r,s)}}class LineDecoration{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length;if(i!==t.length)return!1;for(let n=0;n<i;n++)if(!LineDecoration._equals(e[n],t[n]))return!1;return!0}static extractWrapped(e,t,i){if(0===e.length)return e;const n=t+1,o=i+1,r=i-t,s=[];let a=0;for(const l of e)l.endColumn<=n||l.startColumn>=o||(s[a++]=new LineDecoration(Math.max(1,l.startColumn-n+1),Math.min(r+1,l.endColumn-n+1),l.className,l.type));return s}static filter(e,t,i,n){if(0===e.length)return[];const o=[];let r=0;for(let s=0,a=e.length;s<a;s++){const a=e[s],l=a.range;if(l.endLineNumber<t||l.startLineNumber>t)continue;if(l.isEmpty()&&(0===a.type||3===a.type))continue;const d=l.startLineNumber===t?l.startColumn:i,c=l.endLineNumber===t?l.endColumn:n;o[r++]=new LineDecoration(d,c,a.inlineClassName,a.type)}return o}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=LineDecoration._typeCompare(e.type,t.type);return 0!==i?i:e.className!==t.className?e.className<t.className?-1:1:0}}class DecorationSegment{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class Stack{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let e=0;for(;e+1<this.count&&this.stopOffsets[e]===this.stopOffsets[e+1];)e++;i.push(new DecorationSegment(t,this.stopOffsets[e],this.classNames.join(" "),Stack._metadata(this.metadata))),t=this.stopOffsets[e]+1,this.stopOffsets.splice(0,e+1),this.classNames.splice(0,e+1),this.metadata.splice(0,e+1),this.count-=e+1}return this.count>0&&t<e&&(i.push(new DecorationSegment(t,e-1,this.classNames.join(" "),Stack._metadata(this.metadata))),t=e),t}insert(e,t,i){if(0===this.count||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class LineDecorationsNormalizer{static normalize(e,t){if(0===t.length)return[];const i=[],n=new Stack;let o=0;for(let r=0,s=t.length;r<s;r++){const s=t[r];let a=s.startColumn,l=s.endColumn;const d=s.className,c=1===s.type?2:2===s.type?4:0;if(a>1){isHighSurrogate(e.charCodeAt(a-2))&&a--}if(l>1){isHighSurrogate(e.charCodeAt(l-2))&&l--}const h=a-1,u=l-2;o=n.consumeLowerThan(h,o,i),0===n.count&&(o=h),n.insert(u,d,c)}return n.consumeLowerThan(1073741824,o,i),i}}class LinePart{constructor(e,t,i){this._linePartBrand=void 0,this.endIndex=e,this.type=t,this.metadata=i}isWhitespace(){return!!(1&this.metadata)}isPseudoAfter(){return!!(4&this.metadata)}}class LineRange{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class RenderLineInput{constructor(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p,m,f,_,C){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=o,this.containsRTL=r,this.fauxIndentLength=s,this.lineTokens=a,this.lineDecorations=l.sort(LineDecoration.compare),this.tabSize=d,this.startVisibleColumn=c,this.spaceWidth=h,this.stopRenderingLineAfter=p,this.renderWhitespace="all"===m?4:"boundary"===m?1:"selection"===m?2:"trailing"===m?3:0,this.renderControlCharacters=f,this.fontLigatures=_,this.selectionsOnLine=C&&C.sort(((e,t)=>e.startOffset<t.startOffset?-1:1));Math.abs(g-h)<Math.abs(u-h)?(this.renderSpaceWidth=g,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=u,this.renderSpaceCharCode=183)}sameSelection(e){if(null===this.selectionsOnLine)return null===e;if(null===e)return!1;if(e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&LineDecoration.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class DomPosition{constructor(e,t){this.partIndex=e,this.charIndex=t}}class CharacterMapping{constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._absoluteOffsets=new Uint32Array(this.length)}static getPartIndex(e){return(4294901760&e)>>>16}static getCharIndex(e){return(65535&e)>>>0}setColumnInfo(e,t,i,n){const o=(t<<16|i<<0)>>>0;this._data[e-1]=o,this._absoluteOffsets[e-1]=n+i}getAbsoluteOffset(e){return 0===this._absoluteOffsets.length?0:this._absoluteOffsets[e-1]}charOffsetToPartData(e){return 0===this.length?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=CharacterMapping.getPartIndex(t),n=CharacterMapping.getCharIndex(t);return new DomPosition(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(0===this.length)return 0;const n=(e<<16|i<<0)>>>0;let o=0,r=this.length-1;for(;o+1<r;){const e=o+r>>>1,t=this._data[e];if(t===n)return e;t>n?r=e:o=e}if(o===r)return o;const s=this._data[o],a=this._data[r];if(s===n)return o;if(a===n)return r;const l=CharacterMapping.getPartIndex(s),d=CharacterMapping.getCharIndex(s);let c;c=l!==CharacterMapping.getPartIndex(a)?t:CharacterMapping.getCharIndex(a);return i-d<=c-i?o:r}}class RenderLineOutput{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function renderViewLine(e,t){if(0===e.lineContent.length){if(e.lineDecorations.length>0){t.appendASCIIString("<span>");let i=0,n=0,o=0;for(const s of e.lineDecorations)1!==s.type&&2!==s.type||(t.appendASCIIString('<span class="'),t.appendASCIIString(s.className),t.appendASCIIString('"></span>'),1===s.type&&(o|=1,i++),2===s.type&&(o|=2,n++));t.appendASCIIString("</span>");const r=new CharacterMapping(1,i+n);return r.setColumnInfo(1,i,0,0),new RenderLineOutput(r,!1,o)}return t.appendASCIIString("<span><span></span></span>"),new RenderLineOutput(new CharacterMapping(0,0),!1,0)}return _renderLine(resolveRenderLineInput(e),t)}class RenderLineOutput2{constructor(e,t,i,n){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=n}}function renderViewLine2(e){const t=createStringBuilder(1e4),i=renderViewLine(e,t);return new RenderLineOutput2(i.characterMapping,t.build(),i.containsRTL,i.containsForeignElements)}class ResolvedRenderLineInput{constructor(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=o,this.parts=r,this.containsForeignElements=s,this.fauxIndentLength=a,this.tabSize=l,this.startVisibleColumn=d,this.containsRTL=c,this.spaceWidth=h,this.renderSpaceCharCode=u,this.renderWhitespace=g,this.renderControlCharacters=p}}function resolveRenderLineInput(e){const t=e.lineContent;let i,n;-1!==e.stopRenderingLineAfter&&e.stopRenderingLineAfter<t.length?(i=!0,n=e.stopRenderingLineAfter):(i=!1,n=t.length);let o=transformAndRemoveOverflowing(e.lineTokens,e.fauxIndentLength,n);e.renderControlCharacters&&!e.isBasicASCII&&(o=extractControlCharacters(t,o)),(4===e.renderWhitespace||1===e.renderWhitespace||2===e.renderWhitespace&&e.selectionsOnLine||3===e.renderWhitespace)&&(o=_applyRenderWhitespace(e,t,n,o));let r=0;if(e.lineDecorations.length>0){for(let t=0,i=e.lineDecorations.length;t<i;t++){const i=e.lineDecorations[t];3===i.type||1===i.type?r|=1:2===i.type&&(r|=2)}o=_applyInlineDecorations(t,n,o,e.lineDecorations)}return e.containsRTL||(o=splitLargeTokens(t,o,!e.isBasicASCII||e.fontLigatures)),new ResolvedRenderLineInput(e.useMonospaceOptimizations,e.canUseHalfwidthRightwardsArrow,t,n,i,o,r,e.fauxIndentLength,e.tabSize,e.startVisibleColumn,e.containsRTL,e.spaceWidth,e.renderSpaceCharCode,e.renderWhitespace,e.renderControlCharacters)}function transformAndRemoveOverflowing(e,t,i){const n=[];let o=0;t>0&&(n[o++]=new LinePart(t,"",0));for(let r=0,s=e.getCount();r<s;r++){const s=e.getEndOffset(r);if(s<=t)continue;const a=e.getClassName(r);if(s>=i){n[o++]=new LinePart(i,a,0);break}n[o++]=new LinePart(s,a,0)}return n}function splitLargeTokens(e,t,i){let n=0;const o=[];let r=0;if(i)for(let s=0,a=t.length;s<a;s++){const i=t[s],a=i.endIndex;if(n+50<a){const t=i.type,s=i.metadata;let l=-1,d=n;for(let i=n;i<a;i++)32===e.charCodeAt(i)&&(l=i),-1!==l&&i-d>=50&&(o[r++]=new LinePart(l+1,t,s),d=l+1,l=-1);d!==a&&(o[r++]=new LinePart(a,t,s))}else o[r++]=i;n=a}else for(let s=0,a=t.length;s<a;s++){const e=t[s],i=e.endIndex,a=i-n;if(a>50){const t=e.type,s=e.metadata,l=Math.ceil(a/50);for(let e=1;e<l;e++){const i=n+50*e;o[r++]=new LinePart(i,t,s)}o[r++]=new LinePart(i,t,s)}else o[r++]=e;n=i}return o}function isControlCharacter(e){return e<32?9!==e:127===e||(e>=8234&&e<=8238||e>=8294&&e<=8297||e>=8206&&e<=8207||1564===e)}function extractControlCharacters(e,t){const i=[];let n=new LinePart(0,"",0),o=0;for(const r of t){const t=r.endIndex;for(;o<t;o++){isControlCharacter(e.charCodeAt(o))&&(o>n.endIndex&&(n=new LinePart(o,r.type,r.metadata),i.push(n)),n=new LinePart(o+1,"mtkcontrol",r.metadata),i.push(n))}o>n.endIndex&&(n=new LinePart(t,r.type,r.metadata),i.push(n))}return i}function _applyRenderWhitespace(e,t,i,n){const o=e.continuesWithWrappedLine,r=e.fauxIndentLength,s=e.tabSize,a=e.startVisibleColumn,l=e.useMonospaceOptimizations,d=e.selectionsOnLine,c=1===e.renderWhitespace,h=3===e.renderWhitespace,u=e.renderSpaceWidth!==e.spaceWidth,g=[];let p=0,m=0,f=n[m].type,_=n[m].endIndex;const C=n.length;let v,b=!1,S=firstNonWhitespaceIndex(t);-1===S?(b=!0,S=i,v=i):v=lastNonWhitespaceIndex(t);let y=!1,w=0,E=d&&d[w],L=a%s;for(let D=r;D<i;D++){const e=t.charCodeAt(D);let o;if(E&&D>=E.endOffset&&(w++,E=d&&d[w]),D<S||D>v)o=!0;else if(9===e)o=!0;else if(32===e)if(c)if(y)o=!0;else{const e=D+1<i?t.charCodeAt(D+1):0;o=32===e||9===e}else o=!0;else o=!1;if(o&&d&&(o=!!E&&E.startOffset<=D&&E.endOffset>D),o&&h&&(o=b||D>v),y){if(!o||!l&&L>=s){if(u){for(let e=(p>0?g[p-1].endIndex:r)+1;e<=D;e++)g[p++]=new LinePart(e,"mtkw",1)}else g[p++]=new LinePart(D,"mtkw",1);L%=s}}else(D===_||o&&D>r)&&(g[p++]=new LinePart(D,f,0),L%=s);for(9===e?L=s:isFullWidthCharacter(e)?L+=2:L++,y=o;D===_&&(m++,m<C);)f=n[m].type,_=n[m].endIndex}let x=!1;if(y)if(o&&c){const e=i>0?t.charCodeAt(i-1):0,n=i>1?t.charCodeAt(i-2):0;32===e&&32!==n&&9!==n||(x=!0)}else x=!0;if(x)if(u){for(let e=(p>0?g[p-1].endIndex:r)+1;e<=i;e++)g[p++]=new LinePart(e,"mtkw",1)}else g[p++]=new LinePart(i,"mtkw",1);else g[p++]=new LinePart(i,f,0);return g}function _applyInlineDecorations(e,t,i,n){n.sort(LineDecoration.compare);const o=LineDecorationsNormalizer.normalize(e,n),r=o.length;let s=0;const a=[];let l=0,d=0;for(let h=0,u=i.length;h<u;h++){const e=i[h],t=e.endIndex,n=e.type,c=e.metadata;for(;s<r&&o[s].startOffset<t;){const e=o[s];if(e.startOffset>d&&(d=e.startOffset,a[l++]=new LinePart(d,n,c)),!(e.endOffset+1<=t)){d=t,a[l++]=new LinePart(d,n+" "+e.className,c|e.metadata);break}d=e.endOffset+1,a[l++]=new LinePart(d,n+" "+e.className,c|e.metadata),s++}t>d&&(d=t,a[l++]=new LinePart(d,n,c))}const c=i[i.length-1].endIndex;if(s<r&&o[s].startOffset===c)for(;s<r&&o[s].startOffset===c;){const e=o[s];a[l++]=new LinePart(d,e.className,e.metadata),s++}return a}function _renderLine(e,t){const i=e.fontIsMonospace,n=e.canUseHalfwidthRightwardsArrow,o=e.containsForeignElements,r=e.lineContent,s=e.len,a=e.isOverflowing,l=e.parts,d=e.fauxIndentLength,c=e.tabSize,h=e.startVisibleColumn,u=e.containsRTL,g=e.spaceWidth,p=e.renderSpaceCharCode,m=e.renderWhitespace,f=e.renderControlCharacters,_=new CharacterMapping(s+1,l.length);let C=!1,v=0,b=h,S=0,y=0,w=0,E=0;u?t.appendASCIIString('<span dir="ltr">'):t.appendASCIIString("<span>");for(let L=0,x=l.length;L<x;L++){E+=w;const e=l[L],a=e.endIndex,h=e.type,u=0!==m&&e.isWhitespace(),x=u&&!i&&("mtkw"===h||!o),D=v===a&&e.isPseudoAfter();if(S=0,t.appendASCIIString('<span class="'),t.appendASCIIString(x?"mtkz":h),t.appendASCII(34),u){let e=0;{let t=v,i=b;for(;t<a;t++){const n=0|(9===r.charCodeAt(t)?c-i%c:1);e+=n,t>=d&&(i+=n)}}for(x&&(t.appendASCIIString(' style="width:'),t.appendASCIIString(String(g*e)),t.appendASCIIString('px"')),t.appendASCII(62);v<a;v++){_.setColumnInfo(v+1,L-y,S,E),y=0;let e;if(9===r.charCodeAt(v)){e=c-b%c|0,!n||e>1?t.write1(8594):t.write1(65515);for(let i=2;i<=e;i++)t.write1(160)}else e=1,t.write1(p);S+=e,v>=d&&(b+=e)}w=e}else{let e=0;for(t.appendASCII(62);v<a;v++){_.setColumnInfo(v+1,L-y,S,E),y=0;const i=r.charCodeAt(v);let n=1,o=1;switch(i){case 9:n=c-b%c,o=n;for(let e=1;e<=n;e++)t.write1(160);break;case 32:t.write1(160);break;case 60:t.appendASCIIString("&lt;");break;case 62:t.appendASCIIString("&gt;");break;case 38:t.appendASCIIString("&amp;");break;case 0:f?t.write1(9216):t.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:t.write1(65533);break;default:isFullWidthCharacter(i)&&o++,f&&i<32?t.write1(9216+i):f&&127===i?t.write1(9249):f&&isControlCharacter(i)?(t.appendASCIIString("[U+"),t.appendASCIIString(to4CharHex(i)),t.appendASCIIString("]"),n=8):t.write1(i)}S+=n,e+=n,v>=d&&(b+=o)}w=e}D?y++:y=0,v>=s&&!C&&e.isPseudoAfter()&&(C=!0,_.setColumnInfo(v+1,L,S,E)),t.appendASCIIString("</span>")}return C||_.setColumnInfo(s+1,l.length-1,S,E),a&&t.appendASCIIString("<span>&hellip;</span>"),t.appendASCIIString("</span>"),new RenderLineOutput(_,u,o)}function to4CharHex(e){return e.toString(16).toUpperCase().padStart(4,"0")}const canUseFastRenderedViewLine=!!isNative||!(isLinux||isFirefox||isSafari);let monospaceAssumptionsAreValid=!0;class DomReadingContext{constructor(e,t){this._domNode=e,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1,this.endNode=t}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}}class ViewLineOptions{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(44);this.renderWhitespace=i.get(88),this.renderControlCharacters=i.get(83),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(29),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(59),this.stopRenderingLineAfter=i.get(105),this.fontLigatures=i.get(45)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}class ViewLine{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(!this._renderedViewLine)throw new Error("I have no rendered view line to set the dom node to...");this._renderedViewLine.domNode=createFastDomNode(e)}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return(this._options.themeType===ColorScheme.HIGH_CONTRAST||"selection"===this._options.renderWhitespace)&&(this._isMaybeInvalid=!0,!0)}renderLine(e,t,i,n){if(!1===this._isMaybeInvalid)return!1;this._isMaybeInvalid=!1;const o=i.getViewLineRenderingData(e),r=this._options,s=LineDecoration.filter(o.inlineDecorations,e,o.minColumn,o.maxColumn);let a=null;if(r.themeType===ColorScheme.HIGH_CONTRAST||"selection"===this._options.renderWhitespace){const t=i.selections;for(const i of t){if(i.endLineNumber<e||i.startLineNumber>e)continue;const t=i.startLineNumber===e?i.startColumn:o.minColumn,n=i.endLineNumber===e?i.endColumn:o.maxColumn;t<n&&(r.themeType===ColorScheme.HIGH_CONTRAST||"selection"!==this._options.renderWhitespace?s.push(new LineDecoration(t,n,"inline-selected-text",0)):(a||(a=[]),a.push(new LineRange(t-1,n-1))))}}const l=new RenderLineInput(r.useMonospaceOptimizations,r.canUseHalfwidthRightwardsArrow,o.content,o.continuesWithWrappedLine,o.isBasicASCII,o.containsRTL,o.minColumn-1,o.tokens,s,o.tabSize,o.startVisibleColumn,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==EditorFontLigatures.OFF,a);if(this._renderedViewLine&&this._renderedViewLine.input.equals(l))return!1;n.appendASCIIString('<div style="top:'),n.appendASCIIString(String(t)),n.appendASCIIString("px;height:"),n.appendASCIIString(String(this._options.lineHeight)),n.appendASCIIString('px;" class="'),n.appendASCIIString(ViewLine.CLASS_NAME),n.appendASCIIString('">');const d=renderViewLine(l,n);n.appendASCIIString("</div>");let c=null;return monospaceAssumptionsAreValid&&canUseFastRenderedViewLine&&o.isBasicASCII&&r.useMonospaceOptimizations&&0===d.containsForeignElements&&o.content.length<300&&l.lineTokens.getCount()<100&&(c=new FastRenderedViewLine(this._renderedViewLine?this._renderedViewLine.domNode:null,l,d.characterMapping)),c||(c=createRenderedLine(this._renderedViewLine?this._renderedViewLine.domNode:null,l,d.characterMapping,d.containsRTL,d.containsForeignElements)),this._renderedViewLine=c,!0}layoutLine(e,t){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(this._options.lineHeight))}getWidth(){return this._renderedViewLine?this._renderedViewLine.getWidth():0}getWidthIsFast(){return!this._renderedViewLine||this._renderedViewLine.getWidthIsFast()}needsMonospaceFontCheck(){return!!this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine?this._renderedViewLine.monospaceAssumptionsAreValid():monospaceAssumptionsAreValid}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof FastRenderedViewLine&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const o=this._renderedViewLine.input.stopRenderingLineAfter;let r=!1;-1!==o&&t>o+1&&i>o+1&&(r=!0),-1!==o&&t>o+1&&(t=o+1),-1!==o&&i>o+1&&(i=o+1);const s=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return s&&s.length>0?new VisibleRanges(r,s):null}getColumnOfNodeOffset(e,t,i){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t,i):1}}ViewLine.CLASS_NAME="view-line";class FastRenderedViewLine{constructor(e,t,i){this.domNode=e,this.input=t,this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(){return Math.round(this._getCharPosition(this._characterMapping.length))}getWidthIsFast(){return!0}monospaceAssumptionsAreValid(){if(!this.domNode)return monospaceAssumptionsAreValid;const e=this.getWidth(),t=this.domNode.domNode.firstChild.offsetWidth;return Math.abs(e-t)>=2&&(monospaceAssumptionsAreValid=!1),monospaceAssumptionsAreValid}toSlowRenderedLine(){return createRenderedLine(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,n){const o=this._getCharPosition(t),r=this._getCharPosition(i);return[new FloatHorizontalRange(o,r-o)]}_getCharPosition(e){const t=this._characterMapping.getAbsoluteOffset(e);return this._charWidth*t}getColumnOfNodeOffset(e,t,i){const n=t.textContent.length;let o=-1;for(;t;)t=t.previousSibling,o++;return this._characterMapping.getColumn(new DomPosition(o,i),n)}}class RenderedViewLine{constructor(e,t,i,n,o){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=o,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||0===this._characterMapping.length){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let e=0,t=this._characterMapping.length;e<=t;e++)this._pixelOffsetCache[e]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(){return this.domNode?(-1===this._cachedWidth&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth),this._cachedWidth):0}getWidthIsFast(){return-1!==this._cachedWidth}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(null!==this._pixelOffsetCache){const o=this._readPixelOffset(this.domNode,e,t,n);if(-1===o)return null;const r=this._readPixelOffset(this.domNode,e,i,n);return-1===r?null:[new FloatHorizontalRange(o,r-o)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,o){if(i===n){const n=this._readPixelOffset(e,t,i,o);return-1===n?null:[new FloatHorizontalRange(n,0)]}return this._readRawVisibleRangesForRange(e,i,n,o)}_readPixelOffset(e,t,i,n){if(0===this._characterMapping.length){if(0===this._containsForeignElements)return 0;if(2===this._containsForeignElements)return 0;if(1===this._containsForeignElements)return this.getWidth();const t=this._getReadingTarget(e);return t.firstChild?t.firstChild.offsetWidth:0}if(null!==this._pixelOffsetCache){const o=this._pixelOffsetCache[i];if(-1!==o)return o;const r=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=r,r}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(0===this._characterMapping.length){const t=RangeUtil.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n.clientRectDeltaLeft,n.clientRectScale,n.endNode);return t&&0!==t.length?t[0].left:-1}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&0===this._containsForeignElements)return this.getWidth();const o=this._characterMapping.getDomPosition(i),r=RangeUtil.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,o.partIndex,o.charIndex,n.clientRectDeltaLeft,n.clientRectScale,n.endNode);if(!r||0===r.length)return-1;const s=r[0].left;if(this.input.isBasicASCII){const e=this._characterMapping.getAbsoluteOffset(i),t=Math.round(this.input.spaceWidth*e);if(Math.abs(t-s)<=1)return t}return s}_readRawVisibleRangesForRange(e,t,i,n){if(1===t&&i===this._characterMapping.length)return[new FloatHorizontalRange(0,this.getWidth())];const o=this._characterMapping.getDomPosition(t),r=this._characterMapping.getDomPosition(i);return RangeUtil.readHorizontalRanges(this._getReadingTarget(e),o.partIndex,o.charIndex,r.partIndex,r.charIndex,n.clientRectDeltaLeft,n.clientRectScale,n.endNode)}getColumnOfNodeOffset(e,t,i){const n=t.textContent.length;let o=-1;for(;t;)t=t.previousSibling,o++;return this._characterMapping.getColumn(new DomPosition(o,i),n)}}class WebKitRenderedViewLine extends RenderedViewLine{_readVisibleRangesForRange(e,t,i,n,o){const r=super._readVisibleRangesForRange(e,t,i,n,o);if(!r||0===r.length||i===n||1===i&&n===this._characterMapping.length)return r;if(!this.input.containsRTL){const i=this._readPixelOffset(e,t,n,o);if(-1!==i){const e=r[r.length-1];e.left<i&&(e.width=i-e.left)}}return r}}const createRenderedLine=isWebKit?createWebKitRenderedLine:createNormalRenderedLine;function createWebKitRenderedLine(e,t,i,n,o){return new WebKitRenderedViewLine(e,t,i,n,o)}function createNormalRenderedLine(e,t,i,n,o){return new RenderedViewLine(e,t,i,n,o)}class UnknownHitTestResult{constructor(e=null){this.hitTarget=e,this.type=0}}class ContentHitTestResult{constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var HitTestResult;(HitTestResult||(HitTestResult={})).createFromDOMInfo=function(e,t,i){const n=e.getPositionFromDOMInfo(t,i);return n?new ContentHitTestResult(n,t,null):new UnknownHitTestResult(t)};class PointerHandlerLastRenderData{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class MouseTarget{static _deduceRage(e,t=null){return!t&&e?new Range$2(e.lineNumber,e.column,e.lineNumber,e.column):null!=t?t:null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,o,r){return{type:e,element:t,mouseColumn:i,position:n,range:o,detail:r}}static createViewZone(e,t,i,n,o){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:o}}static createContentText(e,t,i,n,o){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:o}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t)}}static _typeToString(e){return 1===e?"TEXTAREA":2===e?"GUTTER_GLYPH_MARGIN":3===e?"GUTTER_LINE_NUMBERS":4===e?"GUTTER_LINE_DECORATIONS":5===e?"GUTTER_VIEW_ZONE":6===e?"CONTENT_TEXT":7===e?"CONTENT_EMPTY":8===e?"CONTENT_VIEW_ZONE":9===e?"CONTENT_WIDGET":10===e?"OVERVIEW_RULER":11===e?"SCROLLBAR":12===e?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class ElementPath{static isTextArea(e){return 2===e.length&&3===e[0]&&6===e[1]}static isChildOfViewLines(e){return e.length>=4&&3===e[0]&&7===e[3]}static isStrictChildOfViewLines(e){return e.length>4&&3===e[0]&&7===e[3]}static isChildOfScrollableElement(e){return e.length>=2&&3===e[0]&&5===e[1]}static isChildOfMinimap(e){return e.length>=2&&3===e[0]&&8===e[1]}static isChildOfContentWidgets(e){return e.length>=4&&3===e[0]&&1===e[3]}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&2===e[0]}static isChildOfOverlayWidgets(e){return e.length>=2&&3===e[0]&&4===e[1]}}class HitTestContext{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(131),this.viewDomNode=t.viewDomNode,this.lineHeight=n.get(59),this.stickyTabStops=n.get(104),this.typicalHalfwidthCharacterWidth=n.get(44).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return HitTestContext.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,o=e.viewModel.getLineCount();let r,s=null,a=null;return i.afterLineNumber!==o&&(a=new Position$1(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(s=new Position$1(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),r=null===a?s:null===s?a:t<n?s:a,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:s,positionAfter:a,position:r}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const e=this._context.viewModel.getLineCount(),t=this._context.viewModel.getLineMaxColumn(e);return{range:new Range$2(e,t,e,t),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new Range$2(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return HitTestContext._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==document.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class BareHitTestRequest{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class HitTestRequest extends BareHitTestRequest{constructor(e,t,i,n,o){super(e,t,i,n),this._ctx=e,o?(this.target=o,this.targetPath=PartFingerprints.collect(o,e.viewDomNode)):(this.target=null,this.targetPath=new Uint8Array(0))}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\n\ttarget: ${this.target?this.target.outerHTML:null}`}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return MouseTarget.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return MouseTarget.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return MouseTarget.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return MouseTarget.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return MouseTarget.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return MouseTarget.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return MouseTarget.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return MouseTarget.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return MouseTarget.createOverlayWidget(this.target,this._getMouseColumn(),e)}withTarget(e){return new HitTestRequest(this._ctx,this.editorPos,this.pos,this.relativePos,e)}}const EMPTY_CONTENT_AFTER_LINES={isAfterLines:!0};function createEmptyContentDataInLines(e){return{isAfterLines:!1,horizontalDistanceToText:e}}class MouseTargetFactory{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=PartFingerprints.collect(t,this._viewHelper.viewDomNode);return!(!ElementPath.isChildOfContentWidgets(i)&&!ElementPath.isChildOfOverflowingContentWidgets(i))||!!ElementPath.isChildOfOverlayWidgets(i)}createMouseTarget(e,t,i,n,o){const r=new HitTestContext(this._context,this._viewHelper,e),s=new HitTestRequest(r,t,i,n,o);try{return MouseTargetFactory._createMouseTarget(r,s,!1)}catch(a){return s.fulfillUnknown()}}static _createMouseTarget(e,t,i){if(null===t.target){if(i)return t.fulfillUnknown();const n=MouseTargetFactory._doHitTest(e,t);return 1===n.type?MouseTargetFactory.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):this._createMouseTarget(e,t.withTarget(n.hitTarget),!0)}const n=t;let o=null;return o=o||MouseTargetFactory._hitTestContentWidget(e,n),o=o||MouseTargetFactory._hitTestOverlayWidget(e,n),o=o||MouseTargetFactory._hitTestMinimap(e,n),o=o||MouseTargetFactory._hitTestScrollbarSlider(e,n),o=o||MouseTargetFactory._hitTestViewZone(e,n),o=o||MouseTargetFactory._hitTestMargin(e,n),o=o||MouseTargetFactory._hitTestViewCursor(e,n),o=o||MouseTargetFactory._hitTestTextArea(e,n),o=o||MouseTargetFactory._hitTestViewLines(e,n,i),o=o||MouseTargetFactory._hitTestScrollbar(e,n),o||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(ElementPath.isChildOfContentWidgets(t.targetPath)||ElementPath.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(ElementPath.isChildOfOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const e of i)if(t.target===e.domNode)return t.fulfillContentText(e.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,o=t.mouseVerticalOffset;for(const r of i){if(n<r.contentLeft)continue;if(n>r.contentLeft+r.width)continue;const i=e.getVerticalOffsetForLineNumber(r.position.lineNumber);if(i<=o&&o<=i+r.height)return t.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const e=t.isInContentArea?8:5;return t.fulfillViewZone(e,i.position,i)}return null}static _hitTestTextArea(e,t){return ElementPath.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let o=Math.abs(t.relativePos.x);const r={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:o};return o-=e.layoutInfo.glyphMarginLeft,o<=e.layoutInfo.glyphMarginWidth?t.fulfillMargin(2,n,i.range,r):(o-=e.layoutInfo.glyphMarginWidth,o<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,r):(o-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,r)))}return null}static _hitTestViewLines(e,t,i){if(!ElementPath.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new Position$1(1,1),EMPTY_CONTENT_AFTER_LINES);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const i=e.viewModel.getLineCount(),n=e.viewModel.getLineMaxColumn(i);return t.fulfillContentEmpty(new Position$1(i,n),EMPTY_CONTENT_AFTER_LINES)}if(i){if(ElementPath.isStrictChildOfViewLines(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(0===e.viewModel.getLineLength(i)){const n=e.getLineWidth(i),o=createEmptyContentDataInLines(t.mouseContentHorizontalOffset-n);return t.fulfillContentEmpty(new Position$1(i,1),o)}const n=e.getLineWidth(i);if(t.mouseContentHorizontalOffset>=n){const o=createEmptyContentDataInLines(t.mouseContentHorizontalOffset-n),r=new Position$1(i,e.viewModel.getLineMaxColumn(i));return t.fulfillContentEmpty(r,o)}}return t.fulfillUnknown()}const n=MouseTargetFactory._doHitTest(e,t);return 1===n.type?MouseTargetFactory.createMouseTargetFromHitTestPosition(e,t,n.spanNode,n.position,n.injectedText):this._createMouseTarget(e,t.withTarget(n.hitTarget),!0)}static _hitTestMinimap(e,t){if(ElementPath.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new Position$1(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(ElementPath.isChildOfScrollableElement(t.targetPath)&&t.target&&1===t.target.nodeType){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new Position$1(i,n))}}return null}static _hitTestScrollbar(e,t){if(ElementPath.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new Position$1(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(131),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return MouseTargetFactory._getMouseColumn(n,t.get(44).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){if(e<0)return 1;return Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,o){const r=n.lineNumber,s=n.column,a=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>a){const e=createEmptyContentDataInLines(t.mouseContentHorizontalOffset-a);return t.fulfillContentEmpty(n,e)}const l=e.visibleRangeForPosition(r,s);if(!l)return t.fulfillUnknown(n);const d=l.left;if(t.mouseContentHorizontalOffset===d)return t.fulfillContentText(n,null,{mightBeForeignElement:!!o,injectedText:o});const c=[];if(c.push({offset:l.left,column:s}),s>1){const t=e.visibleRangeForPosition(r,s-1);t&&c.push({offset:t.left,column:s-1})}if(s<e.viewModel.getLineMaxColumn(r)){const t=e.visibleRangeForPosition(r,s+1);t&&c.push({offset:t.left,column:s+1})}c.sort(((e,t)=>e.offset-t.offset));const h=t.pos.toClientCoordinates(),u=i.getBoundingClientRect(),g=u.left<=h.clientX&&h.clientX<=u.right;for(let p=1;p<c.length;p++){const e=c[p-1],i=c[p];if(e.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=i.offset){const s=new Range$2(r,e.column,r,i.column);return t.fulfillContentText(n,s,{mightBeForeignElement:!g||!!o,injectedText:o})}}return t.fulfillContentText(n,null,{mightBeForeignElement:!g||!!o,injectedText:o})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i)+Math.floor(e.lineHeight/2);let o=t.pos.y+(n-t.mouseVerticalOffset);o<=t.editorPos.y&&(o=t.editorPos.y+1),o>=t.editorPos.y+t.editorPos.height&&(o=t.editorPos.y+t.editorPos.height-1);const r=new PageCoordinates(t.pos.x,o),s=this._actualDoHitTestWithCaretRangeFromPoint(e,r.toClientCoordinates());return 1===s.type?s:this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates())}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=getShadowRoot(e.viewDomNode);let n;if(n=i?void 0===i.caretRangeFromPoint?shadowCaretRangeFromPoint(i,t.clientX,t.clientY):i.caretRangeFromPoint(t.clientX,t.clientY):document.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new UnknownHitTestResult;const o=n.startContainer;if(o.nodeType===o.TEXT_NODE){const t=o.parentNode,i=t?t.parentNode:null,r=i?i.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(e,t,n.startOffset):new UnknownHitTestResult(o.parentNode)}if(o.nodeType===o.ELEMENT_NODE){const t=o.parentNode,i=t?t.parentNode:null;return(i&&i.nodeType===i.ELEMENT_NODE?i.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(e,o,o.textContent.length):new UnknownHitTestResult(o)}return new UnknownHitTestResult}static _doHitTestWithCaretPositionFromPoint(e,t){const i=document.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const t=i.offsetNode.parentNode,n=t?t.parentNode:null,o=n?n.parentNode:null;return(o&&o.nodeType===o.ELEMENT_NODE?o.className:null)===ViewLine.CLASS_NAME?HitTestResult.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new UnknownHitTestResult(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const t=i.offsetNode.parentNode,n=t&&t.nodeType===t.ELEMENT_NODE?t.className:null,o=t?t.parentNode:null,r=o&&o.nodeType===o.ELEMENT_NODE?o.className:null;if(n===ViewLine.CLASS_NAME){const t=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(t)return HitTestResult.createFromDOMInfo(e,t,0)}else if(r===ViewLine.CLASS_NAME)return HitTestResult.createFromDOMInfo(e,i.offsetNode,0)}return new UnknownHitTestResult(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),o=AtomicTabMoveOperations.atomicPosition(i,e.column-1,n,2);return-1!==o?new Position$1(e.lineNumber,o+1):e}static _doHitTest(e,t){let i=new UnknownHitTestResult;if("function"==typeof document.caretRangeFromPoint?i=this._doHitTestWithCaretRangeFromPoint(e,t):document.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates())),1===i.type){const t=e.viewModel.getInjectedTextAt(i.position),n=e.viewModel.normalizePosition(i.position,2);!t&&n.equals(i.position)||(i=new ContentHitTestResult(n,i.spanNode,t))}return 1===i.type&&e.stickyTabStops&&(i=new ContentHitTestResult(this._snapToSoftTabBoundary(i.position,e.viewModel),i.spanNode,i.injectedText)),i}}function shadowCaretRangeFromPoint(e,t,i){const n=document.createRange();let o=e.elementFromPoint(t,i);if(null!==o){for(;o&&o.firstChild&&o.firstChild.nodeType!==o.firstChild.TEXT_NODE&&o.lastChild&&o.lastChild.firstChild;)o=o.lastChild;const e=o.getBoundingClientRect(),i=window.getComputedStyle(o,null).getPropertyValue("font"),r=o.innerText;let s,a=e.left,l=0;if(t>e.left+e.width)l=r.length;else{const e=CharWidthReader.getInstance();for(let n=0;n<r.length+1;n++){if(s=e.getCharWidth(r.charAt(n),i)/2,a+=s,t<a){l=n;break}a+=s}}n.setStart(o.firstChild,l),n.setEnd(o.firstChild,l)}return n}class CharWidthReader{constructor(){this._cache={},this._canvas=document.createElement("canvas")}static getInstance(){return CharWidthReader._INSTANCE||(CharWidthReader._INSTANCE=new CharWidthReader),CharWidthReader._INSTANCE}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const o=n.measureText(e).width;return this._cache[i]=o,o}}function createMouseMoveEventMerger(e){return function(t,i){let n=!1;return e&&(n=e.mouseTargetIsWidget(i)),n||i.preventDefault(),i}}CharWidthReader._INSTANCE=null;class MouseHandler extends ViewEventHandler{constructor(e,t,i){super(),this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new MouseTargetFactory(this._context,i),this._mouseDownOperation=this._register(new MouseDownOperation(this._context,this.viewController,this.viewHelper,((e,t)=>this._createMouseTarget(e,t)),(e=>this._getMouseColumn(e)))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(131).height;const n=new EditorMouseEventFactory(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,(e=>this._onContextMenu(e,!0)))),this._register(n.onMouseMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),createMouseMoveEventMerger(this.mouseTargetFactory),MouseHandler.MOUSE_MOVE_MINIMUM_TIME)),this._register(n.onMouseUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(n.onMouseDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))));this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.MOUSE_WHEEL,(e=>{if(this.viewController.emitMouseWheel(e),!this._context.configuration.options.get(68))return;const t=new StandardWheelEvent(e);if(isMacintosh?(e.metaKey||e.ctrlKey)&&!e.shiftKey&&!e.altKey:e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){const e=EditorZoom.getZoomLevel(),i=t.deltaY>0?1:-1;EditorZoom.setZoomLevel(e+i),t.preventDefault(),t.stopPropagation()}}),{capture:!0,passive:!1})),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(131)){const e=this._context.configuration.options.get(131).height;this._height!==e&&(this._height=e,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}onScrollChanged(e){return this._mouseDownOperation.onScrollChanged(),!1}getTargetAtClientPoint(e,t){const i=new ClientCoordinates(e,t).toPageCoordinates(),n=createEditorPagePosition(this.viewHelper.viewDomNode);if(i.y<n.y||i.y>n.y+n.height||i.x<n.x||i.x>n.x+n.width)return null;const o=createCoordinatesRelativeToEditor(this.viewHelper.viewDomNode,n,i);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),n,i,o,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const t=getShadowRoot(this.viewHelper.viewDomNode);t&&(i=t.elementsFromPoint(e.posx,e.posy).find((e=>this.viewHelper.viewDomNode.contains(e))))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){if(this._mouseDownOperation.isActive())return;e.timestamp<this.lastMouseLeaveTime||this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this.lastMouseLeaveTime=(new Date).getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e){const t=this._createMouseTarget(e,!0),i=6===t.type||7===t.type,n=2===t.type||3===t.type||4===t.type,o=3===t.type,r=this._context.configuration.options.get(98),s=8===t.type||5===t.type,a=9===t.type;let l=e.leftButton||e.middleButton;isMacintosh&&e.leftButton&&e.ctrlKey&&(l=!1);const d=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(l&&(i||o&&r))d(),this._mouseDownOperation.start(t.type,e);else if(n)e.preventDefault();else if(s){const i=t.detail;this.viewHelper.shouldSuppressMouseDownOnViewZone(i.viewZoneId)&&(d(),this._mouseDownOperation.start(t.type,e),e.preventDefault())}else a&&this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)&&(d(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:t})}}MouseHandler.MOUSE_MOVE_MINIMUM_TIME=100;class MouseDownOperation extends Disposable{constructor(e,t,i,n,o){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._createMouseTarget=n,this._getMouseColumn=o,this._mouseMoveMonitor=this._register(new GlobalEditorMouseMoveMonitor(this._viewHelper.viewDomNode)),this._onScrollTimeout=this._register(new TimeoutTimer),this._mouseState=new MouseDownState,this._currentSelection=new Selection$1(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!0);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):this._dispatchMouse(t,!0))}start(e,t){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(3===e),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const i=this._findMousePosition(t,!0);if(!i||!i.position)return;this._mouseState.trySetCount(t.detail,i.position),t.detail=this._mouseState.count;const n=this._context.configuration.options;if(!n.get(81)&&n.get(31)&&!n.get(18)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&6===i.type&&i.position&&this._currentSelection.containsPosition(i.position))return this._mouseState.isDragAndDrop=!0,this._isActive=!0,void this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,createMouseMoveEventMerger(null),(e=>this._onMouseDownThenMove(e)),(e=>{const t=this._findMousePosition(this._lastMouseEvent,!0);e&&e instanceof KeyboardEvent?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:t?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()}));this._mouseState.isDragAndDrop=!1,this._dispatchMouse(i,t.shiftKey),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(t.target,t.buttons,createMouseMoveEventMerger(null),(e=>this._onMouseDownThenMove(e)),(()=>this._stop())))}_stop(){this._isActive=!1,this._onScrollTimeout.cancel()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onScrollChanged(){this._isActive&&this._onScrollTimeout.setIfNotSet((()=>{if(!this._lastMouseEvent)return;const e=this._findMousePosition(this._lastMouseEvent,!1);e&&(this._mouseState.isDragAndDrop||this._dispatchMouse(e,!0))}),10)}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,o=this._getMouseColumn(e);if(e.posy<t.y){const i=Math.max(n.getCurrentScrollTop()-(t.y-e.posy),0),r=HitTestContext.getZoneAtCoord(this._context,i);if(r){const e=this._helpPositionJumpOverViewZone(r);if(e)return MouseTarget.createOutsideEditor(o,e)}const s=n.getLineNumberAtVerticalOffset(i);return MouseTarget.createOutsideEditor(o,new Position$1(s,1))}if(e.posy>t.y+t.height){const t=n.getCurrentScrollTop()+e.relativePos.y,r=HitTestContext.getZoneAtCoord(this._context,t);if(r){const e=this._helpPositionJumpOverViewZone(r);if(e)return MouseTarget.createOutsideEditor(o,e)}const s=n.getLineNumberAtVerticalOffset(t);return MouseTarget.createOutsideEditor(o,new Position$1(s,i.getLineMaxColumn(s)))}const r=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y);return e.posx<t.x?MouseTarget.createOutsideEditor(o,new Position$1(r,1)):e.posx>t.x+t.width?MouseTarget.createOutsideEditor(o,new Position$1(r,i.getLineMaxColumn(r))):null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(8===n.type||5===n.type){const e=this._helpPositionJumpOverViewZone(n.detail);if(e)return MouseTarget.createViewZone(n.type,n.element,n.mouseColumn,e,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new Position$1(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:6===e.type&&null!==e.detail.injectedText})}}class MouseDownState{constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=(new Date).getTime();i-this._lastSetMouseDownCountTime>MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}}var Mimes,Mimes2,TextAreaSyntethicEvents;MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME=400,Mimes2=Mimes||(Mimes={}),Mimes2.text="text/plain",Mimes2.binary="application/octet-stream",Mimes2.unknown="application/unknown",Mimes2.markdown="text/markdown",Mimes2.latex="text/latex",Mimes2.uriList="text/uri-list";class TextAreaState{constructor(e,t,i,n,o){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selectionStartPosition=n,this.selectionEndPosition=o}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e){return new TextAreaState(e.getValue(),e.getSelectionStart(),e.getSelectionEnd(),null,null)}collapseSelection(){return new TextAreaState(this.value,this.value.length,this.value.length,null,null)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const t=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selectionStartPosition,t,-1)}if(e>=this.selectionEnd){const t=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selectionEndPosition,t,1)}const t=this.value.substring(this.selectionStart,e);if(-1===t.indexOf(String.fromCharCode(8230)))return this._finishDeduceEditorPosition(this.selectionStartPosition,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selectionEndPosition,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,o=-1;for(;-1!==(o=t.indexOf("\n",o+1));)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(commonPrefixLength(e.value,t.value),e.selectionStart,t.selectionStart),o=Math.min(commonSuffixLength(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-o);const r=t.value.substring(n,t.value.length-o),s=e.selectionStart-n,a=e.selectionEnd-n;if(t.selectionStart-n===t.selectionEnd-n){return{text:r,replacePrevCharCnt:e.selectionStart-n,replaceNextCharCnt:0,positionDelta:0}}return{text:r,replacePrevCharCnt:a-s,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(commonPrefixLength(e.value,t.value),e.selectionEnd),n=Math.min(commonSuffixLength(e.value,t.value),e.value.length-e.selectionEnd),o=e.value.substring(i,e.value.length-n),r=t.value.substring(i,t.value.length-n);e.selectionStart;const s=e.selectionEnd-i;t.selectionStart;const a=t.selectionEnd-i;return{text:r,replacePrevCharCnt:s,replaceNextCharCnt:o.length-s,positionDelta:a-r.length}}}TextAreaState.EMPTY=new TextAreaState("",0,0,null,null);class PagedScreenReaderStrategy{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t;return new Range$2(i+1,1,i+t+1,1)}static fromEditorSelection(e,t,i,n,o){const r=PagedScreenReaderStrategy._getPageOfLine(i.startLineNumber,n),s=PagedScreenReaderStrategy._getRangeForPage(r,n),a=PagedScreenReaderStrategy._getPageOfLine(i.endLineNumber,n),l=PagedScreenReaderStrategy._getRangeForPage(a,n),d=s.intersectRanges(new Range$2(1,1,i.startLineNumber,i.startColumn));let c=t.getValueInRange(d,1);const h=t.getLineCount(),u=t.getLineMaxColumn(h),g=l.intersectRanges(new Range$2(i.endLineNumber,i.endColumn,h,u));let p,m=t.getValueInRange(g,1);if(r===a||r+1===a)p=t.getValueInRange(i,1);else{const e=s.intersectRanges(i),n=l.intersectRanges(i);p=t.getValueInRange(e,1)+String.fromCharCode(8230)+t.getValueInRange(n,1)}if(o){const e=500;c.length>e&&(c=c.substring(c.length-e,c.length)),m.length>e&&(m=m.substring(0,e)),p.length>2*e&&(p=p.substring(0,e)+String.fromCharCode(8230)+p.substring(p.length-e,p.length))}return new TextAreaState(c+p+m,c.length,c.length+p.length,new Position$1(i.startLineNumber,i.startColumn),new Position$1(i.endLineNumber,i.endColumn))}}(TextAreaSyntethicEvents||(TextAreaSyntethicEvents={})).Tap="-monaco-textarea-synthetic-tap";const CopyOptions={forceCopyWithSyntaxHighlighting:!1};class InMemoryClipboardMetadataManager{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}}InMemoryClipboardMetadataManager.INSTANCE=new InMemoryClipboardMetadataManager;class CompositionContext{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){const t={text:e=e||"",replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}class TextAreaInput extends Disposable{constructor(e,t,i,n){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._onFocus=this._register(new Emitter$1),this.onFocus=this._onFocus.event,this._onBlur=this._register(new Emitter$1),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new Emitter$1),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new Emitter$1),this.onCut=this._onCut.event,this._onPaste=this._register(new Emitter$1),this.onPaste=this._onPaste.event,this._onType=this._register(new Emitter$1),this.onType=this._onType.event,this._onCompositionStart=this._register(new Emitter$1),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new Emitter$1),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new Emitter$1),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new Emitter$1),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncTriggerCut=this._register(new RunOnceScheduler((()=>this._onCut.fire()),0)),this._asyncFocusGainWriteScreenReaderContent=this._register(new RunOnceScheduler((()=>this.writeScreenReaderContent("asyncFocusGain")),0)),this._textAreaState=TextAreaState.EMPTY,this._selectionChangeListener=null,this.writeScreenReaderContent("ctor"),this._hasFocus=!1,this._currentComposition=null;let o=null;this._register(this._textArea.onKeyDown((e=>{const t=new StandardKeyboardEvent(e);(109===t.keyCode||this._currentComposition&&1===t.keyCode)&&t.stopPropagation(),t.equals(9)&&t.preventDefault(),o=t,this._onKeyDown.fire(t)}))),this._register(this._textArea.onKeyUp((e=>{const t=new StandardKeyboardEvent(e);this._onKeyUp.fire(t)}))),this._register(this._textArea.onCompositionStart((e=>{const t=new CompositionContext;if(this._currentComposition)this._currentComposition=t;else{if(this._currentComposition=t,2===this._OS&&o&&o.equals(109)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===e.data&&("ArrowRight"===o.code||"ArrowLeft"===o.code))return t.handleCompositionUpdate("x"),void this._onCompositionStart.fire({data:e.data});this._browser.isAndroid,this._onCompositionStart.fire({data:e.data})}}))),this._register(this._textArea.onCompositionUpdate((e=>{const t=this._currentComposition;if(!t)return;if(this._browser.isAndroid){const t=TextAreaState.readFromTextArea(this._textArea),i=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,t);return this._textAreaState=t,this._onType.fire(i),void this._onCompositionUpdate.fire(e)}const i=t.handleCompositionUpdate(e.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea),this._onType.fire(i),this._onCompositionUpdate.fire(e)}))),this._register(this._textArea.onCompositionEnd((e=>{const t=this._currentComposition;if(!t)return;if(this._currentComposition=null,this._browser.isAndroid){const e=TextAreaState.readFromTextArea(this._textArea),t=TextAreaState.deduceAndroidCompositionInput(this._textAreaState,e);return this._textAreaState=e,this._onType.fire(t),void this._onCompositionEnd.fire()}const i=t.handleCompositionUpdate(e.data);this._textAreaState=TextAreaState.readFromTextArea(this._textArea),this._onType.fire(i),this._onCompositionEnd.fire()}))),this._register(this._textArea.onInput((e=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const t=TextAreaState.readFromTextArea(this._textArea),i=TextAreaState.deduceInput(this._textAreaState,t,2===this._OS);0===i.replacePrevCharCnt&&1===i.text.length&&isHighSurrogate(i.text.charCodeAt(0))||(this._textAreaState=t,""===i.text&&0===i.replacePrevCharCnt&&0===i.replaceNextCharCnt&&0===i.positionDelta||this._onType.fire(i))}))),this._register(this._textArea.onCut((e=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(e),this._asyncTriggerCut.schedule()}))),this._register(this._textArea.onCopy((e=>{this._ensureClipboardGetsEditorSelection(e)}))),this._register(this._textArea.onPaste((e=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),e.preventDefault(),!e.clipboardData)return;let[t,i]=ClipboardEventUtils.getTextData(e.clipboardData);t&&(i=i||InMemoryClipboardMetadataManager.INSTANCE.get(t),this._onPaste.fire({text:t,metadata:i}))}))),this._register(this._textArea.onFocus((()=>{const e=this._hasFocus;this._setHasFocus(!0),this._browser.isSafari&&!e&&this._hasFocus&&this._asyncFocusGainWriteScreenReaderContent.schedule()}))),this._register(this._textArea.onBlur((()=>{this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)}))),this._register(this._textArea.onSyntheticTap((()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeScreenReaderContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())})))}_installSelectionChangeListener(){let e=0;return addDisposableListener(document,"selectionchange",(t=>{if(!this._hasFocus)return;if(this._currentComposition)return;if(!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const o=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),o<100)return;if(!this._textAreaState.selectionStartPosition||!this._textAreaState.selectionEndPosition)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const s=this._textArea.getSelectionStart(),a=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===s&&this._textAreaState.selectionEnd===a)return;const l=this._textAreaState.deduceEditorPosition(s),d=this._host.deduceModelPosition(l[0],l[1],l[2]),c=this._textAreaState.deduceEditorPosition(a),h=this._host.deduceModelPosition(c[0],c[1],c[2]),u=new Selection$1(d.lineNumber,d.column,h.lineNumber,h.column);this._onSelectionChangeRequest.fire(u)}))}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeScreenReaderContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeScreenReaderContent(e){this._currentComposition||this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent(this._textAreaState))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};InMemoryClipboardMetadataManager.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,"\n"):t.text,i),e.preventDefault(),e.clipboardData&&ClipboardEventUtils.setTextData(e.clipboardData,t.text,t.html,i)}}class ClipboardEventUtils{static getTextData(e){const t=e.getData(Mimes.text);let i=null;const n=e.getData("vscode-editor-data");if("string"==typeof n)try{i=JSON.parse(n),1!==i.version&&(i=null)}catch(o){}return[t,i]}static setTextData(e,t,i,n){e.setData(Mimes.text,t),"string"==typeof i&&e.setData("text/html",i),e.setData("vscode-editor-data",JSON.stringify(n))}}class TextAreaWrapper extends Disposable{constructor(e){super(),this._actual=e,this.onKeyDown=this._register(createEventEmitter(this._actual,"keydown")).event,this.onKeyUp=this._register(createEventEmitter(this._actual,"keyup")).event,this.onCompositionStart=this._register(createEventEmitter(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(createEventEmitter(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(createEventEmitter(this._actual,"compositionend")).event,this.onInput=this._register(createEventEmitter(this._actual,"input")).event,this.onCut=this._register(createEventEmitter(this._actual,"cut")).event,this.onCopy=this._register(createEventEmitter(this._actual,"copy")).event,this.onPaste=this._register(createEventEmitter(this._actual,"paste")).event,this.onFocus=this._register(createEventEmitter(this._actual,"focus")).event,this.onBlur=this._register(createEventEmitter(this._actual,"blur")).event,this._onSyntheticTap=this._register(new Emitter$1),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(addDisposableListener(this._actual,TextAreaSyntethicEvents.Tap,(()=>this._onSyntheticTap.fire())))}hasFocus(){const e=getShadowRoot(this._actual);return e?e.activeElement===this._actual:!!isInDOM(this._actual)&&document.activeElement===this._actual}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return"backward"===this._actual.selectionDirection?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return"backward"===this._actual.selectionDirection?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let o=null;const r=getShadowRoot(n);o=r?r.activeElement:document.activeElement;const s=o===n,a=n.selectionStart,l=n.selectionEnd;if(s&&a===t&&l===i)isFirefox&&window.parent!==window&&n.focus();else{if(s)return this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),void(isFirefox&&window.parent!==window&&n.focus());try{const e=saveParentsScrollTop(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),restoreParentsScrollTop(n,e)}catch(e2){}}}}class PointerEventHandler extends MouseHandler{constructor(e,t,i){super(e,t,i),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,(e=>this.onTap(e)))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,(e=>this.onChange(e)))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,(e=>this._onContextMenu(new EditorMouseEvent(e,this.viewHelper.viewDomNode),!1)))),this._lastPointerType="mouse",this._register(addDisposableListener(this.viewHelper.linesContentDomNode,"pointerdown",(e=>{const t=e.pointerType;this._lastPointerType="mouse"!==t?"touch"===t?"touch":"pen":"mouse"})));const n=new EditorPointerEventFactory(this.viewHelper.viewDomNode);this._register(n.onPointerMoveThrottled(this.viewHelper.viewDomNode,(e=>this._onMouseMove(e)),createMouseMoveEventMerger(this.mouseTargetFactory),MouseHandler.MOUSE_MOVE_MINIMUM_TIME)),this._register(n.onPointerUp(this.viewHelper.viewDomNode,(e=>this._onMouseUp(e)))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,(e=>this._onMouseLeave(e)))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(e=>this._onMouseDown(e))))}onTap(e){if(!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget))return;e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new EditorMouseEvent(e,this.viewHelper.viewDomNode),!1);t.position&&this.viewController.dispatchMouse({position:t.position,mouseColumn:t.position.column,startedOnLineNumbers:!1,mouseDownCount:e.tapCount,inSelectionMode:!1,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:6===t.type&&null!==t.detail.injectedText})}onChange(e){"touch"===this._lastPointerType&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}_onMouseDown(e){"touch"!==e.browserEvent.pointerType&&super._onMouseDown(e)}}class TouchHandler extends MouseHandler{constructor(e,t,i){super(e,t,i),this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode)),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Tap,(e=>this.onTap(e)))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Change,(e=>this.onChange(e)))),this._register(addDisposableListener(this.viewHelper.linesContentDomNode,EventType.Contextmenu,(e=>this._onContextMenu(new EditorMouseEvent(e,this.viewHelper.viewDomNode),!1))))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new EditorMouseEvent(e,this.viewHelper.viewDomNode),!1);if(t.position){const e=document.createEvent("CustomEvent");e.initEvent(TextAreaSyntethicEvents.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(e),this.viewController.moveTo(t.position)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class PointerHandler extends Disposable{constructor(e,t,i){super(),isIOS&&BrowserFeatures.pointerEvents?this.handler=this._register(new PointerEventHandler(e,t,i)):window.TouchEvent?this.handler=this._register(new TouchHandler(e,t,i)):this.handler=this._register(new MouseHandler(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}var textAreaHandler="",lineNumbers="";class DynamicViewOverlay extends ViewEventHandler{}const editorLineHighlight=registerColor("editor.lineHighlightBackground",{dark:null,light:null,hc:null},localize("lineHighlight","Background color for the highlight of line at the cursor position.")),editorLineHighlightBorder=registerColor("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hc:"#f38518"},localize("lineHighlightBorderBox","Background color for the border around the line at the cursor position.")),editorRangeHighlight=registerColor("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hc:null},localize("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0),editorRangeHighlightBorder=registerColor("editor.rangeHighlightBorder",{dark:null,light:null,hc:activeContrastBorder},localize("rangeHighlightBorder","Background color of the border around highlighted ranges."),!0),editorSymbolHighlight=registerColor("editor.symbolHighlightBackground",{dark:editorFindMatchHighlight,light:editorFindMatchHighlight,hc:null},localize("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0),editorSymbolHighlightBorder=registerColor("editor.symbolHighlightBorder",{dark:null,light:null,hc:activeContrastBorder},localize("symbolHighlightBorder","Background color of the border around highlighted symbols."),!0),editorCursorForeground=registerColor("editorCursor.foreground",{dark:"#AEAFAD",light:Color.black,hc:Color.white},localize("caret","Color of the editor cursor.")),editorCursorBackground=registerColor("editorCursor.background",null,localize("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),editorWhitespaces=registerColor("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hc:"#e3e4e229"},localize("editorWhitespaces","Color of whitespace characters in the editor.")),editorIndentGuides=registerColor("editorIndentGuide.background",{dark:editorWhitespaces,light:editorWhitespaces,hc:editorWhitespaces},localize("editorIndentGuides","Color of the editor indentation guides.")),editorActiveIndentGuides=registerColor("editorIndentGuide.activeBackground",{dark:editorWhitespaces,light:editorWhitespaces,hc:editorWhitespaces},localize("editorActiveIndentGuide","Color of the active editor indentation guides.")),editorLineNumbers=registerColor("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hc:Color.white},localize("editorLineNumbers","Color of editor line numbers.")),deprecatedEditorActiveLineNumber=registerColor("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hc:activeContrastBorder},localize("editorActiveLineNumber","Color of editor active line number"),!1,localize("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead.")),editorActiveLineNumber=registerColor("editorLineNumber.activeForeground",{dark:deprecatedEditorActiveLineNumber,light:deprecatedEditorActiveLineNumber,hc:deprecatedEditorActiveLineNumber},localize("editorActiveLineNumber","Color of editor active line number")),editorRuler=registerColor("editorRuler.foreground",{dark:"#5A5A5A",light:Color.lightgrey,hc:Color.white},localize("editorRuler","Color of the editor rulers."));registerColor("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hc:"#999999"},localize("editorCodeLensForeground","Foreground color of editor CodeLens"));const editorBracketMatchBackground=registerColor("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hc:"#0064001a"},localize("editorBracketMatchBackground","Background color behind matching brackets")),editorBracketMatchBorder=registerColor("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hc:contrastBorder},localize("editorBracketMatchBorder","Color for matching brackets boxes")),editorOverviewRulerBorder=registerColor("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hc:"#7f7f7f4d"},localize("editorOverviewRulerBorder","Color of the overview ruler border.")),editorOverviewRulerBackground=registerColor("editorOverviewRuler.background",null,localize("editorOverviewRulerBackground","Background color of the editor overview ruler. Only used when the minimap is enabled and placed on the right side of the editor.")),editorGutter=registerColor("editorGutter.background",{dark:editorBackground,light:editorBackground,hc:editorBackground},localize("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers.")),editorUnnecessaryCodeBorder=registerColor("editorUnnecessaryCode.border",{dark:null,light:null,hc:Color.fromHex("#fff").transparent(.8)},localize("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor.")),editorUnnecessaryCodeOpacity=registerColor("editorUnnecessaryCode.opacity",{dark:Color.fromHex("#000a"),light:Color.fromHex("#0007"),hc:null},localize("unnecessaryCodeOpacity","Opacity of unnecessary (unused) source code in the editor. For example, \"#000000c0\" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.")),ghostTextBorder=registerColor("editorGhostText.border",{dark:null,light:null,hc:Color.fromHex("#fff").transparent(.8)},localize("editorGhostTextBorder","Border color of ghost text in the editor.")),ghostTextForeground=registerColor("editorGhostText.foreground",{dark:Color.fromHex("#ffffff56"),light:Color.fromHex("#0007"),hc:null},localize("editorGhostTextForeground","Foreground color of the ghost text in the editor.")),ghostTextBackground=registerColor("editorGhostText.background",{dark:null,light:null,hc:null},localize("editorGhostTextBackground","Background color of the ghost text in the editor.")),rulerRangeDefault=new Color(new RGBA(0,122,204,.6));registerColor("editorOverviewRuler.rangeHighlightForeground",{dark:rulerRangeDefault,light:rulerRangeDefault,hc:rulerRangeDefault},localize("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0);const overviewRulerError=registerColor("editorOverviewRuler.errorForeground",{dark:new Color(new RGBA(255,18,18,.7)),light:new Color(new RGBA(255,18,18,.7)),hc:new Color(new RGBA(255,50,50,1))},localize("overviewRuleError","Overview ruler marker color for errors.")),overviewRulerWarning=registerColor("editorOverviewRuler.warningForeground",{dark:editorWarningForeground,light:editorWarningForeground,hc:editorWarningBorder},localize("overviewRuleWarning","Overview ruler marker color for warnings.")),overviewRulerInfo=registerColor("editorOverviewRuler.infoForeground",{dark:editorInfoForeground,light:editorInfoForeground,hc:editorInfoBorder},localize("overviewRuleInfo","Overview ruler marker color for infos.")),editorBracketHighlightingForeground1=registerColor("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hc:"#FFD700"},localize("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground2=registerColor("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hc:"#DA70D6"},localize("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground3=registerColor("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hc:"#87CEFA"},localize("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground4=registerColor("editorBracketHighlight.foreground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground5=registerColor("editorBracketHighlight.foreground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),editorBracketHighlightingForeground6=registerColor("editorBracketHighlight.foreground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),editorBracketHighlightingUnexpectedBracketForeground=registerColor("editorBracketHighlight.unexpectedBracket.foreground",{dark:new Color(new RGBA(255,18,18,.8)),light:new Color(new RGBA(255,18,18,.8)),hc:new Color(new RGBA(255,50,50,1))},localize("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),editorBracketPairGuideBackground1=registerColor("editorBracketPairGuide.background1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground2=registerColor("editorBracketPairGuide.background2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground3=registerColor("editorBracketPairGuide.background3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground4=registerColor("editorBracketPairGuide.background4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground5=registerColor("editorBracketPairGuide.background5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideBackground6=registerColor("editorBracketPairGuide.background6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground1=registerColor("editorBracketPairGuide.activeBackground1",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground2=registerColor("editorBracketPairGuide.activeBackground2",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground3=registerColor("editorBracketPairGuide.activeBackground3",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground4=registerColor("editorBracketPairGuide.activeBackground4",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground5=registerColor("editorBracketPairGuide.activeBackground5",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),editorBracketPairGuideActiveBackground6=registerColor("editorBracketPairGuide.activeBackground6",{dark:"#00000000",light:"#00000000",hc:"#00000000"},localize("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));registerColor("editorUnicodeHighlight.border",{dark:"#BD9B03",light:"#CEA33D",hc:"#ff0000"},localize("editorUnicodeHighlight.border","Border color used to highlight unicode characters.")),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorBackground);i&&t.addRule(`.monaco-editor, .monaco-editor-background, .monaco-editor .inputarea.ime-input { background-color: ${i}; }`);const n=e.getColor(editorForeground);n&&t.addRule(`.monaco-editor, .monaco-editor .inputarea.ime-input { color: ${n}; }`);const o=e.getColor(editorGutter);o&&t.addRule(`.monaco-editor .margin { background-color: ${o}; }`);const r=e.getColor(editorRangeHighlight);r&&t.addRule(`.monaco-editor .rangeHighlight { background-color: ${r}; }`);const s=e.getColor(editorRangeHighlightBorder);s&&t.addRule(`.monaco-editor .rangeHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${s}; }`);const a=e.getColor(editorSymbolHighlight);a&&t.addRule(`.monaco-editor .symbolHighlight { background-color: ${a}; }`);const l=e.getColor(editorSymbolHighlightBorder);l&&t.addRule(`.monaco-editor .symbolHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${l}; }`);const d=e.getColor(editorWhitespaces);d&&(t.addRule(`.monaco-editor .mtkw { color: ${d} !important; }`),t.addRule(`.monaco-editor .mtkz { color: ${d} !important; }`))}));class LineNumbersOverlay extends DynamicViewOverlay{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new Position$1(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(59);const t=e.get(60);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(84);const i=e.get(131);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),2!==this._renderLineNumbers&&3!==this._renderLineNumbers||(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(e,1));if(1!==t.column)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(2===this._renderLineNumbers){const e=Math.abs(this._lastCursorModelPosition.lineNumber-i);return 0===e?'<span class="relative-current-line-number">'+i+"</span>":String(e)}return 3===this._renderLineNumbers?this._lastCursorModelPosition.lineNumber===i||i%10==0?String(i):"":String(i)}prepareRender(e){if(0===this._renderLineNumbers)return void(this._renderResult=null);const t=isLinux?this._lineHeight%2==0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o='<div class="'+LineNumbersOverlay.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">',r=this._context.viewModel.getLineCount(),s=[];for(let a=i;a<=n;a++){const e=a-i;if(!this._renderFinalNewline&&a===r&&0===this._context.viewModel.getLineLength(a)){s[e]="";continue}const n=this._getLineRenderLineNumber(a);n?a===this._activeLineNumber?s[e]='<div class="active-line-number '+LineNumbersOverlay.CLASS_NAME+t+'" style="left:'+this._lineNumbersLeft+"px;width:"+this._lineNumbersWidth+'px;">'+n+"</div>":s[e]=o+n+"</div>":s[e]=""}this._renderResult=s}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}LineNumbersOverlay.CLASS_NAME="line-numbers",registerThemingParticipant(((e,t)=>{const i=e.getColor(editorLineNumbers);i&&t.addRule(`.monaco-editor .line-numbers { color: ${i}; }`);const n=e.getColor(editorActiveLineNumber);n&&t.addRule(`.monaco-editor .line-numbers.active-line-number { color: ${n}; }`)}));class Margin extends ViewPart{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(131);this._canUseLayerHinting=!t.get(28),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(Margin.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=createFastDomNode(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(131);return this._canUseLayerHinting=!t.get(28),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}}Margin.CLASS_NAME="glyph-margin",Margin.OUTER_CLASS_NAME="margin";var mouseCursor="";const MOUSE_CURSOR_TEXT_CSS_CLASS_NAME="monaco-mouse-cursor-text";var __awaiter$14=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},CompletionItemKinds,InlineCompletionTriggerKind$1,InlineCompletionTriggerKind2,SignatureHelpTriggerKind$1,SignatureHelpTriggerKind2,DocumentHighlightKind$1,DocumentHighlightKind2,SymbolKinds,Command,InlayHintKind$1,InlayHintKind2;class TokenizationRegistry$1{constructor(){this._map=new Map,this._factories=new Map,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._colorMap=null}fire(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._map.set(e,t),this.fire([e]),toDisposable((()=>{this._map.get(e)===t&&(this._map.delete(e),this.fire([e]))}))}registerFactory(e,t){var i;null===(i=this._factories.get(e))||void 0===i||i.dispose();const n=new TokenizationSupportFactoryData(this,e,t);return this._factories.set(e,n),toDisposable((()=>{const t=this._factories.get(e);t&&t===n&&(this._factories.delete(e),t.dispose())}))}getOrCreate(e){return __awaiter$14(this,void 0,void 0,(function*(){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(yield i.resolve(),this.get(e))}))}get(e){return this._map.get(e)||null}isResolved(e){if(this.get(e))return!0;const t=this._factories.get(e);return!(t&&!t.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._map.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}}class TokenizationSupportFactoryData extends Disposable{constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}get isResolved(){return this._isResolved}dispose(){this._isDisposed=!0,super.dispose()}resolve(){return __awaiter$14(this,void 0,void 0,(function*(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}))}_create(){return __awaiter$14(this,void 0,void 0,(function*(){const e=yield Promise.resolve(this._factory.createTokenizationSupport());this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}))}}class TokenMetadata{static getLanguageId(e){return(255&e)>>>0}static getTokenType(e){return(768&e)>>>8}static getFontStyle(e){return(15360&e)>>>10}static getForeground(e){return(8372224&e)>>>14}static getBackground(e){return(4286578688&e)>>>23}static getClassNameFromMetadata(e){let t="mtk"+this.getForeground(e);const i=this.getFontStyle(e);return 1&i&&(t+=" mtki"),2&i&&(t+=" mtkb"),4&i&&(t+=" mtku"),8&i&&(t+=" mtks"),t}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let o=`color: ${t[i]};`;1&n&&(o+="font-style: italic;"),2&n&&(o+="font-weight: bold;");let r="";return 4&n&&(r+=" underline"),8&n&&(r+=" line-through"),r&&(o+=`text-decoration:${r};`),o}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:Boolean(1&i),bold:Boolean(2&i),underline:Boolean(4&i),strikethrough:Boolean(8&i)}}}class Token$2{constructor(e,t,i){this._tokenBrand=void 0,this.offset=e,this.type=t,this.language=i}toString(){return"("+this.offset+", "+this.type+")"}}class TokenizationResult{constructor(e,t){this._tokenizationResultBrand=void 0,this.tokens=e,this.endState=t}}class EncodedTokenizationResult{constructor(e,t){this._encodedTokenizationResultBrand=void 0,this.tokens=e,this.endState=t}}function isLocationLink(e){return e&&URI.isUri(e.uri)&&Range$2.isIRange(e.range)&&(Range$2.isIRange(e.originSelectionRange)||Range$2.isIRange(e.targetSelectionRange))}!function(e){const t=new Map;t.set(0,Codicon.symbolMethod),t.set(1,Codicon.symbolFunction),t.set(2,Codicon.symbolConstructor),t.set(3,Codicon.symbolField),t.set(4,Codicon.symbolVariable),t.set(5,Codicon.symbolClass),t.set(6,Codicon.symbolStruct),t.set(7,Codicon.symbolInterface),t.set(8,Codicon.symbolModule),t.set(9,Codicon.symbolProperty),t.set(10,Codicon.symbolEvent),t.set(11,Codicon.symbolOperator),t.set(12,Codicon.symbolUnit),t.set(13,Codicon.symbolValue),t.set(15,Codicon.symbolEnum),t.set(14,Codicon.symbolConstant),t.set(15,Codicon.symbolEnum),t.set(16,Codicon.symbolEnumMember),t.set(17,Codicon.symbolKeyword),t.set(27,Codicon.symbolSnippet),t.set(18,Codicon.symbolText),t.set(19,Codicon.symbolColor),t.set(20,Codicon.symbolFile),t.set(21,Codicon.symbolReference),t.set(22,Codicon.symbolCustomColor),t.set(23,Codicon.symbolFolder),t.set(24,Codicon.symbolTypeParameter),t.set(25,Codicon.account),t.set(26,Codicon.issues),e.toIcon=function(e){let i=t.get(e);return i||(i=Codicon.symbolProperty),i};const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26),e.fromString=function(e,t){let n=i.get(e);return void 0!==n||t||(n=9),n}}(CompletionItemKinds||(CompletionItemKinds={})),InlineCompletionTriggerKind2=InlineCompletionTriggerKind$1||(InlineCompletionTriggerKind$1={}),InlineCompletionTriggerKind2[InlineCompletionTriggerKind2.Automatic=0]="Automatic",InlineCompletionTriggerKind2[InlineCompletionTriggerKind2.Explicit=1]="Explicit",SignatureHelpTriggerKind2=SignatureHelpTriggerKind$1||(SignatureHelpTriggerKind$1={}),SignatureHelpTriggerKind2[SignatureHelpTriggerKind2.Invoke=1]="Invoke",SignatureHelpTriggerKind2[SignatureHelpTriggerKind2.TriggerCharacter=2]="TriggerCharacter",SignatureHelpTriggerKind2[SignatureHelpTriggerKind2.ContentChange=3]="ContentChange",DocumentHighlightKind2=DocumentHighlightKind$1||(DocumentHighlightKind$1={}),DocumentHighlightKind2[DocumentHighlightKind2.Text=0]="Text",DocumentHighlightKind2[DocumentHighlightKind2.Read=1]="Read",DocumentHighlightKind2[DocumentHighlightKind2.Write=2]="Write",function(e){const t=new Map;t.set(0,Codicon.symbolFile),t.set(1,Codicon.symbolModule),t.set(2,Codicon.symbolNamespace),t.set(3,Codicon.symbolPackage),t.set(4,Codicon.symbolClass),t.set(5,Codicon.symbolMethod),t.set(6,Codicon.symbolProperty),t.set(7,Codicon.symbolField),t.set(8,Codicon.symbolConstructor),t.set(9,Codicon.symbolEnum),t.set(10,Codicon.symbolInterface),t.set(11,Codicon.symbolFunction),t.set(12,Codicon.symbolVariable),t.set(13,Codicon.symbolConstant),t.set(14,Codicon.symbolString),t.set(15,Codicon.symbolNumber),t.set(16,Codicon.symbolBoolean),t.set(17,Codicon.symbolArray),t.set(18,Codicon.symbolObject),t.set(19,Codicon.symbolKey),t.set(20,Codicon.symbolNull),t.set(21,Codicon.symbolEnumMember),t.set(22,Codicon.symbolStruct),t.set(23,Codicon.symbolEvent),t.set(24,Codicon.symbolOperator),t.set(25,Codicon.symbolTypeParameter),e.toIcon=function(e){let i=t.get(e);return i||(i=Codicon.symbolProperty),i}}(SymbolKinds||(SymbolKinds={}));class FoldingRangeKind{constructor(e){this.value=e}}FoldingRangeKind.Comment=new FoldingRangeKind("comment"),FoldingRangeKind.Imports=new FoldingRangeKind("imports"),FoldingRangeKind.Region=new FoldingRangeKind("region"),(Command||(Command={})).is=function(e){return!(!e||"object"!=typeof e)&&"string"==typeof e.id&&"string"==typeof e.title},InlayHintKind2=InlayHintKind$1||(InlayHintKind$1={}),InlayHintKind2[InlayHintKind2.Type=1]="Type",InlayHintKind2[InlayHintKind2.Parameter=2]="Parameter";const TokenizationRegistry=new TokenizationRegistry$1;class VisibleTextAreaData{constructor(e,t,i,n,o){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=o,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new Position$1(this.modelLineNumber,this.distanceToModelLineStart+1),i=new Position$1(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(this._previousPresentation=e||{foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const canUseZeroSizeTextarea=isFirefox;class TextAreaHandler extends ViewPart{constructor(e,t,i){super(e),this._primaryCursorPosition=new Position$1(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const n=this._context.configuration.options,o=n.get(131);this._setAccessibilityOptions(n),this._contentLeft=o.contentLeft,this._contentWidth=o.contentWidth,this._contentHeight=o.height,this._fontInfo=n.get(44),this._lineHeight=n.get(59),this._emptySelectionClipboard=n.get(32),this._copyWithSyntaxHighlighting=n.get(21),this._visibleTextArea=null,this._selections=[new Selection$1(1,1,1,1)],this._modelSelections=[new Selection$1(1,1,1,1)],this._lastRenderPosition=null,this.textArea=createFastDomNode(document.createElement("textarea")),PartFingerprints.write(this.textArea,6),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(n)),this.textArea.setAttribute("tabindex",String(n.get(112))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",localize("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),n.get(30)&&n.get(81)&&this.textArea.setAttribute("readonly","true"),this.textAreaCover=createFastDomNode(document.createElement("div")),this.textAreaCover.setPosition("absolute");const r={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:e=>this._context.viewModel.getLineMaxColumn(e),getValueInRange:(e,t)=>this._context.viewModel.getValueInRange(e,t)},s={getDataToCopy:()=>{const e=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,isWindows),t=this._context.viewModel.model.getEOL(),i=this._emptySelectionClipboard&&1===this._modelSelections.length&&this._modelSelections[0].isEmpty(),n=Array.isArray(e)?e:null,o=Array.isArray(e)?e.join(t):e;let r,s=null;if(CopyOptions.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&o.length<65536){const e=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);e&&(r=e.html,s=e.mode)}return{isFromEmptySelection:i,multicursorText:n,text:o,html:r,mode:s}},getScreenReaderContent:e=>{if(1===this._accessibilitySupport){if(isMacintosh){const e=this._selections[0];if(e.isEmpty()){const t=e.getStartPosition();let i=this._getWordBeforePosition(t);if(0===i.length&&(i=this._getCharacterBeforePosition(t)),i.length>0)return new TextAreaState(i,i.length,i.length,t,t)}}return TextAreaState.EMPTY}if(isAndroid){const e=this._selections[0];if(e.isEmpty()){const t=e.getStartPosition(),[i,n]=this._getAndroidWordAtPosition(t);if(i.length>0)return new TextAreaState(i,n,n,t,t)}return TextAreaState.EMPTY}return PagedScreenReaderStrategy.fromEditorSelection(e,r,this._selections[0],this._accessibilityPageSize,0===this._accessibilitySupport)},deduceModelPosition:(e,t,i)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(e,t,i)},a=this._register(new TextAreaWrapper(this.textArea.domNode));this._textAreaInput=this._register(new TextAreaInput(s,a,OS,browser)),this._register(this._textAreaInput.onKeyDown((e=>{this._viewController.emitKeyDown(e)}))),this._register(this._textAreaInput.onKeyUp((e=>{this._viewController.emitKeyUp(e)}))),this._register(this._textAreaInput.onPaste((e=>{let t=!1,i=null,n=null;e.metadata&&(t=this._emptySelectionClipboard&&!!e.metadata.isFromEmptySelection,i=void 0!==e.metadata.multicursorText?e.metadata.multicursorText:null,n=e.metadata.mode),this._viewController.paste(e.text,t,i,n)}))),this._register(this._textAreaInput.onCut((()=>{this._viewController.cut()}))),this._register(this._textAreaInput.onType((e=>{e.replacePrevCharCnt||e.replaceNextCharCnt||e.positionDelta?this._viewController.compositionType(e.text,e.replacePrevCharCnt,e.replaceNextCharCnt,e.positionDelta):this._viewController.type(e.text)}))),this._register(this._textAreaInput.onSelectionChangeRequest((e=>{this._viewController.setSelection(e)}))),this._register(this._textAreaInput.onCompositionStart((e=>{const t=this.textArea.domNode,i=this._modelSelections[0],{distanceToModelLineStart:n,widthOfHiddenTextBefore:o}=(()=>{const e=t.value.substring(0,Math.min(t.selectionStart,t.selectionEnd)),n=e.lastIndexOf("\n"),o=e.substring(n+1),r=o.lastIndexOf("\t"),s=o.length-r-1,a=i.getStartPosition(),l=Math.min(a.column-1,s);return{distanceToModelLineStart:a.column-1-l,widthOfHiddenTextBefore:measureText(o.substring(0,o.length-l),this._fontInfo)}})(),{distanceToModelLineEnd:r}=(()=>{const e=t.value.substring(Math.max(t.selectionStart,t.selectionEnd)),n=e.indexOf("\n"),o=-1===n?e:e.substring(0,n),r=o.indexOf("\t"),s=-1===r?o.length:o.length-r-1,a=i.getEndPosition(),l=Math.min(this._context.viewModel.model.getLineMaxColumn(a.lineNumber)-a.column,s);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(a.lineNumber)-a.column-l}})();this._context.viewModel.revealRange("keyboard",!0,Range$2.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new VisibleTextAreaData(this._context,i.startLineNumber,n,o,r),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()}))),this._register(this._textAreaInput.onCompositionUpdate((e=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())}))),this._register(this._textAreaInput.onCompositionEnd((()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}))),this._register(this._textAreaInput.onFocus((()=>{this._context.viewModel.setHasFocus(!0)}))),this._register(this._textAreaInput.onBlur((()=>{this._context.viewModel.setHasFocus(!1)})))}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=getMapForWordSeparators('`~!@#$%^&*()-=+[{]}\\|;:",.<>/?');let n=!0,o=e.column,r=!0,s=e.column,a=0;for(;a<50&&(n||r);){if(n&&o<=1&&(n=!1),n){const e=t.charCodeAt(o-2);0!==i.get(e)?n=!1:o--}if(r&&s>t.length&&(r=!1),r){const e=t.charCodeAt(s-1);0!==i.get(e)?r=!1:s++}a++}return[t.substring(o-1,s-1),e.column-o]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=getMapForWordSeparators(this._context.configuration.options.get(117));let n=e.column,o=0;for(;n>1;){const r=t.charCodeAt(n-2);if(0!==i.get(r)||o>50)return t.substring(n-1,e.column-1);o++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const t=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!isHighSurrogate(t.charCodeAt(0)))return t}return""}_getAriaLabel(e){return 1===e.get(2)?localize("accessibilityOffAriaLabel","The editor is not accessible at this time. Press {0} for options.",isLinux?"Shift+Alt+F1":"Alt+F1"):e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);2===this._accessibilitySupport&&t===EditorOptions.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(131);return this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(44),this._lineHeight=t.get(59),this._emptySelectionClipboard=t.get(32),this._copyWithSyntaxHighlighting=t.get(21),this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("tabindex",String(t.get(112))),(e.hasChanged(30)||e.hasChanged(81))&&(t.get(30)&&t.get(81)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")),e.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}prepareRender(e){this._primaryCursorPosition=new Position$1(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea&&this._visibleTextArea.prepareRender(e)}render(e){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea){const e=this._visibleTextArea.visibleTextareaStart,t=this._visibleTextArea.visibleTextareaEnd,i=this._visibleTextArea.startPosition,n=this._visibleTextArea.endPosition;if(i&&n&&e&&t&&t.left>=this._scrollLeft&&e.left<=this._scrollLeft+this._contentWidth){const o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,r=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let s=this._visibleTextArea.widthOfHiddenLineTextBefore,a=this._contentLeft+e.left-this._scrollLeft,l=t.left-e.left+1;if(a<this._contentLeft){const e=this._contentLeft-a;a+=e,s+=e,l-=e}l>this._contentWidth&&(l=this._contentWidth);const d=this._context.viewModel.getViewLineData(i.lineNumber),c=d.tokens.findTokenIndexAtOffset(i.column-1),h=c===d.tokens.findTokenIndexAtOffset(n.column-1),u=this._visibleTextArea.definePresentation(h?d.tokens.getPresentation(c):null);this.textArea.domNode.scrollTop=r*this._lineHeight,this.textArea.domNode.scrollLeft=s,this._doRender({lastRenderPosition:null,top:o,left:a,width:l,height:this._lineHeight,useCover:!1,color:(TokenizationRegistry.getColorMap()||[])[u.foreground],italic:u.italic,bold:u.bold,underline:u.underline,strikethrough:u.strikethrough})}return}if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft();const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft();const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight)this._renderAtTopLeft();else if(isMacintosh){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:e,width:canUseZeroSizeTextarea?0:1,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const i=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight}else this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:e,width:canUseZeroSizeTextarea?0:1,height:canUseZeroSizeTextarea?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;for(;;){if(i=e.indexOf("\n",i+1),-1===i)break;t++}return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:canUseZeroSizeTextarea?0:1,height:canUseZeroSizeTextarea?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;applyFontInfo(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?Color.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(50)?i.setClassName("monaco-editor-background textAreaCover "+Margin.OUTER_CLASS_NAME):0!==n.get(60).renderType?i.setClassName("monaco-editor-background textAreaCover "+LineNumbersOverlay.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}}function measureText(e,t){if(0===e.length)return 0;const i=document.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";const n=document.createElement("span");applyFontInfo(n,t),n.style.whiteSpace="pre",n.append(e),i.appendChild(n),document.body.appendChild(i);const o=n.offsetWidth;return document.body.removeChild(i),o}class ViewController{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){CoreNavigationCommands.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new Position$1(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(70)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(70)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=isLinux&&t.get(96),n=t.get(18);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position):this._lastCursorLineSelect(e.position):e.inSelectionMode?this._lineSelectDrag(e.position):this._lineSelect(e.position):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position):e.inSelectionMode?this._wordSelectDrag(e.position):this._wordSelect(e.position)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position):this.moveTo(e.position)}_usualArgs(e){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e}}moveTo(e){CoreNavigationCommands.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_moveToSelect(e){CoreNavigationCommands.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_columnSelect(e,t,i){e=this._validateViewColumn(e),CoreNavigationCommands.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),CoreNavigationCommands.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e){CoreNavigationCommands.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelect(e){CoreNavigationCommands.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_wordSelectDrag(e){CoreNavigationCommands.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorWordSelect(e){CoreNavigationCommands.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelect(e){CoreNavigationCommands.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lineSelectDrag(e){CoreNavigationCommands.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelect(e){CoreNavigationCommands.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_lastCursorLineSelectDrag(e){CoreNavigationCommands.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e))}_selectAll(){CoreNavigationCommands.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class ViewUserInputEvents{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown&&this.onKeyDown(e)}emitKeyUp(e){this.onKeyUp&&this.onKeyUp(e)}emitContextMenu(e){this.onContextMenu&&this.onContextMenu(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove&&this.onMouseMove(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave&&this.onMouseLeave(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown&&this.onMouseDown(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp&&this.onMouseUp(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag&&this.onMouseDrag(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop&&this.onMouseDrop(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled&&this.onMouseDropCanceled()}emitMouseWheel(e){this.onMouseWheel&&this.onMouseWheel(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return ViewUserInputEvents.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i=Object.assign({},e);return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),i}}var _a$b;class RenderedLinesCollection{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new Error("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(0===this.getCount())return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const i=t-e+1;return this._rendLineNumberStart-=i,null}if(e>n)return null;let o=0,r=0;for(let s=i;s<=n;s++){const i=s-this._rendLineNumberStart;e<=s&&s<=t&&(0===r?(o=i,r=1):r++)}if(e<i){let n=0;n=t<i?t-e+1:i-e,this._rendLineNumberStart-=n}return this._lines.splice(o,r)}onLinesChanged(e,t){if(0===this.getCount())return!1;const i=this.getStartLineNumber(),n=this.getEndLineNumber();let o=!1;for(let r=e;r<=t;r++)r>=i&&r<=n&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),o=!0);return o}onLinesInserted(e,t){if(0===this.getCount())return null;const i=t-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>o)return null;if(i+e>o){return this._lines.splice(e-this._rendLineNumberStart,o-e+1)}const r=[];for(let c=0;c<i;c++)r[c]=this._createLine();const s=e-this._rendLineNumberStart,a=this._lines.slice(0,s),l=this._lines.slice(s,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=a.concat(r).concat(l),d}onTokensChanged(e){if(0===this.getCount())return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let o=0,r=e.length;o<r;o++){const r=e[o];if(r.toLineNumber<t||r.fromLineNumber>i)continue;const s=Math.max(t,r.fromLineNumber),a=Math.min(i,r.toLineNumber);for(let e=s;e<=a;e++){const t=e-this._rendLineNumberStart;this._lines[t].onTokensChanged(),n=!0}}return n}}class VisibleLinesCollection{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new RenderedLinesCollection((()=>this._host.createVisibleLine()))}_createDomNode(){const e=createFastDomNode(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(131)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++){const e=t[i].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new ViewLayerRenderer(this.domNode.domNode,this._host,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},o=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}class ViewLayerRenderer{constructor(e,t,i){this.domNode=e,this.host=t,this.viewportData=i}render(e,t,i,n){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<t||i<o.rendLineNumberStart){o.rendLineNumberStart=t,o.linesLength=i-t+1,o.lines=[];for(let e=t;e<=i;e++)o.lines[e-t]=this.host.createVisibleLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(t-o.rendLineNumberStart,0),Math.min(i-o.rendLineNumberStart,o.linesLength-1),n,t),o.rendLineNumberStart>t){const e=t,r=Math.min(i,o.rendLineNumberStart-1);e<=r&&(this._insertLinesBefore(o,e,r,n,t),o.linesLength+=r-e+1)}else if(o.rendLineNumberStart<t){const e=Math.min(o.linesLength,t-o.rendLineNumberStart);e>0&&(this._removeLinesBefore(o,e),o.linesLength-=e)}if(o.rendLineNumberStart=t,o.rendLineNumberStart+o.linesLength-1<i){const e=o.rendLineNumberStart+o.linesLength,r=i;e<=r&&(this._insertLinesAfter(o,e,r,n,t),o.linesLength+=r-e+1)}else if(o.rendLineNumberStart+o.linesLength-1>i){const e=Math.max(0,i-o.rendLineNumberStart+1),t=o.linesLength-1-e+1;t>0&&(this._removeLinesAfter(o,t),o.linesLength-=t)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,t,i,n,o){const r=e.rendLineNumberStart,s=e.lines;for(let a=t;a<=i;a++){const e=r+a;s[a].layoutLine(e,n[e-o])}}_insertLinesBefore(e,t,i,n,o){const r=[];let s=0;for(let a=t;a<=i;a++)r[s++]=this.host.createVisibleLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++){const t=e.lines[i].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,o){const r=[];let s=0;for(let a=t;a<=i;a++)r[s++]=this.host.createVisibleLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++){const t=e.lines[i+n].getDomNode();t&&this.domNode.removeChild(t)}e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){ViewLayerRenderer._ttPolicy&&(i=ViewLayerRenderer._ttPolicy.createHTML(i));const o=this.domNode.lastChild;t||!o?this.domNode.innerHTML=i:o.insertAdjacentHTML("afterend",i);let r=this.domNode.lastChild;for(let s=e.linesLength-1;s>=0;s--){const t=e.lines[s];n[s]&&(t.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");ViewLayerRenderer._ttPolicy&&(t=ViewLayerRenderer._ttPolicy.createHTML(t)),n.innerHTML=t;for(let o=0;o<e.linesLength;o++){const t=e.lines[o];if(i[o]){const e=n.firstChild,i=t.getDomNode();i.parentNode.replaceChild(e,i),t.setDomNode(e)}}}_finishRendering(e,t,i){const n=ViewLayerRenderer._sb,o=e.linesLength,r=e.lines,s=e.rendLineNumberStart,a=[];{n.reset();let l=!1;for(let e=0;e<o;e++){const t=r[e];a[e]=!1;if(t.getDomNode())continue;t.renderLine(e+s,i[e],this.viewportData,n)&&(a[e]=!0,l=!0)}l&&this._finishRenderingNewLines(e,t,n.build(),a)}{n.reset();let t=!1;const l=[];for(let e=0;e<o;e++){const o=r[e];if(l[e]=!1,a[e])continue;o.renderLine(e+s,i[e],this.viewportData,n)&&(l[e]=!0,t=!0)}t&&this._finishRenderingInvalidLines(e,n.build(),l)}}}ViewLayerRenderer._ttPolicy=null===(_a$b=window.trustedTypes)||void 0===_a$b?void 0:_a$b.createPolicy("editorViewLayer",{createHTML:e=>e}),ViewLayerRenderer._sb=createStringBuilder(1e5);class ViewOverlays extends ViewPart{constructor(e){super(e),this._visibleLines=new VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode,this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++){if(this._dynamicOverlays[e].shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++){this._dynamicOverlays[e].dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new ViewOverlayLine(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){this._visibleLines.getVisibleLine(n).onConfigurationChanged(e)}return!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let i=0,n=t.length;i<n;i++){const n=t[i];n.prepareRender(e),n.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class ViewOverlayLine{constructor(e,t){this._configuration=e,this._lineHeight=this._configuration.options.get(59),this._dynamicOverlays=t,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=createFastDomNode(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(59)}renderLine(e,t,i,n){let o="";for(let r=0,s=this._dynamicOverlays.length;r<s;r++){o+=this._dynamicOverlays[r].render(i.startLineNumber,e)}return this._renderedContent!==o&&(this._renderedContent=o,n.appendASCIIString('<div style="position:absolute;top:'),n.appendASCIIString(String(t)),n.appendASCIIString("px;width:100%;height:"),n.appendASCIIString(String(this._lineHeight)),n.appendASCIIString('px;">'),n.appendASCIIString(o),n.appendASCIIString("</div>"),!0)}layoutLine(e,t){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(this._lineHeight))}}class ContentViewOverlays extends ViewOverlays{constructor(e){super(e);const t=this._context.configuration.options.get(131);this._contentWidth=t.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const t=this._context.configuration.options.get(131);return this._contentWidth=t.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class MarginViewOverlays extends ViewOverlays{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(131);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),applyFontInfo(this.domNode,t.get(44))}onConfigurationChanged(e){const t=this._context.configuration.options;applyFontInfo(this.domNode,t.get(44));const i=t.get(131);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class Coordinate{constructor(e,t){this._coordinateBrand=void 0,this.top=e,this.left=t}}class ViewContentWidgets extends ViewPart{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onLineMappingChanged(e);return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}addWidget(e){const t=new Widget$1(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i){this._widgets[e.getId()].setPosition(t,i),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t];delete this._widgets[t];const i=e.domNode.domNode;i.parentNode.removeChild(i),i.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return!!this._widgets.hasOwnProperty(e)&&this._widgets[e].suppressMouseDown}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class Widget$1{constructor(e,t,i){this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=createFastDomNode(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const n=this._context.configuration.options,o=n.get(131);this._fixedOverflowWidgets=n.get(36),this._contentWidth=o.contentWidth,this._contentLeft=o.contentLeft,this._lineHeight=n.get(59),this._range=null,this._viewRange=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(59),e.hasChanged(131)){const e=t.get(131);this._contentLeft=e.contentLeft,this._contentWidth=e.contentWidth,this._maxWidth=this._getMaxWidth()}}onLineMappingChanged(e){this._setPosition(this._range)}_setPosition(e){if(this._range=e,this._viewRange=null,this._range){const e=this._context.viewModel.model.validateRange(this._range);(this._context.viewModel.coordinatesConverter.modelPositionIsVisible(e.getStartPosition())||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(e.getEndPosition()))&&(this._viewRange=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(e))}}_getMaxWidth(){return this.allowEditorOverflow?window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth:this._contentWidth}setPosition(e,t){this._setPosition(e),this._preference=t,this._viewRange&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n,o){const r=e.top,s=r,a=t.top+this._lineHeight,l=r-n,d=s>=n,c=a,h=o.viewportHeight-a>=n;let u=e.left,g=t.left;return u+i>o.scrollLeft+o.viewportWidth&&(u=o.scrollLeft+o.viewportWidth-i),g+i>o.scrollLeft+o.viewportWidth&&(g=o.scrollLeft+o.viewportWidth-i),u<o.scrollLeft&&(u=o.scrollLeft),g<o.scrollLeft&&(g=o.scrollLeft),{fitsAbove:d,aboveTop:l,aboveLeft:u,fitsBelow:h,belowTop:c,belowLeft:g}}_layoutHorizontalSegmentInPage(e,t,i,n){const o=Math.max(0,t.left-n),r=Math.min(t.left+t.width+n,e.width);let s=t.left+i-StandardWindow.scrollX;if(s+n>r){const e=s-(r-n);s-=e,i-=e}if(s<o){const e=s-o;s-=e,i-=e}return[i,s]}_layoutBoxInPage(e,t,i,n,o){const r=e.top-n,s=t.top+this._lineHeight,a=getDomNodePagePosition(this._viewDomNode.domNode),l=a.top+r-StandardWindow.scrollY,d=a.top+s-StandardWindow.scrollY,c=getClientArea(document.body),[h,u]=this._layoutHorizontalSegmentInPage(c,a,e.left-o.scrollLeft+this._contentLeft,i),[g,p]=this._layoutHorizontalSegmentInPage(c,a,t.left-o.scrollLeft+this._contentLeft,i),m=l>=22,f=d+n<=c.height-22;return this._fixedOverflowWidgets?{fitsAbove:m,aboveTop:Math.max(l,22),aboveLeft:u,fitsBelow:f,belowTop:d,belowLeft:p}:{fitsAbove:m,aboveTop:r,aboveLeft:h,fitsBelow:f,belowTop:s,belowLeft:g}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new Coordinate(e.top,e.left+this._contentLeft)}_getTopAndBottomLeft(e){if(!this._viewRange)return[null,null];const t=e.linesVisibleRangesForRange(this._viewRange,!1);if(!t||0===t.length)return[null,null];let i=t[0],n=t[0];for(const d of t)d.lineNumber<i.lineNumber&&(i=d),d.lineNumber>n.lineNumber&&(n=d);let o=1073741824;for(const d of i.ranges)d.left<o&&(o=d.left);let r=1073741824;for(const d of n.ranges)d.left<r&&(r=d.left);const s=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.scrollTop,a=new Coordinate(s,o),l=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.scrollTop;return[a,new Coordinate(l,r)]}_prepareRenderWidget(e){if(!this._preference||0===this._preference.length)return null;const[t,i]=this._getTopAndBottomLeft(e);if(!t||!i)return null;if(-1===this._cachedDomNodeOffsetWidth||-1===this._cachedDomNodeOffsetHeight){let e=null;if("function"==typeof this._actual.beforeRender&&(e=safeInvoke(this._actual.beforeRender,this._actual)),e)this._cachedDomNodeOffsetWidth=e.width,this._cachedDomNodeOffsetHeight=e.height;else{const e=this.domNode.domNode;this._cachedDomNodeOffsetWidth=e.offsetWidth,this._cachedDomNodeOffsetHeight=e.offsetHeight}}let n;n=this.allowEditorOverflow?this._layoutBoxInPage(t,i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):this._layoutBoxInViewport(t,i,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let o=1;o<=2;o++)for(const e of this._preference)if(1===e){if(!n)return null;if(2===o||n.fitsAbove)return{coordinate:new Coordinate(n.aboveTop,n.aboveLeft),position:1}}else{if(2!==e)return this.allowEditorOverflow?{coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(t),position:0}:{coordinate:t,position:0};if(!n)return null;if(2===o||n.fitsBelow)return{coordinate:new Coordinate(n.belowTop,n.belowLeft),position:2}}return null}onBeforeRender(e){this._viewRange&&this._preference&&(this._viewRange.endLineNumber<e.startLineNumber||this._viewRange.startLineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth))}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData)return this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this.domNode.setVisibility("hidden")),void("function"==typeof this._actual.afterRender&&safeInvoke(this._actual.afterRender,this._actual,null));this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),"function"==typeof this._actual.afterRender&&safeInvoke(this._actual.afterRender,this._actual,this._renderData.position)}}function safeInvoke(e,t,...i){try{return e.call(t,...i)}catch(n){return null}}var currentLineHighlight="";class AbstractLineHighlightOverlay extends DynamicViewOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(131);this._lineHeight=t.get(59),this._renderLineHighlight=t.get(85),this._renderLineHighlightOnlyWhenFocus=t.get(86),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new Selection$1(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=this._selections.map((e=>e.positionLineNumber));t.sort(((e,t)=>e-t)),equals$1(this._cursorLineNumbers,t)||(this._cursorLineNumbers=t,e=!0);const i=this._selections.every((e=>e.isEmpty()));return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(131);return this._lineHeight=t.get(59),this._renderLineHighlight=t.get(85),this._renderLineHighlightOnlyWhenFocus=t.get(86),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return!!this._renderLineHighlightOnlyWhenFocus&&(this._focused=e.isFocused,!0)}prepareRender(e){if(!this._shouldRenderThis())return void(this._renderData=null);const t=this._renderOne(e),i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,o=this._cursorLineNumbers.length;let r=0;const s=[];for(let a=i;a<=n;a++){const e=a-i;for(;r<o&&this._cursorLineNumbers[r]<a;)r++;r<o&&this._cursorLineNumbers[r]===a?s[e]=t:s[e]=""}this._renderData=s}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return("gutter"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return("line"===this._renderLineHighlight||"all"===this._renderLineHighlight)&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderOther()?" current-line-both":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay{_renderOne(e){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")}" style="width:${this._contentLeft}px; height:${this._lineHeight}px;"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}registerThemingParticipant(((e,t)=>{const i=e.getColor(editorLineHighlight);if(i&&(t.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${i}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${i}; border: none; }`)),!i||i.isTransparent()||e.defines(editorLineHighlightBorder)){const i=e.getColor(editorLineHighlightBorder);i&&(t.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${i}; }`),t.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${i}; }`),"hc"===e.type&&(t.addRule(".monaco-editor .view-overlays .current-line { border-width: 1px; }"),t.addRule(".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }")))}}));var decorations="";class DecorationsOverlay extends DynamicViewOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(59),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(59),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let a=0,l=t.length;a<l;a++){const e=t[a];e.options.className&&(i[n++]=e)}i=i.sort(((e,t)=>{if(e.options.zIndex<t.options.zIndex)return-1;if(e.options.zIndex>t.options.zIndex)return 1;const i=e.options.className,n=t.options.className;return i<n?-1:i>n?1:Range$2.compareRangesUsingStarts(e.range,t.range)}));const o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,s=[];for(let a=o;a<=r;a++){s[a-o]=""}this._renderWholeLineDecorations(e,i,s),this._renderNormalDecorations(e,i,s),this._renderResult=s}_renderWholeLineDecorations(e,t,i){const n=String(this._lineHeight),o=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber;for(let s=0,a=t.length;s<a;s++){const e=t[s];if(!e.options.isWholeLine)continue;const a='<div class="cdr '+e.options.className+'" style="left:0;width:100%;height:'+n+'px;"></div>',l=Math.max(e.range.startLineNumber,o),d=Math.min(e.range.endLineNumber,r);for(let t=l;t<=d;t++){i[t-o]+=a}}}_renderNormalDecorations(e,t,i){const n=String(this._lineHeight),o=e.visibleRange.startLineNumber;let r=null,s=!1,a=null;for(let l=0,d=t.length;l<d;l++){const d=t[l];if(d.options.isWholeLine)continue;const c=d.options.className,h=Boolean(d.options.showIfCollapsed);let u=d.range;h&&1===u.endColumn&&u.endLineNumber!==u.startLineNumber&&(u=new Range$2(u.startLineNumber,u.startColumn,u.endLineNumber-1,this._context.viewModel.getLineMaxColumn(u.endLineNumber-1))),r===c&&s===h&&Range$2.areIntersectingOrTouching(a,u)?a=Range$2.plusRange(a,u):(null!==r&&this._renderNormalDecoration(e,a,r,s,n,o,i),r=c,s=h,a=u)}null!==r&&this._renderNormalDecoration(e,a,r,s,n,o,i)}_renderNormalDecoration(e,t,i,n,o,r,s){const a=e.linesVisibleRangesForRange(t,"findMatch"===i);if(a)for(let l=0,d=a.length;l<d;l++){const e=a[l];if(e.outsideRenderedLine)continue;const t=e.lineNumber-r;if(n&&1===e.ranges.length){const t=e.ranges[0];if(t.width<this._typicalHalfwidthCharacterWidth){const i=Math.round(t.left+t.width/2),n=Math.max(0,Math.round(i-this._typicalHalfwidthCharacterWidth/2));e.ranges[0]=new HorizontalRange(n,this._typicalHalfwidthCharacterWidth)}}for(let n=0,r=e.ranges.length;n<r;n++){const r=e.ranges[n],a='<div class="cdr '+i+'" style="left:'+String(r.left)+"px;width:"+String(r.width)+"px;height:"+o+'px;"></div>';s[t]+=a}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class Widget extends Disposable{onclick(e,t){this._register(addDisposableListener(e,EventType$1.CLICK,(e=>t(new StandardMouseEvent(e)))))}onmousedown(e,t){this._register(addDisposableListener(e,EventType$1.MOUSE_DOWN,(e=>t(new StandardMouseEvent(e)))))}onmouseover(e,t){this._register(addDisposableListener(e,EventType$1.MOUSE_OVER,(e=>t(new StandardMouseEvent(e)))))}onnonbubblingmouseout(e,t){this._register(addDisposableNonBubblingMouseOutListener(e,(e=>t(new StandardMouseEvent(e)))))}onkeydown(e,t){this._register(addDisposableListener(e,EventType$1.KEY_DOWN,(e=>t(new StandardKeyboardEvent(e)))))}onkeyup(e,t){this._register(addDisposableListener(e,EventType$1.KEY_UP,(e=>t(new StandardKeyboardEvent(e)))))}oninput(e,t){this._register(addDisposableListener(e,EventType$1.INPUT,t))}onblur(e,t){this._register(addDisposableListener(e,EventType$1.BLUR,t))}onfocus(e,t){this._register(addDisposableListener(e,EventType$1.FOCUS,t))}ignoreGesture(e){Gesture.ignoreTarget(e)}}const ARROW_IMG_SIZE=11;class ScrollbarArrow extends Widget{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",void 0!==e.top&&(this.bgDomNode.style.top="0px"),void 0!==e.left&&(this.bgDomNode.style.left="0px"),void 0!==e.bottom&&(this.bgDomNode.style.bottom="0px"),void 0!==e.right&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...e.icon.classNamesArray),this.domNode.style.position="absolute",this.domNode.style.width=ARROW_IMG_SIZE+"px",this.domNode.style.height=ARROW_IMG_SIZE+"px",void 0!==e.top&&(this.domNode.style.top=e.top+"px"),void 0!==e.left&&(this.domNode.style.left=e.left+"px"),void 0!==e.bottom&&(this.domNode.style.bottom=e.bottom+"px"),void 0!==e.right&&(this.domNode.style.right=e.right+"px"),this._mouseMoveMonitor=this._register(new GlobalMouseMoveMonitor),this.onmousedown(this.bgDomNode,(e=>this._arrowMouseDown(e))),this.onmousedown(this.domNode,(e=>this._arrowMouseDown(e))),this._mousedownRepeatTimer=this._register(new IntervalTimer),this._mousedownScheduleRepeatTimer=this._register(new TimeoutTimer)}_arrowMouseDown(e){this._onActivate(),this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancelAndSet((()=>{this._mousedownRepeatTimer.cancelAndSet((()=>this._onActivate()),1e3/24)}),200),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,standardMouseMoveMerger,(e=>{}),(()=>{this._mousedownRepeatTimer.cancel(),this._mousedownScheduleRepeatTimer.cancel()})),e.preventDefault()}}class ScrollbarVisibilityController extends Disposable{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new TimeoutTimer)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return 2!==this._visibility&&(3===this._visibility||this._rawShouldBeVisible)}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){this._isNeeded?this._shouldBeVisible?this._reveal():this._hide(!0):this._hide(!1)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet((()=>{this._domNode&&this._domNode.setClassName(this._visibleClassName)}),0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode&&this._domNode.setClassName(this._invisibleClassName+(e?" fade":"")))}}const MOUSE_DRAG_RESET_DISTANCE$1=140;class AbstractScrollbar extends Widget{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new ScrollbarVisibilityController(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._mouseMoveMonitor=this._register(new GlobalMouseMoveMonitor),this._shouldRender=!0,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this.onmousedown(this.domNode.domNode,(e=>this._domNodeMouseDown(e)))}_createArrow(e){const t=this._register(new ScrollbarArrow(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=createFastDomNode(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),"number"==typeof i&&this.slider.setWidth(i),"number"==typeof n&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this.onmousedown(this.slider.domNode,(e=>{e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))})),this.onclick(this.slider.domNode,(e=>{e.leftButton&&e.stopPropagation()}))}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodeMouseDown(e){e.target===this.domNode.domNode&&this._onMouseDown(e)}delegateMouseDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),o=this._sliderMousePosition(e);i<=o&&o<=n?e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{}))):this._onMouseDown(e)}_onMouseDown(e){let t,i;if(e.target===this.domNode.domNode&&"number"==typeof e.browserEvent.offsetX&&"number"==typeof e.browserEvent.offsetY)t=e.browserEvent.offsetX,i=e.browserEvent.offsetY;else{const n=getDomNodePagePosition(this.domNode.domNode);t=e.posx-n.left,i=e.posy-n.top}const n=this._mouseDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.leftButton&&(e.preventDefault(),this._sliderMouseDown(e,(()=>{})))}_sliderMouseDown(e,t){const i=this._sliderMousePosition(e),n=this._sliderOrthogonalMousePosition(e),o=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._mouseMoveMonitor.startMonitoring(e.target,e.buttons,standardMouseMoveMerger,(e=>{const t=this._sliderOrthogonalMousePosition(e),r=Math.abs(t-n);if(isWindows&&r>MOUSE_DRAG_RESET_DISTANCE$1)return void this._setDesiredScrollPositionNow(o.getScrollPosition());const s=this._sliderMousePosition(e)-i;this._setDesiredScrollPositionNow(o.getDesiredScrollPositionFromDelta(s))}),(()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd(),t()})),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const MINIMUM_SLIDER_SIZE=20;class ScrollbarState{constructor(e,t,i,n,o,r){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=o,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new ScrollbarState(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t&&(this._visibleSize=t,this._refreshComputedValues(),!0)}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t&&(this._scrollSize=t,this._refreshComputedValues(),!0)}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t&&(this._scrollPosition=t,this._refreshComputedValues(),!0)}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,o){const r=Math.max(0,i-e),s=Math.max(0,r-2*t),a=n>0&&n>i;if(!a)return{computedAvailableSize:Math.round(r),computedIsNeeded:a,computedSliderSize:Math.round(s),computedSliderRatio:0,computedSliderPosition:0};const l=Math.round(Math.max(MINIMUM_SLIDER_SIZE,Math.floor(i*s/n))),d=(s-l)/(n-i),c=o*d;return{computedAvailableSize:Math.round(r),computedIsNeeded:a,computedSliderSize:Math.round(l),computedSliderRatio:d,computedSliderPosition:Math.round(c)}}_refreshComputedValues(){const e=ScrollbarState._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class HorizontalScrollbar extends AbstractScrollbar{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new ScrollbarState(t.horizontalHasArrows?t.arrowSize:0,2===t.horizontal?0:t.horizontalScrollbarSize,2===t.vertical?0:t.verticalScrollbarSize,n.width,n.scrollWidth,o.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const e=(t.arrowSize-ARROW_IMG_SIZE)/2,i=(t.horizontalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonLeft,top:i,left:e,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,1,0))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonRight,top:i,left:void 0,bottom:void 0,right:e,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return e}_sliderMousePosition(e){return e.posx}_sliderOrthogonalMousePosition(e){return e.posy}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(2===e.horizontal?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(2===e.vertical?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class VerticalScrollbar extends AbstractScrollbar{constructor(e,t,i){const n=e.getScrollDimensions(),o=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new ScrollbarState(t.verticalHasArrows?t.arrowSize:0,2===t.vertical?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,o.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const e=(t.arrowSize-ARROW_IMG_SIZE)/2,i=(t.verticalScrollbarSize-ARROW_IMG_SIZE)/2;this._createArrow({className:"scra",icon:Codicon.scrollbarButtonUp,top:e,left:i,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,1))}),this._createArrow({className:"scra",icon:Codicon.scrollbarButtonDown,top:void 0,left:i,bottom:e,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new StandardWheelEvent(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_mouseDownRelativePosition(e,t){return t}_sliderMousePosition(e){return e.posy}_sliderOrthogonalMousePosition(e){return e.posx}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(2===e.vertical?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class ScrollState{constructor(e,t,i,n,o,r,s){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t|=0,i|=0,n|=0,o|=0,r|=0,s|=0),this.rawScrollLeft=n,this.rawScrollTop=s,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),o<0&&(o=0),s+o>r&&(s=r-o),s<0&&(s=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=o,this.scrollHeight=r,this.scrollTop=s}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new ScrollState(this._forceIntegerValues,void 0!==e.width?e.width:this.width,void 0!==e.scrollWidth?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,void 0!==e.height?e.height:this.height,void 0!==e.scrollHeight?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new ScrollState(this._forceIntegerValues,this.width,this.scrollWidth,void 0!==e.scrollLeft?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,void 0!==e.scrollTop?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,o=this.scrollLeft!==e.scrollLeft,r=this.height!==e.height,s=this.scrollHeight!==e.scrollHeight,a=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:o,heightChanged:r,scrollHeightChanged:s,scrollTopChanged:a}}}class Scrollable extends Disposable{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new Emitter$1),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new ScrollState(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){const i=this._state.withScrollDimensions(e,t);this._setState(i,Boolean(this._smoothScrolling)),this._smoothScrolling&&this._smoothScrolling.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(0===this._smoothScrollDuration)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:void 0===e.scrollLeft?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:void 0===e.scrollTop?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;n=t?new SmoothScrollingOperation(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const t=this._state.withScrollPosition(e);this._smoothScrolling=SmoothScrollingOperation.start(this._state,t,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);return this._setState(t,!0),this._smoothScrolling?e.isDone?(this._smoothScrolling.dispose(),void(this._smoothScrolling=null)):void(this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame((()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())}))):void 0}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class SmoothScrollingUpdate{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function createEaseOutCubic(e,t){const i=t-e;return function(t){return e+i*easeOutCubic(t)}}function createComposed(e,t,i){return function(n){return n<i?e(n/i):t((n-i)/(1-i))}}class SmoothScrollingOperation{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let n,o;return e<t?(n=e+.75*i,o=t-.75*i):(n=e-.75*i,o=t+.75*i),createComposed(createEaseOutCubic(e,n),createEaseOutCubic(o,t),.33)}return createEaseOutCubic(e,t)}dispose(){null!==this.animationFrameDisposable&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const e=this.scrollLeft(t),i=this.scrollTop(t);return new SmoothScrollingUpdate(e,i,!1)}return new SmoothScrollingUpdate(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return SmoothScrollingOperation.start(e,t,i)}static start(e,t,i){i+=10;const n=Date.now()-10;return new SmoothScrollingOperation(e,t,n,i)}}function easeInCubic(e){return Math.pow(e,3)}function easeOutCubic(e){return 1-easeInCubic(1-e)}var scrollbars="";const HIDE_TIMEOUT=500,SCROLL_WHEEL_SENSITIVITY=50;class MouseWheelClassifierItem{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}class MouseWheelClassifier{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(-1===this._front&&-1===this._rear)return!1;let e=1,t=0,i=1,n=this._rear;for(;;){const o=n===this._front?e:Math.pow(2,-i);if(e-=o,t+=this._memory[n].score*o,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}return t<=.5}accept(e,t,i){const n=new MouseWheelClassifierItem(e,t,i);n.score=this._computeScore(n),-1===this._front&&-1===this._rear?(this._memory[0]=n,this._front=0,this._rear=0):(this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=n)}_computeScore(e){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let t=.5;return(-1!==this._front||-1!==this._rear)&&this._memory[this._rear],this._isAlmostInt(e.deltaX)&&this._isAlmostInt(e.deltaY)||(t+=.25),Math.min(Math.max(t,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}}MouseWheelClassifier.INSTANCE=new MouseWheelClassifier;class AbstractScrollableElement extends Widget{constructor(e,t,i){super(),this._onScroll=this._register(new Emitter$1),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new Emitter$1),e.style.overflow="hidden",this._options=resolveOptions$1(t),this._scrollable=i,this._register(this._scrollable.onScroll((e=>{this._onWillScroll.fire(e),this._onDidScroll(e),this._onScroll.fire(e)})));const n={onMouseWheel:e=>this._onMouseWheel(e),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new VerticalScrollbar(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new HorizontalScrollbar(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=createFastDomNode(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=createFastDomNode(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=createFastDomNode(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,(e=>this._onMouseOver(e))),this.onnonbubblingmouseout(this._listenOnDomNode,(e=>this._onMouseOut(e))),this._hideTimeout=this._register(new TimeoutTimer),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarMouseDown(e){this._verticalScrollbar.delegateMouseDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,isMacintosh&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){void 0!==e.handleMouseWheel&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),void 0!==e.mouseWheelScrollSensitivity&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),void 0!==e.fastScrollSensitivity&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),void 0!==e.scrollPredominantAxis&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),void 0!==e.horizontal&&(this._options.horizontal=e.horizontal),void 0!==e.vertical&&(this._options.vertical=e.vertical),void 0!==e.horizontalScrollbarSize&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),void 0!==e.verticalScrollbarSize&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),void 0!==e.scrollByPage&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=dispose(this._mouseWheelToDispose),e)){const e=e=>{this._onMouseWheel(new StandardWheelEvent(e))};this._mouseWheelToDispose.push(addDisposableListener(this._listenOnDomNode,EventType$1.MOUSE_WHEEL,e,{passive:!1}))}}_onMouseWheel(e){const t=MouseWheelClassifier.INSTANCE;{const i=window.devicePixelRatio/getZoomFactor();isWindows||isLinux?t.accept(Date.now(),e.deltaX/i,e.deltaY/i):t.accept(Date.now(),e.deltaX,e.deltaY)}let i=!1;if(e.deltaY||e.deltaX){let n=e.deltaY*this._options.mouseWheelScrollSensitivity,o=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(Math.abs(n)>=Math.abs(o)?o=0:n=0),this._options.flipAxes&&([n,o]=[o,n]);const r=!isMacintosh&&e.browserEvent&&e.browserEvent.shiftKey;!this._options.scrollYToX&&!r||o||(o=n,n=0),e.browserEvent&&e.browserEvent.altKey&&(o*=this._options.fastScrollSensitivity,n*=this._options.fastScrollSensitivity);const s=this._scrollable.getFutureScrollPosition();let a={};if(n){const e=SCROLL_WHEEL_SENSITIVITY*n,t=s.scrollTop-(e<0?Math.floor(e):Math.ceil(e));this._verticalScrollbar.writeScrollPosition(a,t)}if(o){const e=SCROLL_WHEEL_SENSITIVITY*o,t=s.scrollLeft-(e<0?Math.floor(e):Math.ceil(e));this._horizontalScrollbar.writeScrollPosition(a,t)}if(a=this._scrollable.validateScrollPosition(a),s.scrollLeft!==a.scrollLeft||s.scrollTop!==a.scrollTop){this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(a):this._scrollable.setScrollPositionNow(a),i=!0}}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",o=t?" top":"",r=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${o}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${o}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseOut(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){this._mouseIsOver||this._isDragging||(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){this._mouseIsOver||this._isDragging||this._hideTimeout.cancelAndSet((()=>this._hide()),HIDE_TIMEOUT)}}class ScrollableElement extends AbstractScrollableElement{constructor(e,t){(t=t||{}).mouseWheelSmoothScroll=!1;const i=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:e=>scheduleAtNextAnimationFrame(e)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class SmoothScrollableElement extends AbstractScrollableElement{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class DomScrollableElement extends AbstractScrollableElement{constructor(e,t){(t=t||{}).mouseWheelSmoothScroll=!1;const i=new Scrollable({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:e=>scheduleAtNextAnimationFrame(e)});super(e,t,i),this._register(i),this._element=e,this.onScroll((e=>{e.scrollTopChanged&&(this._element.scrollTop=e.scrollTop),e.scrollLeftChanged&&(this._element.scrollLeft=e.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function resolveOptions$1(e){const t={lazyRender:void 0!==e.lazyRender&&e.lazyRender,className:void 0!==e.className?e.className:"",useShadows:void 0===e.useShadows||e.useShadows,handleMouseWheel:void 0===e.handleMouseWheel||e.handleMouseWheel,flipAxes:void 0!==e.flipAxes&&e.flipAxes,consumeMouseWheelIfScrollbarIsNeeded:void 0!==e.consumeMouseWheelIfScrollbarIsNeeded&&e.consumeMouseWheelIfScrollbarIsNeeded,alwaysConsumeMouseWheel:void 0!==e.alwaysConsumeMouseWheel&&e.alwaysConsumeMouseWheel,scrollYToX:void 0!==e.scrollYToX&&e.scrollYToX,mouseWheelScrollSensitivity:void 0!==e.mouseWheelScrollSensitivity?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:void 0!==e.fastScrollSensitivity?e.fastScrollSensitivity:5,scrollPredominantAxis:void 0===e.scrollPredominantAxis||e.scrollPredominantAxis,mouseWheelSmoothScroll:void 0===e.mouseWheelSmoothScroll||e.mouseWheelSmoothScroll,arrowSize:void 0!==e.arrowSize?e.arrowSize:11,listenOnDomNode:void 0!==e.listenOnDomNode?e.listenOnDomNode:null,horizontal:void 0!==e.horizontal?e.horizontal:1,horizontalScrollbarSize:void 0!==e.horizontalScrollbarSize?e.horizontalScrollbarSize:10,horizontalSliderSize:void 0!==e.horizontalSliderSize?e.horizontalSliderSize:0,horizontalHasArrows:void 0!==e.horizontalHasArrows&&e.horizontalHasArrows,vertical:void 0!==e.vertical?e.vertical:1,verticalScrollbarSize:void 0!==e.verticalScrollbarSize?e.verticalScrollbarSize:10,verticalHasArrows:void 0!==e.verticalHasArrows&&e.verticalHasArrows,verticalSliderSize:void 0!==e.verticalSliderSize?e.verticalSliderSize:0,scrollByPage:void 0!==e.scrollByPage&&e.scrollByPage};return t.horizontalSliderSize=void 0!==e.horizontalSliderSize?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=void 0!==e.verticalSliderSize?e.verticalSliderSize:t.verticalScrollbarSize,isMacintosh&&(t.className+=" mac"),t}class EditorScrollbar extends ViewPart{constructor(e,t,i,n){super(e);const o=this._context.configuration.options,r=o.get(92),s=o.get(67),a=o.get(34),l=o.get(95),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+getThemeTypeSelector(e.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:s,fastScrollSensitivity:a,scrollPredominantAxis:l,scrollByPage:r.scrollByPage};this.scrollbar=this._register(new SmoothScrollableElement(t.domNode,d,this._context.viewLayout.getScrollable())),PartFingerprints.write(this.scrollbar.getDomNode(),5),this.scrollbarDomNode=createFastDomNode(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const c=(e,t,i)=>{const n={};if(t){const t=e.scrollTop;t&&(n.scrollTop=this._context.viewLayout.getCurrentScrollTop()+t,e.scrollTop=0)}if(i){const t=e.scrollLeft;t&&(n.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+t,e.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(n,1)};this._register(addDisposableListener(i.domNode,"scroll",(e=>c(i.domNode,!0,!0)))),this._register(addDisposableListener(t.domNode,"scroll",(e=>c(t.domNode,!0,!1)))),this._register(addDisposableListener(n.domNode,"scroll",(e=>c(n.domNode,!0,!1)))),this._register(addDisposableListener(this.scrollbarDomNode.domNode,"scroll",(e=>c(this.scrollbarDomNode.domNode,!0,!1))))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(131);this.scrollbarDomNode.setLeft(t.contentLeft);"right"===e.get(65).side?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarMouseDown(e){this.scrollbar.delegateVerticalScrollbarMouseDown(e)}onConfigurationChanged(e){if(e.hasChanged(92)||e.hasChanged(67)||e.hasChanged(34)){const e=this._context.configuration.options,t=e.get(92),i=e.get(67),n=e.get(34),o=e.get(95),r={vertical:t.vertical,horizontal:t.horizontal,verticalScrollbarSize:t.verticalScrollbarSize,horizontalScrollbarSize:t.horizontalScrollbarSize,scrollByPage:t.scrollByPage,handleMouseWheel:t.handleMouseWheel,mouseWheelScrollSensitivity:i,fastScrollSensitivity:n,scrollPredominantAxis:o};this.scrollbar.updateOptions(r)}return e.hasChanged(131)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+getThemeTypeSelector(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}registerThemingParticipant(((e,t)=>{const i=e.getColor(scrollbarShadow);i&&t.addRule(`\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tbox-shadow: ${i} 0 6px 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tbox-shadow: ${i} 6px 0 6px -6px inset;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\tbox-shadow: ${i} 6px 6px 6px -6px inset;\n\t\t\t}\n\t\t`);const n=e.getColor(scrollbarSliderBackground);n&&t.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\tbackground: ${n};\n\t\t\t}\n\t\t`);const o=e.getColor(scrollbarSliderHoverBackground);o&&t.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\tbackground: ${o};\n\t\t\t}\n\t\t`);const r=e.getColor(scrollbarSliderActiveBackground);r&&t.addRule(`\n\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\tbackground: ${r};\n\t\t\t}\n\t\t`)}));var glyphMargin="";class DecorationToRender{constructor(e,t,i){this._decorationToRenderBrand=void 0,this.startLineNumber=+e,this.endLineNumber=+t,this.className=String(i)}}class DedupOverlay extends DynamicViewOverlay{_render(e,t,i){const n=[];for(let s=e;s<=t;s++){n[s-e]=[]}if(0===i.length)return n;i.sort(((e,t)=>e.className===t.className?e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber:e.className<t.className?-1:1));let o=null,r=0;for(let s=0,a=i.length;s<a;s++){const a=i[s],l=a.className;let d=Math.max(a.startLineNumber,e)-e;const c=Math.min(a.endLineNumber,t)-e;o===l?(d=Math.max(r+1,d),r=Math.max(r,c)):(o=l,r=c);for(let e=d;e<=r;e++)n[e].push(o)}return n}}class GlyphMarginOverlay extends DedupOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(131);this._lineHeight=t.get(59),this._glyphMargin=t.get(50),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(131);return this._lineHeight=t.get(59),this._glyphMargin=t.get(50),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const e=t[o],r=e.options.glyphMarginClassName;r&&(i[n++]=new DecorationToRender(e.range.startLineNumber,e.range.endLineNumber,r))}return i}prepareRender(e){if(!this._glyphMargin)return void(this._renderResult=null);const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=this._lineHeight.toString(),r='" style="left:'+this._glyphMarginLeft.toString()+"px;width:"+this._glyphMarginWidth.toString()+"px;height:"+o+'px;"></div>',s=[];for(let a=t;a<=i;a++){const e=a-t,i=n[e];0===i.length?s[e]="":s[e]='<div class="cgmr codicon '+i.join(" ")+r}this._renderResult=s}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}var indentGuides="",HorizontalGuidesState,HorizontalGuidesState2;class TextModelPart{constructor(){this._isDisposed=!1}dispose(){this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function computeIndentLevel(e,t){let i=0,n=0;const o=e.length;for(;n<o;){const o=e.charCodeAt(n);if(32===o)i++;else{if(9!==o)break;i=i-i%t+t}n++}return n===o?-1:i}HorizontalGuidesState2=HorizontalGuidesState||(HorizontalGuidesState={}),HorizontalGuidesState2[HorizontalGuidesState2.Disabled=0]="Disabled",HorizontalGuidesState2[HorizontalGuidesState2.EnabledForActive=1]="EnabledForActive",HorizontalGuidesState2[HorizontalGuidesState2.Enabled=2]="Enabled";class IndentGuide{constructor(e,t,i){this.visibleColumn=e,this.className=t,this.horizontalLine=i}}class IndentGuideHorizontalLine{constructor(e,t){this.top=e,this.endColumn=t}}class GuidesTextModelPart extends TextModelPart{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return computeIndentLevel(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new Error("Illegal value for lineNumber");const o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=Boolean(o&&o.offSide);let s=-2,a=-1,l=-2,d=-1;const c=e=>{if(-1!==s&&(-2===s||s>e-1)){s=-1,a=-1;for(let t=e-2;t>=0;t--){const e=this._computeIndentLevel(t);if(e>=0){s=t,a=e;break}}}if(-2===l){l=-1,d=-1;for(let t=e;t<n;t++){const e=this._computeIndentLevel(t);if(e>=0){l=t,d=e;break}}}};let h=-2,u=-1,g=-2,p=-1;const m=e=>{if(-2===h){h=-1,u=-1;for(let t=e-2;t>=0;t--){const e=this._computeIndentLevel(t);if(e>=0){h=t,u=e;break}}}if(-1!==g&&(-2===g||g<e-1)){g=-1,p=-1;for(let t=e;t<n;t++){const e=this._computeIndentLevel(t);if(e>=0){g=t,p=e;break}}}};let f=0,_=!0,C=0,v=!0,b=0,S=0;for(let y=0;_||v;y++){const o=e-y,s=e+y;y>1&&(o<1||o<t)&&(_=!1),y>1&&(s>n||s>i)&&(v=!1),y>5e4&&(_=!1,v=!1);let g=-1;if(_&&o>=1){const e=this._computeIndentLevel(o-1);e>=0?(l=o-1,d=e,g=Math.ceil(e/this.textModel.getOptions().indentSize)):(c(o),g=this._getIndentLevelForWhitespaceLine(r,a,d))}let w=-1;if(v&&s<=n){const e=this._computeIndentLevel(s-1);e>=0?(h=s-1,u=e,w=Math.ceil(e/this.textModel.getOptions().indentSize)):(m(s),w=this._getIndentLevelForWhitespaceLine(r,u,p))}if(0!==y){if(1===y){if(s<=n&&w>=0&&S+1===w){_=!1,f=s,C=s,b=w;continue}if(o>=1&&g>=0&&g-1===S){v=!1,f=o,C=o,b=g;continue}if(f=e,C=e,b=S,0===b)return{startLineNumber:f,endLineNumber:C,indent:b}}_&&(g>=b?f=o:_=!1),v&&(w>=b?C=s:v=!1)}else S=g}return{startLineNumber:f,endLineNumber:C,indent:b}}getLinesBracketGuides(e,t,i,n){var o,r,s,a,l;const d=[],c=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new Range$2(e,1,t,this.textModel.getLineMaxColumn(t)));let h;if(i&&c.length>0){h=null===(o=findLast(e<=i.lineNumber&&i.lineNumber<=t?c.filter((e=>Range$2.strictContainsPosition(e.range,i))):this.textModel.bracketPairs.getBracketPairsInRange(Range$2.fromPositions(i)),(e=>e.range.startLineNumber!==e.range.endLineNumber)))||void 0===o?void 0:o.range}const u=new ArrayQueue(c),g=new Array,p=new Array,m=new BracketPairGuidesClassNames;for(let f=e;f<=t;f++){let e=new Array;p.length>0&&(e=e.concat(p),p.length=0),d.push(e);for(const i of u.takeWhile((e=>e.openingBracketRange.startLineNumber<=f))||[]){if(i.range.startLineNumber===i.range.endLineNumber)continue;const e=Math.min(this.getVisibleColumnFromPosition(i.openingBracketRange.getStartPosition()),this.getVisibleColumnFromPosition(null!==(s=null===(r=i.closingBracketRange)||void 0===r?void 0:r.getStartPosition())&&void 0!==s?s:i.range.getEndPosition()),i.minVisibleColumnIndentation+1);let t=!1;if(i.closingBracketRange){firstNonWhitespaceIndex(this.textModel.getLineContent(i.closingBracketRange.startLineNumber))<i.closingBracketRange.startColumn-1&&(t=!0)}const n=i.openingBracketRange.getStartPosition(),o=null!==(l=null===(a=i.closingBracketRange)||void 0===a?void 0:a.getStartPosition())&&void 0!==l?l:i.range.getEndPosition();void 0===i.closingBracketRange?g[i.nestingLevel]=null:g[i.nestingLevel]={nestingLevel:i.nestingLevel,guideVisibleColumn:e,start:n,visibleStartColumn:this.getVisibleColumnFromPosition(n),end:o,visibleEndColumn:this.getVisibleColumnFromPosition(o),bracketPair:i,renderHorizontalEndLineAtTheBottom:t}}for(const i of g){if(!i)continue;const t=h&&i.bracketPair.range.equalsRange(h),o=m.getInlineClassNameOfLevel(i.nestingLevel)+(n.highlightActive&&t?" "+m.activeClassName:"");(t&&n.horizontalGuides!==HorizontalGuidesState.Disabled||n.includeInactive&&n.horizontalGuides===HorizontalGuidesState.Enabled)&&(i.start.lineNumber===f&&i.guideVisibleColumn<i.visibleStartColumn&&e.push(new IndentGuide(i.guideVisibleColumn,o,new IndentGuideHorizontalLine(!1,i.start.column))),i.end.lineNumber===f+1&&i.guideVisibleColumn<i.visibleEndColumn&&p.push(new IndentGuide(i.guideVisibleColumn,o,new IndentGuideHorizontalLine(!i.renderHorizontalEndLineAtTheBottom,i.end.column))))}let t=Number.MAX_SAFE_INTEGER;for(let i=g.length-1;i>=0;i--){const o=g[i];if(!o)continue;const r=n.highlightActive&&h&&o.bracketPair.range.equalsRange(h),s=m.getInlineClassNameOfLevel(o.nestingLevel)+(r?" "+m.activeClassName:"");(r||n.includeInactive)&&o.renderHorizontalEndLineAtTheBottom&&o.end.lineNumber===f+1&&p.push(new IndentGuide(o.guideVisibleColumn,s,null)),o.end.lineNumber<=f||o.start.lineNumber>=f||(o.guideVisibleColumn>=t&&!r||(t=o.guideVisibleColumn,(r||n.includeInactive)&&e.push(new IndentGuide(o.guideVisibleColumn,s,null))))}e.sort(((e,t)=>e.visibleColumn-t.visibleColumn))}return d}getVisibleColumnFromPosition(e){return CursorColumns.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),o=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=Boolean(o&&o.offSide),s=new Array(t-e+1);let a=-2,l=-1,d=-2,c=-1;for(let h=e;h<=t;h++){const t=h-e,o=this._computeIndentLevel(h-1);if(o>=0)a=h-1,l=o,s[t]=Math.ceil(o/n.indentSize);else{if(-2===a){a=-1,l=-1;for(let e=h-2;e>=0;e--){const t=this._computeIndentLevel(e);if(t>=0){a=e,l=t;break}}}if(-1!==d&&(-2===d||d<h-1)){d=-1,c=-1;for(let e=h;e<i;e++){const t=this._computeIndentLevel(e);if(t>=0){d=e,c=t;break}}}s[t]=this._getIndentLevelForWhitespaceLine(r,l,c)}}return s}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return-1===t||-1===i?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class BracketPairGuidesClassNames{constructor(){this.activeClassName="indent-active"}getInlineClassNameOfLevel(e){return"bracket-indent-guide lvl-"+e%30}}class IndentGuidesOverlay extends DynamicViewOverlay{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(132),n=t.get(44);this._lineHeight=t.get(59),this._spaceWidth=n.spaceWidth,this._maxIndentLeft=-1===i.wrappingColumn?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(13),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(132),n=t.get(44);return this._lineHeight=t.get(59),this._spaceWidth=n.spaceWidth,this._maxIndentLeft=-1===i.wrappingColumn?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(13),!0}onCursorStateChanged(e){var t;const i=e.selections[0].getPosition();return!(null===(t=this._primaryPosition)||void 0===t?void 0:t.equals(i))&&(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){var t,i,n,o;if(!this._bracketPairGuideOptions.indentation&&!1===this._bracketPairGuideOptions.bracketPairs)return void(this._renderResult=null);const r=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber,a=e.scrollWidth,l=this._lineHeight,d=this._primaryPosition,c=this.getGuidesByLine(r,s,d),h=[];for(let u=r;u<=s;u++){const s=u-r,d=c[s];let g="";const p=null!==(i=null===(t=e.visibleRangeForPosition(new Position$1(u,1)))||void 0===t?void 0:t.left)&&void 0!==i?i:0;for(const t of d){const i=p+(t.visibleColumn-1)*this._spaceWidth;if(i>a||this._maxIndentLeft>0&&i>this._maxIndentLeft)break;const r=t.horizontalLine?t.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",s=t.horizontalLine?(null!==(o=null===(n=e.visibleRangeForPosition(new Position$1(u,t.horizontalLine.endColumn)))||void 0===n?void 0:n.left)&&void 0!==o?o:i+this._spaceWidth)-i:this._spaceWidth;g+=`<div class="core-guide ${t.className} ${r}" style="left:${i}px;height:${l}px;width:${s}px"></div>`}h[s]=g}this._renderResult=h}getGuidesByLine(e,t,i){const n=!1!==this._bracketPairGuideOptions.bracketPairs?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:!0===this._bracketPairGuideOptions.bracketPairsHorizontal?HorizontalGuidesState.Enabled:"active"===this._bracketPairGuideOptions.bracketPairsHorizontal?HorizontalGuidesState.EnabledForActive:HorizontalGuidesState.Disabled,includeInactive:!0===this._bracketPairGuideOptions.bracketPairs}):null,o=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let r=0,s=0,a=0;if(this._bracketPairGuideOptions.highlightActiveIndentation&&i){const n=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);r=n.startLineNumber,s=n.endLineNumber,a=n.indent}const{indentSize:l}=this._context.viewModel.model.getOptions(),d=[];for(let c=e;c<=t;c++){const t=new Array;d.push(t);const i=n?n[c-e]:[],h=new ArrayQueue(i),u=o?o[c-e]:[];for(let e=1;e<=u;e++){const n=(e-1)*l+1,o=0===i.length&&r<=c&&c<=s&&e===a;t.push(...h.takeWhile((e=>e.visibleColumn<n))||[]);const d=h.peek();d&&d.visibleColumn===n&&!d.horizontalLine||t.push(new IndentGuide(n,o?"core-guide-indent-active":"core-guide-indent",null))}t.push(...h.takeWhile((e=>!0))||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function transparentToUndefined(e){if(!e||!e.isTransparent())return e}registerThemingParticipant(((e,t)=>{const i=e.getColor(editorIndentGuides);i&&t.addRule(`.monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 ${i} inset; }`);const n=e.getColor(editorActiveIndentGuides)||i;n&&t.addRule(`.monaco-editor .lines-content .core-guide-indent-active { box-shadow: 1px 0 0 0 ${n} inset; }`);const o=[{bracketColor:editorBracketHighlightingForeground1,guideColor:editorBracketPairGuideBackground1,guideColorActive:editorBracketPairGuideActiveBackground1},{bracketColor:editorBracketHighlightingForeground2,guideColor:editorBracketPairGuideBackground2,guideColorActive:editorBracketPairGuideActiveBackground2},{bracketColor:editorBracketHighlightingForeground3,guideColor:editorBracketPairGuideBackground3,guideColorActive:editorBracketPairGuideActiveBackground3},{bracketColor:editorBracketHighlightingForeground4,guideColor:editorBracketPairGuideBackground4,guideColorActive:editorBracketPairGuideActiveBackground4},{bracketColor:editorBracketHighlightingForeground5,guideColor:editorBracketPairGuideBackground5,guideColorActive:editorBracketPairGuideActiveBackground5},{bracketColor:editorBracketHighlightingForeground6,guideColor:editorBracketPairGuideBackground6,guideColorActive:editorBracketPairGuideActiveBackground6}],r=new BracketPairGuidesClassNames,s=o.map((t=>{var i,n;const o=e.getColor(t.bracketColor),r=e.getColor(t.guideColor),s=e.getColor(t.guideColorActive),a=transparentToUndefined(null!==(i=transparentToUndefined(r))&&void 0!==i?i:null==o?void 0:o.transparent(.3)),l=transparentToUndefined(null!==(n=transparentToUndefined(s))&&void 0!==n?n:o);if(a&&l)return{guideColor:a,guideColorActive:l}})).filter(isDefined);if(s.length>0){for(let e=0;e<30;e++){const i=s[e%s.length];t.addRule(`.monaco-editor .${r.getInlineClassNameOfLevel(e).replace(/ /g,".")} { --guide-color: ${i.guideColor}; --guide-color-active: ${i.guideColorActive}; }`)}t.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),t.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),t.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),t.addRule(`.monaco-editor .vertical.${r.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),t.addRule(`.monaco-editor .horizontal-top.${r.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),t.addRule(`.monaco-editor .horizontal-bottom.${r.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}}));var viewLines="";class LastRenderedData{constructor(){this._currentVisibleRange=new Range$2(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class HorizontalRevealRangeRequest{constructor(e,t,i,n,o,r,s){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=o,this.stopScrollTop=r,this.scrollType=s,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class HorizontalRevealSelectionsRequest{constructor(e,t,i,n,o){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=o,this.type="selections";let r=t[0].startLineNumber,s=t[0].endLineNumber;for(let a=1,l=t.length;a<l;a++){const e=t[a];r=Math.min(r,e.startLineNumber),s=Math.max(s,e.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=s}}class ViewLines extends ViewPart{constructor(e,t){super(e),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new VisibleLinesCollection(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration,n=this._context.configuration.options,o=n.get(44),r=n.get(132),s=n.get(131);this._lineHeight=n.get(59),this._typicalHalfwidthCharacterWidth=o.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=n.get(89),this._horizontalScrollbarHeight=s.horizontalScrollbarHeight,this._cursorSurroundingLines=n.get(25),this._cursorSurroundingLinesStyle=n.get(26),this._canUseLayerHinting=!n.get(28),this._viewLineOptions=new ViewLineOptions(i,this._context.theme.type),PartFingerprints.write(this.domNode,7),this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),applyFontInfo(this.domNode,o),this._maxLineWidth=0,this._asyncUpdateLineWidths=new RunOnceScheduler((()=>{this._updateLineWidthsSlow()}),200),this._asyncCheckMonospaceFontAssumptions=new RunOnceScheduler((()=>{this._checkMonospaceFontAssumptions()}),2e3),this._lastRenderedData=new LastRenderedData,this._horizontalRevealRequest=null}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}createVisibleLine(){return new ViewLine(this._viewLineOptions)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(132)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(44),n=t.get(132),o=t.get(131);return this._lineHeight=t.get(59),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(89),this._horizontalScrollbarHeight=o.horizontalScrollbarHeight,this._cursorSurroundingLines=t.get(25),this._cursorSurroundingLinesStyle=t.get(26),this._canUseLayerHinting=!t.get(28),applyFontInfo(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(131)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new ViewLineOptions(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const e=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let t=e;t<=i;t++){this._visibleLines.getVisibleLine(t).onOptionsChanged(this._viewLineOptions)}return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let o=t;o<=i;o++)n=this._visibleLines.getVisibleLine(o).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const e=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let i=e;i<=t;i++)this._visibleLines.getVisibleLine(i).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(-1===t)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new HorizontalRevealRangeRequest(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new HorizontalRevealSelectionsRequest(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const n=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,n),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(null===i)return null;const n=this._getLineNumberFor(i);if(-1===n)return null;if(n<1||n>this._context.viewModel.getLineCount())return null;if(1===this._context.viewModel.getLineMaxColumn(n))return new Position$1(n,1);const o=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(n<o||n>r)return null;let s=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(n,e,t);const a=this._context.viewModel.getLineMinColumn(n);return s<a&&(s=a),new Position$1(n,s)}_getViewLineDomNode(e){for(;e&&1===e.nodeType;){if(e.className===ViewLine.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){if(e===this._visibleLines.getVisibleLine(n).getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();return e<t||e>i?-1:this._visibleLines.getVisibleLine(e).getWidth()}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=Range$2.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;let o=[],r=0;const s=new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot);let a=0;t&&(a=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(n.startLineNumber,1)).lineNumber);const l=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let c=n.startLineNumber;c<=n.endLineNumber;c++){if(c<l||c>d)continue;const e=c===n.startLineNumber?n.startColumn:1,h=c===n.endLineNumber?n.endColumn:this._context.viewModel.getLineMaxColumn(c),u=this._visibleLines.getVisibleLine(c).getVisibleRangesForRange(c,e,h,s);if(u){if(t&&c<i){const e=a;a=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(c+1,1)).lineNumber,e!==a&&(u.ranges[u.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}o[r++]=new LineVisibleRanges(u.outsideRenderedLine,c,HorizontalRange.from(u.ranges))}}return 0===r?null:o}_visibleRangesForLineRange(e,t,i){return this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber()?null:this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,new DomReadingContext(this.domNode.domNode,this._textRangeRestingSpot))}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new HorizontalPosition(t.outsideRenderedLine,t.ranges[0].left):null}updateLineWidths(){this._updateLineWidths(!1)}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,o=!0;for(let r=t;r<=i;r++){const t=this._visibleLines.getVisibleLine(r);!e||t.getWidthIsFast()?n=Math.max(n,t.getWidth()):o=!1}return o&&1===t&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),o}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let o=i;o<=n;o++){const i=this._visibleLines.getVisibleLine(o);if(i.needsMonospaceFontCheck()){const n=i.getWidth();n>t&&(t=n,e=o)}}if(-1!==e&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let o=i;o<=n;o++){this._visibleLines.getVisibleLine(o).onMonospaceAssumptionsInvalidated()}}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const t=this._horizontalRevealRequest;if(e.startLineNumber<=t.minLineNumber&&t.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const e=this._computeScrollLeftToReveal(t);e&&(this._isViewportWrapping||this._ensureMaxLineWidth(e.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:e.scrollLeft},t.scrollType))}}if(this._updateLineWidthsFast()||this._asyncUpdateLineWidths.schedule(),isLinux&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const e=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let i=e;i<=t;i++){if(this._visibleLines.getVisibleLine(i).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,o,r){const s=e.top,a=e.height,l=s+a;let d,c,h;if(o&&o.length>0){let e=o[0].startLineNumber,t=o[0].endLineNumber;for(let i=1,n=o.length;i<n;i++){const n=o[i];e=Math.min(e,n.startLineNumber),t=Math.max(t,n.endLineNumber)}d=!1,c=this._context.viewLayout.getVerticalOffsetForLineNumber(e),h=this._context.viewLayout.getVerticalOffsetForLineNumber(t)+this._lineHeight}else{if(!n)return-1;d=!0,c=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight}if(("mouse"===t||i)&&"default"===this._cursorSurroundingLinesStyle)i||(c-=this._lineHeight);else{const e=Math.min(a/this._lineHeight/2,this._cursorSurroundingLines);c-=e*this._lineHeight,h+=Math.max(0,e-1)*this._lineHeight}let u;if(0!==r&&4!==r||(h+=i?this._horizontalScrollbarHeight:this._lineHeight),h-c>a){if(!d)return-1;u=c}else if(5===r||6===r)if(6===r&&s<=c&&h<=l)u=s;else{const e=c-Math.max(5*this._lineHeight,.2*a),t=h-a;u=Math.max(t,e)}else if(1===r||2===r)if(2===r&&s<=c&&h<=l)u=s;else{const e=(c+h)/2;u=Math.max(0,e-a/2)}else u=this._computeMinimumScrolling(s,l,c,h,3===r,4===r);return u}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=t.left,n=i+t.width;let o=1073741824,r=0;if("range"===e.type){const t=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!t)return null;for(const e of t.ranges)o=Math.min(o,Math.round(e.left)),r=Math.max(r,Math.round(e.left+e.width))}else for(const s of e.selections){if(s.startLineNumber!==s.endLineNumber)return null;const e=this._visibleRangesForLineRange(s.startLineNumber,s.startColumn,s.endColumn);if(!e)return null;for(const t of e.ranges)o=Math.min(o,Math.round(t.left)),r=Math.max(r,Math.round(t.left+t.width))}if(e.minimalReveal||(o=Math.max(0,o-ViewLines.HORIZONTAL_EXTRA_PX),r+=this._revealHorizontalRightPadding),"selections"===e.type&&r-o>t.width)return null;return{scrollLeft:this._computeMinimumScrolling(i,n,o,r),maxHorizontalOffset:r}}_computeMinimumScrolling(e,t,i,n,o,r){o=!!o,r=!!r;const s=(t|=0)-(e|=0);return(n|=0)-(i|=0)<s?o?i:r?Math.max(0,n-s):i<e?i:n>t?Math.max(0,n-s):e:i}}ViewLines.HORIZONTAL_EXTRA_PX=30;var linesDecorations="";class LinesDecorationsOverlay extends DedupOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options.get(131);this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options.get(131);return this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const e=t[o],r=e.options.linesDecorationsClassName;r&&(i[n++]=new DecorationToRender(e.range.startLineNumber,e.range.endLineNumber,r));const s=e.options.firstLineDecorationClassName;s&&(i[n++]=new DecorationToRender(e.range.startLineNumber,e.range.startLineNumber,s))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',r=[];for(let s=t;s<=i;s++){const e=s-t,i=n[e];let a="";for(let t=0,n=i.length;t<n;t++)a+='<div class="cldr '+i[t]+o;r[e]=a}this._renderResult=r}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}var marginDecorations="";class MarginViewLineDecorationsOverlay extends DedupOverlay{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let o=0,r=t.length;o<r;o++){const e=t[o],r=e.options.marginClassName;r&&(i[n++]=new DecorationToRender(e.range.startLineNumber,e.range.endLineNumber,r))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),o=[];for(let r=t;r<=i;r++){const e=r-t,i=n[e];let s="";for(let t=0,n=i.length;t<n;t++)s+='<div class="cmdr '+i[t]+'" style=""></div>';o[e]=s}this._renderResult=o}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}var minimap="";class RGBA8{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=RGBA8._clamp(e),this.g=RGBA8._clamp(t),this.b=RGBA8._clamp(i),this.a=RGBA8._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:0|e}}RGBA8.Empty=new RGBA8(0,0,0,0);class MinimapTokensColorTracker extends Disposable{constructor(){super(),this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(TokenizationRegistry.onDidChange((e=>{e.changedColorMap&&this._updateColorMap()})))}static getInstance(){return this._INSTANCE||(this._INSTANCE=markAsSingleton(new MinimapTokensColorTracker)),this._INSTANCE}_updateColorMap(){const e=TokenizationRegistry.getColorMap();if(!e)return this._colors=[RGBA8.Empty],void(this._backgroundIsLight=!0);this._colors=[RGBA8.Empty];for(let i=1;i<e.length;i++){const t=e[i].rgba;this._colors[i]=new RGBA8(t.r,t.g,t.b,Math.round(255*t.a))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}}MinimapTokensColorTracker._INSTANCE=null;class Viewport{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=0|e,this.left=0|t,this.width=0|i,this.height=0|n}}class MinimapLinesRenderingData{constructor(e,t){this.tabSize=e,this.data=t}}class ViewLineData{constructor(e,t,i,n,o,r,s){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=o,this.tokens=r,this.inlineDecorations=s}}class ViewLineRenderingData{constructor(e,t,i,n,o,r,s,a,l,d){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=ViewLineRenderingData.isBasicASCII(i,r),this.containsRTL=ViewLineRenderingData.containsRTL(i,this.isBasicASCII,o),this.tokens=s,this.inlineDecorations=a,this.tabSize=l,this.startVisibleColumn=d}static isBasicASCII(e,t){return!t||isBasicASCII(e)}static containsRTL(e,t,i){return!(t||!i)&&containsRTL(e)}}class InlineDecoration{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class SingleLineInlineDecoration{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new InlineDecoration(new Range$2(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class ViewModelDecoration{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class OverviewRulerDecorationsGroup{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static cmp(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}}const allCharCodes=(()=>{const e=[];for(let t=32;t<=126;t++)e.push(t);return e.push(65533),e})(),getCharIndex=(e,t)=>(e-=32)<0||e>96?t<=2?(e+96)%96:95:e;class MinimapCharRenderer{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=MinimapCharRenderer.soften(e,.8),this.charDataLight=MinimapCharRenderer.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,o=e.length;n<o;n++)i[n]=toUint8(e[n]*t);return i}renderChar(e,t,i,n,o,r,s,a,l,d,c){const h=1*this.scale,u=2*this.scale,g=c?1:u;if(t+h>e.width||i+g>e.height)return;const p=d?this.charDataLight:this.charDataNormal,m=getCharIndex(n,l),f=4*e.width,_=s.r,C=s.g,v=s.b,b=o.r-_,S=o.g-C,y=o.b-v,w=Math.max(r,a),E=e.data;let L=m*h*u,x=i*f+4*t;for(let D=0;D<g;D++){let e=x;for(let t=0;t<h;t++){const t=p[L++]/255*(r/255);E[e++]=_+b*t,E[e++]=C+S*t,E[e++]=v+y*t,E[e++]=w}x+=f}}blockRenderChar(e,t,i,n,o,r,s,a){const l=1*this.scale,d=2*this.scale,c=a?1:d;if(t+l>e.width||i+c>e.height)return;const h=4*e.width,u=o/255*.5,g=r.r,p=r.g,m=r.b,f=g+(n.r-g)*u,_=p+(n.g-p)*u,C=m+(n.b-m)*u,v=Math.max(o,s),b=e.data;let S=i*h+4*t;for(let y=0;y<c;y++){let e=S;for(let t=0;t<l;t++)b[e++]=f,b[e++]=_,b[e++]=C,b[e++]=v;S+=h}}}const charTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},decodeData=e=>{const t=new Uint8ClampedArray(e.length/2);for(let i=0;i<e.length;i+=2)t[i>>1]=charTable[e[i]]<<4|15&charTable[e[i+1]];return t},prebakedMiniMaps={1:once$1((()=>decodeData("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792"))),2:once$1((()=>decodeData("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126")))};class MinimapCharRendererFactory{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return i=prebakedMiniMaps[e]?new MinimapCharRenderer(prebakedMiniMaps[e](),e):MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=960,t.style.width="960px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const o of allCharCodes)i.fillText(String.fromCharCode(o),n,8),n+=10;return i.getImageData(0,0,960,16)}static createFromSampleData(e,t){if(61440!==e.length)throw new Error("Unexpected source in MinimapCharRenderer");const i=MinimapCharRendererFactory._downsample(e,t);return new MinimapCharRenderer(i,t)}static _downsampleChar(e,t,i,n,o){const r=1*o,s=2*o;let a=n,l=0;for(let d=0;d<s;d++){const n=d/s*16,o=(d+1)/s*16;for(let s=0;s<r;s++){const d=s/r*10,c=(s+1)/r*10;let h=0,u=0;for(let i=n;i<o;i++){const n=t+3840*Math.floor(i),o=1-(i-Math.floor(i));for(let t=d;t<c;t++){const i=1-(t-Math.floor(t)),r=n+4*Math.floor(t),s=i*o;u+=s,h+=e[r]*e[r+3]/255*s}}const g=h/u;l=Math.max(l,g),i[a++]=toUint8(g)}}return l}static _downsample(e,t){const i=2*t*1*t,n=96*i,o=new Uint8ClampedArray(n);let r=0,s=0,a=0;for(let l=0;l<96;l++)a=Math.max(a,this._downsampleChar(e,s,o,r,t)),r+=i,s+=40;if(a>0){const e=255/a;for(let t=0;t<n;t++)o[t]*=e}return o}}var OverviewRulerLane$1,OverviewRulerLane2,MinimapPosition$1,MinimapPosition2,InjectedTextCursorStops$1,InjectedTextCursorStops2;OverviewRulerLane2=OverviewRulerLane$1||(OverviewRulerLane$1={}),OverviewRulerLane2[OverviewRulerLane2.Left=1]="Left",OverviewRulerLane2[OverviewRulerLane2.Center=2]="Center",OverviewRulerLane2[OverviewRulerLane2.Right=4]="Right",OverviewRulerLane2[OverviewRulerLane2.Full=7]="Full",MinimapPosition2=MinimapPosition$1||(MinimapPosition$1={}),MinimapPosition2[MinimapPosition2.Inline=1]="Inline",MinimapPosition2[MinimapPosition2.Gutter=2]="Gutter",InjectedTextCursorStops2=InjectedTextCursorStops$1||(InjectedTextCursorStops$1={}),InjectedTextCursorStops2[InjectedTextCursorStops2.Both=0]="Both",InjectedTextCursorStops2[InjectedTextCursorStops2.Right=1]="Right",InjectedTextCursorStops2[InjectedTextCursorStops2.Left=2]="Left",InjectedTextCursorStops2[InjectedTextCursorStops2.None=3]="None";class TextModelResolvedOptions{constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|e.tabSize),this.indentSize=0|e.tabSize,this.insertSpaces=Boolean(e.insertSpaces),this.defaultEOL=0|e.defaultEOL,this.trimAutoWhitespace=Boolean(e.trimAutoWhitespace),this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&equals(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class FindMatch{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class ValidAnnotatedEditOperation{constructor(e,t,i,n,o,r){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=o,this._isTracked=r}}class SearchData{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class ApplyEditsResult{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function shouldSynchronizeModel(e){return!e.isTooLargeForSyncing()&&!e.isForSimpleWidget}const MOUSE_DRAG_RESET_DISTANCE=140,GUTTER_DECORATION_WIDTH=2;class MinimapOptions{constructor(e,t,i){const n=e.options,o=n.get(129),r=n.get(131),s=r.minimap,a=n.get(44),l=n.get(65);this.renderMinimap=s.renderMinimap,this.size=l.size,this.minimapHeightIsEditorHeight=s.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(94),this.showSlider=l.showSlider,this.pixelRatio=o,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(59),this.minimapLeft=s.minimapLeft,this.minimapWidth=s.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=s.minimapCanvasInnerWidth,this.canvasInnerHeight=s.minimapCanvasInnerHeight,this.canvasOuterWidth=s.minimapCanvasOuterWidth,this.canvasOuterHeight=s.minimapCanvasOuterHeight,this.isSampling=s.minimapIsSampling,this.editorHeight=r.height,this.fontScale=s.minimapScale,this.minimapLineHeight=s.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.charRenderer=once$1((()=>MinimapCharRendererFactory.create(this.fontScale,a.fontFamily))),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=MinimapOptions._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=MinimapOptions._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(minimapBackground);return i?new RGBA8(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(minimapForegroundOpacity);return t?RGBA8._clamp(Math.round(255*t.rgba.a)):255}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.showSlider===e.showSlider&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class MinimapLayout{constructor(e,t,i,n,o,r,s,a){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=o,this.sliderHeight=r,this.startLineNumber=s,this.endLineNumber=a}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}static create(e,t,i,n,o,r,s,a,l,d,c){const h=e.pixelRatio,u=e.minimapLineHeight,g=Math.floor(e.canvasInnerHeight/u),p=e.lineHeight;if(e.minimapHeightIsEditorHeight){const t=a*e.lineHeight+(e.scrollBeyondLastLine?o-e.lineHeight:0),i=Math.max(1,Math.floor(o*o/t)),n=Math.max(0,e.minimapHeight-i),r=n/(d-o),c=l*r,h=n>0,u=Math.floor(e.canvasInnerHeight/e.minimapLineHeight);return new MinimapLayout(l,d,h,r,c,i,1,Math.min(s,u))}let m,f;if(r&&i!==s){const e=i-t+1;m=Math.floor(e*u/h)}else{const e=o/p;m=Math.floor(e*u/h)}f=e.scrollBeyondLastLine?(s-1)*u/h:Math.max(0,s*u/h-m),f=Math.min(e.minimapHeight-m,f);const _=f/(d-o),C=l*_;let v=0;if(e.scrollBeyondLastLine){v=o/p-1}if(g>=s+v){return new MinimapLayout(l,d,f>0,_,C,m,1,s)}{let e=Math.max(1,Math.floor(t-C*h/u));c&&c.scrollHeight===d&&(c.scrollTop>l&&(e=Math.min(e,c.startLineNumber)),c.scrollTop<l&&(e=Math.max(e,c.startLineNumber)));const i=Math.min(s,e+g-1);return new MinimapLayout(l,d,!0,_,(t-e+(l-n)/p)*u/h,m,e,i)}}}class MinimapLine{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}}MinimapLine.INVALID=new MinimapLine(-1);class RenderData{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new RenderedLinesCollection((()=>MinimapLine.INVALID)),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const t=this._renderedLines._get().lines;for(let i=0,n=t.length;i<n;i++)if(-1===t[i].dy)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class MinimapBuffers{constructor(e,t,i,n){this._backgroundFillData=MinimapBuffers._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,o=i.g,r=i.b,s=i.a,a=new Uint8ClampedArray(e*t*4);let l=0;for(let d=0;d<t;d++)for(let t=0;t<e;t++)a[l]=n,a[l+1]=o,a[l+2]=r,a[l+3]=s,l+=4;return a}}class MinimapSamplingState{constructor(e,t){this.samplingRatio=e,this.minimapLines=t}static compute(e,t,i){if(0===e.renderMinimap||!e.isSampling)return[null,[]];const n=e.pixelRatio,o=e.lineHeight,r=e.scrollBeyondLastLine,{minimapLineCount:s}=EditorLayoutInfoComputer.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:r,height:e.editorHeight,lineHeight:o,pixelRatio:n}),a=t/s,l=a/2;if(!i||0===i.minimapLines.length){const e=[];if(e[0]=1,s>1){for(let t=0,i=s-1;t<i;t++)e[t]=Math.round(t*a+l);e[s-1]=t}return[new MinimapSamplingState(a,e),[]]}const d=i.minimapLines,c=d.length,h=[];let u=0,g=0,p=1;let m=[],f=null;for(let _=0;_<s;_++){const e=Math.max(p,Math.round(_*a)),i=Math.max(e,Math.round((_+1)*a));for(;u<c&&d[u]<e;){if(m.length<10){const e=u+1+g;f&&"deleted"===f.type&&f._oldIndex===u-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:u,deleteFromLineNumber:e,deleteToLineNumber:e},m.push(f)),g--}u++}let n;if(u<c&&d[u]<=i)n=d[u],u++;else if(n=0===_?1:_+1===s?t:Math.round(_*a+l),m.length<10){const e=u+1+g;f&&"inserted"===f.type&&f._i===_-1?f.insertToLineNumber++:(f={type:"inserted",_i:_,insertFromLineNumber:e,insertToLineNumber:e},m.push(f)),g++}h[_]=n,p=n}if(m.length<10)for(;u<c;){const e=u+1+g;f&&"deleted"===f.type&&f._oldIndex===u-1?f.deleteToLineNumber++:(f={type:"deleted",_oldIndex:u,deleteFromLineNumber:e,deleteToLineNumber:e},m.push(f)),g--,u++}else m=[{type:"flush"}];return[new MinimapSamplingState(a,h),m]}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const n=this.minimapLines[i];if(n<e||n>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let o=this.minimapLines.length-1;o>=0&&!(this.minimapLines[o]<e.fromLineNumber);o--)this.minimapLines[o]<=e.toLineNumber?(this.minimapLines[o]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,o),n=Math.max(n,o)):this.minimapLines[o]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class Minimap extends ViewPart{constructor(e){super(e),this.tokensColorTracker=MinimapTokensColorTracker.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new InnerMinimap(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new MinimapOptions(this._context.configuration,this._context.theme,this.tokensColorTracker);return!this.options.equals(e)&&(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return!!e.affectsMinimap&&this._actual.onDecorationsChanged()}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.toLineNumber);return!!t&&this._actual.onLinesChanged(t[0],t[1])}return this._actual.onLinesChanged(e.fromLineNumber,e.toLineNumber)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i+1),this._shouldCheckSampling=!0,!0}return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const e=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);e&&t.push({fromLineNumber:e[0],toLineNumber:e[1]})}return!!t.length&&this._actual.onTokensChanged(t)}return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=Boolean(this._samplingState),[t,i]=MinimapSamplingState.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed()}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let o=0,r=t-e+1;o<r;o++)i[o]?n[o]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+o-1]):n[o]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(null===this._minimapSelections)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new Selection$1(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const n=this._samplingState.minimapLines[e-1],o=this._samplingState.minimapLines[t-1];i=new Range$2(n,1,o,this._context.viewModel.getLineMaxColumn(o))}else i=new Range$2(e,1,t,this._context.viewModel.getLineMaxColumn(t));const n=this._context.viewModel.getDecorationsInViewport(i);if(this._samplingState){const e=[];for(const t of n){if(!t.options.minimap)continue;const i=t.range,n=this._samplingState.modelLineToMinimapLine(i.startLineNumber),o=this._samplingState.modelLineToMinimapLine(i.endLineNumber);e.push(new ViewModelDecoration(new Range$2(n,i.startColumn,o,i.endColumn),t.options))}return e}return n}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new Range$2(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class InnerMinimap extends Disposable{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(minimapSelection),this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,8),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=createFastDomNode(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=createFastDomNode(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=createFastDomNode(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=createFastDomNode(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=createFastDomNode(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._mouseDownListener=addStandardDisposableListener(this._domNode.domNode,"mousedown",(e=>{e.preventDefault();if(0===this._model.options.renderMinimap)return;if(!this._lastRenderData)return;if("proportional"!==this._model.options.size){if(e.leftButton&&this._lastRenderData){const t=getDomNodePagePosition(this._slider.domNode),i=t.top+t.height/2;this._startSliderDragging(e.buttons,e.posx,i,e.posy,this._lastRenderData.renderedLayout)}return}const t=this._model.options.minimapLineHeight,i=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*e.browserEvent.offsetY;let n=Math.floor(i/t)+this._lastRenderData.renderedLayout.startLineNumber;n=Math.min(n,this._model.getLineCount()),this._model.revealLineNumber(n)})),this._sliderMouseMoveMonitor=new GlobalMouseMoveMonitor,this._sliderMouseDownListener=addStandardDisposableListener(this._slider.domNode,"mousedown",(e=>{e.preventDefault(),e.stopPropagation(),e.leftButton&&this._lastRenderData&&this._startSliderDragging(e.buttons,e.posx,e.posy,e.posy,this._lastRenderData.renderedLayout)})),this._gestureDisposable=Gesture.addTarget(this._domNode.domNode),this._sliderTouchStartListener=addDisposableListener(this._domNode.domNode,EventType.Start,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(e))}),{passive:!1}),this._sliderTouchMoveListener=addDisposableListener(this._domNode.domNode,EventType.Change,(e=>{e.preventDefault(),e.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(e)}),{passive:!1}),this._sliderTouchEndListener=addStandardDisposableListener(this._domNode.domNode,EventType.End,(e=>{e.preventDefault(),e.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)}))}_startSliderDragging(e,t,i,n,o){this._slider.toggleClassName("active",!0);const r=(e,n)=>{const r=Math.abs(n-t);if(isWindows&&r>MOUSE_DRAG_RESET_DISTANCE)return void this._model.setScrollTop(o.scrollTop);const s=e-i;this._model.setScrollTop(o.getDesiredScrollTopFromDelta(s))};n!==i&&r(n,t),this._sliderMouseMoveMonitor.startMonitoring(this._slider.domNode,e,standardMouseMoveMerger,(e=>r(e.posy,e.posx)),(()=>{this._slider.toggleClassName("active",!1)}))}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._mouseDownListener.dispose(),this._sliderMouseMoveMonitor.dispose(),this._sliderMouseDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){return"always"===this._model.options.showSlider?"minimap slider-always":"minimap slider-mouseover"}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new MinimapBuffers(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return!!this._lastRenderData&&this._lastRenderData.onLinesChanged(e,t)}onLinesDeleted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData&&this._lastRenderData.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(minimapSelection),this._renderDecorations=!0,!0}onTokensChanged(e){return!!this._lastRenderData&&this._lastRenderData.onTokensChanged(e)}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(0===this._model.options.renderMinimap)return this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),void this._sliderHorizontal.setHeight(0);e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const t=MinimapLayout.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(t.sliderNeeded?"block":"none"),this._slider.setTop(t.sliderTop),this._slider.setHeight(t.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(t.sliderHeight),this.renderDecorations(t),this._lastRenderData=this.renderLines(t)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(Range$2.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort(((e,t)=>(e.options.zIndex||0)-(t.options.zIndex||0)));const{canvasInnerWidth:n,canvasInnerHeight:o}=this._model.options,r=this._model.options.minimapLineHeight,s=this._model.options.minimapCharWidth,a=this._model.getOptions().tabSize,l=this._decorationsCanvas.domNode.getContext("2d");l.clearRect(0,0,n,o);const d=new ContiguousLineMap(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(l,t,d,e,r),this._renderDecorationsLineHighlights(l,i,d,e,r);const c=new ContiguousLineMap(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(l,t,c,e,r,a,s,n),this._renderDecorationsHighlights(l,i,c,e,r,a,s,n)}}_renderSelectionLineHighlights(e,t,i,n,o){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,s=0;for(const a of t){const t=Math.max(n.startLineNumber,a.startLineNumber),l=Math.min(n.endLineNumber,a.endLineNumber);if(t>l)continue;for(let e=t;e<=l;e++)i.set(e,!0);const d=(t-n.startLineNumber)*o,c=(l-n.startLineNumber)*o+o;s>=d||(s>r&&e.fillRect(MINIMAP_GUTTER_WIDTH,r,e.canvas.width,s-r),r=d),s=c}s>r&&e.fillRect(MINIMAP_GUTTER_WIDTH,r,e.canvas.width,s-r)}_renderDecorationsLineHighlights(e,t,i,n,o){const r=new Map;for(let s=t.length-1;s>=0;s--){const a=t[s],l=a.options.minimap;if(!l||l.position!==MinimapPosition$1.Inline)continue;const d=Math.max(n.startLineNumber,a.range.startLineNumber),c=Math.min(n.endLineNumber,a.range.endLineNumber);if(d>c)continue;const h=l.getColor(this._theme.value);if(!h||h.isTransparent())continue;let u=r.get(h.toString());u||(u=h.transparent(.5).toString(),r.set(h.toString(),u)),e.fillStyle=u;for(let t=d;t<=c;t++){if(i.has(t))continue;i.set(t,!0);const r=(d-n.startLineNumber)*o;e.fillRect(MINIMAP_GUTTER_WIDTH,r,e.canvas.width,o)}}}_renderSelectionsHighlights(e,t,i,n,o,r,s,a){if(this._selectionColor&&!this._selectionColor.isTransparent())for(const l of t){const t=Math.max(n.startLineNumber,l.startLineNumber),d=Math.min(n.endLineNumber,l.endLineNumber);if(!(t>d))for(let c=t;c<=d;c++)this.renderDecorationOnLine(e,i,l,this._selectionColor,n,c,o,o,r,s,a)}}_renderDecorationsHighlights(e,t,i,n,o,r,s,a){for(const l of t){const t=l.options.minimap;if(!t)continue;const d=Math.max(n.startLineNumber,l.range.startLineNumber),c=Math.min(n.endLineNumber,l.range.endLineNumber);if(d>c)continue;const h=t.getColor(this._theme.value);if(h&&!h.isTransparent())for(let u=d;u<=c;u++)switch(t.position){case MinimapPosition$1.Inline:this.renderDecorationOnLine(e,i,l.range,h,n,u,o,o,r,s,a);continue;case MinimapPosition$1.Gutter:{const t=(u-n.startLineNumber)*o,i=2;this.renderDecoration(e,h,i,t,GUTTER_DECORATION_WIDTH,o);continue}}}}renderDecorationOnLine(e,t,i,n,o,r,s,a,l,d,c){const h=(r-o.startLineNumber)*a;if(h+s<0||h>this._model.options.canvasInnerHeight)return;const{startLineNumber:u,endLineNumber:g}=i,p=u===r?i.startColumn:1,m=g===r?i.endColumn:this._model.getLineMaxColumn(r),f=this.getXOffsetForPosition(t,r,p,l,d,c),_=this.getXOffsetForPosition(t,r,m,l,d,c);this.renderDecoration(e,n,f,h,_-f,s)}getXOffsetForPosition(e,t,i,n,o,r){if(1===i)return MINIMAP_GUTTER_WIDTH;if((i-1)*o>=r)return r;let s=e.get(t);if(!s){const i=this._model.getLineContent(t);s=[MINIMAP_GUTTER_WIDTH];let a=MINIMAP_GUTTER_WIDTH;for(let e=1;e<i.length+1;e++){const t=i.charCodeAt(e-1),l=a+(9===t?n*o:isFullWidthCharacter(t)?2*o:o);if(l>=r){s[e]=r;break}s[e]=l,a=l}e.set(t,s)}return i-1<s.length?s[i-1]:r}renderDecoration(e,t,i,n,o,r){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,o,r)}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const t=this._lastRenderData._get();return new RenderData(e,t.imageData,t.lines)}const o=this._getBuffer();if(!o)return null;const[r,s,a]=InnerMinimap._renderUntouchedLines(o,t,i,n,this._lastRenderData),l=this._model.getMinimapLinesRenderingData(t,i,a),d=this._model.getOptions().tabSize,c=this._model.options.defaultBackgroundColor,h=this._model.options.backgroundColor,u=this._model.options.foregroundAlpha,g=this._model.tokensColorTracker,p=g.backgroundIsLight(),m=this._model.options.renderMinimap,f=this._model.options.charRenderer(),_=this._model.options.fontScale,C=this._model.options.minimapCharWidth,v=(1===m?2:3)*_,b=n>v?Math.floor((n-v)/2):0,S=h.a/255,y=new RGBA8(Math.round((h.r-c.r)*S+c.r),Math.round((h.g-c.g)*S+c.g),Math.round((h.b-c.b)*S+c.b),255);let w=0;const E=[];for(let D=0,I=i-t+1;D<I;D++)a[D]&&InnerMinimap._renderLine(o,y,h.a,p,m,C,g,u,f,w,b,d,l[D],_,n),E[D]=new MinimapLine(w),w+=n;const L=-1===r?0:r,x=(-1===s?o.height:s)-L;return this._canvas.domNode.getContext("2d").putImageData(o,0,0,0,L,o.width,x),new RenderData(e,o,E)}static _renderUntouchedLines(e,t,i,n,o){const r=[];if(!o){for(let e=0,n=i-t+1;e<n;e++)r[e]=!0;return[-1,-1,r]}const s=o._get(),a=s.imageData.data,l=s.rendLineNumberStart,d=s.lines,c=d.length,h=e.width,u=e.data,g=(i-t+1)*n*h*4;let p=-1,m=-1,f=-1,_=-1,C=-1,v=-1,b=0;for(let S=t;S<=i;S++){const e=S-t,i=S-l,o=i>=0&&i<c?d[i].dy:-1;if(-1===o){r[e]=!0,b+=n;continue}const s=o*h*4,y=(o+n)*h*4,w=b*h*4,E=(b+n)*h*4;_===s&&v===w?(_=y,v=E):(-1!==f&&(u.set(a.subarray(f,_),C),-1===p&&0===f&&f===C&&(p=_),-1===m&&_===g&&f===C&&(m=f)),f=s,_=y,C=w,v=E),r[e]=!1,b+=n}-1!==f&&(u.set(a.subarray(f,_),C),-1===p&&0===f&&f===C&&(p=_),-1===m&&_===g&&f===C&&(m=f));return[-1===p?-1:p/(4*h),-1===m?-1:m/(4*h),r]}static _renderLine(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p){const m=u.content,f=u.tokens,_=e.width-r,C=1===p;let v=MINIMAP_GUTTER_WIDTH,b=0,S=0;for(let y=0,w=f.getCount();y<w;y++){const u=f.getEndOffset(y),p=f.getForeground(y),w=s.getColor(p);for(;b<u;b++){if(v>_)return;const s=m.charCodeAt(b);if(9===s){const e=h-(b+S)%h;S+=e-1,v+=e*r}else if(32===s)v+=r;else{const h=isFullWidthCharacter(s)?2:1;for(let u=0;u<h;u++)if(2===o?l.blockRenderChar(e,v,d+c,w,a,t,i,C):l.renderChar(e,v,d+c,s,w,a,t,i,g,n,C),v+=r,v>_)return}}}}}class ContiguousLineMap{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,o=this._endLineNumber-this._startLineNumber+1;n<o;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}registerThemingParticipant(((e,t)=>{const i=e.getColor(minimapSliderBackground);i&&t.addRule(`.monaco-editor .minimap-slider .minimap-slider-horizontal { background: ${i}; }`);const n=e.getColor(minimapSliderHoverBackground);n&&t.addRule(`.monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: ${n}; }`);const o=e.getColor(minimapSliderActiveBackground);o&&t.addRule(`.monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: ${o}; }`);const r=e.getColor(scrollbarShadow);r&&t.addRule(`.monaco-editor .minimap-shadow-visible { box-shadow: ${r} -6px 0 6px -6px inset; }`)}));var overlayWidgets="";class ViewOverlayWidgets extends ViewPart{constructor(e){super(e);const t=this._context.configuration.options.get(131);this._widgets={},this._verticalScrollbarWidth=t.verticalScrollbarWidth,this._minimapWidth=t.minimap.minimapWidth,this._horizontalScrollbarHeight=t.horizontalScrollbarHeight,this._editorHeight=t.height,this._editorWidth=t.width,this._domNode=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._domNode,4),this._domNode.setClassName("overlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options.get(131);return this._verticalScrollbarWidth=t.verticalScrollbarWidth,this._minimapWidth=t.minimap.minimapWidth,this._horizontalScrollbarHeight=t.horizontalScrollbarHeight,this._editorHeight=t.height,this._editorWidth=t.width,!0}addWidget(e){const t=createFastDomNode(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),this._domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference!==t&&(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const e=this._widgets[t].domNode.domNode;delete this._widgets[t],e.parentNode.removeChild(e),this.setShouldRender()}}_renderWidget(e){const t=e.domNode;if(null!==e.preference)if(0===e.preference)t.setTop(0),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth);else if(1===e.preference){const e=t.domNode.clientHeight;t.setTop(this._editorHeight-e-2*this._horizontalScrollbarHeight),t.setRight(2*this._verticalScrollbarWidth+this._minimapWidth)}else 2===e.preference&&(t.setTop(0),t.domNode.style.right="50%");else t.unsetTop()}prepareRender(e){}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets);for(let i=0,n=t.length;i<n;i++){const e=t[i];this._renderWidget(this._widgets[e])}}}class Settings{constructor(e,t){const i=e.options;this.lineHeight=i.get(59),this.pixelRatio=i.get(129),this.overviewRulerLanes=i.get(74),this.renderBorder=i.get(73);const n=t.getColor(editorOverviewRulerBorder);this.borderColor=n?n.toString():null,this.hideCursor=i.get(52);const o=t.getColor(editorCursorForeground);this.cursorColor=o?o.transparent(.7).toString():null,this.themeType=t.type;const r=i.get(65),s=r.enabled,a=r.side,l=s?t.getColor(editorOverviewRulerBackground)||TokenizationRegistry.getDefaultBackground():null;this.backgroundColor=null===l||"left"===a?null:Color.Format.CSS.formatHex(l);const d=i.get(131).overviewRuler;this.top=d.top,this.right=d.right,this.domWidth=d.width,this.domHeight=d.height,0===this.overviewRulerLanes?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[c,h]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=c,this.w=h}_initLanes(e,t,i){const n=t-e;if(i>=3){const t=Math.floor(n/3),i=Math.floor(n/3),o=n-t-i,r=e+t;return[[0,e,r,e,e+t+o,e,r,e],[0,t,o,t+o,i,t+o+i,o+i,t+o+i]]}if(2===i){const t=Math.floor(n/2),i=n-t;return[[0,e,e,e,e+t,e,e,e],[0,t,t,t,i,t+i,t+i,t+i]]}return[[0,e,e,e,e,e,e,e],[0,n,n,n,n,n,n,n]]}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColor===e.cursorColor&&this.themeType===e.themeType&&this.backgroundColor===e.backgroundColor&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class DecorationsOverviewRuler extends ViewPart{constructor(e){super(e),this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=TokenizationRegistry.onDidChange((e=>{e.changedColorMap&&this._updateSettings(!0)})),this._cursorPositions=[]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Settings(this._context.configuration,this._context.theme);return(!this._settings||!this._settings.equals(t))&&(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}onConfigurationChanged(e){return this._updateSettings(!1)}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++)this._cursorPositions[t]=e.selections[t].getPosition();return this._cursorPositions.sort(Position$1.compare),!0}onDecorationsChanged(e){return!!e.affectsOverviewRuler}onFlushed(e){return!0}onScrollChanged(e){return e.scrollHeightChanged}onZonesChanged(e){return!0}onThemeChanged(e){return this._updateSettings(!1)}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render()}_render(){if(0===this._settings.overviewRulerLanes)return this._domNode.setBackgroundColor(this._settings.backgroundColor?this._settings.backgroundColor:""),void this._domNode.setDisplay("none");this._domNode.setDisplay("block");const e=this._settings.canvasWidth,t=this._settings.canvasHeight,i=this._settings.lineHeight,n=this._context.viewLayout,o=t/this._context.viewLayout.getScrollHeight(),r=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme),s=6*this._settings.pixelRatio|0,a=s/2|0,l=this._domNode.domNode.getContext("2d");null===this._settings.backgroundColor?l.clearRect(0,0,e,t):(l.fillStyle=this._settings.backgroundColor,l.fillRect(0,0,e,t));const d=this._settings.x,c=this._settings.w;r.sort(OverviewRulerDecorationsGroup.cmp);for(const h of r){const e=h.color,r=h.data;l.fillStyle=e;let u=0,g=0,p=0;for(let h=0,m=r.length/3;h<m;h++){const e=r[3*h],m=r[3*h+1],f=r[3*h+2];let _=n.getVerticalOffsetForLineNumber(m)*o|0,C=(n.getVerticalOffsetForLineNumber(f)+i)*o|0;if(C-_<s){let e=(_+C)/2|0;e<a?e=a:e+a>t&&(e=t-a),_=e-a,C=e+a}_>p+1||e!==u?(0!==h&&l.fillRect(d[u],g,c[u],p-g),u=e,g=_,p=C):C>p&&(p=C)}l.fillRect(d[u],g,c[u],p-g)}if(!this._settings.hideCursor&&this._settings.cursorColor){const e=2*this._settings.pixelRatio|0,i=e/2|0,r=this._settings.x[7],s=this._settings.w[7];l.fillStyle=this._settings.cursorColor;let a=-100,d=-100;for(let c=0,h=this._cursorPositions.length;c<h;c++){const h=this._cursorPositions[c];let u=n.getVerticalOffsetForLineNumber(h.lineNumber)*o|0;u<i?u=i:u+i>t&&(u=t-i);const g=u-i,p=g+e;g>d+1?(0!==c&&l.fillRect(r,a,s,d-a),a=g,d=p):p>d&&(d=p)}l.fillRect(r,a,s,d-a)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(l.beginPath(),l.lineWidth=1,l.strokeStyle=this._settings.borderColor,l.moveTo(0,0),l.lineTo(0,t),l.stroke(),l.moveTo(0,0),l.lineTo(e,0),l.stroke())}}class ColorZone{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=0|e,this.to=0|t,this.colorId=0|i}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class OverviewRulerZone{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class OverviewZoneManager{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(OverviewRulerZone.compare)}setLineHeight(e){return this._lineHeight!==e&&(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth!==e&&(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight!==e&&(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight!==e&&(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=i/Math.floor(this._outerHeight),o=Math.floor(4*this._pixelRatio/2),r=[];for(let s=0,a=this._zones.length;s<a;s++){const a=this._zones[s];if(!e){const e=a.getColorZones();if(e){r.push(e);continue}}const l=this._getVerticalOffsetForLine(a.startLineNumber),d=0===a.heightInLines?this._getVerticalOffsetForLine(a.endLineNumber)+t:l+a.heightInLines*t,c=Math.floor(n*l),h=Math.floor(n*d);let u=Math.floor((c+h)/2),g=h-u;g<o&&(g=o),u-g<0&&(u=g),u+g>i&&(u=i-g);const p=a.color;let m=this._color2Id[p];m||(m=++this._lastAssignedId,this._color2Id[p]=m,this._id2Color[m]=p);const f=new ColorZone(u-g,u+g,m);a.setColorZone(f),r.push(f)}return this._colorZonesInvalid=!1,r.sort(ColorZone.compare),r}}class OverviewRuler extends ViewEventHandler{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=createFastDomNode(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new OverviewZoneManager((e=>this._context.viewLayout.getVerticalOffsetForLineNumber(e))),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(59)),this._zoneManager.setPixelRatio(i.get(129)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(59)&&(this._zoneManager.setLineHeight(t.get(59)),this._render()),e.hasChanged(129)&&(this._zoneManager.setPixelRatio(t.get(129)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(0===this._zoneManager.getOuterHeight())return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),o=this._domNode.domNode.getContext("2d");return o.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(o,i,n,e),!0}_renderOneLane(e,t,i,n){let o=0,r=0,s=0;for(const a of t){const t=a.colorId,l=a.from,d=a.to;t!==o?(e.fillRect(0,r,n,s-r),o=t,e.fillStyle=i[o],r=l,s=d):s>=l?s=Math.max(s,d):(e.fillRect(0,r,n,s-r),r=l,s=d)}e.fillRect(0,r,n,s-r)}}var rulers="";class Rulers extends ViewPart{constructor(e){super(e),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(91),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(91),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:i}=this._context.viewModel.model.getOptions(),n=i;let o=t-e;for(;o>0;){const e=createFastDomNode(document.createElement("div"));e.setClassName("view-ruler"),e.setWidth(n),this.domNode.appendChild(e),this._renderedRulers.push(e),o--}return}let i=e-t;for(;i>0;){const e=this._renderedRulers.pop();this.domNode.removeChild(e),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const i=this._renderedRulers[t],n=this._rulers[t];i.setBoxShadow(n.color?`1px 0 0 0 ${n.color} inset`:""),i.setHeight(Math.min(e.scrollHeight,1e6)),i.setLeft(n.column*this._typicalHalfwidthCharacterWidth)}}}registerThemingParticipant(((e,t)=>{const i=e.getColor(editorRuler);i&&t.addRule(`.monaco-editor .view-ruler { box-shadow: 1px 0 0 0 ${i} inset; }`)}));var scrollDecoration="";class ScrollDecorationViewPart extends ViewPart{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const t=this._context.configuration.options.get(92);this._useShadows=t.useShadows,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e&&(this._shouldShow=e,!0)}getDomNode(){return this._domNode}_updateWidth(){const e=this._context.configuration.options.get(131);0===e.minimap.renderMinimap||e.minimap.minimapWidth>0&&0===e.minimap.minimapLeft?this._width=e.width:this._width=e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}onConfigurationChanged(e){const t=this._context.configuration.options.get(92);return this._useShadows=t.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}registerThemingParticipant(((e,t)=>{const i=e.getColor(scrollbarShadow);i&&t.addRule(`.monaco-editor .scroll-decoration { box-shadow: ${i} 0 6px 6px -6px inset; }`)}));var selections="";class HorizontalRangeWithStyle{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class LineVisibleRangesWithStyle{constructor(e,t){this.lineNumber=e,this.ranges=t}}function toStyledRange(e){return new HorizontalRangeWithStyle(e)}function toStyled(e){return new LineVisibleRangesWithStyle(e.lineNumber,e.ranges.map(toStyledRange))}class SelectionsOverlay extends DynamicViewOverlay{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._lineHeight=t.get(59),this._roundedSelection=t.get(90),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._lineHeight=t.get(59),this._roundedSelection=t.get(90),this._typicalHalfwidthCharacterWidth=t.get(44).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++){if(e[t].ranges.length>1)return!0}return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let o=null,r=null;if(i&&i.length>0&&t.length>0){const n=t[0].lineNumber;if(n===e.startLineNumber)for(let e=0;!o&&e<i.length;e++)i[e].lineNumber===n&&(o=i[e].ranges[0]);const s=t[t.length-1].lineNumber;if(s===e.endLineNumber)for(let e=i.length-1;!r&&e>=0;e--)i[e].lineNumber===s&&(r=i[e].ranges[0]);o&&!o.startStyle&&(o=null),r&&!r.startStyle&&(r=null)}for(let s=0,a=t.length;s<a;s++){const e=t[s].ranges[0],i=e.left,l=e.left+e.width,d={top:0,bottom:0},c={top:0,bottom:0};if(s>0){const e=t[s-1].ranges[0].left,o=t[s-1].ranges[0].left+t[s-1].ranges[0].width;abs(i-e)<n?d.top=2:i>e&&(d.top=1),abs(l-o)<n?c.top=2:e<l&&l<o&&(c.top=1)}else o&&(d.top=o.startStyle.top,c.top=o.endStyle.top);if(s+1<a){const e=t[s+1].ranges[0].left,o=t[s+1].ranges[0].left+t[s+1].ranges[0].width;abs(i-e)<n?d.bottom=2:e<i&&i<o&&(d.bottom=1),abs(l-o)<n?c.bottom=2:l<o&&(c.bottom=1)}else r&&(d.bottom=r.startStyle.bottom,c.bottom=r.endStyle.bottom);e.startStyle=d,e.endStyle=c}}_getVisibleRangesWithStyle(e,t,i){const n=(t.linesVisibleRangesForRange(e,!0)||[]).map(toStyled);return!this._visibleRangesHaveGaps(n)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,n,i),n}_createSelectionPiece(e,t,i,n,o){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;left:"+n.toString()+"px;width:"+o.toString()+"px;height:"+t+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(0===n.length)return;const o=!!n[0].ranges[0].startStyle,r=this._lineHeight.toString(),s=(this._lineHeight-1).toString(),a=n[0].lineNumber,l=n[n.length-1].lineNumber;for(let d=0,c=n.length;d<c;d++){const c=n[d],h=c.lineNumber,u=h-t,g=i&&(h===l||h===a)?s:r,p=i&&h===a?1:0;let m="",f="";for(let e=0,t=c.ranges.length;e<t;e++){const t=c.ranges[e];if(o){const e=t.startStyle,i=t.endStyle;if(1===e.top||1===e.bottom){m+=this._createSelectionPiece(p,g,SelectionsOverlay.SELECTION_CLASS_NAME,t.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let i=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;1===e.top&&(i+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),1===e.bottom&&(i+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT),m+=this._createSelectionPiece(p,g,i,t.left-SelectionsOverlay.ROUNDED_PIECE_WIDTH,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}if(1===i.top||1===i.bottom){m+=this._createSelectionPiece(p,g,SelectionsOverlay.SELECTION_CLASS_NAME,t.left+t.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH);let e=SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;1===i.top&&(e+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),1===i.bottom&&(e+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),m+=this._createSelectionPiece(p,g,e,t.left+t.width,SelectionsOverlay.ROUNDED_PIECE_WIDTH)}}let i=SelectionsOverlay.SELECTION_CLASS_NAME;if(o){const e=t.startStyle,n=t.endStyle;0===e.top&&(i+=" "+SelectionsOverlay.SELECTION_TOP_LEFT),0===e.bottom&&(i+=" "+SelectionsOverlay.SELECTION_BOTTOM_LEFT),0===n.top&&(i+=" "+SelectionsOverlay.SELECTION_TOP_RIGHT),0===n.bottom&&(i+=" "+SelectionsOverlay.SELECTION_BOTTOM_RIGHT)}f+=this._createSelectionPiece(p,g,i,t.left,t.width)}e[u][0]+=m,e[u][1]+=f}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let r=i;r<=n;r++){t[r-i]=["",""]}const o=[];for(let r=0,s=this._selections.length;r<s;r++){const n=this._selections[r];if(n.isEmpty()){o[r]=null;continue}const s=this._getVisibleRangesWithStyle(n,e,this._previousFrameVisibleRangesWithStyle[r]);o[r]=s,this._actualRenderOneSelection(t,i,this._selections.length>1,s)}this._previousFrameVisibleRangesWithStyle=o,this._renderResult=t.map((([e,t])=>e+t))}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function abs(e){return e<0?-e:e}SelectionsOverlay.SELECTION_CLASS_NAME="selected-text",SelectionsOverlay.SELECTION_TOP_LEFT="top-left-radius",SelectionsOverlay.SELECTION_BOTTOM_LEFT="bottom-left-radius",SelectionsOverlay.SELECTION_TOP_RIGHT="top-right-radius",SelectionsOverlay.SELECTION_BOTTOM_RIGHT="bottom-right-radius",SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",SelectionsOverlay.ROUNDED_PIECE_WIDTH=10,registerThemingParticipant(((e,t)=>{const i=e.getColor(editorSelectionBackground);i&&t.addRule(`.monaco-editor .focused .selected-text { background-color: ${i}; }`);const n=e.getColor(editorInactiveSelection);n&&t.addRule(`.monaco-editor .selected-text { background-color: ${n}; }`);const o=e.getColor(editorSelectionForeground);o&&!o.isTransparent()&&t.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${o}; }`)}));var viewCursors="";class ViewCursorRenderData{constructor(e,t,i,n,o,r){this.top=e,this.left=t,this.width=i,this.height=n,this.textContent=o,this.textContentClassName=r}}class ViewCursor{constructor(e){this._context=e;const t=this._context.configuration.options,i=t.get(44);this._cursorStyle=t.get(24),this._lineHeight=t.get(59),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(27),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),applyFontInfo(this._domNode,i),this._domNode.setDisplay("none"),this._position=new Position$1(1,1),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(44);return this._cursorStyle=t.get(24),this._lineHeight=t.get(59),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(27),this._typicalHalfwidthCharacterWidth),applyFontInfo(this._domNode,i),!0}onCursorPositionChanged(e){return this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,o]=getCharContainingOffset(i,t-1);return[new Position$1(e,n+1),i.substring(n,o)]}_prepareRender(e){let t="";const[i,n]=this._getGraphemeAwarePosition();if(this._cursorStyle===TextEditorCursorStyle$1.Line||this._cursorStyle===TextEditorCursorStyle$1.LineThin){const o=e.visibleRangeForPosition(i);if(!o||o.outsideRenderedLine)return null;let r;this._cursorStyle===TextEditorCursorStyle$1.Line?(r=computeScreenAwareSize(this._lineCursorWidth>0?this._lineCursorWidth:2),r>2&&(t=n)):r=computeScreenAwareSize(1);let s=o.left;r>=2&&s>=1&&(s-=1);const a=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta;return new ViewCursorRenderData(a,s,r,this._lineHeight,t,"")}const o=e.linesVisibleRangesForRange(new Range$2(i.lineNumber,i.column,i.lineNumber,i.column+n.length),!1);if(!o||0===o.length)return null;const r=o[0];if(r.outsideRenderedLine||0===r.ranges.length)return null;const s=r.ranges[0],a=s.width<1?this._typicalHalfwidthCharacterWidth:s.width;let l="";if(this._cursorStyle===TextEditorCursorStyle$1.Block){const e=this._context.viewModel.getViewLineData(i.lineNumber);t=n;const o=e.tokens.findTokenIndexAtOffset(i.column-1);l=e.tokens.getClassName(o)}let d=e.getVerticalOffsetForLineNumber(i.lineNumber)-e.bigNumbersDelta,c=this._lineHeight;return this._cursorStyle!==TextEditorCursorStyle$1.Underline&&this._cursorStyle!==TextEditorCursorStyle$1.UnderlineThin||(d+=this._lineHeight-2,c=2),new ViewCursorRenderData(d,s.left,a,c,t,l)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}class ViewCursors extends ViewPart{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(81),this._cursorBlinking=t.get(22),this._cursorStyle=t.get(24),this._cursorSmoothCaretAnimation=t.get(23),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new ViewCursor(this._context),this._secondaryCursors=[],this._renderData=[],this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new TimeoutTimer,this._cursorFlatBlinkInterval=new IntervalTimer,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(81),this._cursorBlinking=t.get(22),this._cursorStyle=t.get(24),this._cursorSmoothCaretAnimation=t.get(23),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t){if(this._primaryCursor.onCursorPositionChanged(e),this._updateBlinking(),this._secondaryCursors.length<t.length){const e=t.length-this._secondaryCursors.length;for(let t=0;t<e;t++){const e=new ViewCursor(this._context);this._domNode.domNode.insertBefore(e.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(e)}}else if(this._secondaryCursors.length>t.length){const e=this._secondaryCursors.length-t.length;for(let t=0;t<e;t++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let i=0;i<t.length;i++)this._secondaryCursors[i].onCursorPositionChanged(t[i])}onCursorStateChanged(e){const t=[];for(let n=0,o=e.selections.length;n<o;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1));const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=t=>{for(let i=0,n=e.ranges.length;i<n;i++)if(e.ranges[i].fromLineNumber<=t.lineNumber&&t.lineNumber<=e.ranges[i].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput?0:this._editorHasFocus?this._readOnly?5:this._cursorBlinking:0}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=0===e,i=5===e;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),t||i||(1===e?this._cursorFlatBlinkInterval.cancelAndSet((()=>{this._isVisible?this._hide():this._show()}),ViewCursors.BLINK_INTERVAL):this._startCursorBlinkAnimation.setIfNotSet((()=>{this._blinkingEnabled=!0,this._updateDomClassName()}),ViewCursors.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case TextEditorCursorStyle$1.Line:e+=" cursor-line-style";break;case TextEditorCursorStyle$1.Block:e+=" cursor-block-style";break;case TextEditorCursorStyle$1.Underline:e+=" cursor-underline-style";break;case TextEditorCursorStyle$1.LineThin:e+=" cursor-line-thin-style";break;case TextEditorCursorStyle$1.BlockOutline:e+=" cursor-block-outline-style";break;case TextEditorCursorStyle$1.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return this._cursorSmoothCaretAnimation&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let o=0,r=this._secondaryCursors.length;o<r;o++){const n=this._secondaryCursors[o].render(e);n&&(t[i++]=n)}this._renderData=t}getLastRenderData(){return this._renderData}}ViewCursors.BLINK_INTERVAL=500,registerThemingParticipant(((e,t)=>{const i=e.getColor(editorCursorForeground);if(i){let n=e.getColor(editorCursorBackground);n||(n=i.opposite()),t.addRule(`.monaco-editor .inputarea.ime-input { caret-color: ${i}; }`),t.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${i}; border-color: ${i}; color: ${n}; }`),"hc"===e.type&&t.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${n}; border-right: 1px solid ${n}; }`)}}));const invalidFunc$1=()=>{throw new Error("Invalid change accessor")};class ViewZones extends ViewPart{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(131);this._lineHeight=t.get(59),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=createFastDomNode(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace((e=>{const n=Object.keys(this._zones);for(let o=0,r=n.length;o<r;o++){const r=n[o],s=this._zones[r],a=this._computeWhitespaceProps(s.delegate);s.isInHiddenArea=a.isInHiddenArea;const l=t.get(r);!l||l.afterLineNumber===a.afterViewLineNumber&&l.height===a.heightInPx||(e.changeOneWhitespace(r,a.afterViewLineNumber,a.heightInPx),this._safeCallOnComputedHeight(s.delegate,a.heightInPx),i=!0)}})),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(131);return this._lineHeight=t.get(59),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(59)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return void 0!==e.afterColumn?e.afterColumn:1e4}_computeWhitespaceProps(e){if(0===e.afterLineNumber)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t,i;if(void 0!==e.afterColumn)t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const i=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new Position$1(i,this._context.viewModel.model.getLineMaxColumn(i))}i=t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity),o=this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!o,afterViewLineNumber:n.lineNumber,heightInPx:o?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace((i=>{const n={addZone:e=>(t=!0,this._addZone(i,e)),removeZone:e=>{e&&(t=this._removeZone(i,e)||t)},layoutZone:e=>{e&&(t=this._layoutZone(i,e)||t)}};safeInvoke1Arg(e,n),n.addZone=invalidFunc$1,n.removeZone=invalidFunc$1,n.layoutZone=invalidFunc$1})),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),n={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:createFastDomNode(t.domNode),marginDomNode:t.marginDomNode?createFastDomNode(t.marginDomNode):null};return this._safeCallOnComputedHeight(n.delegate,i.heightInPx),n.domNode.setPosition("absolute"),n.domNode.domNode.style.width="100%",n.domNode.setDisplay("none"),n.domNode.setAttribute("monaco-view-zone",n.whitespaceId),this.domNode.appendChild(n.domNode),n.marginDomNode&&(n.marginDomNode.setPosition("absolute"),n.marginDomNode.domNode.style.width="100%",n.marginDomNode.setDisplay("none"),n.marginDomNode.setAttribute("monaco-view-zone",n.whitespaceId),this.marginDomNode.appendChild(n.marginDomNode)),this._zones[n.whitespaceId]=n,this.setShouldRender(),n.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.parentNode.removeChild(i.domNode.domNode),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.parentNode.removeChild(i.marginDomNode.domNode)),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){if(this._zones.hasOwnProperty(e)){const t=this._zones[e];return Boolean(t.delegate.suppressMouseDown)}return!1}_heightInPixels(e){return"number"==typeof e.heightInPx?e.heightInPx:"number"==typeof e.heightInLines?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return"number"==typeof e.minWidthInPx?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if("function"==typeof e.onComputedHeight)try{e.onComputedHeight(t)}catch(e2){onUnexpectedError(e2)}}_safeCallOnDomNodeTop(e,t){if("function"==typeof e.onDomNodeTop)try{e.onDomNodeTop(t)}catch(e2){onUnexpectedError(e2)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const r of t)this._zones[r.id].isInHiddenArea||(i[r.id]=r,n=!0);const o=Object.keys(this._zones);for(let r=0,s=o.length;r<s;r++){const t=o[r],n=this._zones[t];let s=0,a=0,l="none";i.hasOwnProperty(t)?(s=i[t].verticalOffset-e.bigNumbersDelta,a=i[t].height,l="block",n.isVisible||(n.domNode.setAttribute("monaco-visible-view-zone","true"),n.isVisible=!0),this._safeCallOnDomNodeTop(n.delegate,e.getScrolledTopFromAbsoluteTop(i[t].verticalOffset))):(n.isVisible&&(n.domNode.removeAttribute("monaco-visible-view-zone"),n.isVisible=!1),this._safeCallOnDomNodeTop(n.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),n.domNode.setTop(s),n.domNode.setHeight(a),n.domNode.setDisplay(l),n.marginDomNode&&(n.marginDomNode.setTop(s),n.marginDomNode.setHeight(a),n.marginDomNode.setDisplay(l))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function safeInvoke1Arg(e,t){try{return e(t)}catch(e2){onUnexpectedError(e2)}}class EditorTheme{constructor(e){this._theme=e}get type(){return this._theme.type}get value(){return this._theme}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class ViewContext{constructor(e,t,i){this.configuration=e,this.theme=new EditorTheme(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}class ViewportData{constructor(e,t,i,n){this.selections=e,this.startLineNumber=0|t.startLineNumber,this.endLineNumber=0|t.endLineNumber,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=0|t.bigNumbersDelta,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new Range$2(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class View extends ViewEventHandler{constructor(e,t,i,n,o,r){super(),this._selections=[new Selection$1(1,1,1,1)],this._renderAnimationFrame=null;const s=new ViewController(t,n,o,e);this._context=new ViewContext(t,i,n),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=new TextAreaHandler(this._context,s,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=createFastDomNode(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=createFastDomNode(document.createElement("div")),PartFingerprints.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new EditorScrollbar(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new ViewLines(this._context,this._linesContent),this._viewZones=new ViewZones(this._context),this._viewParts.push(this._viewZones);const a=new DecorationsOverviewRuler(this._context);this._viewParts.push(a);const l=new ScrollDecorationViewPart(this._context);this._viewParts.push(l);const d=new ContentViewOverlays(this._context);this._viewParts.push(d),d.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context)),d.addDynamicOverlay(new SelectionsOverlay(this._context)),d.addDynamicOverlay(new IndentGuidesOverlay(this._context)),d.addDynamicOverlay(new DecorationsOverlay(this._context));const c=new MarginViewOverlays(this._context);this._viewParts.push(c),c.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context)),c.addDynamicOverlay(new GlyphMarginOverlay(this._context)),c.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context)),c.addDynamicOverlay(new LinesDecorationsOverlay(this._context)),c.addDynamicOverlay(new LineNumbersOverlay(this._context));const h=new Margin(this._context);h.getDomNode().appendChild(this._viewZones.marginDomNode),h.getDomNode().appendChild(c.getDomNode()),this._viewParts.push(h),this._contentWidgets=new ViewContentWidgets(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new ViewCursors(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new ViewOverlayWidgets(this._context),this._viewParts.push(this._overlayWidgets);const u=new Rulers(this._context);this._viewParts.push(u);const g=new Minimap(this._context);if(this._viewParts.push(g),a){const e=this._scrollbar.getOverviewRulerLayoutInfo();e.parent.insertBefore(a.getDomNode(),e.insertBefore)}this._linesContent.appendChild(d.getDomNode()),this._linesContent.appendChild(u.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(h.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(l.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this.domNode.appendChild(this._overflowGuardContainer),r?r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode):this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this._applyLayout(),this._pointerHandler=this._register(new PointerHandler(this._context,s,this._createPointerHandlerHelper()))}_flushAccumulatedAndRenderNow(){this._renderNow()}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new PointerHandlerLastRenderData(e,t)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new Position$1(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const e=this._context.configuration.options.get(131);this.domNode.setWidth(e.width),this.domNode.setHeight(e.height),this._overflowGuardContainer.setWidth(e.width),this._overflowGuardContainer.setHeight(e.height),this._linesContent.setWidth(1e6),this._linesContent.setHeight(1e6)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(128)+" "+getThemeTypeSelector(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){null!==this._renderAnimationFrame&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){null===this._renderAnimationFrame&&(this._renderAnimationFrame=runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this),100))}_onRenderScheduled(){this._renderAnimationFrame=null,this._flushAccumulatedAndRenderNow()}_renderNow(){safeInvokeNoArg((()=>this._actualRender()))}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_actualRender(){if(!isInDOM(this.domNode.domNode))return;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&0===e.length)return;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new ViewportData(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender());const n=new RenderingContext(this._context.viewLayout,i,this._viewLines);for(const o of e)o.prepareRender(n);for(const o of e)o.render(n),o.onDidRender()}delegateVerticalScrollbarMouseDown(e){this._scrollbar.delegateVerticalScrollbarMouseDown(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop},1),this._context.viewModel.tokenizeViewport(),this._renderNow(),this._viewLines.updateLineWidths(),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:e.scrollLeft},1)}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const o=this._viewLines.visibleRangeForPosition(new Position$1(n.lineNumber,n.column));return o?o.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?ViewUserInputEvents.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new OverviewRuler(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const e of this._viewParts)e.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){let t=e.position&&e.position.range||null;if(null===t){const i=e.position?e.position.position:null;null!==i&&(t=new Range$2(i.lineNumber,i.column,i.lineNumber,i.column))}const i=e.position?e.position.preference:null;this._contentWidgets.setWidgetPosition(e.widget,t,i),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){const t=e.position?e.position.preference:null;this._overlayWidgets.setWidgetPosition(e.widget,t)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}}function safeInvokeNoArg(e){try{return e()}catch(e2){onUnexpectedError(e2)}}class Cursor{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new SingleCursorState(new Range$2(1,1,1,1),0,new Position$1(1,1),0),new SingleCursorState(new Range$2(1,1,1,1),0,new Position$1(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new CursorState$1(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return Selection$1.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),o=t.selectionStart.getEndPosition(),r=e.normalizePosition(i,2),s=this._validatePositionWithCache(e,n,i,r),a=this._validatePositionWithCache(e,o,n,s);return i.equals(r)&&n.equals(s)&&o.equals(a)?t:new SingleCursorState(Range$2.fromPositions(s,a),t.selectionStartLeftoverVisibleColumns+n.column-s.column,r,t.leftoverVisibleColumns+i.column-r.column)}_setState(e,t,i){if(i&&(i=Cursor._validateViewState(e.viewModel,i)),t){const i=e.model.validateRange(t.selectionStart),n=t.selectionStart.equalsRange(i)?t.selectionStartLeftoverVisibleColumns:0,o=e.model.validatePosition(t.position),r=t.position.equals(o)?t.leftoverVisibleColumns:0;t=new SingleCursorState(i,n,o,r)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),o=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new SingleCursorState(n,i.selectionStartLeftoverVisibleColumns,o,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),o=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new SingleCursorState(n,t.selectionStartLeftoverVisibleColumns,o,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),o=e.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),r=new Range$2(n.lineNumber,n.column,o.lineNumber,o.column),s=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new SingleCursorState(r,t.selectionStartLeftoverVisibleColumns,s,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class CursorCollection{constructor(e){this.context=e,this.cursors=[new Cursor(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map((e=>e.readSelectionFromMarkers(this.context)))}getAll(){return this.cursors.map((e=>e.asCursorState()))}getViewPositions(){return this.cursors.map((e=>e.viewState.position))}getTopMostViewPosition(){return findMinBy(this.cursors,compareBy((e=>e.viewState.position),Position$1.compare)).viewState.position}getBottomMostViewPosition(){return findLastMaxBy(this.cursors,compareBy((e=>e.viewState.position),Position$1.compare)).viewState.position}getSelections(){return this.cursors.map((e=>e.modelState.selection))}getViewSelections(){return this.cursors.map((e=>e.viewState.selection))}setSelections(e){this.setStates(CursorState$1.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){null!==e&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const e=i-t;for(let t=0;t<e;t++)this._addSecondaryCursor()}else if(t>i){const e=t-i;for(let t=0;t<e;t++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new Cursor(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return 1===this.cursors.length||0===this.lastAddedCursorIndex?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(1===this.cursors.length)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(compareBy((e=>e.selection),Range$2.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],o=t[i+1],r=n.selection,s=o.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let a;if(a=s.isEmpty()||r.isEmpty()?s.getStartPosition().isBeforeOrEqual(r.getEndPosition()):s.getStartPosition().isBefore(r.getEndPosition()),a){const r=n.index<o.index?i:i+1,s=n.index<o.index?i+1:i,a=t[s].index,l=t[r].index,d=t[s].selection,c=t[r].selection;if(!d.equalsSelection(c)){const i=d.plusRange(c),n=d.selectionStartLineNumber===d.startLineNumber&&d.selectionStartColumn===d.startColumn,o=c.selectionStartLineNumber===c.startLineNumber&&c.selectionStartColumn===c.startColumn;let s,h;a===this.lastAddedCursorIndex?(s=n,this.lastAddedCursorIndex=l):s=o,h=s?new Selection$1(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn):new Selection$1(i.endLineNumber,i.endColumn,i.startLineNumber,i.startColumn),t[r].selection=h;const u=CursorState$1.fromModelSelection(h);e[l].setState(this.context,u.modelState,u.viewState)}for(const e of t)e.index>a&&e.index--;e.splice(a,1),t.splice(s,1),this._removeSecondaryCursor(a-1),i--}}}}class CursorContext{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class ModelRawFlush{constructor(){this.changeType=1}}class LineInjectedText{constructor(e,t,i,n,o){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=o}static applyInjectedText(e,t){if(!t||0===t.length)return e;let i="",n=0;for(const o of t)i+=e.substring(n,o.column-1),n=o.column-1,i+=o.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new LineInjectedText(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new LineInjectedText(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort(((e,t)=>e.lineNumber===t.lineNumber?e.column===t.column?e.order-t.order:e.column-t.column:e.lineNumber-t.lineNumber)),t}}class ModelRawLineChanged{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class ModelRawLinesDeleted{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class ModelRawLinesInserted{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class ModelRawEOLChanged{constructor(){this.changeType=5}}class ModelRawContentChangedEvent{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++){if(this.changes[t].changeType===e)return!0}return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,o=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new ModelRawContentChangedEvent(i,n,o,r)}}class ModelInjectedTextChangedEvent{constructor(e){this.changes=e}}class InternalModelContentChangeEvent{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=ModelRawContentChangedEvent.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=InternalModelContentChangeEvent._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new InternalModelContentChangeEvent(t,i)}static _mergeChangeEvents(e,t){return{changes:[].concat(e.changes).concat(t.changes),eol:t.eol,versionId:t.versionId,isUndoing:e.isUndoing||t.isUndoing,isRedoing:e.isRedoing||t.isRedoing,isFlush:e.isFlush||t.isFlush}}}class ViewCompositionStartEvent{constructor(){this.type=0}}class ViewCompositionEndEvent{constructor(){this.type=1}}class ViewConfigurationChangedEvent{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class ViewCursorStateChangedEvent{constructor(e,t){this.type=3,this.selections=e,this.modelSelections=t}}class ViewDecorationsChangedEvent{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0)}}class ViewFlushedEvent{constructor(){this.type=5}}class ViewFocusChangedEvent{constructor(e){this.type=6,this.isFocused=e}}class ViewLanguageConfigurationEvent{constructor(){this.type=7}}class ViewLineMappingChangedEvent{constructor(){this.type=8}}class ViewLinesChangedEvent{constructor(e,t){this.type=9,this.fromLineNumber=e,this.toLineNumber=t}}class ViewLinesDeletedEvent{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class ViewLinesInsertedEvent{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class ViewRevealRangeRequestEvent{constructor(e,t,i,n,o,r,s){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=o,this.revealHorizontal=r,this.scrollType=s,this.type=12}}class ViewScrollChangedEvent{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class ViewThemeChangedEvent{constructor(e){this.theme=e,this.type=14}}class ViewTokensChangedEvent{constructor(e){this.type=15,this.ranges=e}}class ViewTokensColorsChangedEvent{constructor(){this.type=16}}class ViewZonesChangedEvent$1{constructor(){this.type=17}}class ViewModelEventDispatcher extends Disposable{constructor(){super(),this._onEvent=this._register(new Emitter$1),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++)if(this._outgoingEvents[t].kind===e.kind)return void(this._outgoingEvents[t]=this._outgoingEvents[t].merge(e));this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t];this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,1===this._collectorCnt&&(this._collector=new ViewModelEventsCollector),this._collector}endEmitViewEvents(){if(this._collectorCnt--,0===this._collectorCnt){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class ViewModelEventsCollector{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class ContentSizeChangedEvent{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}merge(e){return 0!==e.kind?this:new ContentSizeChangedEvent(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class FocusChangedEvent{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}merge(e){return 1!==e.kind?this:new FocusChangedEvent(this.oldHasFocus,e.hasFocus)}}class ScrollChangedEvent{constructor(e,t,i,n,o,r,s,a){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=o,this.scrollLeft=r,this.scrollHeight=s,this.scrollTop=a,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!(this.scrollWidthChanged||this.scrollLeftChanged||this.scrollHeightChanged||this.scrollTopChanged)}merge(e){return 2!==e.kind?this:new ScrollChangedEvent(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class ViewZonesChangedEvent{constructor(){this.kind=3}isNoOp(){return!1}merge(e){return this}}class CursorStateChangedEvent{constructor(e,t,i,n,o,r,s){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=o,this.reason=r,this.reachedMaxCursorCount=s}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length;if(i!==t.length)return!1;for(let n=0;n<i;n++)if(!e[n].equalsSelection(t[n]))return!1;return!0}isNoOp(){return CursorStateChangedEvent._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}merge(e){return 6!==e.kind?this:new CursorStateChangedEvent(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class ReadOnlyEditAttemptEvent{constructor(){this.kind=5}isNoOp(){return!1}merge(e){return this}}class CursorsController extends Disposable{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new CursorCollection(this.context),this._hasFocus=!1,this._isHandling=!1,this._isDoingComposition=!1,this._selectionsWhenCompositionStarted=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=dispose(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new CursorContext(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let o=!1;null!==n&&n.length>CursorsController.MAX_CURSOR_COUNT&&(n=n.slice(0,CursorsController.MAX_CURSOR_COUNT),o=!0);const r=CursorModelState.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,r,o)}setCursorColumnSelectData(e){this._columnSelectData=e}revealPrimary(e,t,i,n,o,r){const s=this._cursors.getViewPositions();let a=null,l=null;s.length>1?l=this._cursors.getViewSelections():a=Range$2.fromPositions(s[0],s[0]),e.emitViewEvent(new ViewRevealRangeRequestEvent(t,i,a,l,n,o,r))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push({inSelectionMode:!n.isEmpty(),selectionStart:{lineNumber:n.selectionStartLineNumber,column:n.selectionStartColumn},position:{lineNumber:n.positionLineNumber,column:n.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,o=t.length;n<o;n++){const e=t[n];let o=1,r=1;e.position&&e.position.lineNumber&&(o=e.position.lineNumber),e.position&&e.position.column&&(r=e.position.column);let s=o,a=r;e.selectionStart&&e.selectionStart.lineNumber&&(s=e.selectionStart.lineNumber),e.selectionStart&&e.selectionStart.column&&(a=e.selectionStart.column),i.push({selectionStartLineNumber:s,selectionStartColumn:a,positionLineNumber:o,positionColumn:r})}this.setStates(e,"restoreState",0,CursorState$1.fromModelSelections(i)),this.revealPrimary(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof ModelInjectedTextChangedEvent){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{if(this._knownModelVersionId=t.versionId,this._isHandling)return;const i=t.containsEvent(1);if(this._prevEditOperationType=0,i)this._cursors.dispose(),this._cursors=new CursorCollection(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&t.resultingSelection&&t.resultingSelection.length>0){const i=CursorState$1.fromModelSelections(t.resultingSelection);this.setStates(e,"modelChange",t.isUndoing?5:t.isRedoing?6:2,i)&&this.revealPrimary(e,"modelChange",!1,0,!0,0)}else{const t=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,CursorState$1.fromModelSelections(t))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,CursorState$1.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let s=0,a=e.length;s<a;s++)i.push({range:e[s],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[s],options:{description:"auto-closed-enclosing",stickiness:1}});const o=this._model.deltaDecorations([],i),r=this._model.deltaDecorations([],n);this._autoClosedActions.push(new AutoClosedAction(this._model,o,r))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=CommandExecutor.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],n=[];for(let t=0;t<e.commands.length;t++){const o=e.commands[t];o instanceof TypeWithAutoClosingCommand&&o.enclosingRange&&o.closeCharacterRange&&(i.push(o.closeCharacterRange),n.push(o.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){e&&0!==e.length||(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,o){const r=CursorModelState.from(this._model,this);if(r.equals(n))return!1;const s=this._cursors.getSelections(),a=this._cursors.getViewSelections();if(e.emitViewEvent(new ViewCursorStateChangedEvent(a,s)),!n||n.cursorState.length!==r.cursorState.length||r.cursorState.some(((e,t)=>!e.modelState.equals(n.cursorState[t].modelState)))){const a=n?n.cursorState.map((e=>e.modelState.selection)):null,l=n?n.modelVersionId:0;e.emitOutgoingEvent(new CursorStateChangedEvent(a,s,l,r.modelVersionId,t||"keyboard",i,o))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];if(!n.text||n.text.indexOf("\n")>=0)return null;const o=n.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!o)return null;const r=o[1],s=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(r);if(!s||1!==s.length)return null;const a=s[0].open,l=n.text.length-o[2].length-1,d=n.text.lastIndexOf(a,l-1);if(-1===d)return null;t.push([d,l])}return t}executeEdits(e,t,i,n){let o=null;"snippet"===t&&(o=this._findAutoClosingPairs(i)),o&&(i[0]._isTracked=!0);const r=[],s=[],a=this._model.pushEditOperations(this.getSelections(),i,(e=>{if(o)for(let i=0,n=o.length;i<n;i++){const[t,n]=o[i],a=e[i],l=a.range.startLineNumber,d=a.range.startColumn-1+t,c=a.range.startColumn-1+n;r.push(new Range$2(l,c+1,l,c+2)),s.push(new Range$2(l,d+1,l,c+2))}const t=n(e);return t&&(this._isHandling=!0),t}));a&&(this._isHandling=!1,this.setSelections(e,t,a,0)),r.length>0&&this._pushAutoClosedAction(r,s)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const o=CursorModelState.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(r){onUnexpectedError(r)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,o,!1)&&this.revealPrimary(t,i,!1,0,!0,0)}setIsDoingComposition(e){this._isDoingComposition=e}getAutoClosedCharacters(){return AutoClosedAction.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._selectionsWhenCompositionStarted=this.getSelections().slice(0)}endComposition(e,t){this._executeEdit((()=>{"keyboard"===t&&(this._executeEditOperation(TypeOperations.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this._selectionsWhenCompositionStarted,this.getSelections(),this.getAutoClosedCharacters())),this._selectionsWhenCompositionStarted=null)}),e,t)}type(e,t,i){this._executeEdit((()=>{if("keyboard"===i){const e=t.length;let i=0;for(;i<e;){const e=nextCharLength(t,i),n=t.substr(i,e);this._executeEditOperation(TypeOperations.typeWithInterceptors(this._isDoingComposition,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),n)),i+=e}}else this._executeEditOperation(TypeOperations.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))}),e,i)}compositionType(e,t,i,n,o,r){if(0!==t.length||0!==i||0!==n)this._executeEdit((()=>{this._executeEditOperation(TypeOperations.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,o))}),e,r);else if(0!==o){const t=this.getSelections().map((e=>{const t=e.getPosition();return new Selection$1(t.lineNumber,t.column+o,t.lineNumber,t.column+o)}));this.setSelections(e,r,t,0)}}paste(e,t,i,n,o){this._executeEdit((()=>{this._executeEditOperation(TypeOperations.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]))}),e,o,4)}cut(e,t){this._executeEdit((()=>{this._executeEditOperation(DeleteOperations.cut(this.context.cursorConfig,this._model,this.getSelections()))}),e,t)}executeCommand(e,t,i){this._executeEdit((()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new EditOperationResult(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),e,i)}executeCommands(e,t,i){this._executeEdit((()=>{this._executeEditOperation(new EditOperationResult(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))}),e,i)}}CursorsController.MAX_CURSOR_COUNT=1e4;class CursorModelState{constructor(e,t){this.modelVersionId=e,this.cursorState=t}static from(e,t){return new CursorModelState(e.getVersionId(),t.getCursorStates())}equals(e){if(!e)return!1;if(this.modelVersionId!==e.modelVersionId)return!1;if(this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class AutoClosedAction{constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const e=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(e&&(t.push(e),e.startLineNumber!==e.endLineNumber))return!1}t.sort(Range$2.compareRangesUsingStarts),e.sort(Range$2.compareRangesUsingStarts);for(let i=0;i<e.length;i++){if(i>=t.length)return!1;if(!t[i].strictContainsRange(e[i]))return!1}return!0}}class CommandExecutor{static executeCommands(e,t,i){const n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},o=this._innerExecuteCommands(n,i);for(let r=0,s=n.trackedRanges.length;r<s;r++)n.model._setTrackedRange(n.trackedRanges[r],null,0);return o}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(0===i.operations.length)return null;const n=i.operations,o=this._getLoserCursorMap(n);if(o.hasOwnProperty("0"))return null;const r=[];for(let l=0,d=n.length;l<d;l++)o.hasOwnProperty(n[l].identifier.major.toString())||r.push(n[l]);i.hadTrackedEditOperation&&r.length>0&&(r[0]._isTracked=!0);let s=e.model.pushEditOperations(e.selectionsBefore,r,(i=>{const n=[];for(let t=0;t<e.selectionsBefore.length;t++)n[t]=[];for(const e of i)e.identifier&&n[e.identifier.major].push(e);const o=(e,t)=>e.identifier.minor-t.identifier.minor,r=[];for(let s=0;s<e.selectionsBefore.length;s++)n[s].length>0?(n[s].sort(o),r[s]=t[s].computeCursorState(e.model,{getInverseEditOperations:()=>n[s],getTrackedSelection:t=>{const i=parseInt(t,10),n=e.model._getTrackedRange(e.trackedRanges[i]);return 0===e.trackedRangesDirection[i]?new Selection$1(n.startLineNumber,n.startColumn,n.endLineNumber,n.endColumn):new Selection$1(n.endLineNumber,n.endColumn,n.startLineNumber,n.startColumn)}})):r[s]=e.selectionsBefore[s];return r}));s||(s=e.selectionsBefore);const a=[];for(let l in o)o.hasOwnProperty(l)&&a.push(parseInt(l,10));a.sort(((e,t)=>t-e));for(const l of a)s.splice(l,1);return s}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let o=0,r=t.length;o<r;o++){const r=t[o];if(r){const t=this._getEditOperationsFromCommand(e,o,r);i=i.concat(t.operations),n=n||t.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let o=0;const r=(e,r,s=!1)=>{Range$2.isEmpty(e)&&""===r||n.push({identifier:{major:t,minor:o++},range:e,text:r,forceMoveMarkers:s,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let s=!1;const a={addEditOperation:r,addTrackedEditOperation:(e,t,i)=>{s=!0,r(e,t,i)},trackSelection:(t,i)=>{const n=Selection$1.liftSelection(t);let o;if(n.isEmpty())if("boolean"==typeof i)o=i?2:3;else{const t=e.model.getLineMaxColumn(n.startLineNumber);o=n.startColumn===t?2:3}else o=1;const r=e.trackedRanges.length,s=e.model._setTrackedRange(null,n,o);return e.trackedRanges[r]=s,e.trackedRangesDirection[r]=n.getDirection(),r.toString()}};try{i.getEditOperations(e.model,a)}catch(e2){return onUnexpectedError(e2),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:s}}static _getLoserCursorMap(e){(e=e.slice(0)).sort(((e,t)=>-Range$2.compareRangesUsingEnds(e.range,t.range)));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],o=e[i];if(Range$2.getStartPosition(n.range).isBefore(Range$2.getEndPosition(o.range))){let r;r=n.identifier.major>o.identifier.major?n.identifier.major:o.identifier.major,t[r.toString()]=!0;for(let t=0;t<e.length;t++)e[t].identifier.major===r&&(e.splice(t,1),t<i&&i--,t--);i>0&&i--}}return t}}class InternalEditorAction{constructor(e,t,i,n,o,r){this.id=e,this.label=t,this.alias=i,this._precondition=n,this._run=o,this._contextKeyService=r}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(){return this.isSupported()?this._run():Promise.resolve(void 0)}}const EditorType={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"},Extensions$3={Configuration:"base.contributions.configuration"},resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage",contributionRegistry=Registry.as(Extensions$5.JSONContribution);class ConfigurationRegistry{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new Emitter$1,this._onDidUpdateConfiguration=new Emitter$1,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:localize("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=this.doRegisterConfigurations(e,t);contributionRegistry.registerSchema(resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){var t;const i=[],n=[];for(const{overrides:o,source:r}of e)for(const e in o)if(i.push(e),OVERRIDE_PROPERTY_REGEX.test(e)){const i=Object.assign(Object.assign({},(null===(t=this.configurationDefaultsOverrides.get(e))||void 0===t?void 0:t.value)||{}),o[e]);this.configurationDefaultsOverrides.set(e,{source:r,value:i});const s={type:"object",default:i,description:localize("defaultLanguageConfiguration.description","Configure settings to be overridden for {0} language.",e),$ref:resourceLanguageSettingsSchemaId,defaultDefaultValue:i,source:isString$1(r)?void 0:r};n.push(...overrideIdentifiersFromKey(e)),this.configurationProperties[e]=s,this.defaultLanguageConfigurationOverridesNode.properties[e]=s}else{this.configurationDefaultsOverrides.set(e,{value:o[e],source:r});const t=this.configurationProperties[e];t&&(this.updatePropertyDefaultValue(e,t),this.updateSchema(e,t))}this.registerOverrideIdentifiers(n),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:!0})}registerOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t){const i=[];return e.forEach((e=>{i.push(...this.validateAndRegisterProperties(e,t,e.extensionInfo,e.restrictedProperties)),this.configurationContributors.push(e),this.registerJSONConfiguration(e)})),i}validateAndRegisterProperties(e,t=!0,i,n,o=3){o=isUndefinedOrNull(e.scope)?o:e.scope;let r=[],s=e.properties;if(s)for(let l in s){if(t&&validateProperty(l)){delete s[l];continue}const e=s[l];e.source=i,e.defaultDefaultValue=s[l].default,this.updatePropertyDefaultValue(l,e),OVERRIDE_PROPERTY_REGEX.test(l)?e.scope=void 0:(e.scope=isUndefinedOrNull(e.scope)?o:e.scope,e.restricted=isUndefinedOrNull(e.restricted)?!!(null==n?void 0:n.includes(l)):e.restricted),!s[l].hasOwnProperty("included")||s[l].included?(this.configurationProperties[l]=s[l],!s[l].deprecationMessage&&s[l].markdownDeprecationMessage&&(s[l].deprecationMessage=s[l].markdownDeprecationMessage),r.push(l)):(this.excludedConfigurationProperties[l]=s[l],delete s[l])}let a=e.allOf;if(a)for(let l of a)r.push(...this.validateAndRegisterProperties(l,t,i,n,o));return r}getConfigurationProperties(){return this.configurationProperties}registerJSONConfiguration(e){const t=e=>{let i=e.properties;if(i)for(const t in i)this.updateSchema(t,i[t]);let n=e.allOf;n&&n.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:case 2:case 6:case 3:case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(t,i)}this._onDidSchemaChange.fire()}registerOverridePropertyPatternKey(){localize("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),localize("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e);let n=null==i?void 0:i.value,o=null==i?void 0:i.source;isUndefined(n)&&(n=t.defaultDefaultValue,o=void 0),isUndefined(n)&&(n=getDefaultValue(t.type)),t.default=n,t.defaultValueSource=o}}const OVERRIDE_IDENTIFIER_PATTERN="\\[([^\\]]+)\\]",OVERRIDE_IDENTIFIER_REGEX=new RegExp(OVERRIDE_IDENTIFIER_PATTERN,"g"),OVERRIDE_PROPERTY_PATTERN=`^(${OVERRIDE_IDENTIFIER_PATTERN})+$`,OVERRIDE_PROPERTY_REGEX=new RegExp(OVERRIDE_PROPERTY_PATTERN);function overrideIdentifiersFromKey(e){const t=[];if(OVERRIDE_PROPERTY_REGEX.test(e)){let i=OVERRIDE_IDENTIFIER_REGEX.exec(e);for(;null==i?void 0:i.length;){const n=i[1].trim();n&&t.push(n),i=OVERRIDE_IDENTIFIER_REGEX.exec(e)}}return distinct(t)}function getDefaultValue(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const configurationRegistry$2=new ConfigurationRegistry;function validateProperty(e){return e.trim()?OVERRIDE_PROPERTY_REGEX.test(e)?localize("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",e):void 0!==configurationRegistry$2.getConfigurationProperties()[e]?localize("config.property.duplicate","Cannot register '{0}'. This property is already registered.",e):null:localize("config.property.empty","Cannot register an empty property")}Registry.add(Extensions$3.Configuration,configurationRegistry$2);const Extensions$2={ModesRegistry:"editor.modesRegistry"};class EditorModesRegistry{constructor(){this._onDidChangeLanguages=new Emitter$1,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e)return void this._languages.splice(t,1)}}}getLanguages(){return this._languages}}const ModesRegistry=new EditorModesRegistry;Registry.add(Extensions$2.ModesRegistry,ModesRegistry);const PLAINTEXT_LANGUAGE_ID="plaintext",PLAINTEXT_EXTENSION=".txt";ModesRegistry.registerLanguage({id:PLAINTEXT_LANGUAGE_ID,extensions:[PLAINTEXT_EXTENSION],aliases:[localize("plainText.alias","Plain Text"),"text"],mimetypes:[Mimes.text]}),LanguageConfigurationRegistry.register(PLAINTEXT_LANGUAGE_ID,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0),Registry.as(Extensions$3.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class LineTokens{constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this._languageIdCodec=i}static createEmpty(e,t){const i=LineTokens.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new LineTokens(n,e,t)}equals(e){return e instanceof LineTokens&&this.slicedEquals(e,0,this._tokensCount)}slicedEquals(e,t,i){if(this._text!==e._text)return!1;if(this._tokensCount!==e._tokensCount)return!1;const n=t<<1,o=n+(i<<1);for(let r=n;r<o;r++)if(this._tokens[r]!==e._tokens[r])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[1+(e<<1)]}getLanguageId(e){const t=this._tokens[1+(e<<1)],i=TokenMetadata.getLanguageId(t);return this._languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[1+(e<<1)];return TokenMetadata.getTokenType(t)}getForeground(e){const t=this._tokens[1+(e<<1)];return TokenMetadata.getForeground(t)}getClassName(e){const t=this._tokens[1+(e<<1)];return TokenMetadata.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[1+(e<<1)];return TokenMetadata.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[1+(e<<1)];return TokenMetadata.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return LineTokens.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new SliceLineTokens(this,e,t,i)}static convertToEndOffset(e,t){const i=(e.length>>>1)-1;for(let n=0;n<i;n++)e[n<<1]=e[n+1<<1];e[i<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const o=i+Math.floor((n-i)/2),r=e[o<<1];if(r===t)return o+1;r<t?i=o+1:r>t&&(n=o)}return i}withInserted(e){if(0===e.length)return this;let t=0,i=0,n="";const o=new Array;let r=0;for(;;){const s=t<this._tokensCount?this._tokens[t<<1]:-1,a=i<e.length?e[i]:null;if(-1!==s&&(null===a||s<=a.offset)){n+=this._text.substring(r,s);const e=this._tokens[1+(t<<1)];o.push(n.length,e),t++,r=s}else{if(!a)break;if(a.offset>r){n+=this._text.substring(r,a.offset);const e=this._tokens[1+(t<<1)];o.push(n.length,e),r=a.offset}n+=a.text,o.push(n.length,a.tokenMetadata),i++}}return new LineTokens(new Uint32Array(o),n,this._languageIdCodec)}}LineTokens.defaultTokenMetadata=16793600;class SliceLineTokens{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this._tokensCount=0;for(let o=this._firstTokenIndex,r=e.getCount();o<r;o++){if(e.getStartOffset(o)>=i)break;this._tokensCount++}}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof SliceLineTokens&&(this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount))}getCount(){return this._tokensCount}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}}const NullState=new class{clone(){return this}equals(e){return this===e}};function nullTokenize(e,t){return new TokenizationResult([new Token$2(0,"",e)],t)}function nullTokenizeEncoded(e,t){const i=new Uint32Array(2);return i[0]=0,i[1]=(16384|e<<0|2<<23)>>>0,new EncodedTokenizationResult(i,null===t?NullState:t)}var __awaiter$13=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const fallback={getInitialState:()=>NullState,tokenizeEncoded:(e,t,i)=>nullTokenizeEncoded(0,i)};function tokenizeToString(e,t,i){return __awaiter$13(this,void 0,void 0,(function*(){if(!i)return _tokenizeToString(t,e.languageIdCodec,fallback);const n=yield TokenizationRegistry.getOrCreate(i);return _tokenizeToString(t,e.languageIdCodec,n||fallback)}))}function tokenizeLineToHTML(e,t,i,n,o,r,s){let a="<div>",l=n,d=0,c=!0;for(let h=0,u=t.getCount();h<u;h++){const u=t.getEndOffset(h);if(u<=n)continue;let g="";for(;l<u&&l<o;l++){const t=e.charCodeAt(l);switch(t){case 9:{let e=r-(l+d)%r;for(d+=e-1;e>0;)s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0),e--;break}case 60:g+="&lt;",c=!1;break;case 62:g+="&gt;",c=!1;break;case 38:g+="&amp;",c=!1;break;case 0:g+="&#00;",c=!1;break;case 65279:case 8232:case 8233:case 133:g+="�",c=!1;break;case 13:g+="&#8203",c=!1;break;case 32:s&&c?(g+="&#160;",c=!1):(g+=" ",c=!0);break;default:g+=String.fromCharCode(t),c=!1}}if(a+=`<span style="${t.getInlineStyle(h,i)}">${g}</span>`,u>o||l>=o)break}return a+="</div>",a}function _tokenizeToString(e,t,i){let n='<div class="monaco-tokenized-source">';const o=splitLines(e);let r=i.getInitialState();for(let s=0,a=o.length;s<a;s++){const e=o[s];s>0&&(n+="<br/>");const a=i.tokenizeEncoded(e,!0,r);LineTokens.convertToEndOffset(a.tokens,e.length);const l=new LineTokens(a.tokens,e,t).inflate();let d=0;for(let t=0,i=l.getCount();t<i;t++){const i=l.getClassName(t),o=l.getEndOffset(t);n+=`<span class="${i}">${escape(e.substring(d,o))}</span>`,d=o}r=a.endState}return n+="</div>",n}class PendingChanges{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class EditorWhitespace{constructor(e,t,i,n,o){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=o,this.prefixSum=0}}class LinesLayout{constructor(e,t,i,n){this._instanceId=singleLetterHash(++LinesLayout.INSTANCE_COUNT),this._pendingChanges=new PendingChanges,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(e,t,i){let n=0,o=e.length;for(;n<o;){const r=n+o>>>1;t===e[r].afterLineNumber?i<e[r].ordinal?o=r:n=r+1:t<e[r].afterLineNumber?o=r:n=r+1}return n}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(e,i,n,o)=>{t=!0,e|=0,i|=0,n|=0,o|=0;const r=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new EditorWhitespace(r,e,i,n,o)),r},changeOneWhitespace:(e,i,n)=>{t=!0,i|=0,n|=0,this._pendingChanges.change({id:e,newAfterLineNumber:i,newHeight:n})},removeWhitespace:e=>{t=!0,this._pendingChanges.remove({id:e})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const t of e)this._insertWhitespace(t);for(const e of t)this._changeOneWhitespace(e.id,e.newAfterLineNumber,e.newHeight);for(const e of i){const t=this._findWhitespaceIndex(e.id);-1!==t&&this._removeWhitespace(t)}return}const n=new Set;for(const a of i)n.add(a.id);const o=new Map;for(const a of t)o.set(a.id,a);const r=e=>{const t=[];for(const i of e)if(!n.has(i.id)){if(o.has(i.id)){const e=o.get(i.id);i.afterLineNumber=e.newAfterLineNumber,i.height=e.newHeight}t.push(i)}return t},s=r(this._arr).concat(r(e));s.sort(((e,t)=>e.afterLineNumber===t.afterLineNumber?e.ordinal-t.ordinal:e.afterLineNumber-t.afterLineNumber)),this._arr=s,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=LinesLayout.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(-1!==n&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const e=this._arr[n];this._removeWhitespace(n),e.afterLineNumber=t,this._insertWhitespace(e)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e|=0,t|=0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const n=this._arr[i].afterLineNumber;e<=n&&n<=t?this._arr[i].afterLineNumber=e-1:n>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e|=0,t|=0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){e<=this._arr[i].afterLineNumber&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),0===this._arr.length?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e|=0;let t=Math.max(0,this._prefixSumValidIndex+1);0===t&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();return this._lineHeight*this._lineCount+this.getWhitespacesTotalHeight()+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e|=0;const t=this._findLastWhitespaceBeforeLineNumber(e);return-1===t?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e|=0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const o=i+((n-i|0)/2|0)|0;if(t[o].afterLineNumber<e){if(o+1>=t.length||t[o+1].afterLineNumber>=e)return o;i=o+1|0}else n=o-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e|=0;const t=this._findLastWhitespaceBeforeLineNumber(e)+1;return t<this._arr.length?t:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e|=0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e){let t;this._checkPendingChanges(),t=(e|=0)>1?this._lineHeight*(e-1):0;return t+this.getWhitespaceAccumulatedHeightBeforeLineNumber(e)+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),-1===this._minWidth){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();return e>this.getLinesTotalHeight()}isInTopPadding(e){return 0!==this._paddingTop&&(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(0===this._paddingBottom)return!1;this._checkPendingChanges();return e>=this.getLinesTotalHeight()-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),(e|=0)<0)return 1;const t=0|this._lineCount,i=this._lineHeight;let n=1,o=t;for(;n<o;){const t=(n+o)/2|0,r=0|this.getVerticalOffsetForLineNumber(t);if(e>=r+i)n=t+1;else{if(e>=r)return t;o=t}}return n>t?t:n}getLinesViewportData(e,t){this._checkPendingChanges(),e|=0,t|=0;const i=this._lineHeight,n=0|this.getLineNumberAtOrAfterVerticalOffset(e),o=0|this.getVerticalOffsetForLineNumber(n);let r=0|this._lineCount,s=0|this.getFirstWhitespaceIndexAfterLineNumber(n);const a=0|this.getWhitespacesCount();let l,d;-1===s?(s=a,d=r+1,l=0):(d=0|this.getAfterLineNumberForWhitespaceIndex(s),l=0|this.getHeightForWhitespaceIndex(s));let c=o,h=c;const u=5e5;let g=0;o>=u&&(g=Math.floor(o/u)*u,g=Math.floor(g/i)*i,h-=g);const p=[],m=e+(t-e)/2;let f=-1;for(let b=n;b<=r;b++){if(-1===f){const e=c,t=c+i;(e<=m&&m<t||e>m)&&(f=b)}for(c+=i,p[b-n]=h,h+=i;d===b;)h+=l,c+=l,s++,s>=a?d=r+1:(d=0|this.getAfterLineNumberForWhitespaceIndex(s),l=0|this.getHeightForWhitespaceIndex(s));if(c>=t){r=b;break}}-1===f&&(f=r);const _=0|this.getVerticalOffsetForLineNumber(r);let C=n,v=r;return C<v&&o<e&&C++,C<v&&_+i>t&&v--,{bigNumbersDelta:g,startLineNumber:n,endLineNumber:r,relativeVerticalOffset:p,centeredLineNumber:f,completelyVisibleStartLineNumber:C,completelyVisibleEndLineNumber:v}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e|=0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i,n;return i=t>=1?this._lineHeight*t:0,n=e>0?this.getWhitespacesAccumulatedHeight(e-1):0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e|=0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;if(e>=this.getVerticalOffsetForWhitespaceIndex(i)+this.getHeightForWhitespaceIndex(i))return-1;for(;t<i;){const n=Math.floor((t+i)/2),o=this.getVerticalOffsetForWhitespaceIndex(n);if(e>=o+this.getHeightForWhitespaceIndex(n))t=n+1;else{if(e>=o)return n;i=n}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e|=0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0)return null;if(t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t);return{id:this.getIdForWhitespaceIndex(t),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(t),verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e|=0,t|=0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const o=[];for(let r=i;r<=n;r++){const e=this.getVerticalOffsetForWhitespaceIndex(r),i=this.getHeightForWhitespaceIndex(r);if(e>=t)break;o.push({id:this.getIdForWhitespaceIndex(r),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(r),verticalOffset:e,height:i})}return o}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e|=0,this._arr[e].height}}LinesLayout.INSTANCE_COUNT=0;const SMOOTH_SCROLLING_TIME=125;class EditorScrollDimensions{constructor(e,t,i,n){(e|=0)<0&&(e=0),(t|=0)<0&&(t=0),(i|=0)<0&&(i=0),(n|=0)<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class EditorScrollable extends Disposable{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new Emitter$1),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new EditorScrollDimensions(0,0,0,0),this._scrollable=this._register(new Scrollable({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new ContentSizeChangedEvent(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}}class ViewLayout extends Disposable{constructor(e,t,i){super(),this._configuration=e;const n=this._configuration.options,o=n.get(131),r=n.get(75);this._linesLayout=new LinesLayout(t,n.get(59),r.top,r.bottom),this._scrollable=this._register(new EditorScrollable(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new EditorScrollDimensions(o.contentWidth,0,o.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(103)?SMOOTH_SCROLLING_TIME:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(59)&&this._linesLayout.setLineHeight(t.get(59)),e.hasChanged(75)){const e=t.get(75);this._linesLayout.setPadding(e.top,e.bottom)}if(e.hasChanged(131)){const e=t.get(131),i=e.contentWidth,n=e.height,o=this._scrollable.getScrollDimensions(),r=o.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(i,o.contentWidth,n,this._getContentHeight(i,n,r)))}else this._updateHeight();e.hasChanged(103)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const i=this._configuration.options.get(92);return 2===i.horizontal||e>=t?0:i.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let o=this._linesLayout.getLinesTotalHeight();return n.get(94)?o+=Math.max(0,t-n.get(59)-n.get(75).bottom):o+=this._getHorizontalScrollbarHeight(e,i),o}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new EditorScrollDimensions(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new Viewport(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new Viewport(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(e){const t=this._configuration.options,i=t.get(132),n=t.get(44);if(i.isViewportWrapping){const i=t.get(131),o=t.get(65);return e>i.contentWidth+n.typicalHalfwidthCharacterWidth&&o.enabled&&"right"===o.side?e+i.verticalScrollbarWidth:e}{const i=t.get(93)*n.typicalHalfwidthCharacterWidth,o=this._linesLayout.getWhitespaceMinWidth();return Math.max(e+i,o)}}setMaxLineWidth(e){const t=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new EditorScrollDimensions(t.width,this._computeContentWidth(e),t.height,t.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t);return{scrollTop:t,scrollTopWithoutViewZones:t-this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i),scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e){return this._linesLayout.getVerticalOffsetForLineNumber(e)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){1===t?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class ViewModelDecorations{constructor(e,t,i,n,o){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=o,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,o=e.options;let r;if(o.isWholeLine){const e=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(n.startLineNumber,1),0),t=this._coordinatesConverter.convertModelPositionToViewPosition(new Position$1(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);r=new Range$2(e.lineNumber,e.column,t.lineNumber,t.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new ViewModelDecoration(r,o),this._decorationsCache[t]=i}return i}getDecorationsViewportData(e){let t=null!==this._cachedModelDecorationsResolver;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsViewportData(e),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}_getDecorationsViewportData(e){const t=this._linesCollection.getDecorationsInRange(e,this.editorId,filterValidationDecorations(this.configuration.options)),i=e.startLineNumber,n=e.endLineNumber,o=[];let r=0;const s=[];for(let a=i;a<=n;a++)s[a-i]=[];for(let a=0,l=t.length;a<l;a++){const e=t[a],l=e.options;if(!isModelDecorationVisible(this.model,e))continue;const d=this._getOrCreateViewModelDecoration(e),c=d.range;if(o[r++]=d,l.inlineClassName){const e=new InlineDecoration(c,l.inlineClassName,l.inlineClassNameAffectsLetterSpacing?3:0),t=Math.max(i,c.startLineNumber),o=Math.min(n,c.endLineNumber);for(let n=t;n<=o;n++)s[n-i].push(e)}if(l.beforeContentClassName&&i<=c.startLineNumber&&c.startLineNumber<=n){const e=new InlineDecoration(new Range$2(c.startLineNumber,c.startColumn,c.startLineNumber,c.startColumn),l.beforeContentClassName,1);s[c.startLineNumber-i].push(e)}if(l.afterContentClassName&&i<=c.endLineNumber&&c.endLineNumber<=n){const e=new InlineDecoration(new Range$2(c.endLineNumber,c.endColumn,c.endLineNumber,c.endColumn),l.afterContentClassName,2);s[c.endLineNumber-i].push(e)}}return{decorations:o,inlineDecorations:s}}}function isModelDecorationVisible(e,t){return(!t.options.hideInCommentTokens||!isModelDecorationInComment(e,t))&&(!t.options.hideInStringTokens||!isModelDecorationInString(e,t))}function isModelDecorationInComment(e,t){return testTokensInRange(e,t.range,(e=>1===e))}function isModelDecorationInString(e,t){return testTokensInRange(e,t.range,(e=>2===e))}function testTokensInRange(e,t,i){for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const o=e.getLineTokens(n),r=n===t.startLineNumber,s=n===t.endLineNumber;let a=r?o.findTokenIndexAtOffset(t.startColumn-1):0;for(;a<o.getCount();){if(s){if(o.getStartOffset(a)>t.endColumn-1)break}if(!i(o.getStandardTokenType(a)))return!1;a++}}return!0}class BracketInfo{constructor(e,t,i){this.range=e,this.nestingLevel=t,this.isInvalid=i}}class BracketPairInfo{constructor(e,t,i,n){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n}}class BracketPairWithMinIndentationInfo extends BracketPairInfo{constructor(e,t,i,n,o){super(e,t,i,n),this.minVisibleColumnIndentation=o}}class LengthObj{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}function lengthDiff(e,t,i,n){return e!==i?toLength(i-e,n):toLength(0,n-t)}LengthObj.zero=new LengthObj(0,0);const lengthZero=0;function lengthIsZero(e){return 0===e}const factor=Math.pow(2,26);function toLength(e,t){return e*factor+t}function lengthToObj(e){const t=e,i=Math.floor(t/factor);return new LengthObj(i,t-i*factor)}function lengthGetLineCount(e){return Math.floor(e/factor)}function lengthGetColumnCountIfZeroLineCount(e){return e}function lengthAdd(e,t){return t<factor?e+t:e-e%factor+t}function lengthDiffNonNegative(e,t){const i=e,n=t;if(n-i<=0)return lengthZero;const o=Math.floor(i/factor),r=Math.floor(n/factor),s=n-r*factor;if(o===r){return toLength(0,s-(i-o*factor))}return toLength(r-o,s)}function lengthLessThan(e,t){return e<t}function lengthLessThanEqual(e,t){return e<=t}function lengthGreaterThanEqual(e,t){return e>=t}function positionToLength(e){return toLength(e.lineNumber-1,e.column-1)}function lengthsToRange(e,t){const i=e,n=Math.floor(i/factor),o=i-n*factor,r=t,s=Math.floor(r/factor);return new Range$2(n+1,o+1,s+1,r-s*factor+1)}function lengthOfString(e){const t=splitLines(e);return toLength(t.length-1,t[t.length-1].length)}class TextEditInfo{constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}}class BeforeEditPositionMapper{constructor(e,t){this.documentLength=t,this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map((e=>TextEditInfoCache.from(e)))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx];return lengthDiffNonNegative(e,t?this.translateOldToCur(t.offsetObj):this.documentLength)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?toLength(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):toLength(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=lengthToObj(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?toLength(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):toLength(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(!lengthLessThanEqual(i,e))break;{this.nextEditIdx++;const e=lengthToObj(i),n=lengthToObj(this.translateOldToCur(t.endOffsetBeforeObj)),o=e.lineCount-n.lineCount;this.deltaOldToNewLineCount+=o;const r=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,s=e.columnCount-n.columnCount;this.deltaOldToNewColumnCount=r+s,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}}}}class TextEditInfoCache{constructor(e,t,i){this.endOffsetBeforeObj=lengthToObj(t),this.endOffsetAfterObj=lengthToObj(lengthAdd(e,i)),this.offsetObj=lengthToObj(e)}static from(e){return new TextEditInfoCache(e.startOffset,e.endOffset,e.newLength)}}const emptyArr=new Array;class SmallImmutableSet{constructor(e,t){this.items=e,this.additionalItems=t}static create(e,t){if(e<=128&&0===t.length){let i=SmallImmutableSet.cache[e];return i||(i=new SmallImmutableSet(e,t),SmallImmutableSet.cache[e]=i),i}return new SmallImmutableSet(e,t)}static getEmpty(){return this.empty}add(e,t){const i=t.getKey(e);let n=i>>5;if(0===n){const e=1<<i|this.items;return e===this.items?this:SmallImmutableSet.create(e,this.additionalItems)}n--;const o=this.additionalItems.slice(0);for(;o.length<n;)o.push(0);return o[n]|=1<<(31&i),SmallImmutableSet.create(this.items,o)}merge(e){const t=this.items|e.items;if(this.additionalItems===emptyArr&&e.additionalItems===emptyArr)return t===this.items?this:t===e.items?e:SmallImmutableSet.create(t,emptyArr);const i=new Array;for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const t=this.additionalItems[n]||0,o=e.additionalItems[n]||0;i.push(t|o)}return SmallImmutableSet.create(t,i)}intersects(e){if(0!=(this.items&e.items))return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(0!=(this.additionalItems[t]&e.additionalItems[t]))return!0;return!1}}SmallImmutableSet.cache=new Array(129),SmallImmutableSet.empty=SmallImmutableSet.create(0,emptyArr);const identityKeyProvider={getKey:e=>e};class DenseKeyProvider{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return void 0===t&&(t=this.items.size,this.items.set(e,t)),t}}class BaseAstNode{constructor(e){this._length=e}get length(){return this._length}}class PairAstNode extends BaseAstNode{constructor(e,t,i,n,o){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=o}static create(e,t,i){let n=e.length;return t&&(n=lengthAdd(n,t.length)),i&&(n=lengthAdd(n,i.length)),new PairAstNode(n,e,t,i,t?t.missingOpeningBracketIds:SmallImmutableSet.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=new Array;return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}canBeReused(e){return null!==this.closingBracket&&!e.intersects(this.missingOpeningBracketIds)}deepClone(){return new PairAstNode(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(lengthAdd(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class ListAstNode extends BaseAstNode{constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}static create23(e,t,i,n=!1){let o=e.length,r=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(o=lengthAdd(o,t.length),r=r.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");o=lengthAdd(o,i.length),r=r.merge(i.missingOpeningBracketIds)}return n?new Immutable23ListAstNode(o,e.listHeight+1,e,t,i,r):new TwoThreeListAstNode(o,e.listHeight+1,e,t,i,r)}static getEmpty(){return new ImmutableArrayListAstNode(lengthZero,0,[],SmallImmutableSet.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(0===e)return;const t=this.getChild(e-1),i=4===t.kind?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){this.throwIfImmutable();if(0===this.childrenLength)return;const e=this.getChild(0),t=4===e.kind?e.toMutable():e;return e!==t&&this.setChild(0,t),t}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds))return!1;let t,i=this;for(;4===i.kind&&(t=i.childrenLength)>0;)i=i.getChild(t-1);return i.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const e=this.getChild(n);t=lengthAdd(t,e.length),i=i.merge(e.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(-1!==this.cachedMinIndentation)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let o=0;o<this.childrenLength;o++){const e=this.getChild(o);e&&(i=Math.min(i,e.computeMinIndentation(n,t)),n=lengthAdd(n,e.length))}return this.cachedMinIndentation=i,i}}class TwoThreeListAstNode extends ListAstNode{constructor(e,t,i,n,o,r){super(e,t,r),this._item1=i,this._item2=n,this._item3=o}get childrenLength(){return null!==this._item3?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:return void(this._item1=t);case 1:return void(this._item2=t);case 2:return void(this._item3=t)}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}deepClone(){return new TwoThreeListAstNode(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class Immutable23ListAstNode extends TwoThreeListAstNode{toMutable(){return new TwoThreeListAstNode(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class ArrayListAstNode extends ListAstNode{constructor(e,t,i,n){super(e,t,n),this._children=i}get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new ArrayListAstNode(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class ImmutableArrayListAstNode extends ArrayListAstNode{toMutable(){return new ArrayListAstNode(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const emptyArray=[];class ImmutableLeafAstNode extends BaseAstNode{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return emptyArray}deepClone(){return this}}class TextAstNode extends ImmutableLeafAstNode{get kind(){return 0}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=lengthToObj(e),n=(0===i.columnCount?i.lineCount:i.lineCount+1)+1,o=lengthGetLineCount(lengthAdd(e,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let s=n;s<=o;s++){const e=t.getLineFirstNonWhitespaceColumn(s),i=t.getLineContent(s);if(0===e)continue;const n=CursorColumns.visibleColumnFromColumn(i,e,t.getOptions().tabSize);r=Math.min(r,n)}return r}}class BracketAstNode extends ImmutableLeafAstNode{constructor(e,t,i){super(e),this.languageId=t,this.bracketIds=i}static create(e,t,i){return new BracketAstNode(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return SmallImmutableSet.getEmpty()}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class InvalidBracketAstNode extends ImmutableLeafAstNode{constructor(e,t){super(t),this.missingOpeningBracketIds=e}get kind(){return 3}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class Token$1{constructor(e,t,i,n,o){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=o}}class TextBufferTokenizer{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new NonPeekableTextBufferTokenizer(this.textModel,this.bracketTokens),this._offset=lengthZero,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return toLength(this.textBufferLineCount,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=lengthAdd(this._offset,e);const t=lengthToObj(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=lengthAdd(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class NonPeekableTextBufferTokenizer{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset)):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const e=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=lengthGetColumnCountIfZeroLineCount(e.length),e}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;null===this.line&&(this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const n=this.lineTokens,o=n.getCount();let r=null;if(this.lineTokenOffset<o){const s=n.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<o&&s===n.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const a=0===TokenMetadata.getTokenType(s),l=n.getEndOffset(this.lineTokenOffset);if(a&&l!==this.lineCharOffset){const e=n.getLanguageId(this.lineTokenOffset),t=this.line.substring(this.lineCharOffset,l),i=this.bracketTokens.getSingleLanguageBracketTokens(e),o=i.regExpGlobal;if(o){o.lastIndex=0;const e=o.exec(t);e&&(r=i.getToken(e[0]),r&&(this.lineCharOffset+=e.index))}}if(i+=l-this.lineCharOffset,r){if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=r;break}return this.lineCharOffset+=lengthGetColumnCountIfZeroLineCount(r.length),r}this.lineTokenOffset++,this.lineCharOffset=l}else{if(this.lineIdx===this.textBufferLineCount-1)break;if(this.lineIdx++,this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3)break}if(i>1500)break}const n=lengthDiff(e,t,this.lineIdx,this.lineCharOffset);return new Token$1(n,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(n))}}class FastTokenizer{constructor(e,t){this.text=e,this._offset=lengthZero,this.idx=0;const i=t.getRegExpStr()?new RegExp(t.getRegExpStr()+"|\n","g"):null,n=[];let o,r=0,s=0,a=0,l=0;const d=new Array;for(let u=0;u<60;u++)d.push(new Token$1(toLength(0,u),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(0,u))));const c=new Array;for(let u=0;u<60;u++)c.push(new Token$1(toLength(1,u),0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(toLength(1,u))));if(i)for(i.lastIndex=0;null!==(o=i.exec(e));){const e=o.index,i=o[0];if("\n"===i)r++,s=e+1;else{if(a!==e){let t;if(l===r){const i=e-a;if(i<d.length)t=d[i];else{const e=toLength(0,i);t=new Token$1(e,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(e))}}else{const i=r-l,n=e-s;if(1===i&&n<c.length)t=c[n];else{const e=toLength(i,n);t=new Token$1(e,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(e))}}n.push(t)}n.push(t.getToken(i)),a=e+i.length,l=r}}const h=e.length;if(a!==h){const e=l===r?toLength(0,h-a):toLength(r-l,h-s);n.push(new Token$1(e,0,-1,SmallImmutableSet.getEmpty(),new TextAstNode(e)))}this.length=toLength(r,h-s),this.tokens=n}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new NotSupportedError}}class BracketTokens{constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}static createFromLanguage(e,t){function i(e,i){return t.getKey(`${e}:::${i}`)}const n=e.characterPair.getColorizedBrackets(),o=new Map,r=new Set;for(const[a,l]of n){r.add(a);let t=o.get(l);const n=i(e.languageId,a);t||(t={openingBrackets:SmallImmutableSet.getEmpty(),first:n},o.set(l,t)),t.openingBrackets=t.openingBrackets.add(n,identityKeyProvider)}const s=new Map;for(const[a,l]of o){const t=toLength(0,a.length);s.set(a,new Token$1(t,2,l.first,l.openingBrackets,BracketAstNode.create(t,e.languageId,l.openingBrackets)))}for(const a of r){const t=toLength(0,a.length),n=i(e.languageId,a),o=SmallImmutableSet.getEmpty().add(n,identityKeyProvider);s.set(a,new Token$1(t,1,n,o,BracketAstNode.create(t,e.languageId,o)))}return new BracketTokens(s)}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map((e=>prepareBracketForRegExp(e))).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e)}findClosingTokenText(e){for(const[t,i]of this.map)if(i.bracketIds.intersects(e))return t}get isEmpty(){return 0===this.map.size}}function prepareBracketForRegExp(e){const t=escapeRegExpCharacters(e);return/^[\w ]+$/.test(e)?`\\b${t}\\b`:t}class LanguageAgnosticBracketTokens{constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){const t=this.languageIdToBracketTokens.get(e);if(!t)return!1;const i=BracketTokens.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider).getRegExpStr();return t.getRegExpStr()!==i}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=BracketTokens.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function concat23Trees(e){if(0===e.length)return null;if(1===e.length)return e[0];let t=0;function i(){if(t>=e.length)return null;const i=t,n=e[i].listHeight;for(t++;t<e.length&&e[t].listHeight===n;)t++;return t-i>=2?concat23TreesOfSameHeight(0===i&&t===e.length?e:e.slice(i,t),!1):e[i]}let n=i(),o=i();if(!o)return n;for(let r=i();r;r=i())heightDiff(n,o)<=heightDiff(o,r)?(n=concat$1(n,o),o=r):o=concat$1(o,r);return concat$1(n,o)}function concat23TreesOfSameHeight(e,t=!1){if(0===e.length)return null;if(1===e.length)return e[0];let i=e.length;for(;i>3;){const n=i>>1;for(let o=0;o<n;o++){const n=o<<1;e[o]=ListAstNode.create23(e[n],e[n+1],n+3===i?e[n+2]:null,t)}i=n}return ListAstNode.create23(e[0],e[1],i>=3?e[2]:null,t)}function heightDiff(e,t){return Math.abs(e.listHeight-t.listHeight)}function concat$1(e,t){return e.listHeight===t.listHeight?ListAstNode.create23(e,t,null,!1):e.listHeight>t.listHeight?append(e,t):prepend(t,e)}function append(e,t){let i=e=e.toMutable();const n=new Array;let o;for(;;){if(t.listHeight===i.listHeight){o=t;break}if(4!==i.kind)throw new Error("unexpected");n.push(i),i=i.makeLastElementMutable()}for(let r=n.length-1;r>=0;r--){const e=n[r];o?e.childrenLength>=3?o=ListAstNode.create23(e.unappendChild(),o,null,!1):(e.appendChildOfSameHeight(o),o=void 0):e.handleChildrenChanged()}return o?ListAstNode.create23(e,o,null,!1):e}function prepend(e,t){let i=e=e.toMutable();const n=new Array;for(;t.listHeight!==i.listHeight;){if(4!==i.kind)throw new Error("unexpected");n.push(i),i=i.makeFirstElementMutable()}let o=t;for(let r=n.length-1;r>=0;r--){const e=n[r];o?e.childrenLength>=3?o=ListAstNode.create23(o,e.unprependChild(),null,!1):(e.prependChildOfSameHeight(o),o=void 0):e.handleChildrenChanged()}return o?ListAstNode.create23(o,e,null,!1):e}class NodeReader{constructor(e){this.lastOffset=lengthZero,this.nextNodes=[e],this.offsets=[lengthZero],this.idxs=[]}readLongestNodeAt(e,t){if(lengthLessThan(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=lastOrUndefined(this.nextNodes);if(!i)return;const n=lastOrUndefined(this.offsets);if(lengthLessThan(e,n))return;if(lengthLessThan(n,e))if(lengthAdd(n,i.length)<=e)this.nextNodeAfterCurrent();else{const e=getNextChildIdx(i);-1!==e?(this.nextNodes.push(i.getChild(e)),this.offsets.push(n),this.idxs.push(e)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const e=getNextChildIdx(i);if(-1===e)return void this.nextNodeAfterCurrent();this.nextNodes.push(i.getChild(e)),this.offsets.push(n),this.idxs.push(e)}}}}nextNodeAfterCurrent(){for(;;){const e=lastOrUndefined(this.offsets),t=lastOrUndefined(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),0===this.idxs.length)break;const i=lastOrUndefined(this.nextNodes),n=getNextChildIdx(i,this.idxs[this.idxs.length-1]);if(-1!==n){this.nextNodes.push(i.getChild(n)),this.offsets.push(lengthAdd(e,t.length)),this.idxs[this.idxs.length-1]=n;break}this.idxs.pop()}}}function getNextChildIdx(e,t=-1){for(;;){if(++t>=e.childrenLength)return-1;if(e.getChild(t))return t}}function lastOrUndefined(e){return e.length>0?e[e.length-1]:void 0}function parseDocument(e,t,i,n){return new Parser(e,t,i,n).parseDocument()}class Parser{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new NodeReader(i):void 0,this.positionMapper=new BeforeEditPositionMapper(t,e.length)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(SmallImmutableSet.getEmpty());return e||(e=ListAstNode.getEmpty()),e}parseList(e){const t=new Array;for(;;){const i=this.tokenizer.peek();if(!i||2===i.kind&&i.bracketIds.intersects(e))break;const n=this.parseChild(e);4===n.kind&&0===n.childrenLength||t.push(n)}return this.oldNodeReader?concat23Trees(t):concat23TreesOfSameHeight(t,this.createImmutableLists)}parseChild(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(!lengthIsZero(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),(i=>{if(!lengthLessThan(i.length,t))return!1;return i.canBeReused(e)}));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}this._itemsConstructed++;const t=this.tokenizer.read();switch(t.kind){case 2:return new InvalidBracketAstNode(t.bracketIds,t.length);case 0:return t.astNode;case 1:{const i=e.merge(t.bracketIds),n=this.parseList(i),o=this.tokenizer.peek();return o&&2===o.kind&&(o.bracketId===t.bracketId||o.bracketIds.intersects(t.bracketIds))?(this.tokenizer.read(),PairAstNode.create(t.astNode,n,o.astNode)):PairAstNode.create(t.astNode,n,null)}default:throw new Error("unexpected")}}}class BracketPairsTree extends Disposable{constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new Emitter$1,this.denseKeyProvider=new DenseKeyProvider,this.brackets=new LanguageAgnosticBracketTokens(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,0===e.backgroundTokenizationState){const e=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),t=new FastTokenizer(this.textModel.getValue(),e);this.initialAstWithoutTokens=parseDocument(t,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}else 2===e.backgroundTokenizationState?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):1===e.backgroundTokenizationState&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens)}didLanguageChange(e){return this.brackets.didLanguageChange(e)}handleDidChangeBackgroundTokenizationState(){if(2===this.textModel.backgroundTokenizationState){const e=void 0===this.initialAstWithoutTokens;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map((e=>new TextEditInfo(toLength(e.fromLineNumber-1,0),toLength(e.toLineNumber,0),toLength(e.toLineNumber-e.fromLineNumber+1,0))));this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens,!1),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=e.changes.map((e=>{const t=Range$2.lift(e.range);return new TextEditInfo(positionToLength(t.getStartPosition()),positionToLength(t.getEndPosition()),lengthOfString(e.text))})).reverse();this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens,!1),this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(t,this.initialAstWithoutTokens,!1))}parseDocumentFromTextBuffer(e,t,i){const n=t;return parseDocument(new TextBufferTokenizer(this.textModel,this.brackets),e,n,i)}getBracketsInRange(e){const t=toLength(e.startLineNumber-1,e.startColumn-1),i=toLength(e.endLineNumber-1,e.endColumn-1),n=new Array,o=this.initialAstWithoutTokens||this.astWithTokens;return collectBrackets(o,lengthZero,o.length,t,i,n),n}getBracketPairsInRange(e,t){const i=new Array,n=positionToLength(e.getStartPosition()),o=positionToLength(e.getEndPosition()),r=this.initialAstWithoutTokens||this.astWithTokens,s=new CollectBracketPairsContext(i,t,this.textModel);return collectBracketPairs(r,lengthZero,r.length,n,o,s),i}}function collectBrackets(e,t,i,n,o,r,s=0){if(4===e.kind)for(const a of e.children)i=lengthAdd(t,a.length),lengthLessThanEqual(t,o)&&lengthGreaterThanEqual(i,n)&&collectBrackets(a,t,i,n,o,r,s),t=i;else if(2===e.kind){s++;if(i=lengthAdd(t,e.openingBracket.length),lengthLessThanEqual(t,o)&&lengthGreaterThanEqual(i,n)){const n=lengthsToRange(t,i);r.push(new BracketInfo(n,s-1,!e.closingBracket))}t=i;if(e.child){const a=e.child;i=lengthAdd(t,a.length),lengthLessThanEqual(t,o)&&lengthGreaterThanEqual(i,n)&&collectBrackets(a,t,i,n,o,r,s),t=i}if(e.closingBracket){if(i=lengthAdd(t,e.closingBracket.length),lengthLessThanEqual(t,o)&&lengthGreaterThanEqual(i,n)){const e=lengthsToRange(t,i);r.push(new BracketInfo(e,s-1,!1))}t=i}}else if(3===e.kind){const e=lengthsToRange(t,i);r.push(new BracketInfo(e,s-1,!0))}else if(1===e.kind){const e=lengthsToRange(t,i);r.push(new BracketInfo(e,s-1,!1))}}class CollectBracketPairsContext{constructor(e,t,i){this.result=e,this.includeMinIndentation=t,this.textModel=i}}function collectBracketPairs(e,t,i,n,o,r,s=0){var a;if(2===e.kind){const n=lengthAdd(t,e.openingBracket.length);let o=-1;r.includeMinIndentation&&(o=e.computeMinIndentation(t,r.textModel)),r.result.push(new BracketPairWithMinIndentationInfo(lengthsToRange(t,i),lengthsToRange(t,n),e.closingBracket?lengthsToRange(lengthAdd(n,(null===(a=e.child)||void 0===a?void 0:a.length)||lengthZero),i):void 0,s,o)),s++}let l=t;for(const d of e.children){const e=l;l=lengthAdd(l,d.length),lengthLessThanEqual(e,o)&&lengthLessThanEqual(n,l)&&collectBracketPairs(d,e,l,n,o,r,s)}}class BracketPairsTextModelPart extends Disposable{constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new MutableDisposable),this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1,this._register(this.languageConfigurationService.onDidChange((e=>{var t;e.languageId&&!(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.didLanguageChange(e.languageId))||(this.bracketPairsTree.clear(),this.updateBracketPairsTree())})))}get isDocumentSupported(){return this.textModel.getValueLength()<=5e6}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){var t;null===(t=this.bracketPairsTree.value)||void 0===t||t.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){var e;null===(e=this.bracketPairsTree.value)||void 0===e||e.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){var t;null===(t=this.bracketPairsTree.value)||void 0===t||t.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.isDocumentSupported){if(!this.bracketPairsTree.value){const e=new DisposableStore;this.bracketPairsTree.value=createDisposableRef$1(e.add(new BracketPairsTree(this.textModel,(e=>this.languageConfigurationService.getLanguageConfiguration(e)))),e),e.add(this.bracketPairsTree.value.object.onDidChange((e=>this.onDidChangeEmitter.fire(e)))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketPairsInRange(e,!1))||[]}getBracketPairsInRangeWithMinIndentation(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketPairsInRange(e,!0))||[]}getBracketsInRange(e){var t;return this.bracketsRequested=!0,this.updateBracketPairsTree(),(null===(t=this.bracketPairsTree.value)||void 0===t?void 0:t.object.getBracketsInRange(e))||[]}findMatchingBracketUp(e,t,i){const n=e.toLowerCase(),o=this.textModel.validatePosition(t),r=this.textModel.getLanguageIdAtPosition(o.lineNumber,o.column),s=this.languageConfigurationService.getLanguageConfiguration(r).brackets;if(!s)return null;const a=s.textIsBracket[n];return a?stripBracketSearchCanceled(this._findMatchingBracketUp(a,o,createTimeBasedContinueBracketSearchPredicate(i))):null}matchBracket(e,t){const i=createTimeBasedContinueBracketSearchPredicate(t);return this._matchBracket(this.textModel.validatePosition(e),i)}_establishBracketSearchOffsets(e,t,i,n){const o=t.getCount(),r=t.getLanguageId(n);let s=Math.max(0,e.column-1-i.maxBracketLength);for(let l=n-1;l>=0;l--){const e=t.getEndOffset(l);if(e<=s)break;if(ignoreBracketsInToken(t.getStandardTokenType(l))||t.getLanguageId(l)!==r){s=e;break}}let a=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let l=n+1;l<o;l++){const e=t.getStartOffset(l);if(e>=a)break;if(ignoreBracketsInToken(t.getStandardTokenType(l))||t.getLanguageId(l)!==r){a=e;break}}return{searchStartOffset:s,searchEndOffset:a}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.getLineTokens(i),o=this.textModel.getLineContent(i),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const s=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(r)).brackets;if(s&&!ignoreBracketsInToken(n.getStandardTokenType(r))){let{searchStartOffset:a,searchEndOffset:l}=this._establishBracketSearchOffsets(e,n,s,r),d=null;for(;;){const n=BracketsUtils.findNextBracketInRange(s.forwardRegex,i,o,a,l);if(!n)break;if(n.startColumn<=e.column&&e.column<=n.endColumn){const e=o.substring(n.startColumn-1,n.endColumn-1).toLowerCase(),i=this._matchFoundBracket(n,s.textIsBracket[e],s.textIsOpenBracket[e],t);if(i){if(i instanceof BracketSearchCanceled)return null;d=i}}a=n.endColumn-1}if(d)return d}if(r>0&&n.getStartOffset(r)===e.column-1){const s=r-1,a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(s)).brackets;if(a&&!ignoreBracketsInToken(n.getStandardTokenType(s))){const{searchStartOffset:r,searchEndOffset:l}=this._establishBracketSearchOffsets(e,n,a,s),d=BracketsUtils.findPrevBracketInRange(a.reversedRegex,i,o,r,l);if(d&&d.startColumn<=e.column&&e.column<=d.endColumn){const e=o.substring(d.startColumn-1,d.endColumn-1).toLowerCase(),i=this._matchFoundBracket(d,a.textIsBracket[e],a.textIsOpenBracket[e],t);if(i)return i instanceof BracketSearchCanceled?null:i}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const o=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return o?o instanceof BracketSearchCanceled?o:[e,o]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,o=e.reversedRegex;let r=-1,s=0;const a=(t,n,a,l)=>{for(;;){if(i&&++s%100==0&&!i())return BracketSearchCanceled.INSTANCE;const d=BracketsUtils.findPrevBracketInRange(o,t,n,a,l);if(!d)break;const c=n.substring(d.startColumn-1,d.endColumn-1).toLowerCase();if(e.isOpen(c)?r++:e.isClose(c)&&r--,0===r)return d;l=d.startColumn-1}return null};for(let l=t.lineNumber;l>=1;l--){const e=this.textModel.getLineTokens(l),i=e.getCount(),o=this.textModel.getLineContent(l);let r=i-1,s=o.length,d=o.length;l===t.lineNumber&&(r=e.findTokenIndexAtOffset(t.column-1),s=t.column-1,d=t.column-1);let c=!0;for(;r>=0;r--){const t=e.getLanguageId(r)===n&&!ignoreBracketsInToken(e.getStandardTokenType(r));if(t)c?s=e.getStartOffset(r):(s=e.getStartOffset(r),d=e.getEndOffset(r));else if(c&&s!==d){const e=a(l,o,s,d);if(e)return e}c=t}if(c&&s!==d){const e=a(l,o,s,d);if(e)return e}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,o=e.forwardRegex;let r=1,s=0;const a=(t,n,a,l)=>{for(;;){if(i&&++s%100==0&&!i())return BracketSearchCanceled.INSTANCE;const d=BracketsUtils.findNextBracketInRange(o,t,n,a,l);if(!d)break;const c=n.substring(d.startColumn-1,d.endColumn-1).toLowerCase();if(e.isOpen(c)?r++:e.isClose(c)&&r--,0===r)return d;a=d.endColumn-1}return null},l=this.textModel.getLineCount();for(let d=t.lineNumber;d<=l;d++){const e=this.textModel.getLineTokens(d),i=e.getCount(),o=this.textModel.getLineContent(d);let r=0,s=0,l=0;d===t.lineNumber&&(r=e.findTokenIndexAtOffset(t.column-1),s=t.column-1,l=t.column-1);let c=!0;for(;r<i;r++){const t=e.getLanguageId(r)===n&&!ignoreBracketsInToken(e.getStandardTokenType(r));if(t)c||(s=e.getStartOffset(r)),l=e.getEndOffset(r);else if(c&&s!==l){const e=a(d,o,s,l);if(e)return e}c=t}if(c&&s!==l){const e=a(d,o,s,l);if(e)return e}}return null}findPrevBracket(e){const t=this.textModel.validatePosition(e);let i=null,n=null;for(let o=t.lineNumber;o>=1;o--){const e=this.textModel.getLineTokens(o),r=e.getCount(),s=this.textModel.getLineContent(o);let a=r-1,l=s.length,d=s.length;if(o===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),l=t.column-1,d=t.column-1;const o=e.getLanguageId(a);i!==o&&(i=o,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets)}let c=!0;for(;a>=0;a--){const t=e.getLanguageId(a);if(i!==t){if(n&&c&&l!==d){const e=BracketsUtils.findPrevBracketInRange(n.reversedRegex,o,s,l,d);if(e)return this._toFoundBracket(n,e);c=!1}i=t,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets}const r=!!n&&!ignoreBracketsInToken(e.getStandardTokenType(a));if(r)c?l=e.getStartOffset(a):(l=e.getStartOffset(a),d=e.getEndOffset(a));else if(n&&c&&l!==d){const e=BracketsUtils.findPrevBracketInRange(n.reversedRegex,o,s,l,d);if(e)return this._toFoundBracket(n,e)}c=r}if(n&&c&&l!==d){const e=BracketsUtils.findPrevBracketInRange(n.reversedRegex,o,s,l,d);if(e)return this._toFoundBracket(n,e)}}return null}findNextBracket(e){const t=this.textModel.validatePosition(e),i=this.textModel.getLineCount();let n=null,o=null;for(let r=t.lineNumber;r<=i;r++){const e=this.textModel.getLineTokens(r),i=e.getCount(),s=this.textModel.getLineContent(r);let a=0,l=0,d=0;if(r===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),l=t.column-1,d=t.column-1;const i=e.getLanguageId(a);n!==i&&(n=i,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets)}let c=!0;for(;a<i;a++){const t=e.getLanguageId(a);if(n!==t){if(o&&c&&l!==d){const e=BracketsUtils.findNextBracketInRange(o.forwardRegex,r,s,l,d);if(e)return this._toFoundBracket(o,e);c=!1}n=t,o=this.languageConfigurationService.getLanguageConfiguration(n).brackets}const i=!!o&&!ignoreBracketsInToken(e.getStandardTokenType(a));if(i)c||(l=e.getStartOffset(a)),d=e.getEndOffset(a);else if(o&&c&&l!==d){const e=BracketsUtils.findNextBracketInRange(o.forwardRegex,r,s,l,d);if(e)return this._toFoundBracket(o,e)}c=i}if(o&&c&&l!==d){const e=BracketsUtils.findNextBracketInRange(o.forwardRegex,r,s,l,d);if(e)return this._toFoundBracket(o,e)}}return null}findEnclosingBrackets(e,t){const i=createTimeBasedContinueBracketSearchPredicate(t),n=this.textModel.validatePosition(e),o=this.textModel.getLineCount(),r=new Map;let s=[];const a=(e,t)=>{if(!r.has(e)){const i=[];for(let e=0,n=t?t.brackets.length:0;e<n;e++)i[e]=0;r.set(e,i)}s=r.get(e)};let l=0;const d=(e,t,n,o,r)=>{for(;;){if(i&&++l%100==0&&!i())return BracketSearchCanceled.INSTANCE;const a=BracketsUtils.findNextBracketInRange(e.forwardRegex,t,n,o,r);if(!a)break;const d=n.substring(a.startColumn-1,a.endColumn-1).toLowerCase(),c=e.textIsBracket[d];if(c&&(c.isOpen(d)?s[c.index]++:c.isClose(d)&&s[c.index]--,-1===s[c.index]))return this._matchFoundBracket(a,c,!1,i);o=a.endColumn-1}return null};let c=null,h=null;for(let u=n.lineNumber;u<=o;u++){const e=this.textModel.getLineTokens(u),t=e.getCount(),i=this.textModel.getLineContent(u);let o=0,r=0,s=0;if(u===n.lineNumber){o=e.findTokenIndexAtOffset(n.column-1),r=n.column-1,s=n.column-1;const t=e.getLanguageId(o);c!==t&&(c=t,h=this.languageConfigurationService.getLanguageConfiguration(c).brackets,a(c,h))}let l=!0;for(;o<t;o++){const t=e.getLanguageId(o);if(c!==t){if(h&&l&&r!==s){const e=d(h,u,i,r,s);if(e)return stripBracketSearchCanceled(e);l=!1}c=t,h=this.languageConfigurationService.getLanguageConfiguration(c).brackets,a(c,h)}const n=!!h&&!ignoreBracketsInToken(e.getStandardTokenType(o));if(n)l||(r=e.getStartOffset(o)),s=e.getEndOffset(o);else if(h&&l&&r!==s){const e=d(h,u,i,r,s);if(e)return stripBracketSearchCanceled(e)}l=n}if(h&&l&&r!==s){const e=d(h,u,i,r,s);if(e)return stripBracketSearchCanceled(e)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.textIsBracket[i];return n?{range:t,open:n.open,close:n.close,isOpen:e.textIsOpenBracket[i]}:null}}function createDisposableRef$1(e,t){return{object:e,dispose:()=>null==t?void 0:t.dispose()}}function createTimeBasedContinueBracketSearchPredicate(e){if(void 0===e)return()=>!0;{const t=Date.now();return()=>Date.now()-t<=e}}class BracketSearchCanceled{constructor(){this._searchCanceledBrand=void 0}}function stripBracketSearchCanceled(e){return e instanceof BracketSearchCanceled?null:e}BracketSearchCanceled.INSTANCE=new BracketSearchCanceled;class ColorizedBracketPairsDecorationProvider extends Disposable{constructor(e){super(),this.textModel=e,this.colorProvider=new ColorProvider,this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange((e=>{this.onDidChangeEmitter.fire()})))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i){if(void 0===t)return[];if(!this.colorizationOptions.enabled)return[];const n=new Array,o=this.textModel.bracketPairs.getBracketsInRange(e);for(const r of o)n.push({id:`bracket${r.range.toString()}-${r.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r)},ownerId:0,range:r.range});return n}getAllDecorations(e,t){return void 0===e?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new Range$2(1,1,this.textModel.getLineCount(),1),e,t):[]}}class ColorProvider{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e.nestingLevel)}getInlineClassNameOfLevel(e){return"bracket-highlighting-"+e%30}}function escapeNewLine(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}registerThemingParticipant(((e,t)=>{const i=[editorBracketHighlightingForeground1,editorBracketHighlightingForeground2,editorBracketHighlightingForeground3,editorBracketHighlightingForeground4,editorBracketHighlightingForeground5,editorBracketHighlightingForeground6],n=new ColorProvider;t.addRule(`.monaco-editor .${n.unexpectedClosingBracketClassName} { color: ${e.getColor(editorBracketHighlightingUnexpectedBracketForeground)}; }`);const o=i.map((t=>e.getColor(t))).filter((e=>!!e)).filter((e=>!e.isTransparent()));for(let r=0;r<30;r++){const e=o[r%o.length];t.addRule(`.monaco-editor .${n.getInlineClassNameOfLevel(r)} { color: ${e}; }`)}}));class TextChange{constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return 0===this.oldText.length?`(insert@${this.oldPosition} "${escapeNewLine(this.newText)}")`:0===this.newText.length?`(delete@${this.oldPosition} "${escapeNewLine(this.oldText)}")`:`(replace@${this.oldPosition} "${escapeNewLine(this.oldText)}" with "${escapeNewLine(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;writeUInt32BE(e,n,i),i+=4;for(let o=0;o<n;o++)writeUInt16LE(e,t.charCodeAt(o),i),i+=2;return i}static _readString(e,t){const i=readUInt32BE(e,t);return decodeUTF16LE(e,t+=4,i)}writeSize(){return 8+TextChange._writeStringSize(this.oldText)+TextChange._writeStringSize(this.newText)}write(e,t){return writeUInt32BE(e,this.oldPosition,t),t+=4,writeUInt32BE(e,this.newPosition,t),t+=4,t=TextChange._writeString(e,this.oldText,t),t=TextChange._writeString(e,this.newText,t)}static read(e,t,i){const n=readUInt32BE(e,t),o=readUInt32BE(e,t+=4);t+=4;const r=TextChange._readString(e,t);t+=TextChange._writeStringSize(r);const s=TextChange._readString(e,t);return t+=TextChange._writeStringSize(s),i.push(new TextChange(n,r,o,s)),t}}function compressConsecutiveTextChanges(e,t){if(null===e||0===e.length)return t;return new TextChangeCompressor(e,t).compress()}class TextChangeCompressor{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(null===i){this._acceptCurr(n),n=this._getCurr(++t);continue}if(null===n){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[e,t]=TextChangeCompressor._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(e),n=t;continue}if(i.newPosition<n.oldPosition){const[e,t]=TextChangeCompressor._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(e),i=t;continue}let o,r;if(n.oldEnd===i.newEnd)o=i,r=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[e,s]=TextChangeCompressor._splitPrev(i,n.oldLength);o=e,r=n,i=s,n=this._getCurr(++t)}else{const[t,s]=TextChangeCompressor._splitCurr(n,i.newLength);o=i,r=t,i=this._getPrev(++e),n=s}this._result[this._resultLen++]=new TextChange(o.oldPosition,o.oldText,r.newPosition,r.newText),this._prevDeltaOffset+=o.newLength-o.oldLength,this._currDeltaOffset+=r.newLength-r.oldLength}const o=TextChangeCompressor._merge(this._result);return TextChangeCompressor._removeNoOps(o)}_acceptCurr(e){this._result[this._resultLen++]=TextChangeCompressor._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=TextChangeCompressor._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new TextChange(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new TextChange(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new TextChange(e.oldPosition,e.oldText,e.newPosition,i),new TextChange(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new TextChange(e.oldPosition,i,e.newPosition,e.newText),new TextChange(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(0===e.length)return e;const t=[];let i=0,n=e[0];for(let o=1;o<e.length;o++){const r=e[o];n.oldEnd===r.oldPosition?n=new TextChange(n.oldPosition,n.oldText+r.oldText,n.newPosition,n.newText+r.newText):(t[i++]=n,n=r)}return t[i++]=n,t}static _removeNoOps(e){if(0===e.length)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const o=e[n];o.oldText!==o.newText&&(t[i++]=o)}return t}}function isPathSeparator(e){return 47===e||92===e}function toSlashes(e){return e.replace(/[\\/]/g,posix.sep)}function toPosixPath(e){return-1===e.indexOf("/")&&(e=toSlashes(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function getRoot(e,t=posix.sep){if(!e)return"";const i=e.length,n=e.charCodeAt(0);if(isPathSeparator(n)){if(isPathSeparator(e.charCodeAt(1))&&!isPathSeparator(e.charCodeAt(2))){let n=3;const o=n;for(;n<i&&!isPathSeparator(e.charCodeAt(n));n++);if(o!==n&&!isPathSeparator(e.charCodeAt(n+1)))for(n+=1;n<i;n++)if(isPathSeparator(e.charCodeAt(n)))return e.slice(0,n+1).replace(/[\\/]/g,t)}return t}if(isWindowsDriveLetter(n)&&58===e.charCodeAt(1))return isPathSeparator(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let o=e.indexOf("://");if(-1!==o)for(o+=3;o<i;o++)if(isPathSeparator(e.charCodeAt(o)))return e.slice(0,o+1);return""}function isEqualOrParent(e,t,i,n=sep){if(e===t)return!0;if(!e||!t)return!1;if(t.length>e.length)return!1;if(i){if(!startsWithIgnoreCase(e,t))return!1;if(t.length===e.length)return!0;let i=t.length;return t.charAt(t.length-1)===n&&i--,e.charAt(i)===n}return t.charAt(t.length-1)!==n&&(t+=n),0===e.indexOf(t)}function isWindowsDriveLetter(e){return e>=65&&e<=90||e>=97&&e<=122}function isRootOrDriveLetter(e){const t=normalize(e);return isWindows?!(e.length>3)&&(hasDriveLetter(t)&&(2===e.length||92===t.charCodeAt(2))):t===posix.sep}function hasDriveLetter(e,t){return!!(void 0!==t?t:isWindows)&&(isWindowsDriveLetter(e.charCodeAt(0))&&58===e.charCodeAt(1))}function originalFSPath(e){return uriToFsPath(e,!0)}class ExtUri{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:compare(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t||!(!e||!t)&&this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===Schemas.file)return isEqualOrParent(originalFSPath(e),originalFSPath(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(isEqualAuthority(e.authority,t.authority))return isEqualOrParent(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return URI.joinPath(e,...t)}basenameOrAuthority(e){return basename(e)||e.authority}basename(e){return posix.basename(e.path)}extname(e){return posix.extname(e.path)}dirname(e){if(0===e.path.length)return e;let t;return e.scheme===Schemas.file?t=URI.file(dirname$1(originalFSPath(e))).path:(t=posix.dirname(e.path),e.authority&&t.length&&47!==t.charCodeAt(0)&&(t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return t=e.scheme===Schemas.file?URI.file(normalize(originalFSPath(e))).path:posix.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!isEqualAuthority(e.authority,t.authority))return;if(e.scheme===Schemas.file){const i=relative(originalFSPath(e),originalFSPath(t));return isWindows?toSlashes(i):i}let i=e.path||"/",n=t.path||"/";if(this._ignorePathCasing(e)){let e=0;for(const t=Math.min(i.length,n.length);e<t&&(i.charCodeAt(e)===n.charCodeAt(e)||i.charAt(e).toLowerCase()===n.charAt(e).toLowerCase());e++);i=n.substr(0,e)+i.substr(e)}return posix.relative(i,n)}resolvePath(e,t){if(e.scheme===Schemas.file){const i=URI.file(resolve(originalFSPath(e),t));return e.with({authority:i.authority,path:i.path})}return t=toPosixPath(t),e.with({path:posix.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&"/"===e.path[0]}isEqualAuthority(e,t){return e===t||void 0!==e&&void 0!==t&&equalsIgnoreCase(e,t)}hasTrailingPathSeparator(e,t=sep){if(e.scheme===Schemas.file){const i=originalFSPath(e);return i.length>getRoot(i).length&&i[i.length-1]===t}{const t=e.path;return t.length>1&&47===t.charCodeAt(t.length-1)&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=sep){return hasTrailingPathSeparator(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=sep){let i=!1;if(e.scheme===Schemas.file){const n=originalFSPath(e);i=void 0!==n&&n.length===getRoot(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=1===n.length&&47===n.charCodeAt(n.length-1)}return i||hasTrailingPathSeparator(e,t)?e:e.with({path:e.path+"/"})}}const extUri=new ExtUri((()=>!1));new ExtUri((e=>e.scheme!==Schemas.file||!isLinux)),new ExtUri((e=>!0));const isEqual=extUri.isEqual.bind(extUri);extUri.isEqualOrParent.bind(extUri),extUri.getComparisonKey.bind(extUri);const basenameOrAuthority=extUri.basenameOrAuthority.bind(extUri),basename=extUri.basename.bind(extUri),extname=extUri.extname.bind(extUri),dirname=extUri.dirname.bind(extUri),joinPath=extUri.joinPath.bind(extUri),normalizePath=extUri.normalizePath.bind(extUri);extUri.relativePath.bind(extUri);const resolvePath=extUri.resolvePath.bind(extUri);extUri.isAbsolutePath.bind(extUri);const isEqualAuthority=extUri.isEqualAuthority.bind(extUri),hasTrailingPathSeparator=extUri.hasTrailingPathSeparator.bind(extUri);var DataUri,DataUri2;function uriGetComparisonKey(e){return e.toString()}extUri.removeTrailingPathSeparator.bind(extUri),extUri.addTrailingPathSeparator.bind(extUri),DataUri2=DataUri||(DataUri={}),DataUri2.META_DATA_LABEL="label",DataUri2.META_DATA_DESCRIPTION="description",DataUri2.META_DATA_SIZE="size",DataUri2.META_DATA_MIME="mime",DataUri2.parseMetaData=function(e){const t=new Map;e.path.substring(e.path.indexOf(";")+1,e.path.lastIndexOf(";")).split(";").forEach((e=>{const[i,n]=e.split(":");i&&n&&t.set(i,n)}));const i=e.path.substring(0,e.path.indexOf(";"));return i&&t.set(DataUri2.META_DATA_MIME,i),t};class SingleModelEditStackData{constructor(e,t,i,n,o,r,s){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=o,this.afterCursorState=r,this.changes=s}static create(e,t){const i=e.getAlternativeVersionId(),n=getModelEOL(e);return new SingleModelEditStackData(i,i,n,n,t,t,[])}append(e,t,i,n,o){t.length>0&&(this.changes=compressConsecutiveTextChanges(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=o}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,i){if(writeUInt32BE(e,t?t.length:0,i),i+=4,t)for(const n of t)writeUInt32BE(e,n.selectionStartLineNumber,i),i+=4,writeUInt32BE(e,n.selectionStartColumn,i),i+=4,writeUInt32BE(e,n.positionLineNumber,i),i+=4,writeUInt32BE(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=readUInt32BE(e,t);t+=4;for(let o=0;o<n;o++){const n=readUInt32BE(e,t),o=readUInt32BE(e,t+=4),r=readUInt32BE(e,t+=4),s=readUInt32BE(e,t+=4);t+=4,i.push(new Selection$1(n,o,r,s))}return t}serialize(){let e=10+SingleModelEditStackData._writeSelectionsSize(this.beforeCursorState)+SingleModelEditStackData._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;writeUInt32BE(t,this.beforeVersionId,i),i+=4,writeUInt32BE(t,this.afterVersionId,i),i+=4,writeUInt8(t,this.beforeEOL,i),i+=1,writeUInt8(t,this.afterEOL,i),i+=1,i=SingleModelEditStackData._writeSelections(t,this.beforeCursorState,i),i=SingleModelEditStackData._writeSelections(t,this.afterCursorState,i),writeUInt32BE(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=readUInt32BE(t,i);i+=4;const o=readUInt32BE(t,i);i+=4;const r=readUInt8(t,i);i+=1;const s=readUInt8(t,i);i+=1;const a=[];i=SingleModelEditStackData._readSelections(t,i,a);const l=[];i=SingleModelEditStackData._readSelections(t,i,l);const d=readUInt32BE(t,i);i+=4;const c=[];for(let h=0;h<d;h++)i=TextChange.read(t,i,c);return new SingleModelEditStackData(n,o,r,s,a,l,c)}}class SingleModelEditStackElement{constructor(e,t){this.model=e,this._data=SingleModelEditStackData.create(e,t)}get type(){return 0}get resource(){return URI.isUri(this.model)?this.model:this.model.uri}get label(){return localize("edit","Typing")}toString(){return(this._data instanceof SingleModelEditStackData?this._data:SingleModelEditStackData.deserialize(this._data)).changes.map((e=>e.toString())).join(", ")}matchesResource(e){return(URI.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof SingleModelEditStackData}append(e,t,i,n,o){this._data instanceof SingleModelEditStackData&&this._data.append(e,t,i,n,o)}close(){this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize())}open(){this._data instanceof SingleModelEditStackData||(this._data=SingleModelEditStackData.deserialize(this._data))}undo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const e=SingleModelEditStackData.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(URI.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize());const e=SingleModelEditStackData.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof SingleModelEditStackData&&(this._data=this._data.serialize()),this._data.byteLength+168}}class MultiModelEditStackElement{constructor(e,t){this.type=1,this.label=e,this._isOpen=!0,this._editStackElementsArr=t.slice(0),this._editStackElementsMap=new Map;for(const i of this._editStackElementsArr){const e=uriGetComparisonKey(i.resource);this._editStackElementsMap.set(e,i)}this._delegate=null}get resources(){return this._editStackElementsArr.map((e=>e.resource))}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=uriGetComparisonKey(e);return this._editStackElementsMap.has(t)}setModel(e){const t=uriGetComparisonKey(URI.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=uriGetComparisonKey(e.uri);if(this._editStackElementsMap.has(t)){return this._editStackElementsMap.get(t).canAppend(e)}return!1}append(e,t,i,n,o){const r=uriGetComparisonKey(e.uri);this._editStackElementsMap.get(r).append(e,t,i,n,o)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=uriGetComparisonKey(e);if(this._editStackElementsMap.has(t)){return this._editStackElementsMap.get(t).heapSize()}return 0}split(){return this._editStackElementsArr}toString(){let e=[];for(const t of this._editStackElementsArr)e.push(`${basename(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function getModelEOL(e){return"\n"===e.getEOL()?0:1}function isEditStackElement(e){return!!e&&(e instanceof SingleModelEditStackElement||e instanceof MultiModelEditStackElement)}class EditStack{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);isEditStackElement(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e){const t=this._undoRedoService.getLastElement(this._model.uri);if(isEditStackElement(t)&&t.canAppend(this._model))return t;const i=new SingleModelEditStackElement(this._model,e);return this._undoRedoService.pushElement(i),i}pushEOL(e){const t=this._getOrCreateEditStackElement(null);this._model.setEOL(e),t.append(this._model,[],getModelEOL(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i){const n=this._getOrCreateEditStackElement(e),o=this._model.applyEdits(t,!0),r=EditStack._computeCursorState(i,o),s=o.map(((e,t)=>({index:t,textChange:e.textChange})));return s.sort(((e,t)=>e.textChange.oldPosition===t.textChange.oldPosition?e.index-t.index:e.textChange.oldPosition-t.textChange.oldPosition)),n.append(this._model,s.map((e=>e.textChange)),getModelEOL(this._model),this._model.getAlternativeVersionId(),r),r}static _computeCursorState(e,t){try{return e?e(t):null}catch(e2){return onUnexpectedError(e2),null}}}class SpacesDiffResult{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function spacesDiff(e,t,i,n,o){let r;for(o.spacesDiff=0,o.looksLikeAlignment=!1,r=0;r<t&&r<n;r++){if(e.charCodeAt(r)!==i.charCodeAt(r))break}let s=0,a=0;for(let u=r;u<t;u++){32===e.charCodeAt(u)?s++:a++}let l=0,d=0;for(let u=r;u<n;u++){32===i.charCodeAt(u)?l++:d++}if(s>0&&a>0)return;if(l>0&&d>0)return;const c=Math.abs(a-d),h=Math.abs(s-l);if(0===c)return o.spacesDiff=h,void(h>0&&0<=l-1&&l-1<e.length&&l<i.length&&32!==i.charCodeAt(l)&&32===e.charCodeAt(l-1)&&44===e.charCodeAt(e.length-1)&&(o.looksLikeAlignment=!0));h%c!=0||(o.spacesDiff=h/c)}function guessIndentation(e,t,i){const n=Math.min(e.getLineCount(),1e4);let o=0,r=0,s="",a=0;const l=[2,4,6,8,3,5,7],d=[0,0,0,0,0,0,0,0,0],c=new SpacesDiffResult;for(let g=1;g<=n;g++){const n=e.getLineLength(g),l=e.getLineContent(g),h=n<=65536;let u=!1,p=0,m=0,f=0;for(let t=0,i=n;t<i;t++){const i=h?l.charCodeAt(t):e.getLineCharCode(g,t);if(9===i)f++;else{if(32!==i){u=!0,p=t;break}m++}}if(!u)continue;if(f>0?o++:m>1&&r++,spacesDiff(s,a,l,p,c),c.looksLikeAlignment&&(!i||t!==c.spacesDiff))continue;const _=c.spacesDiff;_<=8&&d[_]++,s=l,a=p}let h=i;o!==r&&(h=o<r);let u=t;if(h){let e=h?0:.1*n;l.forEach((t=>{const i=d[t];i>e&&(e=i,u=t)})),4===u&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(u=2)}return{insertSpaces:h,tabSize:u}}function getNodeColor(e){return(1&e.metadata)>>>0}function setNodeColor(e,t){e.metadata=254&e.metadata|t<<0}function getNodeIsVisited(e){return(2&e.metadata)>>>1==1}function setNodeIsVisited(e,t){e.metadata=253&e.metadata|(t?1:0)<<1}function getNodeIsForValidation(e){return(4&e.metadata)>>>2==1}function setNodeIsForValidation(e,t){e.metadata=251&e.metadata|(t?1:0)<<2}function getNodeStickiness(e){return(24&e.metadata)>>>3}function _setNodeStickiness(e,t){e.metadata=231&e.metadata|t<<3}function getCollapseOnReplaceEdit(e){return(32&e.metadata)>>>5==1}function setCollapseOnReplaceEdit(e,t){e.metadata=223&e.metadata|(t?1:0)<<5}class IntervalNode{constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,setNodeColor(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,setNodeIsForValidation(this,!1),_setNodeStickiness(this,1),setCollapseOnReplaceEdit(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,setNodeIsVisited(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;setNodeIsForValidation(this,"squiggly-error"===t||"squiggly-warning"===t||"squiggly-info"===t),_setNodeStickiness(this,this.options.stickiness),setCollapseOnReplaceEdit(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL$1=new IntervalNode(null,0,0);SENTINEL$1.parent=SENTINEL$1,SENTINEL$1.left=SENTINEL$1,SENTINEL$1.right=SENTINEL$1,setNodeColor(SENTINEL$1,0);class IntervalTree{constructor(){this.root=SENTINEL$1,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,o){return this.root===SENTINEL$1?[]:intervalSearch(this,e,t,i,n,o)}search(e,t,i){return this.root===SENTINEL$1?[]:search(this,e,t,i)}collectNodesFromOwner(e){return collectNodesFromOwner(this,e)}collectNodesPostOrder(){return collectNodesPostOrder(this)}insert(e){rbTreeInsert(this,e),this._normalizeDeltaIfNecessary()}delete(e){rbTreeDelete(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const o=i.start+n,r=i.end+n;i.setCachedOffsets(o,r,t)}acceptReplace(e,t,i,n){const o=searchForEditing(this,e,e+t);for(let r=0,s=o.length;r<s;r++){rbTreeDelete(this,o[r])}this._normalizeDeltaIfNecessary(),noOverlapReplace(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let r=0,s=o.length;r<s;r++){const s=o[r];s.start=s.cachedAbsoluteStart,s.end=s.cachedAbsoluteEnd,nodeAcceptEdit(s,e,e+t,i,n),s.maxEnd=s.end,rbTreeInsert(this,s)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,normalizeDelta(this))}}function normalizeDelta(e){let t=e.root,i=0;for(;t!==SENTINEL$1;)t.left===SENTINEL$1||getNodeIsVisited(t.left)?t.right===SENTINEL$1||getNodeIsVisited(t.right)?(t.start=i+t.start,t.end=i+t.end,t.delta=0,recomputeMaxEnd(t),setNodeIsVisited(t,!0),setNodeIsVisited(t.left,!1),setNodeIsVisited(t.right,!1),t===t.parent.right&&(i-=t.parent.delta),t=t.parent):(i+=t.delta,t=t.right):t=t.left;setNodeIsVisited(e.root,!1)}function adjustMarkerBeforeColumn(e,t,i,n){return e<i||!(e>i)&&(1!==n&&(2===n||t))}function nodeAcceptEdit(e,t,i,n,o){const r=getNodeStickiness(e),s=0===r||2===r,a=1===r||2===r,l=i-t,d=n,c=Math.min(l,d),h=e.start;let u=!1;const g=e.end;let p=!1;t<=h&&g<=i&&getCollapseOnReplaceEdit(e)&&(e.start=t,u=!0,e.end=t,p=!0);{const e=o?1:l>0?2:0;!u&&adjustMarkerBeforeColumn(h,s,t,e)&&(u=!0),!p&&adjustMarkerBeforeColumn(g,a,t,e)&&(p=!0)}if(c>0&&!o){const e=l>d?2:0;!u&&adjustMarkerBeforeColumn(h,s,t+c,e)&&(u=!0),!p&&adjustMarkerBeforeColumn(g,a,t+c,e)&&(p=!0)}{const n=o?1:0;!u&&adjustMarkerBeforeColumn(h,s,i,n)&&(e.start=t+d,u=!0),!p&&adjustMarkerBeforeColumn(g,a,i,n)&&(e.end=t+d,p=!0)}const m=d-l;u||(e.start=Math.max(0,h+m)),p||(e.end=Math.max(0,g+m)),e.start>e.end&&(e.end=e.start)}function searchForEditing(e,t,i){let n=e.root,o=0,r=0,s=0,a=0;const l=[];let d=0;for(;n!==SENTINEL$1;)if(getNodeIsVisited(n))setNodeIsVisited(n.left,!1),setNodeIsVisited(n.right,!1),n===n.parent.right&&(o-=n.parent.delta),n=n.parent;else{if(!getNodeIsVisited(n.left)){if(r=o+n.maxEnd,r<t){setNodeIsVisited(n,!0);continue}if(n.left!==SENTINEL$1){n=n.left;continue}}s=o+n.start,s>i?setNodeIsVisited(n,!0):(a=o+n.end,a>=t&&(n.setCachedOffsets(s,a,0),l[d++]=n),setNodeIsVisited(n,!0),n.right===SENTINEL$1||getNodeIsVisited(n.right)||(o+=n.delta,n=n.right))}return setNodeIsVisited(e.root,!1),l}function noOverlapReplace(e,t,i,n){let o=e.root,r=0,s=0,a=0;const l=n-(i-t);for(;o!==SENTINEL$1;)if(getNodeIsVisited(o))setNodeIsVisited(o.left,!1),setNodeIsVisited(o.right,!1),o===o.parent.right&&(r-=o.parent.delta),recomputeMaxEnd(o),o=o.parent;else{if(!getNodeIsVisited(o.left)){if(s=r+o.maxEnd,s<t){setNodeIsVisited(o,!0);continue}if(o.left!==SENTINEL$1){o=o.left;continue}}a=r+o.start,a>i?(o.start+=l,o.end+=l,o.delta+=l,(o.delta<-1073741824||o.delta>1073741824)&&(e.requestNormalizeDelta=!0),setNodeIsVisited(o,!0)):(setNodeIsVisited(o,!0),o.right===SENTINEL$1||getNodeIsVisited(o.right)||(r+=o.delta,o=o.right))}setNodeIsVisited(e.root,!1)}function collectNodesFromOwner(e,t){let i=e.root;const n=[];let o=0;for(;i!==SENTINEL$1;)getNodeIsVisited(i)?(setNodeIsVisited(i.left,!1),setNodeIsVisited(i.right,!1),i=i.parent):i.left===SENTINEL$1||getNodeIsVisited(i.left)?(i.ownerId===t&&(n[o++]=i),setNodeIsVisited(i,!0),i.right===SENTINEL$1||getNodeIsVisited(i.right)||(i=i.right)):i=i.left;return setNodeIsVisited(e.root,!1),n}function collectNodesPostOrder(e){let t=e.root;const i=[];let n=0;for(;t!==SENTINEL$1;)getNodeIsVisited(t)?(setNodeIsVisited(t.left,!1),setNodeIsVisited(t.right,!1),t=t.parent):t.left===SENTINEL$1||getNodeIsVisited(t.left)?t.right===SENTINEL$1||getNodeIsVisited(t.right)?(i[n++]=t,setNodeIsVisited(t,!0)):t=t.right:t=t.left;return setNodeIsVisited(e.root,!1),i}function search(e,t,i,n){let o=e.root,r=0,s=0,a=0;const l=[];let d=0;for(;o!==SENTINEL$1;){if(getNodeIsVisited(o)){setNodeIsVisited(o.left,!1),setNodeIsVisited(o.right,!1),o===o.parent.right&&(r-=o.parent.delta),o=o.parent;continue}if(o.left!==SENTINEL$1&&!getNodeIsVisited(o.left)){o=o.left;continue}s=r+o.start,a=r+o.end,o.setCachedOffsets(s,a,n);let e=!0;t&&o.ownerId&&o.ownerId!==t&&(e=!1),i&&getNodeIsForValidation(o)&&(e=!1),e&&(l[d++]=o),setNodeIsVisited(o,!0),o.right===SENTINEL$1||getNodeIsVisited(o.right)||(r+=o.delta,o=o.right)}return setNodeIsVisited(e.root,!1),l}function intervalSearch(e,t,i,n,o,r){let s=e.root,a=0,l=0,d=0,c=0;const h=[];let u=0;for(;s!==SENTINEL$1;)if(getNodeIsVisited(s))setNodeIsVisited(s.left,!1),setNodeIsVisited(s.right,!1),s===s.parent.right&&(a-=s.parent.delta),s=s.parent;else{if(!getNodeIsVisited(s.left)){if(l=a+s.maxEnd,l<t){setNodeIsVisited(s,!0);continue}if(s.left!==SENTINEL$1){s=s.left;continue}}if(d=a+s.start,d>i)setNodeIsVisited(s,!0);else{if(c=a+s.end,c>=t){s.setCachedOffsets(d,c,r);let e=!0;n&&s.ownerId&&s.ownerId!==n&&(e=!1),o&&getNodeIsForValidation(s)&&(e=!1),e&&(h[u++]=s)}setNodeIsVisited(s,!0),s.right===SENTINEL$1||getNodeIsVisited(s.right)||(a+=s.delta,s=s.right)}}return setNodeIsVisited(e.root,!1),h}function rbTreeInsert(e,t){if(e.root===SENTINEL$1)return t.parent=SENTINEL$1,t.left=SENTINEL$1,t.right=SENTINEL$1,setNodeColor(t,0),e.root=t,e.root;treeInsert(e,t),recomputeMaxEndWalkToRoot(t.parent);let i=t;for(;i!==e.root&&1===getNodeColor(i.parent);)if(i.parent===i.parent.parent.left){const t=i.parent.parent.right;1===getNodeColor(t)?(setNodeColor(i.parent,0),setNodeColor(t,0),setNodeColor(i.parent.parent,1),i=i.parent.parent):(i===i.parent.right&&(i=i.parent,leftRotate$2(e,i)),setNodeColor(i.parent,0),setNodeColor(i.parent.parent,1),rightRotate$1(e,i.parent.parent))}else{const t=i.parent.parent.left;1===getNodeColor(t)?(setNodeColor(i.parent,0),setNodeColor(t,0),setNodeColor(i.parent.parent,1),i=i.parent.parent):(i===i.parent.left&&(i=i.parent,rightRotate$1(e,i)),setNodeColor(i.parent,0),setNodeColor(i.parent.parent,1),leftRotate$2(e,i.parent.parent))}return setNodeColor(e.root,0),t}function treeInsert(e,t){let i=0,n=e.root;const o=t.start,r=t.end;for(;;){if(intervalCompare(o,r,n.start+i,n.end+i)<0){if(n.left===SENTINEL$1){t.start-=i,t.end-=i,t.maxEnd-=i,n.left=t;break}n=n.left}else{if(n.right===SENTINEL$1){t.start-=i+n.delta,t.end-=i+n.delta,t.maxEnd-=i+n.delta,n.right=t;break}i+=n.delta,n=n.right}}t.parent=n,t.left=SENTINEL$1,t.right=SENTINEL$1,setNodeColor(t,1)}function rbTreeDelete(e,t){let i,n;if(t.left===SENTINEL$1?(i=t.right,n=t,i.delta+=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta):t.right===SENTINEL$1?(i=t.left,n=t):(n=leftest$1(t.right),i=n.right,i.start+=n.delta,i.end+=n.delta,i.delta+=n.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta,n.delta=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0)),n===e.root)return e.root=i,setNodeColor(i,0),t.detach(),resetSentinel$1(),recomputeMaxEnd(i),void(e.root.parent=SENTINEL$1);const o=1===getNodeColor(n);if(n===n.parent.left?n.parent.left=i:n.parent.right=i,n===t?i.parent=n.parent:(n.parent===t?i.parent=n:i.parent=n.parent,n.left=t.left,n.right=t.right,n.parent=t.parent,setNodeColor(n,getNodeColor(t)),t===e.root?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left!==SENTINEL$1&&(n.left.parent=n),n.right!==SENTINEL$1&&(n.right.parent=n)),t.detach(),o)return recomputeMaxEndWalkToRoot(i.parent),n!==t&&(recomputeMaxEndWalkToRoot(n),recomputeMaxEndWalkToRoot(n.parent)),void resetSentinel$1();let r;for(recomputeMaxEndWalkToRoot(i),recomputeMaxEndWalkToRoot(i.parent),n!==t&&(recomputeMaxEndWalkToRoot(n),recomputeMaxEndWalkToRoot(n.parent));i!==e.root&&0===getNodeColor(i);)i===i.parent.left?(r=i.parent.right,1===getNodeColor(r)&&(setNodeColor(r,0),setNodeColor(i.parent,1),leftRotate$2(e,i.parent),r=i.parent.right),0===getNodeColor(r.left)&&0===getNodeColor(r.right)?(setNodeColor(r,1),i=i.parent):(0===getNodeColor(r.right)&&(setNodeColor(r.left,0),setNodeColor(r,1),rightRotate$1(e,r),r=i.parent.right),setNodeColor(r,getNodeColor(i.parent)),setNodeColor(i.parent,0),setNodeColor(r.right,0),leftRotate$2(e,i.parent),i=e.root)):(r=i.parent.left,1===getNodeColor(r)&&(setNodeColor(r,0),setNodeColor(i.parent,1),rightRotate$1(e,i.parent),r=i.parent.left),0===getNodeColor(r.left)&&0===getNodeColor(r.right)?(setNodeColor(r,1),i=i.parent):(0===getNodeColor(r.left)&&(setNodeColor(r.right,0),setNodeColor(r,1),leftRotate$2(e,r),r=i.parent.left),setNodeColor(r,getNodeColor(i.parent)),setNodeColor(i.parent,0),setNodeColor(r.left,0),rightRotate$1(e,i.parent),i=e.root));setNodeColor(i,0),resetSentinel$1()}function leftest$1(e){for(;e.left!==SENTINEL$1;)e=e.left;return e}function resetSentinel$1(){SENTINEL$1.parent=SENTINEL$1,SENTINEL$1.delta=0,SENTINEL$1.start=0,SENTINEL$1.end=0}function leftRotate$2(e,t){const i=t.right;i.delta+=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,t.right=i.left,i.left!==SENTINEL$1&&(i.left.parent=t),i.parent=t.parent,t.parent===SENTINEL$1?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i,recomputeMaxEnd(t),recomputeMaxEnd(i)}function rightRotate$1(e,t){const i=t.left;t.delta-=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(e.requestNormalizeDelta=!0),t.start-=i.delta,t.end-=i.delta,t.left=i.right,i.right!==SENTINEL$1&&(i.right.parent=t),i.parent=t.parent,t.parent===SENTINEL$1?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i,recomputeMaxEnd(t),recomputeMaxEnd(i)}function computeMaxEnd(e){let t=e.end;if(e.left!==SENTINEL$1){const i=e.left.maxEnd;i>t&&(t=i)}if(e.right!==SENTINEL$1){const i=e.right.maxEnd+e.delta;i>t&&(t=i)}return t}function recomputeMaxEnd(e){e.maxEnd=computeMaxEnd(e)}function recomputeMaxEndWalkToRoot(e){for(;e!==SENTINEL$1;){const t=computeMaxEnd(e);if(e.maxEnd===t)return;e.maxEnd=t,e=e.parent}}function intervalCompare(e,t,i,n){return e===i?t-n:e-i}class TreeNode{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==SENTINEL)return leftest(this.right);let e=this;for(;e.parent!==SENTINEL&&e.parent.left!==e;)e=e.parent;return e.parent===SENTINEL?SENTINEL:e.parent}prev(){if(this.left!==SENTINEL)return righttest(this.left);let e=this;for(;e.parent!==SENTINEL&&e.parent.right!==e;)e=e.parent;return e.parent===SENTINEL?SENTINEL:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const SENTINEL=new TreeNode(null,0);function leftest(e){for(;e.left!==SENTINEL;)e=e.left;return e}function righttest(e){for(;e.right!==SENTINEL;)e=e.right;return e}function calculateSize(e){return e===SENTINEL?0:e.size_left+e.piece.length+calculateSize(e.right)}function calculateLF(e){return e===SENTINEL?0:e.lf_left+e.piece.lineFeedCnt+calculateLF(e.right)}function resetSentinel(){SENTINEL.parent=SENTINEL}function leftRotate$1(e,t){const i=t.right;i.size_left+=t.size_left+(t.piece?t.piece.length:0),i.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=i.left,i.left!==SENTINEL&&(i.left.parent=t),i.parent=t.parent,t.parent===SENTINEL?e.root=i:t.parent.left===t?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i}function rightRotate(e,t){const i=t.left;t.left=i.right,i.right!==SENTINEL&&(i.right.parent=t),i.parent=t.parent,t.size_left-=i.size_left+(i.piece?i.piece.length:0),t.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),t.parent===SENTINEL?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i}function rbDelete(e,t){let i,n;if(t.left===SENTINEL?(n=t,i=n.right):t.right===SENTINEL?(n=t,i=n.left):(n=leftest(t.right),i=n.right),n===e.root)return e.root=i,i.color=0,t.detach(),resetSentinel(),void(e.root.parent=SENTINEL);const o=1===n.color;if(n===n.parent.left?n.parent.left=i:n.parent.right=i,n===t?(i.parent=n.parent,recomputeTreeMetadata(e,i)):(n.parent===t?i.parent=n:i.parent=n.parent,recomputeTreeMetadata(e,i),n.left=t.left,n.right=t.right,n.parent=t.parent,n.color=t.color,t===e.root?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left!==SENTINEL&&(n.left.parent=n),n.right!==SENTINEL&&(n.right.parent=n),n.size_left=t.size_left,n.lf_left=t.lf_left,recomputeTreeMetadata(e,n)),t.detach(),i.parent.left===i){const t=calculateSize(i),n=calculateLF(i);if(t!==i.parent.size_left||n!==i.parent.lf_left){const o=t-i.parent.size_left,r=n-i.parent.lf_left;i.parent.size_left=t,i.parent.lf_left=n,updateTreeMetadata(e,i.parent,o,r)}}if(recomputeTreeMetadata(e,i.parent),o)return void resetSentinel();let r;for(;i!==e.root&&0===i.color;)i===i.parent.left?(r=i.parent.right,1===r.color&&(r.color=0,i.parent.color=1,leftRotate$1(e,i.parent),r=i.parent.right),0===r.left.color&&0===r.right.color?(r.color=1,i=i.parent):(0===r.right.color&&(r.left.color=0,r.color=1,rightRotate(e,r),r=i.parent.right),r.color=i.parent.color,i.parent.color=0,r.right.color=0,leftRotate$1(e,i.parent),i=e.root)):(r=i.parent.left,1===r.color&&(r.color=0,i.parent.color=1,rightRotate(e,i.parent),r=i.parent.left),0===r.left.color&&0===r.right.color?(r.color=1,i=i.parent):(0===r.left.color&&(r.right.color=0,r.color=1,leftRotate$1(e,r),r=i.parent.left),r.color=i.parent.color,i.parent.color=0,r.left.color=0,rightRotate(e,i.parent),i=e.root));i.color=0,resetSentinel()}function fixInsert(e,t){for(recomputeTreeMetadata(e,t);t!==e.root&&1===t.parent.color;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;1===i.color?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&leftRotate$1(e,t=t.parent),t.parent.color=0,t.parent.parent.color=1,rightRotate(e,t.parent.parent))}else{const i=t.parent.parent.left;1===i.color?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&rightRotate(e,t=t.parent),t.parent.color=0,t.parent.parent.color=1,leftRotate$1(e,t.parent.parent))}e.root.color=0}function updateTreeMetadata(e,t,i,n){for(;t!==e.root&&t!==SENTINEL;)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=n),t=t.parent}function recomputeTreeMetadata(e,t){let i=0,n=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(i=calculateSize((t=t.parent).left)-t.size_left,n=calculateLF(t.left)-t.lf_left,t.size_left+=i,t.lf_left+=n;t!==e.root&&(0!==i||0!==n);)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=n),t=t.parent}}SENTINEL.parent=SENTINEL,SENTINEL.left=SENTINEL,SENTINEL.right=SENTINEL,SENTINEL.color=0;const LIMIT_FIND_COUNT$1=999;class SearchParams{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(""===this.searchString)return null;let e;e=this.isRegex?isMultilineRegexSource(this.searchString):this.searchString.indexOf("\n")>=0;let t=null;try{t=createRegExp(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch(n){return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new SearchData(t,this.wordSeparators?getMapForWordSeparators(this.wordSeparators):null,i?this.searchString:null)}}function isMultilineRegexSource(e){if(!e||0===e.length)return!1;for(let t=0,i=e.length;t<i;t++){if(92===e.charCodeAt(t)){if(t++,t>=i)break;const n=e.charCodeAt(t);if(110===n||114===n||87===n)return!0}}return!1}function createFindMatch(e,t,i){if(!i)return new FindMatch(e,null);const n=[];for(let o=0,r=t.length;o<r;o++)n[o]=t[o];return new FindMatch(e,n)}class LineFeedCounter{constructor(e){const t=[];let i=0;for(let n=0,o=e.length;n<o;n++)10===e.charCodeAt(n)&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(-1===n)return 0;if(e<=t[0])return 0;for(;i<n;){const o=i+((n-i)/2>>0);t[o]>=e?n=o-1:t[o+1]>=e?(i=o,n=o):i=o+1}return i+1}}class TextModelSearch{static findMatches(e,t,i,n,o){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new Searcher(r.wordSeparators,r.regex),n,o):this._doFindMatchesLineByLine(e,i,r,n,o):[]}static _getMultilineMatchRange(e,t,i,n,o,r){let s,a,l=0;if(n?(l=n.findLineFeedCountBeforeOffset(o),s=t+o+l):s=t+o,n){const e=n.findLineFeedCountBeforeOffset(o+r.length)-l;a=s+r.length+e}else a=s+r.length;const d=e.getPositionAt(s),c=e.getPositionAt(a);return new Range$2(d.lineNumber,d.column,c.lineNumber,c.column)}static _doFindMatchesMultiline(e,t,i,n,o){const r=e.getOffsetAt(t.getStartPosition()),s=e.getValueInRange(t,1),a="\r\n"===e.getEOL()?new LineFeedCounter(s):null,l=[];let d,c=0;for(i.reset(0);d=i.next(s);)if(l[c++]=createFindMatch(this._getMultilineMatchRange(e,r,s,a,d.index,d[0]),d,n),c>=o)return l;return l}static _doFindMatchesLineByLine(e,t,i,n,o){const r=[];let s=0;if(t.startLineNumber===t.endLineNumber){const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return s=this._findMatchesInLine(i,a,t.startLineNumber,t.startColumn-1,s,r,n,o),r}const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);s=this._findMatchesInLine(i,a,t.startLineNumber,t.startColumn-1,s,r,n,o);for(let l=t.startLineNumber+1;l<t.endLineNumber&&s<o;l++)s=this._findMatchesInLine(i,e.getLineContent(l),l,0,s,r,n,o);if(s<o){const a=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);s=this._findMatchesInLine(i,a,t.endLineNumber,0,s,r,n,o)}return r}static _findMatchesInLine(e,t,i,n,o,r,s,a){const l=e.wordSeparators;if(!s&&e.simpleSearch){const s=e.simpleSearch,d=s.length,c=t.length;let h=-d;for(;-1!==(h=t.indexOf(s,h+d));)if((!l||isValidMatch(l,t,c,h,d))&&(r[o++]=new FindMatch(new Range$2(i,h+1+n,i,h+1+d+n),null),o>=a))return o;return o}const d=new Searcher(e.wordSeparators,e.regex);let c;d.reset(0);do{if(c=d.next(t),c&&(r[o++]=createFindMatch(new Range$2(i,c.index+1+n,i,c.index+1+c[0].length+n),c,s),o>=a))return o}while(c);return o}static findNextMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new Searcher(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindNextMatchMultiline(e,i,r,n):this._doFindNextMatchLineByLine(e,i,r,n)}static _doFindNextMatchMultiline(e,t,i,n){const o=new Position$1(t.lineNumber,1),r=e.getOffsetAt(o),s=e.getLineCount(),a=e.getValueInRange(new Range$2(o.lineNumber,o.column,s,e.getLineMaxColumn(s)),1),l="\r\n"===e.getEOL()?new LineFeedCounter(a):null;i.reset(t.column-1);let d=i.next(a);return d?createFindMatch(this._getMultilineMatchRange(e,r,a,l,d.index,d[0]),d,n):1!==t.lineNumber||1!==t.column?this._doFindNextMatchMultiline(e,new Position$1(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,s=e.getLineContent(r),a=this._findFirstMatchInLine(i,s,r,t.column,n);if(a)return a;for(let l=1;l<=o;l++){const t=(r+l-1)%o,s=e.getLineContent(t+1),a=this._findFirstMatchInLine(i,s,t+1,1,n);if(a)return a}return null}static _findFirstMatchInLine(e,t,i,n,o){e.reset(n-1);const r=e.next(t);return r?createFindMatch(new Range$2(i,r.index+1,i,r.index+1+r[0].length),r,o):null}static findPreviousMatch(e,t,i,n){const o=t.parseSearchRequest();if(!o)return null;const r=new Searcher(o.wordSeparators,o.regex);return o.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,n):this._doFindPreviousMatchLineByLine(e,i,r,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const o=this._doFindMatchesMultiline(e,new Range$2(1,1,t.lineNumber,t.column),i,n,10*LIMIT_FIND_COUNT$1);if(o.length>0)return o[o.length-1];const r=e.getLineCount();return t.lineNumber!==r||t.column!==e.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(e,new Position$1(r,e.getLineMaxColumn(r)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const o=e.getLineCount(),r=t.lineNumber,s=e.getLineContent(r).substring(0,t.column-1),a=this._findLastMatchInLine(i,s,r,n);if(a)return a;for(let l=1;l<=o;l++){const t=(o+r-l-1)%o,s=e.getLineContent(t+1),a=this._findLastMatchInLine(i,s,t+1,n);if(a)return a}return null}static _findLastMatchInLine(e,t,i,n){let o,r=null;for(e.reset(0);o=e.next(t);)r=createFindMatch(new Range$2(i,o.index+1,i,o.index+1+o[0].length),o,n);return r}}function leftIsWordBounday(e,t,i,n,o){if(0===n)return!0;const r=t.charCodeAt(n-1);if(0!==e.get(r))return!0;if(13===r||10===r)return!0;if(o>0){const i=t.charCodeAt(n);if(0!==e.get(i))return!0}return!1}function rightIsWordBounday(e,t,i,n,o){if(n+o===i)return!0;const r=t.charCodeAt(n+o);if(0!==e.get(r))return!0;if(13===r||10===r)return!0;if(o>0){const i=t.charCodeAt(n+o-1);if(0!==e.get(i))return!0}return!1}function isValidMatch(e,t,i,n,o){return leftIsWordBounday(e,t,i,n,o)&&rightIsWordBounday(e,t,i,n,o)}class Searcher{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t)return null;if(i=this._searchRegex.exec(e),!i)return null;const n=i.index,o=i[0].length;if(n===this._prevMatchStartIndex&&o===this._prevMatchLength){if(0===o){getNextCodePoint(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=o,!this._wordSeparators||isValidMatch(this._wordSeparators,e,t,n,o))return i}while(i);return null}}const AverageBufferSize=65535;function createUintArray(e){let t;return t=e[e.length-1]<65536?new Uint16Array(e.length):new Uint32Array(e.length),t.set(e,0),t}class LineStarts{constructor(e,t,i,n,o){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=o}}function createLineStartsFast(e,t=!0){const i=[0];let n=1;for(let o=0,r=e.length;o<r;o++){const t=e.charCodeAt(o);13===t?o+1<r&&10===e.charCodeAt(o+1)?(i[n++]=o+2,o++):i[n++]=o+1:10===t&&(i[n++]=o+1)}return t?createUintArray(i):i}function createLineStarts(e,t){e.length=0,e[0]=0;let i=1,n=0,o=0,r=0,s=!0;for(let l=0,d=t.length;l<d;l++){const a=t.charCodeAt(l);13===a?l+1<d&&10===t.charCodeAt(l+1)?(r++,e[i++]=l+2,l++):(n++,e[i++]=l+1):10===a?(o++,e[i++]=l+1):s&&9!==a&&(a<32||a>126)&&(s=!1)}const a=new LineStarts(createUintArray(e),n,o,r,s);return e.length=0,a}class Piece{constructor(e,t,i,n,o){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=o}}class StringBuffer{constructor(e,t){this.buffer=e,this.lineStarts=t}}class PieceTreeSnapshot{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==SENTINEL&&e.iterate(e.root,(e=>(e!==SENTINEL&&this._pieces.push(e.piece),!0)))}read(){return 0===this._pieces.length?0===this._index?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:0===this._index?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class PieceTreeSearchCache{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const o=i[n];(null===o.node.parent||o.nodeStartOffset>=e)&&(i[n]=null,t=!0)}if(t){const e=[];for(const t of i)null!==t&&e.push(t);this._cache=e}}}class PieceTreeBase{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new StringBuffer("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=SENTINEL,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let o=0,r=e.length;o<r;o++)if(e[o].buffer.length>0){e[o].lineStarts||(e[o].lineStarts=createLineStartsFast(e[o].buffer));const t=new Piece(o+1,{line:0,column:0},{line:e[o].lineStarts.length-1,column:e[o].buffer.length-e[o].lineStarts[e[o].lineStarts.length-1]},e[o].lineStarts.length-1,e[o].buffer.length);this._buffers.push(e[o]),n=this.rbInsertRight(n,t)}this._searchCache=new PieceTreeSearchCache(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=AverageBufferSize,i=t-Math.floor(t/3),n=2*i;let o="",r=0;const s=[];if(this.iterate(this.root,(t=>{const a=this.getNodeContent(t),l=a.length;if(r<=i||r+l<n)return o+=a,r+=l,!0;const d=o.replace(/\r\n|\r|\n/g,e);return s.push(new StringBuffer(d,createLineStartsFast(d))),o=a,r=l,!0})),r>0){const t=o.replace(/\r\n|\r|\n/g,e);s.push(new StringBuffer(t,createLineStartsFast(t)))}this.create(s,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new PieceTreeSnapshot(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==SENTINEL;)if(n.left!==SENTINEL&&n.lf_left+1>=e)n=n.left;else{if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;return i+(this.getAccumulatedValue(n,e-n.lf_left-2)+t-1)}e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right}return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==SENTINEL;)if(0!==t.size_left&&t.size_left>=e)t=t.left;else{if(t.size_left+t.piece.length>=e){const o=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+o.index,0===o.index){const e=this.getOffsetAt(i+1,1);return new Position$1(i+1,n-e+1)}return new Position$1(i+1,o.remainder+1)}if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===SENTINEL){const t=this.getOffsetAt(i+1,1);return new Position$1(i+1,n-e-t+1)}t=t.right}return new Position$1(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),o=this.getValueInRange2(i,n);return t?t===this._EOL&&this._EOLNormalized&&t===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,t):o}getValueInRange2(e,t){if(e.node===t.node){const i=e.node,n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.substring(o+e.remainder,o+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,o=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let r=n.substring(o+e.remainder,o+i.piece.length);for(i=i.next();i!==SENTINEL;){const e=this._buffers[i.piece.bufferIndex].buffer,n=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){r+=e.substring(n,n+t.remainder);break}r+=e.substr(n,i.piece.length),i=i.next()}return r}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,(o=>{if(o===SENTINEL)return!0;const r=o.piece;let s=r.length;if(0===s)return!0;const a=this._buffers[r.bufferIndex].buffer,l=this._buffers[r.bufferIndex].lineStarts,d=r.start.line,c=r.end.line;let h=l[d]+r.start.column;if(n&&(10===a.charCodeAt(h)&&(h++,s--),e[t++]=i,i="",n=!1,0===s))return!0;if(d===c)return this._EOLNormalized||13!==a.charCodeAt(h+s-1)?i+=a.substr(h,s):(n=!0,i+=a.substr(h,s-1)),!0;i+=this._EOLNormalized?a.substring(h,Math.max(h,l[d+1]-this._EOLLength)):a.substring(h,l[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let n=d+1;n<c;n++)i=this._EOLNormalized?a.substring(l[n],l[n+1]-this._EOLLength):a.substring(l[n],l[n+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return this._EOLNormalized||13!==a.charCodeAt(l[c]+r.end.column-1)?i=a.substr(l[c],r.end.column):(n=!0,0===r.end.column?t--:i=a.substr(l[c],r.end.column-1)),!0})),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e||(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}{const t=this._buffers[e.node.piece.bufferIndex],i=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,n,o,r,s,a,l,d,c){const h=this._buffers[e.piece.bufferIndex],u=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),g=this.offsetInBuffer(e.piece.bufferIndex,o),p=this.offsetInBuffer(e.piece.bufferIndex,r);let m;const f={line:0,column:0};let _,C;t._wordSeparators?(_=h.buffer.substring(g,p),C=e=>e+g,t.reset(0)):(_=h.buffer,C=e=>e,t.reset(g));do{if(m=t.next(_),m){if(C(m.index)>=p)return d;this.positionInBuffer(e,C(m.index)-u,f);const t=this.getLineFeedCnt(e.piece.bufferIndex,o,f),r=f.line===o.line?f.column-o.column+n:f.column+1,s=r+m[0].length;if(c[d++]=createFindMatch(new Range$2(i+t,r,i+t,s),m,a),C(m.index)+m[0].length>=p)return d;if(d>=l)return d}}while(m);return d}findMatchesLineByLine(e,t,i,n){const o=[];let r=0;const s=new Searcher(t.wordSeparators,t.regex);let a=this.nodeAt2(e.startLineNumber,e.startColumn);if(null===a)return[];const l=this.nodeAt2(e.endLineNumber,e.endColumn);if(null===l)return[];let d=this.positionInBuffer(a.node,a.remainder);const c=this.positionInBuffer(l.node,l.remainder);if(a.node===l.node)return this.findMatchesInNode(a.node,s,e.startLineNumber,e.startColumn,d,c,t,i,n,r,o),o;let h=e.startLineNumber,u=a.node;for(;u!==l.node;){const l=this.getLineFeedCnt(u.piece.bufferIndex,d,u.piece.end);if(l>=1){const a=this._buffers[u.piece.bufferIndex].lineStarts,c=this.offsetInBuffer(u.piece.bufferIndex,u.piece.start),g=a[d.line+l],p=h===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(u,s,h,p,d,this.positionInBuffer(u,g-c),t,i,n,r,o),r>=n)return o;h+=l}const c=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const a=this.getLineContent(h).substring(c,e.endColumn-1);return r=this._findMatchesInLine(t,s,a,e.endLineNumber,c,r,o,i,n),o}if(r=this._findMatchesInLine(t,s,this.getLineContent(h).substr(c),h,c,r,o,i,n),r>=n)return o;h++,a=this.nodeAt2(h,1),u=a.node,d=this.positionInBuffer(a.node,a.remainder)}if(h===e.endLineNumber){const a=h===e.startLineNumber?e.startColumn-1:0,l=this.getLineContent(h).substring(a,e.endColumn-1);return r=this._findMatchesInLine(t,s,l,e.endLineNumber,a,r,o,i,n),o}const g=h===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(l.node,s,h,g,d,c,t,i,n,r,o),o}_findMatchesInLine(e,t,i,n,o,r,s,a,l){const d=e.wordSeparators;if(!a&&e.simpleSearch){const t=e.simpleSearch,a=t.length,c=i.length;let h=-a;for(;-1!==(h=i.indexOf(t,h+a));)if((!d||isValidMatch(d,i,c,h,a))&&(s[r++]=new FindMatch(new Range$2(n,h+1+o,n,h+1+a+o),null),r>=l))return r;return r}let c;t.reset(0);do{if(c=t.next(i),c&&(s[r++]=createFindMatch(new Range$2(n,c.index+1+o,n,c.index+1+c[0].length+o),c,a),r>=l))return r}while(c);return r}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==SENTINEL){const{node:i,remainder:n,nodeStartOffset:o}=this.nodeAt(e),r=i.piece,s=r.bufferIndex,a=this.positionInBuffer(i,n);if(0===i.piece.bufferIndex&&r.end.line===this._lastChangeBufferPos.line&&r.end.column===this._lastChangeBufferPos.column&&o+r.length===e&&t.length<AverageBufferSize)return this.appendToNode(i,t),void this.computeBufferMetadata();if(o===e)this.insertContentToNodeLeft(t,i),this._searchCache.validate(e);else if(o+i.piece.length>e){const e=[];let o=new Piece(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),this.offsetInBuffer(s,r.end)-this.offsetInBuffer(s,a));if(this.shouldCheckCRLF()&&this.endWithCR(t)){if(10===this.nodeCharCodeAt(i,n)){const e={line:o.start.line+1,column:0};o=new Piece(o.bufferIndex,e,o.end,this.getLineFeedCnt(o.bufferIndex,e,o.end),o.length-1),t+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){if(13===this.nodeCharCodeAt(i,n-1)){const o=this.positionInBuffer(i,n-1);this.deleteNodeTail(i,o),t="\r"+t,0===i.piece.length&&e.push(i)}else this.deleteNodeTail(i,a)}else this.deleteNodeTail(i,a);const l=this.createNewPieces(t);o.length>0&&this.rbInsertRight(i,o);let d=i;for(let t=0;t<l.length;t++)d=this.rbInsertRight(d,l[t]);this.deleteNodes(e)}else this.insertContentToNodeRight(t,i)}else{const e=this.createNewPieces(t);let i=this.rbInsertLeft(null,e[0]);for(let t=1;t<e.length;t++)i=this.rbInsertRight(i,e[t])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===SENTINEL)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),o=i.node,r=n.node;if(o===r){const r=this.positionInBuffer(o,i.remainder),s=this.positionInBuffer(o,n.remainder);if(i.nodeStartOffset===e){if(t===o.piece.length){const e=o.next();return rbDelete(this,o),this.validateCRLFWithPrevNode(e),void this.computeBufferMetadata()}return this.deleteNodeHead(o,s),this._searchCache.validate(e),this.validateCRLFWithPrevNode(o),void this.computeBufferMetadata()}return i.nodeStartOffset+o.piece.length===e+t?(this.deleteNodeTail(o,r),this.validateCRLFWithNextNode(o),void this.computeBufferMetadata()):(this.shrinkNode(o,r,s),void this.computeBufferMetadata())}const s=[],a=this.positionInBuffer(o,i.remainder);this.deleteNodeTail(o,a),this._searchCache.validate(e),0===o.piece.length&&s.push(o);const l=this.positionInBuffer(r,n.remainder);this.deleteNodeHead(r,l),0===r.piece.length&&s.push(r);for(let c=o.next();c!==SENTINEL&&c!==r;c=c.next())s.push(c);const d=0===o.piece.length?o.prev():o;this.deleteNodes(s),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const n=t.piece,o={line:n.start.line+1,column:0},r=new Piece(n.bufferIndex,o,n.end,this.getLineFeedCnt(n.bufferIndex,o,n.end),n.length-1);t.piece=r,e+="\n",updateTreeMetadata(this,t,-1,-1),0===t.piece.length&&i.push(t)}const n=this.createNewPieces(e);let o=this.rbInsertLeft(t,n[n.length-1]);for(let r=n.length-2;r>=0;r--)o=this.rbInsertLeft(o,n[r]);this.validateCRLFWithPrevNode(o),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+="\n");const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let o=n;for(let r=1;r<i.length;r++)o=this.rbInsertRight(o,i[r]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,o=e.piece.bufferIndex,r=this._buffers[o].lineStarts,s=r[n.start.line]+n.start.column+t;let a=n.start.line,l=n.end.line,d=0,c=0,h=0;for(;a<=l&&(d=a+(l-a)/2|0,h=r[d],d!==l);)if(c=r[d+1],s<h)l=d-1;else{if(!(s>=c))break;a=d+1}return i?(i.line=d,i.column=s-h,null):{line:d,column:s-h}}getLineFeedCnt(e,t,i){if(0===i.column)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const o=n[i.line+1],r=n[i.line]+i.column;if(o>r+1)return i.line-t.line;const s=r-1;return 13===this._buffers[e].buffer.charCodeAt(s)?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)rbDelete(this,e[t])}createNewPieces(e){if(e.length>AverageBufferSize){const t=[];for(;e.length>AverageBufferSize;){const i=e.charCodeAt(AverageBufferSize-1);let n;13===i||i>=55296&&i<=56319?(n=e.substring(0,AverageBufferSize-1),e=e.substring(AverageBufferSize-1)):(n=e.substring(0,AverageBufferSize),e=e.substring(AverageBufferSize));const o=createLineStartsFast(n);t.push(new Piece(this._buffers.length,{line:0,column:0},{line:o.length-1,column:n.length-o[o.length-1]},o.length-1,n.length)),this._buffers.push(new StringBuffer(n,o))}const i=createLineStartsFast(e);return t.push(new Piece(this._buffers.length,{line:0,column:0},{line:i.length-1,column:e.length-i[i.length-1]},i.length-1,e.length)),this._buffers.push(new StringBuffer(e,i)),t}let t=this._buffers[0].buffer.length;const i=createLineStartsFast(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&0!==t&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let e=0;e<i.length;e++)i[e]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(0!==t)for(let e=0;e<i.length;e++)i[e]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const o=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,s={line:r,column:o-this._buffers[0].lineStarts[r]},a=new Piece(0,n,s,this.getLineFeedCnt(0,n,s),o-t);return this._lastChangeBufferPos=s,[a]}getLineRawContent(e,t=0){let i=this.root,n="";const o=this._searchCache.get2(e);if(o){i=o.node;const r=this.getAccumulatedValue(i,e-o.nodeStartLineNumber-1),s=this._buffers[i.piece.bufferIndex].buffer,a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(o.nodeStartLineNumber+i.piece.lineFeedCnt!==e){const n=this.getAccumulatedValue(i,e-o.nodeStartLineNumber);return s.substring(a+r,a+n-t)}n=s.substring(a+r,a+i.piece.length)}else{let o=0;const r=e;for(;i!==SENTINEL;)if(i.left!==SENTINEL&&i.lf_left>=e-1)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt>e-1){const n=this.getAccumulatedValue(i,e-i.lf_left-2),s=this.getAccumulatedValue(i,e-i.lf_left-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:r-(e-1-i.lf_left)}),a.substring(l+n,l+s-t)}if(i.lf_left+i.piece.lineFeedCnt===e-1){const t=this.getAccumulatedValue(i,e-i.lf_left-2),o=this._buffers[i.piece.bufferIndex].buffer,r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=o.substring(r+t,r+i.piece.length);break}e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}}for(i=i.next();i!==SENTINEL;){const e=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(i,0),r=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=e.substring(r,r+o-t),n}{const t=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=e.substr(t,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==SENTINEL;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),o=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const t=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(t!==o)return{index:t,remainder:0}}return{index:o,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,o=i.start.line+t+1;return o>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[o]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.end),r=t,s=this.offsetInBuffer(i.bufferIndex,r),a=this.getLineFeedCnt(i.bufferIndex,i.start,r),l=a-n,d=s-o,c=i.length+d;e.piece=new Piece(i.bufferIndex,i.start,r,a,c),updateTreeMetadata(this,e,d,l)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,o=this.offsetInBuffer(i.bufferIndex,i.start),r=t,s=this.getLineFeedCnt(i.bufferIndex,r,i.end),a=s-n,l=o-this.offsetInBuffer(i.bufferIndex,r),d=i.length+l;e.piece=new Piece(i.bufferIndex,r,i.end,s,d),updateTreeMetadata(this,e,l,a)}shrinkNode(e,t,i){const n=e.piece,o=n.start,r=n.end,s=n.length,a=n.lineFeedCnt,l=t,d=this.getLineFeedCnt(n.bufferIndex,n.start,l),c=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,o);e.piece=new Piece(n.bufferIndex,n.start,l,d,c),updateTreeMetadata(this,e,c-s,d-a);const h=new Piece(n.bufferIndex,i,r,this.getLineFeedCnt(n.bufferIndex,i,r),this.offsetInBuffer(n.bufferIndex,r)-this.offsetInBuffer(n.bufferIndex,i)),u=this.rbInsertRight(e,h);this.validateCRLFWithPrevNode(u)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+="\n");const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const o=createLineStartsFast(t,!1);for(let h=0;h<o.length;h++)o[h]+=n;if(i){const e=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-e}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));const r=this._buffers[0].lineStarts.length-1,s={line:r,column:this._buffers[0].buffer.length-this._buffers[0].lineStarts[r]},a=e.piece.length+t.length,l=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,s),c=d-l;e.piece=new Piece(e.piece.bufferIndex,e.piece.start,s,d,a),this._lastChangeBufferPos=s,updateTreeMetadata(this,e,t.length,c)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==SENTINEL;)if(t.size_left>e)t=t.left;else{if(t.size_left+t.piece.length>=e){n+=t.size_left;const i={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(i),i}e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right}return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==SENTINEL;)if(i.left!==SENTINEL&&i.lf_left>=e-1)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt>e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2),r=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(o+t-1,r),nodeStartOffset:n}}if(i.lf_left+i.piece.lineFeedCnt===e-1){const o=this.getAccumulatedValue(i,e-i.lf_left-2);if(o+t-1<=i.piece.length)return{node:i,remainder:o+t-1,nodeStartOffset:n};t-=i.piece.length-o;break}e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==SENTINEL;){if(i.piece.lineFeedCnt>0){const e=this.getAccumulatedValue(i,0),n=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,e),nodeStartOffset:n}}if(i.piece.length>=t-1){return{node:i,remainder:t-1,nodeStartOffset:this.offsetOfNode(i)}}t-=i.piece.length,i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&"\n"===this._EOL)}startWithLF(e){if("string"==typeof e)return 10===e.charCodeAt(0);if(e===SENTINEL||0===e.piece.lineFeedCnt)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,o=i[n]+t.start.column;if(n===i.length-1)return!1;return!(i[n+1]>o+1)&&10===this._buffers[t.bufferIndex].buffer.charCodeAt(o)}endWithCR(e){return"string"==typeof e?13===e.charCodeAt(e.length-1):e!==SENTINEL&&0!==e.piece.lineFeedCnt&&13===this.nodeCharCodeAt(e,e.piece.length-1)}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let o;o=0===e.piece.end.column?{line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:{line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,s=e.piece.lineFeedCnt-1;e.piece=new Piece(e.piece.bufferIndex,e.piece.start,o,s,r),updateTreeMetadata(this,e,-1,-1),0===e.piece.length&&i.push(e);const a={line:t.piece.start.line+1,column:0},l=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,a,t.piece.end);t.piece=new Piece(t.piece.bufferIndex,a,t.piece.end,d,l),updateTreeMetadata(this,t,-1,-1),0===t.piece.length&&i.push(t);const c=this.createNewPieces("\r\n");this.rbInsertRight(e,c[0]);for(let h=0;h<i.length;h++)rbDelete(this,i[h])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+="\n",1===i.piece.length)rbDelete(this,i);else{const e=i.piece,t={line:e.start.line+1,column:0},n=e.length-1,o=this.getLineFeedCnt(e.bufferIndex,t,e.end);i.piece=new Piece(e.bufferIndex,t,e.end,o,n),updateTreeMetadata(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===SENTINEL)return t(SENTINEL);const i=this.iterate(e.left,t);return i?t(e)&&this.iterate(e.right,t):i}getNodeContent(e){if(e===SENTINEL)return"";const t=this._buffers[e.piece.bufferIndex];let i;const n=e.piece,o=this.offsetInBuffer(n.bufferIndex,n.start),r=this.offsetInBuffer(n.bufferIndex,n.end);return i=t.buffer.substring(o,r),i}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new TreeNode(t,1);i.left=SENTINEL,i.right=SENTINEL,i.parent=SENTINEL,i.size_left=0,i.lf_left=0;if(this.root===SENTINEL)this.root=i,i.color=0;else if(e.right===SENTINEL)e.right=i,i.parent=e;else{const t=leftest(e.right);t.left=i,i.parent=t}return fixInsert(this,i),i}rbInsertLeft(e,t){const i=new TreeNode(t,1);if(i.left=SENTINEL,i.right=SENTINEL,i.parent=SENTINEL,i.size_left=0,i.lf_left=0,this.root===SENTINEL)this.root=i,i.color=0;else if(e.left===SENTINEL)e.left=i,i.parent=e;else{const t=righttest(e.left);t.right=i,i.parent=t}return fixInsert(this,i),i}}function countEOL(e){let t=0,i=0,n=0,o=0;for(let r=0,s=e.length;r<s;r++){const a=e.charCodeAt(r);13===a?(0===t&&(i=r),t++,r+1<s&&10===e.charCodeAt(r+1)?(o|=2,r++):o|=3,n=r+1):10===a&&(o|=1,0===t&&(i=r),t++,n=r+1)}return 0===t&&(i=e.length),[t,i,e.length-n,o]}class PieceTreeTextBuffer extends Disposable{constructor(e,t,i,n,o,r,s){super(),this._onDidChangeContent=this._register(new Emitter$1),this._BOM=t,this._mightContainNonBasicASCII=!r,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._pieceTree=new PieceTreeBase(e,i,s)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),o=this.getPositionAt(i);return new Range$2(n.lineNumber,n.column,o.lineNumber,o.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn);return this.getOffsetAt(e.endLineNumber,e.endColumn)-i}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,o=e.endLineNumber;for(let t=n;t<=o;t++){const r=this.getLineContent(t),s=t===n?e.startColumn-1:0,a=t===o?e.endColumn-1:r.length;for(let e=s;e<a;e++)isHighSurrogate(r.charCodeAt(e))?(i+=1,e+=1):i+=1}return i+=this._getEndOfLine(t).length*(o-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=firstNonWhitespaceIndex(this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=lastNonWhitespaceIndex(this.getLineContent(e));return-1===t?0:t+2}_getEndOfLine(e){switch(e){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,o=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,s=!0,a=[];for(let p=0;p<e.length;p++){const t=e[p];s&&t._isTracked&&(s=!1);const i=t.range;if(t.text){let e=!0;r||(e=!isBasicASCII(t.text),r=e),!n&&e&&(n=containsRTL(t.text)),!o&&e&&(o=containsUnusualLineTerminators(t.text))}let l="",d=0,c=0,h=0;if(t.text){let e;[d,c,h,e]=countEOL(t.text);const i=this.getEOL(),n="\r\n"===i?2:1;l=0===e||e===n?t.text:t.text.replace(/\r\n|\r|\n/g,i)}a[p]={sortIndex:p,identifier:t.identifier||null,range:i,rangeOffset:this.getOffsetAt(i.startLineNumber,i.startColumn),rangeLength:this.getValueLengthInRange(i),text:l,eolCount:d,firstLineLength:c,lastLineLength:h,forceMoveMarkers:Boolean(t.forceMoveMarkers),isAutoWhitespaceEdit:t.isAutoWhitespaceEdit||!1}}a.sort(PieceTreeTextBuffer._sortOpsAscending);let l=!1;for(let p=0,m=a.length-1;p<m;p++){const e=a[p].range.getEndPosition(),t=a[p+1].range.getStartPosition();if(t.isBeforeOrEqual(e)){if(t.isBefore(e))throw new Error("Overlapping ranges are not allowed!");l=!0}}s&&(a=this._reduceOperations(a));const d=i||t?PieceTreeTextBuffer._getInverseEditRanges(a):[],c=[];if(t)for(let p=0;p<a.length;p++){const e=a[p],t=d[p];if(e.isAutoWhitespaceEdit&&e.range.isEmpty())for(let i=t.startLineNumber;i<=t.endLineNumber;i++){let n="";i===t.startLineNumber&&(n=this.getLineContent(e.range.startLineNumber),-1!==firstNonWhitespaceIndex(n))||c.push({lineNumber:i,oldContent:n})}}let h=null;if(i){let e=0;h=[];for(let t=0;t<a.length;t++){const i=a[t],n=d[t],o=this.getValueInRange(i.range),r=i.rangeOffset+e;e+=i.text.length-o.length,h[t]={sortIndex:i.sortIndex,identifier:i.identifier,range:n,text:o,textChange:new TextChange(i.rangeOffset,o,r,i.text)}}l||h.sort(((e,t)=>e.sortIndex-t.sortIndex))}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=o,this._mightContainNonBasicASCII=r;const u=this._doApplyEdits(a);let g=null;if(t&&c.length>0){c.sort(((e,t)=>t.lineNumber-e.lineNumber)),g=[];for(let e=0,t=c.length;e<t;e++){const t=c[e].lineNumber;if(e>0&&c[e-1].lineNumber===t)continue;const i=c[e].oldContent,n=this.getLineContent(t);0!==n.length&&n!==i&&-1===firstNonWhitespaceIndex(n)&&g.push(t)}}return this._onDidChangeContent.fire(),new ApplyEditsResult(h,u,g)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,o=new Range$2(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let r=i.startLineNumber,s=i.startColumn;const a=[];for(let u=0,g=e.length;u<g;u++){const i=e[u],n=i.range;t=t||i.forceMoveMarkers,a.push(this.getValueInRange(new Range$2(r,s,n.startLineNumber,n.startColumn))),i.text.length>0&&a.push(i.text),r=n.endLineNumber,s=n.endColumn}const l=a.join(""),[d,c,h]=countEOL(l);return{sortIndex:0,identifier:e[0].identifier,range:o,rangeOffset:this.getOffsetAt(o.startLineNumber,o.startColumn),rangeLength:this.getValueLengthInRange(o,0),text:l,eolCount:d,firstLineLength:c,lastLineLength:h,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(PieceTreeTextBuffer._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],o=n.range.startLineNumber,r=n.range.startColumn,s=n.range.endLineNumber,a=n.range.endColumn;if(o===s&&r===a&&0===n.text.length)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const l=new Range$2(o,r,s,a);t.push({range:l,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,o=null;for(let r=0,s=e.length;r<s;r++){const s=e[r];let a,l,d;if(o?o.range.endLineNumber===s.range.startLineNumber?(a=i,l=n+(s.range.startColumn-o.range.endColumn)):(a=i+(s.range.startLineNumber-o.range.endLineNumber),l=s.range.startColumn):(a=s.range.startLineNumber,l=s.range.startColumn),s.text.length>0){const e=s.eolCount+1;d=1===e?new Range$2(a,l,a,l+s.firstLineLength):new Range$2(a,l,a+e-1,s.lastLineLength+1)}else d=new Range$2(a,l,a,l);i=d.endLineNumber,n=d.endColumn,t.push(d),o=s}return t}static _sortOpsAscending(e,t){const i=Range$2.compareRangesUsingEnds(e.range,t.range);return 0===i?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=Range$2.compareRangesUsingEnds(e.range,t.range);return 0===i?t.sortIndex-e.sortIndex:-i}}class PieceTreeTextBufferFactory{constructor(e,t,i,n,o,r,s,a,l){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=o,this._containsRTL=r,this._containsUnusualLineTerminators=s,this._isBasicASCII=a,this._normalizeEOL=l}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return 0===t?1===e?"\n":"\r\n":i>t/2?"\r\n":"\n"}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&("\r\n"===t&&(this._cr>0||this._lf>0)||"\n"===t&&(this._cr>0||this._crlf>0)))for(let o=0,r=i.length;o<r;o++){const e=i[o].buffer.replace(/\r\n|\r|\n/g,t),n=createLineStartsFast(e);i[o]=new StringBuffer(e,n)}const n=new PieceTreeTextBuffer(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class PieceTreeTextBufferBuilder{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(0===e.length)return;0===this.chunks.length&&startsWithUTF8BOM(e)&&(this.BOM=UTF8_BOM_CHARACTER,e=e.substr(1));const t=e.charCodeAt(e.length-1);13===t||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){(t||0!==e.length)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=createLineStarts(this._tmpLineStarts,e);this.chunks.push(new StringBuffer(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,this.isBasicASCII&&(this.isBasicASCII=t.isBasicASCII),this.isBasicASCII||this.containsRTL||(this.containsRTL=containsRTL(e)),this.isBasicASCII||this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=containsUnusualLineTerminators(e))}finish(e=!0){return this._finish(),new PieceTreeTextBufferFactory(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(0===this.chunks.length&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=createLineStartsFast(e.buffer);e.lineStarts=t,13===this._previousChar&&this.cr++}}}class ContiguousMultilineTokens{constructor(e,t){this._startLineNumber=e,this._tokens=t}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class ContiguousMultilineTokensBuilder{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e)return void i.appendLineTokens(t)}this._tokens.push(new ContiguousMultilineTokens(e,[t]))}finalize(){return this._tokens}}class ContiguousGrowingArray{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}delete(e,t){0===t||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(0===t||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=arrayInsert(this._store,e,i)}}class TokenizationStateStore{constructor(e,t){this.tokenizationSupport=e,this.initialState=t,this._lineBeginState=new ContiguousGrowingArray(null),this._lineNeedsTokenization=new ContiguousGrowingArray(!0),this._firstLineNeedsTokenization=0,this._lineBeginState.set(0,this.initialState)}get invalidLineStartIndex(){return this._firstLineNeedsTokenization}markMustBeTokenized(e){this._lineNeedsTokenization.set(e,!0),this._firstLineNeedsTokenization=Math.min(this._firstLineNeedsTokenization,e)}getBeginState(e){return this._lineBeginState.get(e)}setEndState(e,t,i){if(this._lineNeedsTokenization.set(t,!1),this._firstLineNeedsTokenization=t+1,t===e-1)return;const n=this._lineBeginState.get(t+1);if(null===n||!i.equals(n))return this._lineBeginState.set(t+1,i),void this.markMustBeTokenized(t+1);let o=t+1;for(;o<e&&!this._lineNeedsTokenization.get(o);)o++;this._firstLineNeedsTokenization=o}applyEdits(e,t){this.markMustBeTokenized(e.startLineNumber-1),this._lineBeginState.delete(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineNeedsTokenization.delete(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineBeginState.insert(e.startLineNumber,t),this._lineNeedsTokenization.insert(e.startLineNumber,t)}}class TextModelTokenization extends Disposable{constructor(e,t){super(),this._textModel=e,this._languageIdCodec=t,this._isScheduled=!1,this._isDisposed=!1,this._tokenizationStateStore=null,this._register(TokenizationRegistry.onDidChange((e=>{const t=this._textModel.getLanguageId();-1!==e.changedLanguages.indexOf(t)&&(this._resetTokenizationState(),this._textModel.clearTokens())}))),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}handleDidChangeContent(e){if(e.isFlush)this._resetTokenizationState();else{if(this._tokenizationStateStore)for(let t=0,i=e.changes.length;t<i;t++){const i=e.changes[t],[n]=countEOL(i.text);this._tokenizationStateStore.applyEdits(i.range,n)}this._beginBackgroundTokenization()}}handleDidChangeAttached(){this._beginBackgroundTokenization()}handleDidChangeLanguage(e){this._resetTokenizationState(),this._textModel.clearTokens()}_resetTokenizationState(){const[e,t]=initializeTokenization(this._textModel);this._tokenizationStateStore=e&&t?new TokenizationStateStore(e,t):null,this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,runWhenIdle((e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)})))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{!this._isDisposed&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?setTimeout0(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._textModel.getLineCount(),t=new ContiguousMultilineTokensBuilder,i=StopWatch.create(!1);do{if(i.elapsed()>1)break;if(this._tokenizeOneInvalidLine(t)>=e)break}while(this._hasLinesToTokenize());this._textModel.setTokens(t.finalize(),!this._hasLinesToTokenize())}tokenizeViewport(e,t){const i=new ContiguousMultilineTokensBuilder;this._tokenizeViewport(i,e,t),this._textModel.setTokens(i.finalize(),!this._hasLinesToTokenize())}reset(){this._resetTokenizationState(),this._textModel.clearTokens()}forceTokenization(e){const t=new ContiguousMultilineTokensBuilder;this._updateTokensUntilLine(t,e),this._textModel.setTokens(t.finalize(),!this._hasLinesToTokenize())}getTokenTypeIfInsertingCharacter(e,t){if(!this._tokenizationStateStore)return 0;this.forceTokenization(e.lineNumber);const i=this._tokenizationStateStore.getBeginState(e.lineNumber-1);if(!i)return 0;const n=this._textModel.getLanguageId(),o=this._textModel.getLineContent(e.lineNumber),r=o.substring(0,e.column-1)+t+o.substring(e.column-1),s=safeTokenize(this._languageIdCodec,n,this._tokenizationStateStore.tokenizationSupport,r,!0,i),a=new LineTokens(s.tokens,r,this._languageIdCodec);if(0===a.getCount())return 0;const l=a.findTokenIndexAtOffset(e.column-1);return a.getStandardTokenType(l)}tokenizeLineWithEdit(e,t,i){const n=e.lineNumber,o=e.column;if(!this._tokenizationStateStore)return null;this.forceTokenization(n);const r=this._tokenizationStateStore.getBeginState(n-1);if(!r)return null;const s=this._textModel.getLineContent(n),a=s.substring(0,o-1)+i+s.substring(o-1+t),l=this._textModel.getLanguageIdAtPosition(n,0),d=safeTokenize(this._languageIdCodec,l,this._tokenizationStateStore.tokenizationSupport,a,!0,r);return new LineTokens(d.tokens,a,this._languageIdCodec)}isCheapToTokenize(e){if(!this._tokenizationStateStore)return!0;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return!(e>t)&&(e<t||this._textModel.getLineLength(e)<2048)}_hasLinesToTokenize(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_tokenizeOneInvalidLine(e){if(!this._tokenizationStateStore||!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(e,t),t}_updateTokensUntilLine(e,t){if(!this._tokenizationStateStore)return;const i=this._textModel.getLanguageId(),n=this._textModel.getLineCount(),o=t-1;for(let r=this._tokenizationStateStore.invalidLineStartIndex;r<=o;r++){const t=this._textModel.getLineContent(r+1),o=this._tokenizationStateStore.getBeginState(r),s=safeTokenize(this._languageIdCodec,i,this._tokenizationStateStore.tokenizationSupport,t,!0,o);e.add(r+1,s.tokens),this._tokenizationStateStore.setEndState(n,r,s.endState),r=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(e,t,i){if(!this._tokenizationStateStore)return;if(i<=this._tokenizationStateStore.invalidLineStartIndex)return;if(t<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(e,i);let n=this._textModel.getLineFirstNonWhitespaceColumn(t);const o=[];let r=null;for(let l=t-1;n>1&&l>=1;l--){const e=this._textModel.getLineFirstNonWhitespaceColumn(l);if(0!==e&&e<n){if(r=this._tokenizationStateStore.getBeginState(l-1),r)break;o.push(this._textModel.getLineContent(l)),n=e}}r||(r=this._tokenizationStateStore.initialState);const s=this._textModel.getLanguageId();let a=r;for(let l=o.length-1;l>=0;l--){a=safeTokenize(this._languageIdCodec,s,this._tokenizationStateStore.tokenizationSupport,o[l],!1,a).endState}for(let l=t;l<=i;l++){const t=this._textModel.getLineContent(l),i=safeTokenize(this._languageIdCodec,s,this._tokenizationStateStore.tokenizationSupport,t,!0,a);e.add(l,i.tokens),this._tokenizationStateStore.markMustBeTokenized(l-1),a=i.endState}}}function initializeTokenization(e){if(e.isTooLargeForTokenization())return[null,null];const t=TokenizationRegistry.get(e.getLanguageId());if(!t)return[null,null];let i;try{i=t.getInitialState()}catch(e2){return onUnexpectedError(e2),[null,null]}return[t,i]}function safeTokenize(e,t,i,n,o,r){let s=null;if(i)try{s=i.tokenizeEncoded(n,o,r.clone())}catch(e2){onUnexpectedError(e2)}return s||(s=nullTokenizeEncoded(e.encodeLanguageId(t),r)),LineTokens.convertToEndOffset(s.tokens,n.length),s}const EMPTY_LINE_TOKENS=new Uint32Array(0).buffer;class ContiguousTokensEditing{static deleteBeginning(e,t){return null===e||e===EMPTY_LINE_TOKENS?e:ContiguousTokensEditing.delete(e,0,t)}static deleteEnding(e,t){if(null===e||e===EMPTY_LINE_TOKENS)return e;const i=toUint32Array(e),n=i[i.length-2];return ContiguousTokensEditing.delete(e,t,n)}static delete(e,t,i){if(null===e||e===EMPTY_LINE_TOKENS||t===i)return e;const n=toUint32Array(e),o=n.length>>>1;if(0===t&&n[n.length-2]===i)return EMPTY_LINE_TOKENS;const r=LineTokens.findIndexInTokensArray(n,t),s=r>0?n[r-1<<1]:0;if(i<n[r<<1]){const s=i-t;for(let e=r;e<o;e++)n[e<<1]-=s;return e}let a,l;s!==t?(n[r<<1]=t,a=r+1<<1,l=t):(a=r<<1,l=s);const d=i-t;for(let h=r+1;h<o;h++){const e=n[h<<1]-d;e>l&&(n[a++]=e,n[a++]=n[1+(h<<1)],l=e)}if(a===n.length)return e;const c=new Uint32Array(a);return c.set(n.subarray(0,a),0),c.buffer}static append(e,t){if(t===EMPTY_LINE_TOKENS)return e;if(e===EMPTY_LINE_TOKENS)return t;if(null===e)return e;if(null===t)return null;const i=toUint32Array(e),n=toUint32Array(t),o=n.length>>>1,r=new Uint32Array(i.length+n.length);r.set(i,0);let s=i.length;const a=i[i.length-2];for(let l=0;l<o;l++)r[s++]=n[l<<1]+a,r[s++]=n[1+(l<<1)];return r.buffer}static insert(e,t,i){if(null===e||e===EMPTY_LINE_TOKENS)return e;const n=toUint32Array(e),o=n.length>>>1;let r=LineTokens.findIndexInTokensArray(n,t);if(r>0){n[r-1<<1]===t&&r--}for(let s=r;s<o;s++)n[s<<1]+=i;return e}}function toUint32Array(e){return e instanceof Uint32Array?e:new Uint32Array(e)}class ContiguousTokensStore{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),null!==n&&n!==EMPTY_LINE_TOKENS)return new LineTokens(toUint32Array(n),i,this._languageIdCodec);const o=new Uint32Array(2);return o[0]=i.length,o[1]=getDefaultMetadata(this._languageIdCodec.encodeLanguageId(e)),new LineTokens(o,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?toUint32Array(i):null;if(0===t){let t=!1;if(n&&n.length>1&&(t=TokenMetadata.getLanguageId(n[1])!==e),!t)return EMPTY_LINE_TOKENS}if(!n||0===n.length){const i=new Uint32Array(2);return i[0]=t,i[1]=getDefaultMetadata(e),i.buffer}return n[n.length-2]=t,0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){0!==t&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(0===t)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=arrayInsert(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,o){const r=ContiguousTokensStore._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const s=this._lineTokens[t];return this._lineTokens[t]=r,!!o&&!ContiguousTokensStore._equals(s,r)}static _equals(e,t){if(!e||!t)return!e&&!t;const i=toUint32Array(e),n=toUint32Array(t);if(i.length!==n.length)return!1;for(let o=0,r=i.length;o<r;o++)if(i[o]!==n[o])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new Position$1(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;return void(this._lineTokens[t]=ContiguousTokensEditing.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1))}this._lineTokens[t]=ContiguousTokensEditing.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=ContiguousTokensEditing.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=ContiguousTokensEditing.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(0===t&&0===i)return;const n=e.lineNumber-1;n>=this._len||(0!==t?(this._lineTokens[n]=ContiguousTokensEditing.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=ContiguousTokensEditing.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)):this._lineTokens[n]=ContiguousTokensEditing.insert(this._lineTokens[n],e.column-1,i))}}function getDefaultMetadata(e){return(16384|e<<0|2<<23)>>>0}class SparseTokensStore{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return 0===this._pieces.length}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const n=t[0].getRange(),o=t[t.length-1].getRange();if(!n||!o)return e;i=e.plusRange(n).plusRange(o)}let n=null;for(let o=0,r=this._pieces.length;o<r;o++){const e=this._pieces[o];if(e.endLineNumber<i.startLineNumber)continue;if(e.startLineNumber>i.endLineNumber){n=n||{index:o};break}if(e.removeTokens(i),e.isEmpty()){this._pieces.splice(o,1),o--,r--;continue}if(e.endLineNumber<i.startLineNumber)continue;if(e.startLineNumber>i.endLineNumber){n=n||{index:o};continue}const[t,s]=e.split(i);t.isEmpty()?n=n||{index:o}:s.isEmpty()||(this._pieces.splice(o,1,t,s),o++,r++,n=n||{index:o})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=arrayInsert(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){const i=this._pieces;if(0===i.length)return t;const n=i[SparseTokensStore._findFirstPieceWithLine(i,e)].getLineTokens(e);if(!n)return t;const o=t.getCount(),r=n.getCount();let s=0;const a=[];let l=0,d=0;const c=(e,t)=>{e!==d&&(d=e,a[l++]=e,a[l++]=t)};for(let h=0;h<r;h++){const e=n.getStartCharacter(h),i=n.getEndCharacter(h),r=n.getMetadata(h),a=((1&r?1024:0)|(2&r?2048:0)|(4&r?4096:0)|(8&r?8192:0)|(16&r?8372224:0)|(32&r?4286578688:0))>>>0,l=~a>>>0;for(;s<o&&t.getEndOffset(s)<=e;)c(t.getEndOffset(s),t.getMetadata(s)),s++;for(s<o&&t.getStartOffset(s)<e&&c(e,t.getMetadata(s));s<o&&t.getEndOffset(s)<i;)c(t.getEndOffset(s),t.getMetadata(s)&l|r&a),s++;if(s<o)c(i,t.getMetadata(s)&l|r&a),t.getEndOffset(s)===i&&s++;else{const e=Math.min(Math.max(0,s-1),o-1);c(i,t.getMetadata(e)&l|r&a)}}for(;s<o;)c(t.getEndOffset(s),t.getMetadata(s)),s++;return new LineTokens(new Uint32Array(a),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let o=i+Math.floor((n-i)/2);if(e[o].endLineNumber<t)i=o+1;else{if(!(e[o].startLineNumber>t)){for(;o>i&&e[o-1].startLineNumber<=t&&t<=e[o-1].endLineNumber;)o--;return o}n=o-1}}return i}acceptEdit(e,t,i,n,o){for(const r of this._pieces)r.acceptEdit(e,t,i,n,o)}}const IUndoRedoService=createDecorator("undoRedoService");class ResourceEditStackSnapshot{constructor(e,t){this.resource=e,this.elements=t}}class UndoRedoGroup{constructor(){this.id=UndoRedoGroup._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}UndoRedoGroup._ID=0,UndoRedoGroup.None=new UndoRedoGroup;class UndoRedoSource{constructor(){this.id=UndoRedoSource._ID++,this.order=1}nextOrder(){return 0===this.id?0:this.order++}}UndoRedoSource._ID=0,UndoRedoSource.None=new UndoRedoSource;var __decorate$1w=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1r=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};function createTextBufferBuilder(){return new PieceTreeTextBufferBuilder}function createTextBufferFactory(e){const t=createTextBufferBuilder();return t.acceptChunk(e),t.finish()}function createTextBuffer(e,t){return("string"==typeof e?createTextBufferFactory(e):e).create(t)}let MODEL_ID$1=0;const LIMIT_FIND_COUNT=999,LONG_LINE_BOUNDARY=1e4;class TextModelSnapshot{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;for(;;){const n=this._source.read();if(null===n)return this._eos=!0,0===t?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=65536)return e.join("")}}}const invalidFunc=()=>{throw new Error("Invalid change accessor")};let TextModel=class e extends Disposable{constructor(t,i,n,o=null,r,s,a){super(),this._undoRedoService=r,this._languageService=s,this._languageConfigurationService=a,this._onWillDispose=this._register(new Emitter$1),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new DidChangeDecorationsEmitter((e=>this.handleBeforeFireDecorationsChangedEvent(e)))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeLanguage=this._register(new Emitter$1),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new Emitter$1),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new Emitter$1),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidChangeOptions=this._register(new Emitter$1),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new Emitter$1),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new Emitter$1),this._eventEmitter=this._register(new DidChangeContentEmitter),this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new Emitter$1),MODEL_ID$1++,this.id="$model"+MODEL_ID$1,this.isForSimpleWidget=n.isForSimpleWidget,this._associatedResource=null==o?URI.parse("inmemory://model/"+MODEL_ID$1):o,this._attachedEditorCount=0;const{textBuffer:l,disposable:d}=createTextBuffer(t,n.defaultEOL);this._buffer=l,this._bufferDisposable=d,this._options=e.resolveOptions(this._buffer,n);const c=this._buffer.getLineCount(),h=this._buffer.getValueLengthInRange(new Range$2(1,1,c,this._buffer.getLineLength(c)+1),0);n.largeFileOptimizations?this._isTooLargeForTokenization=h>e.LARGE_FILE_SIZE_THRESHOLD||c>e.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=h>e.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this._isDisposing=!1,this._languageId=i,this._languageRegistryListener=this._languageConfigurationService.onDidChange((e=>{e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._instanceId=singleLetterHash(MODEL_ID$1),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager=new EditStack(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._tokens=new ContiguousTokensStore(this._languageService.languageIdCodec),this._semanticTokens=new SparseTokensStore(this._languageService.languageIdCodec),this._tokenization=new TextModelTokenization(this,this._languageService.languageIdCodec),this._bracketPairColorizer=this._register(new BracketPairsTextModelPart(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new GuidesTextModelPart(this,this._languageConfigurationService)),this._decorationProvider=this._register(new ColorizedBracketPairsDecorationProvider(this)),this._register(this._decorationProvider.onDidChange((()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})))}static resolveOptions(e,t){if(t.detectIndentation){const i=guessIndentation(e,t.tabSize,t.insertSpaces);return new TextModelResolvedOptions({tabSize:i.tabSize,indentSize:i.tabSize,insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new TextModelResolvedOptions({tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}onDidChangeContent(e){return this._eventEmitter.slowEvent((t=>e(t.contentChangedEvent)))}onDidChangeContentOrInjectedText(e){return combinedDisposable(this._eventEmitter.fastEvent((t=>e(t.rawContentChangedEvent))),this._onDidChangeInjectedText.event((t=>e(t))))}get bracketPairs(){return this._bracketPairColorizer}get guides(){return this._guidesTextModelPart}get backgroundTokenizationState(){return this._backgroundTokenizationState}handleTokenizationProgress(e){if(2===this._backgroundTokenizationState)return;const t=e?2:1;this._backgroundTokenizationState!==t&&(this._backgroundTokenizationState=t,this._bracketPairColorizer.handleDidChangeBackgroundTokenizationState(),this._onBackgroundTokenizationStateChanged.fire())}dispose(){this._isDisposing=!0,this._onWillDispose.fire(),this._languageRegistryListener.dispose(),this._tokenization.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this._isDisposing=!1;const e=new PieceTreeTextBuffer([],"","\n",!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=Disposable.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this._isDisposing||(this._bracketPairColorizer.handleDidChangeContent(t),this._tokenization.handleDidChangeContent(t),this._eventEmitter.fire(new InternalModelContentChangeEvent(e,t)))}setValue(e){if(this._assertNotDisposed(),null===e)return;const{textBuffer:t,disposable:i}=createTextBuffer(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,n,o,r,s){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:n}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:o,isRedoing:r,isFlush:s}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._tokens.flush(),this._semanticTokens.flush(),this._decorations=Object.create(null),this._decorationsTree=new DecorationsTrees,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawFlush],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,o,r),0,n,this.getValue(),!1,!1,!0))}setEOL(e){this._assertNotDisposed();const t=1===e?"\r\n":"\n";if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),o=this.getLineCount(),r=this.getLineMaxColumn(o);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new ModelRawContentChangedEvent([new ModelRawEOLChanged],this._versionId,!1,!1),this._createContentChanged2(new Range$2(1,1,o,r),0,n,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const n=t[i],o=n.range,r=n.cachedAbsoluteStart-n.start,s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),a=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);n.cachedAbsoluteStart=s,n.cachedAbsoluteEnd=a,n.cachedVersionId=e,n.start=s-r,n.end=a-r,recomputeMaxEnd(n)}}onBeforeAttached(){this._attachedEditorCount++,1===this._attachedEditorCount&&(this._tokenization.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}onBeforeDetached(){this._attachedEditorCount--,0===this._attachedEditorCount&&(this._tokenization.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const i=this._buffer.getLineLength(n);i>=LONG_LINE_BOUNDARY?t+=i:e+=i}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=void 0!==e.tabSize?e.tabSize:this._options.tabSize,i=void 0!==e.indentSize?e.indentSize:this._options.indentSize,n=void 0!==e.insertSpaces?e.insertSpaces:this._options.insertSpaces,o=void 0!==e.trimAutoWhitespace?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r=void 0!==e.bracketColorizationOptions?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,s=new TextModelResolvedOptions({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:o,bracketPairColorizationOptions:r});if(this._options.equals(s))return;const a=this._options.createChangeEvent(s);this._options=s,this._bracketPairColorizer.handleDidChangeOptions(a),this._decorationProvider.handleDidChangeOptions(a),this._onDidChangeOptions.fire(a)}detectIndentation(e,t){this._assertNotDisposed();const i=guessIndentation(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),normalizeIndentation(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(UNUSUAL_LINE_TERMINATORS.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map((e=>({range:e.range,text:null}))),(()=>null))}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new TextModelSnapshot(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),"\n"===this._buffer.getEOL()?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let o=Math.floor("number"!=typeof i||isNaN(i)?1:i),r=Math.floor("number"!=typeof n||isNaN(n)?1:n);if(o<1)o=1,r=1;else if(o>t)o=t,r=this.getLineMaxColumn(o);else if(r<=1)r=1;else{const e=this.getLineMaxColumn(o);r>=e&&(r=e)}const s=e.endLineNumber,a=e.endColumn;let l=Math.floor("number"!=typeof s||isNaN(s)?1:s),d=Math.floor("number"!=typeof a||isNaN(a)?1:a);if(l<1)l=1,d=1;else if(l>t)l=t,d=this.getLineMaxColumn(l);else if(d<=1)d=1;else{const e=this.getLineMaxColumn(l);d>=e&&(d=e)}return i===o&&n===r&&s===l&&a===d&&e instanceof Range$2&&!(e instanceof Selection$1)?e:new Range$2(o,r,l,d)}_isValidPosition(e,t,i){if("number"!=typeof e||"number"!=typeof t)return!1;if(isNaN(e)||isNaN(t))return!1;if(e<1||t<1)return!1;if((0|e)!==e||(0|t)!==t)return!1;if(e>this._buffer.getLineCount())return!1;if(1===t)return!0;if(t>this.getLineMaxColumn(e))return!1;if(1===i){if(isHighSurrogate(this._buffer.getLineCharCode(e,t-2)))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor("number"!=typeof e||isNaN(e)?1:e),o=Math.floor("number"!=typeof t||isNaN(t)?1:t),r=this._buffer.getLineCount();if(n<1)return new Position$1(1,1);if(n>r)return new Position$1(r,this.getLineMaxColumn(r));if(o<=1)return new Position$1(n,1);const s=this.getLineMaxColumn(n);if(o>=s)return new Position$1(n,s);if(1===i){if(isHighSurrogate(this._buffer.getLineCharCode(n,o-2)))return new Position$1(n,o-1)}return new Position$1(n,o)}validatePosition(e){return this._assertNotDisposed(),e instanceof Position$1&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(i,n,0))return!1;if(!this._isValidPosition(o,r,0))return!1;if(1===t){const e=n>1?this._buffer.getLineCharCode(i,n-2):0,t=r>1&&r<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,r-2):0,s=isHighSurrogate(e),a=isHighSurrogate(t);return!s&&!a}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof Range$2&&!(e instanceof Selection$1)&&this._isValidRange(e,1))return e;const t=this._validatePosition(e.startLineNumber,e.startColumn,0),i=this._validatePosition(e.endLineNumber,e.endColumn,0),n=t.lineNumber,o=t.column,r=i.lineNumber,s=i.column;{const e=o>1?this._buffer.getLineCharCode(n,o-2):0,t=s>1&&s<=this._buffer.getLineLength(r)?this._buffer.getLineCharCode(r,s-2):0,i=isHighSurrogate(e),a=isHighSurrogate(t);return i||a?n===r&&o===s?new Range$2(n,o-1,r,s-1):i&&a?new Range$2(n,o-1,r,s+1):i?new Range$2(n,o-1,r,s):new Range$2(n,o,r,s+1):new Range$2(n,o,r,s)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new Range$2(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,o,r,s=LIMIT_FIND_COUNT){this._assertNotDisposed();let a=null;null!==t&&(Array.isArray(t)||(t=[t]),t.every((e=>Range$2.isIRange(e)))&&(a=t.map((e=>this.validateRange(e))))),null===a&&(a=[this.getFullModelRange()]),a=a.sort(((e,t)=>e.startLineNumber-t.startLineNumber||e.startColumn-t.startColumn));const l=[];let d;if(l.push(a.reduce(((e,t)=>Range$2.areIntersecting(e,t)?e.plusRange(t):(l.push(e),t)))),!i&&e.indexOf("\n")<0){const t=new SearchParams(e,i,n,o).parseSearchRequest();if(!t)return[];d=e=>this.findMatchesLineByLine(e,t,r,s)}else d=t=>TextModelSearch.findMatches(this,new SearchParams(e,i,n,o),t,r,s);return l.map(d).reduce(((e,t)=>e.concat(t)),[])}findNextMatch(e,t,i,n,o,r){this._assertNotDisposed();const s=this.validatePosition(t);if(!i&&e.indexOf("\n")<0){const t=new SearchParams(e,i,n,o).parseSearchRequest();if(!t)return null;const a=this.getLineCount();let l=new Range$2(s.lineNumber,s.column,a,this.getLineMaxColumn(a)),d=this.findMatchesLineByLine(l,t,r,1);return TextModelSearch.findNextMatch(this,new SearchParams(e,i,n,o),s,r),d.length>0?d[0]:(l=new Range$2(1,1,s.lineNumber,this.getLineMaxColumn(s.lineNumber)),d=this.findMatchesLineByLine(l,t,r,1),d.length>0?d[0]:null)}return TextModelSearch.findNextMatch(this,new SearchParams(e,i,n,o),s,r)}findPreviousMatch(e,t,i,n,o,r){this._assertNotDisposed();const s=this.validatePosition(t);return TextModelSearch.findPreviousMatch(this,new SearchParams(e,i,n,o),s,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if(("\n"===this.getEOL()?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof ValidAnnotatedEditOperation?e:new ValidAnnotatedEditOperation(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const i=t.map((e=>({range:this.validateRange(e.range),text:e.text})));let n=!0;if(e)for(let t=0,o=e.length;t<o;t++){const o=e[t];let r=!1;for(let e=0,t=i.length;e<t;e++){const t=i[e].range,n=t.startLineNumber>o.endLineNumber,s=o.startLineNumber>t.endLineNumber;if(!n&&!s){r=!0;break}}if(!r){n=!1;break}}if(n)for(let e=0,o=this._trimAutoWhitespaceLines.length;e<o;e++){const n=this._trimAutoWhitespaceLines[e],o=this.getLineMaxColumn(n);let r=!0;for(let e=0,t=i.length;e<t;e++){const t=i[e].range,s=i[e].text;if(!(n<t.startLineNumber||n>t.endLineNumber)&&!(n===t.startLineNumber&&t.startColumn===o&&t.isEmpty()&&s&&s.length>0&&"\n"===s.charAt(0)||n===t.startLineNumber&&1===t.startColumn&&t.isEmpty()&&s&&s.length>0&&"\n"===s.charAt(s.length-1))){r=!1;break}}if(r){const e=new Range$2(n,1,n,o);t.push(new ValidAnnotatedEditOperation(null,e,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i)}_applyUndo(e,t,i,n){const o=e.map((e=>{const t=this.getPositionAt(e.newPosition),i=this.getPositionAt(e.newEnd);return{range:new Range$2(t.lineNumber,t.column,i.lineNumber,i.column),text:e.oldText}}));this._applyUndoRedoEdits(o,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const o=e.map((e=>{const t=this.getPositionAt(e.oldPosition),i=this.getPositionAt(e.oldEnd);return{range:new Range$2(t.lineNumber,t.column,i.lineNumber,i.column),text:e.newText}}));this._applyUndoRedoEdits(o,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,o,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(o)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),n=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),r=n.changes;if(this._trimAutoWhitespaceLines=n.trimAutoWhitespaceLineNumbers,0!==r.length){for(let i=0,n=r.length;i<n;i++){const e=r[i],[t,n,o]=countEOL(e.text);this._tokens.acceptEdit(e.range,t,n),this._semanticTokens.acceptEdit(e.range,t,n,o,e.text.length>0?e.text.charCodeAt(0):0),this._decorationsTree.acceptReplace(e.rangeOffset,e.rangeLength,e.text.length,e.forceMoveMarkers)}const e=[];this._increaseVersionId();let t=i;for(let i=0,n=r.length;i<n;i++){const n=r[i],[s]=countEOL(n.text);this._onDidChangeDecorations.fire();const a=n.range.startLineNumber,l=n.range.endLineNumber,d=l-a,c=s,h=Math.min(d,c),u=c-d,g=o-t-u+a,p=g,m=g+c,f=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new Position$1(p,1)),this.getOffsetAt(new Position$1(m,this.getLineMaxColumn(m))),0),_=LineInjectedText.fromDecorations(f),C=new ArrayQueue(_);for(let t=h;t>=0;t--){const i=a+t,n=g+t;C.takeFromEndWhile((e=>e.lineNumber>n));const o=C.takeFromEndWhile((e=>e.lineNumber===n));e.push(new ModelRawLineChanged(i,this.getLineContent(n),o))}if(h<d){const t=a+h;e.push(new ModelRawLinesDeleted(t+1,l))}if(h<c){const i=new ArrayQueue(_),n=a+h,r=c-h,s=o-t-r+n+1,l=[],d=[];for(let e=0;e<r;e++){const t=s+e;d[e]=this.getLineContent(t),i.takeWhile((e=>e.lineNumber<t)),l[e]=i.takeWhile((e=>e.lineNumber===t))}e.push(new ModelRawLinesInserted(n+1,a+c,d,l))}t+=u}this._emitContentChangedEvent(new ModelRawContentChangedEvent(e,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return null===n.reverseEdits?void 0:n.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(null===e||0===e.size)return;const t=[...e].map((e=>new ModelRawLineChanged(e,this.getLineContent(e),this._getInjectedTextInLine(e))));this._onDidChangeInjectedText.fire(new ModelInjectedTextChangedEvent(t))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(t,i)=>this._deltaDecorationsImpl(e,[],[{range:t,options:i}])[0],changeDecoration:(e,t)=>{this._changeDecorationImpl(e,t)},changeDecorationOptions:(e,t)=>{this._changeDecorationOptionsImpl(e,_normalizeOptions(t))},removeDecoration:t=>{this._deltaDecorationsImpl(e,[t],[])},deltaDecorations:(t,i)=>0===t.length&&0===i.length?[]:this._deltaDecorationsImpl(e,t,i)};let n=null;try{n=t(i)}catch(e2){onUnexpectedError(e2)}return i.addDecoration=invalidFunc,i.changeDecoration=invalidFunc,i.changeDecorationOptions=invalidFunc,i.removeDecoration=invalidFunc,i.deltaDecorations=invalidFunc,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),0===e.length&&0===t.length)return[];try{return this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:TRACKED_RANGE_OPTIONS[i]}])[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const o=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),s=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,s,o),n.setOptions(TRACKED_RANGE_OPTIONS[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const e=t[i];this._decorationsTree.delete(e),delete this._decorations[e.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,n=!1){const o=this.getLineCount(),r=Math.min(o,Math.max(1,e)),s=Math.min(o,Math.max(1,t)),a=this.getLineMaxColumn(s),l=new Range$2(r,1,s,a),d=this._getDecorationsInRange(l,i,n);return d.push(...this._decorationProvider.getDecorationsInRange(l,i,n)),d}getDecorationsInRange(e,t=0,i=!1){const n=this.validateRange(e),o=this._getDecorationsInRange(n,t,i);return o.push(...this._decorationProvider.getDecorationsInRange(n,t,i)),o}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return LineInjectedText.fromDecorations(n).filter((t=>t.lineNumber===e))}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}_getDecorationsInRange(e,t,i){const n=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),o=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,n,o,t,i)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(i.options.before){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}const n=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),r=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),o,r,n),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const n=!(!i.options.overviewRuler||!i.options.overviewRuler.color),o=!(!t.overviewRuler||!t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const e=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(i.options.before||t.before){const e=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}n!==o?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i){const n=this.getVersionId(),o=t.length;let r=0;const s=i.length;let a=0;const l=new Array(s);for(;r<o||a<s;){let d=null;if(r<o){do{d=this._decorations[t[r++]]}while(!d&&r<o);if(d){if(d.options.after){const e=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(d.options.before){const e=this._decorationsTree.getNodeRange(this,d);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}this._decorationsTree.delete(d),this._onDidChangeDecorations.checkAffectedAndFire(d.options)}}if(a<s){if(!d){const e=++this._lastDecorationId,t=`${this._instanceId};${e}`;d=new IntervalNode(t,0,0),this._decorations[t]=d}const t=i[a],o=this._validateRangeRelaxedNoAllocations(t.range),r=_normalizeOptions(t.options),s=this._buffer.getOffsetAt(o.startLineNumber,o.startColumn),c=this._buffer.getOffsetAt(o.endLineNumber,o.endColumn);d.ownerId=e,d.reset(n,s,c,o),d.setOptions(r),d.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.endLineNumber),d.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(o.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(r),this._decorationsTree.insert(d),l[a]=d.id,a++}else d&&delete this._decorations[d.id]}return l}setTokens(e,t=!1){if(0!==e.length){const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];let o=0,r=0,s=!1;for(let e=n.startLineNumber;e<=n.endLineNumber;e++)if(s)this._tokens.setTokens(this._languageId,e-1,this._buffer.getLineLength(e),n.getLineTokens(e),!1),r=e;else{this._tokens.setTokens(this._languageId,e-1,this._buffer.getLineLength(e),n.getLineTokens(e),!0)&&(s=!0,o=e,r=e)}s&&t.push({fromLineNumber:o,toLineNumber:r})}t.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:t})}this.handleTokenizationProgress(t)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==e,ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}tokenizeViewport(e,t){e=Math.max(1,e),t=Math.min(this._buffer.getLineCount(),t),this._tokenization.tokenizeViewport(e,t)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._buffer.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._isDisposing||(this._bracketPairColorizer.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}resetTokenization(){this._tokenization.reset()}forceTokenization(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(e)}isCheapToTokenize(e){return this._tokenization.isCheapToTokenize(e)}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(e)}_getLineTokens(e){const t=this.getLineContent(e),i=this._tokens.getTokens(this._languageId,e-1,t);return this._semanticTokens.addSparseTokens(e,i)}getLanguageId(){return this._languageId}setMode(e){if(this._languageId===e)return;const t={oldLanguage:this._languageId,newLanguage:e};this._languageId=e,this._bracketPairColorizer.handleDidChangeLanguage(t),this._tokenization.handleDidChangeLanguage(t),this._onDidChangeLanguage.fire(t),this._onDidChangeLanguageConfiguration.fire({})}getLanguageIdAtPosition(e,t){const i=this.validatePosition(new Position$1(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}getTokenTypeIfInsertingCharacter(e,t,i){const n=this.validatePosition(new Position$1(e,t));return this._tokenization.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(e,t,i){const n=this.validatePosition(e);return this._tokenization.tokenizeLineWithEdit(n,t,i)}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}getWordAtPosition(t){this._assertNotDisposed();const i=this.validatePosition(t),n=this.getLineContent(i.lineNumber),o=this._getLineTokens(i.lineNumber),r=o.findTokenIndexAtOffset(i.column-1),[s,a]=e._findLanguageBoundaries(o,r),l=getWordAtText(i.column,this.getLanguageConfiguration(o.getLanguageId(r)).getWordDefinition(),n.substring(s,a),s);if(l&&l.startColumn<=t.column&&t.column<=l.endColumn)return l;if(r>0&&s===i.column-1){const[s,a]=e._findLanguageBoundaries(o,r-1),l=getWordAtText(i.column,this.getLanguageConfiguration(o.getLanguageId(r-1)).getWordDefinition(),n.substring(s,a),s);if(l&&l.startColumn<=t.column&&t.column<=l.endColumn)return l}return null}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let r=t;r>=0&&e.getLanguageId(r)===i;r--)n=e.getStartOffset(r);let o=e.getLineContent().length;for(let r=t,s=e.getCount();r<s&&e.getLanguageId(r)===i;r++)o=e.getEndOffset(r);return[n,o]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}normalizePosition(e,t){return e}getLineIndentColumn(e){return indentOfLine(this.getLineContent(e))+1}};function indentOfLine(e){let t=0;for(const i of e){if(" "!==i&&"\t"!==i)break;t++}return t}function isNodeInOverviewRuler(e){return!(!e.options.overviewRuler||!e.options.overviewRuler.color)}function isNodeInjectedText(e){return!!e.options.after||!!e.options.before}TextModel.MODEL_SYNC_LIMIT=52428800,TextModel.LARGE_FILE_SIZE_THRESHOLD=20971520,TextModel.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,TextModel.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:EDITOR_MODEL_DEFAULTS.tabSize,indentSize:EDITOR_MODEL_DEFAULTS.indentSize,insertSpaces:EDITOR_MODEL_DEFAULTS.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,largeFileOptimizations:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,bracketPairColorizationOptions:EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions},TextModel=__decorate$1w([__param$1r(4,IUndoRedoService),__param$1r(5,ILanguageService),__param$1r(6,ILanguageConfigurationService)],TextModel);class DecorationsTrees{constructor(){this._decorationsTree0=new IntervalTree,this._decorationsTree1=new IntervalTree,this._injectedTextDecorationsTree=new IntervalTree}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)null===i.range&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,o){const r=e.getVersionId(),s=this._intervalSearch(t,i,n,o,r);return this._ensureNodesHaveRanges(e,s)}_intervalSearch(e,t,i,n,o){const r=this._decorationsTree0.intervalSearch(e,t,i,n,o),s=this._decorationsTree1.intervalSearch(e,t,i,n,o),a=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,o);return r.concat(s).concat(a)}getInjectedTextInInterval(e,t,i,n){const o=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,o);return this._ensureNodesHaveRanges(e,r).filter((e=>e.options.showIfCollapsed||!e.range.isEmpty()))}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,i);return this._ensureNodesHaveRanges(e,n).filter((e=>e.options.showIfCollapsed||!e.range.isEmpty()))}getAll(e,t,i,n){const o=e.getVersionId(),r=this._search(t,i,n,o);return this._ensureNodesHaveRanges(e,r)}_search(e,t,i,n){if(i)return this._decorationsTree1.search(e,t,n);{const i=this._decorationsTree0.search(e,t,n),o=this._decorationsTree1.search(e,t,n),r=this._injectedTextDecorationsTree.search(e,t,n);return i.concat(o).concat(r)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){isNodeInjectedText(e)?this._injectedTextDecorationsTree.insert(e):isNodeInOverviewRuler(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){isNodeInjectedText(e)?this._injectedTextDecorationsTree.delete(e):isNodeInOverviewRuler(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),null===t.range&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){isNodeInjectedText(e)?this._injectedTextDecorationsTree.resolveNode(e,t):isNodeInOverviewRuler(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function cleanClassName(e){return e.replace(/[^a-z0-9\-_]/gi," ")}class DecorationOptions{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class ModelDecorationOverviewRulerOptions extends DecorationOptions{constructor(e){super(e),this._resolvedColor=null,this.position="number"==typeof e.position?e.position:OverviewRulerLane$1.Center}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if("string"==typeof e)return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class ModelDecorationMinimapOptions extends DecorationOptions{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return"string"==typeof e?Color.fromHex(e):t.getColor(e.id)}}class ModelDecorationInjectedTextOptions{constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}static from(e){return e instanceof ModelDecorationInjectedTextOptions?e:new ModelDecorationInjectedTextOptions(e)}}class ModelDecorationOptions{constructor(e){var t,i;this.description=e.description,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?cleanClassName(e.className):null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new ModelDecorationOverviewRulerOptions(e.overviewRuler):null,this.minimap=e.minimap?new ModelDecorationMinimapOptions(e.minimap):null,this.glyphMarginClassName=e.glyphMarginClassName?cleanClassName(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?cleanClassName(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?cleanClassName(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?cleanClassName(e.marginClassName):null,this.inlineClassName=e.inlineClassName?cleanClassName(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?cleanClassName(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?cleanClassName(e.afterContentClassName):null,this.after=e.after?ModelDecorationInjectedTextOptions.from(e.after):null,this.before=e.before?ModelDecorationInjectedTextOptions.from(e.before):null,this.hideInCommentTokens=null!==(t=e.hideInCommentTokens)&&void 0!==t&&t,this.hideInStringTokens=null!==(i=e.hideInStringTokens)&&void 0!==i&&i}static register(e){return new ModelDecorationOptions(e)}static createDynamic(e){return new ModelDecorationOptions(e)}}ModelDecorationOptions.EMPTY=ModelDecorationOptions.register({description:"empty"});const TRACKED_RANGE_OPTIONS=[ModelDecorationOptions.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ModelDecorationOptions.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ModelDecorationOptions.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function _normalizeOptions(e){return e instanceof ModelDecorationOptions?e:ModelDecorationOptions.createDynamic(e)}class DidChangeDecorationsEmitter extends Disposable{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new Emitter$1),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;if(this._deferredCnt--,0===this._deferredCnt){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(e)}null===(e=this._affectedInjectedTextLines)||void 0===e||e.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!(!e.minimap||!e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!(!e.overviewRuler||!e.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}class DidChangeContentEmitter extends Disposable{constructor(){super(),this._fastEmitter=this._register(new Emitter$1),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new Emitter$1),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,0===this._deferredCnt&&null!==this._deferredEvent){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e:(this._fastEmitter.fire(e),this._slowEmitter.fire(e))}}function createModelLineProjection(e,t){return null===e?t?IdentityModelLineProjection.INSTANCE:HiddenModelLineProjection.INSTANCE:new ModelLineProjection(e,t)}class ModelLineProjection{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,o=this._projectionData.breakOffsets[i];let r;if(null!==this._projectionData.injectionOffsets){const i=this._projectionData.injectionOffsets.map(((e,t)=>new LineInjectedText(0,0,e+1,this._projectionData.injectionOptions[t],0)));r=LineInjectedText.applyInjectedText(e.getLineContent(t),i).substring(n,o)}else r=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:o+1});return i>0&&(r=spaces(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,o,r,s){this._assertVisible();const a=this._projectionData,l=a.injectionOffsets,d=a.injectionOptions;let c,h=null;if(l){h=[];let e=0,t=0;for(let i=0;i<a.getOutputLineCount();i++){const n=new Array;h[i]=n;const o=i>0?a.breakOffsets[i-1]:0,r=a.breakOffsets[i];for(;t<l.length;){const s=d[t].content.length,c=l[t]+e,h=c+s;if(c>r)break;if(o<h){const e=d[t];if(e.inlineClassName){const t=i>0?a.wrappedTextIndentLength:0,s=t+Math.max(c-o,0),l=t+Math.min(h-o,r);s!==l&&n.push(new SingleLineInlineDecoration(s,l,e.inlineClassName,e.inlineClassNameAffectsLetterSpacing))}}if(!(h<=r))break;e+=s,t++}}}c=l?e.getLineTokens(t).withInserted(l.map(((e,t)=>({offset:e,text:d[t].content,tokenMetadata:LineTokens.defaultTokenMetadata})))):e.getLineTokens(t);for(let u=i;u<i+n;u++){const e=o+u-i;r[e]?s[e]=this._getViewLineData(c,h?h[u]:null,u):s[e]=null}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,o=i>0?n.wrappedTextIndentLength:0,r=i>0?n.breakOffsets[i-1]:0,s=n.breakOffsets[i],a=e.sliceAndInflate(r,s,o);let l=a.getLineContent();i>0&&(l=spaces(n.wrappedTextIndentLength)+l);const d=this._projectionData.getMinOutputOffset(i)+1,c=l.length+1,h=i+1<this.getViewLineCount(),u=0===i?0:n.breakOffsetsVisibleColumn[i-1];return new ViewLineData(l,h,d,c,u,a,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){this._assertVisible();return this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();return e+this._projectionData.translateToOutputPosition(t-1).outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}class IdentityModelLineProjection{constructor(){}isVisible(){return!0}setVisible(e){return e?this:HiddenModelLineProjection.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.getLineTokens(t),o=n.getLineContent();return new ViewLineData(o,!1,1,o.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,o,r,s){r[o]?s[o]=this.getViewLineData(e,t,0):s[o]=null}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new Position$1(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}}IdentityModelLineProjection.INSTANCE=new IdentityModelLineProjection;class HiddenModelLineProjection{constructor(){}isVisible(){return!1}setVisible(e){return e?IdentityModelLineProjection.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,o,r,s){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}}HiddenModelLineProjection.INSTANCE=new HiddenModelLineProjection;let _spaces=[""];function spaces(e){if(e>=_spaces.length)for(let t=1;t<=e;t++)_spaces[t]=_makeSpaces(t);return _spaces[e]}function _makeSpaces(e){return new Array(e+1).join(" ")}class PrefixSumComputer{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=toUint32(e);const i=this.values,n=this.prefixSum,o=t.length;return 0!==o&&(this.values=new Uint32Array(i.length+o),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+o),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=toUint32(e),t=toUint32(t),this.values[e]!==t&&(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=toUint32(e),t=toUint32(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const o=i.length-e;return t>=o&&(t=o),0!==t&&(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return 0===this.values.length?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=toUint32(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;0===t&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,o=0,r=0;for(;t<=i;)if(n=t+(i-t)/2|0,o=this.prefixSum[n],r=o-this.values[n],e<r)i=n-1;else{if(!(e>=o))break;t=n+1}return new PrefixSumIndexOfResult(n,e-r)}}class ConstantTimePrefixSumComputer{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),0===e?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new PrefixSumIndexOfResult(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=arrayInsert(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const t=this._values[e],i=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=i+t;for(let n=0;n<t;n++)this._indexBySum[i+n]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class PrefixSumIndexOfResult{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class ViewModelLinesFromProjectedModel{constructor(e,t,i,n,o,r,s,a,l){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=o,this.tabSize=r,this.wrappingStrategy=s,this.wrappingColumn=a,this.wrappingIndent=l,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new CoordinatesConverter(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),o=i.length,r=this.createLineBreaksComputer(),s=new ArrayQueue(LineInjectedText.fromDecorations(n));for(let p=0;p<o;p++){const e=s.takeWhile((e=>e.lineNumber===p+1));r.addRequest(i[p],e,t?t[p]:null)}const a=r.finalize(),l=[],d=this.hiddenAreasDecorationIds.map((e=>this.model.getDecorationRange(e))).sort(Range$2.compareRangesUsingStarts);let c=1,h=0,u=-1,g=u+1<d.length?h+1:o+2;for(let p=0;p<o;p++){const e=p+1;e===g&&(u++,c=d[u].startLineNumber,h=d[u].endLineNumber,g=u+1<d.length?h+1:o+2);const t=e>=c&&e<=h,i=createModelLineProjection(a[p],!t);l[p]=i.getViewLineCount(),this.modelLineProjections[p]=i}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new ConstantTimePrefixSumComputer(l)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map((e=>this.model.getDecorationRange(e)))}setHiddenAreas(e){const t=normalizeLineRanges(e.map((e=>this.model.validateRange(e)))),i=this.hiddenAreasDecorationIds.map((e=>this.model.getDecorationRange(e))).sort(Range$2.compareRangesUsingStarts);if(t.length===i.length){let e=!1;for(let n=0;n<t.length;n++)if(!t[n].equalsRange(i[n])){e=!0;break}if(!e)return!1}const n=t.map((e=>({range:e,options:ModelDecorationOptions.EMPTY})));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,n);const o=t;let r=1,s=0,a=-1,l=a+1<o.length?s+1:this.modelLineProjections.length+2,d=!1;for(let c=0;c<this.modelLineProjections.length;c++){const e=c+1;e===l&&(a++,r=o[a].startLineNumber,s=o[a].endLineNumber,l=a+1<o.length?s+1:this.modelLineProjections.length+2);let t=!1;if(e>=r&&e<=s?this.modelLineProjections[c].isVisible()&&(this.modelLineProjections[c]=this.modelLineProjections[c].setVisible(!1),t=!0):(d=!0,this.modelLineProjections[c].isVisible()||(this.modelLineProjections[c]=this.modelLineProjections[c].setVisible(!0),t=!0)),t){const e=this.modelLineProjections[c].getViewLineCount();this.projectedModelLineLineCounts.setValue(c,e)}}return d||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return!(e<1||e>this.modelLineProjections.length)&&this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize!==e&&(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n){const o=this.fontInfo.equals(e),r=this.wrappingStrategy===t,s=this.wrappingColumn===i,a=this.wrappingIndent===n;if(o&&r&&s&&a)return!1;const l=o&&r&&!s&&a;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n;let d=null;if(l){d=[];for(let e=0,t=this.modelLineProjections.length;e<t;e++)d[e]=this.modelLineProjections[e].getProjectionData()}return this._constructLines(!1,d),!0}createLineBreaksComputer(){return("advanced"===this.wrappingStrategy?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=1===t?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,o=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new ViewLinesDeletedEvent(n,o)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const o=t>2&&!this.modelLineProjections[t-2].isVisible(),r=1===t?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let s=0;const a=[],l=[];for(let d=0,c=n.length;d<c;d++){const e=createModelLineProjection(n[d],!o);a.push(e);const t=e.getViewLineCount();s+=t,l[d]=t}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(a).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,l),new ViewLinesInsertedEvent(r,r+s-1)}onModelLineChanged(e,t,i){if(null!==e&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,o=this.modelLineProjections[n].getViewLineCount(),r=createModelLineProjection(i,this.modelLineProjections[n].isVisible());this.modelLineProjections[n]=r;const s=this.modelLineProjections[n].getViewLineCount();let a=!1,l=0,d=-1,c=0,h=-1,u=0,g=-1;o>s?(l=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=l+s-1,u=d+1,g=u+(o-s)-1,a=!0):o<s?(l=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=l+o-1,c=d+1,h=c+(s-o)-1,a=!0):(l=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,d=l+s-1),this.projectedModelLineLineCounts.setValue(n,s);return[a,l<=d?new ViewLinesChangedEvent(l,d):null,c<=h?new ViewLinesInsertedEvent(c,h):null,u<=g?new ViewLinesDeletedEvent(u,g):null]}acceptVersionId(e){this._validModelVersionId=e,1!==this.modelLineProjections.length||this.modelLineProjections[0].isVisible()||this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:0|e}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),o=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),r=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),s=this.model.guides.getActiveIndentGuide(n.lineNumber,o.lineNumber,r.lineNumber),a=this.convertModelPositionToViewPosition(s.startLineNumber,1),l=this.convertModelPositionToViewPosition(s.endLineNumber,this.model.getLineMaxColumn(s.endLineNumber));return{startLineNumber:a.lineNumber,endLineNumber:l.lineNumber,indent:s.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new ViewLineInfo(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new Position$1(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new Position$1(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),o=new Array;let r=this.getModelStartPositionOfViewLine(i),s=new Array;for(let a=i.modelLineNumber;a<=n.modelLineNumber;a++){const e=this.modelLineProjections[a-1];if(e.isVisible()){const t=a===i.modelLineNumber?i.modelLineWrappedLineIdx:0,o=a===n.modelLineNumber?n.modelLineWrappedLineIdx+1:e.getViewLineCount();for(let e=t;e<o;e++)s.push(new ViewLineInfo(a,e))}if(!e.isVisible()&&r){const e=new Position$1(a-1,this.model.getLineMaxColumn(a-1)+1),t=Range$2.fromPositions(r,e);o.push(new ViewLineInfoGroupedByModelRange(t,s)),s=[],r=null}else e.isVisible()&&!r&&(r=new Position$1(a,1))}if(r){const e=Range$2.fromPositions(r,this.getModelEndPositionOfViewLine(n));o.push(new ViewLineInfoGroupedByModelRange(e,s))}return o}getViewLinesBracketGuides(e,t,i,n){const o=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,r=[];for(const s of this.getViewLineInfosGroupedByModelRanges(e,t)){const e=s.modelRange.startLineNumber,t=this.model.guides.getLinesBracketGuides(e,s.modelRange.endLineNumber,o,n);for(const i of s.viewLines)if(i.isWrappedLineContinuation&&1===this.getMinColumnOfViewLine(i))r.push([]);else{let n=t[i.modelLineNumber-e];n=n.map((e=>e.horizontalLine?new IndentGuide(e.visibleColumn,e.className,new IndentGuideHorizontalLine(e.horizontalLine.top,this.convertModelPositionToViewPosition(i.modelLineNumber,e.horizontalLine.endColumn).column)):e)),r.push(n)}}return r}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let o=[];const r=[],s=[],a=i.lineNumber-1,l=n.lineNumber-1;let d=null;for(let g=a;g<=l;g++){const e=this.modelLineProjections[g];if(e.isVisible()){const t=e.getViewLineNumberOfModelPosition(0,g===a?i.column:1),n=e.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(g+1)),o=n-t+1;let l=0;o>1&&1===e.getViewLineMinColumn(this.model,g+1,n)&&(l=0===t?1:2),r.push(o),s.push(l),null===d&&(d=new Position$1(g+1,0))}else null!==d&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,g)),d=null)}null!==d&&(o=o.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,n.lineNumber)),d=null);const c=t-e+1,h=new Array(c);let u=0;for(let g=0,p=o.length;g<p;g++){let e=o[g];const t=Math.min(c-u,r[g]),i=s[g];let n;n=2===i?0:1===i?1:t;for(let o=0;o<t;o++)o===n&&(e=0),h[u++]=e}return h}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let o=e;const r=n.index,s=n.remainder,a=[];for(let l=r,d=this.model.getLineCount();l<d;l++){const n=this.modelLineProjections[l];if(!n.isVisible())continue;const d=l===r?s:0;let c=n.getViewLineCount()-d,h=!1;if(o+c>t&&(h=!0,c=t-o+1),n.getViewLinesData(this.model,l+1,d,c,o-e,i,a),o+=c,h)break}return a}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),o=n.index,r=n.remainder,s=this.modelLineProjections[o],a=s.getViewLineMinColumn(this.model,o+1,r),l=s.getViewLineMaxColumn(this.model,o+1,r);t<a&&(t=a),t>l&&(t=l);const d=s.getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new Position$1(o+1,d)).equals(i)?new Position$1(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new Range$2(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new Position$1(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new Range$2(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2){const n=this.model.validatePosition(new Position$1(e,t)),o=n.lineNumber,r=n.column;let s=o-1,a=!1;for(;s>0&&!this.modelLineProjections[s].isVisible();)s--,a=!0;if(0===s&&!this.modelLineProjections[s].isVisible())return new Position$1(1,1);const l=1+this.projectedModelLineLineCounts.getPrefixSum(s);let d;return d=a?this.modelLineProjections[s].getViewPositionOfModelPosition(l,this.model.getLineMaxColumn(s+1),i):this.modelLineProjections[o-1].getViewPositionOfModelPosition(l,r,i),d}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return Range$2.fromPositions(i)}{const t=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),i=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new Range$2(t.lineNumber,t.column,i.lineNumber,i.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const e=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(e,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(0===i&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i){const n=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),o=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(o.lineNumber-n.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new Range$2(n.lineNumber,1,o.lineNumber,o.column),t,i);let r=[];const s=n.lineNumber-1,a=o.lineNumber-1;let l=null;for(let u=s;u<=a;u++){if(this.modelLineProjections[u].isVisible())null===l&&(l=new Position$1(u+1,u===s?n.column:1));else if(null!==l){const e=this.model.getLineMaxColumn(u);r=r.concat(this.model.getDecorationsInRange(new Range$2(l.lineNumber,l.column,u,e),t,i)),l=null}}null!==l&&(r=r.concat(this.model.getDecorationsInRange(new Range$2(l.lineNumber,l.column,o.lineNumber,o.column),t,i)),l=null),r.sort(((e,t)=>{const i=Range$2.compareRangesUsingStarts(e.range,t.range);return 0===i?e.id<t.id?-1:e.id>t.id?1:0:i}));let d=[],c=0,h=null;for(const u of r){const e=u.id;h!==e&&(h=e,d[c++]=u)}return d}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return 0===t.modelLineWrappedLineIdx?this.model.getLineIndentColumn(t.modelLineNumber):0}}function normalizeLineRanges(e){if(0===e.length)return[];const t=e.slice();t.sort(Range$2.compareRangesUsingStarts);const i=[];let n=t[0].startLineNumber,o=t[0].endLineNumber;for(let r=1,s=t.length;r<s;r++){const e=t[r];e.startLineNumber>o+1?(i.push(new Range$2(n,1,o,1)),n=e.startLineNumber,o=e.endLineNumber):e.endLineNumber>o&&(o=e.endLineNumber)}return i.push(new Range$2(n,1,o,1)),i}class ViewLineInfo{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}get isWrappedLineContinuation(){return this.modelLineWrappedLineIdx>0}}class ViewLineInfoGroupedByModelRange{constructor(e,t){this.modelRange=e,this.viewLines=t}}class CoordinatesConverter{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class ViewModelLinesFromModelAsIs{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new IdentityCoordinatesConverter(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new ViewLinesDeletedEvent(t,i)}onModelLinesInserted(e,t,i,n){return new ViewLinesInsertedEvent(t,i)}onModelLineChanged(e,t,i){return[!1,new ViewLinesChangedEvent(t,t),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let o=0;o<i;o++)n[o]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.getLineTokens(e),i=t.getLineContent();return new ViewLineData(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const o=[];for(let r=e;r<=t;r++){const t=r-e;o[t]=i[t]?this.getViewLineData(r):null}return o}getDecorationsInRange(e,t,i){return this.model.getDecorationsInRange(e,t,i)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class IdentityCoordinatesConverter{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}class ViewModel extends Disposable{constructor(e,t,i,n,o,r,s,a){if(super(),this.languageConfigurationService=s,this._themeService=a,this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new ViewModelEventDispatcher,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._tokenizeViewportSoon=this._register(new RunOnceScheduler((()=>this.tokenizeViewport()),50)),this._updateConfigurationViewLineCount=this._register(new RunOnceScheduler((()=>this._updateConfigurationViewLineCountNow()),0)),this._hasFocus=!1,this._viewportStartLine=-1,this._viewportStartLineTrackedRange=null,this._viewportStartLineDelta=0,this.model.isTooLargeForTokenization())this._lines=new ViewModelLinesFromModelAsIs(this.model);else{const e=this._configuration.options,t=e.get(44),i=e.get(125),r=e.get(132),s=e.get(124);this._lines=new ViewModelLinesFromProjectedModel(this._editorId,this.model,n,o,t,this.model.getOptions().tabSize,i,r.wrappingColumn,s)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new CursorsController(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new ViewLayout(this._configuration,this.getLineCount(),r)),this._register(this.viewLayout.onDidScroll((e=>{e.scrollTopChanged&&this._tokenizeViewportSoon.schedule(),this._eventDispatcher.emitSingleViewEvent(new ViewScrollChangedEvent(e)),this._eventDispatcher.emitOutgoingEvent(new ScrollChangedEvent(e.oldScrollWidth,e.oldScrollLeft,e.oldScrollHeight,e.oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop))}))),this._register(this.viewLayout.onDidContentSizeChange((e=>{this._eventDispatcher.emitOutgoingEvent(e)}))),this._decorations=new ViewModelDecorations(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast((e=>{try{const t=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(t,e)}finally{this._eventDispatcher.endEmitViewEvents()}}))),this._register(MinimapTokensColorTracker.getInstance().onDidChange((()=>{this._eventDispatcher.emitSingleViewEvent(new ViewTokensColorsChangedEvent)}))),this._register(this._themeService.onDidColorThemeChange((e=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new ViewThemeChangedEvent(e))}))),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,null,1),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}tokenizeViewport(){const e=this.viewLayout.getLinesViewportData(),t=new Range$2(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber)),i=this._toModelVisibleRanges(t);for(const n of i)this.model.tokenizeViewport(n.startLineNumber,n.endLineNumber)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new ViewFocusChangedEvent(e)),this._eventDispatcher.emitOutgoingEvent(new FocusChangedEvent(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionStartEvent)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new ViewCompositionEndEvent)}_onConfigurationChanged(e,t){let i=null;if(-1!==this._viewportStartLine){const e=new Position$1(this._viewportStartLine,this.getLineMinColumn(this._viewportStartLine));i=this.coordinatesConverter.convertViewPositionToModelPosition(e)}let n=!1;const o=this._configuration.options,r=o.get(44),s=o.get(125),a=o.get(132),l=o.get(124);if(this._lines.setWrappingSettings(r,s,a.wrappingColumn,l)&&(e.emitViewEvent(new ViewFlushedEvent),e.emitViewEvent(new ViewLineMappingChangedEvent),e.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),0!==this.viewLayout.getCurrentScrollTop()&&(n=!0),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(81)&&(this._decorations.reset(),e.emitViewEvent(new ViewDecorationsChangedEvent(null))),e.emitViewEvent(new ViewConfigurationChangedEvent(t)),this.viewLayout.onConfigurationChanged(t),n&&i){const e=this.coordinatesConverter.convertModelPositionToViewPosition(i),t=this.viewLayout.getVerticalOffsetForLineNumber(e.lineNumber);this.viewLayout.setScrollPosition({scrollTop:t+this._viewportStartLineDelta},1)}CursorConfiguration.shouldRecreate(t)&&(this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText((e=>{try{const t=this._eventDispatcher.beginEmitViewEvents();let i=!1,n=!1;const o=e.changes,r=e instanceof ModelRawContentChangedEvent?e.versionId:null,s=this._lines.createLineBreaksComputer();for(const e of o)switch(e.changeType){case 4:for(let t=0;t<e.detail.length;t++){const i=e.detail[t];let n=e.injectedTexts[t];n&&(n=n.filter((e=>!e.ownerId||e.ownerId===this._editorId))),s.addRequest(i,n,null)}break;case 2:{let t=null;e.injectedText&&(t=e.injectedText.filter((e=>!e.ownerId||e.ownerId===this._editorId))),s.addRequest(e.detail,t,null);break}}const a=s.finalize(),l=new ArrayQueue(a);for(const e of o)switch(e.changeType){case 1:this._lines.onModelFlushed(),t.emitViewEvent(new ViewFlushedEvent),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),i=!0;break;case 3:{const n=this._lines.onModelLinesDeleted(r,e.fromLineNumber,e.toLineNumber);null!==n&&(t.emitViewEvent(n),this.viewLayout.onLinesDeleted(n.fromLineNumber,n.toLineNumber)),i=!0;break}case 4:{const n=l.takeCount(e.detail.length),o=this._lines.onModelLinesInserted(r,e.fromLineNumber,e.toLineNumber,n);null!==o&&(t.emitViewEvent(o),this.viewLayout.onLinesInserted(o.fromLineNumber,o.toLineNumber)),i=!0;break}case 2:{const i=l.dequeue(),[o,s,a,d]=this._lines.onModelLineChanged(r,e.lineNumber,i);n=o,s&&t.emitViewEvent(s),a&&(t.emitViewEvent(a),this.viewLayout.onLinesInserted(a.fromLineNumber,a.toLineNumber)),d&&(t.emitViewEvent(d),this.viewLayout.onLinesDeleted(d.fromLineNumber,d.toLineNumber));break}}null!==r&&this._lines.acceptVersionId(r),this.viewLayout.onHeightMaybeChanged(),!i&&n&&(t.emitViewEvent(new ViewLineMappingChangedEvent),t.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}if(this._viewportStartLine=-1,this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&this._viewportStartLineTrackedRange){const e=this.model._getTrackedRange(this._viewportStartLineTrackedRange);if(e){const t=this.coordinatesConverter.convertModelPositionToViewPosition(e.getStartPosition()),i=this.viewLayout.getVerticalOffsetForLineNumber(t.lineNumber);this.viewLayout.setScrollPosition({scrollTop:i+this._viewportStartLineDelta},1)}}try{const t=this._eventDispatcher.beginEmitViewEvents();this._cursor.onModelContentChanged(t,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._tokenizeViewportSoon.schedule()}))),this._register(this.model.onDidChangeTokens((e=>{const t=[];for(let i=0,n=e.ranges.length;i<n;i++){const n=e.ranges[i],o=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(n.fromLineNumber,1)).lineNumber,r=this.coordinatesConverter.convertModelPositionToViewPosition(new Position$1(n.toLineNumber,this.model.getLineMaxColumn(n.toLineNumber))).lineNumber;t[i]={fromLineNumber:o,toLineNumber:r}}this._eventDispatcher.emitSingleViewEvent(new ViewTokensChangedEvent(t)),e.tokenizationSupportChanged&&this._tokenizeViewportSoon.schedule()}))),this._register(this.model.onDidChangeLanguageConfiguration((e=>{this._eventDispatcher.emitSingleViewEvent(new ViewLanguageConfigurationEvent),this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeLanguage((e=>{this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeOptions((e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const e=this._eventDispatcher.beginEmitViewEvents();e.emitViewEvent(new ViewFlushedEvent),e.emitViewEvent(new ViewLineMappingChangedEvent),e.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new CursorConfiguration(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig)}))),this._register(this.model.onDidChangeDecorations((e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new ViewDecorationsChangedEvent(e))})))}setHiddenAreas(e){let t=!1;try{const i=this._eventDispatcher.beginEmitViewEvents();t=this._lines.setHiddenAreas(e),t&&(i.emitViewEvent(new ViewFlushedEvent),i.emitViewEvent(new ViewLineMappingChangedEvent),i.emitViewEvent(new ViewDecorationsChangedEvent(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),t&&this._eventDispatcher.emitOutgoingEvent(new ViewZonesChangedEvent)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(131),t=this._configuration.options.get(59),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),o=Math.max(1,n.completelyVisibleStartLineNumber-i),r=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new Range$2(o,this.getLineMinColumn(o),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(0===i.length)return[t];const n=[];let o=0,r=t.startLineNumber,s=t.startColumn;const a=t.endLineNumber,l=t.endColumn;for(let d=0,c=i.length;d<c;d++){const e=i[d].startLineNumber,t=i[d].endLineNumber;t<r||(e>a||(r<e&&(n[o++]=new Range$2(r,s,e-1,this.model.getLineMaxColumn(e-1))),r=t+1,s=1))}return(r<a||r===a&&s<l)&&(n[o++]=new Range$2(r,s,a,l)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new Range$2(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new Range$2(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(i,this.getLineMinColumn(i))),o=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:o}}reduceRestoreState(e){if(void 0===e.firstPosition)return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStartLine=e;const n=this.coordinatesConverter.convertViewPositionToModelPosition(new Position$1(e,this.getLineMinColumn(e)));this._viewportStartLineTrackedRange=this.model._setTrackedRange(this._viewportStartLineTrackedRange,new Range$2(n.lineNumber,n.column,n.lineNumber,n.column),1);const o=this.viewLayout.getVerticalOffsetForLineNumber(e),r=this.viewLayout.getCurrentScrollTop();this._viewportStartLineDelta=r-o}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=firstNonWhitespaceIndex(this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=lastNonWhitespaceIndex(this.getLineContent(e));return-1===t?0:t+2}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),n=this.model.mightContainNonBasicASCII(),o=this.getTabSize(),r=this._lines.getViewLineData(t);let s=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return r.inlineDecorations&&(s=[...s,...r.inlineDecorations.map((e=>e.toInlineDecoration(t)))]),new ViewLineRenderingData(r.minColumn,r.maxColumn,r.content,r.continuesWithWrappedLine,i,n,r.tokens,s,o,r.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new MinimapLinesRenderingData(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,filterValidationDecorations(this._configuration.options)),i=new OverviewRulerDecorations;for(const n of t){const t=n.options,o=t.overviewRuler;if(!o)continue;const r=o.position;if(0===r)continue;const s=o.getColor(e.value),a=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),l=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(s,t.zIndex,a,l,r)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e){const e=t.options.overviewRuler;e&&e.invalidateCachedColor();const i=t.options.minimap;i&&i.invalidateCachedColor()}}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);2===this.model.getEOL().length&&(t<0?t-=i:t+=i);const o=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(o)}getPlainTextToCopy(e,t,i){const n=i?"\r\n":this.model.getEOL();(e=e.slice(0)).sort(Range$2.compareRangesUsingStarts);let o=!1,r=!1;for(const a of e)a.isEmpty()?o=!0:r=!0;if(!r){if(!t)return"";const i=e.map((e=>e.startLineNumber));let o="";for(let e=0;e<i.length;e++)e>0&&i[e-1]===i[e]||(o+=this.model.getLineContent(i[e])+n);return o}if(o&&t){const t=[];let n=0;for(const o of e){const e=o.startLineNumber;o.isEmpty()?e!==n&&t.push(this.model.getLineContent(e)):t.push(this.model.getValueInRange(o,i?2:0)),n=e}return 1===t.length?t[0]:t}const s=[];for(const a of e)a.isEmpty()||s.push(this.model.getValueInRange(a,i?2:0));return 1===s.length?s[0]:s}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===PLAINTEXT_LANGUAGE_ID)return null;if(1!==e.length)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const e=n.startLineNumber;n=new Range$2(e,this.model.getLineMinColumn(e),e,this.model.getLineMaxColumn(e))}const o=this._configuration.options.get(44),r=this._getColorMap();let s;if(/[:;\\\/<>]/.test(o.fontFamily)||o.fontFamily===EDITOR_FONT_DEFAULTS.fontFamily)s=EDITOR_FONT_DEFAULTS.fontFamily;else{s=o.fontFamily,s=s.replace(/"/g,"'");if(!/[,']/.test(s)){/[+ ]/.test(s)&&(s=`'${s}'`)}s=`${s}, ${EDITOR_FONT_DEFAULTS.fontFamily}`}return{mode:i,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${s};font-weight: ${o.fontWeight};font-size: ${o.fontSize}px;line-height: ${o.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,r)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,o=e.endLineNumber,r=e.endColumn,s=this.getTabSize();let a="";for(let l=i;l<=o;l++){const e=this.model.getLineTokens(l),d=e.getLineContent(),c=l===i?n-1:0,h=l===o?r-1:d.length;a+=""===d?"<br>":tokenizeLineToHTML(d,e.inflate(),t,c,h,s,isWindows)}return a}_getColorMap(){const e=TokenizationRegistry.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=Color.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector((n=>this._cursor.setStates(n,e,t,i)))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector((n=>this._cursor.setSelections(n,e,t,i)))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector((t=>this._cursor.restoreState(t,e)))}_executeCursorEdit(e){this._cursor.context.cursorConfig.readOnly?this._eventDispatcher.emitOutgoingEvent(new ReadOnlyEditAttemptEvent):this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit((n=>this._cursor.executeEdits(n,e,t,i)))}startComposition(){this._cursor.setIsDoingComposition(!0),this._executeCursorEdit((e=>this._cursor.startComposition(e)))}endComposition(e){this._cursor.setIsDoingComposition(!1),this._executeCursorEdit((t=>this._cursor.endComposition(t,e)))}type(e,t){this._executeCursorEdit((i=>this._cursor.type(i,e,t)))}compositionType(e,t,i,n,o){this._executeCursorEdit((r=>this._cursor.compositionType(r,e,t,i,n,o)))}paste(e,t,i,n){this._executeCursorEdit((o=>this._cursor.paste(o,e,t,i,n)))}cut(e){this._executeCursorEdit((t=>this._cursor.cut(t,e)))}executeCommand(e,t){this._executeCursorEdit((i=>this._cursor.executeCommand(i,e,t)))}executeCommands(e,t){this._executeCursorEdit((i=>this._cursor.executeCommands(i,e,t)))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector((n=>this._cursor.revealPrimary(n,e,i,0,t,0)))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new Range$2(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector((t=>t.emitViewEvent(new ViewRevealRangeRequestEvent(e,!1,i,null,0,!0,0))))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new Range$2(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector((t=>t.emitViewEvent(new ViewRevealRangeRequestEvent(e,!1,i,null,0,!0,0))))}revealRange(e,t,i,n,o){this._withViewEventsCollector((r=>r.emitViewEvent(new ViewRevealRangeRequestEvent(e,!1,i,null,n,t,o))))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new ViewZonesChangedEvent$1),this._eventDispatcher.emitOutgoingEvent(new ViewZonesChangedEvent))}_withViewEventsCollector(e){try{return e(this._eventDispatcher.beginEmitViewEvents())}finally{this._eventDispatcher.endEmitViewEvents()}}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}}class OverviewRulerDecorations{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,o){const r=this._asMap[e];if(r){const e=r.data,t=e[e.length-3],s=e[e.length-1];if(t===o&&s+1>=i)return void(n>s&&(e[e.length-1]=n));e.push(o,i,n)}else{const r=new OverviewRulerDecorationsGroup(e,t,[o,i,n]);this._asMap[e]=r,this.asArray.push(r)}}}class ServiceCollection{constructor(...e){this._entries=new Map;for(let[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}var Severity$1,Severity2;Severity2=Severity$1||(Severity$1={}),Severity2[Severity2.Ignore=0]="Ignore",Severity2[Severity2.Info=1]="Info",Severity2[Severity2.Warning=2]="Warning",Severity2[Severity2.Error=3]="Error",function(e){const t="error",i="warning",n="info";e.fromValue=function(o){return o?equalsIgnoreCase(t,o)?e.Error:equalsIgnoreCase(i,o)||equalsIgnoreCase("warn",o)?e.Warning:equalsIgnoreCase(n,o)?e.Info:e.Ignore:e.Ignore},e.toString=function(o){switch(o){case e.Error:return t;case e.Warning:return i;case e.Info:return n;default:return"ignore"}}}(Severity$1||(Severity$1={}));var Severity$2=Severity$1,Severity=Severity$2;const INotificationService=createDecorator("notificationService");class NoOpNotification{}class ModelLineProjectionData{constructor(e,t,i,n,o){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=o}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let i=this.breakOffsets[e]-t;return e>0&&(i+=this.wrappedTextIndentLength),i}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let i=0===e?t:this.breakOffsets[e-1]+t;if(null!==this.injectionOffsets)for(let n=0;n<this.injectionOffsets.length&&i>this.injectionOffsets[n];n++)i<this.injectionOffsets[n]+this.injectionOptions[n].content.length?i=this.injectionOffsets[n]:i-=this.injectionOptions[n].content.length;return i}translateToOutputPosition(e,t=2){let i=e;if(null!==this.injectionOffsets)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n])&&(1===t||e!==this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,o=0,r=0;for(;i<=n;){o=i+(n-i)/2|0;const s=this.breakOffsets[o];if(r=o>0?this.breakOffsets[o-1]:0,0===t)if(e<=r)n=o-1;else{if(!(e>s))break;i=o+1}else if(e<r)n=o-1;else{if(!(e>=s))break;i=o+1}}let s=e-r;return o>0&&(s+=this.wrappedTextIndentLength),new OutputPosition(o,s)}normalizeOutputPosition(e,t,i){if(null!==this.injectionOffsets){const n=this.outputPositionToOffsetInInputWithInjections(e,t),o=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(o!==n)return this.offsetInInputWithInjectionsToOutputPosition(o,i)}if(0===i){if(e>0&&t===this.getMinOutputOffset(e))return new OutputPosition(e-1,this.getMaxOutputOffset(e-1))}else if(1===i){if(e<this.getOutputLineCount()-1&&t===this.getMaxOutputOffset(e))return new OutputPosition(e+1,this.getMinOutputOffset(e+1))}return new OutputPosition(e,t)}outputPositionToOffsetInInputWithInjections(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));return(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(2===t){if(e===i.offsetInInputWithInjections+i.length&&hasRightCursorStop(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let e=i.offsetInInputWithInjections;if(hasLeftCursorStop(this.injectionOptions[i.injectedTextIndex].cursorStops))return e;let t=i.injectedTextIndex-1;for(;t>=0&&this.injectionOffsets[t]===this.injectionOffsets[i.injectedTextIndex]&&!hasRightCursorStop(this.injectionOptions[t].cursorStops)&&(e-=this.injectionOptions[t].content.length,!hasLeftCursorStop(this.injectionOptions[t].cursorStops));)t--;return e}}if(1===t){let e=i.offsetInInputWithInjections+i.length,t=i.injectedTextIndex;for(;t+1<this.injectionOffsets.length&&this.injectionOffsets[t+1]===this.injectionOffsets[t];)e+=this.injectionOptions[t+1].content.length,t++;return e}if(0===t){let e=i.offsetInInputWithInjections,t=i.injectedTextIndex;for(;t-1>=0&&this.injectionOffsets[t-1]===this.injectionOffsets[t];)e-=this.injectionOptions[t-1].content.length,t--;return e}assertNever()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(null!==t){let n=0;for(let o=0;o<t.length;o++){const r=i[o].content.length,s=t[o]+n,a=t[o]+n+r;if(s>e)break;if(e<=a)return{injectedTextIndex:o,offsetInInputWithInjections:s,length:r};n+=r}}}}function hasRightCursorStop(e){return null==e||(e===InjectedTextCursorStops$1.Right||e===InjectedTextCursorStops$1.Both)}function hasLeftCursorStop(e){return null==e||(e===InjectedTextCursorStops$1.Left||e===InjectedTextCursorStops$1.Both)}class OutputPosition{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new Position$1(e+this.outputLineIndex,this.outputOffset+1)}}class MonospaceLineBreaksComputerFactory{constructor(e,t){this.classifier=new WrappingCharacterClassifier(e,t)}static create(e){return new MonospaceLineBreaksComputerFactory(e.get(120),e.get(119))}createLineBreaksComputer(e,t,i,n){const o=[],r=[],s=[];return{addRequest:(e,t,i)=>{o.push(e),r.push(t),s.push(i)},finalize:()=>{const a=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,l=[];for(let e=0,d=o.length;e<d;e++){const d=r[e],c=s[e];!c||c.injectionOptions||d?l[e]=createLineBreaks$1(this.classifier,o[e],d,t,i,a,n):l[e]=createLineBreaksFromPreviousLineBreaks(this.classifier,c,o[e],t,i,a,n)}return arrPool1.length=0,arrPool2.length=0,l}}}}class WrappingCharacterClassifier extends CharacterClassifier{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let arrPool1=[],arrPool2=[];function createLineBreaksFromPreviousLineBreaks(e,t,i,n,o,r,s){if(-1===o)return null;const a=i.length;if(a<=1)return null;const l=t.breakOffsets,d=t.breakOffsetsVisibleColumn,c=computeWrappedTextIndentLength(i,n,o,r,s),h=o-c,u=arrPool1,g=arrPool2;let p=0,m=0,f=0,_=o;const C=l.length;let v=0;if(v>=0){let e=Math.abs(d[v]-_);for(;v+1<C;){const t=Math.abs(d[v+1]-_);if(t>=e)break;e=t,v++}}for(;v<C;){let t=v<0?0:l[v],o=v<0?0:d[v];m>t&&(t=m,o=f);let s=0,c=0,b=0,S=0;if(o<=_){let f=o,C=0===t?0:i.charCodeAt(t-1),v=0===t?0:e.get(C),y=!0;for(let o=t;o<a;o++){const t=o,a=i.charCodeAt(o);let l,d;if(isHighSurrogate(a)?(o++,l=0,d=2):(l=e.get(a),d=computeCharWidth(a,f,n,r)),t>m&&canBreak(C,v,a,l)&&(s=t,c=f),f+=d,f>_){t>m?(b=t,S=f-d):(b=o+1,S=f),f-c>h&&(s=0),y=!1;break}C=a,v=l}if(y){p>0&&(u[p]=l[l.length-1],g[p]=d[l.length-1],p++);break}}if(0===s){let a=o,l=i.charCodeAt(t),d=e.get(l),u=!1;for(let n=t-1;n>=m;n--){const t=n+1,o=i.charCodeAt(n);if(9===o){u=!0;break}let g,p;if(isLowSurrogate(o)?(n--,g=0,p=2):(g=e.get(o),p=isFullWidthCharacter(o)?r:1),a<=_){if(0===b&&(b=t,S=a),a<=_-h)break;if(canBreak(o,g,l,d)){s=t,c=a;break}}a-=p,l=o,d=g}if(0!==s){const e=h-(S-c);if(e<=n){const t=i.charCodeAt(b);let o;o=isHighSurrogate(t)?2:computeCharWidth(t,S,n,r),e-o<0&&(s=0)}}if(u){v--;continue}}if(0===s&&(s=b,c=S),s<=m){const e=i.charCodeAt(m);isHighSurrogate(e)?(s=m+2,c=f+2):(s=m+1,c=f+computeCharWidth(e,f,n,r))}for(m=s,u[p]=s,f=c,g[p]=c,p++,_=c+h;v<0||v<C&&d[v]<c;)v++;let y=Math.abs(d[v]-_);for(;v+1<C;){const e=Math.abs(d[v+1]-_);if(e>=y)break;y=e,v++}}return 0===p?null:(u.length=p,g.length=p,arrPool1=t.breakOffsets,arrPool2=t.breakOffsetsVisibleColumn,t.breakOffsets=u,t.breakOffsetsVisibleColumn=g,t.wrappedTextIndentLength=c,t)}function createLineBreaks$1(e,t,i,n,o,r,s){const a=LineInjectedText.applyInjectedText(t,i);let l,d;if(i&&i.length>0?(l=i.map((e=>e.options)),d=i.map((e=>e.column-1))):(l=null,d=null),-1===o)return l?new ModelLineProjectionData(d,l,[a.length],[],0):null;const c=a.length;if(c<=1)return l?new ModelLineProjectionData(d,l,[a.length],[],0):null;const h=computeWrappedTextIndentLength(a,n,o,r,s),u=o-h,g=[],p=[];let m=0,f=0,_=0,C=o,v=a.charCodeAt(0),b=e.get(v),S=computeCharWidth(v,0,n,r),y=1;isHighSurrogate(v)&&(S+=1,v=a.charCodeAt(1),b=e.get(v),y++);for(let w=y;w<c;w++){const t=w,i=a.charCodeAt(w);let o,s;isHighSurrogate(i)?(w++,o=0,s=2):(o=e.get(i),s=computeCharWidth(i,S,n,r)),canBreak(v,b,i,o)&&(f=t,_=S),S+=s,S>C&&((0===f||S-_>u)&&(f=t,_=S-s),g[m]=f,p[m]=_,m++,C=_+u,f=0),v=i,b=o}return 0!==m||i&&0!==i.length?(g[m]=c,p[m]=S,new ModelLineProjectionData(d,l,g,p,h)):null}function computeCharWidth(e,t,i,n){return 9===e?i-t%i:isFullWidthCharacter(e)||e<32?n:1}function tabCharacterWidth(e,t){return t-e%t}function canBreak(e,t,i,n){return 32!==i&&(2===t||3===t&&2!==n||1===n||3===n&&1!==t)}function computeWrappedTextIndentLength(e,t,i,n,o){let r=0;if(0!==o){const s=firstNonWhitespaceIndex(e);if(-1!==s){for(let i=0;i<s;i++){r+=9===e.charCodeAt(i)?tabCharacterWidth(r,t):1}const a=3===o?2:2===o?1:0;for(let e=0;e<a;e++){r+=tabCharacterWidth(r,t)}r+n>i&&(r=0)}}return r}var _a$a;const ttPolicy$4=null===(_a$a=window.trustedTypes)||void 0===_a$a?void 0:_a$a.createPolicy("domLineBreaksComputer",{createHTML:e=>e});class DOMLineBreaksComputerFactory{static create(){return new DOMLineBreaksComputerFactory}constructor(){}createLineBreaksComputer(e,t,i,n){const o=[],r=[];return{addRequest:(e,t,i)=>{o.push(e),r.push(t)},finalize:()=>createLineBreaks(o,e,t,i,n,r)}}}function createLineBreaks(e,t,i,n,o,r){var s;function a(t){const i=r[t];if(i){const n=LineInjectedText.applyInjectedText(e[t],i),o=i.map((e=>e.options)),r=i.map((e=>e.column-1));return new ModelLineProjectionData(r,o,[n.length],[],0)}return null}if(-1===n){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=a(i);return t}const l=Math.round(n*t.typicalHalfwidthCharacterWidth),d=3===o?2:2===o?1:0,c=Math.round(i*d),h=Math.ceil(t.spaceWidth*c),u=document.createElement("div");applyFontInfo(u,t);const g=createStringBuilder(1e4),p=[],m=[],f=[],_=[],C=[];for(let E=0;E<e.length;E++){const n=LineInjectedText.applyInjectedText(e[E],r[E]);let s=0,a=0,d=l;if(0!==o)if(s=firstNonWhitespaceIndex(n),-1===s)s=0;else{for(let t=0;t<s;t++){a+=9===n.charCodeAt(t)?i-a%i:1}const e=Math.ceil(t.spaceWidth*a);e+t.typicalFullwidthCharacterWidth>l?(s=0,a=0):d=l-e}const c=n.substr(s),u=renderLine(c,a,i,d,g,h);p[E]=s,m[E]=a,f[E]=c,_[E]=u[0],C[E]=u[1]}const v=g.build(),b=null!==(s=null==ttPolicy$4?void 0:ttPolicy$4.createHTML(v))&&void 0!==s?s:v;u.innerHTML=b,u.style.position="absolute",u.style.top="10000",u.style.wordWrap="break-word",document.body.appendChild(u);const S=document.createRange(),y=Array.prototype.slice.call(u.children,0),w=[];for(let E=0;E<e.length;E++){const e=readLineBreaks(S,y[E],f[E],_[E]);if(null===e){w[E]=a(E);continue}const t=p[E],i=m[E]+c,n=C[E],o=[];for(let r=0,a=e.length;r<a;r++)o[r]=n[e[r]];if(0!==t)for(let r=0,a=e.length;r<a;r++)e[r]+=t;let s,l;const d=r[E];d?(s=d.map((e=>e.options)),l=d.map((e=>e.column-1))):(s=null,l=null),w[E]=new ModelLineProjectionData(l,s,e,o,i)}return document.body.removeChild(u),w}function renderLine(e,t,i,n,o,r){if(0!==r){const e=String(r);o.appendASCIIString('<div style="text-indent: -'),o.appendASCIIString(e),o.appendASCIIString("px; padding-left: "),o.appendASCIIString(e),o.appendASCIIString("px; box-sizing: border-box; width:")}else o.appendASCIIString('<div style="width:');o.appendASCIIString(String(n)),o.appendASCIIString('px;">');const s=e.length;let a=t,l=0;const d=[],c=[];let h=0<s?e.charCodeAt(0):0;o.appendASCIIString("<span>");for(let u=0;u<s;u++){0!==u&&u%16384==0&&o.appendASCIIString("</span><span>"),d[u]=l,c[u]=a;const t=h;h=u+1<s?e.charCodeAt(u+1):0;let n=1,r=1;switch(t){case 9:n=i-a%i,r=n;for(let e=1;e<=n;e++)e<n?o.write1(160):o.appendASCII(32);break;case 32:32===h?o.write1(160):o.appendASCII(32);break;case 60:o.appendASCIIString("&lt;");break;case 62:o.appendASCIIString("&gt;");break;case 38:o.appendASCIIString("&amp;");break;case 0:o.appendASCIIString("&#00;");break;case 65279:case 8232:case 8233:case 133:o.write1(65533);break;default:isFullWidthCharacter(t)&&r++,t<32?o.write1(9216+t):o.write1(t)}l+=n,a+=r}return o.appendASCIIString("</span>"),d[e.length]=l,c[e.length]=a,o.appendASCIIString("</div>"),[d,c]}function readLineBreaks(e,t,i,n){if(i.length<=1)return null;const o=Array.prototype.slice.call(t.children,0),r=[];try{discoverBreaks(e,o,n,0,null,i.length-1,null,r)}catch(s){return null}return 0===r.length?null:(r.push(i.length),r)}function discoverBreaks(e,t,i,n,o,r,s,a){if(n===r)return;if(o=o||readClientRect(e,t,i[n],i[n+1]),s=s||readClientRect(e,t,i[r],i[r+1]),Math.abs(o[0].top-s[0].top)<=.1)return;if(n+1===r)return void a.push(r);const l=n+(r-n)/2|0,d=readClientRect(e,t,i[l],i[l+1]);discoverBreaks(e,t,i,n,o,l,d,a),discoverBreaks(e,t,i,l,d,r,s,a)}function readClientRect(e,t,i,n){return e.setStart(t[i/16384|0].firstChild,i%16384),e.setEnd(t[n/16384|0].firstChild,n%16384),e.getClientRects()}const ILanguageFeaturesService=createDecorator("ILanguageFeaturesService");var __decorate$1v=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1q=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let EDITOR_ID=0;class ModelData$1{constructor(e,t,i,n,o){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=o}dispose(){dispose(this.listenersToRemove),this.model.onBeforeDetached(),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let CodeEditorWidget=class e extends Disposable{constructor(e,t,i,n,o,r,s,a,l,d,c,h){super(),this.languageConfigurationService=c,this._onDidDispose=this._register(new Emitter$1),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new Emitter$1),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new Emitter$1),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new Emitter$1),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new Emitter$1),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new Emitter$1),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeConfiguration=this._register(new Emitter$1),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new Emitter$1),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new Emitter$1),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new Emitter$1),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Emitter$1),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new Emitter$1),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new BooleanEventEmitter),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new BooleanEventEmitter),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Emitter$1),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Emitter$1),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Emitter$1),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Emitter$1),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Emitter$1),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Emitter$1),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Emitter$1),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Emitter$1),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Emitter$1),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Emitter$1),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onContextMenu=this._register(new Emitter$1),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Emitter$1),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Emitter$1),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Emitter$1),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Emitter$1),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new Emitter$1),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new Emitter$1),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new Emitter$1),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new Emitter$1),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._bannerDomNode=null;const u=Object.assign({},t);let g;this._domElement=e,this._overflowWidgetsDomNode=u.overflowWidgetsDomNode,delete u.overflowWidgetsDomNode,this._id=++EDITOR_ID,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,u,d)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const t=this._configuration.options;if(e.hasChanged(131)){const e=t.get(131);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(s.createScoped(this._domElement)),this._notificationService=l,this._codeEditorService=o,this._commandService=r,this._themeService=a,this._register(new EditorContextKeysManager(this,this._contextKeyService)),this._register(new EditorModeContext(this,this._contextKeyService,h)),this._instantiationService=n.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService])),this._modelData=null,this._contributions={},this._actions={},this._focusTracker=new CodeEditorWidgetFocusTracker(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},g=Array.isArray(i.contributions)?i.contributions:EditorExtensionsRegistry.getEditorContributions();for(const m of g)if(this._contributions[m.id])onUnexpectedError(new Error(`Cannot have two contributions with the same id ${m.id}`));else try{const e=this._instantiationService.createInstance(m.ctor,this);this._contributions[m.id]=e}catch(p){onUnexpectedError(p)}EditorExtensionsRegistry.getEditorActions().forEach((e=>{if(this._actions[e.id])return void onUnexpectedError(new Error(`Cannot have two actions with the same id ${e.id}`));const t=new InternalEditorAction(e.id,e.label,e.alias,withNullAsUndefined(e.precondition),(()=>this._instantiationService.invokeFunction((t=>Promise.resolve(e.runEditorCommand(t,this,null))))),this._contextKeyService);this._actions[t.id]=t})),this._codeEditorService.addCodeEditor(this)}get isSimpleWidget(){return this._configuration.isSimpleWidget}_createConfiguration(e,t,i){return new EditorConfiguration(e,t,this._domElement,i)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return EditorType.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose();const e=Object.keys(this._contributions);for(let t=0,i=e.length;t<i;t++){const i=e[t];this._contributions[i].dispose()}this._contributions={},this._actions={},this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?WordOperations.getWordAtPosition(this._modelData.model,this._configuration.options.get(117),e):null}getValue(e=null){if(!this._modelData)return"";const t=!(!e||!e.preserveBOM);let i=0;return e&&e.lineEnding&&"\n"===e.lineEnding?i=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const t=e;if(null===this._modelData&&null===t)return;if(this._modelData&&this._modelData.model===t)return;const i=this.hasTextFocus(),n=this._detachModel();this._attachModel(t),i&&this.hasModel()&&this.focus();const o={oldModelUrl:n?n.uri:null,newModelUrl:t?t.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(o),this._postDetachModelCleanup(n)}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(let e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(let i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetForPosition(e,t,i){const n=e.model.validatePosition({lineNumber:t,column:i}),o=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(n);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(o.lineNumber)}getTopForLineNumber(t){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,1):-1}getTopForPosition(t,i){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,t,i):-1}setHiddenAreas(e){this._modelData&&this._modelData.viewModel.setHiddenAreas(e.map((e=>Range$2.lift(e))))}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return CursorColumns.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!Position$1.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!Range$2.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",i,r,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if("number"!=typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!Position$1.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=Selection$1.isISelection(e),n=Range$2.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const i={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(i,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new Selection$1(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if("number"!=typeof e||"number"!=typeof t)throw new Error("Invalid arguments");this._sendRevealRange(new Range$2(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!Range$2.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(Range$2.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let t=0,i=e.length;t<i;t++)if(!Selection$1.isISelection(e[t]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if("number"!=typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}saveViewState(){if(!this._modelData)return null;const e={},t=Object.keys(this._contributions);for(const i of t){const t=this._contributions[i];"function"==typeof t.saveViewState&&(e[i]=t.saveViewState())}return{cursorState:this._modelData.viewModel.saveCursorState(),viewState:this._modelData.viewModel.saveState(),contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const e=t.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]);const i=t.contributionsState||{},n=Object.keys(this._contributions);for(let t=0,r=n.length;t<r;t++){const e=n[t],o=this._contributions[e];"function"==typeof o.restoreViewState&&o.restoreViewState(i[e])}const o=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(o)}}getContribution(e){return this._contributions[e]||null}getActions(){const e=[],t=Object.keys(this._actions);for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(this._actions[n])}return e}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions[e]||null}trigger(e,t,i){switch(i=i||{},t){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const t=i;return void this._type(e,t.text||"")}case"replacePreviousChar":{const t=i;return void this._compositionType(e,t.text||"",t.replaceCharCnt||0,0,0)}case"compositionType":{const t=i;return void this._compositionType(e,t.text||"",t.replacePrevCharCnt||0,t.replaceNextCharCnt||0,t.positionDelta||0)}case"paste":{const t=i;return void this._paste(e,t.text||"",t.pasteOnNewLine||!1,t.multicursorText||null,t.mode||null)}case"cut":return void this._cut(e)}const n=this.getAction(t);n?Promise.resolve(n.run()).then(void 0,onUnexpectedError):this._modelData&&(this._triggerEditorCommand(e,t,i)||this._triggerCommand(t,i))}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){this._modelData&&0!==t.length&&("keyboard"===e&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),"keyboard"===e&&this._onDidType.fire(t))}_compositionType(e,t,i,n,o){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,o,e)}_paste(e,t,i,n,o){if(!this._modelData||0===t.length)return;const r=this._modelData.viewModel.getSelection().getStartPosition();this._modelData.viewModel.paste(t,i,n,e);const s=this._modelData.viewModel.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new Range$2(r.lineNumber,r.column,s.lineNumber,s.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=EditorExtensionsRegistry.getEditorCommand(t);return!!n&&((i=i||{}).source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(n.runEditorCommand(e,this,i)).then(void 0,onUnexpectedError)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(81)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(81)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,t,i){if(!this._modelData)return!1;if(this._configuration.options.get(81))return!1;let n;return n=i?Array.isArray(i)?()=>i:i:()=>null,this._modelData.viewModel.executeEdits(e,t,n),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,filterValidationDecorations(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,filterValidationDecorations(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?0===e.length&&0===t.length?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){const t=this._decorationTypeKeysToIds[e];t&&this.deltaDecorations(t,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(131)}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarMouseDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarMouseDown(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const e=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId()),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const e=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,t):null}getScrolledVisiblePosition(t){if(!this._modelData||!this._modelData.hasRealView)return null;const i=this._modelData.model.validatePosition(t),n=this._configuration.options,o=n.get(131);return{top:e._getVerticalOffsetForPosition(this._modelData,i.lineNumber,i.column)-this.getScrollTop(),left:this._modelData.view.getOffsetForColumn(i.lineNumber,i.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft(),height:n.get(59)}}getOffsetForColumn(e,t){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,t):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){applyFontInfo(e,this._configuration.options.get(44))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount()),e.onBeforeAttached();const i=new ViewModel(this._id,this._configuration,e,DOMLineBreaksComputerFactory.create(),MonospaceLineBreaksComputerFactory.create(this._configuration.options),(e=>scheduleAtNextAnimationFrame(e)),this.languageConfigurationService,this._themeService);t.push(e.onDidChangeDecorations((e=>this._onDidChangeModelDecorations.fire(e)))),t.push(e.onDidChangeLanguage((t=>{this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(t)}))),t.push(e.onDidChangeLanguageConfiguration((e=>this._onDidChangeModelLanguageConfiguration.fire(e)))),t.push(e.onDidChangeContent((e=>this._onDidChangeModelContent.fire(e)))),t.push(e.onDidChangeOptions((e=>this._onDidChangeModelOptions.fire(e)))),t.push(e.onWillDispose((()=>this.setModel(null)))),t.push(i.onEvent((e=>{switch(e.kind){case 0:this._onDidContentSizeChange.fire(e);break;case 1:this._editorTextFocus.setValue(e.hasFocus);break;case 2:this._onDidScrollChange.fire(e);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{e.reachedMaxCursorCount&&this._notificationService.warn(localize("cursors.maximum","The number of cursors has been limited to {0}.",CursorsController.MAX_CURSOR_COUNT));const t=[];for(let o=0,r=e.selections.length;o<r;o++)t[o]=e.selections[o].getPosition();const i={position:t[0],secondaryPositions:t.slice(1),reason:e.reason,source:e.source};this._onDidChangeCursorPosition.fire(i);const n={selection:e.selections[0],secondarySelections:e.selections.slice(1),modelVersionId:e.modelVersionId,oldSelections:e.oldSelections,oldModelVersionId:e.oldModelVersionId,source:e.source,reason:e.reason};this._onDidChangeCursorSelection.fire(n);break}}})));const[n,o]=this._createView(i);if(o){this._domElement.appendChild(n.domNode.domNode);let t=Object.keys(this._contentWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];n.addContentWidget(this._contentWidgets[i])}t=Object.keys(this._overlayWidgets);for(let e=0,i=t.length;e<i;e++){const i=t[e];n.addOverlayWidget(this._overlayWidgets[i])}n.render(!1,!0),n.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new ModelData$1(e,i,n,o,t)}_createView(e){let t;t=this.isSimpleWidget?{paste:(e,t,i,n)=>{this._paste("keyboard",e,t,i,n)},type:e=>{this._type("keyboard",e)},compositionType:(e,t,i,n)=>{this._compositionType("keyboard",e,t,i,n)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,t,i,n)=>{const o={text:e,pasteOnNewLine:t,multicursorText:i,mode:n};this._commandService.executeCommand("paste",o)},type:e=>{const t={text:e};this._commandService.executeCommand("type",t)},compositionType:(e,t,i,n)=>{if(i||n){const o={text:e,replacePrevCharCnt:t,replaceNextCharCnt:i,positionDelta:n};this._commandService.executeCommand("compositionType",o)}else{const i={text:e,replaceCharCnt:t};this._commandService.executeCommand("replacePreviousChar",i)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new ViewUserInputEvents(e.coordinatesConverter);i.onKeyDown=e=>this._onKeyDown.fire(e),i.onKeyUp=e=>this._onKeyUp.fire(e),i.onContextMenu=e=>this._onContextMenu.fire(e),i.onMouseMove=e=>this._onMouseMove.fire(e),i.onMouseLeave=e=>this._onMouseLeave.fire(e),i.onMouseDown=e=>this._onMouseDown.fire(e),i.onMouseUp=e=>this._onMouseUp.fire(e),i.onMouseDrag=e=>this._onMouseDrag.fire(e),i.onMouseDrop=e=>this._onMouseDrop.fire(e),i.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),i.onMouseWheel=e=>this._onMouseWheel.fire(e);return[new View(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode),!0]}_postDetachModelCleanup(e){e&&e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&this._domElement.removeChild(t),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}};CodeEditorWidget=__decorate$1v([__param$1q(3,IInstantiationService),__param$1q(4,ICodeEditorService),__param$1q(5,ICommandService),__param$1q(6,IContextKeyService),__param$1q(7,IThemeService),__param$1q(8,INotificationService),__param$1q(9,IAccessibilityService),__param$1q(10,ILanguageConfigurationService),__param$1q(11,ILanguageFeaturesService)],CodeEditorWidget);class BooleanEventEmitter extends Disposable{constructor(){super(),this._onDidChangeToTrue=this._register(new Emitter$1),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new Emitter$1),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class EditorContextKeysManager extends Disposable{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=EditorContextKeys.editorSimpleInput.bindTo(t),this._editorFocus=EditorContextKeys.focus.bindTo(t),this._textInputFocus=EditorContextKeys.textInputFocus.bindTo(t),this._editorTextFocus=EditorContextKeys.editorTextFocus.bindTo(t),this._editorTabMovesFocus=EditorContextKeys.tabMovesFocus.bindTo(t),this._editorReadonly=EditorContextKeys.readOnly.bindTo(t),this._inDiffEditor=EditorContextKeys.inDiffEditor.bindTo(t),this._editorColumnSelection=EditorContextKeys.columnSelection.bindTo(t),this._hasMultipleSelections=EditorContextKeys.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=EditorContextKeys.hasNonEmptySelection.bindTo(t),this._canUndo=EditorContextKeys.canUndo.bindTo(t),this._canRedo=EditorContextKeys.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(e.get(130)),this._editorReadonly.set(e.get(81)),this._inDiffEditor.set(e.get(54)),this._editorColumnSelection.set(e.get(18))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class EditorModeContext extends Disposable{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=EditorContextKeys.languageId.bindTo(t),this._hasCompletionItemProvider=EditorContextKeys.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=EditorContextKeys.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=EditorContextKeys.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=EditorContextKeys.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=EditorContextKeys.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=EditorContextKeys.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=EditorContextKeys.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=EditorContextKeys.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=EditorContextKeys.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=EditorContextKeys.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=EditorContextKeys.hasReferenceProvider.bindTo(t),this._hasRenameProvider=EditorContextKeys.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=EditorContextKeys.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=EditorContextKeys.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=EditorContextKeys.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=EditorContextKeys.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=EditorContextKeys.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=EditorContextKeys.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInWalkThrough=EditorContextKeys.isInWalkThroughSnippet.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===Schemas.walkThroughSnippet)})):this.reset()}}class CodeEditorWidgetFocusTracker extends Disposable{constructor(e){super(),this._onChange=this._register(new Emitter$1),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(trackFocus(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}const squigglyStart=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),squigglyEnd=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function getSquigglySVGData(e){return squigglyStart+encodeURIComponent(e.toString())+squigglyEnd}const dotdotdotStart=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),dotdotdotEnd=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function getDotDotDotSVGData(e){return dotdotdotStart+encodeURIComponent(e.toString())+dotdotdotEnd}registerThemingParticipant(((e,t)=>{const i=e.getColor(editorErrorBorder);i&&t.addRule(`.monaco-editor .squiggly-error { border-bottom: 4px double ${i}; }`);const n=e.getColor(editorErrorForeground);n&&t.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${getSquigglySVGData(n)}") repeat-x bottom left; }`);const o=e.getColor(editorErrorBackground);o&&t.addRule(`.monaco-editor .squiggly-error::before { display: block; content: ''; width: 100%; height: 100%; background: ${o}; }`);const r=e.getColor(editorWarningBorder);r&&t.addRule(`.monaco-editor .squiggly-warning { border-bottom: 4px double ${r}; }`);const s=e.getColor(editorWarningForeground);s&&t.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${getSquigglySVGData(s)}") repeat-x bottom left; }`);const a=e.getColor(editorWarningBackground);a&&t.addRule(`.monaco-editor .squiggly-warning::before { display: block; content: ''; width: 100%; height: 100%; background: ${a}; }`);const l=e.getColor(editorInfoBorder);l&&t.addRule(`.monaco-editor .squiggly-info { border-bottom: 4px double ${l}; }`);const d=e.getColor(editorInfoForeground);d&&t.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${getSquigglySVGData(d)}") repeat-x bottom left; }`);const c=e.getColor(editorInfoBackground);c&&t.addRule(`.monaco-editor .squiggly-info::before { display: block; content: ''; width: 100%; height: 100%; background: ${c}; }`);const h=e.getColor(editorHintBorder);h&&t.addRule(`.monaco-editor .squiggly-hint { border-bottom: 2px dotted ${h}; }`);const u=e.getColor(editorHintForeground);u&&t.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${getDotDotDotSVGData(u)}") no-repeat bottom left; }`);const g=e.getColor(editorUnnecessaryCodeOpacity);g&&t.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${g.rgba.a}; }`);const p=e.getColor(editorUnnecessaryCodeBorder);p&&t.addRule(`.monaco-editor.showUnused .squiggly-unnecessary { border-bottom: 2px dashed ${p}; }`);const m=e.getColor(editorForeground)||"inherit";t.addRule(`.monaco-editor.showDeprecated .squiggly-inline-deprecated { text-decoration: line-through; text-decoration-color: ${m}}`)}));var diffEditor="";class DomEmitter{constructor(e,t,i){const n=e=>this.emitter.fire(e);this.emitter=new Emitter$1({onFirstListenerAdd:()=>e.addEventListener(t,n,i),onLastListenerRemove:()=>e.removeEventListener(t,n,i)})}get event(){return this.emitter.event}dispose(){this.emitter.dispose()}}function stopEvent(e){return e.preventDefault(),e.stopPropagation(),e}var sash="",__decorate$1u=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};let DEBUG=!1;var OrthogonalEdge,OrthogonalEdge2;OrthogonalEdge2=OrthogonalEdge||(OrthogonalEdge={}),OrthogonalEdge2.North="north",OrthogonalEdge2.South="south",OrthogonalEdge2.East="east",OrthogonalEdge2.West="west";let globalSize=4;const onDidChangeGlobalSize=new Emitter$1;let globalHoverDelay=300;const onDidChangeHoverDelay=new Emitter$1;class MouseEventFactory{constructor(){this.disposables=new DisposableStore}get onPointerMove(){return this.disposables.add(new DomEmitter(window,"mousemove")).event}get onPointerUp(){return this.disposables.add(new DomEmitter(window,"mouseup")).event}dispose(){this.disposables.dispose()}}__decorate$1u([memoize],MouseEventFactory.prototype,"onPointerMove",null),__decorate$1u([memoize],MouseEventFactory.prototype,"onPointerUp",null);class GestureEventFactory{constructor(e){this.el=e,this.disposables=new DisposableStore}get onPointerMove(){return this.disposables.add(new DomEmitter(this.el,EventType.Change)).event}get onPointerUp(){return this.disposables.add(new DomEmitter(this.el,EventType.End)).event}dispose(){this.disposables.dispose()}}__decorate$1u([memoize],GestureEventFactory.prototype,"onPointerMove",null),__decorate$1u([memoize],GestureEventFactory.prototype,"onPointerUp",null);class OrthogonalPointerEventFactory{constructor(e){this.factory=e}get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}dispose(){}}__decorate$1u([memoize],OrthogonalPointerEventFactory.prototype,"onPointerMove",null),__decorate$1u([memoize],OrthogonalPointerEventFactory.prototype,"onPointerUp",null);const PointerEventsDisabledCssClass="pointer-events-disabled";class Sash extends Disposable{constructor(e,t,i){super(),this.hoverDelay=globalHoverDelay,this.hoverDelayer=this._register(new Delayer(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new Emitter$1),this._onDidStart=this._register(new Emitter$1),this._onDidChange=this._register(new Emitter$1),this._onDidReset=this._register(new Emitter$1),this._onDidEnd=this._register(new Emitter$1),this.orthogonalStartSashDisposables=this._register(new DisposableStore),this.orthogonalStartDragHandleDisposables=this._register(new DisposableStore),this.orthogonalEndSashDisposables=this._register(new DisposableStore),this.orthogonalEndDragHandleDisposables=this._register(new DisposableStore),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=append$1(e,$$c(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),isMacintosh&&this.el.classList.add("mac");const n=this._register(new DomEmitter(this.el,"mousedown")).event;this._register(n((e=>this.onPointerStart(e,new MouseEventFactory)),this));const o=this._register(new DomEmitter(this.el,"dblclick")).event;this._register(o(this.onPointerDoublePress,this));const r=this._register(new DomEmitter(this.el,"mouseenter")).event;this._register(r((()=>Sash.onMouseEnter(this))));const s=this._register(new DomEmitter(this.el,"mouseleave")).event;this._register(s((()=>Sash.onMouseLeave(this)))),this._register(Gesture.addTarget(this.el));const a=Event$1.map(this._register(new DomEmitter(this.el,EventType.Start)).event,(e=>{var t;return Object.assign(Object.assign({},e),{target:null!==(t=e.initialTarget)&&void 0!==t?t:null})}));this._register(a((e=>this.onPointerStart(e,new GestureEventFactory(this.el))),this));const l=this._register(new DomEmitter(this.el,EventType.Tap)).event,d=Event$1.map(Event$1.filter(Event$1.debounce(l,((e,t)=>{var i;return{event:t,count:(null!==(i=null==e?void 0:e.count)&&void 0!==i?i:0)+1}}),250),(({count:e})=>2===e)),(({event:e})=>{var t;return Object.assign(Object.assign({},e),{target:null!==(t=e.initialTarget)&&void 0!==t?t:null})}));this._register(d(this.onPointerDoublePress,this)),"number"==typeof i.size?(this.size=i.size,0===i.orientation?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=globalSize,this._register(onDidChangeGlobalSize.event((e=>{this.size=e,this.layout()})))),this._register(onDidChangeHoverDelay.event((e=>this.hoverDelay=e))),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,1===this.orientation?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",DEBUG),this.layout()}get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",0===e),this.el.classList.toggle("minimum",1===e),this.el.classList.toggle("maximum",2===e),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=t=>{this.orthogonalStartDragHandleDisposables.clear(),0!==t&&(this._orthogonalStartDragHandle=append$1(this.el,$$c(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(toDisposable((()=>this._orthogonalStartDragHandle.remove()))),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseenter")).event((()=>Sash.onMouseEnter(e)),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new DomEmitter(this._orthogonalStartDragHandle,"mouseleave")).event((()=>Sash.onMouseLeave(e)),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}set orthogonalEndSash(e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=t=>{this.orthogonalEndDragHandleDisposables.clear(),0!==t&&(this._orthogonalEndDragHandle=append$1(this.el,$$c(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(toDisposable((()=>this._orthogonalEndDragHandle.remove()))),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseenter")).event((()=>Sash.onMouseEnter(e)),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new DomEmitter(this._orthogonalEndDragHandle,"mouseleave")).event((()=>Sash.onMouseLeave(e)),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}onPointerStart(e,t){EventHelper.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const n=this.getOrthogonalSash(e);n&&(i=!0,e.__orthogonalSashEvent=!0,n.onPointerStart(e,new OrthogonalPointerEventFactory(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new OrthogonalPointerEventFactory(t))),!this.state)return;const n=getElementsByTagName("iframe");for(const h of n)h.classList.add(PointerEventsDisabledCssClass);const o=e.pageX,r=e.pageY,s=e.altKey,a={startX:o,currentX:o,startY:r,currentY:r,altKey:s};this.el.classList.add("active"),this._onDidStart.fire(a);const l=createStyleSheet(this.el),d=()=>{let e="";e=i?"all-scroll":1===this.orientation?1===this.state?"s-resize":2===this.state?"n-resize":isMacintosh?"row-resize":"ns-resize":1===this.state?"e-resize":2===this.state?"w-resize":isMacintosh?"col-resize":"ew-resize",l.textContent=`* { cursor: ${e} !important; }`},c=new DisposableStore;d(),i||this.onDidEnablementChange.event(d,null,c);t.onPointerMove((e=>{EventHelper.stop(e,!1);const t={startX:o,currentX:e.pageX,startY:r,currentY:e.pageY,altKey:s};this._onDidChange.fire(t)}),null,c),t.onPointerUp((e=>{EventHelper.stop(e,!1),this.el.removeChild(l),this.el.classList.remove("active"),this._onDidEnd.fire(),c.dispose();for(const t of n)t.classList.remove(PointerEventsDisabledCssClass)}),null,c),c.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger((()=>e.el.classList.add("hover")),e.hoverDelay).then(void 0,(()=>{})),!t&&e.linkedSash&&Sash.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Sash.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Sash.onMouseLeave(this)}layout(){if(0===this.orientation){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){if(e.target&&e.target instanceof HTMLElement)return e.target.classList.contains("orthogonal-drag-handle")?e.target.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash:void 0}dispose(){super.dispose(),this.el.remove()}}class StableEditorScrollState{constructor(e,t,i){this._visiblePosition=e,this._visiblePositionScrollDelta=t,this._cursorPosition=i}static capture(e){let t=null,i=0;if(0!==e.getScrollTop()){const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const o=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-o}}return new StableEditorScrollState(t,i,e.getPosition())}restore(e){if(this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i)}}var diffReview="";const DataTransfers={RESOURCES:"ResourceURLs",DOWNLOAD_URL:"DownloadURL",FILES:"Files",TEXT:Mimes.text,TERMINALS:"Terminals"};class DragAndDropData{constructor(e){this.data=e}update(){}getData(){return this.data}}const StaticDND={CurrentDragAndDropData:void 0};var actionbar="";class BaseActionViewItem extends Disposable{constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof Action&&this._register(t.onDidChange((e=>{this.element&&this.handleActionChangeEvent(e)})))}handleActionChangeEvent(e){void 0!==e.enabled&&this.updateEnabled(),void 0!==e.checked&&this.updateChecked(),void 0!==e.class&&this.updateClass(),void 0!==e.label&&(this.updateLabel(),this.updateTooltip()),void 0!==e.tooltip&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new ActionRunner)),this._actionRunner}set actionRunner(e){this._actionRunner=e}getAction(){return this._action}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Gesture.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,isFirefox&&this._register(addDisposableListener(e,EventType$1.DRAG_START,(e=>{var t;return null===(t=e.dataTransfer)||void 0===t?void 0:t.setData(DataTransfers.TEXT,this._action.label)})))),this._register(addDisposableListener(t,EventType.Tap,(e=>this.onClick(e,!0)))),this._register(addDisposableListener(t,EventType$1.MOUSE_DOWN,(e=>{i||EventHelper.stop(e,!0),this._action.enabled&&0===e.button&&t.classList.add("active")}))),isMacintosh&&this._register(addDisposableListener(t,EventType$1.CONTEXT_MENU,(e=>{0===e.button&&!0===e.ctrlKey&&this.onClick(e)}))),this._register(addDisposableListener(t,EventType$1.CLICK,(e=>{EventHelper.stop(e,!0),this.options&&this.options.isMenu||this.onClick(e)}))),this._register(addDisposableListener(t,EventType$1.DBLCLICK,(e=>{EventHelper.stop(e,!0)}))),[EventType$1.MOUSE_UP,EventType$1.MOUSE_OUT].forEach((e=>{this._register(addDisposableListener(t,e,(e=>{EventHelper.stop(e),t.classList.remove("active")})))}))}onClick(e,t=!1){var i;EventHelper.stop(e,!0);const n=isUndefinedOrNull(this._context)?(null===(i=this.options)||void 0===i?void 0:i.useEventAsContext)?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,n)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}updateTooltip(){}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),super.dispose()}}class ActionViewItem extends BaseActionViewItem{constructor(e,t,i={}){super(e,t,i),this.options=i,this.options.icon=void 0!==i.icon&&i.icon,this.options.label=void 0===i.label||i.label,this.cssClass=""}render(e){super.render(e),this.element&&(this.label=append$1(this.element,$$c("a.action-label"))),this.label&&(this._action.id===Separator.ID?this.label.setAttribute("role","presentation"):this.options.isMenu?this.label.setAttribute("role","menuitem"):this.label.setAttribute("role","button")),this.options.label&&this.options.keybinding&&this.element&&(append$1(this.element,$$c("span.keybinding")).textContent=this.options.keybinding),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.getAction().label)}updateTooltip(){let e=null;this.getAction().tooltip?e=this.getAction().tooltip:!this.options.label&&this.getAction().label&&this.options.icon&&(e=this.getAction().label,this.options.keybinding&&(e=localize({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e&&this.label&&(this.label.title=e)}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getAction().class,this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label&&this.label.classList.remove("codicon")}updateEnabled(){this.getAction().enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element&&this.element.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element&&this.element.classList.add("disabled"))}updateChecked(){this.label&&(this.getAction().checked?this.label.classList.add("checked"):this.label.classList.remove("checked"))}}var __awaiter$12=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class ActionBar extends Disposable{constructor(e,t={}){var i,n,o,r,s,a;let l,d;switch(super(),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new Emitter$1),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new Emitter$1({onFirstListenerAdd:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new Emitter$1),this.onDidRun=this._onDidRun.event,this._onBeforeRun=this._register(new Emitter$1),this.onBeforeRun=this._onBeforeRun.event,this.options=t,this._context=null!==(i=t.context)&&void 0!==i?i:null,this._orientation=null!==(n=this.options.orientation)&&void 0!==n?n:0,this._triggerKeys={keyDown:null!==(r=null===(o=this.options.triggerKeys)||void 0===o?void 0:o.keyDown)&&void 0!==r&&r,keys:null!==(a=null===(s=this.options.triggerKeys)||void 0===s?void 0:s.keys)&&void 0!==a?a:[3,10]},this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new ActionRunner,this._register(this._actionRunner)),this._register(this._actionRunner.onDidRun((e=>this._onDidRun.fire(e)))),this._register(this._actionRunner.onBeforeRun((e=>this._onBeforeRun.fire(e)))),this._actionIds=[],this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar",!1!==t.animated&&this.domNode.classList.add("animated"),this._orientation){case 0:l=[15],d=[17];break;case 1:l=[16],d=[18],this.domNode.className+=" vertical"}this._register(addDisposableListener(this.domNode,EventType$1.KEY_DOWN,(e=>{const t=new StandardKeyboardEvent(e);let i=!0;const n="number"==typeof this.focusedItem?this.viewItems[this.focusedItem]:void 0;l&&(t.equals(l[0])||t.equals(l[1]))?i=this.focusPrevious():d&&(t.equals(d[0])||t.equals(d[1]))?i=this.focusNext():t.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():t.equals(14)?i=this.focusFirst():t.equals(13)?i=this.focusLast():t.equals(2)&&n instanceof BaseActionViewItem&&n.trapsArrowNavigation?i=this.focusNext():this.isTriggerKeyEvent(t)?this._triggerKeys.keyDown?this.doTrigger(t):this.triggerKeyDown=!0:i=!1,i&&(t.preventDefault(),t.stopPropagation())}))),this._register(addDisposableListener(this.domNode,EventType$1.KEY_UP,(e=>{const t=new StandardKeyboardEvent(e);this.isTriggerKeyEvent(t)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(t)),t.preventDefault(),t.stopPropagation()):(t.equals(2)||t.equals(1026))&&this.updateFocusedItem()}))),this.focusTracker=this._register(trackFocus(this.domNode)),this._register(this.focusTracker.onDidBlur((()=>{getActiveElement()!==this.domNode&&isAncestor$1(getActiveElement(),this.domNode)||(this._onDidBlur.fire(),this.focusedItem=void 0,this.previouslyFocusedItem=void 0,this.triggerKeyDown=!1)}))),this._register(this.focusTracker.onDidFocus((()=>this.updateFocusedItem()))),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.actionsList.setAttribute("role","toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=2?this.actionsList.setAttribute("role","toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const e=this.viewItems.find((e=>e instanceof BaseActionViewItem&&e.isEnabled()));e instanceof BaseActionViewItem&&e.setFocusable(!0)}else this.viewItems.forEach((e=>{e instanceof BaseActionViewItem&&e.setFocusable(!1)}))}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach((i=>{t=t||e.equals(i)})),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(isAncestor$1(getActiveElement(),t)){this.focusedItem=e;break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach((t=>t.setActionContext(e)))}get actionRunner(){return this._actionRunner}set actionRunner(e){e&&(this._actionRunner=e,this.viewItems.forEach((t=>t.actionRunner=e)))}getContainer(){return this.domNode}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=isNumber$1(t.index)?t.index:null;i.forEach((e=>{const i=document.createElement("li");let o;i.className="action-item",i.setAttribute("role","presentation"),this.options.allowContextMenu||this._register(addDisposableListener(i,EventType$1.CONTEXT_MENU,(e=>{EventHelper.stop(e,!0)}))),this.options.actionViewItemProvider&&(o=this.options.actionViewItemProvider(e)),o||(o=new ActionViewItem(this.context,e,t)),o.actionRunner=this._actionRunner,o.setActionContext(this.context),o.render(i),this.focusable&&o instanceof BaseActionViewItem&&0===this.viewItems.length&&o.setFocusable(!0),null===n||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(i),this.viewItems.push(o),this._actionIds.push(e.id)):(this.actionsList.insertBefore(i,this.actionsList.children[n]),this.viewItems.splice(n,0,o),this._actionIds.splice(n,0,e.id),n++)})),"number"==typeof this.focusedItem&&this.focus(this.focusedItem),this.refreshRole()}clear(){dispose(this.viewItems),this.viewItems=[],this._actionIds=[],clearNode(this.actionsList),this.refreshRole()}length(){return this.viewItems.length}focus(e){let t,i=!1;if(void 0===e?i=!0:"number"==typeof e?t=e:"boolean"==typeof e&&(i=e),i&&void 0===this.focusedItem){const e=this.viewItems.findIndex((e=>e.isEnabled()));this.focusedItem=-1===e?void 0:e,this.updateFocus(void 0,void 0,!0)}else void 0!==t&&(this.focusedItem=t),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e){if(void 0===this.focusedItem)this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=t,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&this.options.focusOnlyEnabledItems&&!i.isEnabled());return this.updateFocus(),!0}focusPrevious(e){if(void 0===this.focusedItem)this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&this.options.focusOnlyEnabledItems&&!i.isEnabled());return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){var n;void 0===this.focusedItem&&this.actionsList.focus({preventScroll:t}),void 0!==this.previouslyFocusedItem&&this.previouslyFocusedItem!==this.focusedItem&&(null===(n=this.viewItems[this.previouslyFocusedItem])||void 0===n||n.blur());const o=void 0!==this.focusedItem&&this.viewItems[this.focusedItem];if(o){let n=!0;isFunction(o.focus)||(n=!1),this.options.focusOnlyEnabledItems&&isFunction(o.isEnabled)&&!o.isEnabled()&&(n=!1),n?(i||this.previouslyFocusedItem!==this.focusedItem)&&(o.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0)}}doTrigger(e){if(void 0===this.focusedItem)return;const t=this.viewItems[this.focusedItem];if(t instanceof BaseActionViewItem){const i=null===t._context||void 0===t._context?e:t._context;this.run(t._action,i)}}run(e,t){return __awaiter$12(this,void 0,void 0,(function*(){yield this._actionRunner.run(e,t)}))}dispose(){dispose(this.viewItems),this.viewItems=[],this._actionIds=[],this.getContainer().remove(),super.dispose()}}const Extensions$1={IconContribution:"base.contributions.icons"};var IconContribution;(IconContribution||(IconContribution={})).getDefinition=function(e,t){let i=e.defaults;for(;ThemeIcon.isThemeIcon(i);){const e=iconRegistry.getIcon(i.id);if(!e)return;i=e.defaults}return i};class IconRegistry{constructor(){this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:localize("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:localize("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${CSSIcon.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const o=this.iconsById[e];if(o){if(i&&!o.description){o.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const t=this.iconReferenceSchema.enum.indexOf(e);-1!==t&&(this.iconReferenceSchema.enumDescriptions[t]=i),this._onDidChange.fire()}return o}let r={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=r;let s={$ref:"#/definitions/icons"};return n&&(s.deprecationMessage=n),i&&(s.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=s,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map((e=>this.iconsById[e]))}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(e,t)=>e.id.localeCompare(t.id),t=e=>{for(;ThemeIcon.isThemeIcon(e.defaults);)e=this.iconsById[e.defaults.id];return`codicon codicon-${e?e.id:""}`};let i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map((e=>this.iconsById[e]));for(const o of n.filter((e=>!!e.description)).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|${ThemeIcon.isThemeIcon(o.defaults)?o.defaults.id:o.id}|${o.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const o of n.filter((e=>!ThemeIcon.isThemeIcon(e.defaults))).sort(e))i.push(`|<i class="${t(o)}"></i>|${o.id}|`);return i.join("\n")}}const iconRegistry=new IconRegistry;function registerIcon(e,t,i,n){return iconRegistry.registerIcon(e,t,i,n)}function getIconRegistry(){return iconRegistry}function initialize(){for(const e of Codicon.getAll())iconRegistry.registerIcon(e.id,e.definition,e.description)}Registry.add(Extensions$1.IconContribution,iconRegistry),initialize();const iconsSchemaId="vscode://schemas/icons";let schemaRegistry=Registry.as(Extensions$5.JSONContribution);schemaRegistry.registerSchema(iconsSchemaId,iconRegistry.getIconSchema());const delayer=new RunOnceScheduler((()=>schemaRegistry.notifySchemaChanged(iconsSchemaId)),200);iconRegistry.onDidChange((()=>{delayer.isScheduled()||delayer.schedule()}));const widgetClose=registerIcon("widget-close",Codicon.close,localize("widgetClose","Icon for the close action in widgets."));registerIcon("goto-previous-location",Codicon.arrowUp,localize("previousChangeIcon","Icon for goto previous editor location.")),registerIcon("goto-next-location",Codicon.arrowDown,localize("nextChangeIcon","Icon for goto next editor location.")),ThemeIcon.modify(Codicon.sync,"spin"),ThemeIcon.modify(Codicon.loading,"spin");var __decorate$1t=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1p=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$11=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},_a$9;const DIFF_LINES_PADDING=3;class DiffEntry{constructor(e,t,i,n){this.originalLineStart=e,this.originalLineEnd=t,this.modifiedLineStart=i,this.modifiedLineEnd=n}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class Diff{constructor(e){this.entries=e}}const diffReviewInsertIcon=registerIcon("diff-review-insert",Codicon.add,localize("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),diffReviewRemoveIcon=registerIcon("diff-review-remove",Codicon.remove,localize("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),diffReviewCloseIcon=registerIcon("diff-review-close",Codicon.close,localize("diffReviewCloseIcon","Icon for 'Close' in diff review."));let DiffReview=class e extends Disposable{constructor(e,t){super(),this._languageService=t,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=createFastDomNode(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=createFastDomNode(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new ActionBar(this.actionBarContainer.domNode)),this._actionBar.push(new Action("diffreview.close",localize("label.close","Close"),"close-diff-review "+ThemeIcon.asClassName(diffReviewCloseIcon),!0,(()=>__awaiter$11(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=createFastDomNode(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=createFastDomNode(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new DomScrollableElement(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(addStandardDisposableListener(this.domNode.domNode,"click",(e=>{e.preventDefault();const t=findParentWithClass(e.target,"diff-review-row");t&&this._goToRow(t)}))),this._register(addStandardDisposableListener(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow())),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow())),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this.hide()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,i=this._diffs.length;e<i;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=this._diffs.length+t-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new Position$1(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let t=-1;for(let e=0,i=this._diffs.length;e<i;e++)if(this._diffs[e]===this._currentDiff){t=e;break}e=t+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const t=this._diffs[e].entries;this._diffEditor.setPosition(new Position$1(t[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:t[0].modifiedLineStart,endColumn:1073741824,endLineNumber:t[t.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow())}accept(){let e=-1;const t=this._getCurrentFocusedRow();if(t){const i=parseInt(t.getAttribute("data-line"),10);isNaN(i)||(e=i)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new Position$1(e,1)),this._diffEditor.revealPosition(new Position$1(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){const e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e){const t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,t,i){this._width=t,this.shadow.setTop(e-6),this.shadow.setWidth(t),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(t),this.domNode.setHeight(i),this._content.setHeight(i),this._content.setWidth(t),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const t=this._diffEditor.getLineChanges();if(!t||0===t.length)return[];const i=this._diffEditor.getOriginalEditor().getModel(),n=this._diffEditor.getModifiedEditor().getModel();return i&&n?e._mergeAdjacent(t,i.getLineCount(),n.getLineCount()):[]}static _mergeAdjacent(e,t,i){if(!e||0===e.length)return[];const n=[];let o=0;for(let l=0,d=e.length;l<d;l++){const r=e[l],s=r.originalStartLineNumber,a=r.originalEndLineNumber,c=r.modifiedStartLineNumber,h=r.modifiedEndLineNumber,u=[];let g=0;{const t=0===a?s:s-1,i=0===h?c:c-1;let n=1,o=1;if(l>0){const t=e[l-1];n=0===t.originalEndLineNumber?t.originalStartLineNumber+1:t.originalEndLineNumber+1,o=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber+1:t.modifiedEndLineNumber+1}let r=t-DIFF_LINES_PADDING+1,d=i-DIFF_LINES_PADDING+1;if(r<n){const e=n-r;r+=e,d+=e}if(d<o){const e=o-d;r+=e,d+=e}u[g++]=new DiffEntry(r,t,d,i)}0!==a&&(u[g++]=new DiffEntry(s,a,0,0)),0!==h&&(u[g++]=new DiffEntry(0,0,c,h));{const n=0===a?s+1:a+1,o=0===h?c+1:h+1;let r=t,p=i;if(l+1<d){const t=e[l+1];r=0===t.originalEndLineNumber?t.originalStartLineNumber:t.originalStartLineNumber-1,p=0===t.modifiedEndLineNumber?t.modifiedStartLineNumber:t.modifiedStartLineNumber-1}let m=n+DIFF_LINES_PADDING-1,f=o+DIFF_LINES_PADDING-1;if(m>r){const e=r-m;m+=e,f+=e}if(f>p){const e=p-f;m+=e,f+=e}u[g++]=new DiffEntry(n,m,o,f)}n[o++]=new Diff(u)}let r=n[0].entries;const s=[];let a=0;for(let l=1,d=n.length;l<d;l++){const e=n[l].entries,t=r[r.length-1],i=e[0];0===t.getType()&&0===i.getType()&&i.originalLineStart<=t.originalLineEnd?(r[r.length-1]=new DiffEntry(t.originalLineStart,i.originalLineEnd,t.modifiedLineStart,i.modifiedLineEnd),r=r.concat(e.slice(1))):(s[a++]=new Diff(r),r=e)}return s[a++]=new Diff(r),s}_findDiffIndex(e){const t=e.lineNumber;for(let i=0,n=this._diffs.length;i<n;i++){const e=this._diffs[i].entries;if(t<=e[e.length-1].modifiedLineEnd)return i}return 0}_render(){const t=this._diffEditor.getOriginalEditor().getOptions(),i=this._diffEditor.getModifiedEditor().getOptions(),n=this._diffEditor.getOriginalEditor().getModel(),o=this._diffEditor.getModifiedEditor().getModel(),r=n.getOptions(),s=o.getOptions();if(!this._isVisible||!n||!o)return clearNode(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const a=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[a]===this._currentDiff)return;this._currentDiff=this._diffs[a];const l=this._diffs[a].entries,d=document.createElement("div");d.className="diff-review-table",d.setAttribute("role","list"),d.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),applyFontInfo(d,i.get(44));let c=0,h=0,u=0,g=0;for(let e=0,w=l.length;e<w;e++){const t=l[e],i=t.originalLineStart,n=t.originalLineEnd,o=t.modifiedLineStart,r=t.modifiedLineEnd;0!==i&&(0===c||i<c)&&(c=i),0!==n&&(0===h||n>h)&&(h=n),0!==o&&(0===u||o<u)&&(u=o),0!==r&&(0===g||r>g)&&(g=r)}const p=document.createElement("div");p.className="diff-review-row";const m=document.createElement("div");m.className="diff-review-cell diff-review-summary";const f=h-c+1,_=g-u+1;m.appendChild(document.createTextNode(`${a+1}/${this._diffs.length}: @@ -${c},${f} +${u},${_} @@`)),p.setAttribute("data-line",String(u));const C=e=>0===e?localize("no_lines_changed","no lines changed"):1===e?localize("one_line_changed","1 line changed"):localize("more_lines_changed","{0} lines changed",e),v=C(f),b=C(_);p.setAttribute("aria-label",localize({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",a+1,this._diffs.length,c,v,u,b)),p.appendChild(m),p.setAttribute("role","listitem"),d.appendChild(p);const S=i.get(59);let y=u;for(let w=0,E=l.length;w<E;w++){const a=l[w];e._renderSection(d,a,y,S,this._width,t,n,r,i,o,s,this._languageService.languageIdCodec),0!==a.modifiedLineStart&&(y=a.modifiedLineEnd)}clearNode(this._content.domNode),this._content.domNode.appendChild(d),this.scrollbar.scanDomNode()}static _renderSection(t,i,n,o,r,s,a,l,d,c,h,u){const g=i.getType();let p="diff-review-row",m="";let f=null;switch(g){case 1:p="diff-review-row line-insert",m=" char-insert",f=diffReviewInsertIcon;break;case 2:p="diff-review-row line-delete",m=" char-delete",f=diffReviewRemoveIcon}const _=i.originalLineStart,C=i.originalLineEnd,v=i.modifiedLineStart,b=i.modifiedLineEnd,S=Math.max(b-v,C-_),y=s.get(131),w=y.glyphMarginWidth+y.lineNumbersWidth,E=d.get(131),L=10+E.glyphMarginWidth+E.lineNumbersWidth;for(let x=0;x<=S;x++){const i=0===_?0:_+x,C=0===v?0:v+x,b=document.createElement("div");b.style.minWidth=r+"px",b.className=p,b.setAttribute("role","listitem"),0!==C&&(n=C),b.setAttribute("data-line",String(n));const S=document.createElement("div");S.className="diff-review-cell",S.style.height=`${o}px`,b.appendChild(S);const y=document.createElement("span");y.style.width=w+"px",y.style.minWidth=w+"px",y.className="diff-review-line-number"+m,0!==i?y.appendChild(document.createTextNode(String(i))):y.innerText=" ",S.appendChild(y);const E=document.createElement("span");E.style.width=L+"px",E.style.minWidth=L+"px",E.style.paddingRight="10px",E.className="diff-review-line-number"+m,0!==C?E.appendChild(document.createTextNode(String(C))):E.innerText=" ",S.appendChild(E);const D=document.createElement("span");if(D.className="diff-review-spacer",f){const e=document.createElement("span");e.className=ThemeIcon.asClassName(f),e.innerText="  ",D.appendChild(e)}else D.innerText="  ";let I;if(S.appendChild(D),0!==C){let t=this._renderLine(c,d,h.tabSize,C,u);e._ttPolicy&&(t=e._ttPolicy.createHTML(t)),S.insertAdjacentHTML("beforeend",t),I=c.getLineContent(C)}else{let t=this._renderLine(a,s,l.tabSize,i,u);e._ttPolicy&&(t=e._ttPolicy.createHTML(t)),S.insertAdjacentHTML("beforeend",t),I=a.getLineContent(i)}0===I.length&&(I=localize("blankLine","blank"));let k="";switch(g){case 0:k=i===C?localize({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",I,i):localize("equalLine","{0} original line {1} modified line {2}",I,i,C);break;case 1:k=localize("insertLine","+ {0} modified line {1}",I,C);break;case 2:k=localize("deleteLine","- {0} original line {1}",I,i)}b.setAttribute("aria-label",k),t.appendChild(b)}}static _renderLine(e,t,i,n,o){const r=e.getLineContent(n),s=t.get(44),a=LineTokens.createEmpty(r,o),l=ViewLineRenderingData.isBasicASCII(r,e.mightContainNonBasicASCII()),d=ViewLineRenderingData.containsRTL(r,l,e.mightContainRTL());return renderViewLine2(new RenderLineInput(s.isMonospace&&!t.get(29),s.canUseHalfwidthRightwardsArrow,r,!1,l,d,0,a,[],i,0,s.spaceWidth,s.middotWidth,s.wsmiddotWidth,t.get(105),t.get(88),t.get(83),t.get(45)!==EditorFontLigatures.OFF,null)).html}};DiffReview._ttPolicy=null===(_a$9=window.trustedTypes)||void 0===_a$9?void 0:_a$9.createPolicy("diffReview",{createHTML:e=>e}),DiffReview=__decorate$1t([__param$1p(1,ILanguageService)],DiffReview),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorLineNumbers);i&&t.addRule(`.monaco-diff-editor .diff-review-line-number { color: ${i}; }`);const n=e.getColor(scrollbarShadow);n&&t.addRule(`.monaco-diff-editor .diff-review-shadow { box-shadow: ${n} 0 -6px 6px -6px inset; }`)}));class DiffReviewNext extends EditorAction{constructor(){super({id:"editor.action.diffReview.next",label:localize("editor.action.diffReview.next","Go to Next Difference"),alias:"Go to Next Difference",precondition:ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:65,weight:100}})}run(e,t){const i=findFocusedDiffEditor(e);i&&i.diffReviewNext()}}class DiffReviewPrev extends EditorAction{constructor(){super({id:"editor.action.diffReview.prev",label:localize("editor.action.diffReview.prev","Go to Previous Difference"),alias:"Go to Previous Difference",precondition:ContextKeyExpr.has("isInDiffEditor"),kbOpts:{kbExpr:null,primary:1089,weight:100}})}run(e,t){const i=findFocusedDiffEditor(e);i&&i.diffReviewPrev()}}function findFocusedDiffEditor(e){const t=e.get(ICodeEditorService),i=t.listDiffEditors(),n=t.getActiveCodeEditor();if(!n)return null;for(let o=0,r=i.length;o<r;o++){const e=i[o];if(e.getModifiedEditor().getId()===n.getId()||e.getOriginalEditor().getId()===n.getId())return e}return null}registerEditorAction(DiffReviewNext),registerEditorAction(DiffReviewPrev);const ID_EDITOR_WORKER_SERVICE="editorWorkerService",IEditorWorkerService=createDecorator(ID_EDITOR_WORKER_SERVICE),IContextViewService=createDecorator("contextViewService"),IContextMenuService=createDecorator("contextMenuService");var __awaiter$10=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class InlineDiffMargin extends Disposable{constructor(e,t,i,n,o,r){super(),this._viewZoneId=e,this._marginDomNode=t,this.editor=i,this.diff=n,this._contextMenuService=o,this._clipboardService=r,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=Codicon.lightBulb.classNames+" lightbulb-glyph",this._diffActions.style.position="absolute";const s=i.getOption(59),a=i.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${s}px`,this._diffActions.style.lineHeight=`${s}px`,this._marginDomNode.appendChild(this._diffActions);const l=[],d=0===n.modifiedEndLineNumber;l.push(new Action("diff.clipboard.copyDeletedContent",d?n.originalEndLineNumber>n.modifiedStartLineNumber?localize("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):localize("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):n.originalEndLineNumber>n.modifiedStartLineNumber?localize("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):localize("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>__awaiter$10(this,void 0,void 0,(function*(){const e=new Range$2(n.originalStartLineNumber,1,n.originalEndLineNumber+1,1),t=n.originalModel.getValueInRange(e);yield this._clipboardService.writeText(t)})))));let c,h=0;n.originalEndLineNumber>n.modifiedStartLineNumber&&(c=new Action("diff.clipboard.copyDeletedLineContent",d?localize("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.originalStartLineNumber):localize("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.originalStartLineNumber),void 0,!0,(()=>__awaiter$10(this,void 0,void 0,(function*(){const e=n.originalModel.getLineContent(n.originalStartLineNumber+h);if(""===e){const e=n.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===e?"\n":"\r\n")}else yield this._clipboardService.writeText(e)})))),l.push(c));i.getOption(81)||l.push(new Action("diff.inline.revertChange",localize("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>__awaiter$10(this,void 0,void 0,(function*(){const e=new Range$2(n.originalStartLineNumber,1,n.originalEndLineNumber,n.originalModel.getLineMaxColumn(n.originalEndLineNumber)),t=n.originalModel.getValueInRange(e);if(0===n.modifiedEndLineNumber){const e=i.getModel().getLineMaxColumn(n.modifiedStartLineNumber);i.executeEdits("diffEditor",[{range:new Range$2(n.modifiedStartLineNumber,e,n.modifiedStartLineNumber,e),text:a+t}])}else{const e=i.getModel().getLineMaxColumn(n.modifiedEndLineNumber);i.executeEdits("diffEditor",[{range:new Range$2(n.modifiedStartLineNumber,1,n.modifiedEndLineNumber,e),text:t}])}})))));const u=(e,t)=>{this._contextMenuService.showContextMenu({getAnchor:()=>({x:e,y:t}),getActions:()=>(c&&(c.label=d?localize("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.originalStartLineNumber+h):localize("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.originalStartLineNumber+h)),l),autoSelectFirstItem:!0})};this._register(addStandardDisposableListener(this._diffActions,"mousedown",(e=>{const{top:t,height:i}=getDomNodePagePosition(this._diffActions),n=Math.floor(s/3);e.preventDefault(),u(e.posx,t+i+n)}))),this._register(i.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){e.target.detail.viewZoneId===this._viewZoneId?(this.visibility=!0,h=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,s)):this.visibility=!1}else this.visibility=!1}))),this._register(i.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){e.target.detail.viewZoneId===this._viewZoneId&&(e.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,s),u(e.event.posx,e.event.posy+s))}})))}get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}_updateLightBulbPosition(e,t,i){const{top:n}=getDomNodePagePosition(e),o=t-n,r=Math.floor(o/i),s=r*i;if(this._diffActions.style.top=`${s}px`,this.diff.viewLineCounts){let e=0;for(let t=0;t<this.diff.viewLineCounts.length;t++)if(e+=this.diff.viewLineCounts[t],r<e)return t}return r}}const IClipboardService=createDecorator("clipboardService");Object.freeze({total(){},worked(){},done(){}});class Progress{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}}Progress.None=Object.freeze({report(){}});const IEditorProgressService=createDecorator("editorProgressService");var __decorate$1s=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1o=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},_a$8;class VisualEditorState{constructor(e,t){this._contextMenuService=e,this._clipboardService=t,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const t of this._zones)e.removeZone(t)})),this._zones=[],this._zonesMap={},this._decorations=e.deltaDecorations(this._decorations,[])}apply(e,t,i,n){const o=n?StableEditorScrollState.capture(e):null;e.changeViewZones((t=>{var n;for(const e of this._zones)t.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let o=0,r=i.zones.length;o<r;o++){const r=i.zones[o];r.suppressMouseDown=!0;const s=t.addZone(r);this._zones.push(s),this._zonesMap[String(s)]=!0,i.zones[o].diff&&r.marginDomNode&&(r.suppressMouseDown=!1,0!==(null===(n=i.zones[o].diff)||void 0===n?void 0:n.originalModel.getValueLength())&&this._inlineDiffMargins.push(new InlineDiffMargin(s,r.marginDomNode,e,i.zones[o].diff,this._contextMenuService,this._clipboardService)))}})),o&&o.restore(e),this._decorations=e.deltaDecorations(this._decorations,i.decorations),t&&t.setZones(i.overviewZones)}}let DIFF_EDITOR_ID=0;const diffInsertIcon=registerIcon("diff-insert",Codicon.add,localize("diffInsertIcon","Line decoration for inserts in the diff editor.")),diffRemoveIcon=registerIcon("diff-remove",Codicon.remove,localize("diffRemoveIcon","Line decoration for removals in the diff editor.")),ttPolicy$3=null===(_a$8=window.trustedTypes)||void 0===_a$8?void 0:_a$8.createPolicy("diffEditorWidget",{createHTML:e=>e});let DiffEditorWidget=class e extends Disposable{constructor(t,i,n,o,r,s,a,l,d,c,h,u){super(),this._editorProgressService=u,this._onDidDispose=this._register(new Emitter$1),this.onDidDispose=this._onDidDispose.event,this._onDidUpdateDiff=this._register(new Emitter$1),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new Emitter$1),this._lastOriginalWarning=null,this._lastModifiedWarning=null,this._editorWorkerService=r,this._codeEditorService=l,this._contextKeyService=this._register(s.createScoped(t)),this._instantiationService=a.createChild(new ServiceCollection([IContextKeyService,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=d,this._notificationService=c,this._id=++DIFF_EDITOR_ID,this._state=0,this._updatingDiffProgress=null,this._domElement=t,i=i||{},this._options=validateDiffEditorOptions(i,{enableSplitViewResizing:!0,renderSideBySide:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit"}),void 0!==i.isInEmbeddedEditor?this._contextKeyService.createKey("isInEmbeddedDiffEditor",i.isInEmbeddedEditor):this._contextKeyService.createKey("isInEmbeddedDiffEditor",!1),this._updateDecorationsRunner=this._register(new RunOnceScheduler((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=createFastDomNode(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(addStandardDisposableListener(this._overviewDomElement,"mousedown",(e=>{this._modifiedEditor.delegateVerticalScrollbarMouseDown(e)}))),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new VisualEditorState(h,o),this._modifiedEditorState=new VisualEditorState(h,o),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new ElementSizeObserver(this._containerDomElement,i.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),i.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(i,n.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(i,n.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=a.createInstance(DiffReview,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(d.onDidColorThemeChange((t=>{this._strategy&&this._strategy.applyColors(t)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const g=EditorExtensionsRegistry.getDiffEditorContributions();for(const e of g)try{this._register(a.createInstance(e.ctor,this))}catch(p){onUnexpectedError(p)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}diffReviewNext(){this._reviewPane.next()}diffReviewPrev(){this._reviewPane.prev()}static _getClassName(e,t){let i="monaco-diff-editor monaco-editor-background ";return t&&(i+="side-by-side "),i+=getThemeTypeSelector(e.type),i}_recreateOverviewRulers(){this._options.renderOverviewRuler&&(this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(t,i){const n=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(t),i);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(44)&&this._updateDecorationsRunner.schedule(),e.hasChanged(132)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const o=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((t=>{const i=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:i,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),n}_createRightHandSideEditor(t,i){const n=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(t),i);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(44)&&this._updateDecorationsRunner.schedule(),e.hasChanged(132)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(n.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const o=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((t=>{const i=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:i,contentHeightChanged:t.contentHeightChanged,contentWidthChanged:t.contentWidthChanged})}))),n}_createInnerEditor(e,t,i,n){return e.createInstance(CodeEditorWidget,t,i,n)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return EditorType.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(t){const i=validateDiffEditorOptions(t,this._options),n=changedDiffEditorOptions(this._options,i);this._options=i;const o=n.ignoreTrimWhitespace||n.renderIndicators,r=this._isVisible&&(n.maxComputationTime||n.maxFileSize);o?this._beginUpdateDecorations():r&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(t)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(t)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing),n.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new DiffEditorWidgetSideBySide(this._createDataSource(),this._options.enableSplitViewResizing)):this._setStrategy(new DiffEditorWidgetInline(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),n.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}setModel(e){if(e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._recreateOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport()}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e,t="api"){this._modifiedEditor.setPosition(e,t)}revealLine(e,t=0){this._modifiedEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._modifiedEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._modifiedEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._modifiedEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._modifiedEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._modifiedEditor.revealPositionNearTop(e,t)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e,t="api"){this._modifiedEditor.setSelection(e,t)}setSelections(e,t="api"){this._modifiedEditor.setSelections(e,t)}revealLines(e,t,i=0){this._modifiedEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._modifiedEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._modifiedEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._modifiedEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._modifiedEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._modifiedEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._modifiedEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}saveViewState(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._originalEditor.restoreViewState(t.original),this._modifiedEditor.restoreViewState(t.modified)}}layout(e){this._elementSizeObserver.observe(e)}focus(){this._modifiedEditor.focus()}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}trigger(e,t,i){this._modifiedEditor.trigger(e,t,i)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const t=this._elementSizeObserver.getHeight(),i=this._getReviewHeight(),n=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:n+e.ONE_OVERVIEW_WIDTH,height:t-i}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:t-i}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,t){return!e&&!t||!(!e||!t)&&e.toString()===t.toString()}_beginUpdateDecorations(){this._beginUpdateDecorationsTimeout=-1;const t=this._originalEditor.getModel(),i=this._modifiedEditor.getModel();if(!t||!i)return;this._diffComputationToken++;const n=this._diffComputationToken,o=1024*this._options.maxFileSize*1024,r=e=>{const t=e.getValueLength();return 0===o||t<=o};r(t)&&r(i)?(this._setState(1),this._editorWorkerService.computeDiff(t.uri,i.uri,this._options.ignoreTrimWhitespace,this._options.maxComputationTime).then((e=>{n===this._diffComputationToken&&t===this._originalEditor.getModel()&&i===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=e,this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{n===this._diffComputationToken&&t===this._originalEditor.getModel()&&i===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):e._equals(t.uri,this._lastOriginalWarning)&&e._equals(i.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=t.uri,this._lastModifiedWarning=i.uri,this._notificationService.warn(localize("diff.tooLarge","Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],t=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),i=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),n=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,t,i);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,n.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,n.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const t=Object.assign({},e);return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar=Object.assign({},t.scrollbar||{}),t.scrollbar.vertical="visible",t.folding=!1,t.codeLens=this._options.diffCodeLens,t.fixedOverflowWidgets=!0,t.minimap=Object.assign({},t.minimap||{}),t.minimap.enabled=!1,t}_adjustOptionsForLeftHandSide(e){const t=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?t.wordWrapOverride1=this._options.diffWordWrap:(t.wordWrapOverride1="off",t.wordWrapOverride2="off"),e.originalAriaLabel&&(t.ariaLabel=e.originalAriaLabel),t.readOnly=!this._options.originalEditable,t.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}_adjustOptionsForRightHandSide(t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.wordWrapOverride1=this._options.diffWordWrap,i.revealHorizontalRightPadding=EditorOptions.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const t=this._elementSizeObserver.getWidth(),i=this._elementSizeObserver.getHeight(),n=this._getReviewHeight(),o=this._strategy.layout();this._originalDomNode.style.width=o+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=t-o+"px",this._modifiedDomNode.style.left=o+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=i-n+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=t-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:o,height:i-n}),this._modifiedEditor.layout({width:t-o-(this._options.renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:i-n}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(i-n,t,n),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const t=this._modifiedEditor.getScrollTop(),i=this._modifiedEditor.getScrollHeight(),n=Math.max(0,e.height),o=Math.max(0,n-0),r=i>0?o/i:0;return{height:Math.max(0,Math.floor(e.height*r)),top:Math.floor(t*r)}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){this._strategy&&this._strategy.dispose(),this._strategy=e,e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}_getLineChangeAtOrBeforeLineNumber(e,t){const i=this._diffComputationResult?this._diffComputationResult.changes:[];if(0===i.length||e<t(i[0]))return null;let n=0,o=i.length-1;for(;n<o;){const r=Math.floor((n+o)/2),s=t(i[r]),a=r+1<=o?t(i[r+1]):1073741824;e<s?o=r-1:e>=a?n=r+1:(n=r,o=r)}return i[n]}_getEquivalentLineForOriginalLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.originalStartLineNumber));if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),n=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),o=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,r=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-i;return s<=o?n+Math.min(s,r):n+r-o+s}_getEquivalentLineForModifiedLineNumber(e){const t=this._getLineChangeAtOrBeforeLineNumber(e,(e=>e.modifiedStartLineNumber));if(!t)return e;const i=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),n=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),o=t.originalEndLineNumber>0?t.originalEndLineNumber-t.originalStartLineNumber+1:0,r=t.modifiedEndLineNumber>0?t.modifiedEndLineNumber-t.modifiedStartLineNumber+1:0,s=e-n;return s<=r?i+Math.min(s,o):i+o-r+s}getDiffLineInformationForOriginal(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForOriginalLineNumber(e)}:null}getDiffLineInformationForModified(e){return this._diffComputationResult?{equivalentLineNumber:this._getEquivalentLineForModifiedLineNumber(e)}:null}};DiffEditorWidget.ONE_OVERVIEW_WIDTH=15,DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH=30,DiffEditorWidget.UPDATE_DIFF_DECORATIONS_DELAY=200,DiffEditorWidget=__decorate$1s([__param$1o(3,IClipboardService),__param$1o(4,IEditorWorkerService),__param$1o(5,IContextKeyService),__param$1o(6,IInstantiationService),__param$1o(7,ICodeEditorService),__param$1o(8,IThemeService),__param$1o(9,INotificationService),__param$1o(10,IContextMenuService),__param$1o(11,IEditorProgressService)],DiffEditorWidget);class DiffEditorWidgetStyle extends Disposable{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const t=e.getColor(diffOverviewRulerInserted)||(e.getColor(diffInserted)||defaultInsertColor).transparent(2),i=e.getColor(diffOverviewRulerRemoved)||(e.getColor(diffRemoved)||defaultRemoveColor).transparent(2),n=!t.equals(this._insertColor)||!i.equals(this._removeColor);return this._insertColor=t,this._removeColor=i,n}getEditorsDiffDecorations(e,t,i,n,o){o=o.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber)),n=n.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber));const r=this._getViewZones(e,n,o,i),s=this._getOriginalEditorDecorations(r,e,t,i),a=this._getModifiedEditorDecorations(r,e,t,i);return{original:{decorations:s.decorations,overviewZones:s.overviewZones,zones:r.original},modified:{decorations:a.decorations,overviewZones:a.overviewZones,zones:r.modified}}}}class ForeignViewZonesIterator{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class ViewZonesComputer{constructor(e,t,i,n,o){this._lineChanges=e,this._originalForeignVZ=t,this._modifiedForeignVZ=i,this._originalEditor=n,this._modifiedEditor=o}static _getViewLineCount(e,t,i){const n=e.getModel(),o=e._getViewModel();if(n&&o){const e=getViewRange(n,o,t,i);return e.endLineNumber-e.startLineNumber+1}return i-t+1}getViewZones(){const e=this._originalEditor.getOption(59),t=this._modifiedEditor.getOption(59),i=-1!==this._originalEditor.getOption(132).wrappingColumn,n=-1!==this._modifiedEditor.getOption(132).wrappingColumn,o=i||n,r=this._originalEditor.getModel(),s=this._originalEditor._getViewModel().coordinatesConverter,a=this._modifiedEditor._getViewModel().coordinatesConverter,l=[],d=[];let c=0,h=0,u=0,g=0,p=0,m=0;const f=(e,t)=>e.afterLineNumber-t.afterLineNumber,_=(e,t)=>{if(null===t.domNode&&e.length>0){const i=e[e.length-1];if(i.afterLineNumber===t.afterLineNumber&&null===i.domNode)return void(i.heightInLines+=t.heightInLines)}e.push(t)},C=new ForeignViewZonesIterator(this._modifiedForeignVZ),v=new ForeignViewZonesIterator(this._originalForeignVZ);let b=1,S=1;for(let y=0,w=this._lineChanges.length;y<=w;y++){const i=y<w?this._lineChanges[y]:null;null!==i?(u=i.originalStartLineNumber+(i.originalEndLineNumber>0?-1:0),g=i.modifiedStartLineNumber+(i.modifiedEndLineNumber>0?-1:0),h=i.originalEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._originalEditor,i.originalStartLineNumber,i.originalEndLineNumber):0,c=i.modifiedEndLineNumber>0?ViewZonesComputer._getViewLineCount(this._modifiedEditor,i.modifiedStartLineNumber,i.modifiedEndLineNumber):0,p=Math.max(i.originalStartLineNumber,i.originalEndLineNumber),m=Math.max(i.modifiedStartLineNumber,i.modifiedEndLineNumber)):(u+=1e7+h,g+=1e7+c,p=u,m=g);let n=[],E=[];if(o){let e;e=i?i.originalEndLineNumber>0?i.originalStartLineNumber-b:i.modifiedStartLineNumber-S:r.getLineCount()-b+1;for(let t=0;t<e;t++){const e=b+t,i=S+t,o=s.getModelLineViewLineCount(e),r=a.getModelLineViewLineCount(i);o<r?n.push({afterLineNumber:e,heightInLines:r-o,domNode:null,marginDomNode:null}):o>r&&E.push({afterLineNumber:i,heightInLines:o-r,domNode:null,marginDomNode:null})}i&&(b=(i.originalEndLineNumber>0?i.originalEndLineNumber:i.originalStartLineNumber)+1,S=(i.modifiedEndLineNumber>0?i.modifiedEndLineNumber:i.modifiedStartLineNumber)+1)}for(;C.current&&C.current.afterLineNumber<=m;){let e;e=C.current.afterLineNumber<=g?u-g+C.current.afterLineNumber:p;let o=null;i&&i.modifiedStartLineNumber<=C.current.afterLineNumber&&C.current.afterLineNumber<=i.modifiedEndLineNumber&&(o=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),n.push({afterLineNumber:e,heightInLines:C.current.height/t,domNode:null,marginDomNode:o}),C.advance()}for(;v.current&&v.current.afterLineNumber<=p;){let t;t=v.current.afterLineNumber<=u?g-u+v.current.afterLineNumber:m,E.push({afterLineNumber:t,heightInLines:v.current.height/e,domNode:null}),v.advance()}if(null!==i&&isChangeOrInsert(i)){const e=this._produceOriginalFromDiff(i,h,c);e&&n.push(e)}if(null!==i&&isChangeOrDelete(i)){const e=this._produceModifiedFromDiff(i,h,c);e&&E.push(e)}let L=0,x=0;for(n=n.sort(f),E=E.sort(f);L<n.length&&x<E.length;){const e=n[L],t=E[x],i=e.afterLineNumber-u,o=t.afterLineNumber-g;i<o?(_(l,e),L++):o<i?(_(d,t),x++):e.shouldNotShrink?(_(l,e),L++):t.shouldNotShrink?(_(d,t),x++):e.heightInLines>=t.heightInLines?(e.heightInLines-=t.heightInLines,x++):(t.heightInLines-=e.heightInLines,L++)}for(;L<n.length;)_(l,n[L]),L++;for(;x<E.length;)_(d,E[x]),x++}return{original:ViewZonesComputer._ensureDomNodes(l),modified:ViewZonesComputer._ensureDomNodes(d)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=createFakeLinesDiv()),e)))}}function createDecoration(e,t,i,n,o){return{range:new Range$2(e,t,i,n),options:o}}const DECORATIONS={charDelete:ModelDecorationOptions.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:ModelDecorationOptions.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:ModelDecorationOptions.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:ModelDecorationOptions.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:ModelDecorationOptions.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:ModelDecorationOptions.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+ThemeIcon.asClassName(diffInsertIcon),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:ModelDecorationOptions.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:ModelDecorationOptions.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+ThemeIcon.asClassName(diffRemoveIcon),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:ModelDecorationOptions.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class DiffEditorWidgetSideBySide extends DiffEditorWidgetStyle{constructor(e,t){super(e),this._disableSash=!1===t,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new Sash(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e){const t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let i=Math.floor((e||.5)*t);const n=Math.floor(.5*t);return i=this._disableSash?n:i||n,t>2*DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH?(i<DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(i=DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH),i>t-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH&&(i=t-DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH)):i=n,this._sashPosition!==i&&(this._sashPosition=i),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const t=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH:0),i=this.layout((this._startSashPosition+(e.currentX-e.startX))/t);this._sashRatio=i/t,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=.5,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}_getViewZones(e,t,i){const n=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor();return new SideBySideViewZonesComputer(e,t,i,n,o).getViewZones()}_getOriginalEditorDecorations(e,t,i,n){const o=this._dataSource.getOriginalEditor(),r=String(this._removeColor),s={decorations:[],overviewZones:[]},a=o.getModel(),l=o._getViewModel();for(const d of t)if(isChangeOrDelete(d)){s.decorations.push({range:new Range$2(d.originalStartLineNumber,1,d.originalEndLineNumber,1073741824),options:n?DECORATIONS.lineDeleteWithSign:DECORATIONS.lineDelete}),isChangeOrInsert(d)&&d.charChanges||s.decorations.push(createDecoration(d.originalStartLineNumber,1,d.originalEndLineNumber,1073741824,DECORATIONS.charDeleteWholeLine));const e=getViewRange(a,l,d.originalStartLineNumber,d.originalEndLineNumber);if(s.overviewZones.push(new OverviewRulerZone(e.startLineNumber,e.endLineNumber,0,r)),d.charChanges)for(const t of d.charChanges)if(isChangeOrDelete(t))if(i)for(let e=t.originalStartLineNumber;e<=t.originalEndLineNumber;e++){let i,n;i=e===t.originalStartLineNumber?t.originalStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===t.originalEndLineNumber?t.originalEndColumn:a.getLineLastNonWhitespaceColumn(e),s.decorations.push(createDecoration(e,i,e,n,DECORATIONS.charDelete))}else s.decorations.push(createDecoration(t.originalStartLineNumber,t.originalStartColumn,t.originalEndLineNumber,t.originalEndColumn,DECORATIONS.charDelete))}return s}_getModifiedEditorDecorations(e,t,i,n){const o=this._dataSource.getModifiedEditor(),r=String(this._insertColor),s={decorations:[],overviewZones:[]},a=o.getModel(),l=o._getViewModel();for(const d of t)if(isChangeOrInsert(d)){s.decorations.push({range:new Range$2(d.modifiedStartLineNumber,1,d.modifiedEndLineNumber,1073741824),options:n?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert}),isChangeOrDelete(d)&&d.charChanges||s.decorations.push(createDecoration(d.modifiedStartLineNumber,1,d.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine));const e=getViewRange(a,l,d.modifiedStartLineNumber,d.modifiedEndLineNumber);if(s.overviewZones.push(new OverviewRulerZone(e.startLineNumber,e.endLineNumber,0,r)),d.charChanges)for(const t of d.charChanges)if(isChangeOrInsert(t))if(i)for(let e=t.modifiedStartLineNumber;e<=t.modifiedEndLineNumber;e++){let i,n;i=e===t.modifiedStartLineNumber?t.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===t.modifiedEndLineNumber?t.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),s.decorations.push(createDecoration(e,i,e,n,DECORATIONS.charInsert))}else s.decorations.push(createDecoration(t.modifiedStartLineNumber,t.modifiedStartColumn,t.modifiedEndLineNumber,t.modifiedEndColumn,DECORATIONS.charInsert))}return s}}DiffEditorWidgetSideBySide.MINIMUM_EDITOR_WIDTH=100;class SideBySideViewZonesComputer extends ViewZonesComputer{constructor(e,t,i,n,o){super(e,t,i,n,o)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,t,i){return i>t?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i-t,domNode:null}:null}_produceModifiedFromDiff(e,t,i){return t>i?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:t-i,domNode:null}:null}}class DiffEditorWidgetInline extends DiffEditorWidgetStyle{constructor(e,t){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((t=>{this._decorationsLeft!==t.decorationsLeft&&(this._decorationsLeft=t.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,t,i,n){const o=this._dataSource.getOriginalEditor(),r=this._dataSource.getModifiedEditor();return new InlineViewZonesComputer(e,t,i,o,r,n).getViewZones()}_getOriginalEditorDecorations(e,t,i,n){const o=String(this._removeColor),r={decorations:[],overviewZones:[]},s=this._dataSource.getOriginalEditor(),a=s.getModel(),l=s._getViewModel();let d=0;for(const c of t)if(isChangeOrDelete(c)){for(r.decorations.push({range:new Range$2(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824),options:DECORATIONS.lineDeleteMargin});d<e.modified.length;){const t=e.modified[d];if(t.diff&&t.diff.originalStartLineNumber>=c.originalStartLineNumber)break;d++}let t=0;if(d<e.modified.length){const i=e.modified[d];i.diff&&i.diff.originalStartLineNumber===c.originalStartLineNumber&&i.diff.originalEndLineNumber===c.originalEndLineNumber&&i.diff.modifiedStartLineNumber===c.modifiedStartLineNumber&&i.diff.modifiedEndLineNumber===c.modifiedEndLineNumber&&(t=i.heightInLines)}const i=getViewRange(a,l,c.originalStartLineNumber,c.originalEndLineNumber);r.overviewZones.push(new OverviewRulerZone(i.startLineNumber,i.endLineNumber,t,o))}return r}_getModifiedEditorDecorations(e,t,i,n){const o=this._dataSource.getModifiedEditor(),r=String(this._insertColor),s={decorations:[],overviewZones:[]},a=o.getModel(),l=o._getViewModel();for(const d of t)if(isChangeOrInsert(d)){s.decorations.push({range:new Range$2(d.modifiedStartLineNumber,1,d.modifiedEndLineNumber,1073741824),options:n?DECORATIONS.lineInsertWithSign:DECORATIONS.lineInsert});const e=getViewRange(a,l,d.modifiedStartLineNumber,d.modifiedEndLineNumber);if(s.overviewZones.push(new OverviewRulerZone(e.startLineNumber,e.endLineNumber,0,r)),d.charChanges){for(const t of d.charChanges)if(isChangeOrInsert(t))if(i)for(let e=t.modifiedStartLineNumber;e<=t.modifiedEndLineNumber;e++){let i,n;i=e===t.modifiedStartLineNumber?t.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===t.modifiedEndLineNumber?t.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),s.decorations.push(createDecoration(e,i,e,n,DECORATIONS.charInsert))}else s.decorations.push(createDecoration(t.modifiedStartLineNumber,t.modifiedStartColumn,t.modifiedEndLineNumber,t.modifiedEndColumn,DECORATIONS.charInsert))}else s.decorations.push(createDecoration(d.modifiedStartLineNumber,1,d.modifiedEndLineNumber,1073741824,DECORATIONS.charInsertWholeLine))}return s}layout(){return Math.max(5,this._decorationsLeft)}}class InlineViewZonesComputer extends ViewZonesComputer{constructor(e,t,i,n,o,r){super(e,t,i,n,o),this._originalModel=n.getModel(),this._renderIndicators=r,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,t,i){const n=document.createElement("div");return n.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:i,domNode:document.createElement("div"),marginDomNode:n}}_produceModifiedFromDiff(e,t,i){const n=document.createElement("div");n.className=`view-lines line-delete ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`;const o=document.createElement("div");o.className="inline-deleted-margin-view-zone";const r={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:t,minWidthInPx:0,domNode:n,marginDomNode:o,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let s=e.originalStartLineNumber;s<=e.originalEndLineNumber;s++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(s),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(r),r}_finalize(e){const t=this._modifiedEditor.getOptions(),i=this._modifiedEditor.getModel().getOptions().tabSize,n=t.get(44),o=t.get(29),r=n.typicalHalfwidthCharacterWidth,s=t.get(93),a=this._originalModel.mightContainNonBasicASCII(),l=this._originalModel.mightContainRTL(),d=t.get(59),c=t.get(131).decorationsWidth,h=t.get(105),u=t.get(88),g=t.get(83),p=t.get(45),m=this._lineBreaksComputer.finalize();let f=0;for(let _=0;_<this._pendingLineChange.length;_++){const t=this._pendingLineChange[_],C=this._pendingViewZones[_],v=C.domNode;applyFontInfo(v,n);const b=C.marginDomNode;applyFontInfo(b,n);const S=[];if(t.charChanges)for(const e of t.charChanges)isChangeOrDelete(e)&&S.push(new InlineDecoration(new Range$2(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const y=S.length>0,w=createStringBuilder(1e4);let E=0,L=0,x=null;for(let r=t.originalStartLineNumber;r<=t.originalEndLineNumber;r++){const s=r-t.originalStartLineNumber,_=this._originalModel.getLineTokens(r),v=_.getLineContent(),D=m[f++],I=LineDecoration.filter(S,r,1,v.length+1);if(D){let t=0;for(const e of D.breakOffsets){const r=_.sliceAndInflate(t,e,0),s=v.substring(t,e);E=Math.max(E,this._renderOriginalLine(L++,s,r,LineDecoration.extractWrapped(I,t,e),y,a,l,n,o,d,c,h,u,g,p,i,w,b)),t=e}for(x||(x=[]);x.length<s;)x[x.length]=1;x[s]=D.breakOffsets.length,C.heightInLines+=D.breakOffsets.length-1;const m=document.createElement("div");m.className="gutter-delete",e.original.push({afterLineNumber:r,afterColumn:0,heightInLines:D.breakOffsets.length-1,domNode:createFakeLinesDiv(),marginDomNode:m})}else E=Math.max(E,this._renderOriginalLine(L++,v,_,I,y,a,l,n,o,d,c,h,u,g,p,i,w,b))}E+=s;const D=w.build(),I=ttPolicy$3?ttPolicy$3.createHTML(D):D;if(v.innerHTML=I,C.minWidthInPx=E*r,x){const e=t.originalEndLineNumber-t.originalStartLineNumber;for(;x.length<=e;)x[x.length]=1}C.diff.viewLineCounts=x}e.original.sort(((e,t)=>e.afterLineNumber-t.afterLineNumber))}_renderOriginalLine(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p,m,f,_){f.appendASCIIString('<div class="view-line'),o||f.appendASCIIString(" char-delete"),f.appendASCIIString('" style="top:'),f.appendASCIIString(String(e*d)),f.appendASCIIString('px;width:1000000px;">');const C=ViewLineRenderingData.isBasicASCII(t,r),v=ViewLineRenderingData.containsRTL(t,C,s),b=renderViewLine(new RenderLineInput(a.isMonospace&&!l,a.canUseHalfwidthRightwardsArrow,t,!1,C,v,0,i,n,m,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,h,u,g,p!==EditorFontLigatures.OFF,null),f);if(f.appendASCIIString("</div>"),this._renderIndicators){const t=document.createElement("div");t.className=`delete-sign ${ThemeIcon.asClassName(diffRemoveIcon)}`,t.setAttribute("style",`position:absolute;top:${e*d}px;width:${c}px;height:${d}px;right:0;`),_.appendChild(t)}return b.characterMapping.getAbsoluteOffset(b.characterMapping.length)}}function validateDiffWordWrap(e,t){return stringSet(e,t,["off","on","inherit"])}function isChangeOrInsert(e){return e.modifiedEndLineNumber>0}function isChangeOrDelete(e){return e.originalEndLineNumber>0}function createFakeLinesDiv(){const e=document.createElement("div");return e.className="diagonal-fill",e}function getViewRange(e,t,i,n){const o=e.getLineCount();return i=Math.min(o,Math.max(1,i)),n=Math.min(o,Math.max(1,n)),t.coordinatesConverter.convertModelRangeToViewRange(new Range$2(i,e.getLineMinColumn(i),n,e.getLineMaxColumn(n)))}function validateDiffEditorOptions(e,t){return{enableSplitViewResizing:boolean(e.enableSplitViewResizing,t.enableSplitViewResizing),renderSideBySide:boolean(e.renderSideBySide,t.renderSideBySide),maxComputationTime:clampedInt(e.maxComputationTime,t.maxComputationTime,0,1073741824),maxFileSize:clampedInt(e.maxFileSize,t.maxFileSize,0,1073741824),ignoreTrimWhitespace:boolean(e.ignoreTrimWhitespace,t.ignoreTrimWhitespace),renderIndicators:boolean(e.renderIndicators,t.renderIndicators),originalEditable:boolean(e.originalEditable,t.originalEditable),diffCodeLens:boolean(e.diffCodeLens,t.diffCodeLens),renderOverviewRuler:boolean(e.renderOverviewRuler,t.renderOverviewRuler),diffWordWrap:validateDiffWordWrap(e.diffWordWrap,t.diffWordWrap)}}function changedDiffEditorOptions(e,t){return{enableSplitViewResizing:e.enableSplitViewResizing!==t.enableSplitViewResizing,renderSideBySide:e.renderSideBySide!==t.renderSideBySide,maxComputationTime:e.maxComputationTime!==t.maxComputationTime,maxFileSize:e.maxFileSize!==t.maxFileSize,ignoreTrimWhitespace:e.ignoreTrimWhitespace!==t.ignoreTrimWhitespace,renderIndicators:e.renderIndicators!==t.renderIndicators,originalEditable:e.originalEditable!==t.originalEditable,diffCodeLens:e.diffCodeLens!==t.diffCodeLens,renderOverviewRuler:e.renderOverviewRuler!==t.renderOverviewRuler,diffWordWrap:e.diffWordWrap!==t.diffWordWrap}}registerThemingParticipant(((e,t)=>{const i=e.getColor(diffInserted);i&&t.addRule(`.monaco-editor .char-insert, .monaco-diff-editor .char-insert { background-color: ${i}; }`);const n=e.getColor(diffInsertedLine)||i;n&&t.addRule(`.monaco-editor .line-insert, .monaco-diff-editor .line-insert { background-color: ${n}; }`);const o=e.getColor(diffInsertedLineGutter)||n;o&&(t.addRule(`.monaco-editor .inline-added-margin-view-zone { background-color: ${o}; }`),t.addRule(`.monaco-editor .gutter-insert, .monaco-diff-editor .gutter-insert { background-color: ${o}; }`));const r=e.getColor(diffRemoved);r&&t.addRule(`.monaco-editor .char-delete, .monaco-diff-editor .char-delete { background-color: ${r}; }`);const s=e.getColor(diffRemovedLine)||r;s&&t.addRule(`.monaco-editor .line-delete, .monaco-diff-editor .line-delete { background-color: ${s}; }`);const a=e.getColor(diffRemovedLineGutter)||s;a&&(t.addRule(`.monaco-editor .inline-deleted-margin-view-zone { background-color: ${a}; }`),t.addRule(`.monaco-editor .gutter-delete, .monaco-diff-editor .gutter-delete { background-color: ${a}; }`));const l=e.getColor(diffInsertedOutline);l&&t.addRule(`.monaco-editor .line-insert, .monaco-editor .char-insert { border: 1px ${"hc"===e.type?"dashed":"solid"} ${l}; }`);const d=e.getColor(diffRemovedOutline);d&&t.addRule(`.monaco-editor .line-delete, .monaco-editor .char-delete { border: 1px ${"hc"===e.type?"dashed":"solid"} ${d}; }`);const c=e.getColor(scrollbarShadow);c&&t.addRule(`.monaco-diff-editor.side-by-side .editor.modified { box-shadow: -6px 0 5px -5px ${c}; }`);const h=e.getColor(diffBorder);h&&t.addRule(`.monaco-diff-editor.side-by-side .editor.modified { border-left: 1px solid ${h}; }`);const u=e.getColor(scrollbarSliderBackground);u&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport {\n\t\t\t\tbackground: ${u};\n\t\t\t}\n\t\t`);const g=e.getColor(scrollbarSliderHoverBackground);g&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:hover {\n\t\t\t\tbackground: ${g};\n\t\t\t}\n\t\t`);const p=e.getColor(scrollbarSliderActiveBackground);p&&t.addRule(`\n\t\t\t.monaco-diff-editor .diffViewport:active {\n\t\t\t\tbackground: ${p};\n\t\t\t}\n\t\t`);const m=e.getColor(diffDiagonalFill);t.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${m} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${m} 50%, ${m} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}));const defaultOptions$3={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0};class DiffNavigator extends Disposable{constructor(e,t={}){super(),this._onDidUpdate=this._register(new Emitter$1),this._editor=e,this._options=mixin(t,defaultOptions$3,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidDispose((()=>this.dispose()))),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this.nextIdx=-1)}))),this._options.alwaysRevealFirst&&this._register(this._editor.getModifiedEditor().onDidChangeModel((e=>{this.revealFirst=!0}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new Range$2(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new Range$2(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new Range$2(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((e,t)=>Range$2.compareRangesUsingStarts(e.range,t.range))),this._onDidUpdate.fire(this)}_initIdx(e){let t=!1;const i=this._editor.getPosition();if(i){for(let n=0,o=this.ranges.length;n<o&&!t;n++){const o=this.ranges[n].range;i.isBeforeOrEqual(o.getStartPosition())&&(this.nextIdx=n+(e?0:-1),t=!0)}t||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,t){if(ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const i=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const e=i.range.getStartPosition();this._editor.setPosition(e),this._editor.revealRangeInCenter(i.range,t)}finally{this.ignoreSelectionChange=!1}}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this._move(!0,e)}previous(e=0){this._move(!1,e)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}}var _a$7,_b$1;class StringIterator{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){return e.charCodeAt(0)-this._value.charCodeAt(this._pos)}value(){return this._value[this._pos]}}class ConfigKeysIterator{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++){if(46===this._value.charCodeAt(this._to)){if(!e)break;this._from++}else e=!1}return this}cmp(e){return this._caseSensitive?compareSubstring(e,this._value,0,e.length,this._from,this._to):compareSubstringIgnoreCase(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class PathIterator{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const e=this._value.charCodeAt(t);if(!(47===e||this._splitOnBackslash&&92===e))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(47===t||this._splitOnBackslash&&92===t){if(!e)break;this._from++}else e=!1}return this}cmp(e){return this._caseSensitive?compareSubstring(e,this._value,0,e.length,this._from,this._to):compareSubstringIgnoreCase(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class UriIterator{constructor(e){this._ignorePathCasing=e,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new PathIterator(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5),this._stateIdx=0,this}next(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return 3===this._states[this._stateIdx]&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(1===this._states[this._stateIdx])return compareIgnoreCase(e,this._value.scheme);if(2===this._states[this._stateIdx])return compareIgnoreCase(e,this._value.authority);if(3===this._states[this._stateIdx])return this._pathIterator.cmp(e);if(4===this._states[this._stateIdx])return compare(e,this._value.query);if(5===this._states[this._stateIdx])return compare(e,this._value.fragment);throw new Error}value(){if(1===this._states[this._stateIdx])return this._value.scheme;if(2===this._states[this._stateIdx])return this._value.authority;if(3===this._states[this._stateIdx])return this._pathIterator.value();if(4===this._states[this._stateIdx])return this._value.query;if(5===this._states[this._stateIdx])return this._value.fragment;throw new Error}}class TernarySearchTreeNode{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e,t;return null!==(t=null===(e=this.left)||void 0===e?void 0:e.height)&&void 0!==t?t:0}get heightRight(){var e,t;return null!==(t=null===(e=this.right)||void 0===e?void 0:e.height)&&void 0!==t?t:0}}class TernarySearchTree{constructor(e){this._iter=e}static forUris(e=(()=>!1)){return new TernarySearchTree(new UriIterator(e))}static forStrings(){return new TernarySearchTree(new StringIterator)}static forConfigKeys(){return new TernarySearchTree(new ConfigKeysIterator)}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new TernarySearchTreeNode,this._root.segment=i.value());const o=[];for(n=this._root;;){const e=i.cmp(n.segment);if(e>0)n.left||(n.left=new TernarySearchTreeNode,n.left.segment=i.value()),o.push([-1,n]),n=n.left;else if(e<0)n.right||(n.right=new TernarySearchTreeNode,n.right.segment=i.value()),o.push([1,n]),n=n.right;else{if(!i.hasNext())break;i.next(),n.mid||(n.mid=new TernarySearchTreeNode,n.mid.segment=i.value()),o.push([0,n]),n=n.mid}}const r=n.value;n.value=t,n.key=e;for(let s=o.length-1;s>=0;s--){const e=o[s][1];e.updateHeight();const t=e.balanceFactor();if(t<-1||t>1){const t=o[s][0],i=o[s+1][0];if(1===t&&1===i)o[s][1]=e.rotateLeft();else if(-1===t&&-1===i)o[s][1]=e.rotateRight();else if(1===t&&-1===i)e.right=o[s+1][1]=o[s+1][1].rotateRight(),o[s][1]=e.rotateLeft();else{if(-1!==t||1!==i)throw new Error;e.left=o[s+1][1]=o[s+1][1].rotateLeft(),o[s][1]=e.rotateRight()}if(s>0)switch(o[s-1][0]){case-1:o[s-1][1].left=o[s][1];break;case 1:o[s-1][1].right=o[s][1];break;case 0:o[s-1][1].mid=o[s][1]}else this._root=o[0][1]}}return r}get(e){var t;return null===(t=this._getNode(e))||void 0===t?void 0:t.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const e=t.cmp(i.segment);if(e>0)i=i.left;else if(e<0)i=i.right;else{if(!t.hasNext())break;t.next(),i=i.mid}}return i}has(e){const t=this._getNode(e);return!(void 0===(null==t?void 0:t.value)&&void 0===(null==t?void 0:t.mid))}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){var i;const n=this._iter.reset(e),o=[];let r=this._root;for(;r;){const e=n.cmp(r.segment);if(e>0)o.push([-1,r]),r=r.left;else if(e<0)o.push([1,r]),r=r.right;else{if(!n.hasNext())break;n.next(),o.push([0,r]),r=r.mid}}if(r){if(t?(r.left=void 0,r.mid=void 0,r.right=void 0,r.height=1):(r.key=void 0,r.value=void 0),!r.mid&&!r.value)if(r.left&&r.right){const e=this._min(r.right),{key:t,value:i,segment:n}=e;this._delete(e.key,!1),r.key=t,r.value=i,r.segment=n}else{const e=null!==(i=r.left)&&void 0!==i?i:r.right;if(o.length>0){const[t,i]=o[o.length-1];switch(t){case-1:i.left=e;break;case 0:i.mid=e;break;case 1:i.right=e}}else this._root=e}for(let e=o.length-1;e>=0;e--){const t=o[e][1];t.updateHeight();const i=t.balanceFactor();if(i>1?(t.right.balanceFactor()>=0||(t.right=t.right.rotateRight()),o[e][1]=t.rotateLeft()):i<-1&&(t.left.balanceFactor()<=0||(t.left=t.left.rotateLeft()),o[e][1]=t.rotateRight()),e>0)switch(o[e-1][0]){case-1:o[e-1][1].left=o[e][1];break;case 1:o[e-1][1].right=o[e][1];break;case 0:o[e-1][1].mid=o[e][1]}else this._root=o[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i,n=this._root;for(;n;){const e=t.cmp(n.segment);if(e>0)n=n.left;else if(e<0)n=n.right;else{if(!t.hasNext())break;t.next(),i=n.value||i,n=n.mid}}return n&&n.value||i}findSuperstr(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const e=t.cmp(i.segment);if(e>0)i=i.left;else if(e<0)i=i.right;else{if(!t.hasNext())return i.mid?this._entries(i.mid):void 0;t.next(),i=i.mid}}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}*_entries(e){e&&(e.left&&(yield*this._entries(e.left)),e.value&&(yield[e.key,e.value]),e.mid&&(yield*this._entries(e.mid)),e.right&&(yield*this._entries(e.right)))}}class ResourceMapEntry{constructor(e,t){this.uri=e,this.value=t}}class ResourceMap{constructor(e,t){this[_a$7]="ResourceMap",e instanceof ResourceMap?(this.map=new Map(e.map),this.toKey=null!=t?t:ResourceMap.defaultToKey):(this.map=new Map,this.toKey=null!=e?e:ResourceMap.defaultToKey)}set(e,t){return this.map.set(this.toKey(e),new ResourceMapEntry(e,t)),this}get(e){var t;return null===(t=this.map.get(this.toKey(e)))||void 0===t?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){void 0!==t&&(e=e.bind(t));for(let[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(_a$7=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}}ResourceMap.defaultToKey=e=>e.toString();class LinkedMap{constructor(){this[_b$1]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return null===(e=this._head)||void 0===e?void 0:e.value}get last(){var e;return null===(e=this._tail)||void 0===e?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return 0!==t&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,0!==i&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:case 2:default:this.addItemLast(n);break;case 1:this.addItemFirst(n)}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator]:()=>n,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const e={value:i.key,done:!1};return i=i.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator]:()=>n,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const e={value:i.value,done:!1};return i=i.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator]:()=>n,next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const e={value:[i.key,i.value],done:!1};return i=i.next,e}return{value:void 0,done:!0}}};return n}[(_b$1=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(1===t||2===t)if(1===t){if(e===this._head)return;const t=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(2===t){if(e===this._tail)return;const t=e.next,i=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,i)=>{e.push([i,t])})),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class LRUCache extends LinkedMap{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}function or(...e){return function(t,i){for(let n=0,o=e.length;n<o;n++){const o=e[n](t,i);if(o)return o}return null}}_matchesPrefix.bind(void 0,!1);const matchesPrefix=_matchesPrefix.bind(void 0,!0);function _matchesPrefix(e,t,i){if(!i||i.length<t.length)return null;let n;return n=e?startsWithIgnoreCase(i,t):0===i.indexOf(t),n?t.length>0?[{start:0,end:t.length}]:[]:null}function matchesContiguousSubString(e,t){const i=t.toLowerCase().indexOf(e.toLowerCase());return-1===i?null:[{start:i,end:i+e.length}]}function matchesSubString(e,t){return _matchesSubString(e.toLowerCase(),t.toLowerCase(),0,0)}function _matchesSubString(e,t,i,n){if(i===e.length)return[];if(n===t.length)return null;if(e[i]===t[n]){let o=null;return(o=_matchesSubString(e,t,i+1,n+1))?join({start:n,end:n+1},o):null}return _matchesSubString(e,t,i,n+1)}function isLower(e){return 97<=e&&e<=122}function isUpper(e){return 65<=e&&e<=90}function isNumber(e){return 48<=e&&e<=57}function isWhitespace(e){return 32===e||9===e||10===e||13===e}const wordSeparators=new Set;function isAlphanumeric(e){return isLower(e)||isUpper(e)||isNumber(e)}function join(e,t){return 0===t.length?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function nextAnchor(e,t){for(let i=t;i<e.length;i++){const t=e.charCodeAt(i);if(isUpper(t)||isNumber(t)||i>0&&!isAlphanumeric(e.charCodeAt(i-1)))return i}return e.length}function _matchesCamelCase(e,t,i,n){if(i===e.length)return[];if(n===t.length)return null;if(e[i]!==t[n].toLowerCase())return null;{let o=null,r=n+1;for(o=_matchesCamelCase(e,t,i+1,n+1);!o&&(r=nextAnchor(t,r))<t.length;)o=_matchesCamelCase(e,t,i+1,r),r++;return null===o?null:join({start:n,end:n+1},o)}}function analyzeCamelCaseWord(e){let t=0,i=0,n=0,o=0,r=0;for(let s=0;s<e.length;s++)r=e.charCodeAt(s),isUpper(r)&&t++,isLower(r)&&i++,isAlphanumeric(r)&&n++,isNumber(r)&&o++;return{upperPercent:t/e.length,lowerPercent:i/e.length,alphaPercent:n/e.length,numericPercent:o/e.length}}function isUpperCaseWord(e){const{upperPercent:t,lowerPercent:i}=e;return 0===i&&t>.6}function isCamelCaseWord(e){const{upperPercent:t,lowerPercent:i,alphaPercent:n,numericPercent:o}=e;return i>.2&&t<.8&&n>.6&&o<.2}function isCamelCasePattern(e){let t=0,i=0,n=0,o=0;for(let r=0;r<e.length;r++)n=e.charCodeAt(r),isUpper(n)&&t++,isLower(n)&&i++,isWhitespace(n)&&o++;return 0!==t&&0!==i||0!==o?t<=5:e.length<=30}function matchesCamelCase(e,t){if(!t)return null;if(0===(t=t.trim()).length)return null;if(!isCamelCasePattern(e))return null;if(t.length>60)return null;const i=analyzeCamelCaseWord(t);if(!isCamelCaseWord(i)){if(!isUpperCaseWord(i))return null;t=t.toLowerCase()}let n=null,o=0;for(e=e.toLowerCase();o<t.length&&null===(n=_matchesCamelCase(e,t,0,o));)o=nextAnchor(t,o+1);return n}"()[]{}<>`'\"-/;:,.?!".split("").forEach((e=>wordSeparators.add(e.charCodeAt(0))));const fuzzyContiguousFilter=or(matchesPrefix,matchesCamelCase,matchesContiguousSubString),fuzzySeparateFilter=or(matchesPrefix,matchesCamelCase,matchesSubString),fuzzyRegExpCache=new LRUCache(1e4);function matchesFuzzy(e,t,i=!1){if("string"!=typeof e||"string"!=typeof t)return null;let n=fuzzyRegExpCache.get(e);n||(n=new RegExp(convertSimple2RegExpPattern(e),"i"),fuzzyRegExpCache.set(e,n));const o=n.exec(t);return o?[{start:o.index,end:o.index+o[0].length}]:i?fuzzySeparateFilter(e,t):fuzzyContiguousFilter(e,t)}function anyScore(e,t,i,n,o,r){const s=Math.min(13,e.length);for(;i<s;i++){const s=fuzzyScore(e,t,i,n,o,r,!1);if(s)return s}return[0,r]}function createMatches(e){if(void 0===e)return[];const t=[],i=e[1];for(let n=e.length-1;n>1;n--){const o=e[n]+i,r=t[t.length-1];r&&r.end===o?r.end=o+1:t.push({start:o,end:o+1})}return t}const _maxLen=128;function initTable(){const e=[],t=[];for(let i=0;i<=_maxLen;i++)t[i]=0;for(let i=0;i<=_maxLen;i++)e.push(t.slice(0));return e}function initArr(e){const t=[];for(let i=0;i<=e;i++)t[i]=0;return t}const _minWordMatchPos=initArr(2*_maxLen),_maxWordMatchPos=initArr(2*_maxLen),_diag=initTable(),_table=initTable(),_arrows=initTable();function isSeparatorAtPos(e,t){if(t<0||t>=e.length)return!1;const i=e.codePointAt(t);switch(i){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 40:case 91:return!0;case void 0:return!1;default:return!!isEmojiImprecise(i)}}function isWhitespaceAtPos(e,t){if(t<0||t>=e.length)return!1;switch(e.charCodeAt(t)){case 32:case 9:return!0;default:return!1}}function isUpperCaseAtPos(e,t,i){return t[e]!==i[e]}function isPatternInWord(e,t,i,n,o,r,s=!1){for(;t<i&&o<r;)e[t]===n[o]&&(s&&(_minWordMatchPos[t]=o),t+=1),o+=1;return t===i}var FuzzyScore,FuzzyScore2;function fuzzyScore(e,t,i,n,o,r,s){const a=e.length>_maxLen?_maxLen:e.length,l=n.length>_maxLen?_maxLen:n.length;if(i>=a||r>=l||a-i>l-r)return;if(!isPatternInWord(t,i,a,o,r,l,!0))return;_fillInMaxWordMatchPos(a,l,i,r,t,o);let d=1,c=1,h=i,u=r;const g=[!1];for(d=1,h=i;h<a;d++,h++){const s=_minWordMatchPos[h],p=_maxWordMatchPos[h],m=h+1<a?_maxWordMatchPos[h+1]:l;for(c=s-r+1,u=s;u<m;c++,u++){let a=Number.MIN_SAFE_INTEGER,m=!1;u<=p&&(a=_doScore(e,t,h,i,n,o,u,l,r,0===_diag[d-1][c-1],g));let f=0;a!==Number.MAX_SAFE_INTEGER&&(m=!0,f=a+_table[d-1][c-1]);const _=u>s,C=_?_table[d][c-1]+(_diag[d][c-1]>0?-5:0):0,v=u>s+1&&_diag[d][c-1]>0,b=v?_table[d][c-2]+(_diag[d][c-2]>0?-5:0):0;if(v&&(!_||b>=C)&&(!m||b>=f))_table[d][c]=b,_arrows[d][c]=3,_diag[d][c]=0;else if(_&&(!m||C>=f))_table[d][c]=C,_arrows[d][c]=2,_diag[d][c]=0;else{if(!m)throw new Error("not possible");_table[d][c]=f,_arrows[d][c]=1,_diag[d][c]=_diag[d-1][c-1]+1}}}if(!g[0]&&!s)return;d--,c--;const p=[_table[d][c],r];let m=0,f=0;for(;d>=1;){let e=c;do{const t=_arrows[d][e];if(3===t)e-=2;else{if(2!==t)break;e-=1}}while(e>=1);m>1&&t[i+d-1]===o[r+c-1]&&!isUpperCaseAtPos(e+r-1,n,o)&&m+1>_diag[d][e]&&(e=c),e===c?m++:m=1,f||(f=e),d--,c=e-1,p.push(c)}l===a&&(p[0]+=2);const _=f-a;return p[0]-=_,p}function _fillInMaxWordMatchPos(e,t,i,n,o,r){let s=e-1,a=t-1;for(;s>=i&&a>=n;)o[s]===r[a]&&(_maxWordMatchPos[s]=a,s--),a--}function _doScore(e,t,i,n,o,r,s,a,l,d,c){if(t[i]!==r[s])return Number.MIN_SAFE_INTEGER;let h=1,u=!1;return s===i-n?h=e[i]===o[s]?7:5:!isUpperCaseAtPos(s,o,r)||0!==s&&isUpperCaseAtPos(s-1,o,r)?!isSeparatorAtPos(r,s)||0!==s&&isSeparatorAtPos(r,s-1)?(isSeparatorAtPos(r,s-1)||isWhitespaceAtPos(r,s-1))&&(h=5,u=!0):h=5:(h=e[i]===o[s]?7:5,u=!0),h>1&&i===n&&(c[0]=!0),u||(u=isUpperCaseAtPos(s,o,r)||isSeparatorAtPos(r,s-1)||isWhitespaceAtPos(r,s-1)),i===n?s>l&&(h-=u?3:5):h+=d?u?2:0:u?0:1,s+1===a&&(h-=u?3:5),h}function fuzzyScoreGracefulAggressive(e,t,i,n,o,r,s){return fuzzyScoreWithPermutations(e,t,i,n,o,r,!0,s)}function fuzzyScoreWithPermutations(e,t,i,n,o,r,s,a){let l=fuzzyScore(e,t,i,n,o,r,a);if(l&&!s)return l;if(e.length>=3){const t=Math.min(7,e.length-1);for(let s=i+1;s<t;s++){const t=nextTypoPermutation(e,s);if(t){const e=fuzzyScore(t,t.toLowerCase(),i,n,o,r,a);e&&(e[0]-=3,(!l||e[0]>l[0])&&(l=e))}}}return l}function nextTypoPermutation(e,t){if(t+1>=e.length)return;const i=e[t],n=e[t+1];return i!==n?e.slice(0,t)+n+i+e.slice(t+2):void 0}FuzzyScore2=FuzzyScore||(FuzzyScore={}),FuzzyScore2.Default=[-100,0],FuzzyScore2.isDefault=function(e){return!e||2===e.length&&-100===e[0]&&0===e[1]};const iconStartMarker="$(",iconsRegex=new RegExp(`\\$\\(${CSSIcon.iconNameExpression}(?:${CSSIcon.iconModifierExpression})?\\)`,"g"),iconNameCharacterRegexp=new RegExp(CSSIcon.iconNameCharacter),escapeIconsRegex=new RegExp(`(\\\\)?${iconsRegex.source}`,"g");function escapeIcons(e){return e.replace(escapeIconsRegex,((e,t)=>t?e:`\\${e}`))}const markdownEscapedIconsRegex=new RegExp(`\\\\${iconsRegex.source}`,"g");function markdownEscapeEscapedIcons(e){return e.replace(markdownEscapedIconsRegex,(e=>`\\${e}`))}const stripIconsRegex=new RegExp(`(\\s)?(\\\\)?${iconsRegex.source}(\\s)?`,"g");function stripIcons(e){return-1===e.indexOf(iconStartMarker)?e:e.replace(stripIconsRegex,((e,t,i,n)=>i?e:t||n||""))}function parseLabelWithIcons(e){const t=e.indexOf(iconStartMarker);return-1===t?{text:e}:doParseLabelWithIcons(e,t)}function doParseLabelWithIcons(e,t){const i=[];let n="";function o(e){if(e){n+=e;for(const t of e)i.push(d)}}let r,s,a=-1,l="",d=0,c=t;const h=e.length;for(o(e.substr(0,t));c<h;){if(r=e[c],s=e[c+1],r===iconStartMarker[0]&&s===iconStartMarker[1])a=c,o(l),l=iconStartMarker,c++;else if(")"===r&&-1!==a){d+=c-a+1,a=-1,l=""}else-1!==a?iconNameCharacterRegexp.test(r)?l+=r:(o(l),a=-1,l=""):o(r);c++}return o(l),{text:n,iconOffsets:i}}function matchesFuzzyIconAware(e,t,i=!1){const{text:n,iconOffsets:o}=t;if(!o||0===o.length)return matchesFuzzy(e,n,i);const r=ltrim(n," "),s=n.length-r.length,a=matchesFuzzy(e,r,i);if(a)for(const l of a){const e=o[l.start+s]+s;l.start+=e,l.end+=e}return a}class MarkdownString{constructor(e="",t=!1){var i,n,o;if(this.value=e,"string"!=typeof this.value)throw illegalArgument("value");"boolean"==typeof t?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=null!==(i=t.isTrusted)&&void 0!==i?i:void 0,this.supportThemeIcons=null!==(n=t.supportThemeIcons)&&void 0!==n&&n,this.supportHtml=null!==(o=t.supportHtml)&&void 0!==o&&o)}appendText(e,t=0){return this.value+=escapeMarkdownSyntaxTokens(this.supportThemeIcons?escapeIcons(e):e).replace(/([ \t]+)/g,((e,t)=>"&nbsp;".repeat(t.length))).replace(/\>/gm,"\\>").replace(/\n/g,1===t?"\\\n":"\n\n"),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+="\n```",this.value+=e,this.value+="\n",this.value+=t,this.value+="\n```\n",this}}function isEmptyMarkdownString(e){return isMarkdownString(e)?!e.value:!Array.isArray(e)||e.every(isEmptyMarkdownString)}function isMarkdownString(e){return e instanceof MarkdownString||!(!e||"object"!=typeof e)&&!("string"!=typeof e.value||"boolean"!=typeof e.isTrusted&&void 0!==e.isTrusted||"boolean"!=typeof e.supportThemeIcons&&void 0!==e.supportThemeIcons)}function escapeMarkdownSyntaxTokens(e){return e.replace(/[\\`*_{}[\]()#+\-!]/g,"\\$&")}function removeMarkdownEscapes(e){return e?e.replace(/\\([\\`*_{}[\]()#+\-.!])/g,"$1"):e}function parseHrefAndDimensions(e){const t=[],i=e.split("|").map((e=>e.trim()));e=i[0];const n=i[1];if(n){const e=/height=(\d+)/.exec(n),i=/width=(\d+)/.exec(n),o=e?e[1]:"",r=i?i[1]:"",s=isFinite(parseInt(r)),a=isFinite(parseInt(o));s&&t.push(`width="${r}"`),a&&t.push(`height="${o}"`)}return{href:e,dimensions:t}}var anchorSelect="",__decorate$1r=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1n=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$$=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const SelectionAnchorSet=new RawContextKey("selectionAnchorSet",!1);let SelectionAnchorController=class e{constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=SelectionAnchorSet.bindTo(t),this.modelChangeListener=e.onDidChangeModel((()=>this.selectionAnchorSetContextKey.reset()))}static get(t){return t.getContribution(e.ID)}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition(),t=this.decorationId?[this.decorationId]:[],i=this.editor.deltaDecorations(t,[{range:Selection$1.fromPositions(e,e),options:{description:"selection-anchor",stickiness:1,hoverMessage:(new MarkdownString).appendText(localize("selectionAnchor","Selection Anchor")),className:"selection-anchor"}}]);this.decorationId=i[0],this.selectionAnchorSetContextKey.set(!!this.decorationId),alert(localize("anchorSet","Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(Selection$1.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){this.decorationId&&(this.editor.deltaDecorations([this.decorationId],[]),this.decorationId=void 0,this.selectionAnchorSetContextKey.set(!1))}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};SelectionAnchorController.ID="editor.contrib.selectionAnchorController",SelectionAnchorController=__decorate$1r([__param$1n(1,IContextKeyService)],SelectionAnchorController);class SetSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.setSelectionAnchor",label:localize("setSelectionAnchor","Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2080),weight:100}})}run(e,t){var i;return __awaiter$$(this,void 0,void 0,(function*(){null===(i=SelectionAnchorController.get(t))||void 0===i||i.setSelectionAnchor()}))}}class GoToSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.goToSelectionAnchor",label:localize("goToSelectionAnchor","Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:SelectionAnchorSet})}run(e,t){var i;return __awaiter$$(this,void 0,void 0,(function*(){null===(i=SelectionAnchorController.get(t))||void 0===i||i.goToSelectionAnchor()}))}}class SelectFromAnchorToCursor extends EditorAction{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:localize("selectFromAnchorToCursor","Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:SelectionAnchorSet,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2089),weight:100}})}run(e,t){var i;return __awaiter$$(this,void 0,void 0,(function*(){null===(i=SelectionAnchorController.get(t))||void 0===i||i.selectFromAnchorToCursor()}))}}class CancelSelectionAnchor extends EditorAction{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:localize("cancelSelectionAnchor","Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:SelectionAnchorSet,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:9,weight:100}})}run(e,t){var i;return __awaiter$$(this,void 0,void 0,(function*(){null===(i=SelectionAnchorController.get(t))||void 0===i||i.cancelSelectionAnchor()}))}}registerEditorContribution(SelectionAnchorController.ID,SelectionAnchorController),registerEditorAction(SetSelectionAnchor),registerEditorAction(GoToSelectionAnchor),registerEditorAction(SelectFromAnchorToCursor),registerEditorAction(CancelSelectionAnchor);var bracketMatching="";const overviewRulerBracketMatchForeground=registerColor("editorOverviewRuler.bracketMatchForeground",{dark:"#A0A0A0",light:"#A0A0A0",hc:"#A0A0A0"},localize("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class JumpToBracketAction extends EditorAction{constructor(){super({id:"editor.action.jumpToBracket",label:localize("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3160,weight:100}})}run(e,t){var i;null===(i=BracketMatchingController.get(t))||void 0===i||i.jumpToBracket()}}class SelectToBracketAction extends EditorAction{constructor(){super({id:"editor.action.selectToBracket",label:localize("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,description:{description:"Select to Bracket",args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){var n;let o=!0;i&&!1===i.selectBrackets&&(o=!1),null===(n=BracketMatchingController.get(t))||void 0===n||n.selectToBracket(o)}}class BracketsData{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}class BracketMatchingController extends Disposable{constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new RunOnceScheduler((()=>this._updateBrackets()),50)),this._matchBrackets=this._editor.getOption(64),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition((e=>{"never"!==this._matchBrackets&&this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModelContent((e=>{this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModel((e=>{this._lastBracketsData=[],this._decorations=[],this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeModelLanguageConfiguration((e=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(64)&&(this._matchBrackets=this._editor.getOption(64),this._decorations=this._editor.deltaDecorations(this._decorations,[]),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())}))),this._register(e.onDidBlurEditorWidget((()=>{this._updateBracketsSoon.schedule()}))),this._register(e.onDidFocusEditorWidget((()=>{this._updateBracketsSoon.schedule()})))}static get(e){return e.getContribution(BracketMatchingController.ID)}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map((t=>{const i=t.getStartPosition(),n=e.bracketPairs.matchBracket(i);let o=null;if(n)n[0].containsPosition(i)?o=n[1].getStartPosition():n[1].containsPosition(i)&&(o=n[0].getStartPosition());else{const t=e.bracketPairs.findEnclosingBrackets(i);if(t)o=t[0].getStartPosition();else{const t=e.bracketPairs.findNextBracket(i);t&&t.range&&(o=t.range.getStartPosition())}}return o?new Selection$1(o.lineNumber,o.column,o.lineNumber,o.column):new Selection$1(i.lineNumber,i.column,i.lineNumber,i.column)}));this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach((n=>{const o=n.getStartPosition();let r=t.bracketPairs.matchBracket(o);if(!r&&(r=t.bracketPairs.findEnclosingBrackets(o),!r)){const e=t.bracketPairs.findNextBracket(o);e&&e.range&&(r=t.bracketPairs.matchBracket(e.range.getStartPosition()))}let s=null,a=null;if(r){r.sort(Range$2.compareRangesUsingStarts);const[t,i]=r;if(s=e?t.getStartPosition():t.getEndPosition(),a=e?i.getEndPosition():i.getStartPosition(),i.containsPosition(o)){const e=s;s=a,a=e}}s&&a&&i.push(new Selection$1(s.lineNumber,s.column,a.lineNumber,a.column))})),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}_updateBrackets(){if("never"===this._matchBrackets)return;this._recomputeBrackets();let e=[],t=0;for(const i of this._lastBracketsData){let n=i.brackets;n&&(e[t++]={range:n[0],options:i.options},e[t++]={range:n[1],options:i.options})}this._decorations=this._editor.deltaDecorations(this._decorations,e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus())return this._lastBracketsData=[],void(this._lastVersionId=0);const e=this._editor.getSelections();if(e.length>100)return this._lastBracketsData=[],void(this._lastVersionId=0);const t=this._editor.getModel(),i=t.getVersionId();let n=[];this._lastVersionId===i&&(n=this._lastBracketsData);let o=[],r=0;for(let c=0,h=e.length;c<h;c++){let t=e[c];t.isEmpty()&&(o[r++]=t.getStartPosition())}o.length>1&&o.sort(Position$1.compare);let s=[],a=0,l=0,d=n.length;for(let c=0,h=o.length;c<h;c++){let e=o[c];for(;l<d&&n[l].position.isBefore(e);)l++;if(l<d&&n[l].position.equals(e))s[a++]=n[l];else{let i=t.bracketPairs.matchBracket(e,20),n=BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;i||"always"!==this._matchBrackets||(i=t.bracketPairs.findEnclosingBrackets(e,20),n=BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),s[a++]=new BracketsData(e,i,n)}}this._lastBracketsData=s,this._lastVersionId=i}}BracketMatchingController.ID="editor.contrib.bracketMatchingController",BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=ModelDecorationOptions.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:themeColorFromId(overviewRulerBracketMatchForeground),position:OverviewRulerLane$1.Center}}),BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=ModelDecorationOptions.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"}),registerEditorContribution(BracketMatchingController.ID,BracketMatchingController),registerEditorAction(SelectToBracketAction),registerEditorAction(JumpToBracketAction),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorBracketMatchBackground);i&&t.addRule(`.monaco-editor .bracket-match { background-color: ${i}; }`);const n=e.getColor(editorBracketMatchBorder);n&&t.addRule(`.monaco-editor .bracket-match { border: 1px solid ${n}; }`)})),MenuRegistry.appendMenuItem(MenuId.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:localize({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});class MoveCaretCommand{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const i=this._selection.startLineNumber,n=this._selection.startColumn,o=this._selection.endColumn;if((!this._isMovingLeft||1!==n)&&(this._isMovingLeft||o!==e.getLineMaxColumn(i)))if(this._isMovingLeft){const r=new Range$2(i,n-1,i,n),s=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new Range$2(i,o,i,o),s)}else{const r=new Range$2(i,o,i,o+1),s=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new Range$2(i,n,i,n),s)}}computeCursorState(e,t){return this._isMovingLeft?new Selection$1(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new Selection$1(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class MoveCaretAction extends EditorAction{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;const i=[],n=t.getSelections();for(const o of n)i.push(new MoveCaretCommand(o,this.left));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class MoveCaretLeftAction extends MoveCaretAction{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:localize("caret.moveLeft","Move Selected Text Left"),alias:"Move Selected Text Left",precondition:EditorContextKeys.writable})}}class MoveCaretRightAction extends MoveCaretAction{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:localize("caret.moveRight","Move Selected Text Right"),alias:"Move Selected Text Right",precondition:EditorContextKeys.writable})}}registerEditorAction(MoveCaretLeftAction),registerEditorAction(MoveCaretRightAction);class TransposeLettersAction extends EditorAction{constructor(){super({id:"editor.action.transposeLetters",label:localize("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;let i=t.getModel(),n=[],o=t.getSelections();for(let r of o){if(!r.isEmpty())continue;let e=r.startLineNumber,t=r.startColumn,o=i.getLineMaxColumn(e);if(1===e&&(1===t||2===t&&2===o))continue;let s=t===o?r.getPosition():MoveOperations.rightPosition(i,r.getPosition().lineNumber,r.getPosition().column),a=MoveOperations.leftPosition(i,s),l=MoveOperations.leftPosition(i,a),d=i.getValueInRange(Range$2.fromPositions(l,a)),c=i.getValueInRange(Range$2.fromPositions(a,s)),h=Range$2.fromPositions(l,s);n.push(new ReplaceCommand(h,c+d))}n.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop())}}registerEditorAction(TransposeLettersAction);var __awaiter$_=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const CLIPBOARD_CONTEXT_MENU_GROUP="9_cutcopypaste",supportsCut=isNative||document.queryCommandSupported("cut"),supportsCopy=isNative||document.queryCommandSupported("copy"),supportsPaste=void 0!==navigator.clipboard&&!isFirefox||document.queryCommandSupported("paste");function registerCommand$1(e){return e.register(),e}const CutAction=supportsCut?registerCommand$1(new MultiCommand({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:isNative?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miCut",comment:["&& denotes a mnemonic"]},"Cu&&t"),order:1},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.cutLabel","Cut"),when:EditorContextKeys.writable,order:1},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.cutLabel","Cut"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.cutLabel","Cut"),when:EditorContextKeys.writable,order:1}]})):void 0,CopyAction=supportsCopy?registerCommand$1(new MultiCommand({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:isNative?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miCopy",comment:["&& denotes a mnemonic"]},"&&Copy"),order:2},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.copyLabel","Copy"),order:2},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.copyLabel","Copy"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.copyLabel","Copy"),order:2}]})):void 0;MenuRegistry.appendMenuItem(MenuId.MenubarEditMenu,{submenu:MenuId.MenubarCopy,title:{value:localize("copy as","Copy As"),original:"Copy As"},group:"2_ccp",order:3}),MenuRegistry.appendMenuItem(MenuId.EditorContext,{submenu:MenuId.EditorContextCopy,title:{value:localize("copy as","Copy As"),original:"Copy As"},group:CLIPBOARD_CONTEXT_MENU_GROUP,order:3});const PasteAction=supportsPaste?registerCommand$1(new MultiCommand({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:isNative?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:MenuId.MenubarEditMenu,group:"2_ccp",title:localize({key:"miPaste",comment:["&& denotes a mnemonic"]},"&&Paste"),order:4},{menuId:MenuId.EditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.pasteLabel","Paste"),when:EditorContextKeys.writable,order:4},{menuId:MenuId.CommandPalette,group:"",title:localize("actions.clipboard.pasteLabel","Paste"),order:1},{menuId:MenuId.SimpleEditorContext,group:CLIPBOARD_CONTEXT_MENU_GROUP,title:localize("actions.clipboard.pasteLabel","Paste"),when:EditorContextKeys.writable,order:4}]})):void 0;class ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:localize("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,weight:100}})}run(e,t){if(!t.hasModel())return;!t.getOption(32)&&t.getSelection().isEmpty()||(CopyOptions.forceCopyWithSyntaxHighlighting=!0,t.focus(),document.execCommand("copy"),CopyOptions.forceCopyWithSyntaxHighlighting=!1)}}function registerExecCommandImpl(e,t){e&&(e.addImplementation(1e4,"code-editor",((e,i)=>{const n=e.get(ICodeEditorService).getFocusedCodeEditor();if(n&&n.hasTextFocus()){const e=n.getOption(32),i=n.getSelection();return i&&i.isEmpty()&&!e||document.execCommand(t),!0}return!1})),e.addImplementation(0,"generic-dom",((e,i)=>(document.execCommand(t),!0))))}registerExecCommandImpl(CutAction,"cut"),registerExecCommandImpl(CopyAction,"copy"),PasteAction&&(PasteAction.addImplementation(1e4,"code-editor",((e,t)=>{const i=e.get(ICodeEditorService),n=e.get(IClipboardService),o=i.getFocusedCodeEditor();if(o&&o.hasTextFocus()){return!(!document.execCommand("paste")&&isWeb)||__awaiter$_(void 0,void 0,void 0,(function*(){const e=yield n.readText();if(""!==e){const t=InMemoryClipboardMetadataManager.INSTANCE.get(e);let i=!1,n=null,r=null;t&&(i=o.getOption(32)&&!!t.isFromEmptySelection,n=void 0!==t.multicursorText?t.multicursorText:null,r=t.mode),o.trigger("keyboard","paste",{text:e,pasteOnNewLine:i,multicursorText:n,mode:r})}}))}return!1})),PasteAction.addImplementation(0,"generic-dom",((e,t)=>(document.execCommand("paste"),!0)))),supportsCopy&&registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);const IBulkEditService=createDecorator("IWorkspaceEditService");function isWorkspaceFileEdit(e){return isObject(e)&&(Boolean(e.newUri)||Boolean(e.oldUri))}function isWorkspaceTextEdit(e){return isObject(e)&&URI.isUri(e.resource)&&isObject(e.edit)}class ResourceEdit{constructor(e){this.metadata=e}static convert(e){return e.edits.map((e=>{if(isWorkspaceTextEdit(e))return new ResourceTextEdit(e.resource,e.edit,e.modelVersionId,e.metadata);if(isWorkspaceFileEdit(e))return new ResourceFileEdit(e.oldUri,e.newUri,e.options,e.metadata);throw new Error("Unsupported edit")}))}}class ResourceTextEdit extends ResourceEdit{constructor(e,t,i,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class ResourceFileEdit extends ResourceEdit{constructor(e,t,i,n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const IEditorCancellationTokens=createDecorator("IEditorCancelService"),ctxCancellableOperation=new RawContextKey("cancellableOperation",!1,localize("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));registerSingleton(IEditorCancellationTokens,class{constructor(){this._tokens=new WeakMap}add(e,t){let i,n=this._tokens.get(e);return n||(n=e.invokeWithinContext((e=>({key:ctxCancellableOperation.bindTo(e.get(IContextKeyService)),tokens:new LinkedList}))),this._tokens.set(e,n)),n.key.set(!0),i=n.tokens.push(t),()=>{i&&(i(),n.key.set(!n.tokens.isEmpty()),i=void 0)}}cancel(e){const t=this._tokens.get(e);if(!t)return;const i=t.tokens.pop();i&&(i.cancel(),t.key.set(!t.tokens.isEmpty()))}},!0);class EditorKeybindingCancellationTokenSource extends CancellationTokenSource$1{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext((t=>t.get(IEditorCancellationTokens).add(e,this)))}dispose(){this._unregister(),super.dispose()}}registerEditorCommand(new class extends EditorCommand{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:ctxCancellableOperation})}runEditorCommand(e,t){e.get(IEditorCancellationTokens).cancel(t)}});class EditorState$1{constructor(e,t){if(this.flags=t,0!=(1&this.flags)){const t=e.getModel();this.modelVersionId=t?format("{0}#{1}",t.uri.toString(),t.getVersionId()):null}else this.modelVersionId=null;0!=(4&this.flags)?this.position=e.getPosition():this.position=null,0!=(2&this.flags)?this.selection=e.getSelection():this.selection=null,0!=(8&this.flags)?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof EditorState$1))return!1;const t=e;return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(e){return this._equals(new EditorState$1(e,this.flags))}}class EditorStateCancellationTokenSource extends EditorKeybindingCancellationTokenSource{constructor(e,t,i,n){super(e,n),this._listener=new DisposableStore,4&t&&this._listener.add(e.onDidChangeCursorPosition((e=>{i&&Range$2.containsPosition(i,e.position)||this.cancel()}))),2&t&&this._listener.add(e.onDidChangeCursorSelection((e=>{i&&Range$2.containsRange(i,e.selection)||this.cancel()}))),8&t&&this._listener.add(e.onDidScrollChange((e=>this.cancel()))),1&t&&(this._listener.add(e.onDidChangeModel((e=>this.cancel()))),this._listener.add(e.onDidChangeModelContent((e=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}class TextModelCancellationTokenSource extends CancellationTokenSource$1{constructor(e,t){super(t),this._listener=e.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}class CodeActionKind{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||""===this.value||e.value.startsWith(this.value+CodeActionKind.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(e){return new CodeActionKind(this.value+CodeActionKind.sep+e)}}function mayIncludeActionsOfKind(e,t){return!(e.include&&!e.include.intersects(t))&&((!e.excludes||!e.excludes.some((i=>excludesAction(t,i,e.include))))&&!(!e.includeSourceActions&&CodeActionKind.Source.contains(t)))}function filtersAction(e,t){const i=t.kind?new CodeActionKind(t.kind):void 0;return!!(!e.include||i&&e.include.contains(i))&&(!(e.excludes&&i&&e.excludes.some((t=>excludesAction(i,t,e.include))))&&(!(!e.includeSourceActions&&i&&CodeActionKind.Source.contains(i))&&!(e.onlyIncludePreferredActions&&!t.isPreferred)))}function excludesAction(e,t,i){return!!t.contains(e)&&(!i||!t.contains(i))}CodeActionKind.sep=".",CodeActionKind.None=new CodeActionKind("@@none@@"),CodeActionKind.Empty=new CodeActionKind(""),CodeActionKind.QuickFix=new CodeActionKind("quickfix"),CodeActionKind.Refactor=new CodeActionKind("refactor"),CodeActionKind.Source=new CodeActionKind("source"),CodeActionKind.SourceOrganizeImports=CodeActionKind.Source.append("organizeImports"),CodeActionKind.SourceFixAll=CodeActionKind.Source.append("fixAll");class CodeActionCommandArgs{constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}static fromUser(e,t){return e&&"object"==typeof e?new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(e,t.kind),CodeActionCommandArgs.getApplyFromUser(e,t.apply),CodeActionCommandArgs.getPreferredUser(e)):new CodeActionCommandArgs(t.kind,t.apply,!1)}static getApplyFromUser(e,t){switch("string"==typeof e.apply?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return"string"==typeof e.kind?new CodeActionKind(e.kind):t}static getPreferredUser(e){return"boolean"==typeof e.preferred&&e.preferred}}var __awaiter$Z=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const codeActionCommandId="editor.action.codeAction",refactorCommandId="editor.action.refactor",sourceActionCommandId="editor.action.sourceAction",organizeImportsCommandId="editor.action.organizeImports",fixAllCommandId="editor.action.fixAll";class CodeActionItem{constructor(e,t){this.action=e,this.provider=t}resolve(e){var t;return __awaiter$Z(this,void 0,void 0,(function*(){if((null===(t=this.provider)||void 0===t?void 0:t.resolveCodeAction)&&!this.action.edit){let t;try{t=yield this.provider.resolveCodeAction(this.action,e)}catch(i){onUnexpectedExternalError(i)}t&&(this.action.edit=t.edit)}return this}))}}class ManagedCodeActionSet extends Disposable{constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(ManagedCodeActionSet.codeActionsComparator),this.validActions=this.allActions.filter((({action:e})=>!e.disabled))}static codeActionsComparator({action:e},{action:t}){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:isNonEmptyArray(e.diagnostics)?isNonEmptyArray(t.diagnostics)?e.diagnostics[0].message.localeCompare(t.diagnostics[0].message):-1:isNonEmptyArray(t.diagnostics)?1:0}get hasAutoFix(){return this.validActions.some((({action:e})=>!!e.kind&&CodeActionKind.QuickFix.contains(new CodeActionKind(e.kind))&&!!e.isPreferred))}}const emptyCodeActionsResponse={actions:[],documentation:void 0};function getCodeActions(e,t,i,n,o,r){var s;const a=n.filter||{},l={only:null===(s=a.include)||void 0===s?void 0:s.value,trigger:n.type},d=new TextModelCancellationTokenSource(t,r),c=getCodeActionProviders(e,t,a),h=new DisposableStore,u=c.map((e=>__awaiter$Z(this,void 0,void 0,(function*(){try{o.report(e);const n=yield e.provideCodeActions(t,i,l,d.token);if(n&&h.add(n),d.token.isCancellationRequested)return emptyCodeActionsResponse;const r=((null==n?void 0:n.actions)||[]).filter((e=>e&&filtersAction(a,e))),s=getDocumentation(e,r,a.include);return{actions:r.map((t=>new CodeActionItem(t,e))),documentation:s}}catch(n){if(isCancellationError(n))throw n;return onUnexpectedExternalError(n),emptyCodeActionsResponse}})))),g=e.onDidChange((()=>{equals$1(e.all(t),c)||d.cancel()}));return Promise.all(u).then((e=>{const t=flatten(e.map((e=>e.actions))),i=coalesce(e.map((e=>e.documentation)));return new ManagedCodeActionSet(t,i,h)})).finally((()=>{g.dispose(),d.dispose()}))}function getCodeActionProviders(e,t,i){return e.all(t).filter((e=>!e.providedCodeActionKinds||e.providedCodeActionKinds.some((e=>mayIncludeActionsOfKind(i,new CodeActionKind(e))))))}function getDocumentation(e,t,i){if(!e.documentation)return;const n=e.documentation.map((e=>({kind:new CodeActionKind(e.kind),command:e.command})));if(i){let e;for(const t of n)t.kind.contains(i)&&(e?e.kind.contains(t.kind)&&(e=t):e=t);if(e)return null==e?void 0:e.command}for(const o of t)if(o.kind)for(const e of n)if(e.kind.contains(new CodeActionKind(o.kind)))return e.command}CommandsRegistry.registerCommand("_executeCodeActionProvider",(function(e,t,i,n,o){return __awaiter$Z(this,void 0,void 0,(function*(){if(!(t instanceof URI))throw illegalArgument();const{codeActionProvider:r}=e.get(ILanguageFeaturesService),s=e.get(IModelService).getModel(t);if(!s)throw illegalArgument();const a=Selection$1.isISelection(i)?Selection$1.liftSelection(i):Range$2.isIRange(i)?s.validateRange(i):void 0;if(!a)throw illegalArgument();const l="string"==typeof n?new CodeActionKind(n):void 0,d=yield getCodeActions(r,s,a,{type:1,filter:{includeSourceActions:!0,include:l}},Progress.None,CancellationToken.None),c=[],h=Math.min(d.validActions.length,"number"==typeof o?o:0);for(let e=0;e<h;e++)c.push(d.validActions[e].resolve(CancellationToken.None));try{return yield Promise.all(c),d.validActions.map((e=>e.action))}finally{setTimeout((()=>d.dispose()),100)}}))}));var messageController="",__decorate$1q=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1m=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let MessageController=class e{constructor(t,i){this._messageWidget=new MutableDisposable,this._messageListeners=new DisposableStore,this._editor=t,this._visible=e.MESSAGE_VISIBLE.bindTo(i),this._editorListener=this._editor.onDidAttemptReadOnlyEdit((()=>this._onDidAttemptReadOnlyEdit()))}static get(t){return t.getContribution(e.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){let i;alert(e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new MessageWidget$1(this._editor,t,e),this._messageListeners.add(this._editor.onDidBlurEditorText((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeCursorPosition((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidDispose((()=>this.closeMessage()))),this._messageListeners.add(this._editor.onDidChangeModel((()=>this.closeMessage()))),this._messageListeners.add(new TimeoutTimer((()=>this.closeMessage()),3e3)),this._messageListeners.add(this._editor.onMouseMove((e=>{e.target.position&&(i?i.containsPosition(e.target.position)||this.closeMessage():i=new Range$2(t.lineNumber-3,1,e.target.position.lineNumber+3,1))})))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(MessageWidget$1.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(localize("editor.readonly","Cannot edit in read-only editor"),this._editor.getPosition())}};MessageController.ID="editor.contrib.messageController",MessageController.MESSAGE_VISIBLE=new RawContextKey("messageVisible",!1,localize("messageVisible","Whether the editor is currently showing an inline message")),MessageController=__decorate$1q([__param$1m(1,IContextKeyService)],MessageController);const MessageCommand=EditorCommand.bindToContribution(MessageController.get);registerEditorCommand(new MessageCommand({id:"leaveEditorMessage",precondition:MessageController.MESSAGE_VISIBLE,handler:e=>e.closeMessage(),kbOpts:{weight:130,primary:9}}));class MessageWidget$1{constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i-1},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage");const o=document.createElement("div");o.classList.add("anchor","top"),this._domNode.appendChild(o);const r=document.createElement("div");r.classList.add("message"),r.textContent=n,this._domNode.appendChild(r);const s=document.createElement("div");s.classList.add("anchor","below"),this._domNode.appendChild(s),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}static fadeOut(e){let t;const i=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener("animationend",i)};return t=setTimeout(i,110),e.getDomNode().addEventListener("animationend",i),e.getDomNode().classList.add("fadeOut"),{dispose:i}}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(e){this._domNode.classList.toggle("below",2===e)}}registerEditorContribution(MessageController.ID,MessageController);const IKeybindingService=createDecorator("keybindingService");var __decorate$1p=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1l=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$Y=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class CodeActionAction extends Action{constructor(e,t){super(e.command?e.command.id:e.title,stripNewlines(e.title),void 0,!e.disabled,t),this.action=e}}function stripNewlines(e){return e.replace(/\r\n|\r|\n/g," ")}let CodeActionMenu=class extends Disposable{constructor(e,t,i,n,o){super(),this._editor=e,this._delegate=t,this._contextMenuService=i,this._languageFeaturesService=o,this._visible=!1,this._showingActions=this._register(new MutableDisposable),this._keybindingResolver=new CodeActionKeybindingResolver({getKeybindings:()=>n.getKeybindings()})}get isVisible(){return this._visible}show(e,t,i,n){return __awaiter$Y(this,void 0,void 0,(function*(){const o=n.includeDisabledActions?t.allActions:t.validActions;if(!o.length)return void(this._visible=!1);if(!this._editor.getDomNode())throw this._visible=!1,canceled();this._visible=!0,this._showingActions.value=t;const r=this.getMenuActions(e,o,t.documentation),s=Position$1.isIPosition(i)?this._toCoords(i):i||{x:0,y:0},a=this._keybindingResolver.getResolver(),l=this._editor.getOption(115);this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>s,getActions:()=>r,onHide:()=>{this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:e=>e instanceof CodeActionAction?a(e.action):void 0})}))}getMenuActions(e,t,i){var n,o;const r=e=>new CodeActionAction(e.action,(()=>this._delegate.onSelectCodeAction(e))),s=t.map(r),a=[...i],l=this._editor.getModel();if(l&&s.length)for(const d of this._languageFeaturesService.codeActionProvider.all(l))d._getAdditionalMenuItems&&a.push(...d._getAdditionalMenuItems({trigger:e.type,only:null===(o=null===(n=e.filter)||void 0===n?void 0:n.include)||void 0===o?void 0:o.value},t.map((e=>e.action))));return a.length&&s.push(new Separator,...a.map((e=>r(new CodeActionItem({title:e.title,command:e},void 0))))),s}_toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=getDomNodePagePosition(this._editor.getDomNode());return{x:i.left+t.left,y:i.top+t.top+t.height}}};CodeActionMenu=__decorate$1p([__param$1l(2,IContextMenuService),__param$1l(3,IKeybindingService),__param$1l(4,ILanguageFeaturesService)],CodeActionMenu);class CodeActionKeybindingResolver{constructor(e){this._keybindingProvider=e}getResolver(){const e=new Lazy((()=>this._keybindingProvider.getKeybindings().filter((e=>CodeActionKeybindingResolver.codeActionCommands.indexOf(e.command)>=0)).filter((e=>e.resolvedKeybinding)).map((e=>{let t=e.commandArgs;return e.command===organizeImportsCommandId?t={kind:CodeActionKind.SourceOrganizeImports.value}:e.command===fixAllCommandId&&(t={kind:CodeActionKind.SourceFixAll.value}),Object.assign({resolvedKeybinding:e.resolvedKeybinding},CodeActionCommandArgs.fromUser(t,{kind:CodeActionKind.None,apply:"never"}))}))));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.getValue());return null==i?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new CodeActionKind(e.kind);return t.filter((e=>e.kind.contains(i))).filter((t=>!t.preferred||e.isPreferred)).reduceRight(((e,t)=>e?e.kind.contains(t.kind)?t:e:t),void 0)}}CodeActionKeybindingResolver.codeActionCommands=[refactorCommandId,codeActionCommandId,sourceActionCommandId,organizeImportsCommandId,fixAllCommandId];var lightBulbWidget="",__decorate$1o=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1k=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},LightBulbState;!function(e){e.Hidden={type:0};e.Showing=class{constructor(e,t,i,n){this.actions=e,this.trigger=t,this.editorPosition=i,this.widgetPosition=n,this.type=1}}}(LightBulbState||(LightBulbState={}));let LightBulbWidget=class e extends Disposable{constructor(e,t,i,n){super(),this._editor=e,this._quickFixActionId=t,this._preferredFixActionId=i,this._keybindingService=n,this._onClick=this._register(new Emitter$1),this.onClick=this._onClick.event,this._state=LightBulbState.Hidden,this._domNode=document.createElement("div"),this._domNode.className=Codicon.lightBulb.classNames,this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent((e=>{const t=this._editor.getModel();(1!==this.state.type||!t||this.state.editorPosition.lineNumber>=t.getLineCount())&&this.hide()}))),Gesture.ignoreTarget(this._domNode),this._register(addStandardDisposableGenericMouseDownListener(this._domNode,(e=>{if(1!==this.state.type)return;this._editor.focus(),e.preventDefault();const{top:t,height:i}=getDomNodePagePosition(this._domNode),n=this._editor.getOption(59);let o=Math.floor(n/3);null!==this.state.widgetPosition.position&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(o+=n),this._onClick.fire({x:e.posx,y:t+i+o,actions:this.state.actions,trigger:this.state.trigger})}))),this._register(addDisposableListener(this._domNode,"mouseenter",(e=>{if(1!=(1&e.buttons))return;this.hide();const t=new GlobalMouseMoveMonitor;t.startMonitoring(e.target,e.buttons,standardMouseMoveMerger,(()=>{}),(()=>{t.dispose()}))}))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(57)&&!this._editor.getOption(57).enabled&&this.hide()}))),this._updateLightBulbTitleAndIcon(),this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon,this))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return 1===this._state.type?this._state.widgetPosition:null}update(t,i,n){if(t.validActions.length<=0)return this.hide();const o=this._editor.getOptions();if(!o.get(57).enabled)return this.hide();const r=this._editor.getModel();if(!r)return this.hide();const{lineNumber:s,column:a}=r.validatePosition(n),l=r.getOptions().tabSize,d=o.get(44),c=computeIndentLevel(r.getLineContent(s),l),h=e=>e>2&&this._editor.getTopForLineNumber(e)===this._editor.getTopForLineNumber(e-1);let u=s;if(!(d.spaceWidth*c>22))if(s>1&&!h(s-1))u-=1;else if(h(s+1)){if(a*d.spaceWidth<22)return this.hide()}else u+=1;this.state=new LightBulbState.Showing(t,i,n,{position:{lineNumber:u,column:1},preference:e._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state=LightBulbState.Hidden,this._editor.layoutContentWidget(this)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(1===this.state.type&&this.state.actions.hasAutoFix){this._domNode.classList.remove(...Codicon.lightBulb.classNamesArray),this._domNode.classList.add(...Codicon.lightbulbAutofix.classNamesArray);const e=this._keybindingService.lookupKeybinding(this._preferredFixActionId);if(e)return void(this.title=localize("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",e.getLabel()))}this._domNode.classList.remove(...Codicon.lightbulbAutofix.classNamesArray),this._domNode.classList.add(...Codicon.lightBulb.classNamesArray);const e=this._keybindingService.lookupKeybinding(this._quickFixActionId);this.title=e?localize("codeActionWithKb","Show Code Actions ({0})",e.getLabel()):localize("codeAction","Show Code Actions")}set title(e){this._domNode.title=e}};LightBulbWidget._posPref=[0],LightBulbWidget=__decorate$1o([__param$1k(3,IKeybindingService)],LightBulbWidget),registerThemingParticipant(((e,t)=>{var i;const n=null===(i=e.getColor(editorBackground))||void 0===i?void 0:i.transparent(.7),o=e.getColor(editorLightBulbForeground);o&&t.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightBulb.cssSelector} {\n\t\t\tcolor: ${o};\n\t\t\tbackground-color: ${n};\n\t\t}`);const r=e.getColor(editorLightBulbAutoFixForeground);r&&t.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightbulbAutofix.cssSelector} {\n\t\t\tcolor: ${r};\n\t\t\tbackground-color: ${n};\n\t\t}`)}));var __decorate$1n=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1j=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$X=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__classPrivateFieldSet$1=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,i,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,i):o?o.value=i:t.set(e,i),i},__classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)},_CodeActionUi_disposed;let CodeActionUi=class extends Disposable{constructor(e,t,i,n,o){super(),this._editor=e,this.delegate=n,this._activeCodeActions=this._register(new MutableDisposable),_CodeActionUi_disposed.set(this,!1),this._codeActionWidget=new Lazy((()=>this._register(o.createInstance(CodeActionMenu,this._editor,{onSelectCodeAction:e=>__awaiter$X(this,void 0,void 0,(function*(){this.delegate.applyCodeAction(e,!0)}))})))),this._lightBulbWidget=new Lazy((()=>{const e=this._register(o.createInstance(LightBulbWidget,this._editor,t,i));return this._register(e.onClick((e=>this.showCodeActionList(e.trigger,e.actions,e,{includeDisabledActions:!1})))),e}))}dispose(){__classPrivateFieldSet$1(this,_CodeActionUi_disposed,!0,"f"),super.dispose()}update(e){var t,i,n,o,r;return __awaiter$X(this,void 0,void 0,(function*(){if(1!==e.type)return void(null===(t=this._lightBulbWidget.rawValue)||void 0===t||t.hide());let s;try{s=yield e.actions}catch(e2){return void onUnexpectedError(e2)}if(!__classPrivateFieldGet$1(this,_CodeActionUi_disposed,"f"))if(this._lightBulbWidget.getValue().update(s,e.trigger,e.position),1===e.trigger.type){if(null===(i=e.trigger.filter)||void 0===i?void 0:i.include){const t=this.tryGetValidActionToApply(e.trigger,s);if(t){try{this._lightBulbWidget.getValue().hide(),yield this.delegate.applyCodeAction(t,!1)}finally{s.dispose()}return}if(e.trigger.context){const t=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,s);if(t&&t.action.disabled)return null===(n=MessageController.get(this._editor))||void 0===n||n.showMessage(t.action.disabled,e.trigger.context.position),void s.dispose()}}const t=!!(null===(o=e.trigger.filter)||void 0===o?void 0:o.include);if(e.trigger.context&&(!s.allActions.length||!t&&!s.validActions.length))return null===(r=MessageController.get(this._editor))||void 0===r||r.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=s,void s.dispose();this._activeCodeActions.value=s,this._codeActionWidget.getValue().show(e.trigger,s,e.position,{includeDisabledActions:t})}else this._codeActionWidget.getValue().isVisible?s.dispose():this._activeCodeActions.value=s}))}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length)return"first"===e.autoApply&&0===t.validActions.length||"ifSingle"===e.autoApply&&1===t.allActions.length?t.allActions.find((({action:e})=>e.disabled)):void 0}tryGetValidActionToApply(e,t){if(t.validActions.length)return"first"===e.autoApply&&t.validActions.length>0||"ifSingle"===e.autoApply&&1===t.validActions.length?t.validActions[0]:void 0}showCodeActionList(e,t,i,n){return __awaiter$X(this,void 0,void 0,(function*(){this._codeActionWidget.getValue().show(e,t,i,n)}))}};var MarkerSeverity$2,MarkerSeverity2,IMarkerData;_CodeActionUi_disposed=new WeakMap,CodeActionUi=__decorate$1n([__param$1j(4,IInstantiationService)],CodeActionUi),MarkerSeverity2=MarkerSeverity$2||(MarkerSeverity$2={}),MarkerSeverity2[MarkerSeverity2.Hint=1]="Hint",MarkerSeverity2[MarkerSeverity2.Info=2]="Info",MarkerSeverity2[MarkerSeverity2.Warning=4]="Warning",MarkerSeverity2[MarkerSeverity2.Error=8]="Error",function(e){e.compare=function(e,t){return t-e};const t=Object.create(null);t[e.Error]=localize("sev.error","Error"),t[e.Warning]=localize("sev.warning","Warning"),t[e.Info]=localize("sev.info","Info"),e.toString=function(e){return t[e]||""},e.fromSeverity=function(t){switch(t){case Severity$2.Error:return e.Error;case Severity$2.Warning:return e.Warning;case Severity$2.Info:return e.Info;case Severity$2.Ignore:return e.Hint}},e.toSeverity=function(t){switch(t){case e.Error:return Severity$2.Error;case e.Warning:return Severity$2.Warning;case e.Info:return Severity$2.Info;case e.Hint:return Severity$2.Ignore}}}(MarkerSeverity$2||(MarkerSeverity$2={})),function(e){const t="";function i(e,i){let n=[t];return e.source?n.push(e.source.replace("¦","\\¦")):n.push(t),e.code?"string"==typeof e.code?n.push(e.code.replace("¦","\\¦")):n.push(e.code.value.replace("¦","\\¦")):n.push(t),void 0!==e.severity&&null!==e.severity?n.push(MarkerSeverity$2.toString(e.severity)):n.push(t),e.message&&i?n.push(e.message.replace("¦","\\¦")):n.push(t),void 0!==e.startLineNumber&&null!==e.startLineNumber?n.push(e.startLineNumber.toString()):n.push(t),void 0!==e.startColumn&&null!==e.startColumn?n.push(e.startColumn.toString()):n.push(t),void 0!==e.endLineNumber&&null!==e.endLineNumber?n.push(e.endLineNumber.toString()):n.push(t),void 0!==e.endColumn&&null!==e.endColumn?n.push(e.endColumn.toString()):n.push(t),n.push(t),n.join("¦")}e.makeKey=function(e){return i(e,!0)},e.makeKeyOptionalMessage=i}(IMarkerData||(IMarkerData={}));const IMarkerService=createDecorator("markerService");var __classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)},__classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,i,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,i):o?o.value=i:t.set(e,i),i},_CodeActionModel_isDisposed;const SUPPORTED_CODE_ACTIONS=new RawContextKey("supportedCodeAction","");class CodeActionOracle extends Disposable{constructor(e,t,i,n=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=n,this._autoTriggerTimer=this._register(new TimeoutTimer),this._register(this._markerService.onMarkerChanged((e=>this._onMarkerChanges(e)))),this._register(this._editor.onDidChangeCursorPosition((()=>this._onCursorChange())))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);return this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some((e=>isEqual(e,t.uri)))&&this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2})}),this._delay)}_getRangeOfMarker(e){const t=this._editor.getModel();if(t)for(const i of this._markerService.read({resource:t.uri})){const n=t.validateRange(i);if(Range$2.intersectRanges(n,e))return Range$2.lift(n)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelection();if(i.isEmpty()&&2===e.type){const{lineNumber:e,column:n}=i.getPosition(),o=t.getLineContent(e);if(0===o.length)return;if(1===n){if(/\s/.test(o[0]))return}else if(n===t.getLineMaxColumn(e)){if(/\s/.test(o[o.length-1]))return}else if(/\s/.test(o[n-2])&&/\s/.test(o[n-1]))return}return i}_createEventAndSignalChange(e,t){const i=this._editor.getModel();if(!t||!i)return void this._signalChange(void 0);const n=this._getRangeOfMarker(t),o=n?n.getStartPosition():t.getStartPosition(),r={trigger:e,selection:t,position:o};return this._signalChange(r),r}}var CodeActionsState;!function(e){e.Empty={type:0};e.Triggered=class{constructor(e,t,i,n){this.trigger=e,this.rangeOrSelection=t,this.position=i,this._cancellablePromise=n,this.type=1,this.actions=n.catch((e=>{if(isCancellationError(e))return emptyCodeActionSet;throw e}))}cancel(){this._cancellablePromise.cancel()}}}(CodeActionsState||(CodeActionsState={}));const emptyCodeActionSet={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1};class CodeActionModel extends Disposable{constructor(e,t,i,n,o){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=o,this._codeActionOracle=this._register(new MutableDisposable),this._state=CodeActionsState.Empty,this._onDidChangeState=this._register(new Emitter$1),this.onDidChangeState=this._onDidChangeState.event,_CodeActionModel_isDisposed.set(this,!1),this._supportedCodeActions=SUPPORTED_CODE_ACTIONS.bindTo(n),this._register(this._editor.onDidChangeModel((()=>this._update()))),this._register(this._editor.onDidChangeModelLanguage((()=>this._update()))),this._register(this._registry.onDidChange((()=>this._update()))),this._update()}dispose(){__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")||(__classPrivateFieldSet(this,_CodeActionModel_isDisposed,!0,"f"),super.dispose(),this.setState(CodeActionsState.Empty,!0))}_update(){if(__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f"))return;this._codeActionOracle.value=void 0,this.setState(CodeActionsState.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(81)){const t=[];for(const i of this._registry.all(e))Array.isArray(i.providedCodeActionKinds)&&t.push(...i.providedCodeActionKinds);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new CodeActionOracle(this._editor,this._markerService,(t=>{var i;if(!t)return void this.setState(CodeActionsState.Empty);const n=createCancelablePromise((i=>getCodeActions(this._registry,e,t.selection,t.trigger,Progress.None,i)));1===t.trigger.type&&(null===(i=this._progressService)||void 0===i||i.showWhile(n,250)),this.setState(new CodeActionsState.Triggered(t.trigger,t.selection,t.position,n))}),void 0),this._codeActionOracle.value.trigger({type:2})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value&&this._codeActionOracle.value.trigger(e)}setState(e,t){e!==this._state&&(1===this._state.type&&this._state.cancel(),this._state=e,t||__classPrivateFieldGet(this,_CodeActionModel_isDisposed,"f")||this._onDidChangeState.fire(e))}}_CodeActionModel_isDisposed=new WeakMap;var __decorate$1m=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1i=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$W=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function contextKeyForSupportedActions(e){return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0],new RegExp("(\\s|^)"+escapeRegExpCharacters(e.value)+"\\b"))}const argsSchema={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:localize("args.schema.kind","Kind of the code action to run.")},apply:{type:"string",description:localize("args.schema.apply","Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[localize("args.schema.apply.first","Always apply the first returned code action."),localize("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),localize("args.schema.apply.never","Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:localize("args.schema.preferred","Controls if only preferred code actions should be returned.")}}};let QuickFixController=class e extends Disposable{constructor(e,t,i,n,o,r){super(),this._instantiationService=o,this._editor=e,this._model=this._register(new CodeActionModel(this._editor,r.codeActionProvider,t,i,n)),this._register(this._model.onDidChangeState((e=>this.update(e)))),this._ui=new Lazy((()=>this._register(new CodeActionUi(e,QuickFixAction.Id,AutoFixAction.Id,{applyCodeAction:(e,t)=>__awaiter$W(this,void 0,void 0,(function*(){try{yield this._applyCodeAction(e)}finally{t&&this._trigger({type:2,filter:{}})}}))},this._instantiationService))))}static get(t){return t.getContribution(e.ID)}update(e){this._ui.getValue().update(e)}showCodeActions(e,t,i){return this._ui.getValue().showCodeActionList(e,t,i,{includeDisabledActions:!1})}manualTriggerAtCurrentPosition(e,t,i){var n;if(!this._editor.hasModel())return;null===(n=MessageController.get(this._editor))||void 0===n||n.closeMessage();const o=this._editor.getPosition();this._trigger({type:1,filter:t,autoApply:i,context:{notAvailableMessage:e,position:o}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e){return this._instantiationService.invokeFunction(applyCodeAction,e,this._editor)}};function applyCodeAction(e,t,i){return __awaiter$W(this,void 0,void 0,(function*(){const n=e.get(IBulkEditService),o=e.get(ICommandService),r=e.get(ITelemetryService),s=e.get(INotificationService);if(r.publicLog2("codeAction.applyCodeAction",{codeActionTitle:t.action.title,codeActionKind:t.action.kind,codeActionIsPreferred:!!t.action.isPreferred}),yield t.resolve(CancellationToken.None),t.action.edit&&(yield n.apply(ResourceEdit.convert(t.action.edit),{editor:i,label:t.action.title})),t.action.command)try{yield o.executeCommand(t.action.command.id,...t.action.command.arguments||[])}catch(a){const e=asMessage(a);s.error("string"==typeof e?e:localize("applyCodeActionFailed","An unknown error occurred while applying the code action"))}}))}function asMessage(e){return"string"==typeof e?e:e instanceof Error&&"string"==typeof e.message?e.message:void 0}function triggerCodeActionsForEditorSelection(e,t,i,n){if(e.hasModel()){const o=QuickFixController.get(e);o&&o.manualTriggerAtCurrentPosition(t,i,n)}}QuickFixController.ID="editor.contrib.quickFixController",QuickFixController=__decorate$1m([__param$1i(1,IMarkerService),__param$1i(2,IContextKeyService),__param$1i(3,IEditorProgressService),__param$1i(4,IInstantiationService),__param$1i(5,ILanguageFeaturesService)],QuickFixController);class QuickFixAction extends EditorAction{constructor(){super({id:QuickFixAction.Id,label:localize("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2132,weight:100}})}run(e,t){return triggerCodeActionsForEditorSelection(t,localize("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0)}}QuickFixAction.Id="editor.action.quickFix";class CodeActionCommand extends EditorCommand{constructor(){super({id:codeActionCommandId,precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),description:{description:"Trigger a code action",args:[{name:"args",schema:argsSchema}]}})}runEditorCommand(e,t,i){const n=CodeActionCommandArgs.fromUser(i,{kind:CodeActionKind.Empty,apply:"ifSingle"});return triggerCodeActionsForEditorSelection(t,"string"==typeof(null==i?void 0:i.kind)?n.preferred?localize("editor.action.codeAction.noneMessage.preferred.kind","No preferred code actions for '{0}' available",i.kind):localize("editor.action.codeAction.noneMessage.kind","No code actions for '{0}' available",i.kind):n.preferred?localize("editor.action.codeAction.noneMessage.preferred","No preferred code actions available"):localize("editor.action.codeAction.noneMessage","No code actions available"),{include:n.kind,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class RefactorAction extends EditorAction{constructor(){super({id:refactorCommandId,label:localize("refactor.label","Refactor..."),alias:"Refactor...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.Refactor))},description:{description:"Refactor...",args:[{name:"args",schema:argsSchema}]}})}run(e,t,i){const n=CodeActionCommandArgs.fromUser(i,{kind:CodeActionKind.Refactor,apply:"never"});return triggerCodeActionsForEditorSelection(t,"string"==typeof(null==i?void 0:i.kind)?n.preferred?localize("editor.action.refactor.noneMessage.preferred.kind","No preferred refactorings for '{0}' available",i.kind):localize("editor.action.refactor.noneMessage.kind","No refactorings for '{0}' available",i.kind):n.preferred?localize("editor.action.refactor.noneMessage.preferred","No preferred refactorings available"):localize("editor.action.refactor.noneMessage","No refactorings available"),{include:CodeActionKind.Refactor.contains(n.kind)?n.kind:CodeActionKind.None,onlyIncludePreferredActions:n.preferred},n.apply)}}class SourceAction extends EditorAction{constructor(){super({id:sourceActionCommandId,label:localize("source.label","Source Action..."),alias:"Source Action...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.Source))},description:{description:"Source Action...",args:[{name:"args",schema:argsSchema}]}})}run(e,t,i){const n=CodeActionCommandArgs.fromUser(i,{kind:CodeActionKind.Source,apply:"never"});return triggerCodeActionsForEditorSelection(t,"string"==typeof(null==i?void 0:i.kind)?n.preferred?localize("editor.action.source.noneMessage.preferred.kind","No preferred source actions for '{0}' available",i.kind):localize("editor.action.source.noneMessage.kind","No source actions for '{0}' available",i.kind):n.preferred?localize("editor.action.source.noneMessage.preferred","No preferred source actions available"):localize("editor.action.source.noneMessage","No source actions available"),{include:CodeActionKind.Source.contains(n.kind)?n.kind:CodeActionKind.None,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class OrganizeImportsAction extends EditorAction{constructor(){super({id:organizeImportsCommandId,label:localize("organizeImports.label","Organize Imports"),alias:"Organize Imports",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1581,weight:100}})}run(e,t){return triggerCodeActionsForEditorSelection(t,localize("editor.action.organize.noneMessage","No organize imports action available"),{include:CodeActionKind.SourceOrganizeImports,includeSourceActions:!0},"ifSingle")}}class FixAllAction extends EditorAction{constructor(){super({id:fixAllCommandId,label:localize("fixAll.label","Fix All"),alias:"Fix All",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.SourceFixAll))})}run(e,t){return triggerCodeActionsForEditorSelection(t,localize("fixAll.noneMessage","No fix all action available"),{include:CodeActionKind.SourceFixAll,includeSourceActions:!0},"ifSingle")}}class AutoFixAction extends EditorAction{constructor(){super({id:AutoFixAction.Id,label:localize("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:ContextKeyExpr.and(EditorContextKeys.writable,contextKeyForSupportedActions(CodeActionKind.QuickFix)),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1620,mac:{primary:2644},weight:100}})}run(e,t){return triggerCodeActionsForEditorSelection(t,localize("editor.action.autoFix.noneMessage","No auto fixes available"),{include:CodeActionKind.QuickFix,onlyIncludePreferredActions:!0},"ifSingle")}}function hash(e){return doHash(e,0)}function doHash(e,t){switch(typeof e){case"object":return null===e?numberHash(349,t):Array.isArray(e)?arrayHash(e,t):objectHash(e,t);case"string":return stringHash(e,t);case"boolean":return booleanHash(e,t);case"number":return numberHash(e,t);case"undefined":return numberHash(937,t);default:return numberHash(617,t)}}function numberHash(e,t){return(t<<5)-t+e|0}function booleanHash(e,t){return numberHash(e?433:863,t)}function stringHash(e,t){t=numberHash(149417,t);for(let i=0,n=e.length;i<n;i++)t=numberHash(e.charCodeAt(i),t);return t}function arrayHash(e,t){return t=numberHash(104579,t),e.reduce(((e,t)=>doHash(t,e)),t)}function objectHash(e,t){return t=numberHash(181387,t),Object.keys(e).sort().reduce(((t,i)=>(t=stringHash(i,t),doHash(e[i],t))),t)}function leftRotate(e,t,i=32){const n=i-t;return(e<<t|(~((1<<n)-1)&e)>>>n)>>>0}function fill(e,t=0,i=e.byteLength,n=0){for(let o=0;o<i;o++)e[t+o]=n}function leftPad(e,t,i="0"){for(;e.length<t;)e=i+e;return e}function toHexString(e,t=32){return e instanceof ArrayBuffer?Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join(""):leftPad((e>>>0).toString(16),t/4)}AutoFixAction.Id="editor.action.autoFix",registerEditorContribution(QuickFixController.ID,QuickFixController),registerEditorAction(QuickFixAction),registerEditorAction(RefactorAction),registerEditorAction(SourceAction),registerEditorAction(OrganizeImportsAction),registerEditorAction(AutoFixAction),registerEditorAction(FixAllAction),registerEditorCommand(new CodeActionCommand);class StringSHA1{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(0===t)return;const i=this._buff;let n,o,r=this._buffLen,s=this._leftoverHighSurrogate;for(0!==s?(n=s,o=-1,s=0):(n=e.charCodeAt(0),o=0);;){let a=n;if(isHighSurrogate(n)){if(!(o+1<t)){s=n;break}{const t=e.charCodeAt(o+1);isLowSurrogate(t)?(o++,a=computeCodePoint(n,t)):a=65533}}else isLowSurrogate(n)&&(a=65533);if(r=this._push(i,r,a),o++,!(o<t))break;n=e.charCodeAt(o)}this._buffLen=r,this._leftoverHighSurrogate=s}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(1984&i)>>>6,e[t++]=128|(63&i)>>>0):i<65536?(e[t++]=224|(61440&i)>>>12,e[t++]=128|(4032&i)>>>6,e[t++]=128|(63&i)>>>0):(e[t++]=240|(1835008&i)>>>18,e[t++]=128|(258048&i)>>>12,e[t++]=128|(4032&i)>>>6,e[t++]=128|(63&i)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),toHexString(this._h0)+toHexString(this._h1)+toHexString(this._h2)+toHexString(this._h3)+toHexString(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,fill(this._buff,this._buffLen),this._buffLen>56&&(this._step(),fill(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=StringSHA1._bigBlock32,t=this._buffDV;for(let c=0;c<64;c+=4)e.setUint32(c,t.getUint32(c,!1),!1);for(let c=64;c<320;c+=4)e.setUint32(c,leftRotate(e.getUint32(c-12,!1)^e.getUint32(c-32,!1)^e.getUint32(c-56,!1)^e.getUint32(c-64,!1),1),!1);let i,n,o,r=this._h0,s=this._h1,a=this._h2,l=this._h3,d=this._h4;for(let c=0;c<80;c++)c<20?(i=s&a|~s&l,n=1518500249):c<40?(i=s^a^l,n=1859775393):c<60?(i=s&a|s&l|a&l,n=2400959708):(i=s^a^l,n=3395469782),o=leftRotate(r,5)+i+d+n+e.getUint32(4*c,!1)&4294967295,d=l,l=a,a=leftRotate(s,30),s=r,r=o;this._h0=this._h0+r&4294967295,this._h1=this._h1+s&4294967295,this._h2=this._h2+a&4294967295,this._h3=this._h3+l&4294967295,this._h4=this._h4+d&4294967295}}StringSHA1._bigBlock32=new DataView(new ArrayBuffer(320));var __awaiter$V=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class CodeLensModel{constructor(){this.lenses=[],this._disposables=new DisposableStore}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(e,t){this._disposables.add(e);for(const i of e.lenses)this.lenses.push({symbol:i,provider:t})}}function getCodeLensModel(e,t,i){return __awaiter$V(this,void 0,void 0,(function*(){const n=e.ordered(t),o=new Map,r=new CodeLensModel,s=n.map(((e,n)=>__awaiter$V(this,void 0,void 0,(function*(){o.set(e,n);try{const n=yield Promise.resolve(e.provideCodeLenses(t,i));n&&r.add(n,e)}catch(s){onUnexpectedExternalError(s)}}))));return yield Promise.all(s),r.lenses=r.lenses.sort(((e,t)=>e.symbol.range.startLineNumber<t.symbol.range.startLineNumber?-1:e.symbol.range.startLineNumber>t.symbol.range.startLineNumber?1:o.get(e.provider)<o.get(t.provider)?-1:o.get(e.provider)>o.get(t.provider)?1:e.symbol.range.startColumn<t.symbol.range.startColumn?-1:e.symbol.range.startColumn>t.symbol.range.startColumn?1:0)),r}))}CommandsRegistry.registerCommand("_executeCodeLensProvider",(function(e,...t){let[i,n]=t;assertType(URI.isUri(i)),assertType("number"==typeof n||!n);const{codeLensProvider:o}=e.get(ILanguageFeaturesService),r=e.get(IModelService).getModel(i);if(!r)throw illegalArgument();const s=[],a=new DisposableStore;return getCodeLensModel(o,r,CancellationToken.None).then((e=>{a.add(e);let t=[];for(const i of e.lenses)null==n||Boolean(i.symbol.command)?s.push(i.symbol):n-- >0&&i.provider.resolveCodeLens&&t.push(Promise.resolve(i.provider.resolveCodeLens(r,i.symbol,CancellationToken.None)).then((e=>s.push(e||i.symbol))));return Promise.all(t)})).then((()=>s)).finally((()=>{setTimeout((()=>a.dispose()),100)}))}));var __awaiter$U=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},StorageState,StorageState2;StorageState2=StorageState||(StorageState={}),StorageState2[StorageState2.None=0]="None",StorageState2[StorageState2.Initialized=1]="Initialized",StorageState2[StorageState2.Closed=2]="Closed";class Storage extends Disposable{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new Emitter$1),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=StorageState.None,this.cache=new Map,this.flushDelayer=new ThrottledDelayer(Storage.DEFAULT_FLUSH_DELAY),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal((e=>this.onDidChangeItemsExternal(e))))}onDidChangeItemsExternal(e){var t,i;null===(t=e.changed)||void 0===t||t.forEach(((e,t)=>this.accept(t,e))),null===(i=e.deleted)||void 0===i||i.forEach((e=>this.accept(e,void 0)))}accept(e,t){if(this.state===StorageState.Closed)return;let i=!1;if(isUndefinedOrNull(t))i=this.cache.delete(e);else{this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0)}i&&this._onDidChangeStorage.fire(e)}get(e,t){const i=this.cache.get(e);return isUndefinedOrNull(i)?t:i}getBoolean(e,t){const i=this.get(e);return isUndefinedOrNull(i)?t:"true"===i}getNumber(e,t){const i=this.get(e);return isUndefinedOrNull(i)?t:parseInt(i,10)}set(e,t){return __awaiter$U(this,void 0,void 0,(function*(){if(this.state===StorageState.Closed)return;if(isUndefinedOrNull(t))return this.delete(e);const i=String(t);return this.cache.get(e)!==i?(this.cache.set(e,i),this.pendingInserts.set(e,i),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire(e),this.doFlush()):void 0}))}delete(e){return __awaiter$U(this,void 0,void 0,(function*(){if(this.state===StorageState.Closed)return;return this.cache.delete(e)?(this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire(e),this.doFlush()):void 0}))}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}flushPending(){return __awaiter$U(this,void 0,void 0,(function*(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally((()=>{var e;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)null===(e=this.whenFlushedCallbacks.pop())||void 0===e||e()}))}))}doFlush(e){return __awaiter$U(this,void 0,void 0,(function*(){return this.flushDelayer.trigger((()=>this.flushPending()),e)}))}dispose(){this.flushDelayer.dispose(),super.dispose()}}Storage.DEFAULT_FLUSH_DELAY=100;class InMemoryStorageDatabase{constructor(){this.onDidChangeItemsExternal=Event$1.None,this.items=new Map}updateItems(e){return __awaiter$U(this,void 0,void 0,(function*(){e.insert&&e.insert.forEach(((e,t)=>this.items.set(t,e))),e.delete&&e.delete.forEach((e=>this.items.delete(e)))}))}}const TARGET_KEY="__$__targetStorageMarker",IStorageService=createDecorator("storageService");var WillSaveStateReason,WillSaveStateReason2;WillSaveStateReason2=WillSaveStateReason||(WillSaveStateReason={}),WillSaveStateReason2[WillSaveStateReason2.NONE=0]="NONE",WillSaveStateReason2[WillSaveStateReason2.SHUTDOWN=1]="SHUTDOWN";class AbstractStorageService extends Disposable{constructor(e={flushInterval:AbstractStorageService.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new PauseableEmitter),this._onDidChangeTarget=this._register(new PauseableEmitter),this._onWillSaveState=this._register(new Emitter$1),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._globalKeyTargets=void 0}emitDidChangeValue(e,t){t===TARGET_KEY?(0===e?this._globalKeyTargets=void 0:1===e&&(this._workspaceKeyTargets=void 0),this._onDidChangeTarget.fire({scope:e})):this._onDidChangeValue.fire({scope:e,key:t,target:this.getKeyTargets(e)[t]})}get(e,t,i){var n;return null===(n=this.getStorage(t))||void 0===n?void 0:n.get(e,i)}getBoolean(e,t,i){var n;return null===(n=this.getStorage(t))||void 0===n?void 0:n.getBoolean(e,i)}getNumber(e,t,i){var n;return null===(n=this.getStorage(t))||void 0===n?void 0:n.getNumber(e,i)}store(e,t,i,n){isUndefinedOrNull(t)?this.remove(e,i):this.withPausedEmitters((()=>{var o;this.updateKeyTarget(e,i,n),null===(o=this.getStorage(i))||void 0===o||o.set(e,t)}))}remove(e,t){this.withPausedEmitters((()=>{var i;this.updateKeyTarget(e,t,void 0),null===(i=this.getStorage(t))||void 0===i||i.delete(e)}))}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i){var n,o;const r=this.getKeyTargets(t);"number"==typeof i?r[e]!==i&&(r[e]=i,null===(n=this.getStorage(t))||void 0===n||n.set(TARGET_KEY,JSON.stringify(r))):"number"==typeof r[e]&&(delete r[e],null===(o=this.getStorage(t))||void 0===o||o.set(TARGET_KEY,JSON.stringify(r)))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get globalKeyTargets(){return this._globalKeyTargets||(this._globalKeyTargets=this.loadKeyTargets(0)),this._globalKeyTargets}getKeyTargets(e){return 0===e?this.globalKeyTargets:this.workspaceKeyTargets}loadKeyTargets(e){const t=this.get(TARGET_KEY,e);if(t)try{return JSON.parse(t)}catch(i){}return Object.create(null)}}AbstractStorageService.DEFAULT_FLUSH_INTERVAL=6e4;class InMemoryStorageService extends AbstractStorageService{constructor(){super(),this.globalStorage=this._register(new Storage(new InMemoryStorageDatabase)),this.workspaceStorage=this._register(new Storage(new InMemoryStorageDatabase)),this._register(this.workspaceStorage.onDidChangeStorage((e=>this.emitDidChangeValue(1,e)))),this._register(this.globalStorage.onDidChangeStorage((e=>this.emitDidChangeValue(0,e))))}getStorage(e){return 0===e?this.globalStorage:this.workspaceStorage}}var __decorate$1l=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1h=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const ICodeLensCache=createDecorator("ICodeLensCache");class CacheItem{constructor(e,t){this.lineCount=e,this.data=t}}let CodeLensCache=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new LRUCache(20,.75);runWhenIdle((()=>e.remove("codelens/cache",1)));const t="codelens/cache2",i=e.get(t,1,"{}");this._deserialize(i),once$1(e.onWillSaveState)((i=>{i.reason===WillSaveStateReason.SHUTDOWN&&e.store(t,this._serialize(),1,1)}))}put(e,t){const i=t.lenses.map((e=>{var t;return{range:e.symbol.range,command:e.symbol.command&&{id:"",title:null===(t=e.symbol.command)||void 0===t?void 0:t.title}}})),n=new CodeLensModel;n.add({lenses:i,dispose:()=>{}},this._fakeProvider);const o=new CacheItem(e.getLineCount(),n);this._cache.set(e.uri.toString(),o)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,i]of this._cache){const n=new Set;for(const e of i.data.lenses)n.add(e.symbol.range.startLineNumber);e[t]={lineCount:i.lineCount,lines:[...n.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const e in t){const i=t[e],n=[];for(const e of i.lines)n.push({range:new Range$2(e,1,e,11)});const o=new CodeLensModel;o.add({lenses:n,dispose(){}},this._fakeProvider),this._cache.set(e,new CacheItem(i.lineCount,o))}}catch(t){}}};CodeLensCache=__decorate$1l([__param$1h(0,IStorageService)],CodeLensCache),registerSingleton(ICodeLensCache,CodeLensCache);const labelWithIconsRegex=new RegExp(`(\\\\)?\\$\\((${CSSIcon.iconNameExpression}(?:${CSSIcon.iconModifierExpression})?)\\)`,"g");function renderLabelWithIcons(e){const t=new Array;let i,n=0,o=0;for(;null!==(i=labelWithIconsRegex.exec(e));){o=i.index||0,t.push(e.substring(n,o)),n=(i.index||0)+i[0].length;const[,r,s]=i;t.push(r?`$(${s})`:renderIcon({id:s}))}return n<e.length&&t.push(e.substring(n)),t}function renderIcon(e){const t=$$c("span");return t.classList.add(...CSSIcon.asClassNameArray(e)),t}var codelensWidget="";class CodeLensViewZone{constructor(e,t,i){this.afterColumn=1073741824,this.afterLineNumber=e,this.heightInPx=t,this._onHeight=i,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){void 0===this._lastHeight?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return 0!==this._lastHeight&&this.domNode.hasAttribute("monaco-visible-view-zone")}}class CodeLensContentWidget{constructor(e,t,i){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id="codelens.widget-"+CodeLensContentWidget._idPool++,this.updatePosition(i),this._domNode=document.createElement("span"),this._domNode.className=`codelens-decoration ${t}`}withCommands(e,t){this._commands.clear();let i=[],n=!1;for(let o=0;o<e.length;o++){const t=e[o];if(t&&(n=!0,t.command)){const n=renderLabelWithIcons(t.command.title.trim());t.command.id?(i.push($$c("a",{id:String(o),title:t.command.tooltip},...n)),this._commands.set(String(o),t.command)):i.push($$c("span",{title:t.command.tooltip},...n)),o+1<e.length&&i.push($$c("span",void 0," | "))}}n?(reset(this._domNode,...i),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):reset(this._domNode,$$c("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}}CodeLensContentWidget._idPool=0;class CodeLensHelper{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){let t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,n=t.length;i<n;i++)this._addDecorationsCallbacks[i](t[i])}}class CodeLensWidget{constructor(e,t,i,n,o,r,s){let a;this._isDisposed=!1,this._editor=t,this._className=i,this._data=e,this._decorationIds=[];let l=[];this._data.forEach(((e,t)=>{e.symbol.command&&l.push(e.symbol),n.addDecoration({range:e.symbol.range,options:ModelDecorationOptions.EMPTY},(e=>this._decorationIds[t]=e)),a=a?Range$2.plusRange(a,e.symbol.range):Range$2.lift(e.symbol.range)})),this._viewZone=new CodeLensViewZone(a.startLineNumber-1,r,s),this._viewZoneId=o.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new CodeLensContentWidget(this._editor,this._className,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t&&t.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some(((e,t)=>{const i=this._editor.getModel().getDecorationRange(e),n=this._data[t].symbol;return!(!i||Range$2.isEmpty(n.range)!==i.isEmpty())}))}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach(((e,i)=>{t.addDecoration({range:e.symbol.range,options:ModelDecorationOptions.EMPTY},(e=>this._decorationIds[i]=e))}))}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){const i=e.getDecorationRange(this._decorationIds[t]);i&&(this._data[t].symbol.range=i)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const i=e[t];if(i){const{symbol:e}=this._data[t];e.command=i.command||e.command}}}getCommand(e){var t;return null===(t=this._contentWidget)||void 0===t?void 0:t.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}const NO_KEY_MODS={ctrlCmd:!1,alt:!1};var QuickInputHideReason,QuickInputHideReason2,ItemActivation,ItemActivation2;QuickInputHideReason2=QuickInputHideReason||(QuickInputHideReason={}),QuickInputHideReason2[QuickInputHideReason2.Blur=1]="Blur",QuickInputHideReason2[QuickInputHideReason2.Gesture=2]="Gesture",QuickInputHideReason2[QuickInputHideReason2.Other=3]="Other",ItemActivation2=ItemActivation||(ItemActivation={}),ItemActivation2[ItemActivation2.NONE=0]="NONE",ItemActivation2[ItemActivation2.FIRST=1]="FIRST",ItemActivation2[ItemActivation2.SECOND=2]="SECOND",ItemActivation2[ItemActivation2.LAST=3]="LAST";const IQuickInputService=createDecorator("quickInputService");function clamp(e,t,i){return Math.min(Math.max(e,t),i)}class MovingAverage{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class SlidingWindowAverage{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}var __decorate$1k=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1g=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const ILanguageFeatureDebounceService=createDecorator("ILanguageFeatureDebounceService");var IdentityHash;!function(e){const t=new WeakMap;let i=0;e.of=function(e){let n=t.get(e);return void 0===n&&(n=++i,t.set(e,n)),n}}(IdentityHash||(IdentityHash={}));class FeatureDebounceInformation{constructor(e,t,i,n,o,r){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=o,this._max=r,this._cache=new LRUCache(50,.7)}_key(e){return e.id+this._registry.all(e).reduce(((e,t)=>doHash(IdentityHash.of(t),e)),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?clamp(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new SlidingWindowAverage(6),this._cache.set(i,n));const o=clamp(n.update(t),this._min,this._max);return this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${o}ms`),o}_overall(){const e=new MovingAverage;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){return clamp(0|this._overall()||this._default,this._min,this._max)}}let LanguageFeatureDebounceService=class{constructor(e){this._logService=e,this._data=new Map}for(e,t,i){var n,o,r;const s=null!==(n=null==i?void 0:i.min)&&void 0!==n?n:50,a=null!==(o=null==i?void 0:i.max)&&void 0!==o?o:Math.pow(s,2),l=null!==(r=null==i?void 0:i.key)&&void 0!==r?r:void 0,d=`${IdentityHash.of(e)},${s}${l?","+l:""}`;let c=this._data.get(d);return c||(c=new FeatureDebounceInformation(this._logService,t,e,0|this._overallAverage()||1.5*s,s,a),this._data.set(d,c)),c}_overallAverage(){let e=new MovingAverage;for(let t of this._data.values())e.update(t.default());return e.value}};LanguageFeatureDebounceService=__decorate$1k([__param$1g(0,ILogService)],LanguageFeatureDebounceService),registerSingleton(ILanguageFeatureDebounceService,LanguageFeatureDebounceService,!0);var __decorate$1j=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1f=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$T=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let CodeLensContribution=class{constructor(e,t,i,n,o,r){this._editor=e,this._languageFeaturesService=t,this._commandService=n,this._notificationService=o,this._codeLensCache=r,this._disposables=new DisposableStore,this._localToDispose=new DisposableStore,this._lenses=[],this._oldCodeLensModels=new DisposableStore,this._provideCodeLensDebounce=i.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=i.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new RunOnceScheduler((()=>this._resolveCodeLensesInViewport()),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>this._onModelChange()))),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(44)||e.hasChanged(16)||e.hasChanged(15))&&this._updateLensStyle(),e.hasChanged(14)&&this._onModelChange()}))),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._styleClassName="_"+hash(this._editor.getId()).toString(16),this._styleElement=createStyleSheet(isInShadowDOM(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0),this._updateLensStyle()}dispose(){var e;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),null===(e=this._currentCodeLensModel)||void 0===e||e.dispose(),this._styleElement.remove()}_getLayoutInfo(){let e,t=this._editor.getOption(16);return!t||t<5?(t=.9*this._editor.getOption(46)|0,e=this._editor.getOption(59)):e=t*Math.max(1.3,this._editor.getOption(59)/this._editor.getOption(46))|0,{codeLensHeight:e,fontSize:t}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(15),n=this._editor.getOption(44),o=`--codelens-font-family${this._styleClassName}`,r=`--codelens-font-features${this._styleClassName}`;let s=`\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${e}px; font-size: ${t}px; padding-right: ${Math.round(.5*t)}px; font-feature-settings: var(${r}) }\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${e}px; font-size: ${t}px; }\n\t\t`;i&&(s+=`.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${o}), ${EDITOR_FONT_DEFAULTS.fontFamily}}`),this._styleElement.textContent=s,this._editor.getContainerDomNode().style.setProperty(o,null!=i?i:"inherit"),this._editor.getContainerDomNode().style.setProperty(r,n.fontFeatureSettings),this._editor.changeViewZones((t=>{for(let i of this._lenses)i.updateHeight(e,t)}))}_localDispose(){var e,t,i;null===(e=this._getCodeLensModelPromise)||void 0===e||e.cancel(),this._getCodeLensModelPromise=void 0,null===(t=this._resolveCodeLensesPromise)||void 0===t||t.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),null===(i=this._currentCodeLensModel)||void 0===i||i.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e)return;if(!this._editor.getOption(14))return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e))return void(t&&this._localToDispose.add(disposableTimeout((()=>{const i=this._codeLensCache.get(e);t===i&&(this._codeLensCache.delete(e),this._onModelChange())}),3e4)));for(const n of this._languageFeaturesService.codeLensProvider.all(e))if("function"==typeof n.onDidChange){let e=n.onDidChange((()=>i.schedule()));this._localToDispose.add(e)}const i=new RunOnceScheduler((()=>{var t;const n=Date.now();null===(t=this._getCodeLensModelPromise)||void 0===t||t.cancel(),this._getCodeLensModelPromise=createCancelablePromise((t=>getCodeLensModel(this._languageFeaturesService.codeLensProvider,e,t))),this._getCodeLensModelPromise.then((t=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=t,this._codeLensCache.put(e,t);const o=this._provideCodeLensDebounce.update(e,Date.now()-n);i.delay=o,this._renderCodeLensSymbols(t),this._resolveCodeLensesInViewportSoon()}),onUnexpectedError)}),this._provideCodeLensDebounce.get(e));this._localToDispose.add(i),this._localToDispose.add(toDisposable((()=>this._resolveCodeLensesScheduler.cancel()))),this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{let i=[],n=-1;this._lenses.forEach((e=>{e.isValid()&&n!==e.getLineNumber()?(e.update(t),n=e.getLineNumber()):i.push(e)}));let o=new CodeLensHelper;i.forEach((e=>{e.dispose(o,t),this._lenses.splice(this._lenses.indexOf(e),1)})),o.commit(e)}))})),i.schedule()}))),this._localToDispose.add(this._editor.onDidFocusEditorWidget((()=>{i.schedule()}))),this._localToDispose.add(this._editor.onDidScrollChange((e=>{e.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(this._editor.onDidLayoutChange((()=>{this._resolveCodeLensesInViewportSoon()}))),this._localToDispose.add(toDisposable((()=>{if(this._editor.getModel()){const e=StableEditorScrollState.capture(this._editor);this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{this._disposeAllLenses(e,t)}))})),e.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)}))),this._localToDispose.add(this._editor.onMouseDown((e=>{if(9!==e.target.type)return;let t=e.target.element;if("SPAN"===(null==t?void 0:t.tagName)&&(t=t.parentElement),"A"===(null==t?void 0:t.tagName))for(const i of this._lenses){let e=i.getCommand(t);if(e){this._commandService.executeCommand(e.id,...e.arguments||[]).catch((e=>this._notificationService.error(e)));break}}}))),i.schedule()}_disposeAllLenses(e,t){const i=new CodeLensHelper;for(const n of this._lenses)n.dispose(i,t);e&&i.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;let t,i=this._editor.getModel().getLineCount(),n=[];for(let s of e.lenses){let e=s.symbol.range.startLineNumber;e<1||e>i||(t&&t[t.length-1].symbol.range.startLineNumber===e?t.push(s):(t=[s],n.push(t)))}const o=StableEditorScrollState.capture(this._editor),r=this._getLayoutInfo();this._editor.changeDecorations((e=>{this._editor.changeViewZones((t=>{const i=new CodeLensHelper;let o=0,s=0;for(;s<n.length&&o<this._lenses.length;){let e=n[s][0].symbol.range.startLineNumber,a=this._lenses[o].getLineNumber();a<e?(this._lenses[o].dispose(i,t),this._lenses.splice(o,1)):a===e?(this._lenses[o].updateCodeLensSymbols(n[s],i),s++,o++):(this._lenses.splice(o,0,new CodeLensWidget(n[s],this._editor,this._styleClassName,i,t,r.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),o++,s++)}for(;o<this._lenses.length;)this._lenses[o].dispose(i,t),this._lenses.splice(o,1);for(;s<n.length;)this._lenses.push(new CodeLensWidget(n[s],this._editor,this._styleClassName,i,t,r.codeLensHeight,(()=>this._resolveCodeLensesInViewportSoon()))),s++;i.commit(e)}))})),o.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var e;null===(e=this._resolveCodeLensesPromise)||void 0===e||e.cancel(),this._resolveCodeLensesPromise=void 0;const t=this._editor.getModel();if(!t)return;const i=[],n=[];if(this._lenses.forEach((e=>{const o=e.computeIfNecessary(t);o&&(i.push(o),n.push(e))})),0===i.length)return;const o=Date.now(),r=createCancelablePromise((e=>{const o=i.map(((i,o)=>{const r=new Array(i.length),s=i.map(((i,n)=>i.symbol.command||"function"!=typeof i.provider.resolveCodeLens?(r[n]=i.symbol,Promise.resolve(void 0)):Promise.resolve(i.provider.resolveCodeLens(t,i.symbol,e)).then((e=>{r[n]=e}),onUnexpectedExternalError)));return Promise.all(s).then((()=>{e.isCancellationRequested||n[o].isDisposed()||n[o].updateCommands(r)}))}));return Promise.all(o)}));this._resolveCodeLensesPromise=r,this._resolveCodeLensesPromise.then((()=>{const e=this._resolveCodeLensesDebounce.update(t,Date.now()-o);this._resolveCodeLensesScheduler.delay=e,this._currentCodeLensModel&&this._codeLensCache.put(t,this._currentCodeLensModel),this._oldCodeLensModels.clear(),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}),(e=>{onUnexpectedError(e),r===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)}))}getModel(){return this._currentCodeLensModel}};function getColors(e,t,i){const n=[],o=e.ordered(t).reverse().map((e=>Promise.resolve(e.provideDocumentColors(t,i)).then((t=>{if(Array.isArray(t))for(let i of t)n.push({colorInfo:i,provider:e})}))));return Promise.all(o).then((()=>n))}function getColorPresentations(e,t,i,n){return Promise.resolve(i.provideColorPresentations(e,t,n))}CodeLensContribution.ID="css.editor.codeLens",CodeLensContribution=__decorate$1j([__param$1f(1,ILanguageFeaturesService),__param$1f(2,ILanguageFeatureDebounceService),__param$1f(3,ICommandService),__param$1f(4,INotificationService),__param$1f(5,ICodeLensCache)],CodeLensContribution),registerEditorContribution(CodeLensContribution.ID,CodeLensContribution),registerEditorAction(class extends EditorAction{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:EditorContextKeys.hasCodeLensProvider,label:localize("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}run(e,t){return __awaiter$T(this,void 0,void 0,(function*(){if(!t.hasModel())return;const i=e.get(IQuickInputService),n=e.get(ICommandService),o=e.get(INotificationService),r=t.getSelection().positionLineNumber,s=t.getContribution(CodeLensContribution.ID);if(!s)return;const a=s.getModel();if(!a)return;const l=[];for(const e of a.lenses)e.symbol.command&&e.symbol.range.startLineNumber===r&&l.push({label:e.symbol.command.title,command:e.symbol.command});if(0===l.length)return;const d=yield i.pick(l,{canPickMany:!1});if(d){if(a.isDisposed)return yield n.executeCommand(this.id);try{yield n.executeCommand(d.command.id,...d.command.arguments||[])}catch(c){o.error(c)}}}))}}),CommandsRegistry.registerCommand("_executeDocumentColorProvider",(function(e,...t){const[i]=t;if(!(i instanceof URI))throw illegalArgument();const{colorProvider:n}=e.get(ILanguageFeaturesService),o=e.get(IModelService).getModel(i);if(!o)throw illegalArgument();const r=[],s=n.ordered(o).reverse().map((e=>Promise.resolve(e.provideDocumentColors(o,CancellationToken.None)).then((e=>{if(Array.isArray(e))for(let t of e)r.push({range:t.range,color:[t.color.red,t.color.green,t.color.blue,t.color.alpha]})}))));return Promise.all(s).then((()=>r))})),CommandsRegistry.registerCommand("_executeColorPresentationProvider",(function(e,...t){const[i,n]=t,{uri:o,range:r}=n;if(!(o instanceof URI&&Array.isArray(i)&&4===i.length&&Range$2.isIRange(r)))throw illegalArgument();const[s,a,l,d]=i,{colorProvider:c}=e.get(ILanguageFeaturesService),h=e.get(IModelService).getModel(o);if(!h)throw illegalArgument();const u={range:r,color:{red:s,green:a,blue:l,alpha:d}},g=[],p=c.ordered(h).reverse().map((e=>Promise.resolve(e.provideColorPresentations(h,u,CancellationToken.None)).then((e=>{Array.isArray(e)&&g.push(...e)}))));return Promise.all(p).then((()=>g))}));var __decorate$1i=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1e=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$S=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const ColorDecorationInjectedTextMarker=Object.create({}),MAX_DECORATORS=500;let ColorDetector=class e extends Disposable{constructor(t,i,n,o){super(),this._editor=t,this._configurationService=i,this._languageFeaturesService=n,this._localToDispose=this._register(new DisposableStore),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=new Set,this._ruleFactory=new DynamicCssRules(this._editor),this._colorDecorationClassRefs=this._register(new DisposableStore),this._debounceInformation=o.for(n.colorProvider,"Document Colors",{min:e.RECOMPUTE_TIME}),this._register(t.onDidChangeModel((()=>{this._isEnabled=this.isEnabled(),this.onModelChanged()}))),this._register(t.onDidChangeModelLanguage((()=>this.onModelChanged()))),this._register(n.colorProvider.onDidChange((()=>this.onModelChanged()))),this._register(t.onDidChangeConfiguration((()=>{let e=this._isEnabled;this._isEnabled=this.isEnabled(),e!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())}))),this._timeoutTimer=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&"object"==typeof i){const e=i.colorDecorators;if(e&&void 0!==e.enable&&!e.enable)return e.enable}return this._editor.getOption(17)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}onModelChanged(){if(this.stop(),!this._isEnabled)return;const e=this._editor.getModel();e&&this._languageFeaturesService.colorProvider.has(e)&&(this._localToDispose.add(this._editor.onDidChangeModelContent((()=>{this._timeoutTimer||(this._timeoutTimer=new TimeoutTimer,this._timeoutTimer.cancelAndSet((()=>{this._timeoutTimer=null,this.beginCompute()}),this._debounceInformation.get(e)))}))),this.beginCompute())}beginCompute(){this._computePromise=createCancelablePromise((e=>__awaiter$S(this,void 0,void 0,(function*(){const t=this._editor.getModel();if(!t)return Promise.resolve([]);const i=new StopWatch(!1),n=yield getColors(this._languageFeaturesService.colorProvider,t,e);return this._debounceInformation.update(t,i.elapsed()),n})))),this._computePromise.then((e=>{this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}),onUnexpectedError)}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map((e=>({range:{startLineNumber:e.colorInfo.range.startLineNumber,startColumn:e.colorInfo.range.startColumn,endLineNumber:e.colorInfo.range.endLineNumber,endColumn:e.colorInfo.range.endColumn},options:ModelDecorationOptions.EMPTY})));this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach(((t,i)=>this._colorDatas.set(t,e[i])))}updateColorDecorators(e){this._colorDecorationClassRefs.clear();let t=[];for(let i=0;i<e.length&&t.length<MAX_DECORATORS;i++){const{red:n,green:o,blue:r,alpha:s}=e[i].colorInfo.color,a=new RGBA(Math.round(255*n),Math.round(255*o),Math.round(255*r),s);let l=`rgba(${a.r}, ${a.g}, ${a.b}, ${a.a})`;const d=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:l}));t.push({range:{startLineNumber:e[i].colorInfo.range.startLineNumber,startColumn:e[i].colorInfo.range.startColumn,endLineNumber:e[i].colorInfo.range.endLineNumber,endColumn:e[i].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:noBreakWhitespace,inlineClassName:`${d.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:ColorDecorationInjectedTextMarker}}})}this._colorDecoratorIds=new Set(this._editor.deltaDecorations([...this._colorDecoratorIds],t))}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=new Set(this._editor.deltaDecorations([...this._colorDecoratorIds],[])),this._colorDecorationClassRefs.clear()}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(Range$2.fromPositions(e,e)).filter((e=>this._colorDatas.has(e.id)));return 0===i.length?null:this._colorDatas.get(i[0].id)}isColorDecorationId(e){return this._colorDecoratorIds.has(e)}};ColorDetector.ID="editor.contrib.colorDetector",ColorDetector.RECOMPUTE_TIME=1e3,ColorDetector=__decorate$1i([__param$1e(1,IConfigurationService),__param$1e(2,ILanguageFeaturesService),__param$1e(3,ILanguageFeatureDebounceService)],ColorDetector),registerEditorContribution(ColorDetector.ID,ColorDetector);class ColorPickerModel{constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new Emitter$1,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new Emitter$1,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new Emitter$1,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){for(let i=0;i<this.colorPresentations.length;i++)if(t.toLowerCase()===this.colorPresentations[i].label){this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation);break}}flushColor(){this._onColorFlushed.fire(this._color)}}var colorPicker="";const $$b=$$c;class ColorPickerHeader extends Disposable{constructor(e,t,i){super(),this.model=t,this.domNode=$$b(".colorpicker-header"),append$1(e,this.domNode),this.pickedColorNode=append$1(this.domNode,$$b(".picked-color"));const n=localize("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this.pickedColorNode.setAttribute("title",n);const o=append$1(this.domNode,$$b(".original-color"));o.style.backgroundColor=Color.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(editorHoverBackground)||Color.white,this._register(registerThemingParticipant(((e,t)=>{this.backgroundColor=e.getColor(editorHoverBackground)||Color.white}))),this._register(addDisposableListener(this.pickedColorNode,EventType$1.CLICK,(()=>this.model.selectNextColorPresentation()))),this._register(addDisposableListener(o,EventType$1.CLICK,(()=>{this.model.color=this.model.originalColor,this.model.flushColor()}))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=Color.Format.CSS.format(t.color)||"",this.pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter()),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){this.pickedColorNode.style.backgroundColor=Color.Format.CSS.format(e)||"",this.pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:"",this.pickedColorNode.prepend($$b(".codicon.codicon-color-mode"))}}class ColorPickerBody extends Disposable{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this.domNode=$$b(".colorpicker-body"),append$1(e,this.domNode),this.saturationBox=new SaturationBox(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new OpacityStrip(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new HueStrip(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new Color(new HSVA(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new Color(new HSVA(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=360*(1-e);this.model.color=new Color(new HSVA(360===i?0:i,t.s,t.v,t.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}}class SaturationBox extends Disposable{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Emitter$1,this.onColorFlushed=this._onColorFlushed.event,this.domNode=$$b(".saturation-wrap"),append$1(e,this.domNode),this.canvas=document.createElement("canvas"),this.canvas.className="saturation-box",append$1(this.domNode,this.canvas),this.selection=$$b(".saturation-selection"),append$1(this.domNode,this.selection),this.layout(),this._register(addDisposableGenericMouseDownListener(this.domNode,(e=>this.onMouseDown(e)))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new GlobalMouseMoveMonitor);const t=getDomNodePagePosition(this.domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.buttons,standardMouseMoveMerger,(e=>this.onDidChangePosition(e.posx-t.left,e.posy-t.top)),(()=>null));const i=addDisposableGenericMouseUpListener(document,(()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)}),!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new Color(new HSVA(e.h,1,1,1)),i=this.canvas.getContext("2d"),n=i.createLinearGradient(0,0,this.canvas.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)");const o=i.createLinearGradient(0,0,0,this.canvas.height);o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this.canvas.width,this.canvas.height),i.fillStyle=Color.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=o,i.fill()}paintSelection(e,t){this.selection.style.left=e*this.width+"px",this.selection.style.top=this.height-t*this.height+"px"}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}}class Strip extends Disposable{constructor(e,t){super(),this.model=t,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new Emitter$1,this.onColorFlushed=this._onColorFlushed.event,this.domNode=append$1(e,$$b(".strip")),this.overlay=append$1(this.domNode,$$b(".overlay")),this.slider=append$1(this.domNode,$$b(".slider")),this.slider.style.top="0px",this._register(addDisposableGenericMouseDownListener(this.domNode,(e=>this.onMouseDown(e)))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onMouseDown(e){const t=this._register(new GlobalMouseMoveMonitor),i=getDomNodePagePosition(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.buttons,standardMouseMoveMerger,(e=>this.onDidChangeTop(e.posy-i.top)),(()=>null));const n=addDisposableGenericMouseUpListener(document,(()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")}),!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=(1-e)*this.height+"px"}}class OpacityStrip extends Strip{constructor(e,t){super(e,t),this.domNode.classList.add("opacity-strip"),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){const{r:t,g:i,b:n}=e.rgba,o=new Color(new RGBA(t,i,n,1)),r=new Color(new RGBA(t,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${o} 0%, ${r} 100%)`}getValue(e){return e.hsva.a}}class HueStrip extends Strip{constructor(e,t){super(e,t),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class ColorPickerWidget extends Widget{constructor(e,t,i,n){super(),this.model=t,this.pixelRatio=i,this._register(PixelRatio.onDidChange((()=>this.layout())));const o=$$b(".colorpicker-widget");e.appendChild(o);const r=new ColorPickerHeader(o,this.model,n);this.body=new ColorPickerBody(o,this.model,this.pixelRatio),this._register(r),this._register(this.body)}layout(){this.body.layout()}}var __decorate$1h=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1d=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$R=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class ColorHover{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let ColorHoverParticipant=class{constructor(e,t){this._editor=e,this._themeService=t,this.hoverOrdinal=1}computeSync(e,t){return[]}computeAsync(e,t,i){return AsyncIterableObject.fromPromise(this._computeAsync(e,t,i))}_computeAsync(e,t,i){return __awaiter$R(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return[];const e=ColorDetector.get(this._editor);if(!e)return[];for(const i of t){if(!e.isColorDecorationId(i.id))continue;const t=e.getColorData(i.range.getStartPosition());if(t){return[yield this._createColorHover(this._editor.getModel(),t.colorInfo,t.provider)]}}return[]}))}_createColorHover(e,t,i){return __awaiter$R(this,void 0,void 0,(function*(){const n=e.getValueInRange(t.range),{red:o,green:r,blue:s,alpha:a}=t.color,l=new RGBA(Math.round(255*o),Math.round(255*r),Math.round(255*s),a),d=new Color(l),c=yield getColorPresentations(e,t,i,CancellationToken.None),h=new ColorPickerModel(d,[],0);return h.colorPresentations=c||[],h.guessColorPresentation(d,n),new ColorHover(this,Range$2.lift(t.range),h,i)}))}renderHoverParts(e,t){if(0===t.length||!this._editor.hasModel())return Disposable.None;const i=new DisposableStore,n=t[0],o=this._editor.getModel(),r=n.model,s=i.add(new ColorPickerWidget(e.fragment,r,this._editor.getOption(129),this._themeService));e.setColorPicker(s);let a=new Range$2(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn);const l=()=>{let t,i;if(r.presentation.textEdit){t=[r.presentation.textEdit],i=new Range$2(r.presentation.textEdit.range.startLineNumber,r.presentation.textEdit.range.startColumn,r.presentation.textEdit.range.endLineNumber,r.presentation.textEdit.range.endColumn);const e=this._editor.getModel()._setTrackedRange(null,i,3);this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",t),i=this._editor.getModel()._getTrackedRange(e)||i}else t=[{range:a,text:r.presentation.label,forceMoveMarkers:!1}],i=a.setEndPosition(a.endLineNumber,a.startColumn+r.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits("colorpicker",t);r.presentation.additionalTextEdits&&(t=[...r.presentation.additionalTextEdits],this._editor.executeEdits("colorpicker",t),e.hide()),this._editor.pushUndoStop(),a=i},d=e=>getColorPresentations(o,{range:a,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},n.provider,CancellationToken.None).then((e=>{r.colorPresentations=e||[]}));return i.add(r.onColorFlushed((e=>{d(e).then(l)}))),i.add(r.onDidChangeColor(d)),i}};ColorHoverParticipant=__decorate$1h([__param$1d(1,IThemeService)],ColorHoverParticipant);var goToDefinitionAtPosition="";function hasModifier(e,t){return!!e[t]}class ClickLinkMouseEvent{constructor(e,t){this.target=e.target,this.hasTriggerModifier=hasModifier(e.event,t.triggerModifier),this.hasSideBySideModifier=hasModifier(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class ClickLinkKeyboardEvent{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=hasModifier(e,t.triggerModifier)}}class ClickLinkOptions{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function createOptions(e){return"altKey"===e?isMacintosh?new ClickLinkOptions(57,"metaKey",6,"altKey"):new ClickLinkOptions(5,"ctrlKey",6,"altKey"):isMacintosh?new ClickLinkOptions(6,"altKey",57,"metaKey"):new ClickLinkOptions(6,"altKey",5,"ctrlKey")}class ClickLinkGesture extends Disposable{constructor(e){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new Emitter$1),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new Emitter$1),this.onExecute=this._onExecute.event,this._onCancel=this._register(new Emitter$1),this.onCancel=this._onCancel.event,this._editor=e,this._opts=createOptions(this._editor.getOption(70)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((e=>{if(e.hasChanged(70)){const e=createOptions(this._editor.getOption(70));if(this._opts.equals(e))return;this._opts=e,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((e=>this._onEditorMouseMove(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(new ClickLinkMouseEvent(e,this._opts))))),this._register(this._editor.onKeyDown((e=>this._onEditorKeyDown(new ClickLinkKeyboardEvent(e,this._opts))))),this._register(this._editor.onKeyUp((e=>this._onEditorKeyUp(new ClickLinkKeyboardEvent(e,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((e=>this._onDidChangeCursorSelection(e)))),this._register(this._editor.onDidChangeModel((e=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}_onEditorMouseUp(e){const t=e.target.position?e.target.position.lineNumber:0;this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}var peekViewWidget="",__decorate$1g=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1c=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let EmbeddedCodeEditorWidget=class extends CodeEditorWidget{constructor(e,t,i,n,o,r,s,a,l,d,c,h){super(e,Object.assign(Object.assign({},i.getRawOptions()),{overflowWidgetsDomNode:i.getOverflowWidgetsDomNode()}),{},n,o,r,s,a,l,d,c,h),this._parentEditor=i,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(i.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){mixin(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};EmbeddedCodeEditorWidget=__decorate$1g([__param$1c(3,IInstantiationService),__param$1c(4,ICodeEditorService),__param$1c(5,ICommandService),__param$1c(6,IContextKeyService),__param$1c(7,IThemeService),__param$1c(8,INotificationService),__param$1c(9,IAccessibilityService),__param$1c(10,ILanguageConfigurationService),__param$1c(11,ILanguageFeaturesService)],EmbeddedCodeEditorWidget);class IdGenerator{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const defaultGenerator=new IdGenerator("id#");var zoneWidget="";const defaultColor=new Color(new RGBA(0,122,204)),defaultOptions$2={showArrow:!0,showFrame:!0,className:"",frameColor:defaultColor,arrowColor:defaultColor,keepEditorSelection:!1},WIDGET_ID="vs.editor.contrib.zoneWidget";class ViewZoneDelegate{constructor(e,t,i,n,o,r){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this._onDomNodeTop=o,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class OverlayWidgetDelegate{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}class Arrow{constructor(e){this._editor=e,this._ruleName=Arrow._IdGenerator.nextId(),this._decorations=[],this._color=null,this._height=-1}dispose(){this.hide(),removeCSSRulesContainingSelector(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){removeCSSRulesContainingSelector(this._ruleName),createCSSRule(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){1===e.column&&(e={lineNumber:e.lineNumber,column:2}),this._decorations=this._editor.deltaDecorations(this._decorations,[{range:Range$2.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}}Arrow._IdGenerator=new IdGenerator(".arrow-decoration-");class ZoneWidget{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._positionMarkerId=[],this._viewZone=null,this._disposables=new DisposableStore,this.container=null,this._isShowing=!1,this.editor=e,this.options=deepClone(t),mixin(this.options,defaultOptions$2,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange((e=>{const t=this._getWidth(e);this.domNode.style.width=t+"px",this.domNode.style.left=this._getLeft(e)+"px",this._onWidth(t)})))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null})),this.editor.deltaDecorations(this._positionMarkerId,[]),this._positionMarkerId=[],this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Arrow(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){let e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&0===e.minimap.minimapLeft?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){let t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;const i=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(i))}this._resizeSash&&this._resizeSash.layout()}get position(){const[e]=this._positionMarkerId;if(!e)return;const t=this.editor.getModel();if(!t)return;const i=t.getDecorationRange(e);return i?i.getStartPosition():void 0}show(e,t){const i=Range$2.isIRange(e)?Range$2.lift(e):Range$2.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range:i,options:ModelDecorationOptions.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id)})),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let e=this.editor.getOption(59),t=0;if(this.options.showArrow){t+=2*Math.round(e/3)}if(this.options.showFrame){t+=2*Math.round(e/9)}return t}_showImpl(e,t){const i=e.getStartPosition(),n=this.editor.getLayoutInfo(),o=this._getWidth(n);this.domNode.style.width=`${o}px`,this.domNode.style.left=this._getLeft(n)+"px";const r=document.createElement("div");r.style.overflow="hidden";const s=this.editor.getOption(59),a=Math.max(12,this.editor.getLayoutInfo().height/s*.8);t=Math.min(t,a);let l=0,d=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(s/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(d=Math.round(s/9)),this.editor.changeViewZones((e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new ViewZoneDelegate(r,i.lineNumber,i.column,t,(e=>this._onViewZoneTop(e)),(e=>this._onViewZoneHeight(e))),this._viewZone.id=e.addZone(this._viewZone),this._overlayWidget=new OverlayWidgetDelegate(WIDGET_ID+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)})),this.container&&this.options.showFrame){const e=this.options.frameWidth?this.options.frameWidth:d;this.container.style.borderTopWidth=e+"px",this.container.style.borderBottomWidth=e+"px"}let c=t*s-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=c+"px",this.container.style.overflow="hidden"),this._doLayout(c,o),this.options.keepEditorSelection||this.editor.setSelection(e);const h=this.editor.getModel();if(h){const t=e.endLineNumber+1;t<=h.getLineCount()?this.revealLine(t,!1):this.revealLine(h.getLineCount(),!0)}}revealLine(e,t){t?this.editor.revealLineInCenter(e,0):this.editor.revealLine(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones((t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))}))}_initSash(){if(this._resizeSash)return;let e;this._resizeSash=this._disposables.add(new Sash(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0),this._disposables.add(this._resizeSash.onDidStart((t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})}))),this._disposables.add(this._resizeSash.onDidEnd((()=>{e=void 0}))),this._disposables.add(this._resizeSash.onDidChange((t=>{if(e){let i=(t.currentY-e.startY)/this.editor.getOption(59),n=i<0?Math.ceil(i):Math.floor(i),o=e.heightInLines+n;o>5&&o<35&&this._relayout(o)}})))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(null===this.domNode.style.height?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var dropdown="";class BaseDropdown extends ActionRunner{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new Emitter$1),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=append$1(e,$$c(".monaco-dropdown")),this._label=append$1(this._element,$$c(".dropdown-label"));let i=t.labelRenderer;i||(i=e=>(e.textContent=t.label||"",null));for(const o of[EventType$1.CLICK,EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this.element,o,(e=>EventHelper.stop(e,!0))));for(const o of[EventType$1.MOUSE_DOWN,EventType.Tap])this._register(addDisposableListener(this._label,o,(e=>{e instanceof MouseEvent&&e.detail>1||(this.visible?this.hide():this.show())})));this._register(addDisposableListener(this._label,EventType$1.KEY_UP,(e=>{const t=new StandardKeyboardEvent(e);(t.equals(3)||t.equals(10))&&(EventHelper.stop(e,!0),this.visible?this.hide():this.show())})));const n=i(this._label);n&&this._register(n),this._register(Gesture.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class DropdownMenu extends BaseDropdown{constructor(e,t){super(e,t),this._actions=[],this._contextMenuProvider=t.contextMenuProvider,this.actions=t.actions||[],this.actionProvider=t.actionProvider,this.menuClassName=t.menuClassName||"",this.menuAsChild=!!t.menuAsChild}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:e=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class DropdownMenuActionViewItem extends BaseActionViewItem{constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new Emitter$1),this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=Array.isArray(this.menuActionsOrProvider),i={contextMenuProvider:this.contextMenuProvider,labelRenderer:e=>{this.element=append$1(e,$$c("a.action-label"));let t=[];return"string"==typeof this.options.classNames?t=this.options.classNames.split(/\s+/g).filter((e=>!!e)):this.options.classNames&&(t=this.options.classNames),t.find((e=>"icon"===e))||t.push("codicon"),this.element.classList.add(...t),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this.element.title=this._action.label||"",null},menuAsChild:this.options.menuAsChild,actions:t?this.menuActionsOrProvider:void 0,actionProvider:t?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new DropdownMenu(e,i)),this._register(this.dropdownMenu.onDidChangeVisibility((e=>{var t;null===(t=this.element)||void 0===t||t.setAttribute("aria-expanded",`${e}`),this._onDidChangeVisibility.fire(e)}))),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const e=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return e.options.anchorAlignmentProvider()}})}this.updateEnabled()}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}updateEnabled(){var e,t;const i=!this.getAction().enabled;null===(e=this.actionItem)||void 0===e||e.classList.toggle("disabled",i),null===(t=this.element)||void 0===t||t.classList.toggle("disabled",i)}}class ModifierLabelProvider{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(0===t.length)return null;const n=[];for(let o=0,r=t.length;o<r;o++){const r=t[o],s=i(r);if(null===s)return null;n[o]=_simpleAsString(r,s,this.modifierLabels[e])}return n.join(" ")}}const UILabelProvider=new ModifierLabelProvider({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:localize({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),AriaLabelProvider=new ModifierLabelProvider({ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:localize({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:localize({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:localize({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:localize({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:localize({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),ElectronAcceleratorLabelProvider=new ModifierLabelProvider({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"});function _simpleAsString(e,t,i){if(null===t)return"";const n=[];return e.ctrlKey&&n.push(i.ctrlKey),e.shiftKey&&n.push(i.shiftKey),e.altKey&&n.push(i.altKey),e.metaKey&&n.push(i.metaKey),""!==t&&n.push(t),n.join(i.separator)}new ModifierLabelProvider({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});var menuEntryActionViewItem="",__decorate$1f=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1b=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$Q=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function createAndFillInActionBarActions(e,t,i,n,o,r,s){const a=e.getActions(t);return fillInActions(a,i,!1,"string"==typeof n?e=>e===n:n,o,r,s),asDisposable(a)}function asDisposable(e){const t=new DisposableStore;for(const[,i]of e)for(const e of i)t.add(e);return t}function fillInActions(e,t,i,n=(e=>"navigation"===e),o=Number.MAX_SAFE_INTEGER,r=(()=>!1),s=!1){let a,l;Array.isArray(t)?(a=t,l=t):(a=t.primary,l=t.secondary);const d=new Set;for(const[c,h]of e){let e;n(c)?(e=a,e.length>0&&s&&e.push(new Separator)):(e=l,e.length>0&&e.push(new Separator));for(let t of h){i&&(t=t instanceof MenuItemAction&&t.alt?t.alt:t);const n=e.push(t);t instanceof SubmenuAction&&d.add({group:c,action:t,index:n-1})}}for(const{group:c,action:h,index:u}of d){const e=n(c)?a:l,t=h.actions;(t.length<=1||e.length+t.length-2<=o)&&r(h,c,e.length)&&e.splice(u,1,...t)}if(a!==l&&a.length>o){const e=a.splice(o,a.length-o);l.unshift(...e,new Separator)}}let MenuEntryActionViewItem=class extends ActionViewItem{constructor(e,t,i,n,o){super(void 0,e,{icon:!(!e.class&&!e.item.icon),label:!e.class&&!e.item.icon,draggable:null==t?void 0:t.draggable}),this._keybindingService=i,this._notificationService=n,this._contextKeyService=o,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new MutableDisposable),this._altKey=ModifierKeyEmitter.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return __awaiter$Q(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}))}render(e){super.render(e),e.classList.add("menu-entry"),this._updateItemClass(this._menuItemAction.item);let t=!1,i=this._altKey.keyStatus.altKey||(isWindows||isLinux)&&this._altKey.keyStatus.shiftKey;const n=()=>{const e=t&&i;e!==this._wantsAltCommand&&(this._wantsAltCommand=e,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event((e=>{i=e.altKey||(isWindows||isLinux)&&e.shiftKey,n()}))),this._register(addDisposableListener(e,"mouseleave",(e=>{t=!1,n()}))),this._register(addDisposableListener(e,"mouseenter",(e=>{t=!0,n()})))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}updateTooltip(){if(this.label){const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?localize("titleAndKb","{0} ({1})",i,t):i;if(!this._wantsAltCommand&&this._menuItemAction.alt){const e=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,t=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),i=t&&t.getLabel(),o=i?localize("titleAndKb","{0} ({1})",e,i):e;n+=`\n[${UILabelProvider.modifierLabels[OS].altKey}] ${o}`}this.label.title=n}}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){var t;this._itemClassDispose.value=void 0;const{element:i,label:n}=this;if(!i||!n)return;const o=this._commandAction.checked&&(null===(t=e.toggled)||void 0===t?void 0:t.icon)?e.toggled.icon:e.icon;if(o)if(ThemeIcon.isThemeIcon(o)){const e=ThemeIcon.asClassNameArray(o);n.classList.add(...e),this._itemClassDispose.value=toDisposable((()=>{n.classList.remove(...e)}))}else o.light&&n.style.setProperty("--menu-entry-icon-light",asCSSUrl(o.light)),o.dark&&n.style.setProperty("--menu-entry-icon-dark",asCSSUrl(o.dark)),n.classList.add("icon"),this._itemClassDispose.value=toDisposable((()=>{n.classList.remove("icon"),n.style.removeProperty("--menu-entry-icon-light"),n.style.removeProperty("--menu-entry-icon-dark")}))}};MenuEntryActionViewItem=__decorate$1f([__param$1b(2,IKeybindingService),__param$1b(3,INotificationService),__param$1b(4,IContextKeyService)],MenuEntryActionViewItem);let SubmenuEntryActionViewItem=class extends DropdownMenuActionViewItem{constructor(e,t,i){var n,o;const r=Object.assign({},null!=t?t:Object.create(null),{menuAsChild:null!==(n=null==t?void 0:t.menuAsChild)&&void 0!==n&&n,classNames:null!==(o=null==t?void 0:t.classNames)&&void 0!==o?o:ThemeIcon.isThemeIcon(e.item.icon)?ThemeIcon.asClassName(e.item.icon):void 0});super(e,{getActions:()=>e.actions},i,r)}render(e){if(super.render(e),this.element){e.classList.add("menu-entry");const{icon:t}=this._action.item;t&&!ThemeIcon.isThemeIcon(t)&&(this.element.classList.add("icon"),t.light&&this.element.style.setProperty("--menu-entry-icon-light",asCSSUrl(t.light)),t.dark&&this.element.style.setProperty("--menu-entry-icon-dark",asCSSUrl(t.dark)))}}};SubmenuEntryActionViewItem=__decorate$1f([__param$1b(2,IContextMenuService)],SubmenuEntryActionViewItem);let DropdownWithDefaultActionViewItem=class extends BaseActionViewItem{constructor(e,t,i,n,o,r,s,a){var l,d,c;let h;super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=o,this._menuService=r,this._instaService=s,this._storageService=a,this._container=null,this._storageKey=`${e.item.submenu._debugName}_lastActionId`;let u=a.get(this._storageKey,1);u&&(h=e.actions.find((e=>u===e.id))),h||(h=e.actions[0]),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,h,void 0);const g=Object.assign({},null!=t?t:Object.create(null),{menuAsChild:null===(l=null==t?void 0:t.menuAsChild)||void 0===l||l,classNames:null!==(d=null==t?void 0:t.classNames)&&void 0!==d?d:["codicon","codicon-chevron-down"],actionRunner:null!==(c=null==t?void 0:t.actionRunner)&&void 0!==c?c:new ActionRunner});this._dropdown=new DropdownMenuActionViewItem(e,e.actions,this._contextMenuService,g),this._dropdown.actionRunner.onDidRun((e=>{e.action instanceof MenuItemAction&&this.update(e.action)}))}update(e){this._storageService.store(this._storageKey,e.id,1,0),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(MenuEntryActionViewItem,e,void 0),this._defaultAction.actionRunner=new class extends ActionRunner{runAction(e,t){return __awaiter$Q(this,void 0,void 0,(function*(){yield e.run(void 0)}))}},this._container&&this._defaultAction.render(prepend$1(this._container,$$c(".action-container")))}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=$$c(".action-container");this._defaultAction.render(append$1(this._container,t)),this._register(addDisposableListener(t,EventType$1.KEY_DOWN,(e=>{const t=new StandardKeyboardEvent(e);t.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),t.stopPropagation())})));const i=$$c(".dropdown-action-container");this._dropdown.render(append$1(this._container,i)),this._register(addDisposableListener(i,EventType$1.KEY_DOWN,(e=>{var t;const i=new StandardKeyboardEvent(e);i.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),null===(t=this._defaultAction.element)||void 0===t||t.focus(),i.stopPropagation())})))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};function createActionViewItem(e,t,i){return t instanceof MenuItemAction?e.createInstance(MenuEntryActionViewItem,t,void 0):t instanceof SubmenuItemAction?t.item.rememberDefaultAction?e.createInstance(DropdownWithDefaultActionViewItem,t,i):e.createInstance(SubmenuEntryActionViewItem,t,i):void 0}DropdownWithDefaultActionViewItem=__decorate$1f([__param$1b(2,IKeybindingService),__param$1b(3,INotificationService),__param$1b(4,IContextMenuService),__param$1b(5,IMenuService),__param$1b(6,IInstantiationService),__param$1b(7,IStorageService)],DropdownWithDefaultActionViewItem);var __decorate$1e=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1a=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const IPeekViewService=createDecorator("IPeekViewService");var PeekContext,PeekContext2;registerSingleton(IPeekViewService,class{constructor(){this._widgets=new Map}addExclusiveWidget(e,t){const i=this._widgets.get(e);i&&(i.listener.dispose(),i.widget.dispose());this._widgets.set(e,{widget:t,listener:t.onDidClose((()=>{const i=this._widgets.get(e);i&&i.widget===t&&(i.listener.dispose(),this._widgets.delete(e))}))})}}),PeekContext2=PeekContext||(PeekContext={}),PeekContext2.inPeekEditor=new RawContextKey("inReferenceSearchEditor",!0,localize("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),PeekContext2.notInPeekEditor=PeekContext2.inPeekEditor.toNegated();let PeekContextController=class{constructor(e,t){e instanceof EmbeddedCodeEditorWidget&&PeekContext.inPeekEditor.bindTo(t)}dispose(){}};function getOuterEditor(e){let t=e.get(ICodeEditorService).getFocusedCodeEditor();return t instanceof EmbeddedCodeEditorWidget?t.getParentEditor():t}PeekContextController.ID="editor.contrib.referenceController",PeekContextController=__decorate$1e([__param$1a(1,IContextKeyService)],PeekContextController),registerEditorContribution(PeekContextController.ID,PeekContextController);const defaultOptions$1={headerBackgroundColor:Color.white,primaryHeadingColor:Color.fromHex("#333333"),secondaryHeadingColor:Color.fromHex("#6c6c6cb3")};let PeekViewWidget=class extends ZoneWidget{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new Emitter$1,this.onDidClose=this._onDidClose.event,mixin(this.options,defaultOptions$1,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){let t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();let e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=$$c(".head"),this._bodyElement=$$c(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){const i=$$c(".peekview-title");this.options.supportOnTitleClick&&(i.classList.add("clickable"),addStandardDisposableListener(i,"click",(e=>this._onTitleClick(e)))),append$1(this._headElement,i),this._fillTitleIcon(i),this._primaryHeading=$$c("span.filename"),this._secondaryHeading=$$c("span.dirname"),this._metaHeading=$$c("span.meta"),append$1(i,this._primaryHeading,this._secondaryHeading,this._metaHeading);const n=$$c(".peekview-actions");append$1(this._headElement,n);const o=this._getActionBarOptions();this._actionbarWidget=new ActionBar(n,o),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new Action("peekview.close",localize("label.close","Close"),Codicon.close.classNames,!0,(()=>(this.dispose(),Promise.resolve()))),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:createActionViewItem.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:clearNode(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,show(this._metaHeading)):hide(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0)return void this.dispose();const i=Math.ceil(1.2*this.editor.getOption(59)),n=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(n,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};PeekViewWidget=__decorate$1e([__param$1a(2,IInstantiationService)],PeekViewWidget);const peekViewTitleBackground=registerColor("peekViewTitle.background",{dark:transparent(editorInfoForeground,.1),light:transparent(editorInfoForeground,.1),hc:null},localize("peekViewTitleBackground","Background color of the peek view title area.")),peekViewTitleForeground=registerColor("peekViewTitleLabel.foreground",{dark:Color.white,light:Color.black,hc:Color.white},localize("peekViewTitleForeground","Color of the peek view title.")),peekViewTitleInfoForeground=registerColor("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hc:"#FFFFFF99"},localize("peekViewTitleInfoForeground","Color of the peek view title info.")),peekViewBorder=registerColor("peekView.border",{dark:editorInfoForeground,light:editorInfoForeground,hc:contrastBorder},localize("peekViewBorder","Color of the peek view borders and arrow.")),peekViewResultsBackground=registerColor("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hc:Color.black},localize("peekViewResultsBackground","Background color of the peek view result list."));registerColor("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hc:Color.white},localize("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list.")),registerColor("peekViewResult.fileForeground",{dark:Color.white,light:"#1E1E1E",hc:Color.white},localize("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list.")),registerColor("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hc:null},localize("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list.")),registerColor("peekViewResult.selectionForeground",{dark:Color.white,light:"#6C6C6C",hc:Color.white},localize("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const peekViewEditorBackground=registerColor("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hc:Color.black},localize("peekViewEditorBackground","Background color of the peek view editor."));function isCodeEditor(e){return!(!e||"function"!=typeof e.getEditorType)&&e.getEditorType()===EditorType.ICodeEditor}registerColor("peekViewEditorGutter.background",{dark:peekViewEditorBackground,light:peekViewEditorBackground,hc:peekViewEditorBackground},localize("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor.")),registerColor("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hc:null},localize("peekViewResultsMatchHighlight","Match highlight color in the peek view result list.")),registerColor("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hc:null},localize("peekViewEditorMatchHighlight","Match highlight color in the peek view editor.")),registerColor("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hc:activeContrastBorder},localize("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));var list="",Range$1;class CombinedSpliceable{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach((n=>n.splice(e,t,i)))}}class ListError extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function groupIntersect(e,t){const i=[];for(let n of t){if(e.start>=n.range.end)continue;if(e.end<n.range.start)break;const t=Range$1.intersect(e,n.range);Range$1.isEmpty(t)||i.push({range:t,size:n.size})}return i}function shift({start:e,end:t},i){return{start:e+i,end:t+i}}function consolidate(e){const t=[];let i=null;for(let n of e){const e=n.range.start,o=n.range.end,r=n.size;i&&r===i.size?i.range.end=o:(i={range:{start:e,end:o},size:r},t.push(i))}return t}function concat(...e){return consolidate(e.reduce(((e,t)=>e.concat(t)),[]))}!function(e){function t(e,t){if(e.start>=t.end||t.start>=e.end)return{start:0,end:0};const i=Math.max(e.start,t.start),n=Math.min(e.end,t.end);return n-i<=0?{start:0,end:0}:{start:i,end:n}}function i(e){return e.end-e.start<=0}e.intersect=t,e.isEmpty=i,e.intersects=function(e,n){return!i(t(e,n))},e.relativeComplement=function(e,t){const n=[],o={start:e.start,end:Math.min(t.start,e.end)},r={start:Math.max(t.end,e.start),end:e.end};return i(o)||n.push(o),i(r)||n.push(r),n}}(Range$1||(Range$1={}));class RangeMap{constructor(){this.groups=[],this._size=0}splice(e,t,i=[]){const n=i.length-t,o=groupIntersect({start:0,end:e},this.groups),r=groupIntersect({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map((e=>({range:shift(e.range,n),size:e.size}))),s=i.map(((t,i)=>({range:{start:e+i,end:e+i+1},size:t.size})));this.groups=concat(o,s,r),this._size=this.groups.reduce(((e,t)=>e+t.size*(t.range.end-t.range.start)),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;let t=0,i=0;for(let n of this.groups){const o=n.range.end-n.range.start,r=i+o*n.size;if(e<r)return t+Math.floor((e-i)/n.size);t+=o,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(let n of this.groups){const o=n.range.end-n.range.start,r=i+o;if(e<r)return t+(e-i)*n.size;t+=o*n.size,i=r}return-1}}function removeFromParent(e){try{e.parentElement&&e.parentElement.removeChild(e)}catch(e2){}}class RowCache{constructor(e){this.renderers=e,this.cache=new Map}alloc(e){let t=this.getTemplateCache(e).pop();if(!t){const i=$$c(".monaco-list-row");t={domNode:i,templateId:e,templateData:this.getRenderer(e).renderTemplate(i)}}return t}release(e){e&&this.releaseRow(e)}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(t.classList.remove("scrolling"),removeFromParent(t));this.getTemplateCache(i).push(e)}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach(((e,t)=>{for(const i of e){this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}})),this.cache.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var __decorate$1d=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};const DefaultOptions$1={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements:e=>[e],getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class ElementsDragAndDropData{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class ExternalElementsDragAndDropData{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class NativeDragAndDropData{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function equalsDragFeedback(e,t){return Array.isArray(e)&&Array.isArray(t)?equals$1(e,t):e===t}class ListViewAccessibilityProvider{constructor(e){(null==e?void 0:e.getSetSize)?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(e,t,i)=>i,(null==e?void 0:e.getPosInSet)?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(e,t)=>t+1,(null==e?void 0:e.getRole)?this.getRole=e.getRole.bind(e):this.getRole=e=>"listitem",(null==e?void 0:e.isChecked)?this.isChecked=e.isChecked.bind(e):this.isChecked=e=>{}}}class ListView{constructor(e,t,i,n=DefaultOptions$1){if(this.virtualDelegate=t,this.domId="list_id_"+ ++ListView.InstanceCount,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new Delayer(50),this.splicing=!1,this.dragOverAnimationStopDisposable=Disposable.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=Disposable.None,this.onDragLeaveTimeout=Disposable.None,this.disposables=new DisposableStore,this._onDidChangeContentHeight=new Emitter$1,this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=new RangeMap;for(const o of i)this.renderers.set(o.templateId,o);this.cache=this.disposables.add(new RowCache(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support","boolean"!=typeof n.mouseSupport||n.mouseSupport),this._horizontalScrolling=getOrDefault(n,(e=>e.horizontalScrolling),DefaultOptions$1.horizontalScrolling),this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.additionalScrollHeight=void 0===n.additionalScrollHeight?0:n.additionalScrollHeight,this.accessibilityProvider=new ListViewAccessibilityProvider(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows";getOrDefault(n,(e=>e.transformOptimization),DefaultOptions$1.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)"),this.disposables.add(Gesture.addTarget(this.rowsContainer)),this.scrollable=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:getOrDefault(n,(e=>e.smoothScrolling),!1)?125:0,scheduleAtNextAnimationFrame:e=>scheduleAtNextAnimationFrame(e)}),this.scrollableElement=this.disposables.add(new SmoothScrollableElement(this.rowsContainer,{alwaysConsumeMouseWheel:getOrDefault(n,(e=>e.alwaysConsumeMouseWheel),DefaultOptions$1.alwaysConsumeMouseWheel),horizontal:1,vertical:getOrDefault(n,(e=>e.verticalScrollMode),DefaultOptions$1.verticalScrollMode),useShadows:getOrDefault(n,(e=>e.useShadows),DefaultOptions$1.useShadows),mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(addDisposableListener(this.rowsContainer,EventType.Change,(e=>this.onTouchChange(e)))),this.disposables.add(addDisposableListener(this.scrollableElement.getDomNode(),"scroll",(e=>e.target.scrollTop=0))),this.disposables.add(addDisposableListener(this.domNode,"dragover",(e=>this.onDragOver(this.toDragEvent(e))))),this.disposables.add(addDisposableListener(this.domNode,"drop",(e=>this.onDrop(this.toDragEvent(e))))),this.disposables.add(addDisposableListener(this.domNode,"dragleave",(e=>this.onDragLeave(this.toDragEvent(e))))),this.disposables.add(addDisposableListener(this.domNode,"dragend",(e=>this.onDragEnd(e)))),this.setRowLineHeight=getOrDefault(n,(e=>e.setRowLineHeight),DefaultOptions$1.setRowLineHeight),this.setRowHeight=getOrDefault(n,(e=>e.setRowHeight),DefaultOptions$1.setRowHeight),this.supportDynamicHeights=getOrDefault(n,(e=>e.supportDynamicHeights),DefaultOptions$1.supportDynamicHeights),this.dnd=getOrDefault(n,(e=>e.dnd),DefaultOptions$1.dnd),this.layout()}get contentHeight(){return this.rangeMap.size}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const e of this.items)this.measureItemWidth(e);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:getContentWidth(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}updateOptions(e){void 0!==e.additionalScrollHeight&&(this.additionalScrollHeight=e.additionalScrollHeight,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),void 0!==e.smoothScrolling&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),void 0!==e.horizontalScrolling&&(this.horizontalScrolling=e.horizontalScrolling),void 0!==e.mouseWheelScrollSensitivity&&this.scrollableElement.updateOptions({mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),void 0!==e.fastScrollSensitivity&&this.scrollableElement.updateOptions({fastScrollSensitivity:e.fastScrollSensitivity})}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),o={start:e,end:e+t},r=Range$1.intersect(n,o),s=new Map;for(let b=r.end-1;b>=r.start;b--){const e=this.items[b];if(e.dragStartDisposable.dispose(),e.row){let t=s.get(e.templateId);t||(t=[],s.set(e.templateId,t));const i=this.renderers.get(e.templateId);i&&i.disposeElement&&i.disposeElement(e.element,b,e.row.templateData,e.size),t.push(e.row)}e.row=null}const a={start:e+t,end:this.items.length},l=Range$1.intersect(a,n),d=Range$1.relativeComplement(a,n),c=i.map((e=>({id:String(this.itemId++),element:e,templateId:this.virtualDelegate.getTemplateId(e),size:this.virtualDelegate.getHeight(e),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(e),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:Disposable.None,checkedDisposable:Disposable.None})));let h;0===e&&t>=this.items.length?(this.rangeMap=new RangeMap,this.rangeMap.splice(0,0,c),h=this.items,this.items=c):(this.rangeMap.splice(e,t,c),h=this.items.splice(e,t,...c));const u=i.length-t,g=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),p=shift(l,u),m=Range$1.intersect(g,p);for(let b=m.start;b<m.end;b++)this.updateItemInDOM(this.items[b],b);const f=Range$1.relativeComplement(p,g);for(const b of f)for(let e=b.start;e<b.end;e++)this.removeItemFromDOM(e);const _=d.map((e=>shift(e,u))),C=[{start:e,end:e+i.length},..._].map((e=>Range$1.intersect(g,e))),v=this.getNextToLastElement(C);for(const b of C)for(let e=b.start;e<b.end;e++){const t=this.items[e],i=s.get(t.templateId),n=null==i?void 0:i.pop();this.insertItemInDOM(e,v,n)}for(const b of s.values())for(const e of b)this.cache.release(e);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),h.map((e=>e.element))}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=scheduleAtNextAnimationFrame((()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null})))}eventuallyUpdateScrollWidth(){this.horizontalScrolling?this.scrollableElementWidthDelayer.trigger((()=>this.updateScrollWidth())):this.scrollableElementWidthDelayer.cancel()}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)void 0!==t.width&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:0===e?0:e+10})}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}element(e){return this.items[e].element}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){let i={height:"number"==typeof e?e:getContentHeight(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),void 0!==t&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:"number"==typeof t?t:getContentWidth(this.domNode)})}render(e,t,i,n,o,r=!1){const s=this.getRenderRange(t,i),a=Range$1.relativeComplement(s,e),l=Range$1.relativeComplement(e,s),d=this.getNextToLastElement(a);if(r){const t=Range$1.intersect(e,s);for(let e=t.start;e<t.end;e++)this.updateItemInDOM(this.items[e],e)}for(const c of a)for(let e=c.start;e<c.end;e++)this.insertItemInDOM(e,d);for(const c of l)for(let e=c.start;e<c.end;e++)this.removeItemFromDOM(e);void 0!==n&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&void 0!==o&&(this.rowsContainer.style.width=`${Math.max(o,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t,i){const n=this.items[e];n.row||(n.row=null!=i?i:this.cache.alloc(n.templateId));const o=this.accessibilityProvider.getRole(n.element)||"listitem";n.row.domNode.setAttribute("role",o);const r=this.accessibilityProvider.isChecked(n.element);if("boolean"==typeof r)n.row.domNode.setAttribute("aria-checked",String(!!r));else if(r){const e=e=>n.row.domNode.setAttribute("aria-checked",String(!!e));e(r.value),n.checkedDisposable=r.onDidChange(e)}n.row.domNode.parentElement||(t?this.rowsContainer.insertBefore(n.row.domNode,t):this.rowsContainer.appendChild(n.row.domNode)),this.updateItemInDOM(n,e);const s=this.renderers.get(n.templateId);if(!s)throw new Error(`No renderer found for template id ${n.templateId}`);s&&s.renderElement(n.element,e,n.row.templateData,n.size);const a=this.dnd.getDragURI(n.element);n.dragStartDisposable.dispose(),n.row.domNode.draggable=!!a,a&&(n.dragStartDisposable=addDisposableListener(n.row.domNode,"dragstart",(e=>this.onDragStart(n.element,a,e)))),this.horizontalScrolling&&(this.measureItemWidth(n),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width=isFirefox?"-moz-fit-content":"fit-content",e.width=getContentWidth(e.row.domNode);const t=window.getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2==0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.additionalScrollHeight}get onMouseClick(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"click")).event,(e=>this.toMouseEvent(e)))}get onMouseDblClick(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"dblclick")).event,(e=>this.toMouseEvent(e)))}get onMouseMiddleClick(){return Event$1.filter(Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"auxclick")).event,(e=>this.toMouseEvent(e))),(e=>1===e.browserEvent.button))}get onMouseDown(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"mousedown")).event,(e=>this.toMouseEvent(e)))}get onContextMenu(){return Event$1.any(Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"contextmenu")).event,(e=>this.toMouseEvent(e))),Event$1.map(this.disposables.add(new DomEmitter(this.domNode,EventType.Contextmenu)).event,(e=>this.toGestureEvent(e))))}get onTouchStart(){return Event$1.map(this.disposables.add(new DomEmitter(this.domNode,"touchstart")).event,(e=>this.toTouchEvent(e)))}get onTap(){return Event$1.map(this.disposables.add(new DomEmitter(this.rowsContainer,EventType.Tap)).event,(e=>this.toGestureEvent(e)))}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:i&&i.element}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:i&&i.element}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:i&&i.element}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=void 0===t?void 0:this.items[t];return{browserEvent:e,index:t,element:i&&i.element}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(DataTransfers.TEXT,t),i.dataTransfer.setDragImage){let e;this.dnd.getDragLabel&&(e=this.dnd.getDragLabel(n,i)),void 0===e&&(e=String(n.length));const t=$$c(".monaco-drag-image");t.textContent=e,document.body.appendChild(t),i.dataTransfer.setDragImage(t,-10,-10),setTimeout((()=>document.body.removeChild(t)),0)}this.currentDragData=new ElementsDragAndDropData(n),StaticDND.CurrentDragAndDropData=new ExternalElementsDragAndDropData(n),this.dnd.onDragStart&&this.dnd.onDragStart(this.currentDragData,i)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),StaticDND.CurrentDragAndDropData&&"vscode-ui"===StaticDND.CurrentDragAndDropData.getData())return!1;if(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer)return!1;if(!this.currentDragData)if(StaticDND.CurrentDragAndDropData)this.currentDragData=StaticDND.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new NativeDragAndDropData}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.browserEvent);if(this.canDrop="boolean"==typeof t?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;let i;if(e.browserEvent.dataTransfer.dropEffect="boolean"!=typeof t&&0===t.effect?"copy":"move",i="boolean"!=typeof t&&t.feedback?t.feedback:void 0===e.index?[-1]:[e.index],i=distinct(i).filter((e=>e>=-1&&e<this.length)).sort(((e,t)=>e-t)),i=-1===i[0]?[-1]:i,equalsDragFeedback(this.currentDragFeedback,i))return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackDisposable.dispose(),-1===i[0])this.domNode.classList.add("drop-target"),this.rowsContainer.classList.add("drop-target"),this.currentDragFeedbackDisposable=toDisposable((()=>{this.domNode.classList.remove("drop-target"),this.rowsContainer.classList.remove("drop-target")}));else{for(const e of i){const t=this.items[e];t.dropTarget=!0,t.row&&t.row.domNode.classList.add("drop-target")}this.currentDragFeedbackDisposable=toDisposable((()=>{for(const e of i){const t=this.items[e];t.dropTarget=!1,t.row&&t.row.domNode.classList.remove("drop-target")}}))}return!0}onDragLeave(e){var t,i;this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=disposableTimeout((()=>this.clearDragOverFeedback()),100),this.currentDragData&&(null===(i=(t=this.dnd).onDragLeave)||void 0===i||i.call(t,this.currentDragData,e.element,e.index,e.browserEvent))}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,t&&e.browserEvent.dataTransfer&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.currentDragData=void 0,StaticDND.CurrentDragAndDropData=void 0,this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=Disposable.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const e=getTopLeftOffset(this.domNode).top;this.dragOverAnimationDisposable=animate(this.animateDragAndDropScrollTop.bind(this,e))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=disposableTimeout((()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}),1e3),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(void 0===this.dragOverMouseY)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;i instanceof HTMLElement&&i!==this.rowsContainer&&t.contains(i);){const e=i.getAttribute("data-index");if(e){const t=Number(e);if(!isNaN(t))return t}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const n=this.getRenderRange(e,t);let o,r;e===this.elementTop(n.start)?(o=n.start,r=0):n.end-n.start>1&&(o=n.start+1,r=this.elementTop(o)-e);let s=0;for(;;){const a=this.getRenderRange(e,t);let l=!1;for(let e=a.start;e<a.end;e++){const t=this.probeDynamicHeight(e);0!==t&&this.rangeMap.splice(e,1,[this.items[e]]),s+=t,l=l||0!==t}if(!l){0!==s&&this.eventuallyUpdateScrollDimensions();const t=Range$1.relativeComplement(n,a);for(const e of t)for(let t=e.start;t<e.end;t++)this.items[t].row&&this.removeItemFromDOM(t);const l=Range$1.relativeComplement(a,n);for(const e of l)for(let t=e.start;t<e.end;t++){const e=t+1,i=e<this.items.length?this.items[e].row:null,n=i?i.domNode:null;this.insertItemInDOM(t,n)}for(let e=a.start;e<a.end;e++)this.items[e].row&&this.updateItemInDOM(this.items[e],e);if("number"==typeof o){const t=this.scrollable.getFutureScrollPosition().scrollTop-e,n=this.elementTop(o)-r+t;this.setScrollTop(n,i)}return void this._onDidChangeContentHeight.fire(this.contentHeight)}}}probeDynamicHeight(e){const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const e=this.virtualDelegate.getDynamicHeight(t.element);if(null!==e){const i=t.size;return t.size=e,t.lastDynamicHeightWidth=this.renderWidth,e-i}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth)return 0;if(this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(!this.setRowHeight&&t.row){let e=t.row.domNode.offsetHeight;return t.size=e,t.lastDynamicHeightWidth=this.renderWidth,e-i}const n=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const o=this.renderers.get(t.templateId);return o&&(o.renderElement(t.element,e,n.templateData,void 0),o.disposeElement&&o.disposeElement(t.element,e,n.templateData,void 0)),t.size=n.domNode.offsetHeight,this.virtualDelegate.setDynamicHeight&&this.virtualDelegate.setDynamicHeight(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,this.rowsContainer.removeChild(n.domNode),this.cache.release(n),t.size-i}getNextToLastElement(e){const t=e[e.length-1];if(!t)return null;const i=this.items[t.end];return i&&i.row?i.row.domNode:null}getElementDomId(e){return`${this.domId}_${e}`}dispose(){if(this.items){for(const e of this.items)if(e.row){const t=this.renderers.get(e.row.templateId);t&&(t.disposeElement&&t.disposeElement(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[]}this.domNode&&this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),dispose(this.disposables)}}ListView.InstanceCount=0,__decorate$1d([memoize],ListView.prototype,"onMouseClick",null),__decorate$1d([memoize],ListView.prototype,"onMouseDblClick",null),__decorate$1d([memoize],ListView.prototype,"onMouseMiddleClick",null),__decorate$1d([memoize],ListView.prototype,"onMouseDown",null),__decorate$1d([memoize],ListView.prototype,"onContextMenu",null),__decorate$1d([memoize],ListView.prototype,"onTouchStart",null),__decorate$1d([memoize],ListView.prototype,"onTap",null);var __decorate$1c=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__awaiter$P=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},TypeLabelControllerState,TypeLabelControllerState2;class TraitRenderer{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex((e=>e.templateData===i));if(n>=0){const e=this.renderedElements[n];this.trait.unrender(i),e.index=t}else{const e={index:t,templateData:i};this.renderedElements.push(e)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const o of this.renderedElements)o.index<e?n.push(o):o.index>=e+t&&n.push({index:o.index+i-t,templateData:o.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex((t=>t.templateData===e));t<0||this.renderedElements.splice(t,1)}}class Trait$1{constructor(e){this._trait=e,this.length=0,this.indexes=[],this.sortedIndexes=[],this._onChange=new Emitter$1,this.onChange=this._onChange.event}get name(){return this._trait}get renderer(){return new TraitRenderer(this)}splice(e,t,i){var n;t=Math.max(0,Math.min(t,this.length-e));const o=i.length-t,r=e+t,s=[...this.sortedIndexes.filter((t=>t<e)),...i.map(((t,i)=>t?i+e:-1)).filter((e=>-1!==e)),...this.sortedIndexes.filter((e=>e>=r)).map((e=>e+o))],a=this.length+o;if(this.sortedIndexes.length>0&&0===s.length&&a>0){const t=null!==(n=this.sortedIndexes.find((t=>t>=e)))&&void 0!==n?n:a-1;s.push(Math.min(t,a-1))}this.renderer.splice(e,t,i.length),this._set(s,s),this.length=a}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(numericSort),t)}_set(e,t,i){const n=this.indexes,o=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const r=disjunction(o,e);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return binarySearch(this.sortedIndexes,e,numericSort)>=0}dispose(){dispose(this._onChange)}}__decorate$1c([memoize],Trait$1.prototype,"renderer",null);class SelectionTrait extends Trait$1{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class TraitSpliceable{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,i.map((()=>!1)));const n=this.trait.get().map((e=>this.identityProvider.getId(this.view.element(e)).toString())),o=i.map((e=>n.indexOf(this.identityProvider.getId(e).toString())>-1));this.trait.splice(e,t,o)}}function isInputElement(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName}function isMonacoEditor(e){return!!e.classList.contains("monaco-editor")||!e.classList.contains("monaco-list")&&(!!e.parentElement&&isMonacoEditor(e.parentElement))}class KeyboardController{constructor(e,t,i){this.list=e,this.view=t,this.disposables=new DisposableStore,this.multipleSelectionDisposables=new DisposableStore,this.onKeyDown.filter((e=>3===e.keyCode)).on(this.onEnter,this,this.disposables),this.onKeyDown.filter((e=>16===e.keyCode)).on(this.onUpArrow,this,this.disposables),this.onKeyDown.filter((e=>18===e.keyCode)).on(this.onDownArrow,this,this.disposables),this.onKeyDown.filter((e=>11===e.keyCode)).on(this.onPageUpArrow,this,this.disposables),this.onKeyDown.filter((e=>12===e.keyCode)).on(this.onPageDownArrow,this,this.disposables),this.onKeyDown.filter((e=>9===e.keyCode)).on(this.onEscape,this,this.disposables),!1!==i.multipleSelectionSupport&&this.onKeyDown.filter((e=>(isMacintosh?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables)}get onKeyDown(){return Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).map((e=>new StandardKeyboardEvent(e)))}updateOptions(e){void 0!==e.multipleSelectionSupport&&(this.multipleSelectionDisposables.clear(),e.multipleSelectionSupport&&this.onKeyDown.filter((e=>(isMacintosh?e.metaKey:e.ctrlKey)&&31===e.keyCode)).on(this.onCtrlA,this,this.multipleSelectionDisposables))}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(range(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}__decorate$1c([memoize],KeyboardController.prototype,"onKeyDown",null),TypeLabelControllerState2=TypeLabelControllerState||(TypeLabelControllerState={}),TypeLabelControllerState2[TypeLabelControllerState2.Idle=0]="Idle",TypeLabelControllerState2[TypeLabelControllerState2.Typing=1]="Typing";const DefaultKeyboardNavigationDelegate=new class{mightProducePrintableCharacter(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30||e.keyCode>=93&&e.keyCode<=102||e.keyCode>=80&&e.keyCode<=90)}};class TypeLabelController{constructor(e,t,i,n){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.delegate=n,this.enabled=!1,this.state=TypeLabelControllerState.Idle,this.automaticKeyboardNavigation=!0,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this.updateOptions(e.options)}updateOptions(e){void 0===e.enableKeyboardNavigation||!!e.enableKeyboardNavigation?this.enable():this.disable(),void 0!==e.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation)}enable(){if(this.enabled)return;const e=Event$1.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).filter((()=>this.automaticKeyboardNavigation||this.triggered)).map((e=>new StandardKeyboardEvent(e))).filter((e=>this.delegate.mightProducePrintableCharacter(e))).forEach((e=>e.preventDefault())).map((e=>e.browserEvent.key)).event,t=Event$1.debounce(e,(()=>null),800);Event$1.reduce(Event$1.any(e,t),((e,t)=>null===t?null:(e||"")+t))(this.onInput,this,this.enabledDisposables),t(this.onClear,this,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){var e;const t=this.list.getFocus();if(t.length>0&&t[0]===this.previouslyFocused){const i=null===(e=this.list.options.accessibilityProvider)||void 0===e?void 0:e.getAriaLabel(this.list.element(t[0]));i&&alert(i)}this.previouslyFocused=-1}onInput(e){if(!e)return this.state=TypeLabelControllerState.Idle,void(this.triggered=!1);const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===TypeLabelControllerState.Idle?1:0;this.state=TypeLabelControllerState.Typing;for(let o=0;o<this.list.length;o++){const t=(i+o+n)%this.list.length,r=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(t)),s=r&&r.toString();if(void 0===s||matchesPrefix(e,s))return this.previouslyFocused=i,this.list.setFocus([t]),void this.list.reveal(t)}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class DOMFocusController{constructor(e,t){this.list=e,this.view=t,this.disposables=new DisposableStore;Event$1.chain(this.disposables.add(new DomEmitter(t.domNode,"keydown")).event).filter((e=>!isInputElement(e.target))).map((e=>new StandardKeyboardEvent(e))).filter((e=>!(2!==e.keyCode||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey))).on(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(0===t.length)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!(n&&n instanceof HTMLElement&&-1!==n.tabIndex))return;const o=window.getComputedStyle(n);"hidden"!==o.visibility&&"none"!==o.display&&(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function isSelectionSingleChangeEvent(e){return isMacintosh?e.browserEvent.metaKey:e.browserEvent.ctrlKey}function isSelectionRangeChangeEvent(e){return e.browserEvent.shiftKey}function isMouseRightClick(e){return e instanceof MouseEvent&&2===e.button}const DefaultMultipleSelectionController={isSelectionSingleChangeEvent:isSelectionSingleChangeEvent,isSelectionRangeChangeEvent:isSelectionRangeChangeEvent};class MouseController{constructor(e){this.list=e,this.disposables=new DisposableStore,this._onPointer=new Emitter$1,this.onPointer=this._onPointer.event,!1!==e.options.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController),this.mouseSupport=void 0===e.options.mouseSupport||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Gesture.addTarget(e.getHTMLElement()))),Event$1.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){void 0!==e.multipleSelectionSupport&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||DefaultMultipleSelectionController))}isSelectionSingleChangeEvent(e){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionSingleChangeEvent(e)}isSelectionRangeChangeEvent(e){return!!this.multipleSelectionController&&this.multipleSelectionController.isSelectionRangeChangeEvent(e)}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){isMonacoEditor(e.browserEvent.target)||document.activeElement!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(isMonacoEditor(e.browserEvent.target))return;const t=void 0===e.index?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport)return;if(isInputElement(e.browserEvent.target)||isMonacoEditor(e.browserEvent.target))return;const t=e.index;return void 0===t?(this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),void this.list.setAnchor(void 0)):this.isSelectionRangeChangeEvent(e)||this.isSelectionChangeEvent(e)?this.changeSelection(e):(this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),isMouseRightClick(e.browserEvent)||this.list.setSelection([t],e.browserEvent),void this._onPointer.fire(e))}onDoubleClick(e){if(isInputElement(e.browserEvent.target)||isMonacoEditor(e.browserEvent.target))return;if(this.isSelectionChangeEvent(e))return;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){if(void 0===i){const e=this.list.getFocus()[0];i=null!=e?e:t,this.list.setAnchor(i)}const n=range(Math.min(i,t),Math.max(i,t)+1),o=this.list.getSelection(),r=getContiguousRangeContaining(disjunction(o,[i]),i);if(0===r.length)return;const s=disjunction(n,relativeComplement(o,r));this.list.setSelection(s,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const i=this.list.getSelection(),n=i.filter((e=>e!==t));this.list.setFocus([t]),this.list.setAnchor(t),i.length===n.length?this.list.setSelection([...n,t],e.browserEvent):this.list.setSelection(n,e.browserEvent)}}dispose(){this.disposables.dispose()}}class DefaultStyleController{constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&e.listBackground.isOpaque()&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }\n\t\t\t`),e.listFocusAndSelectionForeground&&i.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }\n\t\t\t`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listFocusOutline&&i.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropBackground&&i.push(`\n\t\t\t\t.monaco-list${t}.drop-target,\n\t\t\t\t.monaco-list${t} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropBackground} !important; color: inherit !important; }\n\t\t\t`),e.listFilterWidgetBackground&&i.push(`.monaco-list-type-filter { background-color: ${e.listFilterWidgetBackground} }`),e.listFilterWidgetOutline&&i.push(`.monaco-list-type-filter { border: 1px solid ${e.listFilterWidgetOutline}; }`),e.listFilterWidgetNoMatchesOutline&&i.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${e.listFilterWidgetNoMatchesOutline}; }`),e.listMatchesShadow&&i.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${e.listMatchesShadow}; }`),e.tableColumnsBorder&&i.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${e.tableColumnsBorder};\n\t\t\t}`),e.tableOddRowsBackgroundColor&&i.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${e.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`),this.styleElement.textContent=i.join("\n")}}const defaultStyles$1={listFocusBackground:Color.fromHex("#7FB0D0"),listActiveSelectionBackground:Color.fromHex("#0E639C"),listActiveSelectionForeground:Color.fromHex("#FFFFFF"),listActiveSelectionIconForeground:Color.fromHex("#FFFFFF"),listFocusAndSelectionBackground:Color.fromHex("#094771"),listFocusAndSelectionForeground:Color.fromHex("#FFFFFF"),listInactiveSelectionBackground:Color.fromHex("#3F3F46"),listInactiveSelectionIconForeground:Color.fromHex("#FFFFFF"),listHoverBackground:Color.fromHex("#2A2D2E"),listDropBackground:Color.fromHex("#383B3D"),treeIndentGuidesStroke:Color.fromHex("#a9a9a9"),tableColumnsBorder:Color.fromHex("#cccccc").transparent(.2),tableOddRowsBackgroundColor:Color.fromHex("#cccccc").transparent(.04)},DefaultOptions={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI:()=>null,onDragStart(){},onDragOver:()=>!1,drop(){}}};function getContiguousRangeContaining(e,t){const i=e.indexOf(t);if(-1===i)return[];const n=[];let o=i-1;for(;o>=0&&e[o]===t-(i-o);)n.push(e[o--]);for(n.reverse(),o=i;o<e.length&&e[o]===t+(o-i);)n.push(e[o++]);return n}function disjunction(e,t){const i=[];let n=0,o=0;for(;n<e.length||o<t.length;)if(n>=e.length)i.push(t[o++]);else if(o>=t.length)i.push(e[n++]);else{if(e[n]===t[o]){i.push(e[n]),n++,o++;continue}e[n]<t[o]?i.push(e[n++]):i.push(t[o++])}return i}function relativeComplement(e,t){const i=[];let n=0,o=0;for(;n<e.length||o<t.length;)if(n>=e.length)i.push(t[o++]);else if(o>=t.length)i.push(e[n++]);else{if(e[n]===t[o]){n++,o++;continue}e[n]<t[o]?i.push(e[n++]):o++}return i}const numericSort=(e,t)=>e-t;class PipelineRenderer{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map((t=>t.renderTemplate(e)))}renderElement(e,t,i,n){let o=0;for(const r of this.renderers)r.renderElement(e,t,i[o++],n)}disposeElement(e,t,i,n){let o=0;for(const r of this.renderers)r.disposeElement&&r.disposeElement(e,t,i[o],n),o+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class AccessibiltyRenderer{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return e}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e);n?i.setAttribute("aria-label",n):i.removeAttribute("aria-label");const o=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);"number"==typeof o?i.setAttribute("aria-level",`${o}`):i.removeAttribute("aria-level")}disposeTemplate(e){}}class ListViewDragAndDrop{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(e,t)}onDragOver(e,t,i,n){return this.dnd.onDragOver(e,t,i,n)}onDragLeave(e,t,i,n){var o,r;null===(r=(o=this.dnd).onDragLeave)||void 0===r||r.call(o,e,t,i,n)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}drop(e,t,i,n){this.dnd.drop(e,t,i,n)}}class List{constructor(e,t,i,n,o=DefaultOptions){var r;this.user=e,this._options=o,this.focus=new Trait$1("focused"),this.anchor=new Trait$1("anchor"),this.eventBufferer=new EventBufferer,this._ariaLabel="",this.disposables=new DisposableStore,this._onDidDispose=new Emitter$1,this.onDidDispose=this._onDidDispose.event;const s=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?null===(r=this._options.accessibilityProvider)||void 0===r?void 0:r.getWidgetRole():"list";this.selection=new SelectionTrait("listbox"!==s),mixin(o,defaultStyles$1,!1);const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=o.accessibilityProvider,this.accessibilityProvider&&(a.push(new AccessibiltyRenderer(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant&&this.accessibilityProvider.onDidChangeActiveDescendant(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map((e=>new PipelineRenderer(e.templateId,[...a,e])));const l=Object.assign(Object.assign({},o),{dnd:o.dnd&&new ListViewDragAndDrop(this,o.dnd)});if(this.view=new ListView(t,i,n,l),this.view.domNode.setAttribute("role",s),o.styleController)this.styleController=o.styleController(this.view.domId);else{const e=createStyleSheet(this.view.domNode);this.styleController=new DefaultStyleController(e,this.view.domId)}if(this.spliceable=new CombinedSpliceable([new TraitSpliceable(this.focus,this.view,o.identityProvider),new TraitSpliceable(this.selection,this.view,o.identityProvider),new TraitSpliceable(this.anchor,this.view,o.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new DOMFocusController(this,this.view)),("boolean"!=typeof o.keyboardSupport||o.keyboardSupport)&&(this.keyboardController=new KeyboardController(this,this.view,o),this.disposables.add(this.keyboardController)),o.keyboardNavigationLabelProvider){const e=o.keyboardNavigationDelegate||DefaultKeyboardNavigationDelegate;this.typeLabelController=new TypeLabelController(this,this.view,o.keyboardNavigationLabelProvider,e),this.disposables.add(this.typeLabelController)}this.mouseController=this.createMouseController(o),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),!1!==this._options.multipleSelectionSupport&&this.view.domNode.setAttribute("aria-multiselectable","true")}get onDidChangeFocus(){return Event$1.map(this.eventBufferer.wrapEvent(this.focus.onChange),(e=>this.toListEvent(e)))}get onDidChangeSelection(){return Event$1.map(this.eventBufferer.wrapEvent(this.selection.onChange),(e=>this.toListEvent(e)))}get domId(){return this.view.domId}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event).map((e=>new StandardKeyboardEvent(e))).filter((t=>e=58===t.keyCode||t.shiftKey&&68===t.keyCode)).map(stopEvent).filter((()=>!1)).event,i=Event$1.chain(this.disposables.add(new DomEmitter(this.view.domNode,"keyup")).event).forEach((()=>e=!1)).map((e=>new StandardKeyboardEvent(e))).filter((e=>58===e.keyCode||e.shiftKey&&68===e.keyCode)).map(stopEvent).map((({browserEvent:e})=>{const t=this.getFocus(),i=t.length?t[0]:void 0;return{index:i,element:void 0!==i?this.view.element(i):void 0,anchor:void 0!==i?this.view.domElement(i):this.view.domNode,browserEvent:e}})).event,n=Event$1.chain(this.view.onContextMenu).filter((t=>!e)).map((({element:e,index:t,browserEvent:i})=>({element:e,index:t,anchor:{x:i.pageX+1,y:i.pageY},browserEvent:i}))).event;return Event$1.any(t,i,n)}get onKeyDown(){return this.disposables.add(new DomEmitter(this.view.domNode,"keydown")).event}get onDidFocus(){return Event$1.signal(this.disposables.add(new DomEmitter(this.view.domNode,"focus",!0)).event)}createMouseController(e){return new MouseController(this)}updateOptions(e={}){var t;this._options=Object.assign(Object.assign({},this._options),e),this.typeLabelController&&this.typeLabelController.updateOptions(this._options),void 0!==this._options.multipleSelectionController&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),null===(t=this.keyboardController)||void 0===t||t.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new ListError(this.user,`Invalid start index: ${e}`);if(t<0)throw new ListError(this.user,`Invalid delete count: ${t}`);0===t&&0===i.length||this.eventBufferer.bufferEvents((()=>this.spliceable.splice(e,t,i)))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new ListError(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map((e=>this.view.element(e)))}setAnchor(e){if(void 0!==e){if(e<0||e>=this.length)throw new ListError(this.user,`Invalid index ${e}`);this.anchor.set([e])}else this.anchor.set([])}getAnchor(){return firstOrDefault(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return void 0===e?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new ListError(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(0===this.length)return;const o=this.focus.get(),r=this.findNextIndex(o.length>0?o[0]+e:0,t,n);r>-1&&this.setFocus([r],i)}focusPrevious(e=1,t=!1,i,n){if(0===this.length)return;const o=this.focus.get(),r=this.findPreviousIndex(o.length>0?o[0]-e:0,t,n);r>-1&&this.setFocus([r],i)}focusNextPage(e,t){return __awaiter$P(this,void 0,void 0,(function*(){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=0===i?0:i-1;const n=this.view.element(i),o=this.getFocusedElements()[0];if(o!==n){const n=this.findPreviousIndex(i,!1,t);n>-1&&o!==this.view.element(n)?this.setFocus([n],e):this.setFocus([i],e)}else{const n=this.view.getScrollTop();this.view.setScrollTop(n+this.view.renderHeight-this.view.elementHeight(i)),this.view.getScrollTop()!==n&&(this.setFocus([]),yield timeout(0),yield this.focusNextPage(e,t))}}))}focusPreviousPage(e,t){return __awaiter$P(this,void 0,void 0,(function*(){let i;const n=this.view.getScrollTop();i=0===n?this.view.indexAt(n):this.view.indexAfter(n-1);const o=this.view.element(i),r=this.getFocusedElements()[0];if(r!==o){const n=this.findNextIndex(i,!1,t);n>-1&&r!==this.view.element(n)?this.setFocus([n],e):this.setFocus([i],e)}else{const i=n;this.view.setScrollTop(n-this.view.renderHeight),this.view.getScrollTop()!==i&&(this.setFocus([]),yield timeout(0),yield this.focusPreviousPage(e,t))}}))}focusLast(e,t){if(0===this.length)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(0===this.length)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e%=this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map((e=>this.view.element(e)))}reveal(e,t){if(e<0||e>=this.length)throw new ListError(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),o=this.view.elementHeight(e);if(isNumber$1(t)){const e=o-this.view.renderHeight;this.view.setScrollTop(e*clamp(t,0,1)+n)}else{const e=n+o,t=i+this.view.renderHeight;n<i&&e>=t||(n<i||e>=t&&o>=this.view.renderHeight?this.view.setScrollTop(n):e>=t&&this.view.setScrollTop(e-this.view.renderHeight))}}getRelativeTop(e){if(e<0||e>=this.length)throw new ListError(this.user,`Invalid index ${e}`);const t=this.view.getScrollTop(),i=this.view.elementTop(e),n=this.view.elementHeight(e);if(i<t||i+n>t+this.view.renderHeight)return null;const o=n-this.view.renderHeight;return Math.abs((t-i)/o)}getHTMLElement(){return this.view.domNode}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map((e=>this.view.element(e))),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){var e;const t=this.focus.get();if(t.length>0){let i;(null===(e=this.accessibilityProvider)||void 0===e?void 0:e.getActiveDescendantId)&&(i=this.accessibilityProvider.getActiveDescendantId(this.view.element(t[0]))),this.view.domNode.setAttribute("aria-activedescendant",i||this.view.getElementDomId(t[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",0===e.length),this.view.domNode.classList.toggle("selection-single",1===e.length),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}__decorate$1c([memoize],List.prototype,"onDidChangeFocus",null),__decorate$1c([memoize],List.prototype,"onDidChangeSelection",null),__decorate$1c([memoize],List.prototype,"onContextMenu",null),__decorate$1c([memoize],List.prototype,"onKeyDown",null),__decorate$1c([memoize],List.prototype,"onDidFocus",null);class PagedRenderer{constructor(e,t){this.renderer=e,this.modelProvider=t}get templateId(){return this.renderer.templateId}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:Disposable.None}}renderElement(e,t,i,n){if(i.disposable&&i.disposable.dispose(),!i.data)return;const o=this.modelProvider();if(o.isResolved(e))return this.renderer.renderElement(o.get(e),e,i.data,n);const r=new CancellationTokenSource$1,s=o.resolve(e,r.token);i.disposable={dispose:()=>r.cancel()},this.renderer.renderPlaceholder(e,i.data),s.then((t=>this.renderer.renderElement(t,e,i.data,n)))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class PagedAccessibilityProvider{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function fromPagedListOptions(e,t){return Object.assign(Object.assign({},t),{accessibilityProvider:t.accessibilityProvider&&new PagedAccessibilityProvider(e,t.accessibilityProvider)})}class PagedList{constructor(e,t,i,n,o={}){const r=()=>this.model,s=n.map((e=>new PagedRenderer(e,r)));this.list=new List(e,t,i,s,fromPagedListOptions(r,o))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return Event$1.map(this.list.onMouseDblClick,(({element:e,index:t,browserEvent:i})=>({element:void 0===e?void 0:this._model.get(e),index:t,browserEvent:i})))}get onPointer(){return Event$1.map(this.list.onPointer,(({element:e,index:t,browserEvent:i})=>({element:void 0===e?void 0:this._model.get(e),index:t,browserEvent:i})))}get onDidChangeSelection(){return Event$1.map(this.list.onDidChangeSelection,(({elements:e,indexes:t,browserEvent:i})=>({elements:e.map((e=>this._model.get(e))),indexes:t,browserEvent:i})))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,range(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map((e=>this.model.get(e)))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var splitview="";const defaultStyles={separatorBorder:Color.transparent};class ViewItem{constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,"number"==typeof i?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}set size(e){this._size=e}get size(){return this._size}get visible(){return void 0===this._cachedVisibleSize}setVisible(e,t){e!==this.visible&&(e?(this.size=clamp(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize="number"==typeof t?t:this.size,this.size=0),this.container.classList.toggle("visible",e),this.view.setVisible&&this.view.setVisible(e))}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}layout(e,t){this.layoutContainer(e),this.view.layout(this.size,e,t)}dispose(){return this.disposable.dispose(),this.view}}class VerticalViewItem extends ViewItem{layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class HorizontalViewItem extends ViewItem{layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var State,State2,Sizing,Sizing2;State2=State||(State={}),State2[State2.Idle=0]="Idle",State2[State2.Busy=1]="Busy",Sizing2=Sizing||(Sizing={}),Sizing2.Distribute={type:"distribute"},Sizing2.Split=function(e){return{type:"split",index:e}},Sizing2.Invisible=function(e){return{type:"invisible",cachedVisibleSize:e}};class SplitView extends Disposable{constructor(e,t={}){var i,n,o,r,s;super(),this.size=0,this.contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=State.Idle,this._onDidSashChange=this._register(new Emitter$1),this._onDidSashReset=this._register(new Emitter$1),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=null!==(i=t.orientation)&&void 0!==i?i:0,this.inverseAltBehavior=null!==(n=t.inverseAltBehavior)&&void 0!==n&&n,this.proportionalLayout=null===(o=t.proportionalLayout)||void 0===o||o,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(0===this.orientation?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=append$1(this.el,$$c(".sash-container")),this.viewContainer=$$c(".split-view-container"),this.scrollable=new Scrollable({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:scheduleAtNextAnimationFrame}),this.scrollableElement=this._register(new SmoothScrollableElement(this.viewContainer,{vertical:0===this.orientation?null!==(r=t.scrollbarVisibility)&&void 0!==r?r:1:2,horizontal:1===this.orientation?null!==(s=t.scrollbarVisibility)&&void 0!==s?s:1:2},this.scrollable)),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll((e=>{this.viewContainer.scrollTop=e.scrollTop,this.viewContainer.scrollLeft=e.scrollLeft}))),append$1(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||defaultStyles),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach(((e,t)=>{const i=isUndefined(e.visible)||e.visible?e.size:{type:"invisible",cachedVisibleSize:e.size},n=e.view;this.doAddView(n,i,t,!0)})),this.contentSize=this.viewItems.reduce(((e,t)=>e+t.size),0),this.saveProportions())}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this.contentSize);if(this.size=e,this.layoutContext=t,this.proportions)for(let n=0;n<this.viewItems.length;n++){const t=this.viewItems[n];t.size=clamp(Math.round(this.proportions[n]*e),t.minimumSize,t.maximumSize)}else{const t=range(this.viewItems.length),n=t.filter((e=>1===this.viewItems[e].priority)),o=t.filter((e=>2===this.viewItems[e].priority));this.resize(this.viewItems.length-1,e-i,void 0,n,o)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this.contentSize>0&&(this.proportions=this.viewItems.map((e=>e.size/this.contentSize)))}onSashStart({sash:e,start:t,alt:i}){for(const s of this.viewItems)s.enabled=!1;const n=this.sashItems.findIndex((t=>t.sash===e)),o=combinedDisposable(addDisposableListener(document.body,"keydown",(e=>r(this.sashDragState.current,e.altKey))),addDisposableListener(document.body,"keyup",(()=>r(this.sashDragState.current,!1)))),r=(e,t)=>{const i=this.viewItems.map((e=>e.size));let r,s,a=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(t=!t),t){if(n===this.sashItems.length-1){const e=this.viewItems[n];a=(e.minimumSize-e.size)/2,l=(e.maximumSize-e.size)/2}else{const e=this.viewItems[n+1];a=(e.size-e.maximumSize)/2,l=(e.size-e.minimumSize)/2}}if(!t){const e=range(n,-1),t=range(n+1,this.viewItems.length),o=e.reduce(((e,t)=>e+(this.viewItems[t].minimumSize-i[t])),0),a=e.reduce(((e,t)=>e+(this.viewItems[t].viewMaximumSize-i[t])),0),l=0===t.length?Number.POSITIVE_INFINITY:t.reduce(((e,t)=>e+(i[t]-this.viewItems[t].minimumSize)),0),d=0===t.length?Number.NEGATIVE_INFINITY:t.reduce(((e,t)=>e+(i[t]-this.viewItems[t].viewMaximumSize)),0),c=Math.max(o,d),h=Math.min(l,a),u=this.findFirstSnapIndex(e),g=this.findFirstSnapIndex(t);if("number"==typeof u){const e=this.viewItems[u],t=Math.floor(e.viewMinimumSize/2);r={index:u,limitDelta:e.visible?c-t:c+t,size:e.size}}if("number"==typeof g){const e=this.viewItems[g],t=Math.floor(e.viewMinimumSize/2);s={index:g,limitDelta:e.visible?h+t:h-t,size:e.size}}}this.sashDragState={start:e,current:e,index:n,sizes:i,minDelta:a,maxDelta:l,alt:t,snapBefore:r,snapAfter:s,disposable:o}};r(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:o,minDelta:r,maxDelta:s,snapBefore:a,snapAfter:l}=this.sashDragState;this.sashDragState.current=e;const d=e-i,c=this.resize(t,d,n,void 0,void 0,r,s,a,l);if(o){const e=t===this.sashItems.length-1,i=this.viewItems.map((e=>e.size)),n=e?t:t+1,o=this.viewItems[n],r=o.size-o.maximumSize,s=o.size-o.minimumSize,a=e?t-1:t+1;this.resize(a,-c,i,void 0,void 0,r,s)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=clamp(t="number"==typeof t?t:e.size,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(this.state!==State.Idle)throw new Error("Cant modify splitview");if(this.state=State.Busy,e<0||e>=this.viewItems.length)return;const i=range(this.viewItems.length).filter((t=>t!==e)),n=[...i.filter((e=>1===this.viewItems[e].priority)),e],o=i.filter((e=>2===this.viewItems[e].priority)),r=this.viewItems[e];t=clamp(t=Math.round(t),r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=t,this.relayout(n,o),this.state=State.Idle}distributeViewSizes(){const e=[];let t=0;for(const s of this.viewItems)s.maximumSize-s.minimumSize>0&&(e.push(s),t+=s.size);const i=Math.floor(t/e.length);for(const s of e)s.size=clamp(i,s.minimumSize,s.maximumSize);const n=range(this.viewItems.length),o=n.filter((e=>1===this.viewItems[e].priority)),r=n.filter((e=>2===this.viewItems[e].priority));this.relayout(o,r)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==State.Idle)throw new Error("Cant modify splitview");this.state=State.Busy;const o=$$c(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(o):this.viewContainer.insertBefore(o,this.viewContainer.children.item(i));const r=combinedDisposable(e.onDidChange((e=>this.onViewChange(a,e))),toDisposable((()=>this.viewContainer.removeChild(o))));let s;s="number"==typeof t?t:"split"===t.type?this.getViewSize(t.index)/2:"invisible"===t.type?{cachedVisibleSize:t.cachedVisibleSize}:e.minimumSize;const a=0===this.orientation?new VerticalViewItem(o,e,s,r):new HorizontalViewItem(o,e,s,r);if(this.viewItems.splice(i,0,a),this.viewItems.length>1){let e={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash};const t=0===this.orientation?new Sash(this.sashContainer,{getHorizontalSashTop:e=>this.getSashPosition(e),getHorizontalSashWidth:this.getSashOrthogonalSize},Object.assign(Object.assign({},e),{orientation:1})):new Sash(this.sashContainer,{getVerticalSashLeft:e=>this.getSashPosition(e),getVerticalSashHeight:this.getSashOrthogonalSize},Object.assign(Object.assign({},e),{orientation:0})),n=0===this.orientation?e=>({sash:t,start:e.startY,current:e.currentY,alt:e.altKey}):e=>({sash:t,start:e.startX,current:e.currentX,alt:e.altKey}),o=combinedDisposable(Event$1.map(t.onDidStart,n)(this.onSashStart,this),Event$1.map(t.onDidChange,n)(this.onSashChange,this),Event$1.map(t.onDidEnd,(()=>this.sashItems.findIndex((e=>e.sash===t))))(this.onSashEnd,this),t.onDidReset((()=>{const e=this.sashItems.findIndex((e=>e.sash===t)),i=range(e,-1),n=range(e+1,this.viewItems.length),o=this.findFirstSnapIndex(i),r=this.findFirstSnapIndex(n);("number"!=typeof o||this.viewItems[o].visible)&&("number"!=typeof r||this.viewItems[r].visible)&&this._onDidSashReset.fire(e)})),t),r={sash:t,disposable:o};this.sashItems.splice(i-1,0,r)}let l;o.appendChild(e.element),"number"!=typeof t&&"split"===t.type&&(l=[t.index]),n||this.relayout([i],l),this.state=State.Idle,n||"number"==typeof t||"distribute"!==t.type||this.distributeViewSizes()}relayout(e,t){const i=this.viewItems.reduce(((e,t)=>e+t.size),0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map((e=>e.size)),n,o,r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,a,l){if(e<0||e>=this.viewItems.length)return 0;const d=range(e,-1),c=range(e+1,this.viewItems.length);if(o)for(const y of o)pushToStart(d,y),pushToStart(c,y);if(n)for(const y of n)pushToEnd(d,y),pushToEnd(c,y);const h=d.map((e=>this.viewItems[e])),u=d.map((e=>i[e])),g=c.map((e=>this.viewItems[e])),p=c.map((e=>i[e])),m=d.reduce(((e,t)=>e+(this.viewItems[t].minimumSize-i[t])),0),f=d.reduce(((e,t)=>e+(this.viewItems[t].maximumSize-i[t])),0),_=0===c.length?Number.POSITIVE_INFINITY:c.reduce(((e,t)=>e+(i[t]-this.viewItems[t].minimumSize)),0),C=0===c.length?Number.NEGATIVE_INFINITY:c.reduce(((e,t)=>e+(i[t]-this.viewItems[t].maximumSize)),0),v=Math.max(m,C,r),b=Math.min(_,f,s);let S=!1;if(a){const e=this.viewItems[a.index],i=t>=a.limitDelta;S=i!==e.visible,e.setVisible(i,a.size)}if(!S&&l){const e=this.viewItems[l.index],i=t<l.limitDelta;S=i!==e.visible,e.setVisible(i,l.size)}if(S)return this.resize(e,t,i,n,o,r,s);for(let y=0,w=t=clamp(t,v,b);y<h.length;y++){const e=h[y],t=clamp(u[y]+w,e.minimumSize,e.maximumSize);w-=t-u[y],e.size=t}for(let y=0,w=t;y<g.length;y++){const e=g[y],t=clamp(p[y]-w,e.minimumSize,e.maximumSize);w+=t-p[y],e.size=t}return t}distributeEmptySpace(e){const t=this.viewItems.reduce(((e,t)=>e+t.size),0);let i=this.size-t;const n=range(this.viewItems.length-1,-1),o=n.filter((e=>1===this.viewItems[e].priority)),r=n.filter((e=>2===this.viewItems[e].priority));for(const s of r)pushToStart(n,s);for(const s of o)pushToEnd(n,s);"number"==typeof e&&pushToEnd(n,e);for(let s=0;0!==i&&s<n.length;s++){const e=this.viewItems[n[s]],t=clamp(e.size+i,e.minimumSize,e.maximumSize);i-=t-e.size,e.size=t}}layoutViews(){this.contentSize=this.viewItems.reduce(((e,t)=>e+t.size),0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach((e=>e.sash.layout())),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){0===this.orientation?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this.contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this.contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map((t=>e=t.size-t.minimumSize>0||e));e=!1;const i=this.viewItems.map((t=>e=t.maximumSize-t.size>0||e)),n=[...this.viewItems].reverse();e=!1;const o=n.map((t=>e=t.size-t.minimumSize>0||e)).reverse();e=!1;const r=n.map((t=>e=t.maximumSize-t.size>0||e)).reverse();let s=0;for(let a=0;a<this.sashItems.length;a++){const{sash:e}=this.sashItems[a];s+=this.viewItems[a].size;const n=!(t[a]&&r[a+1]),l=!(i[a]&&o[a+1]);if(n&&l){const i=range(a,-1),n=range(a+1,this.viewItems.length),r=this.findFirstSnapIndex(i),l=this.findFirstSnapIndex(n),d="number"==typeof r&&!this.viewItems[r].visible,c="number"==typeof l&&!this.viewItems[l].visible;d&&o[a]&&(s>0||this.startSnappingEnabled)?e.state=1:c&&t[a]&&(s<this.contentSize||this.endSnappingEnabled)?e.state=2:e.state=0}else e.state=n&&!l?1:!n&&l?2:3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const e=this.viewItems[t];if(e.visible&&e.snap)return t}for(const t of e){const e=this.viewItems[t];if(e.visible&&e.maximumSize-e.minimumSize>0)return;if(!e.visible&&e.snap)return t}}dispose(){super.dispose(),dispose(this.viewItems),this.viewItems=[],this.sashItems.forEach((e=>e.disposable.dispose())),this.sashItems=[]}}var table="",TreeMouseEventTarget,TreeMouseEventTarget2;class TableListRenderer{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=TableListRenderer.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map((e=>[e.templateId,e])));this.renderers=[];for(const o of e){const e=n.get(o.templateId);if(!e)throw new Error(`Table cell renderer for template id ${o.templateId} not found.`);this.renderers.push(e)}}renderTemplate(e){const t=append$1(e,$$c(".monaco-table-tr")),i=[],n=[];for(let r=0;r<this.columns.length;r++){const e=this.renderers[r],o=append$1(t,$$c(".monaco-table-td",{"data-col-index":r}));o.style.width=`${this.getColumnSize(r)}px`,i.push(o),n.push(e.renderTemplate(o))}const o={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(o),o}renderElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const r=this.columns[o].project(e);this.renderers[o].renderElement(r,t,i.cellTemplateData[o],n)}}disposeElement(e,t,i,n){for(let o=0;o<this.columns.length;o++){const r=this.renderers[o];if(r.disposeElement){const s=this.columns[o].project(e);r.disposeElement(s,t,i.cellTemplateData[o],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++){this.renderers[t].disposeTemplate(e.cellTemplateData[t])}clearNode(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}function asListVirtualDelegate(e){return{getHeight:t=>e.getHeight(t),getTemplateId:()=>TableListRenderer.TemplateId}}TableListRenderer.TemplateId="row";class ColumnHeader{constructor(e,t){this.column=e,this.index=t,this._onDidLayout=new Emitter$1,this.onDidLayout=this._onDidLayout.event,this.element=$$c(".monaco-table-th",{"data-col-index":t,title:e.tooltip},e.label)}get minimumSize(){var e;return null!==(e=this.column.minimumWidth)&&void 0!==e?e:120}get maximumSize(){var e;return null!==(e=this.column.maximumWidth)&&void 0!==e?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return null!==(e=this.column.onDidChangeWidthConstraints)&&void 0!==e?e:Event$1.None}layout(e){this._onDidLayout.fire([this.index,e])}}class Table{constructor(e,t,i,n,o,r){this.virtualDelegate=i,this.domId="table_id_"+ ++Table.InstanceCount,this.disposables=new DisposableStore,this.cachedWidth=0,this.cachedHeight=0,this.domNode=append$1(t,$$c(`.monaco-table.${this.domId}`));const s=n.map(((e,t)=>new ColumnHeader(e,t))),a={size:s.reduce(((e,t)=>e+t.column.weight),0),views:s.map((e=>({size:e.column.weight,view:e})))};this.splitview=this.disposables.add(new SplitView(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:a})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const l=new TableListRenderer(n,o,(e=>this.splitview.getViewSize(e)));this.list=this.disposables.add(new List(e,this.domNode,asListVirtualDelegate(i),[l],r)),Event$1.any(...s.map((e=>e.onDidLayout)))((([e,t])=>l.layoutColumn(e,t)),null,this.disposables),this.splitview.onDidSashReset((e=>{const t=n.reduce(((e,t)=>e+t.weight),0),i=n[e].weight/t*this.cachedWidth;this.splitview.resizeView(e,i)}),null,this.disposables),this.styleElement=createStyleSheet(this.domNode),this.style({})}get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get onDidDispose(){return this.list.onDidDispose}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\ttop: ${this.virtualDelegate.headerRowHeight+1}px;\n\t\t\theight: calc(100% - ${this.virtualDelegate.headerRowHeight}px);\n\t\t}`),this.styleElement.textContent=t.join("\n"),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}Table.InstanceCount=0,TreeMouseEventTarget2=TreeMouseEventTarget||(TreeMouseEventTarget={}),TreeMouseEventTarget2[TreeMouseEventTarget2.Unknown=0]="Unknown",TreeMouseEventTarget2[TreeMouseEventTarget2.Twistie=1]="Twistie",TreeMouseEventTarget2[TreeMouseEventTarget2.Element=2]="Element";class TreeError extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class WeakMapper{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}class DiffChange{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class StringDiffSequence{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function stringDiff(e,t,i){return new LcsDiff(new StringDiffSequence(e),new StringDiffSequence(t)).ComputeDiff(i).changes}class Debug{static Assert(e,t){if(!e)throw new Error(t)}}class MyArray{static Copy(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}static Copy2(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}}class DiffChangeHelper{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new DiffChange(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class LcsDiff{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,o,r]=LcsDiff._getElements(e),[s,a,l]=LcsDiff._getElements(t);this._hasStrings=r&&l,this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&"string"==typeof e[0]}static _getElements(e){const t=e.getElements();if(LcsDiff._isStringArray(t)){const e=new Int32Array(t.length);for(let i=0,n=t.length;i<n;i++)e[i]=stringHash(t[i],0);return[t,e,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]===this._modifiedElementsOrHash[t]&&(!this._hasStrings||this._originalStringElements[e]===this._modifiedStringElements[t])}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;return LcsDiff._getStrictElement(this._originalSequence,e)===LcsDiff._getStrictElement(this._modifiedSequence,t)}static _getStrictElement(e,t){return"function"==typeof e.getStrictElement?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]===this._originalElementsOrHash[t]&&(!this._hasStrings||this._originalStringElements[e]===this._originalStringElements[t])}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]===this._modifiedElementsOrHash[t]&&(!this._hasStrings||this._modifiedStringElements[e]===this._modifiedStringElements[t])}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,o){const r=[!1];let s=this.ComputeDiffRecursive(e,t,i,n,r);return o&&(s=this.PrettifyChanges(s)),{quitEarly:r[0],changes:s}}ComputeDiffRecursive(e,t,i,n,o){for(o[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let o;return i<=n?(Debug.Assert(e===t+1,"originalStart should only be one more than originalEnd"),o=[new DiffChange(e,0,i,n-i+1)]):e<=t?(Debug.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),o=[new DiffChange(e,t-e+1,i,0)]):(Debug.Assert(e===t+1,"originalStart should only be one more than originalEnd"),Debug.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),o=[]),o}const r=[0],s=[0],a=this.ComputeRecursionPoint(e,t,i,n,r,s,o),l=r[0],d=s[0];if(null!==a)return a;if(!o[0]){const r=this.ComputeDiffRecursive(e,l,i,d,o);let s=[];return s=o[0]?[new DiffChange(l+1,t-(l+1)+1,d+1,n-(d+1)+1)]:this.ComputeDiffRecursive(l+1,t,d+1,n,o),this.ConcatenateChanges(r,s)}return[new DiffChange(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p,m,f,_){let C=null,v=null,b=new DiffChangeHelper,S=t,y=i,w=u[0]-m[0]-n,E=-1073741824,L=this.m_forwardHistory.length-1;do{const t=w+e;t===S||t<y&&l[t-1]<l[t+1]?(g=(c=l[t+1])-w-n,c<E&&b.MarkNextChange(),E=c,b.AddModifiedElement(c+1,g),w=t+1-e):(g=(c=l[t-1]+1)-w-n,c<E&&b.MarkNextChange(),E=c-1,b.AddOriginalElement(c,g+1),w=t-1-e),L>=0&&(e=(l=this.m_forwardHistory[L])[0],S=1,y=l.length-1)}while(--L>=-1);if(C=b.getReverseChanges(),_[0]){let e=u[0]+1,t=m[0]+1;if(null!==C&&C.length>0){const i=C[C.length-1];e=Math.max(e,i.getOriginalEnd()),t=Math.max(t,i.getModifiedEnd())}v=[new DiffChange(e,h-e+1,t,p-t+1)]}else{b=new DiffChangeHelper,S=r,y=s,w=u[0]-m[0]-a,E=1073741824,L=f?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const e=w+o;e===S||e<y&&d[e-1]>=d[e+1]?(g=(c=d[e+1]-1)-w-a,c>E&&b.MarkNextChange(),E=c+1,b.AddOriginalElement(c+1,g+1),w=e+1-o):(g=(c=d[e-1])-w-a,c>E&&b.MarkNextChange(),E=c,b.AddModifiedElement(c+1,g+1),w=e-1-o),L>=0&&(o=(d=this.m_reverseHistory[L])[0],S=1,y=d.length-1)}while(--L>=-1);v=b.getChanges()}return this.ConcatenateChanges(C,v)}ComputeRecursionPoint(e,t,i,n,o,r,s){let a=0,l=0,d=0,c=0,h=0,u=0;e--,i--,o[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const g=t-e+(n-i),p=g+1,m=new Int32Array(p),f=new Int32Array(p),_=n-i,C=t-e,v=e-i,b=t-n,S=(C-_)%2==0;m[_]=e,f[C]=t,s[0]=!1;for(let y=1;y<=g/2+1;y++){let g=0,w=0;d=this.ClipDiagonalBound(_-y,y,_,p),c=this.ClipDiagonalBound(_+y,y,_,p);for(let e=d;e<=c;e+=2){a=e===d||e<c&&m[e-1]<m[e+1]?m[e+1]:m[e-1]+1,l=a-(e-_)-v;const i=a;for(;a<t&&l<n&&this.ElementsAreEqual(a+1,l+1);)a++,l++;if(m[e]=a,a+l>g+w&&(g=a,w=l),!S&&Math.abs(e-C)<=y-1&&a>=f[e])return o[0]=a,r[0]=l,i<=f[e]&&y<=1448?this.WALKTRACE(_,d,c,v,C,h,u,b,m,f,a,t,o,l,n,r,S,s):null}const E=(g-e+(w-i)-y)/2;if(null!==this.ContinueProcessingPredicate&&!this.ContinueProcessingPredicate(g,E))return s[0]=!0,o[0]=g,r[0]=w,E>0&&y<=1448?this.WALKTRACE(_,d,c,v,C,h,u,b,m,f,a,t,o,l,n,r,S,s):(e++,i++,[new DiffChange(e,t-e+1,i,n-i+1)]);h=this.ClipDiagonalBound(C-y,y,C,p),u=this.ClipDiagonalBound(C+y,y,C,p);for(let p=h;p<=u;p+=2){a=p===h||p<u&&f[p-1]>=f[p+1]?f[p+1]-1:f[p-1],l=a-(p-C)-b;const g=a;for(;a>e&&l>i&&this.ElementsAreEqual(a,l);)a--,l--;if(f[p]=a,S&&Math.abs(p-_)<=y&&a<=m[p])return o[0]=a,r[0]=l,g>=m[p]&&y<=1448?this.WALKTRACE(_,d,c,v,C,h,u,b,m,f,a,t,o,l,n,r,S,s):null}if(y<=1447){let e=new Int32Array(c-d+2);e[0]=_-d+1,MyArray.Copy2(m,d,e,1,c-d+1),this.m_forwardHistory.push(e),e=new Int32Array(u-h+2),e[0]=C-h+1,MyArray.Copy2(f,h,e,1,u-h+1),this.m_reverseHistory.push(e)}}return this.WALKTRACE(_,d,c,v,C,h,u,b,m,f,a,t,o,l,n,r,S,s)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,o=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,r=i.originalLength>0,s=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<o&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!s||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const e=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!e)break;i.originalStart++,i.modifiedStart++}let a=[null];t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],a)&&(e[t]=a[0],e.splice(t+1,1),t--)}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,o=0;if(t>0){const i=e[t-1];n=i.originalStart+i.originalLength,o=i.modifiedStart+i.modifiedLength}const r=i.originalLength>0,s=i.modifiedLength>0;let a=0,l=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let e=1;;e++){const t=i.originalStart-e,d=i.modifiedStart-e;if(t<n||d<o)break;if(r&&!this.OriginalElementsAreEqual(t,t+i.originalLength))break;if(s&&!this.ModifiedElementsAreEqual(d,d+i.modifiedLength))break;const c=(t===n&&d===o?5:0)+this._boundaryScore(t,i.originalLength,d,i.modifiedLength);c>l&&(l=c,a=e)}i.originalStart-=a,i.modifiedStart-=a;const d=[null];t>0&&this.ChangesOverlap(e[t-1],e[t],d)&&(e[t-1]=d[0],e.splice(t,1),t++)}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const i=e[t-1],n=e[t],o=n.originalStart-i.originalStart-i.originalLength,r=i.originalStart,s=n.originalStart+n.originalLength,a=s-r,l=i.modifiedStart,d=n.modifiedStart+n.modifiedLength,c=d-l;if(o<5&&a<20&&c<20){const e=this._findBetterContiguousSequence(r,a,l,c,o);if(e){const[t,r]=e;t===i.originalStart+i.originalLength&&r===i.modifiedStart+i.modifiedLength||(i.originalLength=t-i.originalStart,i.modifiedLength=r-i.modifiedStart,n.originalStart=t+o,n.modifiedStart=r+o,n.originalLength=s-n.originalStart,n.modifiedLength=d-n.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,o){if(t<o||n<o)return null;const r=e+t-o+1,s=i+n-o+1;let a=0,l=0,d=0;for(let c=e;c<r;c++)for(let e=i;e<s;e++){const t=this._contiguousSequenceScore(c,e,o);t>0&&t>a&&(a=t,l=c,d=e)}return a>0?[l,d]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let o=0;o<i;o++){if(!this.ElementsAreEqual(e+o,t+o))return 0;n+=this._originalStringElements[e+o].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1||this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){return(this._OriginalRegionIsBoundary(e,t)?1:0)+(this._ModifiedRegionIsBoundary(i,n)?1:0)}ConcatenateChanges(e,t){let i=[];if(0===e.length||0===t.length)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return MyArray.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],MyArray.Copy(t,1,n,e.length,t.length-1),n}{const i=new Array(e.length+t.length);return MyArray.Copy(e,0,i,0,e.length),MyArray.Copy(t,0,i,e.length,t.length),i}}ChangesOverlap(e,t,i){if(Debug.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),Debug.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let o=e.originalLength;const r=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(o=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(s=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new DiffChange(n,o,r,s),!0}return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const o=t%2==0;if(e<0){return o===(i%2==0)?0:1}return o===((n-i-1)%2==0)?n-1:n-2}}function isFilterResult(e){return"object"==typeof e&&"visibility"in e&&"data"in e}function getVisibleState(e){switch(e){case!0:return 1;case!1:return 0;default:return e}}function isCollapsibleStateUpdate(e){return"boolean"==typeof e.collapsible}class IndexTreeModel{constructor(e,t,i,n={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new EventBufferer,this._onDidChangeCollapseState=new Emitter$1,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new Emitter$1,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new Emitter$1,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new Delayer(MicrotaskDelay),this.collapseByDefault=void 0!==n.collapseByDefault&&n.collapseByDefault,this.filter=n.filter,this.autoExpandSingleChildren=void 0!==n.autoExpandSingleChildren&&n.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=Iterable.empty(),n={}){if(0===e.length)throw new TreeError(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n,o,r){var s;void 0===n&&(n=Iterable.empty()),void 0===r&&(r=null!==(s=o.diffDepth)&&void 0!==s?s:0);const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,o);const l=[...n],d=t[t.length-1],c=new LcsDiff({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,d),...l,...a.children.slice(d+i)].map((t=>e.getId(t.element).toString()))}).ComputeDiff(!1);if(c.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,o);const h=t.slice(0,-1),u=(t,i,n)=>{if(r>0)for(let s=0;s<n;s++)t--,i--,this.spliceSmart(e,[...h,t,0],Number.MAX_SAFE_INTEGER,l[i].children,o,r-1)};let g=Math.min(a.children.length,d+i),p=l.length;for(const m of c.changes.sort(((e,t)=>t.originalStart-e.originalStart)))u(g,p,g-(m.originalStart+m.originalLength)),g=m.originalStart,p=m.modifiedStart-d,this.spliceSimple([...h,g],m.originalLength,Iterable.slice(l,p,p+m.modifiedLength),o);u(g,p,g)}spliceSimple(e,t,i=Iterable.empty(),{onDidCreateNode:n,onDidDeleteNode:o,diffIdentityProvider:r}){const{parentNode:s,listIndex:a,revealed:l,visible:d}=this.getParentNodeWithListIndex(e),c=[],h=Iterable.map(i,(e=>this.createTreeNode(e,s,s.visible?1:0,l,c,n))),u=e[e.length-1],g=s.children.length>0;let p=0;for(let y=u;y>=0&&y<s.children.length;y--){const e=s.children[y];if(e.visible){p=e.visibleChildIndex;break}}const m=[];let f=0,_=0;for(const y of h)m.push(y),_+=y.renderNodeCount,y.visible&&(y.visibleChildIndex=p+f++);const C=splice$1(s.children,u,t,m);r?s.lastDiffIds?splice$1(s.lastDiffIds,u,t,m.map((e=>r.getId(e.element).toString()))):s.lastDiffIds=s.children.map((e=>r.getId(e.element).toString())):s.lastDiffIds=void 0;let v=0;for(const y of C)y.visible&&v++;if(0!==v)for(let y=u+m.length;y<s.children.length;y++){const e=s.children[y];e.visible&&(e.visibleChildIndex-=v)}if(s.visibleChildrenCount+=f-v,l&&d){const e=C.reduce(((e,t)=>e+(t.visible?t.renderNodeCount:0)),0);this._updateAncestorsRenderNodeCount(s,_-e),this.list.splice(a,e,c)}if(C.length>0&&o){const e=t=>{o(t),t.children.forEach(e)};C.forEach(e)}this._onDidSplice.fire({insertedNodes:m,deletedNodes:C});const b=s.children.length>0;g!==b&&this.setCollapsible(e.slice(0,-1),b);let S=s;for(;S;){if(2===S.visibility){this.refilterDelayer.trigger((()=>this.refilter()));break}S=S.parent}}rerender(e){if(0===e.length)throw new TreeError(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);void 0===t&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,n)))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);void 0===t&&(t=!n.collapsed);const o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,o)))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:o}=this.getTreeNodeWithListIndex(e),r=this._setListNodeCollapseState(i,n,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&r&&!isCollapsibleStateUpdate(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let n=-1;for(let e=0;e<i.children.length;e++){if(i.children[e].visible){if(n>-1){n=-1;break}n=e}}n>-1&&this._setCollapseState([...e,n],t)}return r}_setListNodeCollapseState(e,t,i,n){const o=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!o)return o;const r=e.renderNodeCount,s=this.updateNodeAfterCollapseChange(e),a=r-(-1===t?0:1);return this.list.splice(t+1,a,s.slice(1)),o}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:(isCollapsibleStateUpdate(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!isCollapsibleStateUpdate(t)&&t.recursive)for(const o of e.children)n=this._setNodeCollapseState(o,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents((()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})}))}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,o,r){const s={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:"boolean"==typeof e.collapsible?e.collapsible:void 0!==e.collapsed,collapsed:void 0===e.collapsed?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},a=this._filterNode(s,i);s.visibility=a,n&&o.push(s);const l=e.children||Iterable.empty(),d=n&&0!==a&&!s.collapsed,c=Iterable.map(l,(e=>this.createTreeNode(e,s,a,d,o,r)));let h=0,u=1;for(const g of c)s.children.push(g),u+=g.renderNodeCount,g.visible&&(g.visibleChildIndex=h++);return s.collapsible=s.collapsible||s.children.length>0,s.visibleChildrenCount=h,s.visible=2===a?h>0:1===a,s.visible?s.collapsed||(s.renderNodeCount=u):(s.renderNodeCount=0,n&&o.pop()),r&&r(s),s}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(!1===e.visible)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),0===o)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const r=i.length;e.renderNodeCount=e===this.root?0:1;let s=!1;if(e.collapsed&&0===o)e.visibleChildrenCount=0;else{let t=0;for(const r of e.children)s=this._updateNodeAfterFilterChange(r,o,i,n&&!e.collapsed)||s,r.visible&&(r.visibleChildIndex=t++);e.visibleChildrenCount=t}return e!==this.root&&(e.visible=2===o?s:1===o,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-r):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(0!==t)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return"boolean"==typeof i?(e.filterData=void 0,i?1:0):isFilterResult(i)?(e.filterData=i.data,getVisibleState(i.visibility)):(e.filterData=void 0,getVisibleState(i))}hasTreeNode(e,t=this.root){if(!e||0===e.length)return!0;const[i,...n]=e;return!(i<0||i>t.children.length)&&this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||0===e.length)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new TreeError(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(0===e.length)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:o}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new TreeError(this.user,"Invalid tree location");const s=t.children[r];return{node:s,listIndex:i,revealed:n,visible:o&&s.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,o=!0){const[r,...s]=e;if(r<0||r>t.children.length)throw new TreeError(this.user,"Invalid tree location");for(let a=0;a<r;a++)i+=t.children[a].renderNodeCount;return n=n&&!t.collapsed,o=o&&t.visible,0===s.length?{parentNode:t,listIndex:i,revealed:n,visible:o}:this.getParentNodeWithListIndex(s,t.children[r],i+1,n,o)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){return 0===e.length?void 0:1===e.length?[]:tail2(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(0!==t.children.length)return t.children[0].element}}var tree="",RenderIndentGuides,RenderIndentGuides2;class TreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function asTreeDragAndDropData(e){return e instanceof ElementsDragAndDropData?new TreeElementsDragAndDropData(e):e}class TreeNodeListDragAndDrop{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=Disposable.None}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(asTreeDragAndDropData(e),t)}onDragOver(e,t,i,n,o=!0){const r=this.dnd.onDragOver(asTreeDragAndDropData(e),t&&t.element,i,n),s=this.autoExpandNode!==t;if(s&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),void 0===t)return r;if(s&&"boolean"!=typeof r&&r.autoExpand&&(this.autoExpandDisposable=disposableTimeout((()=>{const e=this.modelProvider(),i=e.getNodeLocation(t);e.isCollapsed(i)&&e.setCollapsed(i,!1),this.autoExpandNode=void 0}),500)),"boolean"==typeof r||!r.accept||void 0===r.bubble||r.feedback){if(!o){return{accept:"boolean"==typeof r?r:r.accept,effect:"boolean"==typeof r?void 0:r.effect,feedback:[i]}}return r}if(1===r.bubble){const i=this.modelProvider(),o=i.getNodeLocation(t),r=i.getParentNodeLocation(o),s=i.getNode(r),a=r&&i.getListIndex(r);return this.onDragOver(e,s,a,n,!1)}const a=this.modelProvider(),l=a.getNodeLocation(t),d=a.getListIndex(l),c=a.getListRenderCount(l);return Object.assign(Object.assign({},r),{feedback:range(d,d+c)})}drop(e,t,i,n){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(asTreeDragAndDropData(e),t&&t.element,i,n)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}function asListOptions(e,t){return t&&Object.assign(Object.assign({},t),{identityProvider:t.identityProvider&&{getId:e=>t.identityProvider.getId(e.element)},dnd:t.dnd&&new TreeNodeListDragAndDrop(e,t.dnd),multipleSelectionController:t.multipleSelectionController&&{isSelectionSingleChangeEvent:e=>t.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},e),{element:e.element})),isSelectionRangeChangeEvent:e=>t.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},e),{element:e.element}))},accessibilityProvider:t.accessibilityProvider&&Object.assign(Object.assign({},t.accessibilityProvider),{getSetSize(t){const i=e(),n=i.getNodeLocation(t),o=i.getParentNodeLocation(n);return i.getNode(o).visibleChildrenCount},getPosInSet:e=>e.visibleChildIndex+1,isChecked:t.accessibilityProvider&&t.accessibilityProvider.isChecked?e=>t.accessibilityProvider.isChecked(e.element):void 0,getRole:t.accessibilityProvider&&t.accessibilityProvider.getRole?e=>t.accessibilityProvider.getRole(e.element):()=>"treeitem",getAriaLabel:e=>t.accessibilityProvider.getAriaLabel(e.element),getWidgetAriaLabel:()=>t.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:t.accessibilityProvider&&t.accessibilityProvider.getWidgetRole?()=>t.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:t.accessibilityProvider&&t.accessibilityProvider.getAriaLevel?e=>t.accessibilityProvider.getAriaLevel(e.element):e=>e.depth,getActiveDescendantId:t.accessibilityProvider.getActiveDescendantId&&(e=>t.accessibilityProvider.getActiveDescendantId(e.element))}),keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},t.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:e=>t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}),enableKeyboardNavigation:t.simpleKeyboardNavigation})}class ComposedTreeDelegate{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight&&this.delegate.setDynamicHeight(e.element,t)}}RenderIndentGuides2=RenderIndentGuides||(RenderIndentGuides={}),RenderIndentGuides2.None="none",RenderIndentGuides2.OnHover="onHover",RenderIndentGuides2.Always="always";class EventCollection{constructor(e,t=[]){this._elements=t,this.onDidChange=Event$1.forEach(e,(e=>this._elements=e))}get elements(){return this._elements}}class TreeRenderer{constructor(e,t,i,n,o={}){this.renderer=e,this.modelProvider=t,this.activeNodes=n,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=TreeRenderer.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.renderedIndentGuides=new SetMap,this.activeIndentNodes=new Set,this.indentGuidesDisposable=Disposable.None,this.disposables=new DisposableStore,this.templateId=e.templateId,this.updateOptions(o),Event$1.map(i,(e=>e.node))(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState&&e.onDidChangeTwistieState(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(void 0!==e.indent&&(this.indent=clamp(e.indent,0,40)),void 0!==e.renderIndentGuides){const t=e.renderIndentGuides!==RenderIndentGuides.None;if(t!==this.shouldRenderIndentGuides&&(this.shouldRenderIndentGuides=t,this.indentGuidesDisposable.dispose(),t)){const e=new DisposableStore;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,e),this.indentGuidesDisposable=e,this._onDidChangeActiveNodes(this.activeNodes.elements)}}void 0!==e.hideTwistiesOfChildlessElements&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=append$1(e,$$c(".monaco-tl-row")),i=append$1(t,$$c(".monaco-tl-indent")),n=append$1(t,$$c(".monaco-tl-twistie")),o=append$1(t,$$c(".monaco-tl-contents")),r=this.renderer.renderTemplate(o);return{container:e,indent:i,twistie:n,indentGuidesDisposable:Disposable.None,templateData:r}}renderElement(e,t,i,n){"number"==typeof n&&(this.renderedNodes.set(e,{templateData:i,height:n}),this.renderedElements.set(e.element,e));const o=TreeRenderer.DefaultIndent+(e.depth-1)*this.indent;i.twistie.style.paddingLeft=`${o}px`,i.indent.style.width=o+this.indent-16+"px",this.renderTwistie(e,i),"number"==typeof n&&this.renderIndentGuides(e,i),this.renderer.renderElement(e,t,i.templateData,n)}disposeElement(e,t,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement&&this.renderer.disposeElement(e,t,i.templateData,n),"number"==typeof n&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this.renderTwistie(e,t.templateData),this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderIndentGuides(e,t.templateData))}renderTwistie(e,t){t.twistie.classList.remove(...Codicon.treeItemExpanded.classNamesArray);let i=!1;this.renderer.renderTwistie&&(i=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(i||t.twistie.classList.add(...Codicon.treeItemExpanded.classNamesArray),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded")}renderIndentGuides(e,t){if(clearNode(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new DisposableStore,n=this.modelProvider();let o=e;for(;;){const e=n.getNodeLocation(o),r=n.getParentNodeLocation(e);if(!r)break;const s=n.getNode(r),a=$$c(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(s)&&a.classList.add("active"),0===t.indent.childElementCount?t.indent.appendChild(a):t.indent.insertBefore(a,t.indent.firstElementChild),this.renderedIndentGuides.add(s,a),i.add(toDisposable((()=>this.renderedIndentGuides.delete(s,a)))),o=s}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach((e=>{const n=i.getNodeLocation(e);try{const o=i.getParentNodeLocation(n);e.collapsible&&e.children.length>0&&!e.collapsed?t.add(e):o&&t.add(i.getNode(o))}catch(o){}})),this.activeIndentNodes.forEach((e=>{t.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.remove("active")))})),t.forEach((e=>{this.activeIndentNodes.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.add("active")))})),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),dispose(this.disposables)}}TreeRenderer.DefaultIndent=8;class TypeFilter{constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new DisposableStore,e.onWillRefilter(this.reset,this,this.disposables)}get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}set pattern(e){this._pattern=e,this._lowercasePattern=e.toLowerCase()}filter(e,t){if(this._filter){const i=this._filter.filter(e,t);if(this.tree.options.simpleKeyboardNavigation)return i;let n;if(n="boolean"==typeof i?i?1:0:isFilterResult(i)?getVisibleState(i.visibility):i,0===n)return!1}if(this._totalCount++,this.tree.options.simpleKeyboardNavigation||!this._pattern)return this._matchCount++,{data:FuzzyScore.Default,visibility:!0};const i=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),n=Array.isArray(i)?i:[i];for(const o of n){const e=o&&o.toString();if(void 0===e)return{data:FuzzyScore.Default,visibility:!0};const t=fuzzyScore(this._pattern,this._lowercasePattern,0,e,e.toLowerCase(),0,!0);if(t)return this._matchCount++,1===n.length?{data:t,visibility:!0}:{data:{label:e,score:t},visibility:!0}}return this.tree.options.filterOnType?2:{data:FuzzyScore.Default,visibility:!0}}reset(){this._totalCount=0,this._matchCount=0}dispose(){dispose(this.disposables)}}class TypeFilterController{constructor(e,t,i,n,o){this.tree=e,this.view=i,this.filter=n,this.keyboardNavigationDelegate=o,this._enabled=!1,this._pattern="",this._empty=!1,this._onDidChangeEmptyState=new Emitter$1,this.positionClassName="ne",this.automaticKeyboardNavigation=!0,this.triggered=!1,this._onDidChangePattern=new Emitter$1,this.enabledDisposables=new DisposableStore,this.disposables=new DisposableStore,this.domNode=$$c(`.monaco-list-type-filter.${this.positionClassName}`),this.domNode.draggable=!0,this.disposables.add(addDisposableListener(this.domNode,"dragstart",(()=>this.onDragStart()))),this.messageDomNode=append$1(i.getHTMLElement(),$$c(".monaco-list-type-filter-message")),this.labelDomNode=append$1(this.domNode,$$c("span.label"));const r=append$1(this.domNode,$$c(".controls"));this._filterOnType=!!e.options.filterOnType,this.filterOnTypeDomNode=append$1(r,$$c("input.filter")),this.filterOnTypeDomNode.type="checkbox",this.filterOnTypeDomNode.checked=this._filterOnType,this.filterOnTypeDomNode.tabIndex=-1,this.updateFilterOnTypeTitleAndIcon(),this.disposables.add(addDisposableListener(this.filterOnTypeDomNode,"input",(()=>this.onDidChangeFilterOnType()))),this.clearDomNode=append$1(r,$$c("button.clear"+Codicon.treeFilterClear.cssSelector)),this.clearDomNode.tabIndex=-1,this.clearDomNode.title=localize("clear","Clear"),this.keyboardNavigationEventFilter=e.options.keyboardNavigationEventFilter,t.onDidSplice(this.onDidSpliceModel,this,this.disposables),this.updateOptions(e.options)}get enabled(){return this._enabled}get pattern(){return this._pattern}get filterOnType(){return this._filterOnType}updateOptions(e){e.simpleKeyboardNavigation?this.disable():this.enable(),void 0!==e.filterOnType&&(this._filterOnType=!!e.filterOnType,this.filterOnTypeDomNode.checked=this._filterOnType,this.updateFilterOnTypeTitleAndIcon()),void 0!==e.automaticKeyboardNavigation&&(this.automaticKeyboardNavigation=e.automaticKeyboardNavigation),this.tree.refilter(),this.render(),this.automaticKeyboardNavigation||this.onEventOrInput("")}enable(){if(this._enabled)return;const e=this.enabledDisposables.add(new DomEmitter(this.view.getHTMLElement(),"keydown")),t=Event$1.chain(e.event).filter((e=>!isInputElement(e.target)||e.target===this.filterOnTypeDomNode)).filter((e=>"Dead"!==e.key&&!/^Media/.test(e.key))).map((e=>new StandardKeyboardEvent(e))).filter(this.keyboardNavigationEventFilter||(()=>!0)).filter((()=>this.automaticKeyboardNavigation||this.triggered)).filter((e=>this.keyboardNavigationDelegate.mightProducePrintableCharacter(e)&&!(18===e.keyCode||16===e.keyCode||15===e.keyCode||17===e.keyCode)||(this.pattern.length>0||this.triggered)&&(9===e.keyCode||1===e.keyCode)&&!e.altKey&&!e.ctrlKey&&!e.metaKey||1===e.keyCode&&(isMacintosh?e.altKey&&!e.metaKey:e.ctrlKey)&&!e.shiftKey)).forEach((e=>{e.stopPropagation(),e.preventDefault()})).event,i=this.enabledDisposables.add(new DomEmitter(this.clearDomNode,"click"));Event$1.chain(Event$1.any(t,i.event)).event(this.onEventOrInput,this,this.enabledDisposables),this.filter.pattern="",this.tree.refilter(),this.render(),this._enabled=!0,this.triggered=!1}disable(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.clear(),this.tree.refilter(),this.render(),this._enabled=!1,this.triggered=!1)}onEventOrInput(e){"string"==typeof e?this.onInput(e):e instanceof MouseEvent||9===e.keyCode||1===e.keyCode&&(isMacintosh?e.altKey:e.ctrlKey)?this.onInput(""):1===e.keyCode?this.onInput(0===this.pattern.length?"":this.pattern.substr(0,this.pattern.length-1)):this.onInput(this.pattern+e.browserEvent.key)}onInput(e){const t=this.view.getHTMLElement();e&&!this.domNode.parentElement?t.append(this.domNode):!e&&this.domNode.parentElement&&(this.domNode.remove(),this.tree.domFocus()),this._pattern=e,this._onDidChangePattern.fire(e),this.filter.pattern=e,this.tree.refilter(),e&&this.tree.focusNext(0,!0,void 0,(e=>!FuzzyScore.isDefault(e.filterData)));const i=this.tree.getFocus();if(i.length>0){const e=i[0];null===this.tree.getRelativeTop(e)&&this.tree.reveal(e,.5)}this.render(),e||(this.triggered=!1)}onDragStart(){const e=this.view.getHTMLElement(),{left:t}=getDomNodePagePosition(e),i=e.clientWidth,n=i/2,o=this.domNode.clientWidth,r=new DisposableStore;let s=this.positionClassName;const a=()=>{switch(s){case"nw":this.domNode.style.top="4px",this.domNode.style.left="4px";break;case"ne":this.domNode.style.top="4px",this.domNode.style.left=i-o-6+"px"}},l=()=>{this.positionClassName=s,this.domNode.className=`monaco-list-type-filter ${this.positionClassName}`,this.domNode.style.top="",this.domNode.style.left="",dispose(r)};a(),this.domNode.classList.remove(s),this.domNode.classList.add("dragging"),r.add(toDisposable((()=>this.domNode.classList.remove("dragging")))),r.add(addDisposableListener(document,"dragover",(e=>(e=>{e.preventDefault();const i=e.clientX-t;e.dataTransfer&&(e.dataTransfer.dropEffect="none"),s=i<n?"nw":"ne",a()})(e)))),r.add(addDisposableListener(this.domNode,"dragend",(()=>l()))),StaticDND.CurrentDragAndDropData=new DragAndDropData("vscode-ui"),r.add(toDisposable((()=>StaticDND.CurrentDragAndDropData=void 0)))}onDidSpliceModel(){this._enabled&&0!==this.pattern.length&&(this.tree.refilter(),this.render())}onDidChangeFilterOnType(){this.tree.updateOptions({filterOnType:this.filterOnTypeDomNode.checked}),this.tree.refilter(),this.tree.domFocus(),this.render(),this.updateFilterOnTypeTitleAndIcon()}updateFilterOnTypeTitleAndIcon(){this.filterOnType?(this.filterOnTypeDomNode.classList.remove(...Codicon.treeFilterOnTypeOff.classNamesArray),this.filterOnTypeDomNode.classList.add(...Codicon.treeFilterOnTypeOn.classNamesArray),this.filterOnTypeDomNode.title=localize("disable filter on type","Disable Filter on Type")):(this.filterOnTypeDomNode.classList.remove(...Codicon.treeFilterOnTypeOn.classNamesArray),this.filterOnTypeDomNode.classList.add(...Codicon.treeFilterOnTypeOff.classNamesArray),this.filterOnTypeDomNode.title=localize("enable filter on type","Enable Filter on Type"))}render(){const e=this.filter.totalCount>0&&0===this.filter.matchCount;this.pattern&&this.tree.options.filterOnType&&e?(this.messageDomNode.textContent=localize("empty","No elements found"),this._empty=!0):(this.messageDomNode.innerText="",this._empty=!1),this.domNode.classList.toggle("no-matches",e),this.domNode.title=localize("found","Matched {0} out of {1} elements",this.filter.matchCount,this.filter.totalCount),this.labelDomNode.textContent=this.pattern.length>16?"…"+this.pattern.substr(this.pattern.length-16):this.pattern,this._onDidChangeEmptyState.fire(this._empty)}shouldAllowFocus(e){return!(this.enabled&&this.pattern&&!this.filterOnType)||(this.filter.totalCount>0&&this.filter.matchCount<=1||!FuzzyScore.isDefault(e.filterData))}dispose(){this._enabled&&(this.domNode.remove(),this.enabledDisposables.dispose(),this._enabled=!1,this.triggered=!1),this._onDidChangePattern.dispose(),dispose(this.disposables)}}function asTreeMouseEvent$1(e){let t=TreeMouseEventTarget.Unknown;return hasParentWithClass(e.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?t=TreeMouseEventTarget.Twistie:hasParentWithClass(e.browserEvent.target,"monaco-tl-contents","monaco-tl-row")&&(t=TreeMouseEventTarget.Element),{browserEvent:e.browserEvent,element:e.element?e.element.element:null,target:t}}function dfs$1(e,t){t(e),e.children.forEach((e=>dfs$1(e,t)))}class Trait{constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event}get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}set(e,t){!(null==t?void 0:t.__forceEvent)&&equals$1(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const e=this;this._onDidChange.fire({get elements(){return e.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map((e=>e.element))),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const e=this.createNodeSet(),i=t=>e.delete(t);return t.forEach((e=>dfs$1(e,i))),void this.set([...e.values()])}const i=new Set,n=e=>i.add(this.identityProvider.getId(e.element).toString());t.forEach((e=>dfs$1(e,n)));const o=new Map,r=e=>o.set(this.identityProvider.getId(e.element).toString(),e);e.forEach((e=>dfs$1(e,r)));const s=[];for(const a of this.nodes){const e=this.identityProvider.getId(a.element).toString();if(i.has(e)){const t=o.get(e);t&&s.push(t)}else s.push(a)}if(this.nodes.length>0&&0===s.length){const e=this.getFirstViewElementWithTrait();e&&s.push(e)}this._set(s,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class TreeNodeListMouseController extends MouseController{constructor(e,t){super(e),this.tree=t}onViewPointer(e){if(isInputElement(e.browserEvent.target)||isMonacoEditor(e.browserEvent.target))return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16;let o=!1;if(o="function"==typeof this.tree.expandOnlyOnTwistieClick?this.tree.expandOnlyOnTwistieClick(t.element):!!this.tree.expandOnlyOnTwistieClick,o&&!n&&2!==e.browserEvent.detail)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&2===e.browserEvent.detail)return super.onViewPointer(e);if(t.collapsible){const i=this.tree.model,r=i.getNodeLocation(t),s=e.browserEvent.altKey;if(this.tree.setFocus([r]),i.setCollapsed(r,void 0,s),o&&n)return}super.onViewPointer(e)}onDoubleClick(e){!e.browserEvent.target.classList.contains("monaco-tl-twistie")&&this.tree.expandOnDoubleClick&&super.onDoubleClick(e)}}class TreeNodeList extends List{constructor(e,t,i,n,o,r,s,a){super(e,t,i,n,a),this.focusTrait=o,this.selectionTrait=r,this.anchorTrait=s}createMouseController(e){return new TreeNodeListMouseController(this,e.tree)}splice(e,t,i=[]){if(super.splice(e,t,i),0===i.length)return;const n=[],o=[];let r;i.forEach(((t,i)=>{this.focusTrait.has(t)&&n.push(e+i),this.selectionTrait.has(t)&&o.push(e+i),this.anchorTrait.has(t)&&(r=e+i)})),n.length>0&&super.setFocus(distinct([...super.getFocus(),...n])),o.length>0&&super.setSelection(distinct([...super.getSelection(),...o])),"number"==typeof r&&super.setAnchor(r)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map((e=>this.element(e))),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map((e=>this.element(e))),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(void 0===e?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class AbstractTree{constructor(e,t,i,n,o={}){this._user=e,this._options=o,this.eventBufferer=new EventBufferer,this.disposables=new DisposableStore,this._onWillRefilter=new Emitter$1,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new Emitter$1;const r=new ComposedTreeDelegate(i),s=new Relay,a=new Relay,l=new EventCollection(a.event);this.renderers=n.map((e=>new TreeRenderer(e,(()=>this.model),s.event,l,o)));for(let h of this.renderers)this.disposables.add(h);let d;o.keyboardNavigationLabelProvider&&(d=new TypeFilter(this,o.keyboardNavigationLabelProvider,o.filter),o=Object.assign(Object.assign({},o),{filter:d}),this.disposables.add(d)),this.focus=new Trait((()=>this.view.getFocusedElements()[0]),o.identityProvider),this.selection=new Trait((()=>this.view.getSelectedElements()[0]),o.identityProvider),this.anchor=new Trait((()=>this.view.getAnchorElement()),o.identityProvider),this.view=new TreeNodeList(e,t,r,this.renderers,this.focus,this.selection,this.anchor,Object.assign(Object.assign({},asListOptions((()=>this.model),o)),{tree:this})),this.model=this.createModel(e,this.view,o),s.input=this.model.onDidChangeCollapseState;const c=Event$1.forEach(this.model.onDidSplice,(e=>{this.eventBufferer.bufferEvents((()=>{this.focus.onDidModelSplice(e),this.selection.onDidModelSplice(e)}))}));if(c((()=>null),null,this.disposables),a.input=Event$1.chain(Event$1.any(c,this.focus.onDidChange,this.selection.onDidChange)).debounce((()=>null),0).map((()=>{const e=new Set;for(const t of this.focus.getNodes())e.add(t);for(const t of this.selection.getNodes())e.add(t);return[...e.values()]})).event,!1!==o.keyboardSupport){const e=Event$1.chain(this.view.onKeyDown).filter((e=>!isInputElement(e.target))).map((e=>new StandardKeyboardEvent(e)));e.filter((e=>15===e.keyCode)).on(this.onLeftArrow,this,this.disposables),e.filter((e=>17===e.keyCode)).on(this.onRightArrow,this,this.disposables),e.filter((e=>10===e.keyCode)).on(this.onSpace,this,this.disposables)}if(o.keyboardNavigationLabelProvider){const e=o.keyboardNavigationDelegate||DefaultKeyboardNavigationDelegate;this.typeFilterController=new TypeFilterController(this,this.model,this.view,d,e),this.focusNavigationFilter=e=>this.typeFilterController.shouldAllowFocus(e),this.disposables.add(this.typeFilterController)}this.styleElement=createStyleSheet(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return Event$1.map(this.view.onMouseDblClick,asTreeMouseEvent$1)}get onPointer(){return Event$1.map(this.view.onPointer,asTreeMouseEvent$1)}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return Event$1.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get expandOnDoubleClick(){return void 0===this._options.expandOnDoubleClick||this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return void 0===this._options.expandOnlyOnTwistieClick||this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}updateOptions(e={}){this._options=Object.assign(Object.assign({},this._options),e);for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(Object.assign(Object.assign({},this._options),{enableKeyboardNavigation:this._options.simpleKeyboardNavigation})),this.typeFilterController&&this.typeFilterController.updateOptions(this._options),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===RenderIndentGuides.Always)}get options(){return this._options}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}domFocus(){this.view.domFocus()}layout(e,t){this.view.layout(e,t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeIndentGuidesStroke.transparent(.4)}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`)),this.styleElement.textContent=i.join("\n"),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){const i=e.map((e=>this.model.getNode(e)));this.selection.set(i,t);const n=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setSelection(n,t,!0)}getSelection(){return this.selection.get()}setFocus(e,t){const i=e.map((e=>this.model.getNode(e)));this.focus.set(i,t);const n=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setFocus(n,t,!0)}focusNext(e=1,t=!1,i,n=this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);-1!==i&&this.view.reveal(i,t)}getRelativeTop(e){const t=this.model.getListIndex(e);return-1===t?null:this.view.getRelativeTop(t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const e=this.model.getParentNodeLocation(n);if(!e)return;const t=this.model.getListIndex(e);this.view.reveal(t),this.view.setFocus([t])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some((e=>e.visible)))return;const[e]=this.view.getFocus(),t=e+1;this.view.reveal(t),this.view.setFocus([t])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],n=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,o)}dispose(){dispose(this.disposables),this.view.dispose()}}class ObjectTreeModel{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new IndexTreeModel(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare:(e,t)=>i.sorter.compare(e.element,t.element)}),this.identityProvider=i.identityProvider}setChildren(e,t=Iterable.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=Iterable.empty(),i){const n=new Set,o=new Set;this.model.splice([...e,0],Number.MAX_VALUE,t,Object.assign(Object.assign({},i),{onDidCreateNode:e=>{var t;if(null===e.element)return;const r=e;if(n.add(r.element),this.nodes.set(r.element,r),this.identityProvider){const e=this.identityProvider.getId(r.element).toString();o.add(e),this.nodesByIdentity.set(e,r)}null===(t=i.onDidCreateNode)||void 0===t||t.call(i,r)},onDidDeleteNode:e=>{var t;if(null===e.element)return;const r=e;if(n.has(r.element)||this.nodes.delete(r.element),this.identityProvider){const e=this.identityProvider.getId(r.element).toString();o.has(e)||this.nodesByIdentity.delete(e)}null===(t=i.onDidDeleteNode)||void 0===t||t.call(i,r)}}))}preserveCollapseState(e=Iterable.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),Iterable.map(e,(e=>{let t=this.nodes.get(e.element);if(!t&&this.identityProvider){const i=this.identityProvider.getId(e.element).toString();t=this.nodesByIdentity.get(i)}if(!t)return Object.assign(Object.assign({},e),{children:this.preserveCollapseState(e.children)});const i="boolean"==typeof e.collapsible?e.collapsible:t.collapsible,n=void 0!==e.collapsed?e.collapsed:t.collapsed;return Object.assign(Object.assign({},e),{collapsible:i,collapsed:n,children:this.preserveCollapseState(e.children)})}))}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(null===e)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new TreeError(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(null===e)throw new TreeError(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new TreeError(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(null===e)return[];const t=this.nodes.get(e);if(!t)throw new TreeError(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function noCompress(e){return{element:{elements:[e.element],incompressible:e.incompressible||!1},children:Iterable.map(Iterable.from(e.children),noCompress),collapsible:e.collapsible,collapsed:e.collapsed}}function compress(e){const t=[e.element],i=e.incompressible||!1;let n,o;for(;[o,n]=Iterable.consume(Iterable.from(e.children),2),1===o.length&&!o[0].incompressible;)e=o[0],t.push(e.element);return{element:{elements:t,incompressible:i},children:Iterable.map(Iterable.concat(o,n),compress),collapsible:e.collapsible,collapsed:e.collapsed}}function _decompress(e,t=0){let i;return i=t<e.element.elements.length-1?[_decompress(e,t+1)]:Iterable.map(Iterable.from(e.children),(e=>_decompress(e,0))),0===t&&e.element.incompressible?{element:e.element.elements[t],children:i,incompressible:!0,collapsible:e.collapsible,collapsed:e.collapsed}:{element:e.element.elements[t],children:i,collapsible:e.collapsible,collapsed:e.collapsed}}function decompress(e){return _decompress(e,0)}function splice(e,t,i){return e.element===t?Object.assign(Object.assign({},e),{children:i}):Object.assign(Object.assign({},e),{children:Iterable.map(Iterable.from(e.children),(e=>splice(e,t,i)))})}const wrapIdentityProvider=e=>({getId:t=>t.elements.map((t=>e.getId(t).toString())).join("\0")});class CompressedObjectTreeModel{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new ObjectTreeModel(e,t,i),this.enabled=void 0===i.compressionEnabled||i.compressionEnabled,this.identityProvider=i.identityProvider}get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}setChildren(e,t=Iterable.empty(),i){const n=i.diffIdentityProvider&&wrapIdentityProvider(i.diffIdentityProvider);if(null===e){const e=Iterable.map(t,this.enabled?compress:noCompress);return void this._setChildren(null,e,{diffIdentityProvider:n,diffDepth:Infinity})}const o=this.nodes.get(e);if(!o)throw new Error("Unknown compressed tree node");const r=this.model.getNode(o),s=this.model.getParentNodeLocation(o),a=this.model.getNode(s),l=splice(decompress(r),e,t),d=(this.enabled?compress:noCompress)(l),c=a.children.map((e=>e===r?d:e));this._setChildren(a.element,c,{diffIdentityProvider:n,diffDepth:r.depth-a.depth})}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const t=this.model.getNode().children,i=Iterable.map(t,decompress),n=Iterable.map(i,e?compress:noCompress);this._setChildren(null,n,{diffIdentityProvider:this.identityProvider,diffDepth:Infinity})}_setChildren(e,t,i){const n=new Set;this.model.setChildren(e,t,Object.assign(Object.assign({},i),{onDidCreateNode:e=>{for(const t of e.element.elements)n.add(t),this.nodes.set(t,e.element)},onDidDeleteNode:e=>{for(const t of e.element.elements)n.has(t)||this.nodes.delete(t)}}))}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(void 0===e)return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return null===t?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return null===i?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(null===e)return null;const t=this.nodes.get(e);if(!t)throw new TreeError(this.user,`Tree element not found: ${e}`);return t}}const DefaultElementMapper=e=>e[e.length-1];class CompressedTreeNodeWrapper{constructor(e,t){this.unwrapper=e,this.node=t}get element(){return null===this.node.element?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map((e=>new CompressedTreeNodeWrapper(this.unwrapper,e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}function mapList(e,t){return{splice(i,n,o){t.splice(i,n,o.map((t=>e.map(t))))},updateElementHeight(e,i){t.updateElementHeight(e,i)}}}function mapOptions(e,t){return Object.assign(Object.assign({},t),{identityProvider:t.identityProvider&&{getId:i=>t.identityProvider.getId(e(i))},sorter:t.sorter&&{compare:(e,i)=>t.sorter.compare(e.elements[0],i.elements[0])},filter:t.filter&&{filter:(i,n)=>t.filter.filter(e(i),n)}})}class CompressibleObjectTreeModel{constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||DefaultElementMapper;const n=e=>this.elementMapper(e.elements);this.nodeMapper=new WeakMapper((e=>new CompressedTreeNodeWrapper(n,e))),this.model=new CompressedObjectTreeModel(e,mapList(this.nodeMapper,t),mapOptions(n,i))}get onDidSplice(){return Event$1.map(this.model.onDidSplice,(({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map((e=>this.nodeMapper.map(e))),deletedNodes:t.map((e=>this.nodeMapper.map(e)))})))}get onDidChangeCollapseState(){return Event$1.map(this.model.onDidChangeCollapseState,(({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t})))}get onDidChangeRenderNodeCount(){return Event$1.map(this.model.onDidChangeRenderNodeCount,(e=>this.nodeMapper.map(e)))}setChildren(e,t=Iterable.empty(),i={}){this.model.setChildren(e,t,i)}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return null==t?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var __decorate$1b=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s};class ObjectTree extends AbstractTree{constructor(e,t,i,n,o={}){super(e,t,i,n,o),this.user=e}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}setChildren(e,t=Iterable.empty(),i){this.model.setChildren(e,t,i)}rerender(e){void 0!==e?this.model.rerender(e):this.view.rerender()}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new ObjectTreeModel(e,t,i)}}class CompressibleRenderer{constructor(e,t){this._compressedTreeNodeProvider=e,this.renderer=t,this.templateId=t.templateId,t.onDidChangeTwistieState&&(this.onDidChangeTwistieState=t.onDidChangeTwistieState)}get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){const o=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element);1===o.element.elements.length?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=o,this.renderer.renderCompressedElements(o,t,i.data,n))}disposeElement(e,t,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(i.compressedTreeNode,t,i.data,n):this.renderer.disposeElement&&this.renderer.disposeElement(e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return!!this.renderer.renderTwistie&&this.renderer.renderTwistie(e,t)}}function asObjectTreeOptions$1(e,t){return t&&Object.assign(Object.assign({},t),{keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(i){let n;try{n=e().getCompressedTreeNode(i)}catch(o){return t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i)}return 1===n.element.elements.length?t.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(i):t.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(n.element.elements)}}})}__decorate$1b([memoize],CompressibleRenderer.prototype,"compressedTreeNodeProvider",null);class CompressibleObjectTree extends ObjectTree{constructor(e,t,i,n,o={}){const r=()=>this;super(e,t,i,n.map((e=>new CompressibleRenderer(r,e))),asObjectTreeOptions$1(r,o))}setChildren(e,t=Iterable.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new CompressibleObjectTreeModel(e,t,i)}updateOptions(e={}){super.updateOptions(e),void 0!==e.compressionEnabled&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}var __awaiter$O=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function createAsyncDataTreeNode(e){return Object.assign(Object.assign({},e),{children:[],refreshPromise:void 0,stale:!0,slow:!1,collapsedByDefault:void 0})}function isAncestor(e,t){return!!t.parent&&(t.parent===e||isAncestor(e,t.parent))}function intersects(e,t){return e===t||isAncestor(e,t)||isAncestor(t,e)}class AsyncDataTreeNodeWrapper{constructor(e){this.node=e}get element(){return this.node.element.element}get children(){return this.node.children.map((e=>new AsyncDataTreeNodeWrapper(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class AsyncDataTreeRenderer{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Codicon.treeItemLoading.classNamesArray),!0):(t.classList.remove(...Codicon.treeItemLoading.classNamesArray),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function asTreeEvent(e){return{browserEvent:e.browserEvent,elements:e.elements.map((e=>e.element))}}function asTreeMouseEvent(e){return{browserEvent:e.browserEvent,element:e.element&&e.element.element,target:e.target}}class AsyncDataTreeElementsDragAndDropData extends ElementsDragAndDropData{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function asAsyncDataTreeDragAndDropData(e){return e instanceof ElementsDragAndDropData?new AsyncDataTreeElementsDragAndDropData(e):e}class AsyncDataTreeNodeListDragAndDrop{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){this.dnd.onDragStart&&this.dnd.onDragStart(asAsyncDataTreeDragAndDropData(e),t)}onDragOver(e,t,i,n,o=!0){return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(e),t&&t.element,i,n)}drop(e,t,i,n){this.dnd.drop(asAsyncDataTreeDragAndDropData(e),t&&t.element,i,n)}onDragEnd(e){this.dnd.onDragEnd&&this.dnd.onDragEnd(e)}}function asObjectTreeOptions(e){return e&&Object.assign(Object.assign({},e),{collapseByDefault:!0,identityProvider:e.identityProvider&&{getId:t=>e.identityProvider.getId(t.element)},dnd:e.dnd&&new AsyncDataTreeNodeListDragAndDrop(e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent:t=>e.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({},t),{element:t.element})),isSelectionRangeChangeEvent:t=>e.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({},t),{element:t.element}))},accessibilityProvider:e.accessibilityProvider&&Object.assign(Object.assign({},e.accessibilityProvider),{getPosInSet:void 0,getSetSize:void 0,getRole:e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",isChecked:e.accessibilityProvider.isChecked?t=>{var i;return!!(null===(i=e.accessibilityProvider)||void 0===i?void 0:i.isChecked(t.element))}:void 0,getAriaLabel:t=>e.accessibilityProvider.getAriaLabel(t.element),getWidgetAriaLabel:()=>e.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider.getAriaLevel&&(t=>e.accessibilityProvider.getAriaLevel(t.element)),getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))}),filter:e.filter&&{filter:(t,i)=>e.filter.filter(t.element,i)},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},e.keyboardNavigationLabelProvider),{getKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}),sorter:void 0,expandOnlyOnTwistieClick:void 0===e.expandOnlyOnTwistieClick?void 0:"function"!=typeof e.expandOnlyOnTwistieClick?e.expandOnlyOnTwistieClick:t=>e.expandOnlyOnTwistieClick(t.element),additionalScrollHeight:e.additionalScrollHeight})}function dfs(e,t){t(e),e.children.forEach((e=>dfs(e,t)))}class AsyncDataTree{constructor(e,t,i,n,o,r={}){this.user=e,this.dataSource=o,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new Emitter$1,this._onDidChangeNodeSlowState=new Emitter$1,this.nodeMapper=new WeakMapper((e=>new AsyncDataTreeNodeWrapper(e))),this.disposables=new DisposableStore,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=void 0!==r.autoExpandSingleChildren&&r.autoExpandSingleChildren,this.sorter=r.sorter,this.collapseByDefault=r.collapseByDefault,this.tree=this.createTree(e,t,i,n,r),this.root=createAsyncDataTreeNode({element:void 0,parent:null,hasChildren:!0}),this.identityProvider&&(this.root=Object.assign(Object.assign({},this.root),{id:null})),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}get onDidChangeFocus(){return Event$1.map(this.tree.onDidChangeFocus,asTreeEvent)}get onDidChangeSelection(){return Event$1.map(this.tree.onDidChangeSelection,asTreeEvent)}get onMouseDblClick(){return Event$1.map(this.tree.onMouseDblClick,asTreeMouseEvent)}get onPointer(){return Event$1.map(this.tree.onPointer,asTreeMouseEvent)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidDispose(){return this.tree.onDidDispose}createTree(e,t,i,n,o){const r=new ComposedTreeDelegate(i),s=n.map((e=>new AsyncDataTreeRenderer(e,this.nodeMapper,this._onDidChangeNodeSlowState.event))),a=asObjectTreeOptions(o)||{};return new ObjectTree(e,t,r,s,a)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}setInput(e,t){return __awaiter$O(this,void 0,void 0,(function*(){this.refreshPromises.forEach((e=>e.cancel())),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};yield this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&"number"==typeof t.scrollTop&&(this.scrollTop=t.scrollTop)}))}_updateChildren(e=this.root.element,t=!0,i=!1,n,o){return __awaiter$O(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Event$1.toPromise(this._onDidRender.event));const r=this.getDataNode(e);if(yield this.refreshAndRenderNode(r,t,n,o),i)try{this.tree.rerender(r)}catch(s){}}))}rerender(e){if(void 0===e||e===this.root.element)return void this.tree.rerender();const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}expand(e,t=!1){return __awaiter$O(this,void 0,void 0,(function*(){if(void 0===this.root.element)throw new TreeError(this.user,"Tree input not set");this.root.refreshPromise&&(yield this.root.refreshPromise,yield Event$1.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i))return!1;if(i.refreshPromise&&(yield this.root.refreshPromise,yield Event$1.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(yield this.root.refreshPromise,yield Event$1.toPromise(this._onDidRender.event)),n}))}setSelection(e,t){const i=e.map((e=>this.getDataNode(e)));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map((e=>e.element))}setFocus(e,t){const i=e.map((e=>this.getDataNode(e)));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map((e=>e.element))}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new TreeError(this.user,`Data tree node not found: ${e}`);return t}refreshAndRenderNode(e,t,i,n){return __awaiter$O(this,void 0,void 0,(function*(){yield this.refreshNode(e,t,i),this.render(e,i,n)}))}refreshNode(e,t,i){return __awaiter$O(this,void 0,void 0,(function*(){let n;return this.subTreeRefreshPromises.forEach(((o,r)=>{!n&&intersects(r,e)&&(n=o.then((()=>this.refreshNode(e,t,i))))})),n||this.doRefreshSubTree(e,t,i)}))}doRefreshSubTree(e,t,i){return __awaiter$O(this,void 0,void 0,(function*(){let n;e.refreshPromise=new Promise((e=>n=e)),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally((()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}));try{const o=yield this.doRefreshNode(e,t,i);e.stale=!1,yield Promises.settled(o.map((e=>this.doRefreshSubTree(e,t,i))))}finally{n()}}))}doRefreshNode(e,t,i){return __awaiter$O(this,void 0,void 0,(function*(){let n;if(e.hasChildren=!!this.dataSource.hasChildren(e.element),e.hasChildren){const t=this.doGetChildren(e);if(isIterable(t))n=Promise.resolve(t);else{const i=timeout(800);i.then((()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)}),(e=>null)),n=t.finally((()=>i.cancel()))}}else n=Promise.resolve(Iterable.empty());try{const o=yield n;return this.setChildren(e,o,t,i)}catch(o){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),isCancellationError(o))return[];throw o}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}))}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return isIterable(i)?this.processChildren(i):(t=createCancelablePromise((()=>__awaiter$O(this,void 0,void 0,(function*(){return this.processChildren(yield i)})))),this.refreshPromises.set(e,t),t.finally((()=>{this.refreshPromises.delete(e)})))}_onDidChangeCollapseState({node:e,deep:t}){null!==e.element&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(onUnexpectedError))}setChildren(e,t,i,n){const o=[...t];if(0===e.children.length&&0===o.length)return[];const r=new Map,s=new Map;for(const d of e.children)if(r.set(d.element,d),this.identityProvider){const e=this.tree.isCollapsed(d);s.set(d.id,{node:d,collapsed:e})}const a=[],l=o.map((t=>{const o=!!this.dataSource.hasChildren(t);if(!this.identityProvider){const i=createAsyncDataTreeNode({element:t,parent:e,hasChildren:o});return o&&this.collapseByDefault&&!this.collapseByDefault(t)&&(i.collapsedByDefault=!1,a.push(i)),i}const l=this.identityProvider.getId(t).toString(),d=s.get(l);if(d){const e=d.node;return r.delete(e.element),this.nodes.delete(e.element),this.nodes.set(t,e),e.element=t,e.hasChildren=o,i?d.collapsed?(e.children.forEach((e=>dfs(e,(e=>this.nodes.delete(e.element))))),e.children.splice(0,e.children.length),e.stale=!0):a.push(e):o&&this.collapseByDefault&&!this.collapseByDefault(t)&&(e.collapsedByDefault=!1,a.push(e)),e}const c=createAsyncDataTreeNode({element:t,parent:e,id:l,hasChildren:o});return n&&n.viewState.focus&&n.viewState.focus.indexOf(l)>-1&&n.focus.push(c),n&&n.viewState.selection&&n.viewState.selection.indexOf(l)>-1&&n.selection.push(c),n&&n.viewState.expanded&&n.viewState.expanded.indexOf(l)>-1?a.push(c):o&&this.collapseByDefault&&!this.collapseByDefault(t)&&(c.collapsedByDefault=!1,a.push(c)),c}));for(const d of r.values())dfs(d,(e=>this.nodes.delete(e.element)));for(const d of l)this.nodes.set(d.element,d);return e.children.splice(0,e.children.length,...l),e!==this.root&&this.autoExpandSingleChildren&&1===l.length&&0===a.length&&(l[0].collapsedByDefault=!1,a.push(l[0])),a}render(e,t,i){const n=e.children.map((e=>this.asTreeElement(e,t))),o=i&&Object.assign(Object.assign({},i),{diffIdentityProvider:i.diffIdentityProvider&&{getId:e=>i.diffIdentityProvider.getId(e.element)}});this.tree.setChildren(e===this.root?null:e,n,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return i=!(t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1)&&e.collapsedByDefault,e.collapsedByDefault=void 0,{element:e,children:e.hasChildren?Iterable.map(e.children,(e=>this.asTreeElement(e,t))):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose()}}class CompressibleAsyncDataTreeNodeWrapper{constructor(e){this.node=e}get element(){return{elements:this.node.element.elements.map((e=>e.element)),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map((e=>new CompressibleAsyncDataTreeNodeWrapper(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}}class CompressibleAsyncDataTreeRenderer{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...Codicon.treeItemLoading.classNamesArray),!0):(t.classList.remove(...Codicon.treeItemLoading.classNamesArray),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement&&this.renderer.disposeElement(this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){this.renderer.disposeCompressedElements&&this.renderer.disposeCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=dispose(this.disposables)}}function asCompressibleObjectTreeOptions(e){const t=e&&asObjectTreeOptions(e);return t&&Object.assign(Object.assign({},t),{keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&Object.assign(Object.assign({},t.keyboardNavigationLabelProvider),{getCompressedNodeKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map((e=>e.element)))})})}class CompressibleAsyncDataTree extends AsyncDataTree{constructor(e,t,i,n,o,r,s={}){super(e,t,i,o,r,s),this.compressionDelegate=n,this.compressibleNodeMapper=new WeakMapper((e=>new CompressibleAsyncDataTreeNodeWrapper(e))),this.filter=s.filter}createTree(e,t,i,n,o){const r=new ComposedTreeDelegate(i),s=n.map((e=>new CompressibleAsyncDataTreeRenderer(e,this.nodeMapper,(()=>this.compressibleNodeMapper),this._onDidChangeNodeSlowState.event))),a=asCompressibleObjectTreeOptions(o)||{};return new CompressibleObjectTree(e,t,r,s,a)}asTreeElement(e,t){return Object.assign({incompressible:this.compressionDelegate.isIncompressible(e.element)},super.asTreeElement(e,t))}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t){if(!this.identityProvider)return super.render(e,t);const i=e=>this.identityProvider.getId(e).toString(),n=e=>{const t=new Set;for(const n of e){const e=this.tree.getCompressedTreeNode(n===this.root?null:n);if(e.element)for(const n of e.element.elements)t.add(i(n.element))}return t},o=n(this.tree.getSelection()),r=n(this.tree.getFocus());super.render(e,t);const s=this.getSelection();let a=!1;const l=this.getFocus();let d=!1;const c=e=>{const t=e.element;if(t)for(let n=0;n<t.elements.length;n++){const e=i(t.elements[n].element),c=t.elements[t.elements.length-1].element;o.has(e)&&-1===s.indexOf(c)&&(s.push(c),a=!0),r.has(e)&&-1===l.indexOf(c)&&(l.push(c),d=!0)}e.children.forEach(c)};c(this.tree.getCompressedTreeNode(e===this.root?null:e)),a&&this.setSelection(s),d&&this.setFocus(l)}processChildren(e){return this.filter&&(e=Iterable.filter(e,(e=>{const t=getVisibility(this.filter.filter(e,1));if(2===t)throw new Error("Recursive tree visibility not supported in async data compressed trees");return 1===t}))),super.processChildren(e)}}function getVisibility(e){return"boolean"==typeof e?e?1:0:isFilterResult(e)?getVisibleState(e.visibility):getVisibleState(e)}class DataTree extends AbstractTree{constructor(e,t,i,n,o,r={}){super(e,t,i,n,r),this.user=e,this.dataSource=o,this.identityProvider=r.identityProvider}createModel(e,t,i){return new ObjectTreeModel(e,t,i)}}new RawContextKey("isMac",isMacintosh,localize("isMac","Whether the operating system is macOS")),new RawContextKey("isLinux",isLinux,localize("isLinux","Whether the operating system is Linux"));const IsWindowsContext=new RawContextKey("isWindows",isWindows,localize("isWindows","Whether the operating system is Windows"));new RawContextKey("isWeb",isWeb,localize("isWeb","Whether the platform is a web browser")),new RawContextKey("isMacNative",isMacintosh&&!isWeb,localize("isMacNative","Whether the operating system is macOS on a non-browser platform")),new RawContextKey("isIOS",isIOS,localize("isIOS","Whether the operating system is iOS")),new RawContextKey("isDevelopment",!1,!0);const InputFocusedContextKey="inputFocus";function computeStyles(e,t){const i=Object.create(null);for(let n in t){const o=t[n];o&&(i[n]=resolveColorValue(o,e))}return i}function attachStyler(e,t,i){function n(){const n=computeStyles(e.getColorTheme(),t);"function"==typeof i?i(n):i.style(n)}return n(),e.onDidColorThemeChange(n)}function attachBadgeStyler(e,t,i){return attachStyler(t,{badgeBackground:(null==i?void 0:i.badgeBackground)||badgeBackground,badgeForeground:(null==i?void 0:i.badgeForeground)||badgeForeground,badgeBorder:contrastBorder},e)}function attachListStyler(e,t,i){return attachStyler(t,Object.assign(Object.assign({},defaultListStyles),i||{}),e)}new RawContextKey(InputFocusedContextKey,!1,localize("inputFocus","Whether keyboard focus is inside an input box"));const defaultListStyles={listFocusBackground:listFocusBackground,listFocusForeground:listFocusForeground,listFocusOutline:listFocusOutline,listActiveSelectionBackground:listActiveSelectionBackground,listActiveSelectionForeground:listActiveSelectionForeground,listActiveSelectionIconForeground:listActiveSelectionIconForeground,listFocusAndSelectionBackground:listActiveSelectionBackground,listFocusAndSelectionForeground:listActiveSelectionForeground,listInactiveSelectionBackground:listInactiveSelectionBackground,listInactiveSelectionIconForeground:listInactiveSelectionIconForeground,listInactiveSelectionForeground:listInactiveSelectionForeground,listInactiveFocusBackground:listInactiveFocusBackground,listInactiveFocusOutline:listInactiveFocusOutline,listHoverBackground:listHoverBackground,listHoverForeground:listHoverForeground,listDropBackground:listDropBackground,listSelectionOutline:activeContrastBorder,listHoverOutline:activeContrastBorder,listFilterWidgetBackground:listFilterWidgetBackground,listFilterWidgetOutline:listFilterWidgetOutline,listFilterWidgetNoMatchesOutline:listFilterWidgetNoMatchesOutline,listMatchesShadow:widgetShadow,treeIndentGuidesStroke:treeIndentGuidesStroke,tableColumnsBorder:tableColumnsBorder,tableOddRowsBackgroundColor:tableOddRowsBackgroundColor},defaultMenuStyles={shadowColor:widgetShadow,borderColor:menuBorder,foregroundColor:menuForeground,backgroundColor:menuBackground,selectionForegroundColor:menuSelectionForeground,selectionBackgroundColor:menuSelectionBackground,selectionBorderColor:menuSelectionBorder,separatorColor:menuSeparatorBackground,scrollbarShadow:scrollbarShadow,scrollbarSliderBackground:scrollbarSliderBackground,scrollbarSliderHoverBackground:scrollbarSliderHoverBackground,scrollbarSliderActiveBackground:scrollbarSliderActiveBackground};function attachMenuStyler(e,t,i){return attachStyler(t,Object.assign(Object.assign({},defaultMenuStyles),i),e)}var __decorate$1a=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$19=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const IListService=createDecorator("listService");let ListService=class{constructor(e){this._themeService=e,this.disposables=new DisposableStore,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}get lastFocusedList(){return this._lastFocusedWidget}setLastFocusedList(e){var t,i;e!==this._lastFocusedWidget&&(null===(t=this._lastFocusedWidget)||void 0===t||t.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,null===(i=this._lastFocusedWidget)||void 0===i||i.getHTMLElement().classList.add("last-focused"))}register(e,t){if(!this._hasCreatedStyleController){this._hasCreatedStyleController=!0;const e=new DefaultStyleController(createStyleSheet(),"");this.disposables.add(attachListStyler(e,this._themeService))}if(this.lists.some((t=>t.widget===e)))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),e.getHTMLElement()===document.activeElement&&this.setLastFocusedList(e),combinedDisposable(e.onDidFocus((()=>this.setLastFocusedList(e))),toDisposable((()=>this.lists.splice(this.lists.indexOf(i),1))),e.onDidDispose((()=>{this.lists=this.lists.filter((e=>e!==i)),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)})))}dispose(){this.disposables.dispose()}};ListService=__decorate$1a([__param$19(0,IThemeService)],ListService);const RawWorkbenchListFocusContextKey=new RawContextKey("listFocus",!0),WorkbenchListSupportsMultiSelectContextKey=new RawContextKey("listSupportsMultiselect",!0),WorkbenchListFocusContextKey=ContextKeyExpr.and(RawWorkbenchListFocusContextKey,ContextKeyExpr.not(InputFocusedContextKey)),WorkbenchListHasSelectionOrFocus=new RawContextKey("listHasSelectionOrFocus",!1),WorkbenchListDoubleSelection=new RawContextKey("listDoubleSelection",!1),WorkbenchListMultiSelection=new RawContextKey("listMultiSelection",!1),WorkbenchListSelectionNavigation=new RawContextKey("listSelectionNavigation",!1),WorkbenchTreeElementCanCollapse=new RawContextKey("treeElementCanCollapse",!1),WorkbenchTreeElementHasParent=new RawContextKey("treeElementHasParent",!1),WorkbenchTreeElementCanExpand=new RawContextKey("treeElementCanExpand",!1),WorkbenchTreeElementHasChild=new RawContextKey("treeElementHasChild",!1),WorkbenchListAutomaticKeyboardNavigationKey="listAutomaticKeyboardNavigation";function createScopedContextKeyService(e,t){const i=e.createScoped(t.getHTMLElement());return RawWorkbenchListFocusContextKey.bindTo(i),i}const multiSelectModifierSettingKey="workbench.list.multiSelectModifier",openModeSettingKey="workbench.list.openMode",horizontalScrollingKey="workbench.list.horizontalScrolling",keyboardNavigationSettingKey="workbench.list.keyboardNavigation",automaticKeyboardNavigationSettingKey="workbench.list.automaticKeyboardNavigation",treeIndentKey="workbench.tree.indent",treeRenderIndentGuidesKey="workbench.tree.renderIndentGuides",listSmoothScrolling="workbench.list.smoothScrolling",mouseWheelScrollSensitivityKey="workbench.list.mouseWheelScrollSensitivity",fastScrollSensitivityKey="workbench.list.fastScrollSensitivity",treeExpandMode="workbench.tree.expandMode";function useAltAsMultipleSelectionModifier(e){return"alt"===e.getValue(multiSelectModifierSettingKey)}class MultipleSelectionController extends Disposable{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration(multiSelectModifierSettingKey)&&(this.useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(this.configurationService))})))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:isSelectionSingleChangeEvent(e)}isSelectionRangeChangeEvent(e){return isSelectionRangeChangeEvent(e)}}function toWorkbenchListOptions(e,t,i){var n;const o=new DisposableStore;return[Object.assign(Object.assign({},e),{keyboardNavigationDelegate:{mightProducePrintableCharacter:e=>i.mightProducePrintableCharacter(e)},smoothScrolling:Boolean(t.getValue(listSmoothScrolling)),mouseWheelScrollSensitivity:t.getValue(mouseWheelScrollSensitivityKey),fastScrollSensitivity:t.getValue(fastScrollSensitivityKey),multipleSelectionController:null!==(n=e.multipleSelectionController)&&void 0!==n?n:o.add(new MultipleSelectionController(t))}),o]}let WorkbenchList=class extends List{constructor(e,t,i,n,o,r,s,a,l,d){const c=void 0!==o.horizontalScrolling?o.horizontalScrolling:Boolean(l.getValue(horizontalScrollingKey)),[h,u]=toWorkbenchListOptions(o,l,d);super(e,t,i,n,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},computeStyles(a.getColorTheme(),defaultListStyles)),h),{horizontalScrolling:c})),this.disposables.add(u),this.contextKeyService=createScopedContextKeyService(r,this),this.themeService=a,this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==o.multipleSelectionSupport);WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(o.selectionNavigation)),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=o.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(l),this.disposables.add(this.contextKeyService),this.disposables.add(s.register(this)),o.overrideStyles&&this.updateStyles(o.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const e=this.getSelection(),t=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(e.length>0||t.length>0),this.listMultiSelection.set(e.length>1),this.listDoubleSelection.set(2===e.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const e=this.getSelection(),t=this.getFocus();this.listHasSelectionOrFocus.set(e.length>0||t.length>0)}))),this.disposables.add(l.onDidChangeConfiguration((e=>{e.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(l));let t={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const e=Boolean(l.getValue(horizontalScrollingKey));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(listSmoothScrolling)){const e=Boolean(l.getValue(listSmoothScrolling));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const e=l.getValue(mouseWheelScrollSensitivityKey);t=Object.assign(Object.assign({},t),{mouseWheelScrollSensitivity:e})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const e=l.getValue(fastScrollSensitivityKey);t=Object.assign(Object.assign({},t),{fastScrollSensitivity:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService:l},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=attachListStyler(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),super.dispose()}};WorkbenchList=__decorate$1a([__param$19(5,IContextKeyService),__param$19(6,IListService),__param$19(7,IThemeService),__param$19(8,IConfigurationService),__param$19(9,IKeybindingService)],WorkbenchList);let WorkbenchPagedList=class extends PagedList{constructor(e,t,i,n,o,r,s,a,l,d){const c=void 0!==o.horizontalScrolling?o.horizontalScrolling:Boolean(l.getValue(horizontalScrollingKey)),[h,u]=toWorkbenchListOptions(o,l,d);super(e,t,i,n,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},computeStyles(a.getColorTheme(),defaultListStyles)),h),{horizontalScrolling:c})),this.disposables=new DisposableStore,this.disposables.add(u),this.contextKeyService=createScopedContextKeyService(r,this),this.themeService=a,this.horizontalScrolling=o.horizontalScrolling,this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==o.multipleSelectionSupport);WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(o.selectionNavigation)),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(l),this.disposables.add(this.contextKeyService),this.disposables.add(s.register(this)),o.overrideStyles&&this.updateStyles(o.overrideStyles),o.overrideStyles&&this.disposables.add(attachListStyler(this,a,o.overrideStyles)),this.disposables.add(l.onDidChangeConfiguration((e=>{e.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(l));let t={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const e=Boolean(l.getValue(horizontalScrollingKey));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(listSmoothScrolling)){const e=Boolean(l.getValue(listSmoothScrolling));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const e=l.getValue(mouseWheelScrollSensitivityKey);t=Object.assign(Object.assign({},t),{mouseWheelScrollSensitivity:e})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const e=l.getValue(fastScrollSensitivityKey);t=Object.assign(Object.assign({},t),{fastScrollSensitivity:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new ListResourceNavigator(this,Object.assign({configurationService:l},o)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=attachListStyler(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),this.disposables.dispose(),super.dispose()}};WorkbenchPagedList=__decorate$1a([__param$19(5,IContextKeyService),__param$19(6,IListService),__param$19(7,IThemeService),__param$19(8,IConfigurationService),__param$19(9,IKeybindingService)],WorkbenchPagedList);let WorkbenchTable=class extends Table{constructor(e,t,i,n,o,r,s,a,l,d,c){const h=void 0!==r.horizontalScrolling?r.horizontalScrolling:Boolean(d.getValue(horizontalScrollingKey)),[u,g]=toWorkbenchListOptions(r,d,c);super(e,t,i,n,o,Object.assign(Object.assign(Object.assign({keyboardSupport:!1},computeStyles(l.getColorTheme(),defaultListStyles)),u),{horizontalScrolling:h})),this.disposables.add(g),this.contextKeyService=createScopedContextKeyService(s,this),this.themeService=l,this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==r.multipleSelectionSupport);WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(r.selectionNavigation)),this.listHasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.listDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.listMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(d),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),r.overrideStyles&&this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection((()=>{const e=this.getSelection(),t=this.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.listHasSelectionOrFocus.set(e.length>0||t.length>0),this.listMultiSelection.set(e.length>1),this.listDoubleSelection.set(2===e.length)}))}))),this.disposables.add(this.onDidChangeFocus((()=>{const e=this.getSelection(),t=this.getFocus();this.listHasSelectionOrFocus.set(e.length>0||t.length>0)}))),this.disposables.add(d.onDidChangeConfiguration((e=>{e.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(d));let t={};if(e.affectsConfiguration(horizontalScrollingKey)&&void 0===this.horizontalScrolling){const e=Boolean(d.getValue(horizontalScrollingKey));t=Object.assign(Object.assign({},t),{horizontalScrolling:e})}if(e.affectsConfiguration(listSmoothScrolling)){const e=Boolean(d.getValue(listSmoothScrolling));t=Object.assign(Object.assign({},t),{smoothScrolling:e})}if(e.affectsConfiguration(mouseWheelScrollSensitivityKey)){const e=d.getValue(mouseWheelScrollSensitivityKey);t=Object.assign(Object.assign({},t),{mouseWheelScrollSensitivity:e})}if(e.affectsConfiguration(fastScrollSensitivityKey)){const e=d.getValue(fastScrollSensitivityKey);t=Object.assign(Object.assign({},t),{fastScrollSensitivity:e})}Object.keys(t).length>0&&this.updateOptions(t)}))),this.navigator=new TableResourceNavigator(this,Object.assign({configurationService:d},r)),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles&&this.updateStyles(e.overrideStyles),void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){var t;null===(t=this._styler)||void 0===t||t.dispose(),this._styler=attachListStyler(this,this.themeService,e)}dispose(){var e;null===(e=this._styler)||void 0===e||e.dispose(),this.disposables.dispose(),super.dispose()}};WorkbenchTable=__decorate$1a([__param$19(6,IContextKeyService),__param$19(7,IListService),__param$19(8,IThemeService),__param$19(9,IConfigurationService),__param$19(10,IKeybindingService)],WorkbenchTable);class ResourceNavigator extends Disposable{constructor(e,t){var i;super(),this.widget=e,this._onDidOpen=this._register(new Emitter$1),this.onDidOpen=this._onDidOpen.event,this._register(Event$1.filter(this.widget.onDidChangeSelection,(e=>e.browserEvent instanceof KeyboardEvent))((e=>this.onSelectionFromKeyboard(e)))),this._register(this.widget.onPointer((e=>this.onPointer(e.element,e.browserEvent)))),this._register(this.widget.onMouseDblClick((e=>this.onMouseDblClick(e.element,e.browserEvent)))),"boolean"!=typeof(null==t?void 0:t.openOnSingleClick)&&(null==t?void 0:t.configurationService)?(this.openOnSingleClick="doubleClick"!==(null==t?void 0:t.configurationService.getValue(openModeSettingKey)),this._register(null==t?void 0:t.configurationService.onDidChangeConfiguration((()=>{this.openOnSingleClick="doubleClick"!==(null==t?void 0:t.configurationService.getValue(openModeSettingKey))})))):this.openOnSingleClick=null===(i=null==t?void 0:t.openOnSingleClick)||void 0===i||i}onSelectionFromKeyboard(e){if(1!==e.elements.length)return;const t=e.browserEvent,i="boolean"!=typeof t.preserveFocus||t.preserveFocus,n="boolean"==typeof t.pinned?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick)return;if(2===t.detail)return;const i=1===t.button,n=t.ctrlKey||t.metaKey||t.altKey;this._open(e,!0,i,n,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const n=t.ctrlKey||t.metaKey||t.altKey;this._open(e,!1,!0,n,t)}_open(e,t,i,n,o){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:o})}}class ListResourceNavigator extends ResourceNavigator{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TableResourceNavigator extends ResourceNavigator{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class TreeResourceNavigator extends ResourceNavigator{constructor(e,t){super(e,t)}getSelectedElement(){var e;return null!==(e=this.widget.getSelection()[0])&&void 0!==e?e:void 0}}function createKeyboardNavigationEventFilter(e,t){let i=!1;return n=>{if(n.toKeybinding().isModifierKey())return!1;if(i)return i=!1,!1;const o=t.softDispatch(n,e);return o&&o.enterChord?(i=!0,!1):(i=!1,!0)}}let WorkbenchObjectTree=class extends ObjectTree{constructor(e,t,i,n,o,r,s,a,l,d,c){const{options:h,getAutomaticKeyboardNavigation:u,disposable:g}=workbenchTreeDataPreamble(t,o,r,l,d,c);super(e,t,i,n,h),this.disposables.add(g),this.internals=new WorkbenchTreeInternals(this,o,u,o.overrideStyles,r,s,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};WorkbenchObjectTree=__decorate$1a([__param$19(5,IContextKeyService),__param$19(6,IListService),__param$19(7,IThemeService),__param$19(8,IConfigurationService),__param$19(9,IKeybindingService),__param$19(10,IAccessibilityService)],WorkbenchObjectTree);let WorkbenchCompressibleObjectTree=class extends CompressibleObjectTree{constructor(e,t,i,n,o,r,s,a,l,d,c){const{options:h,getAutomaticKeyboardNavigation:u,disposable:g}=workbenchTreeDataPreamble(t,o,r,l,d,c);super(e,t,i,n,h),this.disposables.add(g),this.internals=new WorkbenchTreeInternals(this,o,u,o.overrideStyles,r,s,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};WorkbenchCompressibleObjectTree=__decorate$1a([__param$19(5,IContextKeyService),__param$19(6,IListService),__param$19(7,IThemeService),__param$19(8,IConfigurationService),__param$19(9,IKeybindingService),__param$19(10,IAccessibilityService)],WorkbenchCompressibleObjectTree);let WorkbenchDataTree=class extends DataTree{constructor(e,t,i,n,o,r,s,a,l,d,c,h){const{options:u,getAutomaticKeyboardNavigation:g,disposable:p}=workbenchTreeDataPreamble(t,r,s,d,c,h);super(e,t,i,n,o,u),this.disposables.add(p),this.internals=new WorkbenchTreeInternals(this,r,g,r.overrideStyles,s,a,l,d,h),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};WorkbenchDataTree=__decorate$1a([__param$19(6,IContextKeyService),__param$19(7,IListService),__param$19(8,IThemeService),__param$19(9,IConfigurationService),__param$19(10,IKeybindingService),__param$19(11,IAccessibilityService)],WorkbenchDataTree);let WorkbenchAsyncDataTree=class extends AsyncDataTree{constructor(e,t,i,n,o,r,s,a,l,d,c,h){const{options:u,getAutomaticKeyboardNavigation:g,disposable:p}=workbenchTreeDataPreamble(t,r,s,d,c,h);super(e,t,i,n,o,u),this.disposables.add(p),this.internals=new WorkbenchTreeInternals(this,r,g,r.overrideStyles,s,a,l,d,h),this.disposables.add(this.internals)}get onDidOpen(){return this.internals.onDidOpen}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};WorkbenchAsyncDataTree=__decorate$1a([__param$19(6,IContextKeyService),__param$19(7,IListService),__param$19(8,IThemeService),__param$19(9,IConfigurationService),__param$19(10,IKeybindingService),__param$19(11,IAccessibilityService)],WorkbenchAsyncDataTree);let WorkbenchCompressibleAsyncDataTree=class extends CompressibleAsyncDataTree{constructor(e,t,i,n,o,r,s,a,l,d,c,h,u){const{options:g,getAutomaticKeyboardNavigation:p,disposable:m}=workbenchTreeDataPreamble(t,s,a,c,h,u);super(e,t,i,n,o,r,g),this.disposables.add(m),this.internals=new WorkbenchTreeInternals(this,s,p,s.overrideStyles,a,l,d,c,u),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};function workbenchTreeDataPreamble(e,t,i,n,o,r){var s;const a=()=>{let e=Boolean(i.getContextKeyValue(WorkbenchListAutomaticKeyboardNavigationKey));return e&&(e=Boolean(n.getValue(automaticKeyboardNavigationSettingKey))),e},l=r.isScreenReaderOptimized(),d=t.simpleKeyboardNavigation||l?"simple":n.getValue(keyboardNavigationSettingKey),c=void 0!==t.horizontalScrolling?t.horizontalScrolling:Boolean(n.getValue(horizontalScrollingKey)),[h,u]=toWorkbenchListOptions(t,n,o),g=t.additionalScrollHeight;return{getAutomaticKeyboardNavigation:a,disposable:u,options:Object.assign(Object.assign({keyboardSupport:!1},h),{indent:"number"==typeof n.getValue(treeIndentKey)?n.getValue(treeIndentKey):void 0,renderIndentGuides:n.getValue(treeRenderIndentGuidesKey),smoothScrolling:Boolean(n.getValue(listSmoothScrolling)),automaticKeyboardNavigation:a(),simpleKeyboardNavigation:"simple"===d,filterOnType:"filter"===d,horizontalScrolling:c,keyboardNavigationEventFilter:createKeyboardNavigationEventFilter(e,o),additionalScrollHeight:g,hideTwistiesOfChildlessElements:t.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:null!==(s=t.expandOnlyOnTwistieClick)&&void 0!==s?s:"doubleClick"===n.getValue(treeExpandMode)})}}WorkbenchCompressibleAsyncDataTree=__decorate$1a([__param$19(7,IContextKeyService),__param$19(8,IListService),__param$19(9,IThemeService),__param$19(10,IConfigurationService),__param$19(11,IKeybindingService),__param$19(12,IAccessibilityService)],WorkbenchCompressibleAsyncDataTree);let WorkbenchTreeInternals=class{constructor(e,t,i,n,o,r,s,a,l){this.tree=e,this.themeService=s,this.disposables=[],this.contextKeyService=createScopedContextKeyService(o,e),this.listSupportsMultiSelect=WorkbenchListSupportsMultiSelectContextKey.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(!1!==t.multipleSelectionSupport);WorkbenchListSelectionNavigation.bindTo(this.contextKeyService).set(Boolean(t.selectionNavigation)),this.hasSelectionOrFocus=WorkbenchListHasSelectionOrFocus.bindTo(this.contextKeyService),this.hasDoubleSelection=WorkbenchListDoubleSelection.bindTo(this.contextKeyService),this.hasMultiSelection=WorkbenchListMultiSelection.bindTo(this.contextKeyService),this.treeElementCanCollapse=WorkbenchTreeElementCanCollapse.bindTo(this.contextKeyService),this.treeElementHasParent=WorkbenchTreeElementHasParent.bindTo(this.contextKeyService),this.treeElementCanExpand=WorkbenchTreeElementCanExpand.bindTo(this.contextKeyService),this.treeElementHasChild=WorkbenchTreeElementHasChild.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(a);const d=new Set;d.add(WorkbenchListAutomaticKeyboardNavigationKey);const c=()=>{const t=l.isScreenReaderOptimized()?"simple":a.getValue(keyboardNavigationSettingKey);e.updateOptions({simpleKeyboardNavigation:"simple"===t,filterOnType:"filter"===t})};this.updateStyleOverrides(n);const h=()=>{const t=e.getFocus()[0];if(!t)return;const i=e.getNode(t);this.treeElementCanCollapse.set(i.collapsible&&!i.collapsed),this.treeElementHasParent.set(!!e.getParentElement(t)),this.treeElementCanExpand.set(i.collapsible&&i.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(t))};this.disposables.push(this.contextKeyService,r.register(e),e.onDidChangeSelection((()=>{const t=e.getSelection(),i=e.getFocus();this.contextKeyService.bufferChangeEvents((()=>{this.hasSelectionOrFocus.set(t.length>0||i.length>0),this.hasMultiSelection.set(t.length>1),this.hasDoubleSelection.set(2===t.length)}))})),e.onDidChangeFocus((()=>{const t=e.getSelection(),i=e.getFocus();this.hasSelectionOrFocus.set(t.length>0||i.length>0),h()})),e.onDidChangeCollapseState(h),e.onDidChangeModel(h),a.onDidChangeConfiguration((n=>{let o={};if(n.affectsConfiguration(multiSelectModifierSettingKey)&&(this._useAltAsMultipleSelectionModifier=useAltAsMultipleSelectionModifier(a)),n.affectsConfiguration(treeIndentKey)){const e=a.getValue(treeIndentKey);o=Object.assign(Object.assign({},o),{indent:e})}if(n.affectsConfiguration(treeRenderIndentGuidesKey)){const e=a.getValue(treeRenderIndentGuidesKey);o=Object.assign(Object.assign({},o),{renderIndentGuides:e})}if(n.affectsConfiguration(listSmoothScrolling)){const e=Boolean(a.getValue(listSmoothScrolling));o=Object.assign(Object.assign({},o),{smoothScrolling:e})}if(n.affectsConfiguration(keyboardNavigationSettingKey)&&c(),n.affectsConfiguration(automaticKeyboardNavigationSettingKey)&&(o=Object.assign(Object.assign({},o),{automaticKeyboardNavigation:i()})),n.affectsConfiguration(horizontalScrollingKey)&&void 0===t.horizontalScrolling){const e=Boolean(a.getValue(horizontalScrollingKey));o=Object.assign(Object.assign({},o),{horizontalScrolling:e})}if(n.affectsConfiguration(treeExpandMode)&&void 0===t.expandOnlyOnTwistieClick&&(o=Object.assign(Object.assign({},o),{expandOnlyOnTwistieClick:"doubleClick"===a.getValue(treeExpandMode)})),n.affectsConfiguration(mouseWheelScrollSensitivityKey)){const e=a.getValue(mouseWheelScrollSensitivityKey);o=Object.assign(Object.assign({},o),{mouseWheelScrollSensitivity:e})}if(n.affectsConfiguration(fastScrollSensitivityKey)){const e=a.getValue(fastScrollSensitivityKey);o=Object.assign(Object.assign({},o),{fastScrollSensitivity:e})}Object.keys(o).length>0&&e.updateOptions(o)})),this.contextKeyService.onDidChangeContext((t=>{t.affectsSome(d)&&e.updateOptions({automaticKeyboardNavigation:i()})})),l.onDidChangeScreenReaderOptimized((()=>c()))),this.navigator=new TreeResourceNavigator(e,Object.assign({configurationService:a},t)),this.disposables.push(this.navigator)}get onDidOpen(){return this.navigator.onDidOpen}updateOptions(e){void 0!==e.multipleSelectionSupport&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){dispose(this.styler),this.styler=e?attachListStyler(this.tree,this.themeService,e):Disposable.None}dispose(){this.disposables=dispose(this.disposables),dispose(this.styler),this.styler=void 0}};WorkbenchTreeInternals=__decorate$1a([__param$19(4,IContextKeyService),__param$19(5,IListService),__param$19(6,IThemeService),__param$19(7,IConfigurationService),__param$19(8,IAccessibilityService)],WorkbenchTreeInternals);const configurationRegistry$1=Registry.as(Extensions$3.Configuration);configurationRegistry$1.registerConfiguration({id:"workbench",order:7,title:localize("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[multiSelectModifierSettingKey]:{type:"string",enum:["ctrlCmd","alt"],enumDescriptions:[localize("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),localize("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:localize({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[openModeSettingKey]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[horizontalScrollingKey]:{type:"boolean",default:!1,description:localize("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[treeIndentKey]:{type:"number",default:8,minimum:4,maximum:40,description:localize("tree indent setting","Controls tree indentation in pixels.")},[treeRenderIndentGuidesKey]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:localize("render tree indent guides","Controls whether the tree should render indent guides.")},[listSmoothScrolling]:{type:"boolean",default:!1,description:localize("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[mouseWheelScrollSensitivityKey]:{type:"number",default:1,description:localize("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[fastScrollSensitivityKey]:{type:"number",default:5,description:localize("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[keyboardNavigationSettingKey]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[localize("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),localize("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),localize("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:localize("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter.")},[automaticKeyboardNavigationSettingKey]:{type:"boolean",default:!0,markdownDescription:localize("automatic keyboard navigation setting","Controls whether keyboard navigation in lists and trees is automatically triggered simply by typing. If set to `false`, keyboard navigation is only triggered when executing the `list.toggleKeyboardNavigation` command, for which you can assign a keyboard shortcut.")},[treeExpandMode]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:localize("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")}}});var __awaiter$N=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class OneReference{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=defaultGenerator.nextId()}get uri(){return this.link.uri}get range(){var e,t;return null!==(t=null!==(e=this._range)&&void 0!==e?e:this.link.targetSelectionRange)&&void 0!==t?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=null===(e=this.parent.getPreview(this))||void 0===e?void 0:e.preview(this.range);return t?localize({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"symbol in {0} on line {1} at column {2}, {3}",basename(this.uri),this.range.startLineNumber,this.range.startColumn,t.value):localize("aria.oneReference","symbol in {0} on line {1} at column {2}",basename(this.uri),this.range.startLineNumber,this.range.startColumn)}}class FilePreview{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:o,endLineNumber:r,endColumn:s}=e,a=i.getWordUntilPosition({lineNumber:n,column:o-t}),l=new Range$2(n,a.startColumn,n,o),d=new Range$2(r,s,r,1073741824),c=i.getValueInRange(l).replace(/^\s+/,""),h=i.getValueInRange(e);return{value:c+h+i.getValueInRange(d).replace(/\s+$/,""),highlight:{start:c.length,end:c.length+h.length}}}}class FileReferences{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new ResourceMap}dispose(){dispose(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return 1===e?localize("aria.fileReferences.1","1 symbol in {0}, full path {1}",basename(this.uri),this.uri.fsPath):localize("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,basename(this.uri),this.uri.fsPath)}resolve(e){return __awaiter$N(this,void 0,void 0,(function*(){if(0!==this._previews.size)return this;for(let i of this.children)if(!this._previews.has(i.uri))try{const t=yield e.createModelReference(i.uri);this._previews.set(i.uri,new FilePreview(t))}catch(t){onUnexpectedError(t)}return this}))}}class ReferencesModel{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new Emitter$1,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;let n;e.sort(ReferencesModel._compareReferences);for(let o of e)if(n&&extUri.isEqual(n.uri,o.uri,!0)||(n=new FileReferences(this,o.uri),this.groups.push(n)),0===n.children.length||0!==ReferencesModel._compareReferences(o,n.children[n.children.length-1])){const e=new OneReference(i===o,n,o,(e=>this._onDidChangeReferenceRange.fire(e)));this.references.push(e),n.children.push(e)}}dispose(){dispose(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new ReferencesModel(this._links,this._title)}get title(){return this._title}get isEmpty(){return 0===this.groups.length}get ariaMessage(){return this.isEmpty?localize("aria.result.0","No results found"):1===this.references.length?localize("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?localize("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):localize("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){let{parent:i}=e,n=i.children.indexOf(e),o=i.children.length,r=i.parent.groups.length;return 1===r||t&&n+1<o||!t&&n>0?(n=t?(n+1)%o:(n+o-1)%o,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%r,i.parent.groups[n].children[0]):(n=(n+r-1)%r,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map(((i,n)=>({idx:n,prefixLen:commonPrefixLength(i.uri.toString(),e.toString()),offsetDist:100*Math.abs(i.range.startLineNumber-t.lineNumber)+Math.abs(i.range.startColumn-t.column)}))).sort(((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0))[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&Range$2.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return extUri.compare(e.uri,t.uri)||Range$2.compareRangesUsingStarts(e.range,t.range)}}var referencesWidget="",countBadge="";const defaultOpts$3={badgeBackground:Color.fromHex("#4D4D4D"),badgeForeground:Color.fromHex("#FFFFFF")};class CountBadge{constructor(e,t){this.count=0,this.options=t||Object.create(null),mixin(this.options,defaultOpts$3,!1),this.badgeBackground=this.options.badgeBackground,this.badgeForeground=this.options.badgeForeground,this.badgeBorder=this.options.badgeBorder,this.element=append$1(e,$$c(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=format(this.countFormat,this.count),this.element.title=format(this.titleFormat,this.count),this.applyStyles()}style(e){this.badgeBackground=e.badgeBackground,this.badgeForeground=e.badgeForeground,this.badgeBorder=e.badgeBorder,this.applyStyles()}applyStyles(){if(this.element){const e=this.badgeBackground?this.badgeBackground.toString():"",t=this.badgeForeground?this.badgeForeground.toString():"",i=this.badgeBorder?this.badgeBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.element.style.borderWidth=i?"1px":"",this.element.style.borderStyle=i?"solid":"",this.element.style.borderColor=i}}}class HighlightedLabel{constructor(e,t){var i;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=null!==(i=null==t?void 0:t.supportIcons)&&void 0!==i&&i,this.domNode=append$1(e,$$c("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n){e||(e=""),n&&(e=HighlightedLabel.escapeNewLines(e,t)),this.didEverRender&&this.text===e&&this.title===i&&equals(this.highlights,t)||(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const n=this.text.substring(t,i.start);e.push($$c("span",void 0,...this.supportIcons?renderLabelWithIcons(n):[n])),t=i.end}const n=this.text.substring(i.start,i.end),o=$$c("span.highlight",void 0,...this.supportIcons?renderLabelWithIcons(n):[n]);i.extraClasses&&o.classList.add(...i.extraClasses),e.push(o),t=i.end}if(t<this.text.length){const i=this.text.substring(t);e.push($$c("span",void 0,...this.supportIcons?renderLabelWithIcons(i):[i]))}reset(this.domNode,...e),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,((e,o)=>{n="\r\n"===e?-1:0,o+=i;for(const i of t)i.end<=o||(i.start>=o&&(i.start+=n),i.end>=o&&(i.end+=n));return i+=n,"⏎"}))}}var __awaiter$M=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function setupNativeHover(e,t){isString$1(t)?e.title=stripIcons(t):(null==t?void 0:t.markdownNotSupportedFallback)?e.title=t.markdownNotSupportedFallback:e.removeAttribute("title")}class UpdatableHoverWidget{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}update(e,t){var i;return __awaiter$M(this,void 0,void 0,(function*(){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(void 0===e||isString$1(e)||e instanceof HTMLElement)n=e;else if(isFunction(e.markdown)){this._hoverWidget||this.show(localize("iconLabel.loading","Loading..."),t),this._cancellationTokenSource=new CancellationTokenSource$1;const i=this._cancellationTokenSource.token;if(n=yield e.markdown(i),void 0===n&&(n=e.markdownNotSupportedFallback),this.isDisposed||i.isCancellationRequested)return}else n=null!==(i=e.markdown)&&void 0!==i?i:e.markdownNotSupportedFallback;this.show(n,t)}))}show(e,t){const i=this._hoverWidget;if(this.hasContent(e)){const n={content:e,target:this.target,showPointer:"element"===this.hoverDelegate.placement,hoverPosition:2,skipFadeInAnimation:!this.fadeInAnimation||!!i};this._hoverWidget=this.hoverDelegate.showHover(n,t)}null==i||i.dispose()}hasContent(e){return!!e&&(!isMarkdownString(e)||!!e.value)}get isDisposed(){var e;return null===(e=this._hoverWidget)||void 0===e?void 0:e.isDisposed}dispose(){var e,t;null===(e=this._hoverWidget)||void 0===e||e.dispose(),null===(t=this._cancellationTokenSource)||void 0===t||t.dispose(!0),this._cancellationTokenSource=void 0}}function setupCustomHover(e,t,i){let n,o;const r=(t,i)=>{var r;t&&(null==o||o.dispose(),o=void 0),i&&(null==n||n.dispose(),n=void 0),null===(r=e.onDidHideHover)||void 0===r||r.call(e)},s=(n,r,s)=>new TimeoutTimer((()=>__awaiter$M(this,void 0,void 0,(function*(){o&&!o.isDisposed||(o=new UpdatableHoverWidget(e,s||t,n>0),yield o.update(i,r))}))),n),a=addDisposableListener(t,EventType$1.MOUSE_OVER,(()=>{if(n)return;const i=new DisposableStore;i.add(addDisposableListener(t,EventType$1.MOUSE_LEAVE,(e=>r(!1,e.fromElement===t)),!0));i.add(addDisposableListener(t,EventType$1.MOUSE_DOWN,(()=>r(!0,!0)),!0));const o={targetElements:[t],dispose:()=>{}};if(void 0===e.placement||"mouse"===e.placement){const e=e=>o.x=e.x+10;i.add(addDisposableListener(t,EventType$1.MOUSE_MOVE,e,!0))}i.add(s(e.delay,!1,o)),n=i}),!0);return{show:e=>{r(!1,!0),s(0,e)},hide:()=>{r(!0,!0)},update:e=>__awaiter$M(this,void 0,void 0,(function*(){i=e,yield null==o?void 0:o.update(i)})),dispose:()=>{a.dispose(),r(!0,!0)}}}var iconlabel="";class FastLabelNode{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set className(e){this.disposed||e===this._className||(this._className=e,this._element.className=e)}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class IconLabel extends Disposable{constructor(e,t){super(),this.customHovers=new Map,this.domNode=this._register(new FastLabelNode(append$1(e,$$c(".monaco-icon-label")))),this.labelContainer=append$1(this.domNode.element,$$c(".monaco-icon-label-container"));const i=append$1(this.labelContainer,$$c("span.monaco-icon-name-container"));this.descriptionContainer=this._register(new FastLabelNode(append$1(this.labelContainer,$$c("span.monaco-icon-description-container")))),(null==t?void 0:t.supportHighlights)||(null==t?void 0:t.supportIcons)?this.nameNode=new LabelWithHighlights(i,!!t.supportIcons):this.nameNode=new Label(i),(null==t?void 0:t.supportDescriptionHighlights)?this.descriptionNodeFactory=()=>new HighlightedLabel(append$1(this.descriptionContainer.element,$$c("span.label-description")),{supportIcons:!!t.supportIcons}):this.descriptionNodeFactory=()=>this._register(new FastLabelNode(append$1(this.descriptionContainer.element,$$c("span.label-description")))),this.hoverDelegate=null==t?void 0:t.hoverDelegate}get element(){return this.domNode.element}setLabel(e,t,i){const n=["monaco-icon-label"];i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough")),this.domNode.className=n.join(" "),this.setupHover((null==i?void 0:i.descriptionTitle)?this.labelContainer:this.element,null==i?void 0:i.title),this.nameNode.setLabel(e,i),(t||this.descriptionNode)&&(this.descriptionNode||(this.descriptionNode=this.descriptionNodeFactory()),this.descriptionNode instanceof HighlightedLabel?(this.descriptionNode.set(t||"",i?i.descriptionMatches:void 0),this.setupHover(this.descriptionNode.element,null==i?void 0:i.descriptionTitle)):(this.descriptionNode.textContent=t||"",this.setupHover(this.descriptionNode.element,(null==i?void 0:i.descriptionTitle)||""),this.descriptionNode.empty=!t))}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),t)if(this.hoverDelegate){const i=setupCustomHover(this.hoverDelegate,e,t);i&&this.customHovers.set(e,i)}else setupNativeHover(e,t);else e.removeAttribute("title")}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}}class Label{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label!==e||!equals(this.options,t))if(this.label=e,this.options=t,"string"==typeof e)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=append$1(this.container,$$c("a.label-name",{id:null==t?void 0:t.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],o=(null==t?void 0:t.domId)&&`${null==t?void 0:t.domId}_${i}`;append$1(this.container,$$c("a.label-name",{id:o,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&append$1(this.container,$$c("span.label-separator",void 0,(null==t?void 0:t.separator)||"/"))}}}}function splitMatches(e,t,i){if(!i)return;let n=0;return e.map((e=>{const o={start:n,end:n+e.length},r=i.map((e=>Range$1.intersect(o,e))).filter((e=>!Range$1.isEmpty(e))).map((({start:e,end:t})=>({start:e-n,end:t-n})));return n=o.end+t.length,r}))}class LabelWithHighlights{constructor(e,t){this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(this.label!==e||!equals(this.options,t))if(this.label=e,this.options=t,"string"==typeof e)this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=new HighlightedLabel(append$1(this.container,$$c("a.label-name",{id:null==t?void 0:t.domId})),{supportIcons:this.supportIcons})),this.singleLabel.set(e,null==t?void 0:t.matches,void 0,null==t?void 0:t.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=(null==t?void 0:t.separator)||"/",n=splitMatches(e,i,null==t?void 0:t.matches);for(let o=0;o<e.length;o++){const r=e[o],s=n?n[o]:void 0,a=$$c("a.label-name",{id:(null==t?void 0:t.domId)&&`${null==t?void 0:t.domId}_${o}`,"data-icon-label-count":e.length,"data-icon-label-index":o,role:"treeitem"});new HighlightedLabel(append$1(this.container,a),{supportIcons:this.supportIcons}).set(r,s,void 0,null==t?void 0:t.labelEscapeNewLines),o<e.length-1&&append$1(a,$$c("span.label-separator",void 0,i))}}}}function getBaseLabel(e){if(!e)return;"string"==typeof e&&(e=URI.file(e));const t=basename(e)||(e.scheme===Schemas.file?e.fsPath:e.path);return isWindows&&isRootOrDriveLetter(t)?normalizeDriveLetter(t):t}function normalizeDriveLetter(e,t){return hasDriveLetter(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}const ILabelService=createDecorator("labelService");var __decorate$19=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$18=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let DataSource=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof ReferencesModel||e instanceof FileReferences}getChildren(e){if(e instanceof ReferencesModel)return e.groups;if(e instanceof FileReferences)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};DataSource=__decorate$19([__param$18(0,ITextModelService)],DataSource);class Delegate{getHeight(){return 23}getTemplateId(e){return e instanceof FileReferences?FileReferencesRenderer.id:OneReferenceRenderer.id}}let StringRepresentationProvider=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof OneReference){const i=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(i)return i.value}return basename(e.uri)}};StringRepresentationProvider=__decorate$19([__param$18(0,IKeybindingService)],StringRepresentationProvider);class IdentityProvider{getId(e){return e instanceof OneReference?e.id:e.uri}}let FileReferencesTemplate=class extends Disposable{constructor(e,t,i){super(),this._uriLabel=t;const n=document.createElement("div");n.classList.add("reference-file"),this.file=this._register(new IconLabel(n,{supportHighlights:!0})),this.badge=new CountBadge(append$1(n,$$c(".count"))),this._register(attachBadgeStyler(this.badge,i)),e.appendChild(n)}set(e,t){let i=dirname(e.uri);this.file.setLabel(getBaseLabel(e.uri),this._uriLabel.getUriLabel(i,{relative:!0}),{title:this._uriLabel.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(localize("referencesCount","{0} references",n)):this.badge.setTitleFormat(localize("referenceCount","{0} reference",n))}};FileReferencesTemplate=__decorate$19([__param$18(1,ILabelService),__param$18(2,IThemeService)],FileReferencesTemplate);let FileReferencesRenderer=class e{constructor(t){this._instantiationService=t,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(FileReferencesTemplate,e)}renderElement(e,t,i){i.set(e.element,createMatches(e.filterData))}disposeTemplate(e){e.dispose()}};FileReferencesRenderer.id="FileReferencesRenderer",FileReferencesRenderer=__decorate$19([__param$18(0,IInstantiationService)],FileReferencesRenderer);class OneReferenceTemplate{constructor(e){this.label=new HighlightedLabel(e)}set(e,t){var i;const n=null===(i=e.parent.getPreview(e))||void 0===i?void 0:i.preview(e.range);if(n&&n.value){const{value:e,highlight:i}=n;t&&!FuzzyScore.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,createMatches(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[i]))}else this.label.set(`${basename(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}class OneReferenceRenderer{constructor(){this.templateId=OneReferenceRenderer.id}renderTemplate(e){return new OneReferenceTemplate(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}OneReferenceRenderer.id="OneReferenceRenderer";class AccessibilityProvider{getWidgetAriaLabel(){return localize("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var __decorate$18=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$17=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$L=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class DecorationsManager{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new DisposableStore,this._callOnModelChange=new DisposableStore,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e)for(let t of this._model.references)if(t.uri.toString()===e.uri.toString())return void this._addDecorations(t.parent)}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const t=[],i=[];for(let o=0,r=e.children.length;o<r;o++){let n=e.children[o];this._decorationIgnoreSet.has(n.id)||n.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:n.range,options:DecorationsManager.DecorationOptions}),i.push(o))}const n=this._editor.deltaDecorations([],t);for(let o=0;o<n.length;o++)this._decorations.set(n[o],e.children[i[o]])}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(let[i,n]of this._decorations){const o=t.getDecorationRange(i);if(!o)continue;let r=!1;if(!Range$2.equalsRange(o,n.range)){if(Range$2.spansMultipleLines(o))r=!0;else{n.range.endColumn-n.range.startColumn!==o.endColumn-o.startColumn&&(r=!0)}r?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=o}}for(let t=0,i=e.length;t<i;t++)this._decorations.delete(e[t]);this._editor.deltaDecorations(e,[])}}removeDecorations(){this._editor.deltaDecorations([...this._decorations.keys()],[]),this._decorations.clear()}}DecorationsManager.DecorationOptions=ModelDecorationOptions.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class LayoutData{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch(n){}return{ratio:t||.7,heightInLines:i||18}}}class ReferencesTree extends WorkbenchAsyncDataTree{}let ReferenceWidget=class extends PeekViewWidget{constructor(e,t,i,n,o,r,s,a,l,d,c,h){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=o,this._instantiationService=r,this._peekViewService=s,this._uriLabel=a,this._undoRedoService=l,this._keybindingService=d,this._languageService=c,this._languageConfigurationService=h,this._disposeOnNewModel=new DisposableStore,this._callOnDispose=new DisposableStore,this._onDidSelectReference=new Emitter$1,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new Dimension(0,0),this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),dispose(this._preview),dispose(this._previewNotAvailableMessage),dispose(this._tree),dispose(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(peekViewBorder)||Color.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(peekViewTitleBackground)||Color.transparent,primaryHeadingColor:e.getColor(peekViewTitleForeground),secondaryHeadingColor:e.getColor(peekViewTitleInfoForeground)})}show(e){this.editor.revealRangeInCenterIfOutsideViewport(e,0),super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=append$1(e,$$c("div.messages")),hide(this._messageContainer),this._splitView=new SplitView(e,{orientation:1}),this._previewContainer=append$1(e,$$c("div.preview.inline"));this._preview=this._instantiationService.createInstance(EmbeddedCodeEditorWidget,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},this.editor),hide(this._previewContainer),this._previewNotAvailableMessage=new TextModel(localize("missingPreviewMessage","no preview available"),PLAINTEXT_LANGUAGE_ID,TextModel.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=append$1(e,$$c("div.ref-tree.inline"));const t={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new AccessibilityProvider,keyboardNavigationLabelProvider:this._instantiationService.createInstance(StringRepresentationProvider),identityProvider:new IdentityProvider,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:peekViewResultsBackground}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(addStandardDisposableListener(this._treeContainer,"keydown",(e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(ReferencesTree,"ReferencesWidget",this._treeContainer,new Delegate,[this._instantiationService.createInstance(FileReferencesRenderer),this._instantiationService.createInstance(OneReferenceRenderer)],this._instantiationService.createInstance(DataSource),t),this._splitView.addView({onDidChange:Event$1.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._preview.layout({height:this._dim.height,width:e})}},Sizing.Distribute),this._splitView.addView({onDidChange:Event$1.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${e}px`,this._tree.layout(this._dim.height,e)}},Sizing.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));let i=(e,t)=>{e instanceof OneReference&&("show"===t&&this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:t,source:"tree"}))};this._tree.onDidOpen((e=>{e.sideBySide?i(e.element,"side"):e.editorOptions.pinned?i(e.element,"goto"):i(e.element,"show")})),hide(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new Dimension(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then((()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))}))}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=localize("noResults","No results"),show(this._messageContainer),Promise.resolve(void 0)):(hide(this._messageContainer),this._decorationsManager=new DecorationsManager(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((e=>this._tree.rerender(e)))),this._disposeOnNewModel.add(this._preview.onMouseDown((e=>{const{event:t,target:i}=e;if(2!==t.detail)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),show(this._treeContainer),show(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();return e instanceof OneReference?e:e instanceof FileReferences&&e.children.length>0?e.children[0]:void 0}revealReference(e){return __awaiter$L(this,void 0,void 0,(function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}))}_revealReference(e,t){return __awaiter$L(this,void 0,void 0,(function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==Schemas.inMemory?this.setTitle(basenameOrAuthority(e.uri),this._uriLabel.getUriLabel(dirname(e.uri))):this.setTitle(localize("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent||(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent)),this._tree.reveal(e);const n=yield i;if(!this._model)return void n.dispose();dispose(this._previewModelReference);const o=n.object;if(o){const t=this._preview.getModel()===o.textEditorModel?0:1,i=Range$2.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(o.textEditorModel),this._preview.setSelection(i),this._preview.revealRangeInCenter(i,t)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}))}};ReferenceWidget=__decorate$18([__param$17(3,IThemeService),__param$17(4,ITextModelService),__param$17(5,IInstantiationService),__param$17(6,IPeekViewService),__param$17(7,ILabelService),__param$17(8,IUndoRedoService),__param$17(9,IKeybindingService),__param$17(10,ILanguageService),__param$17(11,ILanguageConfigurationService)],ReferenceWidget);var __decorate$17=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$16=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$K=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const ctxReferenceSearchVisible=new RawContextKey("referenceSearchVisible",!1,localize("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let ReferencesController=class e{constructor(e,t,i,n,o,r,s,a){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=o,this._instantiationService=r,this._storageService=s,this._configurationService=a,this._disposables=new DisposableStore,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=ctxReferenceSearchVisible.bindTo(i)}static get(t){return t.getContribution(e.ID)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const o="peekViewLayout",r=LayoutData.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(ReferenceWidget,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(localize("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose((()=>{t.cancel(),this._widget&&(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((e=>{let{element:t,kind:n}=e;if(t)switch(n){case"open":"editor"===e.source&&this._configurationService.getValue("editor.stablePeek")||this.openReference(t,!1,!1);break;case"side":this.openReference(t,!0,!1);break;case"goto":i?this._gotoReference(t):this.openReference(t,!1,!0)}})));const s=++this._requestIdPool;t.then((t=>{var i;if(s===this._requestIdPool&&this._widget)return null===(i=this._model)||void 0===i||i.dispose(),this._model=t,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(localize("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));let t=this._editor.getModel().uri,i=new Position$1(e.startLineNumber,e.startColumn),n=this._model.nearestReference(t,i);if(n)return this._widget.setSelection(n).then((()=>{this._widget&&"editor"===this._editor.getOption(77)&&this._widget.focusOnPreviewEditor()}))}}));t.dispose()}),(e=>{this._notificationService.error(e)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return __awaiter$K(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),o=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(n),yield this._gotoReference(n),o?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}))}revealReference(e){return __awaiter$K(this,void 0,void 0,(function*(){this._editor.hasModel()&&this._model&&this._widget&&(yield this._widget.revealReference(e))}))}closeWidget(e=!0){var t,i;null===(t=this._widget)||void 0===t||t.dispose(),null===(i=this._model)||void 0===i||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t){this._widget&&this._widget.hide(),this._ignoreModelChangeEvent=!0;const i=Range$2.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:i,selectionSource:"code.jump"}},this._editor).then((t=>{var n;if(this._ignoreModelChangeEvent=!1,t&&this._widget)if(this._editor===t)this._widget.show(i),this._widget.focusOnReferenceTree();else{const o=e.get(t),r=this._model.clone();this.closeWidget(),t.focus(),null==o||o.toggleWidget(i,createCancelablePromise((e=>Promise.resolve(r))),null!==(n=this._peekMode)&&void 0!==n&&n)}else this.closeWidget()}),(e=>{this._ignoreModelChangeEvent=!1,onUnexpectedError(e)}))}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:o}=e;this._editorService.openCodeEditor({resource:n,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,t)}};function withController(e,t){const i=getOuterEditor(e);if(!i)return;const n=ReferencesController.get(i);n&&t(n)}ReferencesController.ID="editor.contrib.referencesController",ReferencesController=__decorate$17([__param$16(2,IContextKeyService),__param$16(3,ICodeEditorService),__param$16(4,INotificationService),__param$16(5,IInstantiationService),__param$16(6,IStorageService),__param$16(7,IConfigurationService)],ReferencesController),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:KeyChord(2089,60),when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(e){withController(e,(e=>{e.changeFocusBetweenPreviewAndReferences()}))}}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(e){withController(e,(e=>{e.goToNextOrPreviousReference(!0)}))}}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:ContextKeyExpr.or(ctxReferenceSearchVisible,PeekContext.inPeekEditor),handler(e){withController(e,(e=>{e.goToNextOrPreviousReference(!1)}))}}),CommandsRegistry.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),CommandsRegistry.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),CommandsRegistry.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),CommandsRegistry.registerCommand("closeReferenceSearch",(e=>withController(e,(e=>e.closeWidget())))),KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:ContextKeyExpr.and(PeekContext.inPeekEditor,ContextKeyExpr.not("config.editor.stablePeek"))}),KeybindingsRegistry.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:ContextKeyExpr.and(ctxReferenceSearchVisible,ContextKeyExpr.not("config.editor.stablePeek"))}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:ContextKeyExpr.and(ctxReferenceSearchVisible,WorkbenchListFocusContextKey,WorkbenchTreeElementCanCollapse.negate(),WorkbenchTreeElementCanExpand.negate()),handler(e){var t;const i=null===(t=e.get(IListService).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(i)&&i[0]instanceof OneReference&&withController(e,(e=>e.revealReference(i[0])))}}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:ContextKeyExpr.and(ctxReferenceSearchVisible,WorkbenchListFocusContextKey,WorkbenchTreeElementCanCollapse.negate(),WorkbenchTreeElementCanExpand.negate()),handler(e){var t;const i=null===(t=e.get(IListService).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(i)&&i[0]instanceof OneReference&&withController(e,(e=>e.openReference(i[0],!0,!0)))}}),CommandsRegistry.registerCommand("openReference",(e=>{var t;const i=null===(t=e.get(IListService).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(i)&&i[0]instanceof OneReference&&withController(e,(e=>e.openReference(i[0],!1,!0)))}));var __decorate$16=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$15=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const ctxHasSymbols=new RawContextKey("hasSymbols",!1,localize("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),ISymbolNavigationService=createDecorator("ISymbolNavigationService");let SymbolNavigationService=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=ctxHasSymbols.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),null===(e=this._currentState)||void 0===e||e.dispose(),null===(t=this._currentMessage)||void 0===t||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1)return void this.reset();this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new EditorState(this._editorService),n=i.onDidChange((e=>{if(this._ignoreEditorChange)return;const i=this._editorService.getActiveCodeEditor();if(!i)return;const n=i.getModel(),o=i.getPosition();if(!n||!o)return;let r=!1,s=!1;for(const a of t.references)if(isEqual(a.uri,n.uri))r=!0,s=s||Range$2.containsPosition(a.range,o);else if(r)break;r&&s||this.reset()}));this._currentState=combinedDisposable(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:Range$2.collapseToStart(t.range),selectionRevealType:3}},e).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var e;null===(e=this._currentMessage)||void 0===e||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?localize("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):localize("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};SymbolNavigationService=__decorate$16([__param$15(0,IContextKeyService),__param$15(1,ICodeEditorService),__param$15(2,INotificationService),__param$15(3,IKeybindingService)],SymbolNavigationService),registerSingleton(ISymbolNavigationService,SymbolNavigationService,!0),registerEditorCommand(new class extends EditorCommand{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:ctxHasSymbols,kbOpts:{weight:100,primary:70}})}runEditorCommand(e,t){return e.get(ISymbolNavigationService).revealNext(t)}}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:ctxHasSymbols,primary:9,handler(e){e.get(ISymbolNavigationService).reset()}});let EditorState=class{constructor(e){this._listener=new Map,this._disposables=new DisposableStore,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),dispose(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,combinedDisposable(e.onDidChangeCursorPosition((t=>this._onDidChange.fire({editor:e}))),e.onDidChangeModelContent((t=>this._onDidChange.fire({editor:e})))))}_onDidRemoveEditor(e){var t;null===(t=this._listener.get(e))||void 0===t||t.dispose(),this._listener.delete(e)}};EditorState=__decorate$16([__param$15(0,ICodeEditorService)],EditorState);var __awaiter$J=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function getLocationLinks(e,t,i,n){const o=i.ordered(e).map((i=>Promise.resolve(n(i,e,t)).then(void 0,(e=>{onUnexpectedExternalError(e)}))));return Promise.all(o).then((e=>{const t=[];for(let i of e)Array.isArray(i)?t.push(...i):i&&t.push(i);return t}))}function getDefinitionsAtPosition(e,t,i,n){return getLocationLinks(t,i,e,((e,t,i)=>e.provideDefinition(t,i,n)))}function getDeclarationsAtPosition(e,t,i,n){return getLocationLinks(t,i,e,((e,t,i)=>e.provideDeclaration(t,i,n)))}function getImplementationsAtPosition(e,t,i,n){return getLocationLinks(t,i,e,((e,t,i)=>e.provideImplementation(t,i,n)))}function getTypeDefinitionsAtPosition(e,t,i,n){return getLocationLinks(t,i,e,((e,t,i)=>e.provideTypeDefinition(t,i,n)))}function getReferencesAtPosition(e,t,i,n,o){return getLocationLinks(t,i,e,((e,t,i)=>__awaiter$J(this,void 0,void 0,(function*(){const r=yield e.provideReferences(t,i,{includeDeclaration:!0},o);if(!n||!r||2!==r.length)return r;const s=yield e.provideReferences(t,i,{includeDeclaration:!1},o);return s&&1===s.length?s:r}))))}function _sortedAndDeduped(e){return __awaiter$J(this,void 0,void 0,(function*(){const t=yield e(),i=new ReferencesModel(t,""),n=i.references.map((e=>e.link));return i.dispose(),n}))}registerModelAndPositionCommand("_executeDefinitionProvider",((e,t,i)=>{const n=getDefinitionsAtPosition(e.get(ILanguageFeaturesService).definitionProvider,t,i,CancellationToken.None);return _sortedAndDeduped((()=>n))})),registerModelAndPositionCommand("_executeTypeDefinitionProvider",((e,t,i)=>{const n=getTypeDefinitionsAtPosition(e.get(ILanguageFeaturesService).typeDefinitionProvider,t,i,CancellationToken.None);return _sortedAndDeduped((()=>n))})),registerModelAndPositionCommand("_executeDeclarationProvider",((e,t,i)=>{const n=getDeclarationsAtPosition(e.get(ILanguageFeaturesService).declarationProvider,t,i,CancellationToken.None);return _sortedAndDeduped((()=>n))})),registerModelAndPositionCommand("_executeReferenceProvider",((e,t,i)=>{const n=getReferencesAtPosition(e.get(ILanguageFeaturesService).referenceProvider,t,i,!1,CancellationToken.None);return _sortedAndDeduped((()=>n))})),registerModelAndPositionCommand("_executeImplementationProvider",((e,t,i)=>{const n=getImplementationsAtPosition(e.get(ILanguageFeaturesService).implementationProvider,t,i,CancellationToken.None);return _sortedAndDeduped((()=>n))}));var __awaiter$I=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},_a$6,_b,_c,_d,_e,_f,_g,_h;MenuRegistry.appendMenuItem(MenuId.EditorContext,{submenu:MenuId.EditorContextPeek,title:localize("peek.submenu","Peek"),group:"navigation",order:100});const _goToActionIds=new Set;function registerGoToAction(e){const t=new e;return registerInstantiatedEditorAction(t),_goToActionIds.add(t.id),t}class SymbolNavigationAnchor{constructor(e,t){this.model=e,this.position=t}static is(e){return!(!e||"object"!=typeof e)&&(e instanceof SymbolNavigationAnchor||!(!Position$1.isIPosition(e.position)||!e.model))}}class SymbolNavigationAction extends EditorAction{constructor(e,t){super(t),this.configuration=e}run(e,t,i){if(!t.hasModel())return Promise.resolve(void 0);const n=e.get(INotificationService),o=e.get(ICodeEditorService),r=e.get(IEditorProgressService),s=e.get(ISymbolNavigationService),a=e.get(ILanguageFeaturesService),l=t.getModel(),d=t.getPosition(),c=SymbolNavigationAnchor.is(i)?i:new SymbolNavigationAnchor(l,d),h=new EditorStateCancellationTokenSource(t,5),u=raceCancellation(this._getLocationModel(a,c.model,c.position,h.token),h.token).then((e=>__awaiter$I(this,void 0,void 0,(function*(){var i;if(!e||h.token.isCancellationRequested)return;let n;if(alert(e.ariaMessage),e.referenceAt(l.uri,d)){const e=this._getAlternativeCommand(t);e!==this.id&&_goToActionIds.has(e)&&(n=t.getAction(e))}const r=e.references.length;if(0===r){if(!this.configuration.muteMessage){const e=l.getWordAtPosition(d);null===(i=MessageController.get(t))||void 0===i||i.showMessage(this._getNoResultFoundMessage(e),d)}}else{if(1!==r||!n)return this._onResult(o,s,t,e);n.run()}}))),(e=>{n.error(e)})).finally((()=>{h.dispose()}));return r.showWhile(u,250),u}_onResult(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){const o=this._getGoToPreference(i);if(i instanceof EmbeddedCodeEditorWidget||!(this.configuration.openInPeek||"peek"===o&&n.references.length>1)){const r=n.firstReference(),s=n.references.length>1&&"gotoAndPeek"===o,a=yield this._openReference(i,e,r,this.configuration.openToSide,!s);s&&a?this._openInPeek(a,n):n.dispose(),"goto"===o&&t.put(r)}else this._openInPeek(i,n)}))}_openReference(e,t,i,n,o){return __awaiter$I(this,void 0,void 0,(function*(){let r;if(isLocationLink(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const s=yield t.openCodeEditor({resource:i.uri,options:{selection:Range$2.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(s){if(o){const e=s.getModel(),t=s.deltaDecorations([],[{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{s.getModel()===e&&s.deltaDecorations(t,[])}),350)}return s}}))}_openInPeek(e,t){const i=ReferencesController.get(e);i&&e.hasModel()?i.toggleWidget(e.getSelection(),createCancelablePromise((e=>Promise.resolve(t))),this.configuration.openInPeek):t.dispose()}}class DefinitionAction extends SymbolNavigationAction{_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getDefinitionsAtPosition(e.definitionProvider,t,i,n),localize("def.title","Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?localize("noResultWord","No definition found for '{0}'",e.word):localize("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(51).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(51).multipleDefinitions}}const goToDefinitionKb=isWeb&&!isStandalone?2118:70;registerGoToAction((_a$6=class e extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:localize("actions.goToDecl.label","Go to Definition"),alias:"Go to Definition",precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:goToDefinitionKb,weight:100},contextMenuOpts:{group:"navigation",order:1.1}}),CommandsRegistry.registerCommandAlias("editor.action.goToDeclaration",e.id)}},_a$6.id="editor.action.revealDefinition",_a$6)),registerGoToAction((_b=class e extends DefinitionAction{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:e.id,label:localize("actions.goToDeclToSide.label","Open Definition to the Side"),alias:"Open Definition to the Side",precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,goToDefinitionKb),weight:100}}),CommandsRegistry.registerCommandAlias("editor.action.openDeclarationToTheSide",e.id)}},_b.id="editor.action.revealDefinitionAside",_b)),registerGoToAction((_c=class e extends DefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.id,label:localize("actions.previewDecl.label","Peek Definition"),alias:"Peek Definition",precondition:ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:582,linux:{primary:3140},weight:100},contextMenuOpts:{menuId:MenuId.EditorContextPeek,group:"peek",order:2}}),CommandsRegistry.registerCommandAlias("editor.action.previewDeclaration",e.id)}},_c.id="editor.action.peekDefinition",_c));class DeclarationAction extends SymbolNavigationAction{_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getDeclarationsAtPosition(e.declarationProvider,t,i,n),localize("decl.title","Declarations"))}))}_getNoResultFoundMessage(e){return e&&e.word?localize("decl.noResultWord","No declaration found for '{0}'",e.word):localize("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(51).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(51).multipleDeclarations}}registerGoToAction((_d=class e extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:localize("actions.goToDeclaration.label","Go to Declaration"),alias:"Go to Declaration",precondition:ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{group:"navigation",order:1.3}})}_getNoResultFoundMessage(e){return e&&e.word?localize("decl.noResultWord","No declaration found for '{0}'",e.word):localize("decl.generic.noResults","No declaration found")}},_d.id="editor.action.revealDeclaration",_d)),registerGoToAction(class extends DeclarationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",label:localize("actions.peekDecl.label","Peek Declaration"),alias:"Peek Declaration",precondition:ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:MenuId.EditorContextPeek,group:"peek",order:3}})}});class TypeDefinitionAction extends SymbolNavigationAction{_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getTypeDefinitionsAtPosition(e.typeDefinitionProvider,t,i,n),localize("typedef.title","Type Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?localize("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):localize("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(51).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(51).multipleTypeDefinitions}}registerGoToAction((_e=class e extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:localize("actions.goToTypeDefinition.label","Go to Type Definition"),alias:"Go to Type Definition",precondition:ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:0,weight:100},contextMenuOpts:{group:"navigation",order:1.4}})}},_e.ID="editor.action.goToTypeDefinition",_e)),registerGoToAction((_f=class e extends TypeDefinitionAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:localize("actions.peekTypeDefinition.label","Peek Type Definition"),alias:"Peek Type Definition",precondition:ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:MenuId.EditorContextPeek,group:"peek",order:4}})}},_f.ID="editor.action.peekTypeDefinition",_f));class ImplementationAction extends SymbolNavigationAction{_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getImplementationsAtPosition(e.implementationProvider,t,i,n),localize("impl.title","Implementations"))}))}_getNoResultFoundMessage(e){return e&&e.word?localize("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):localize("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(51).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(51).multipleImplementations}}registerGoToAction((_g=class e extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:localize("actions.goToImplementation.label","Go to Implementations"),alias:"Go to Implementations",precondition:ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2118,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}},_g.ID="editor.action.goToImplementation",_g)),registerGoToAction((_h=class e extends ImplementationAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:localize("actions.peekImplementation.label","Peek Implementations"),alias:"Peek Implementations",precondition:ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3142,weight:100},contextMenuOpts:{menuId:MenuId.EditorContextPeek,group:"peek",order:5}})}},_h.ID="editor.action.peekImplementation",_h));class ReferencesAction extends SymbolNavigationAction{_getNoResultFoundMessage(e){return e?localize("references.no","No references found for '{0}'",e.word):localize("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(51).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(51).multipleReferences}}registerGoToAction(class extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",label:localize("goToReferences.label","Go to References"),alias:"Go to References",precondition:ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1094,weight:100},contextMenuOpts:{group:"navigation",order:1.45}})}_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getReferencesAtPosition(e.referenceProvider,t,i,!0,n),localize("ref.title","References"))}))}}),registerGoToAction(class extends ReferencesAction{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",label:localize("references.action.label","Peek References"),alias:"Peek References",precondition:ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider,PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:MenuId.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(yield getReferencesAtPosition(e.referenceProvider,t,i,!1,n),localize("ref.title","References"))}))}});class GenericGoToLocationAction extends SymbolNavigationAction{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",label:localize("label.generic","Go to Any Symbol"),alias:"Go to Any Symbol",precondition:ContextKeyExpr.and(PeekContext.notInPeekEditor,EditorContextKeys.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i,n){return __awaiter$I(this,void 0,void 0,(function*(){return new ReferencesModel(this._references,localize("generic.title","Locations"))}))}_getNoResultFoundMessage(e){return e&&localize("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return null!==(t=this._gotoMultipleBehaviour)&&void 0!==t?t:e.getOption(51).multipleReferences}_getAlternativeCommand(){return""}}CommandsRegistry.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:URI},{name:"position",description:"The position at which to start",constraint:Position$1.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(e,t,i,n,o,r,s)=>__awaiter$I(void 0,void 0,void 0,(function*(){assertType(URI.isUri(t)),assertType(Position$1.isIPosition(i)),assertType(Array.isArray(n)),assertType(void 0===o||"string"==typeof o),assertType(void 0===s||"boolean"==typeof s);const a=e.get(ICodeEditorService),l=yield a.openCodeEditor({resource:t},a.getFocusedCodeEditor());if(isCodeEditor(l))return l.setPosition(i),l.revealPositionInCenterIfOutsideViewport(i,0),l.invokeWithinContext((e=>{const t=new class extends GenericGoToLocationAction{_getNoResultFoundMessage(e){return r||super._getNoResultFoundMessage(e)}}({muteMessage:!Boolean(r),openInPeek:Boolean(s),openToSide:!1},n,o);e.get(IInstantiationService).invokeFunction(t.run.bind(t),l)}))}))}),CommandsRegistry.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:URI},{name:"position",description:"The position at which to start",constraint:Position$1.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(e,t,i,n,o)=>__awaiter$I(void 0,void 0,void 0,(function*(){e.get(ICommandService).executeCommand("editor.action.goToLocations",t,i,n,o,void 0,!0)}))}),CommandsRegistry.registerCommand({id:"editor.action.findReferences",handler:(e,t,i)=>{assertType(URI.isUri(t)),assertType(Position$1.isIPosition(i));const n=e.get(ILanguageFeaturesService),o=e.get(ICodeEditorService);return o.openCodeEditor({resource:t},o.getFocusedCodeEditor()).then((e=>{if(!isCodeEditor(e)||!e.hasModel())return;const t=ReferencesController.get(e);if(!t)return;const o=createCancelablePromise((t=>getReferencesAtPosition(n.referenceProvider,e.getModel(),Position$1.lift(i),!1,t).then((e=>new ReferencesModel(e,localize("ref.title","References")))))),r=new Range$2(i.lineNumber,i.column,i.lineNumber,i.column);return Promise.resolve(t.toggleWidget(r,o,!1))}))}}),CommandsRegistry.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations"),MenuRegistry.appendMenuItems([{id:MenuId.MenubarGoMenu,item:{command:{id:"editor.action.revealDefinition",title:localize({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},group:"4_symbol_nav",order:2}},{id:MenuId.MenubarGoMenu,item:{command:{id:"editor.action.revealDeclaration",title:localize({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},group:"4_symbol_nav",order:3}},{id:MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToTypeDefinition",title:localize({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},group:"4_symbol_nav",order:3}},{id:MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToImplementation",title:localize({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},group:"4_symbol_nav",order:4}},{id:MenuId.MenubarGoMenu,item:{command:{id:"editor.action.goToReferences",title:localize({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},group:"4_symbol_nav",order:5}}]);var __decorate$15=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$14=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let GotoDefinitionAtPositionEditorContribution=class e{constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new DisposableStore,this.toUnhookForKeyboard=new DisposableStore,this.linkDecorations=[],this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e;let o=new ClickLinkGesture(e);this.toUnhook.add(o),this.toUnhook.add(o.onMouseMoveOrRelevantKeyDown((([e,t])=>{this.startFindDefinitionFromMouse(e,withNullAsUndefined(t))}))),this.toUnhook.add(o.onExecute((e=>{this.isEnabled(e)&&this.gotoDefinition(e.target.position,e.hasSideBySideModifier).then((()=>{this.removeLinkDecorations()}),(e=>{this.removeLinkDecorations(),onUnexpectedError(e)}))}))),this.toUnhook.add(o.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(t){return t.getContribution(e.ID)}startFindDefinitionFromCursor(e){return this.startFindDefinition(e).then((()=>{this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}))}startFindDefinitionFromMouse(e,t){if(9===e.target.type&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;this.toUnhookForKeyboard.clear();const i=e?null===(t=this.editor.getModel())||void 0===t?void 0:t.getWordAtPosition(e):null;if(!i)return this.currentWordAtPosition=null,this.removeLinkDecorations(),Promise.resolve(0);if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return Promise.resolve(0);this.currentWordAtPosition=i;let n=new EditorState$1(this.editor,15);return this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=createCancelablePromise((t=>this.findDefinition(e,t))),this.previousPromise.then((t=>{if(t&&t.length&&n.validate(this.editor))if(t.length>1)this.addDecoration(new Range$2(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn),(new MarkdownString).appendText(localize("multipleResults","Click to show {0} definitions.",t.length)));else{let n=t[0];if(!n.uri)return;this.textModelResolverService.createModelReference(n.uri).then((t=>{if(!t.object||!t.object.textEditorModel)return void t.dispose();const{object:{textEditorModel:o}}=t,{startLineNumber:r}=n.range;if(r<1||r>o.getLineCount())return void t.dispose();const s=this.getPreviewValue(o,r,n);let a;a=n.originSelectionRange?Range$2.lift(n.originSelectionRange):new Range$2(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);const l=this.languageService.guessLanguageIdByFilepathOrFirstLine(o.uri);this.addDecoration(a,(new MarkdownString).appendCodeblock(l||"",s)),t.dispose()}))}else this.removeLinkDecorations()})).then(void 0,onUnexpectedError)}getPreviewValue(t,i,n){let o=n.targetSelectionRange?n.range:this.getPreviewRangeBasedOnBrackets(t,i);o.endLineNumber-o.startLineNumber>=e.MAX_SOURCE_PREVIEW_LINES&&(o=this.getPreviewRangeBasedOnIndentation(t,i));return this.stripIndentationFromPreviewRange(t,i,o)}stripIndentationFromPreviewRange(e,t,i){let n=e.getLineFirstNonWhitespaceColumn(t);for(let o=t+1;o<i.endLineNumber;o++){const t=e.getLineFirstNonWhitespaceColumn(o);n=Math.min(n,t)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${n-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(t,i){const n=t.getLineFirstNonWhitespaceColumn(i),o=Math.min(t.getLineCount(),i+e.MAX_SOURCE_PREVIEW_LINES);let r=i+1;for(;r<o;r++){if(n===t.getLineFirstNonWhitespaceColumn(r))break}return new Range$2(i,1,r+1,1)}getPreviewRangeBasedOnBrackets(t,i){const n=Math.min(t.getLineCount(),i+e.MAX_SOURCE_PREVIEW_LINES),o=[];let r=!0,s=t.bracketPairs.findNextBracket(new Position$1(i,1));for(;null!==s;){if(0===o.length)o.push(s);else{const e=o[o.length-1];if(e.open[0]===s.open[0]&&e.isOpen&&!s.isOpen?o.pop():o.push(s),0===o.length){if(!r)return new Range$2(i,1,s.range.endLineNumber+1,1);r=!1}}const e=t.getLineMaxColumn(i);let a=s.range.endLineNumber,l=s.range.endColumn;if(e===s.range.endColumn&&(a++,l=1),a>n)return new Range$2(i,1,n+1,1);s=t.bracketPairs.findNextBracket(new Position$1(a,l))}return new Range$2(i,1,n+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[i])}removeLinkDecorations(){this.linkDecorations.length>0&&(this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[]))}isEnabled(e,t){return this.editor.hasModel()&&e.isNoneOrSingleMouseDown&&6===e.target.type&&(e.hasTriggerModifier||!!t&&t.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider,i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext((e=>{const i=!t&&this.editor.getOption(78)&&!this.isInPeekEditor(e);return new DefinitionAction({openToSide:t,openInPeek:i,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(e,this.editor)}))}isInPeekEditor(e){const t=e.get(IContextKeyService);return PeekContext.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose()}};GotoDefinitionAtPositionEditorContribution.ID="editor.contrib.gotodefinitionatposition",GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES=8,GotoDefinitionAtPositionEditorContribution=__decorate$15([__param$14(1,ITextModelService),__param$14(2,ILanguageService),__param$14(3,ILanguageFeaturesService)],GotoDefinitionAtPositionEditorContribution),registerEditorContribution(GotoDefinitionAtPositionEditorContribution.ID,GotoDefinitionAtPositionEditorContribution),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorActiveLinkForeground);i&&t.addRule(`.monaco-editor .goto-definition-link { color: ${i} !important; }`)}));var hover="";const $$a=$$c;class HoverWidget extends Disposable{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new DomScrollableElement(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}}class HoverAction extends Disposable{constructor(e,t,i){super(),this.actionContainer=append$1(e,$$a("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=append$1(this.actionContainer,$$a("a.action")),this.action.setAttribute("role","button"),t.iconClass&&append$1(this.action,$$a(`span.icon.${t.iconClass}`));append$1(this.action,$$a("span")).textContent=i?`${t.label} (${i})`:t.label,this._register(addDisposableListener(this.actionContainer,EventType$1.CLICK,(e=>{e.stopPropagation(),e.preventDefault(),t.run(this.actionContainer)}))),this._register(addDisposableListener(this.actionContainer,EventType$1.KEY_UP,(e=>{new StandardKeyboardEvent(e).equals(3)&&(e.stopPropagation(),e.preventDefault(),t.run(this.actionContainer))}))),this.setEnabled(!0)}static render(e,t,i){return new HoverAction(e,t,i)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}var __awaiter$H=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__asyncValues$1=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};class HoverResult{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}}class HoverOperation extends Disposable{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new Emitter$1),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new RunOnceScheduler((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new RunOnceScheduler((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new RunOnceScheduler((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(53).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=createCancelableAsyncIterable((e=>this._computer.computeAsync(e))),(()=>{__awaiter$H(this,void 0,void 0,(function*(){var e,t;try{try{for(var i,n=__asyncValues$1(this._asyncIterable);!(i=yield n.next()).done;){const e=i.value;e&&(this._result.push(e),this._fireResult())}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=n.return)&&(yield t.call(n))}finally{if(e)throw e.error}}this._asyncIterableDone=!0,3!==this._state&&4!==this._state||this._setState(0)}catch(e2){onUnexpectedError(e2)}}))})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){3===this._state&&this._setState(4)}_fireResult(){if(1===this._state||2===this._state)return;const e=0===this._state,t=4===this._state;this._onResult.fire(new HoverResult(this._result.slice(0),e,t))}start(e){if(0===e)0===this._state&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class HoverRangeAnchor{constructor(e,t){this.priority=e,this.range=t,this.type=1}equals(e){return 1===e.type&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return 1===e.type&&t.lineNumber===this.range.startLineNumber}}class HoverForeignElementAnchor{constructor(e,t,i){this.priority=e,this.owner=t,this.range=i,this.type=2}equals(e){return 2===e.type&&this.owner===e.owner}canAdoptVisibleHover(e,t){return 2===e.type&&this.owner===e.owner}}const HoverParticipantRegistry=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};class Scanner{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let e,t=this.pos,i=0,n=this.value.charCodeAt(t);if(e=Scanner._table[n],"number"==typeof e)return this.pos+=1,{type:e,pos:t,len:1};if(Scanner.isDigitCharacter(n)){e=8;do{i+=1,n=this.value.charCodeAt(t+i)}while(Scanner.isDigitCharacter(n));return this.pos+=i,{type:e,pos:t,len:i}}if(Scanner.isVariableCharacter(n)){e=9;do{n=this.value.charCodeAt(t+ ++i)}while(Scanner.isVariableCharacter(n)||Scanner.isDigitCharacter(n));return this.pos+=i,{type:e,pos:t,len:i}}e=10;do{i+=1,n=this.value.charCodeAt(t+i)}while(!isNaN(n)&&void 0===Scanner._table[n]&&!Scanner.isDigitCharacter(n)&&!Scanner.isVariableCharacter(n));return this.pos+=i,{type:e,pos:t,len:i}}}Scanner._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};class Marker{constructor(){this._children=[]}appendChild(e){return e instanceof Text&&this._children[this._children.length-1]instanceof Text?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),o=i.children.slice(0);o.splice(n,1,...t),i._children=o,function e(t,i){for(const n of t)n.parent=i,e(n.children,n)}(t,i)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof TextmateSnippet)return e;e=e.parent}}toString(){return this.children.reduce(((e,t)=>e+t.toString()),"")}len(){return 0}}class Text extends Marker{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new Text(this.value)}}class TransformableMarker extends Marker{}class Placeholder extends TransformableMarker{constructor(e){super(),this.index=e}static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}get isFinalTabstop(){return 0===this.index}get choice(){return 1===this._children.length&&this._children[0]instanceof Choice?this._children[0]:void 0}clone(){let e=new Placeholder(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((e=>e.clone())),e}}class Choice extends Marker{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof Text&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){let e=new Choice;return this.options.forEach(e.appendChild,e),e}}class Transform extends Marker{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,n=e.replace(this.regexp,(function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))}));return!i&&this._children.some((e=>e instanceof FormatString&&Boolean(e.elseValue)))&&(n=this._replace([])),n}_replace(e){let t="";for(const i of this._children)if(i instanceof FormatString){let n=e[i.index]||"";n=i.resolve(n),t+=n}else t+=i.toString();return t}toString(){return""}clone(){let e=new Transform;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map((e=>e.clone())),e}}class FormatString extends Marker{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return"upcase"===this.shorthandName?e?e.toLocaleUpperCase():"":"downcase"===this.shorthandName?e?e.toLocaleLowerCase():"":"capitalize"===this.shorthandName?e?e[0].toLocaleUpperCase()+e.substr(1):"":"pascalcase"===this.shorthandName?e?this._toPascalCase(e):"":"camelcase"===this.shorthandName?e?this._toCamelCase(e):"":Boolean(e)&&"string"==typeof this.ifValue?this.ifValue:Boolean(e)||"string"!=typeof this.elseValue?e||"":this.elseValue}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(((e,t)=>0===t?e.toLowerCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())).join(""):e}clone(){return new FormatString(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class Variable extends TransformableMarker{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new Text(t)],!0)}clone(){const e=new Variable(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((e=>e.clone())),e}}function walk(e,t){const i=[...e];for(;i.length>0;){const e=i.shift();if(!t(e))break;i.unshift(...e.children)}}class TextmateSnippet extends Marker{get placeholderInfo(){if(!this._placeholders){let e,t=[];this.walk((function(i){return i instanceof Placeholder&&(t.push(i),e=!e||e.index<i.index?i:e),!0})),this._placeholders={all:t,last:e}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk((n=>n===e?(i=!0,!1):(t+=n.len(),!0))),i?t:-1}fullLen(e){let t=0;return walk([e],(e=>(t+=e.len(),!0))),t}enclosingPlaceholders(e){let t=[],{parent:i}=e;for(;i;)i instanceof Placeholder&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk((t=>(t instanceof Variable&&t.resolve(e)&&(this._placeholders=void 0),!0))),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){let e=new TextmateSnippet;return this._children=this.children.map((e=>e.clone())),e}walk(e){walk(this.children,e)}}class SnippetParser{constructor(){this._scanner=new Scanner,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){this._scanner.text(e),this._token=this._scanner.next();const n=new TextmateSnippet;for(;this._parse(n););const o=new Map,r=[];let s=0;n.walk((e=>(e instanceof Placeholder&&(s+=1,e.isFinalTabstop?o.set(0,void 0):!o.has(e.index)&&e.children.length>0?o.set(e.index,e.children):r.push(e)),!0)));for(const a of r){const e=o.get(a.index);if(e){const t=new Placeholder(a.index);t.transform=a.transform;for(const i of e)t.appendChild(i.clone());n.replace(a,[t])}}return i||(i=s>0&&t),!o.has(0)&&i&&n.appendChild(new Placeholder(0)),n}_accept(e,t){if(void 0===e||this._token.type===e){let e=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),e}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){const e=this._scanner.next();if(0!==e.type&&4!==e.type&&5!==e.type)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new Text(t)),!0)}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new Placeholder(Number(t)):new Variable(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const n=new Placeholder(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(n),!0;if(!this._parse(n))return e.appendChild(new Text("${"+t+":")),n.children.forEach(e.appendChild,e),!0}else{if(!(n.index>0&&this._accept(7)))return this._accept(6)?this._parseTransform(n)?(e.appendChild(n),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(n),!0):this._backTo(i);{const t=new Choice;for(;;){if(this._parseChoiceElement(t)){if(this._accept(2))continue;if(this._accept(7)&&(n.appendChild(t),this._accept(4)))return e.appendChild(n),!0}return this._backTo(i),!1}}}}_parseChoiceElement(e){const t=this._token,i=[];for(;2!==this._token.type&&7!==this._token.type;){let e;if(e=(e=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||e:this._accept(void 0,!0),!e)return this._backTo(t),!1;i.push(e)}return 0===i.length?(this._backTo(t),!1):(e.appendChild(new Text(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const n=new Variable(t);if(!this._accept(1))return this._accept(6)?this._parseTransform(n)?(e.appendChild(n),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(n),!0):this._backTo(i);for(;;){if(this._accept(4))return e.appendChild(n),!0;if(!this._parse(n))return e.appendChild(new Text("${"+t+":")),n.children.forEach(e.appendChild,e),!0}}_parseTransform(e){let t=new Transform,i="",n="";for(;!this._accept(6);){let e;if(e=this._accept(5,!0))e=this._accept(6,!0)||e,i+=e;else{if(14===this._token.type)return!1;i+=this._accept(void 0,!0)}}for(;!this._accept(6);){let e;if(e=this._accept(5,!0))e=this._accept(5,!0)||this._accept(6,!0)||e,t.appendChild(new Text(e));else if(!this._parseFormatString(t)&&!this._parseAnything(t))return!1}for(;!this._accept(4);){if(14===this._token.type)return!1;n+=this._accept(void 0,!0)}try{t.regexp=new RegExp(i,n)}catch(e2){return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);let n=this._accept(8,!0);if(!n)return this._backTo(t),!1;if(!i)return e.appendChild(new FormatString(Number(n))),!0;if(this._accept(4))return e.appendChild(new FormatString(Number(n))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){let i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new FormatString(Number(n),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){let t=this._until(4);if(t)return e.appendChild(new FormatString(Number(n),void 0,t,void 0)),!0}else if(this._accept(12)){let t=this._until(4);if(t)return e.appendChild(new FormatString(Number(n),void 0,void 0,t)),!0}else if(this._accept(13)){let t=this._until(1);if(t){let i=this._until(4);if(i)return e.appendChild(new FormatString(Number(n),void 0,t,i)),!0}}else{let t=this._until(4);if(t)return e.appendChild(new FormatString(Number(n),void 0,void 0,t)),!0}return this._backTo(t),!1}_parseAnything(e){return 14!==this._token.type&&(e.appendChild(new Text(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}var checkbox="";const defaultOpts$2={inputActiveOptionBorder:Color.fromHex("#007ACC00"),inputActiveOptionForeground:Color.fromHex("#FFFFFF"),inputActiveOptionBackground:Color.fromHex("#0E639C50")};class Checkbox extends Widget{constructor(e){super(),this._onChange=this._register(new Emitter$1),this.onChange=this._onChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._opts=Object.assign(Object.assign({},defaultOpts$2),e),this._checked=this._opts.isChecked;const t=["monaco-custom-checkbox"];this._opts.icon&&t.push(...CSSIcon.asClassNameArray(this._opts.icon)),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,(e=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),e.preventDefault())})),this.ignoreGesture(this.domNode),this.onkeydown(this.domNode,(e=>{if(10===e.keyCode||3===e.keyCode)return this.checked=!this._checked,this._onChange.fire(!0),void e.preventDefault();this._onKeyDown.fire(e)}))}get enabled(){return"true"!==this.domNode.getAttribute("aria-disabled")}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}style(e){e.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=e.inputActiveOptionBorder),e.inputActiveOptionForeground&&(this._opts.inputActiveOptionForeground=e.inputActiveOptionForeground),e.inputActiveOptionBackground&&(this._opts.inputActiveOptionBackground=e.inputActiveOptionBackground),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground?this._opts.inputActiveOptionForeground.toString():"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground?this._opts.inputActiveOptionBackground.toString():"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}const NLS_CASE_SENSITIVE_CHECKBOX_LABEL=localize("caseDescription","Match Case"),NLS_WHOLE_WORD_CHECKBOX_LABEL=localize("wordsDescription","Match Whole Word"),NLS_REGEX_CHECKBOX_LABEL=localize("regexDescription","Use Regular Expression");class CaseSensitiveCheckbox extends Checkbox{constructor(e){super({icon:Codicon.caseSensitive,title:NLS_CASE_SENSITIVE_CHECKBOX_LABEL+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class WholeWordsCheckbox extends Checkbox{constructor(e){super({icon:Codicon.wholeWord,title:NLS_WHOLE_WORD_CHECKBOX_LABEL+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class RegexCheckbox extends Checkbox{constructor(e){super({icon:Codicon.regex,title:NLS_REGEX_CHECKBOX_LABEL+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}function renderText(e,t={}){const i=createElement(t);return i.textContent=e,i}function renderFormattedText(e,t={}){const i=createElement(t);return _renderFormattedText(i,parseFormattedText(e,!!t.renderCodeSegments),t.actionHandler,t.renderCodeSegments),i}function createElement(e){const t=e.inline?"span":"div",i=document.createElement(t);return e.className&&(i.className=e.className),i}class StringStream{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function _renderFormattedText(e,t,i,n){let o;if(2===t.type)o=document.createTextNode(t.content||"");else if(3===t.type)o=document.createElement("b");else if(4===t.type)o=document.createElement("i");else if(7===t.type&&n)o=document.createElement("code");else if(5===t.type&&i){const e=document.createElement("a");i.disposables.add(addStandardDisposableListener(e,"click",(e=>{i.callback(String(t.index),e)}))),o=e}else 8===t.type?o=document.createElement("br"):1===t.type&&(o=e);o&&e!==o&&e.appendChild(o),o&&Array.isArray(t.children)&&t.children.forEach((e=>{_renderFormattedText(o,e,i,n)}))}function parseFormattedText(e,t){const i={type:1,children:[]};let n=0,o=i;const r=[],s=new StringStream(e);for(;!s.eos();){let e=s.next();const i="\\"===e&&0!==formatTagType(s.peek(),t);if(i&&(e=s.next()),!i&&isFormatTag(e,t)&&e===s.peek()){s.advance(),2===o.type&&(o=r.pop());const i=formatTagType(e,t);if(o.type===i||5===o.type&&6===i)o=r.pop();else{const e={type:i,children:[]};5===i&&(e.index=n,n++),o.children.push(e),r.push(o),o=e}}else if("\n"===e)2===o.type&&(o=r.pop()),o.children.push({type:8});else if(2!==o.type){const t={type:2,content:e};o.children.push(t),r.push(o),o=t}else o.content+=e}return 2===o.type&&(o=r.pop()),i}function isFormatTag(e,t){return 0!==formatTagType(e,t)}function formatTagType(e,t){switch(e){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return t?7:0;default:return 0}}class ArrayNavigator{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class HistoryNavigator{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._currentPosition()!==this._elements.length-1?this._navigator.next():null}previous(){return 0!==this._currentPosition()?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new ArrayNavigator(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach((t=>e.push(t))),e}}var inputBox="";const $$9=$$c,defaultOpts$1={inputBackground:Color.fromHex("#3C3C3C"),inputForeground:Color.fromHex("#CCCCCC"),inputValidationInfoBorder:Color.fromHex("#55AAFF"),inputValidationInfoBackground:Color.fromHex("#063B49"),inputValidationWarningBorder:Color.fromHex("#B89500"),inputValidationWarningBackground:Color.fromHex("#352A05"),inputValidationErrorBorder:Color.fromHex("#BE1100"),inputValidationErrorBackground:Color.fromHex("#5A1D1D")};class InputBox extends Widget{constructor(e,t,i){var n;super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new Emitter$1),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i||Object.create(null),mixin(this.options,defaultOpts$1,!1),this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=null!==(n=this.options.tooltip)&&void 0!==n?n:this.placeholder||"",this.ariaLabel=this.options.ariaLabel||"",this.inputBackground=this.options.inputBackground,this.inputForeground=this.options.inputForeground,this.inputBorder=this.options.inputBorder,this.inputValidationInfoBorder=this.options.inputValidationInfoBorder,this.inputValidationInfoBackground=this.options.inputValidationInfoBackground,this.inputValidationInfoForeground=this.options.inputValidationInfoForeground,this.inputValidationWarningBorder=this.options.inputValidationWarningBorder,this.inputValidationWarningBackground=this.options.inputValidationWarningBackground,this.inputValidationWarningForeground=this.options.inputValidationWarningForeground,this.inputValidationErrorBorder=this.options.inputValidationErrorBorder,this.inputValidationErrorBackground=this.options.inputValidationErrorBackground,this.inputValidationErrorForeground=this.options.inputValidationErrorForeground,this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=append$1(e,$$9(".monaco-inputbox.idle"));let o=this.options.flexibleHeight?"textarea":"input",r=append$1(this.element,$$9(".ibwrapper"));if(this.input=append$1(r,$$9(o+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,(()=>this.element.classList.add("synthetic-focus"))),this.onblur(this.input,(()=>this.element.classList.remove("synthetic-focus"))),this.options.flexibleHeight){this.maxHeight="number"==typeof this.options.flexibleMaxHeight?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=append$1(r,$$9("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new ScrollableElement(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),append$1(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll((e=>this.input.scrollTop=e.scrollTop)));const t=this._register(new DomEmitter(document,"selectionchange")),i=Event$1.filter(t.event,(()=>{const e=document.getSelection();return(null==e?void 0:e.anchorNode)===r}));this._register(i(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,(()=>this.onValueChange())),this.onblur(this.input,(()=>this.onBlur())),this.onfocus(this.input,(()=>this.onFocus())),this.ignoreGesture(this.input),setTimeout((()=>this.updateMirror()),0),this.options.actions&&(this.actionbar=this._register(new ActionBar(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.input.title=e}setAriaLabel(e){this.ariaLabel=e,e?this.input.setAttribute("aria-label",this.ariaLabel):this.input.removeAttribute("aria-label")}getAriaLabel(){return this.ariaLabel}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return"number"==typeof this.cachedHeight?this.cachedHeight:getTotalHeight(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return document.activeElement===this.input}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}get width(){return getTotalWidth(this.input)}set width(e){if(this.options.flexibleHeight&&this.options.flexibleWidth){let t=0;if(this.mirror){t=(parseFloat(this.mirror.style.paddingLeft||"")||0)+(parseFloat(this.mirror.style.paddingRight||"")||0)}this.input.style.width=e-t+"px"}else this.input.style.width=e+"px";this.mirror&&(this.mirror.style.width=e+"px")}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if("number"!=typeof this.cachedContentHeight||"number"!=typeof this.cachedHeight||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=i.border?`1px solid ${i.border}`:"",(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),null==e?void 0:e.type}stylesForType(e){switch(e){case 1:return{border:this.inputValidationInfoBorder,background:this.inputValidationInfoBackground,foreground:this.inputValidationInfoForeground};case 2:return{border:this.inputValidationWarningBorder,background:this.inputValidationWarningBackground,foreground:this.inputValidationWarningForeground};default:return{border:this.inputValidationErrorBorder,background:this.inputValidationErrorBackground,foreground:this.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e,t,i=()=>e.style.width=getTotalWidth(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:t=>{if(!this.message)return null;e=append$1(t,$$9(".monaco-inputbox-container")),i();const n={inline:!0,className:"monaco-inputbox-message"},o=this.message.formatContent?renderFormattedText(this.message.content,n):renderText(this.message.content,n);o.classList.add(this.classForType(this.message.type));const r=this.stylesForType(this.message.type);return o.style.backgroundColor=r.background?r.background.toString():"",o.style.color=r.foreground?r.foreground.toString():"",o.style.border=r.border?`1px solid ${r.border}`:"",append$1(e,o),null},onHide:()=>{this.state="closed"},layout:i}),t=3===this.message.type?localize("alertErrorMessage","Error: {0}",this.message.content):2===this.message.type?localize("alertWarningMessage","Warning: {0}",this.message.content):localize("alertInfoMessage","Info: {0}",this.message.content),alert(t),this.state="open"}_hideMessage(){this.contextViewProvider&&("open"===this.state&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),"open"===this.state&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,t=10===e.charCodeAt(e.length-1)?" ":"";(e+t).replace(/\u000c/g,"")?this.mirror.textContent=e+t:this.mirror.innerText=" ",this.layout()}style(e){this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){const e=this.inputBackground?this.inputBackground.toString():"",t=this.inputForeground?this.inputForeground.toString():"",i=this.inputBorder?this.inputBorder.toString():"";this.element.style.backgroundColor=e,this.element.style.color=t,this.input.style.backgroundColor="inherit",this.input.style.color=t,this.element.style.borderWidth=i?"1px":"",this.element.style.borderStyle=i?"solid":"",this.element.style.borderColor=i}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=getTotalHeight(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,o=t.value;null!==i&&null!==n&&(this.value=o.substr(0,i)+e+o.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar&&this.actionbar.dispose(),super.dispose()}}class HistoryInputBox extends InputBox{constructor(e,t,i){const n=localize({key:"history.inputbox.hint",comment:["Text will be prefixed with ⇅ plus a single space, then used as a hint where input field keeps history"]},"for history"),o=` or ⇅ ${n}`,r=` (⇅ ${n})`;super(e,t,i),this.history=new HistoryNavigator(i.history,100);const s=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(o)&&!this.placeholder.endsWith(r)&&this.history.getHistory().length){const e=this.placeholder.endsWith(")")?o:r,t=this.placeholder+e;i.showPlaceholderOnFocus&&document.activeElement!==this.input?this.placeholder=t:this.setPlaceHolder(t)}};this.observer=new MutationObserver(((e,t)=>{e.forEach((e=>{e.target.textContent||s()}))})),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,(()=>s())),this.onblur(this.input,(()=>{const e=e=>{if(this.placeholder.endsWith(e)){const t=this.placeholder.slice(0,this.placeholder.length-e.length);return i.showPlaceholderOnFocus?this.placeholder=t:this.setPlaceHolder(t),!0}return!1};e(r)||e(o)}))}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(){this.value&&this.value!==this.getCurrentValue()&&this.history.add(this.value)}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),e&&(this.value=e,status(this.value))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,status(this.value))}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()||this.history.last()}}var findInput="";const NLS_DEFAULT_LABEL$1=localize("defaultLabel","input");class FindInput extends Widget{constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this._onDidOptionChange=this._register(new Emitter$1),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$1),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new Emitter$1),this._onKeyUp=this._register(new Emitter$1),this._onCaseSensitiveKeyDown=this._register(new Emitter$1),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new Emitter$1),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||NLS_DEFAULT_LABEL$1,this.inputActiveOptionBorder=n.inputActiveOptionBorder,this.inputActiveOptionForeground=n.inputActiveOptionForeground,this.inputActiveOptionBackground=n.inputActiveOptionBackground,this.inputBackground=n.inputBackground,this.inputForeground=n.inputForeground,this.inputBorder=n.inputBorder,this.inputValidationInfoBorder=n.inputValidationInfoBorder,this.inputValidationInfoBackground=n.inputValidationInfoBackground,this.inputValidationInfoForeground=n.inputValidationInfoForeground,this.inputValidationWarningBorder=n.inputValidationWarningBorder,this.inputValidationWarningBackground=n.inputValidationWarningBackground,this.inputValidationWarningForeground=n.inputValidationWarningForeground,this.inputValidationErrorBorder=n.inputValidationErrorBorder,this.inputValidationErrorBackground=n.inputValidationErrorBackground,this.inputValidationErrorForeground=n.inputValidationErrorForeground;const o=n.appendCaseSensitiveLabel||"",r=n.appendWholeWordsLabel||"",s=n.appendRegexLabel||"",a=n.history||[],l=!!n.flexibleHeight,d=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:a,showHistoryHint:n.showHistoryHint,flexibleHeight:l,flexibleWidth:d,flexibleMaxHeight:c})),this.regex=this._register(new RegexCheckbox({appendTitle:s,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.regex.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.regex.onKeyDown((e=>{this._onRegexKeyDown.fire(e)}))),this.wholeWords=this._register(new WholeWordsCheckbox({appendTitle:r,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.wholeWords.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this.caseSensitive=this._register(new CaseSensitiveCheckbox({appendTitle:o,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.caseSensitive.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.caseSensitive.onKeyDown((e=>{this._onCaseSensitiveKeyDown.fire(e)}))),this._showOptionButtons&&(this.inputBox.paddingRight=this.caseSensitive.width()+this.wholeWords.width()+this.regex.width());let h=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,(e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=h.indexOf(document.activeElement);if(t>=0){let i=-1;e.equals(17)?i=(t+1)%h.length:e.equals(15)&&(i=0===t?h.length-1:t-1),e.equals(9)?(h[t].blur(),this.inputBox.focus()):i>=0&&h[i].focus(),EventHelper.stop(e,!0)}}})),this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this._showOptionButtons?"block":"none",this.controls.appendChild(this.caseSensitive.domNode),this.controls.appendChild(this.wholeWords.domNode),this.controls.appendChild(this.regex.domNode),this.domNode.appendChild(this.controls),e&&e.appendChild(this.domNode),this._register(addDisposableListener(this.inputBox.inputElement,"compositionstart",(e=>{this.imeSessionInProgress=!0}))),this._register(addDisposableListener(this.inputBox.inputElement,"compositionend",(e=>{this.imeSessionInProgress=!1,this._onInput.fire()}))),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.regex.style(e),this.wholeWords.style(e),this.caseSensitive.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(e){this.caseSensitive.checked=e}getWholeWords(){return this.wholeWords.checked}setWholeWords(e){this.wholeWords.checked=e}getRegex(){return this.regex.checked}setRegex(e){this.regex.checked=e,this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}clearMessage(){this.inputBox.hideMessage()}}const NLS_DEFAULT_LABEL=localize("defaultLabel","input"),NLS_PRESERVE_CASE_LABEL=localize("label.preserveCaseCheckbox","Preserve Case");class PreserveCaseCheckbox extends Checkbox{constructor(e){super({icon:Codicon.preserveCase,title:NLS_PRESERVE_CASE_LABEL+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class ReplaceInput extends Widget{constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new Emitter$1),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new Emitter$1),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new Emitter$1),this._onInput=this._register(new Emitter$1),this._onKeyUp=this._register(new Emitter$1),this._onPreserveCaseKeyDown=this._register(new Emitter$1),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||NLS_DEFAULT_LABEL,this.inputActiveOptionBorder=n.inputActiveOptionBorder,this.inputActiveOptionForeground=n.inputActiveOptionForeground,this.inputActiveOptionBackground=n.inputActiveOptionBackground,this.inputBackground=n.inputBackground,this.inputForeground=n.inputForeground,this.inputBorder=n.inputBorder,this.inputValidationInfoBorder=n.inputValidationInfoBorder,this.inputValidationInfoBackground=n.inputValidationInfoBackground,this.inputValidationInfoForeground=n.inputValidationInfoForeground,this.inputValidationWarningBorder=n.inputValidationWarningBorder,this.inputValidationWarningBackground=n.inputValidationWarningBackground,this.inputValidationWarningForeground=n.inputValidationWarningForeground,this.inputValidationErrorBorder=n.inputValidationErrorBorder,this.inputValidationErrorBackground=n.inputValidationErrorBackground,this.inputValidationErrorForeground=n.inputValidationErrorForeground;const o=n.appendPreserveCaseLabel||"",r=n.history||[],s=!!n.flexibleHeight,a=!!n.flexibleWidth,l=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new HistoryInputBox(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:r,showHistoryHint:n.showHistoryHint,flexibleHeight:s,flexibleWidth:a,flexibleMaxHeight:l})),this.preserveCase=this._register(new PreserveCaseCheckbox({appendTitle:o,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange((e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()}))),this._register(this.preserveCase.onKeyDown((e=>{this._onPreserveCaseKeyDown.fire(e)}))),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let d=[this.preserveCase.domNode];this.onkeydown(this.domNode,(e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=d.indexOf(document.activeElement);if(t>=0){let i=-1;e.equals(17)?i=(t+1)%d.length:e.equals(15)&&(i=0===t?d.length-1:t-1),e.equals(9)?(d[t].blur(),this.inputBox.focus()):i>=0&&d[i].focus(),EventHelper.stop(e,!0)}}}));let c=document.createElement("div");c.className="controls",c.style.display=this._showOptionButtons?"block":"none",c.appendChild(this.preserveCase.domNode),this.domNode.appendChild(c),e&&e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,(e=>this._onKeyDown.fire(e))),this.onkeyup(this.inputBox.inputElement,(e=>this._onKeyUp.fire(e))),this.oninput(this.inputBox.inputElement,(e=>this._onInput.fire())),this.onmousedown(this.inputBox.inputElement,(e=>this._onMouseDown.fire(e)))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){const e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(e);const t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=e,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var __decorate$14=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$13=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const historyNavigationVisible=new RawContextKey("suggestWidgetVisible",!1,localize("suggestWidgetVisible","Whether suggestion are visible")),HistoryNavigationWidgetContext="historyNavigationWidget",HistoryNavigationForwardsEnablementContext="historyNavigationForwardsEnabled",HistoryNavigationBackwardsEnablementContext="historyNavigationBackwardsEnabled";function bindContextScopedWidget(e,t,i){new RawContextKey(i,t).bindTo(e)}function createWidgetScopedContextKeyService(e,t){return e.createScoped(t.target)}function getContextScopedWidget(e,t){return e.getContext(document.activeElement).getValue(t)}function createAndBindHistoryNavigationWidgetScopedContextKeyService(e,t){const i=createWidgetScopedContextKeyService(e,t);bindContextScopedWidget(i,t,HistoryNavigationWidgetContext);return{scopedContextKeyService:i,historyNavigationForwardsEnablement:new RawContextKey(HistoryNavigationForwardsEnablementContext,!0).bindTo(i),historyNavigationBackwardsEnablement:new RawContextKey(HistoryNavigationBackwardsEnablementContext,!0).bindTo(i)}}let ContextScopedFindInput=class extends FindInput{constructor(e,t,i,n,o=!1){super(e,t,o,i),this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(n,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};ContextScopedFindInput=__decorate$14([__param$13(3,IContextKeyService)],ContextScopedFindInput);let ContextScopedReplaceInput=class extends ReplaceInput{constructor(e,t,i,n,o=!1){super(e,t,o,i),this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(n,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};ContextScopedReplaceInput=__decorate$14([__param$13(3,IContextKeyService)],ContextScopedReplaceInput),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext),ContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext,!0),historyNavigationVisible.isEqualTo(!1)),primary:16,secondary:[528],handler:e=>{const t=getContextScopedWidget(e.get(IContextKeyService),HistoryNavigationWidgetContext);if(t){t.historyNavigator.showPreviousValue()}}}),KeybindingsRegistry.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext),ContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext,!0),historyNavigationVisible.isEqualTo(!1)),primary:18,secondary:[530],handler:e=>{const t=getContextScopedWidget(e.get(IContextKeyService),HistoryNavigationWidgetContext);if(t){t.historyNavigator.showNextValue()}}});var __awaiter$G=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const Context$2={Visible:historyNavigationVisible,DetailsVisible:new RawContextKey("suggestWidgetDetailsVisible",!1,localize("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new RawContextKey("suggestWidgetMultipleSuggestions",!1,localize("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new RawContextKey("suggestionMakesTextEdit",!0,localize("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new RawContextKey("acceptSuggestionOnEnter",!0,localize("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new RawContextKey("suggestionHasInsertAndReplaceRange",!1,localize("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new RawContextKey("suggestionInsertMode",void 0,{type:"string",description:localize("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new RawContextKey("suggestionCanResolve",!1,localize("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},suggestWidgetStatusbarMenu=new MenuId("suggestWidgetStatusBar");class CompletionItem{constructor(e,t,i,n){this.position=e,this.completion=t,this.container=i,this.provider=n,this.isInvalid=!1,this.score=FuzzyScore.Default,this.distance=0,this.textLabel="string"==typeof t.label?t.label:t.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),Range$2.isIRange(t.range)?(this.editStart=new Position$1(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new Position$1(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new Position$1(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new Position$1(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new Position$1(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new Position$1(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||Range$2.spansMultipleLines(t.range.insert)||Range$2.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),"function"!=typeof n.resolveCompletionItem&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(e){return __awaiter$G(this,void 0,void 0,(function*(){if(!this._resolveCache){const t=e.onCancellationRequested((()=>{this._resolveCache=void 0,this._isResolved=!1}));this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then((e=>{Object.assign(this.completion,e),this._isResolved=!0,t.dispose()}),(e=>{isCancellationError(e)&&(this._resolveCache=void 0,this._isResolved=!1)}))}return this._resolveCache}))}}class CompletionOptions{constructor(e=2,t=new Set,i=new Set,n=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.showDeprecated=n}}let _snippetSuggestSupport;function getSnippetSuggestSupport(){return _snippetSuggestSupport}CompletionOptions.default=new CompletionOptions;class CompletionItemModel{constructor(e,t,i,n){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=n}}function provideSuggestionItems(e,t,i,n=CompletionOptions.default,o={triggerKind:0},r=CancellationToken.None){return __awaiter$G(this,void 0,void 0,(function*(){const s=new StopWatch(!0);i=i.clone();const a=t.getWordAtPosition(i),l=a?new Range$2(i.lineNumber,a.startColumn,i.lineNumber,a.endColumn):Range$2.fromPositions(i),d={replace:l,insert:l.setEndPosition(i.lineNumber,i.column)},c=[],h=new DisposableStore,u=[];let g=!1;const p=(e,t,o)=>{var r,s,a;let l=!1;if(!t)return l;for(let h of t.suggestions)if(!n.kindFilter.has(h.kind)){if(!n.showDeprecated&&(null===(r=null==h?void 0:h.tags)||void 0===r?void 0:r.includes(1)))continue;h.range||(h.range=d),h.sortText||(h.sortText="string"==typeof h.label?h.label:h.label.label),!g&&h.insertTextRules&&4&h.insertTextRules&&(g=SnippetParser.guessNeedsClipboard(h.insertText)),c.push(new CompletionItem(i,h,t,e)),l=!0}return isDisposable(t)&&h.add(t),u.push({providerName:null!==(s=e._debugDisplayName)&&void 0!==s?s:"unknown_provider",elapsedProvider:null!==(a=t.duration)&&void 0!==a?a:-1,elapsedOverall:o.elapsed()}),l},m=(()=>__awaiter$G(this,void 0,void 0,(function*(){})))();for(let f of e.orderedGroups(t)){let e=!1;if(yield Promise.all(f.map((s=>__awaiter$G(this,void 0,void 0,(function*(){if(!(n.providerFilter.size>0)||n.providerFilter.has(s))try{const n=new StopWatch(!0),a=yield s.provideCompletionItems(t,i,o,r);e=p(s,a,n)||e}catch(a){onUnexpectedExternalError(a)}}))))),e||r.isCancellationRequested)break}return yield m,r.isCancellationRequested?(h.dispose(),Promise.reject(canceled())):new CompletionItemModel(c.sort(getSuggestionComparator(n.snippetSortOrder)),g,{entries:u,elapsed:s.elapsed()},h)}))}function defaultComparator(e,t){if(e.sortTextLow&&t.sortTextLow){if(e.sortTextLow<t.sortTextLow)return-1;if(e.sortTextLow>t.sortTextLow)return 1}return e.completion.label<t.completion.label?-1:e.completion.label>t.completion.label?1:e.completion.kind-t.completion.kind}function snippetUpComparator(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return defaultComparator(e,t)}function snippetDownComparator(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return defaultComparator(e,t)}const _snippetComparators=new Map;function getSuggestionComparator(e){return _snippetComparators.get(e)}let _onlyOnceProvider;_snippetComparators.set(0,snippetUpComparator),_snippetComparators.set(2,snippetDownComparator),_snippetComparators.set(1,defaultComparator),CommandsRegistry.registerCommand("_executeCompletionItemProvider",((e,...t)=>__awaiter$G(void 0,void 0,void 0,(function*(){const[i,n,o,r]=t;assertType(URI.isUri(i)),assertType(Position$1.isIPosition(n)),assertType("string"==typeof o||!o),assertType("number"==typeof r||!r);const{completionProvider:s}=e.get(ILanguageFeaturesService),a=yield e.get(ITextModelService).createModelReference(i);try{const e={incomplete:!1,suggestions:[]},t=[],i=yield provideSuggestionItems(s,a.object.textEditorModel,Position$1.lift(n),void 0,{triggerCharacter:o,triggerKind:o?1:0});for(const n of i.items)t.length<(null!=r?r:0)&&t.push(n.resolve(CancellationToken.None)),e.incomplete=e.incomplete||n.container.incomplete,e.suggestions.push(n.completion);try{return yield Promise.all(t),e}finally{setTimeout((()=>i.disposable.dispose()),100)}}finally{a.dispose()}}))));let _onlyOnceSuggestions=[];function showSimpleSuggestions(e,t,i){const{completionProvider:n}=e.get(ILanguageFeaturesService);_onlyOnceProvider||(_onlyOnceProvider=new class{provideCompletionItems(){let e={suggestions:_onlyOnceSuggestions.slice(0)};return _onlyOnceSuggestions.length=0,e}},n.register("*",_onlyOnceProvider)),setTimeout((()=>{var e;_onlyOnceSuggestions.push(...i),null===(e=t.getContribution("editor.contrib.suggestController"))||void 0===e||e.triggerSuggest((new Set).add(_onlyOnceProvider))}),0)}var __decorate$13=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$12=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const $$8=$$c;let ContentHoverController=class e extends Disposable{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._widget=this._register(this._instantiationService.createInstance(ContentHoverWidget,this._editor)),this._decorationsChangerListener=this._register(new EditorDecorationsChangerListener(this._editor)),this._messages=[],this._messagesAreComplete=!1,this._participants=[];for(const n of HoverParticipantRegistry.getAll())this._participants.push(this._instantiationService.createInstance(n,this._editor));this._participants.sort(((e,t)=>e.hoverOrdinal-t.hoverOrdinal)),this._computer=new ContentHoverComputer(this._editor,this._participants),this._hoverOperation=this._register(new HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{this._withResult(e.value,e.isComplete,e.hasLoadingMessage)}))),this._register(this._decorationsChangerListener.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(addStandardDisposableListener(this._widget.getDomNode(),"keydown",(e=>{e.equals(9)&&this.hide()}))),this._register(TokenizationRegistry.onDidChange((()=>{this._widget.position&&this._computer.anchor&&this._messages.length>0&&(this._widget.clear(),this._renderMessages(this._computer.anchor,this._messages))})))}_onModelDecorationsChanged(){this._widget.position&&(this._hoverOperation.cancel(),this._widget.isColorPickerVisible||this._hoverOperation.start(0))}maybeShowAt(e){const t=[];for(const n of this._participants)if(n.suggestHoverAnchor){const i=n.suggestHoverAnchor(e);i&&t.push(i)}const i=e.target;if(6===i.type&&t.push(new HoverRangeAnchor(0,i.range)),7===i.type){const e=this._editor.getOption(44).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&"number"==typeof i.detail.horizontalDistanceToText&&i.detail.horizontalDistanceToText<e&&t.push(new HoverRangeAnchor(0,i.range))}return 0!==t.length&&(t.sort(((e,t)=>t.priority-e.priority)),this._startShowingAt(t[0],0,!1),!0)}startShowingAtRange(e,t,i){this._startShowingAt(new HoverRangeAnchor(0,e),t,i)}_startShowingAt(e,t,i){if(!this._computer.anchor||!this._computer.anchor.equals(e)){if(this._hoverOperation.cancel(),this._widget.position)if(this._computer.anchor&&e.canAdoptVisibleHover(this._computer.anchor,this._widget.position)){const t=this._messages.filter((t=>t.isValidForHoverAnchor(e)));if(0===t.length)this.hide();else{if(t.length===this._messages.length&&this._messagesAreComplete)return;this._renderMessages(e,t)}}else this.hide();this._computer.anchor=e,this._computer.shouldFocus=i,this._hoverOperation.start(t)}}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._widget.hide()}isColorPickerVisible(){return this._widget.isColorPickerVisible}_addLoadingMessage(e){if(this._computer.anchor)for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e,t,i){this._messages=i?this._addLoadingMessage(e):e,this._messagesAreComplete=t,this._computer.anchor&&this._messages.length>0?this._renderMessages(this._computer.anchor,this._messages):t&&this.hide()}_renderMessages(t,i){let n=1073741824,o=i[0].range,r=null;for(const e of i)n=Math.min(n,e.range.startColumn),o=Range$2.plusRange(o,e.range),e.forceShowAtRange&&(r=e.range);const s=new DisposableStore,a=s.add(new EditorHoverStatusBar(this._keybindingService)),l=document.createDocumentFragment();let d=null;const c={fragment:l,statusBar:a,setColorPicker:e=>d=e,onContentsChanged:()=>this._widget.onContentsChanged(),hide:()=>this.hide()};for(const e of this._participants){const t=i.filter((t=>t.owner===e));t.length>0&&s.add(e.renderHoverParts(c,t))}if(a.hasContent&&l.appendChild(a.hoverElement),l.hasChildNodes()){if(o){const t=this._decorationsChangerListener.deltaDecorations([],[{range:o,options:e._DECORATION_OPTIONS}]);s.add(toDisposable((()=>{this._decorationsChangerListener.deltaDecorations(t,[])})))}this._widget.showAt(l,new ContentHoverVisibleData(d,r?r.getStartPosition():new Position$1(t.range.startLineNumber,n),r||o,this._editor.getOption(53).above,this._computer.shouldFocus,s))}else s.dispose()}};ContentHoverController._DECORATION_OPTIONS=ModelDecorationOptions.register({description:"content-hover-highlight",className:"hoverHighlight"}),ContentHoverController=__decorate$13([__param$12(1,IInstantiationService),__param$12(2,IKeybindingService)],ContentHoverController);class EditorDecorationsChangerListener extends Disposable{constructor(e){super(),this._editor=e,this._onDidChangeModelDecorations=this._register(new Emitter$1),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._isChangingDecorations=!1,this._register(this._editor.onDidChangeModelDecorations((e=>{this._isChangingDecorations||this._onDidChangeModelDecorations.fire(e)})))}deltaDecorations(e,t){try{return this._isChangingDecorations=!0,this._editor.deltaDecorations(e,t)}finally{this._isChangingDecorations=!1}}}class ContentHoverVisibleData{constructor(e,t,i,n,o,r){this.colorPicker=e,this.showAtPosition=t,this.showAtRange=i,this.preferAbove=n,this.stoleFocus=o,this.disposables=r}}let ContentHoverWidget=class e extends Disposable{constructor(e,t){super(),this._editor=e,this._contextKeyService=t,this.allowEditorOverflow=!0,this._hoverVisibleKey=EditorContextKeys.hoverVisible.bindTo(this._contextKeyService),this._hover=this._register(new HoverWidget),this._visibleData=null,this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._setVisibleData(null),this._layout(),this._editor.addContentWidget(this)}get position(){var e,t;return null!==(t=null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition)&&void 0!==t?t:null}get isColorPickerVisible(){var e;return Boolean(null===(e=this._visibleData)||void 0===e?void 0:e.colorPicker)}dispose(){this._editor.removeContentWidget(this),this._visibleData&&this._visibleData.disposables.dispose(),super.dispose()}getId(){return e.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){if(!this._visibleData)return null;let e=this._visibleData.preferAbove;return!e&&this._contextKeyService.getContextKeyValue(Context$2.Visible.key)&&(e=!0),{position:this._visibleData.showAtPosition,range:this._visibleData.showAtRange,preference:e?[1,2]:[2,1]}}_setVisibleData(e){this._visibleData&&this._visibleData.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!this._visibleData),this._hover.containerDomNode.classList.toggle("hidden",!this._visibleData)}_layout(){const e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:i}=this._editor.getOption(44);this._hover.contentsDomNode.style.fontSize=`${t}px`,this._hover.contentsDomNode.style.lineHeight=""+i/t,this._hover.contentsDomNode.style.maxHeight=`${e}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((e=>this._editor.applyFontInfo(e)))}showAt(e,t){this._setVisibleData(t),this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._hover.contentsDomNode.style.paddingBottom="",this._updateFont(),this._editor.layoutContentWidget(this),this.onContentsChanged(),this._editor.render(),this._editor.layoutContentWidget(this),this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),t.colorPicker&&t.colorPicker.layout()}hide(){if(this._visibleData){const e=this._visibleData.stoleFocus;this._setVisibleData(null),this._editor.layoutContentWidget(this),e&&this._editor.focus()}}onContentsChanged(){this._hover.onContentsChanged();const e=this._hover.scrollbar.getScrollDimensions();if(e.scrollWidth>e.width){const e=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingBottom!==e&&(this._hover.contentsDomNode.style.paddingBottom=e,this._editor.layoutContentWidget(this),this._hover.onContentsChanged())}}clear(){this._hover.contentsDomNode.textContent=""}};ContentHoverWidget.ID="editor.contrib.contentHoverWidget",ContentHoverWidget=__decorate$13([__param$12(1,IContextKeyService)],ContentHoverWidget);let EditorHoverStatusBar=class extends Disposable{constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=$$8("div.hover-row.status-bar"),this.actionsElement=append$1(this.hoverElement,$$8("div.actions"))}get hasContent(){return this._hasContent}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(HoverAction.render(this.actionsElement,e,i))}append(e){const t=append$1(this.actionsElement,e);return this._hasContent=!0,t}};EditorHoverStatusBar=__decorate$13([__param$12(0,IKeybindingService)],EditorHoverStatusBar);class ContentHoverComputer{constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1}get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}static _getLineDecorations(e,t){if(1!==t.type)return[];const i=e.getModel(),n=t.range.startLineNumber,o=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter((e=>{if(e.options.isWholeLine)return!0;const i=e.range.startLineNumber===n?e.range.startColumn:1,r=e.range.endLineNumber===n?e.range.endColumn:o;if(e.options.showIfCollapsed){if(i>t.range.startColumn+1||t.range.endColumn-1>r)return!1}else if(i>t.range.startColumn||t.range.endColumn>r)return!1;return!0}))}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return AsyncIterableObject.EMPTY;const i=ContentHoverComputer._getLineDecorations(this._editor,t);return AsyncIterableObject.merge(this._participants.map((n=>n.computeAsync?n.computeAsync(t,i,e):AsyncIterableObject.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=ContentHoverComputer._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return coalesce(t)}}
/*! @license DOMPurify 2.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.1/LICENSE */function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var hasOwnProperty$1=Object.hasOwnProperty,setPrototypeOf=Object.setPrototypeOf,isFrozen=Object.isFrozen,getPrototypeOf=Object.getPrototypeOf,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,freeze=Object.freeze,seal=Object.seal,create$1=Object.create,_ref="undefined"!=typeof Reflect&&Reflect,apply=_ref.apply,construct=_ref.construct;apply||(apply=function(e,t,i){return e.apply(t,i)}),freeze||(freeze=function(e){return e}),seal||(seal=function(e){return e}),construct||(construct=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(_toConsumableArray(t))))});var arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(e){return function(t){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return apply(e,t,n)}}function unconstruct(e){return function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return construct(e,i)}}function addToSet(e,t){setPrototypeOf&&setPrototypeOf(e,null);for(var i=t.length;i--;){var n=t[i];if("string"==typeof n){var o=stringToLowerCase(n);o!==n&&(isFrozen(t)||(t[i]=o),n=o)}e[n]=!0}return e}function clone(e){var t=create$1(null),i=void 0;for(i in e)apply(hasOwnProperty$1,e,[i])&&(t[i]=e[i]);return t}function lookupGetter(e,t){for(;null!==e;){var i=getOwnPropertyDescriptor(e,t);if(i){if(i.get)return unapply(i.get);if("function"==typeof i.value)return unapply(i.value)}e=getPrototypeOf(e)}return function(e){return null}}var html=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html$1=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg$1=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl$1=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\s\S]*|[\s\S]*\}\}/gm),ERB_EXPR=seal(/<%[\s\S]*|[\s\S]*%>/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray$1(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var getGlobal=function(){return"undefined"==typeof window?null:window},_createTrustedTypesPolicy=function(e,t){if("object"!==(void 0===e?"undefined":_typeof(e))||"function"!=typeof e.createPolicy)return null;var i=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(i=t.currentScript.getAttribute(n));var o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(r){return null}};function createDOMPurify(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:getGlobal(),t=function(e){return createDOMPurify(e)};if(t.version="2.3.1",t.removed=[],!e||!e.document||9!==e.document.nodeType)return t.isSupported=!1,t;var i=e.document,n=e.document,o=e.DocumentFragment,r=e.HTMLTemplateElement,s=e.Node,a=e.Element,l=e.NodeFilter,d=e.NamedNodeMap,c=void 0===d?e.NamedNodeMap||e.MozNamedAttrMap:d,h=e.Text,u=e.Comment,g=e.DOMParser,p=e.trustedTypes,m=a.prototype,f=lookupGetter(m,"cloneNode"),_=lookupGetter(m,"nextSibling"),C=lookupGetter(m,"childNodes"),v=lookupGetter(m,"parentNode");if("function"==typeof r){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var S=_createTrustedTypesPolicy(p,i),y=S&&ee?S.createHTML(""):"",w=n,E=w.implementation,L=w.createNodeIterator,x=w.createDocumentFragment,D=w.getElementsByTagName,I=i.importNode,k={};try{k=clone(n).documentMode?n.documentMode:{}}catch(Oe){}var T={};t.isSupported="function"==typeof v&&E&&void 0!==E.createHTMLDocument&&9!==k;var N=MUSTACHE_EXPR,M=ERB_EXPR,R=DATA_ATTR,A=ARIA_ATTR,O=IS_SCRIPT_OR_DATA,P=ATTR_WHITESPACE,F=IS_ALLOWED_URI,B=null,$=addToSet({},[].concat(_toConsumableArray$1(html),_toConsumableArray$1(svg),_toConsumableArray$1(svgFilters),_toConsumableArray$1(mathMl),_toConsumableArray$1(text))),W=null,V=addToSet({},[].concat(_toConsumableArray$1(html$1),_toConsumableArray$1(svg$1),_toConsumableArray$1(mathMl$1),_toConsumableArray$1(xml))),z=null,H=null,K=!0,U=!0,j=!1,G=!1,q=!1,Z=!1,Y=!1,X=!1,Q=!1,J=!0,ee=!1,te=!0,ie=!0,ne=!1,oe={},re=null,se=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ae=null,le=addToSet({},["audio","video","img","source","image","track"]),de=null,ce=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",ue="http://www.w3.org/2000/svg",ge="http://www.w3.org/1999/xhtml",pe=ge,me=!1,fe=null,_e=n.createElement("form"),Ce=function(e){fe&&fe===e||(e&&"object"===(void 0===e?"undefined":_typeof(e))||(e={}),e=clone(e),B="ALLOWED_TAGS"in e?addToSet({},e.ALLOWED_TAGS):$,W="ALLOWED_ATTR"in e?addToSet({},e.ALLOWED_ATTR):V,de="ADD_URI_SAFE_ATTR"in e?addToSet(clone(ce),e.ADD_URI_SAFE_ATTR):ce,ae="ADD_DATA_URI_TAGS"in e?addToSet(clone(le),e.ADD_DATA_URI_TAGS):le,re="FORBID_CONTENTS"in e?addToSet({},e.FORBID_CONTENTS):se,z="FORBID_TAGS"in e?addToSet({},e.FORBID_TAGS):{},H="FORBID_ATTR"in e?addToSet({},e.FORBID_ATTR):{},oe="USE_PROFILES"in e&&e.USE_PROFILES,K=!1!==e.ALLOW_ARIA_ATTR,U=!1!==e.ALLOW_DATA_ATTR,j=e.ALLOW_UNKNOWN_PROTOCOLS||!1,G=e.SAFE_FOR_TEMPLATES||!1,q=e.WHOLE_DOCUMENT||!1,X=e.RETURN_DOM||!1,Q=e.RETURN_DOM_FRAGMENT||!1,J=!1!==e.RETURN_DOM_IMPORT,ee=e.RETURN_TRUSTED_TYPE||!1,Y=e.FORCE_BODY||!1,te=!1!==e.SANITIZE_DOM,ie=!1!==e.KEEP_CONTENT,ne=e.IN_PLACE||!1,F=e.ALLOWED_URI_REGEXP||F,pe=e.NAMESPACE||ge,G&&(U=!1),Q&&(X=!0),oe&&(B=addToSet({},[].concat(_toConsumableArray$1(text))),W=[],!0===oe.html&&(addToSet(B,html),addToSet(W,html$1)),!0===oe.svg&&(addToSet(B,svg),addToSet(W,svg$1),addToSet(W,xml)),!0===oe.svgFilters&&(addToSet(B,svgFilters),addToSet(W,svg$1),addToSet(W,xml)),!0===oe.mathMl&&(addToSet(B,mathMl),addToSet(W,mathMl$1),addToSet(W,xml))),e.ADD_TAGS&&(B===$&&(B=clone(B)),addToSet(B,e.ADD_TAGS)),e.ADD_ATTR&&(W===V&&(W=clone(W)),addToSet(W,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&addToSet(de,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(re===se&&(re=clone(re)),addToSet(re,e.FORBID_CONTENTS)),ie&&(B["#text"]=!0),q&&addToSet(B,["html","head","body"]),B.table&&(addToSet(B,["tbody"]),delete z.tbody),freeze&&freeze(e),fe=e)},ve=addToSet({},["mi","mo","mn","ms","mtext"]),be=addToSet({},["foreignobject","desc","title","annotation-xml"]),Se=addToSet({},svg);addToSet(Se,svgFilters),addToSet(Se,svgDisallowed);var ye=addToSet({},mathMl);addToSet(ye,mathMlDisallowed);var we=function(e){var t=v(e);t&&t.tagName||(t={namespaceURI:ge,tagName:"template"});var i=stringToLowerCase(e.tagName),n=stringToLowerCase(t.tagName);if(e.namespaceURI===ue)return t.namespaceURI===ge?"svg"===i:t.namespaceURI===he?"svg"===i&&("annotation-xml"===n||ve[n]):Boolean(Se[i]);if(e.namespaceURI===he)return t.namespaceURI===ge?"math"===i:t.namespaceURI===ue?"math"===i&&be[n]:Boolean(ye[i]);if(e.namespaceURI===ge){if(t.namespaceURI===ue&&!be[n])return!1;if(t.namespaceURI===he&&!ve[n])return!1;var o=addToSet({},["title","style","font","a","script"]);return!ye[i]&&(o[i]||!Se[i])}return!1},Ee=function(e){arrayPush(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Oe){try{e.outerHTML=y}catch(i){e.remove()}}},Le=function(e,i){try{arrayPush(t.removed,{attribute:i.getAttributeNode(e),from:i})}catch(Oe){arrayPush(t.removed,{attribute:null,from:i})}if(i.removeAttribute(e),"is"===e&&!W[e])if(X||Q)try{Ee(i)}catch(Oe){}else try{i.setAttribute(e,"")}catch(Oe){}},xe=function(e){var t=void 0,i=void 0;if(Y)e="<remove></remove>"+e;else{var o=stringMatch(e,/^[\r\n\t ]+/);i=o&&o[0]}var r=S?S.createHTML(e):e;if(pe===ge)try{t=(new g).parseFromString(r,"text/html")}catch(Oe){}if(!t||!t.documentElement){t=E.createDocument(pe,"template",null);try{t.documentElement.innerHTML=me?"":r}catch(Oe){}}var s=t.body||t.documentElement;return e&&i&&s.insertBefore(n.createTextNode(i),s.childNodes[0]||null),pe===ge?D.call(t,q?"html":"body")[0]:q?t.documentElement:s},De=function(e){return L.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Ie=function(e){return!(e instanceof h||e instanceof u)&&!("string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof c&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore)},ke=function(e){return"object"===(void 0===s?"undefined":_typeof(s))?e instanceof s:e&&"object"===(void 0===e?"undefined":_typeof(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Te=function(e,i,n){T[e]&&arrayForEach(T[e],(function(e){e.call(t,i,n,fe)}))},Ne=function(e){var i=void 0;if(Te("beforeSanitizeElements",e,null),Ie(e))return Ee(e),!0;if(stringMatch(e.nodeName,/[\u0080-\uFFFF]/))return Ee(e),!0;var n=stringToLowerCase(e.nodeName);if(Te("uponSanitizeElement",e,{tagName:n,allowedTags:B}),!ke(e.firstElementChild)&&(!ke(e.content)||!ke(e.content.firstElementChild))&&regExpTest(/<[/\w]/g,e.innerHTML)&&regExpTest(/<[/\w]/g,e.textContent))return Ee(e),!0;if("select"===n&&regExpTest(/<template/i,e.innerHTML))return Ee(e),!0;if(!B[n]||z[n]){if(ie&&!re[n]){var o=v(e)||e.parentNode,r=C(e)||e.childNodes;if(r&&o)for(var s=r.length-1;s>=0;--s)o.insertBefore(f(r[s],!0),_(e))}return Ee(e),!0}return e instanceof a&&!we(e)?(Ee(e),!0):"noscript"!==n&&"noembed"!==n||!regExpTest(/<\/no(script|embed)/i,e.innerHTML)?(G&&3===e.nodeType&&(i=e.textContent,i=stringReplace(i,N," "),i=stringReplace(i,M," "),e.textContent!==i&&(arrayPush(t.removed,{element:e.cloneNode()}),e.textContent=i)),Te("afterSanitizeElements",e,null),!1):(Ee(e),!0)},Me=function(e,t,i){if(te&&("id"===t||"name"===t)&&(i in n||i in _e))return!1;if(U&&!H[t]&&regExpTest(R,t));else if(K&&regExpTest(A,t));else{if(!W[t]||H[t])return!1;if(de[t]);else if(regExpTest(F,stringReplace(i,P,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==stringIndexOf(i,"data:")||!ae[e]){if(j&&!regExpTest(O,stringReplace(i,P,"")));else if(i)return!1}else;}return!0},Re=function(e){var i=void 0,n=void 0,o=void 0,r=void 0;Te("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W};for(r=s.length;r--;){var l=i=s[r],d=l.name,c=l.namespaceURI;if(n=stringTrim(i.value),o=stringToLowerCase(d),a.attrName=o,a.attrValue=n,a.keepAttr=!0,a.forceKeepAttr=void 0,Te("uponSanitizeAttribute",e,a),n=a.attrValue,!a.forceKeepAttr&&(Le(d,e),a.keepAttr))if(regExpTest(/\/>/i,n))Le(d,e);else{G&&(n=stringReplace(n,N," "),n=stringReplace(n,M," "));var h=e.nodeName.toLowerCase();if(Me(h,o,n))try{c?e.setAttributeNS(c,d,n):e.setAttribute(d,n),arrayPop(t.removed)}catch(Oe){}}}Te("afterSanitizeAttributes",e,null)}},Ae=function e(t){var i=void 0,n=De(t);for(Te("beforeSanitizeShadowDOM",t,null);i=n.nextNode();)Te("uponSanitizeShadowNode",i,null),Ne(i)||(i.content instanceof o&&e(i.content),Re(i));Te("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(n,r){var a=void 0,l=void 0,d=void 0,c=void 0,h=void 0;if((me=!n)&&(n="\x3c!--\x3e"),"string"!=typeof n&&!ke(n)){if("function"!=typeof n.toString)throw typeErrorCreate("toString is not a function");if("string"!=typeof(n=n.toString()))throw typeErrorCreate("dirty is not a string, aborting")}if(!t.isSupported){if("object"===_typeof(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof n)return e.toStaticHTML(n);if(ke(n))return e.toStaticHTML(n.outerHTML)}return n}if(Z||Ce(r),t.removed=[],"string"==typeof n&&(ne=!1),ne);else if(n instanceof s)1===(l=(a=xe("\x3c!----\x3e")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!X&&!G&&!q&&-1===n.indexOf("<"))return S&&ee?S.createHTML(n):n;if(!(a=xe(n)))return X?null:y}a&&Y&&Ee(a.firstChild);for(var u=De(ne?n:a);d=u.nextNode();)3===d.nodeType&&d===c||Ne(d)||(d.content instanceof o&&Ae(d.content),Re(d),c=d);if(c=null,ne)return n;if(X){if(Q)for(h=x.call(a.ownerDocument);a.firstChild;)h.appendChild(a.firstChild);else h=a;return J&&(h=I.call(i,h,!0)),h}var g=q?a.outerHTML:a.innerHTML;return G&&(g=stringReplace(g,N," "),g=stringReplace(g,M," ")),S&&ee?S.createHTML(g):g},t.setConfig=function(e){Ce(e),Z=!0},t.clearConfig=function(){fe=null,Z=!1},t.isValidAttribute=function(e,t,i){fe||Ce({});var n=stringToLowerCase(e),o=stringToLowerCase(t);return Me(n,o,i)},t.addHook=function(e,t){"function"==typeof t&&(T[e]=T[e]||[],arrayPush(T[e],t))},t.removeHook=function(e){T[e]&&arrayPop(T[e])},t.removeHooks=function(e){T[e]&&(T[e]=[])},t.removeAllHooks=function(){T={}},t}var purify=createDOMPurify();purify.version,purify.isSupported;const sanitize$1=purify.sanitize;purify.setConfig,purify.clearConfig,purify.isValidAttribute;const addHook=purify.addHook,removeHook=purify.removeHook;purify.removeHooks,purify.removeAllHooks;let __marked_exports={};!function(){function e(e,t){t(__marked_exports)}var t,i;e.amd=!0,t=this,i=function(e){function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}e.defaults={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};var r=/[&<>"']/,s=/[&<>"']/g,a=/[<>"']|&(?!#?\w+;)/,l=/[<>"']|&(?!#?\w+;)/g,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=function(e){return d[e]};function h(e,t){if(t){if(r.test(e))return e.replace(s,c)}else if(a.test(e))return e.replace(l,c);return e}var u=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function g(e){return e.replace(u,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var p=/(^|[^\[])\^/g;function m(e,t){e=e.source||e,t=t||"";var i={replace:function(t,n){return n=(n=n.source||n).replace(p,"$1"),e=e.replace(t,n),i},getRegex:function(){return new RegExp(e,t)}};return i}var f=/[^\w:]/g,_=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function C(e,t,i){if(e){var n;try{n=decodeURIComponent(g(i)).replace(f,"").toLowerCase()}catch(e2){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}t&&!_.test(i)&&(i=function(e,t){v[" "+e]||(b.test(e)?v[" "+e]=e+"/":v[" "+e]=x(e,"/",!0));var i=-1===(e=v[" "+e]).indexOf(":");return"//"===t.substring(0,2)?i?t:e.replace(S,"$1")+t:"/"===t.charAt(0)?i?t:e.replace(y,"$1")+t:e+t}(t,i));try{i=encodeURI(i).replace(/%25/g,"%")}catch(e2){return null}return i}var v={},b=/^[^:]+:\/*[^/]*$/,S=/^([^:]+:)[\s\S]*$/,y=/^([^:]+:\/*[^/]*)[\s\S]*$/,w={exec:function(){}};function E(e){for(var t,i,n=1;n<arguments.length;n++)for(i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function L(e,t){var i=e.replace(/\|/g,(function(e,t,i){for(var n=!1,o=t;--o>=0&&"\\"===i[o];)n=!n;return n?"|":" |"})).split(/ \|/),n=0;if(i[0].trim()||i.shift(),i[i.length-1].trim()||i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i}function x(e,t,i){var n=e.length;if(0===n)return"";for(var o=0;o<n;){var r=e.charAt(n-o-1);if(r!==t||i){if(r===t||!i)break;o++}else o++}return e.substr(0,n-o)}function D(e){e&&e.sanitize&&e.silent}function I(e,t){if(t<1)return"";for(var i="";t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e}function k(e,t,i,n){var o=t.href,r=t.title?h(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){n.state.inLink=!0;var a={type:"link",raw:i,href:o,title:r,text:s,tokens:n.inlineTokens(s,[])};return n.state.inLink=!1,a}return{type:"image",raw:i,href:o,title:r,text:h(s)}}var T=function(){function t(t){this.options=t||e.defaults}var i=t.prototype;return i.space=function(e){var t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}},i.code=function(e){var t=this.rules.block.code.exec(e);if(t){var i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:x(i,"\n")}}},i.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var i=t[0],n=function(e,t){var i=e.match(/^(\s+)(?:```)/);if(null===i)return t;var n=i[1];return t.split("\n").map((function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=n.length?e.slice(n.length):e})).join("\n")}(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim():t[2],text:n}}},i.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var i=t[2].trim();if(/#$/.test(i)){var n=x(i,"#");this.options.pedantic?i=n.trim():n&&!/ $/.test(n)||(i=n.trim())}var o={type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:[]};return this.lexer.inline(o.text,o.tokens),o}},i.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},i.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var i=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(i,[]),text:i}}},i.list=function(e){var t=this.rules.block.list.exec(e);if(t){var i,o,r,s,a,l,d,c,h,u,g,p,m=t[1].trim(),f=m.length>1,_={type:"list",raw:"",ordered:f,start:f?+m.slice(0,-1):"",loose:!1,items:[]};m=f?"\\d{1,9}\\"+m.slice(-1):"\\"+m,this.options.pedantic&&(m=f?m:"[*+-]");for(var C=new RegExp("^( {0,3}"+m+")((?: [^\\n]*)?(?:\\n|$))");e&&(p=!1,t=C.exec(e))&&!this.rules.block.hr.test(e);){if(i=t[0],e=e.substring(i.length),c=t[2].split("\n",1)[0],h=e.split("\n",1)[0],this.options.pedantic?(s=2,g=c.trimLeft()):(s=(s=t[2].search(/[^ ]/))>4?1:s,g=c.slice(s),s+=t[1].length),l=!1,!c&&/^ *$/.test(h)&&(i+=h+"\n",e=e.substring(h.length+1),p=!0),!p)for(var v=new RegExp("^ {0,"+Math.min(3,s-1)+"}(?:[*+-]|\\d{1,9}[.)])");e&&(c=u=e.split("\n",1)[0],this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!v.test(c));){if(c.search(/[^ ]/)>=s||!c.trim())g+="\n"+c.slice(s);else{if(l)break;g+="\n"+c}l||c.trim()||(l=!0),i+=u+"\n",e=e.substring(u.length+1)}_.loose||(d?_.loose=!0:/\n *\n *$/.test(i)&&(d=!0)),this.options.gfm&&(o=/^\[[ xX]\] /.exec(g))&&(r="[ ] "!==o[0],g=g.replace(/^\[[ xX]\] +/,"")),_.items.push({type:"list_item",raw:i,task:!!o,checked:r,loose:!1,text:g}),_.raw+=i}_.items[_.items.length-1].raw=i.trimRight(),_.items[_.items.length-1].text=g.trimRight(),_.raw=_.raw.trimRight();var b=_.items.length;for(a=0;a<b;a++){this.lexer.state.top=!1,_.items[a].tokens=this.lexer.blockTokens(_.items[a].text,[]);var S=_.items[a].tokens.filter((function(e){return"space"===e.type})),y=S.every((function(e){for(var t,i=0,o=n(e.raw.split(""));!(t=o()).done;)if("\n"===t.value&&(i+=1),i>1)return!0;return!1}));!_.loose&&S.length&&y&&(_.loose=!0,_.items[a].loose=!0)}return _}},i.html=function(e){var t=this.rules.block.html.exec(e);if(t){var i={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(t[0]):h(t[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}},i.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},i.table=function(e){var t=this.rules.block.table.exec(e);if(t){var i={type:"table",header:L(t[1]).map((function(e){return{text:e}})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(i.header.length===i.align.length){i.raw=t[0];var n,o,r,s,a=i.align.length;for(n=0;n<a;n++)/^ *-+: *$/.test(i.align[n])?i.align[n]="right":/^ *:-+: *$/.test(i.align[n])?i.align[n]="center":/^ *:-+ *$/.test(i.align[n])?i.align[n]="left":i.align[n]=null;for(a=i.rows.length,n=0;n<a;n++)i.rows[n]=L(i.rows[n],i.header.length).map((function(e){return{text:e}}));for(a=i.header.length,o=0;o<a;o++)i.header[o].tokens=[],this.lexer.inlineTokens(i.header[o].text,i.header[o].tokens);for(a=i.rows.length,o=0;o<a;o++)for(s=i.rows[o],r=0;r<s.length;r++)s[r].tokens=[],this.lexer.inlineTokens(s[r].text,s[r].tokens);return i}}},i.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t){var i={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}},i.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t){var i={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}},i.text=function(e){var t=this.rules.block.text.exec(e);if(t){var i={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}},i.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:h(t[1])}},i.tag=function(e){var t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):h(t[0]):t[0]}},i.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;var n=x(i.slice(0,-1),"\\");if((i.length-n.length)%2==0)return}else{var o=function(e,t){if(-1===e.indexOf(t[1]))return-1;for(var i=e.length,n=0,o=0;o<i;o++)if("\\"===e[o])o++;else if(e[o]===t[0])n++;else if(e[o]===t[1]&&--n<0)return o;return-1}(t[2],"()");if(o>-1){var r=(0===t[0].indexOf("!")?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,r).trim(),t[3]=""}}var s=t[2],a="";if(this.options.pedantic){var l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);l&&(s=l[1],a=l[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(i)?s.slice(1):s.slice(1,-1)),k(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0],this.lexer)}},i.reflink=function(e,t){var i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){var n=(i[2]||i[1]).replace(/\s+/g," ");if(!(n=t[n.toLowerCase()])||!n.href){var o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return k(i,n,i[0],this.lexer)}},i.emStrong=function(e,t,i){void 0===i&&(i="");var n=this.rules.inline.emStrong.lDelim.exec(e);if(n&&(!n[3]||!i.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var o=n[1]||n[2]||"";if(!o||o&&(""===i||this.rules.inline.punctuation.exec(i))){var r,s,a=n[0].length-1,l=a,d=0,c="*"===n[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+a);null!=(n=c.exec(t));)if(r=n[1]||n[2]||n[3]||n[4]||n[5]||n[6])if(s=r.length,n[3]||n[4])l+=s;else if(!((n[5]||n[6])&&a%3)||(a+s)%3){if(!((l-=s)>0)){if(s=Math.min(s,s+l+d),Math.min(a,s)%2){var h=e.slice(1,a+n.index+s);return{type:"em",raw:e.slice(0,a+n.index+s+1),text:h,tokens:this.lexer.inlineTokens(h,[])}}var u=e.slice(2,a+n.index+s-1);return{type:"strong",raw:e.slice(0,a+n.index+s+1),text:u,tokens:this.lexer.inlineTokens(u,[])}}}else d+=s}}},i.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var i=t[2].replace(/\n/g," "),n=/[^ ]/.test(i),o=/^ /.test(i)&&/ $/.test(i);return n&&o&&(i=i.substring(1,i.length-1)),i=h(i,!0),{type:"codespan",raw:t[0],text:i}}},i.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},i.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}},i.autolink=function(e,t){var i,n,o=this.rules.inline.autolink.exec(e);if(o)return n="@"===o[2]?"mailto:"+(i=h(this.options.mangle?t(o[1]):o[1])):i=h(o[1]),{type:"link",raw:o[0],text:i,href:n,tokens:[{type:"text",raw:i,text:i}]}},i.url=function(e,t){var i;if(i=this.rules.inline.url.exec(e)){var n,o;if("@"===i[2])o="mailto:"+(n=h(this.options.mangle?t(i[0]):i[0]));else{var r;do{r=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0]}while(r!==i[0]);n=h(i[0]),o="www."===i[1]?"http://"+n:n}return{type:"link",raw:i[0],text:n,href:o,tokens:[{type:"text",raw:n,text:n}]}}},i.inlineText=function(e,t){var i,n=this.rules.inline.text.exec(e);if(n)return i=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):h(n[0]):n[0]:h(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:i}},t}(),N={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:w,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};N.def=m(N.def).replace("label",N._label).replace("title",N._title).getRegex(),N.bullet=/(?:[*+-]|\d{1,9}[.)])/,N.listItemStart=m(/^( *)(bull) */).replace("bull",N.bullet).getRegex(),N.list=m(N.list).replace(/bull/g,N.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+N.def.source+")").getRegex(),N._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",N._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,N.html=m(N.html,"i").replace("comment",N._comment).replace("tag",N._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),N.paragraph=m(N._paragraph).replace("hr",N.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N._tag).getRegex(),N.blockquote=m(N.blockquote).replace("paragraph",N.paragraph).getRegex(),N.normal=E({},N),N.gfm=E({},N.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),N.gfm.table=m(N.gfm.table).replace("hr",N.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N._tag).getRegex(),N.gfm.paragraph=m(N._paragraph).replace("hr",N.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",N.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N._tag).getRegex(),N.pedantic=E({},N.normal,{html:m("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",N._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:w,paragraph:m(N.normal._paragraph).replace("hr",N.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",N.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var M={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:w,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:w,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function R(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function A(e){var t,i,n="",o=e.length;for(t=0;t<o;t++)i=e.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),n+="&#"+i+";";return n}M._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",M.punctuation=m(M.punctuation).replace(/punctuation/g,M._punctuation).getRegex(),M.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,M.escapedEmSt=/\\\*|\\_/g,M._comment=m(N._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),M.emStrong.lDelim=m(M.emStrong.lDelim).replace(/punct/g,M._punctuation).getRegex(),M.emStrong.rDelimAst=m(M.emStrong.rDelimAst,"g").replace(/punct/g,M._punctuation).getRegex(),M.emStrong.rDelimUnd=m(M.emStrong.rDelimUnd,"g").replace(/punct/g,M._punctuation).getRegex(),M._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,M._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,M._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,M.autolink=m(M.autolink).replace("scheme",M._scheme).replace("email",M._email).getRegex(),M._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,M.tag=m(M.tag).replace("comment",M._comment).replace("attribute",M._attribute).getRegex(),M._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,M._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,M._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,M.link=m(M.link).replace("label",M._label).replace("href",M._href).replace("title",M._title).getRegex(),M.reflink=m(M.reflink).replace("label",M._label).replace("ref",N._label).getRegex(),M.nolink=m(M.nolink).replace("ref",N._label).getRegex(),M.reflinkSearch=m(M.reflinkSearch,"g").replace("reflink",M.reflink).replace("nolink",M.nolink).getRegex(),M.normal=E({},M),M.pedantic=E({},M.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:m(/^!?\[(label)\]\((.*?)\)/).replace("label",M._label).getRegex(),reflink:m(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",M._label).getRegex()}),M.gfm=E({},M.normal,{escape:m(M.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),M.gfm.url=m(M.gfm.url,"i").replace("email",M.gfm._extended_email).getRegex(),M.breaks=E({},M.gfm,{br:m(M.br).replace("{2,}","*").getRegex(),text:m(M.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var O=function(){function i(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||e.defaults,this.options.tokenizer=this.options.tokenizer||new T,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var i={block:N.normal,inline:M.normal};this.options.pedantic?(i.block=N.pedantic,i.inline=M.pedantic):this.options.gfm&&(i.block=N.gfm,this.options.breaks?i.inline=M.breaks:i.inline=M.gfm),this.tokenizer.rules=i}i.lex=function(e,t){return new i(t).lex(e)},i.lexInline=function(e,t){return new i(t).inlineTokens(e)};var n,o,r,s=i.prototype;return s.lex=function(e){var t;for(e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens},s.blockTokens=function(e,t){var i,n,o,r,s=this;for(void 0===t&&(t=[]),this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((function(n){return!!(i=n.call({lexer:s},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)}))))if(i=this.tokenizer.space(e))e=e.substring(i.raw.length),1===i.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(i);else if(i=this.tokenizer.code(e))e=e.substring(i.raw.length),!(n=t[t.length-1])||"paragraph"!==n.type&&"text"!==n.type?t.push(i):(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(i=this.tokenizer.fences(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.heading(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.hr(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.blockquote(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.list(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.html(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.def(e))e=e.substring(i.raw.length),!(n=t[t.length-1])||"paragraph"!==n.type&&"text"!==n.type?this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title}):(n.raw+="\n"+i.raw,n.text+="\n"+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text);else if(i=this.tokenizer.table(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.lheading(e))e=e.substring(i.raw.length),t.push(i);else if(o=e,this.options.extensions&&this.options.extensions.startBlock&&function(){var t=Infinity,i=e.slice(1),n=void 0;s.options.extensions.startBlock.forEach((function(e){"number"==typeof(n=e.call({lexer:this},i))&&n>=0&&(t=Math.min(t,n))})),t<Infinity&&t>=0&&(o=e.substring(0,t+1))}(),this.state.top&&(i=this.tokenizer.paragraph(o)))n=t[t.length-1],r&&"paragraph"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i),r=o.length!==e.length,e=e.substring(i.raw.length);else if(i=this.tokenizer.text(e))e=e.substring(i.raw.length),(n=t[t.length-1])&&"text"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):t.push(i);else if(e){var a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent)break;throw new Error(a)}return this.state.top=!0,t},s.inline=function(e,t){this.inlineQueue.push({src:e,tokens:t})},s.inlineTokens=function(e,t){var i,n,o,r=this;void 0===t&&(t=[]);var s,a,l,d=e;if(this.tokens.links){var c=Object.keys(this.tokens.links);if(c.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(d));)c.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(d=d.slice(0,s.index)+"["+I("a",s[0].length-2)+"]"+d.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(d));)d=d.slice(0,s.index)+"["+I("a",s[0].length-2)+"]"+d.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.escapedEmSt.exec(d));)d=d.slice(0,s.index)+"++"+d.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(a||(l=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((function(n){return!!(i=n.call({lexer:r},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)}))))if(i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e))e=e.substring(i.raw.length),(n=t[t.length-1])&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(i.raw.length),(n=t[t.length-1])&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=this.tokenizer.emStrong(e,d,l))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.autolink(e,A))e=e.substring(i.raw.length),t.push(i);else if(this.state.inLink||!(i=this.tokenizer.url(e,A))){if(o=e,this.options.extensions&&this.options.extensions.startInline&&function(){var t=Infinity,i=e.slice(1),n=void 0;r.options.extensions.startInline.forEach((function(e){"number"==typeof(n=e.call({lexer:this},i))&&n>=0&&(t=Math.min(t,n))})),t<Infinity&&t>=0&&(o=e.substring(0,t+1))}(),i=this.tokenizer.inlineText(o,R))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(l=i.raw.slice(-1)),a=!0,(n=t[t.length-1])&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(e){var h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent)break;throw new Error(h)}}else e=e.substring(i.raw.length),t.push(i);return t},n=i,r=[{key:"rules",get:function(){return{block:N,inline:M}}}],(o=null)&&t(n.prototype,o),r&&t(n,r),Object.defineProperty(n,"prototype",{writable:!1}),i}(),P=function(){function t(t){this.options=t||e.defaults}var i=t.prototype;return i.code=function(e,t,i){var n=(t||"").match(/\S*/)[0];if(this.options.highlight){var o=this.options.highlight(e,n);null!=o&&o!==e&&(i=!0,e=o)}return e=e.replace(/\n$/,"")+"\n",n?'<pre><code class="'+this.options.langPrefix+h(n,!0)+'">'+(i?e:h(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:h(e,!0))+"</code></pre>\n"},i.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.html=function(e){return e},i.heading=function(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},i.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.list=function(e,t,i){var n=t?"ol":"ul";return"<"+n+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+n+">\n"},i.listitem=function(e){return"<li>"+e+"</li>\n"},i.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},i.paragraph=function(e){return"<p>"+e+"</p>\n"},i.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},i.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.tablecell=function(e,t){var i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+">\n"},i.strong=function(e){return"<strong>"+e+"</strong>"},i.em=function(e){return"<em>"+e+"</em>"},i.codespan=function(e){return"<code>"+e+"</code>"},i.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.del=function(e){return"<del>"+e+"</del>"},i.link=function(e,t,i){if(null===(e=C(this.options.sanitize,this.options.baseUrl,e)))return i;var n='<a href="'+h(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>"},i.image=function(e,t,i){if(null===(e=C(this.options.sanitize,this.options.baseUrl,e)))return i;var n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">"},i.text=function(e){return e},t}(),F=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,i){return""+i},t.image=function(e,t,i){return""+i},t.br=function(){return""},e}(),B=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do{i=e+"-"+ ++n}while(this.seen.hasOwnProperty(i))}return t||(this.seen[e]=n,this.seen[i]=0),i},t.slug=function(e,t){void 0===t&&(t={});var i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun)},e}(),$=function(){function t(t){this.options=t||e.defaults,this.options.renderer=this.options.renderer||new P,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new F,this.slugger=new B}t.parse=function(e,i){return new t(i).parse(e)},t.parseInline=function(e,i){return new t(i).parseInline(e)};var i=t.prototype;return i.parse=function(e,t){void 0===t&&(t=!0);var i,n,o,r,s,a,l,d,c,h,u,p,m,f,_,C,v,b,S,y="",w=e.length;for(i=0;i<w;i++)if(h=e[i],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type])||!1===(S=this.options.extensions.renderers[h.type].call({parser:this},h))&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))switch(h.type){case"space":continue;case"hr":y+=this.renderer.hr();continue;case"heading":y+=this.renderer.heading(this.parseInline(h.tokens),h.depth,g(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":y+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(d="",l="",r=h.header.length,n=0;n<r;n++)l+=this.renderer.tablecell(this.parseInline(h.header[n].tokens),{header:!0,align:h.align[n]});for(d+=this.renderer.tablerow(l),c="",r=h.rows.length,n=0;n<r;n++){for(l="",s=(a=h.rows[n]).length,o=0;o<s;o++)l+=this.renderer.tablecell(this.parseInline(a[o].tokens),{header:!1,align:h.align[o]});c+=this.renderer.tablerow(l)}y+=this.renderer.table(d,c);continue;case"blockquote":c=this.parse(h.tokens),y+=this.renderer.blockquote(c);continue;case"list":for(u=h.ordered,p=h.start,m=h.loose,r=h.items.length,c="",n=0;n<r;n++)C=(_=h.items[n]).checked,v=_.task,f="",_.task&&(b=this.renderer.checkbox(C),m?_.tokens.length>0&&"paragraph"===_.tokens[0].type?(_.tokens[0].text=b+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&"text"===_.tokens[0].tokens[0].type&&(_.tokens[0].tokens[0].text=b+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:b}):f+=b),f+=this.parse(_.tokens,m),c+=this.renderer.listitem(f,v,C);y+=this.renderer.list(c,u,p);continue;case"html":y+=this.renderer.html(h.text);continue;case"paragraph":y+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(c=h.tokens?this.parseInline(h.tokens):h.text;i+1<w&&"text"===e[i+1].type;)c+="\n"+((h=e[++i]).tokens?this.parseInline(h.tokens):h.text);y+=t?this.renderer.paragraph(c):c;continue;default:var E='Token with "'+h.type+'" type was not found.';if(this.options.silent)return;throw new Error(E)}else y+=S||"";return y},i.parseInline=function(e,t){t=t||this.renderer;var i,n,o,r="",s=e.length;for(i=0;i<s;i++)if(n=e[i],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type])||!1===(o=this.options.extensions.renderers[n.type].call({parser:this},n))&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type))switch(n.type){case"escape":case"text":r+=t.text(n.text);break;case"html":r+=t.html(n.text);break;case"link":r+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":r+=t.image(n.href,n.title,n.text);break;case"strong":r+=t.strong(this.parseInline(n.tokens,t));break;case"em":r+=t.em(this.parseInline(n.tokens,t));break;case"codespan":r+=t.codespan(n.text);break;case"br":r+=t.br();break;case"del":r+=t.del(this.parseInline(n.tokens,t));break;default:var a='Token with "'+n.type+'" type was not found.';if(this.options.silent)return;throw new Error(a)}else r+=o||"";return r},t}();function W(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(i=t,t=null),D(t=E({},W.defaults,t||{})),i){var n,o=t.highlight;try{n=O.lex(e,t)}catch(e2){return i(e2)}var r=function(e){var r;if(!e)try{t.walkTokens&&W.walkTokens(n,t.walkTokens),r=$.parse(n,t)}catch(e2){e=e2}return t.highlight=o,e?i(e):i(null,r)};if(!o||o.length<3)return r();if(delete t.highlight,!n.length)return r();var s=0;return W.walkTokens(n,(function(e){"code"===e.type&&(s++,setTimeout((function(){o(e.text,e.lang,(function(t,i){if(t)return r(t);null!=i&&i!==e.text&&(e.text=i,e.escaped=!0),0==--s&&r()}))}),0))})),void(0===s&&r())}try{var a=O.lex(e,t);return t.walkTokens&&W.walkTokens(a,t.walkTokens),$.parse(a,t)}catch(e2){if(e2.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+h(e2.message+"",!0)+"</pre>";throw e2}}W.options=W.setOptions=function(t){var i;return E(W.defaults,t),i=W.defaults,e.defaults=i,W},W.getDefaults=o,W.defaults=e.defaults,W.use=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n,o=E.apply(void 0,[{}].concat(t)),r=W.defaults.extensions||{renderers:{},childTokens:{}};t.forEach((function(e){if(e.extensions&&(n=!0,e.extensions.forEach((function(e){if(!e.name)throw new Error("extension name required");if(e.renderer){var t=r.renderers?r.renderers[e.name]:null;r.renderers[e.name]=t?function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];var r=e.renderer.apply(this,n);return!1===r&&(r=t.apply(this,n)),r}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");r[e.level]?r[e.level].unshift(e.tokenizer):r[e.level]=[e.tokenizer],e.start&&("block"===e.level?r.startBlock?r.startBlock.push(e.start):r.startBlock=[e.start]:"inline"===e.level&&(r.startInline?r.startInline.push(e.start):r.startInline=[e.start]))}e.childTokens&&(r.childTokens[e.name]=e.childTokens)}))),e.renderer&&function(){var t=W.defaults.renderer||new P,i=function(i){var n=t[i];t[i]=function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=e.renderer[i].apply(t,r);return!1===a&&(a=n.apply(t,r)),a}};for(var n in e.renderer)i(n);o.renderer=t}(),e.tokenizer&&function(){var t=W.defaults.tokenizer||new T,i=function(i){var n=t[i];t[i]=function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=e.tokenizer[i].apply(t,r);return!1===a&&(a=n.apply(t,r)),a}};for(var n in e.tokenizer)i(n);o.tokenizer=t}(),e.walkTokens){var t=W.defaults.walkTokens;o.walkTokens=function(i){e.walkTokens.call(this,i),t&&t.call(this,i)}}n&&(o.extensions=r),W.setOptions(o)}))},W.walkTokens=function(e,t){for(var i,o=function(){var e=i.value;switch(t.call(W,e),e.type){case"table":for(var o,r=n(e.header);!(o=r()).done;){var s=o.value;W.walkTokens(s.tokens,t)}for(var a,l=n(e.rows);!(a=l()).done;)for(var d,c=n(a.value);!(d=c()).done;){var h=d.value;W.walkTokens(h.tokens,t)}break;case"list":W.walkTokens(e.items,t);break;default:W.defaults.extensions&&W.defaults.extensions.childTokens&&W.defaults.extensions.childTokens[e.type]?W.defaults.extensions.childTokens[e.type].forEach((function(i){W.walkTokens(e[i],t)})):e.tokens&&W.walkTokens(e.tokens,t)}},r=n(e);!(i=r()).done;)o()},W.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");D(t=E({},W.defaults,t||{}));try{var i=O.lexInline(e,t);return t.walkTokens&&W.walkTokens(i,t.walkTokens),$.parseInline(i,t)}catch(e2){if(e2.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+h(e2.message+"",!0)+"</pre>";throw e2}},W.Parser=$,W.parser=$.parse,W.Renderer=P,W.TextRenderer=F,W.Lexer=O,W.lexer=O.lex,W.Tokenizer=T,W.Slugger=B,W.parse=W;var V=W.options,z=W.setOptions,H=W.use,K=W.walkTokens,U=W.parseInline,j=W,G=$.parse,q=O.lex;e.Lexer=O,e.Parser=$,e.Renderer=P,e.Slugger=B,e.TextRenderer=F,e.Tokenizer=T,e.getDefaults=o,e.lexer=q,e.marked=W,e.options=V,e.parse=j,e.parseInline=U,e.parser=G,e.setOptions=z,e.use=H,e.walkTokens=K,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?i(exports):e.amd?e(0,i):i((t="undefined"!=typeof globalThis?globalThis:t||self).marked={})}();var marked=__marked_exports||exports;function parse$1(e){let t=JSON.parse(e);return t=revive(t),t}function revive(e,t=0){if(!e||t>200)return e;if("object"==typeof e){switch(e.$mid){case 1:return URI.revive(e);case 2:return new RegExp(e.source,e.flags);case 14:return new Date(e.source)}if(e instanceof VSBuffer||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=revive(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=revive(e[i],t+1))}return e}function renderMarkdown(e,t={},i={}){var n;const o=new DisposableStore;let r=!1;const s=o.add(new CancellationTokenSource$1),a=createElement(t),l=function(t){let i;try{i=parse$1(decodeURIComponent(t))}catch(e2){}return i?(i=cloneAndChange(i,(t=>e.uris&&e.uris[t]?URI.revive(e.uris[t]):void 0)),encodeURIComponent(JSON.stringify(i))):t},d=function(t,i){const n=e.uris&&e.uris[t];let o=URI.revive(n);return i?t.startsWith(Schemas.data+":")?t:(o||(o=URI.parse(t)),FileAccess.asBrowserUri(o).toString(!0)):o?URI.parse(t).toString()===o.toString()?t:(o.query&&(o=o.with({query:l(o.query)})),o.toString()):t};let c;const h=new Promise((e=>c=e)),u=new marked.Renderer;if(u.image=(e,t,i)=>{let n=[],o=[];return e&&(({href:e,dimensions:n}=parseHrefAndDimensions(e)),o.push(`src="${e}"`)),i&&o.push(`alt="${i}"`),t&&o.push(`title="${t}"`),n.length&&(o=o.concat(n)),"<img "+o.join(" ")+">"},u.link=(t,i,n)=>"string"!=typeof t?"":(t===n&&(n=removeMarkdownEscapes(n)),t=d(t,!1),e.baseUri&&(t=resolveWithBaseUri(URI.from(e.baseUri),t)),i="string"==typeof i?removeMarkdownEscapes(i):"",!(t=removeMarkdownEscapes(t))||/^data:|javascript:/i.test(t)||/^command:/i.test(t)&&!e.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(t)?n:`<a data-href="${t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" title="${i||t}">${n}</a>`),u.paragraph=e=>`<p>${e}</p>`,t.codeBlockRenderer&&(u.code=(e,i)=>{const n=t.codeBlockRenderer(null!=i?i:"",e),o=defaultGenerator.nextId();return raceCancellation(Promise.all([n,h]),s.token).then((e=>{var i;if(!r&&e){const n=a.querySelector(`div[data-code="${o}"]`);n&&reset(n,e[0]),null===(i=t.asyncRenderCallback)||void 0===i||i.call(t)}})).catch((()=>{})),`<div class="code" data-code="${o}">${escape(e)}</div>`}),t.actionHandler){const i=t.actionHandler.disposables.add(new DomEmitter(a,"click")),n=t.actionHandler.disposables.add(new DomEmitter(a,"auxclick"));t.actionHandler.disposables.add(Event$1.any(i.event,n.event)((i=>{const n=new StandardMouseEvent(i);if(!n.leftButton&&!n.middleButton)return;let o=n.target;if("A"===o.tagName||(o=o.parentElement,o&&"A"===o.tagName))try{let i=o.dataset.href;i&&(e.baseUri&&(i=resolveWithBaseUri(URI.from(e.baseUri),i)),t.actionHandler.callback(i,n))}catch(r){onUnexpectedError(r)}finally{n.preventDefault()}})))}e.supportHtml||(i.sanitizer=t=>(e.isTrusted?t.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?t:"",i.sanitize=!0,i.silent=!0),i.renderer=u;let g=null!==(n=e.value)&&void 0!==n?n:"";g.length>1e5&&(g=`${g.substr(0,1e5)}…`),e.supportThemeIcons&&(g=markdownEscapeEscapedIcons(g));let p=marked.parse(g,i);if(e.supportThemeIcons){p=renderLabelWithIcons(p).map((e=>"string"==typeof e?e:e.outerHTML)).join("")}const m=(new DOMParser).parseFromString(sanitizeRenderedMarkdown(e,p),"text/html");if(m.body.querySelectorAll("img").forEach((t=>{const i=t.getAttribute("src");if(i){let o=i;try{e.baseUri&&(o=resolveWithBaseUri(URI.from(e.baseUri),o))}catch(n){}t.src=d(o,!0)}})),a.innerHTML=sanitizeRenderedMarkdown(e,m.body.innerHTML),c(),t.asyncRenderCallback)for(const f of a.getElementsByTagName("img")){const e=o.add(addDisposableListener(f,"load",(()=>{e.dispose(),t.asyncRenderCallback()})))}return{element:a,dispose:()=>{r=!0,s.cancel(),o.dispose()}}}function resolveWithBaseUri(e,t){return/^\w[\w\d+.-]*:/.test(t)?t:e.path.endsWith("/")?resolvePath(e,t).toString():resolvePath(dirname(e),t).toString()}function sanitizeRenderedMarkdown(e,t){const{config:i,allowedSchemes:n}=getSanitizerOptions(e);addHook("uponSanitizeAttribute",((e,t)=>{if("style"!==t.attrName&&"class"!==t.attrName);else{if("SPAN"===e.tagName){if("style"===t.attrName)return void(t.keepAttr=/^(color\:#[0-9a-fA-F]+;)?(background-color\:#[0-9a-fA-F]+;)?$/.test(t.attrValue));if("class"===t.attrName)return void(t.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(t.attrValue))}t.keepAttr=!1}}));const o=document.createElement("a");addHook("afterSanitizeAttributes",(e=>{for(const t of["href","src"])e.hasAttribute(t)&&(o.href=e.getAttribute(t),n.includes(o.protocol.replace(/:$/,""))||e.removeAttribute(t))}));try{return sanitize$1(t,Object.assign(Object.assign({},i),{RETURN_TRUSTED_TYPE:!0}))}finally{removeHook("uponSanitizeAttribute"),removeHook("afterSanitizeAttributes")}}function getSanitizerOptions(e){const t=[Schemas.http,Schemas.https,Schemas.mailto,Schemas.data,Schemas.file,Schemas.vscodeFileResource,Schemas.vscodeRemote,Schemas.vscodeRemoteResource];return e.isTrusted&&t.push(Schemas.command),{config:{ALLOWED_TAGS:["ul","li","p","b","i","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"],ALLOWED_ATTR:["href","data-href","target","title","src","alt","class","style","data-code","width","height","align"],ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:t}}var __awaiter$F=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const IOpenerService=createDecorator("openerService"),NullOpenerService=Object.freeze({_serviceBrand:void 0,registerOpener:()=>Disposable.None,registerValidator:()=>Disposable.None,registerExternalUriResolver:()=>Disposable.None,setDefaultExternalOpener(){},registerExternalOpener:()=>Disposable.None,open(){return __awaiter$F(this,void 0,void 0,(function*(){return!1}))},resolveExternalUri(e){return __awaiter$F(this,void 0,void 0,(function*(){return{resolved:e,dispose(){}}}))}});function matchesScheme(e,t){return URI.isUri(e)?equalsIgnoreCase(e.scheme,t):startsWithIgnoreCase(e,t+":")}function matchesSomeScheme(e,...t){return t.some((t=>matchesScheme(e,t)))}function extractSelection(e){let t;const i=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(e.fragment);return i&&(t={startLineNumber:parseInt(i[1]),startColumn:i[2]?parseInt(i[2]):1,endLineNumber:i[4]?parseInt(i[4]):void 0,endColumn:i[4]?i[5]?parseInt(i[5]):1:void 0},e=e.with({fragment:""})),{selection:t,uri:e}}var __decorate$12=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$11=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$E=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},_a$5;let MarkdownRenderer=class e{constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new Emitter$1,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e){return{element:document.createElement("span"),dispose:()=>{}}}const n=new DisposableStore;return{element:n.add(renderMarkdown(e,Object.assign(Object.assign({},this._getRenderOptions(e,n)),t),i)).element,dispose:()=>n.dispose()}}_getRenderOptions(t,i){return{codeBlockRenderer:(t,i)=>__awaiter$E(this,void 0,void 0,(function*(){var n,o,r;let s;t?s=this._languageService.getLanguageIdByLanguageName(t):this._options.editor&&(s=null===(n=this._options.editor.getModel())||void 0===n?void 0:n.getLanguageId()),s||(s=PLAINTEXT_LANGUAGE_ID);const a=yield tokenizeToString(this._languageService,i,s),l=document.createElement("span");if(l.innerHTML=null!==(r=null===(o=e._ttpTokenizer)||void 0===o?void 0:o.createHTML(a))&&void 0!==r?r:a,this._options.editor){applyFontInfo(l,this._options.editor.getOption(44))}else this._options.codeBlockFontFamily&&(l.style.fontFamily=this._options.codeBlockFontFamily);return l})),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:e=>this._openerService.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:t.isTrusted}).catch(onUnexpectedError),disposables:i}}}};MarkdownRenderer._ttpTokenizer=null===(_a$5=window.trustedTypes)||void 0===_a$5?void 0:_a$5.createPolicy("tokenizeToString",{createHTML:e=>e}),MarkdownRenderer=__decorate$12([__param$11(1,ILanguageService),__param$11(2,IOpenerService)],MarkdownRenderer);const $$7=$$c;class MarginHoverWidget extends Disposable{constructor(e,t,i=NullOpenerService){super(),this._renderDisposeables=this._register(new DisposableStore),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new HoverWidget),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new MarkdownRenderer({editor:this._editor},t,i)),this._computer=new MarginHoverComputer(this._editor),this._hoverOperation=this._register(new HoverOperation(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{this._withResult(e.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return MarginHoverWidget.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((e=>this._editor.applyFontInfo(e)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const e=$$7("div.hover-row.markdown-hover"),t=append$1(e,$$7("div.hover-contents")),o=this._renderDisposeables.add(this._markdownRenderer.render(n.value));t.appendChild(o.element),i.appendChild(e)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),o=this._editor.getOption(59),r=i-n-(this._hover.containerDomNode.clientHeight-o)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(r),0)}px`}}MarginHoverWidget.ID="editor.contrib.modesGlyphHoverWidget";class MarginHoverComputer{constructor(e){this._editor=e,this._lineNumber=-1}get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const n of t){if(!n.options.glyphMarginClassName)continue;const t=n.options.glyphMarginHoverMessage;t&&!isEmptyMarkdownString(t)&&i.push(...asArray(t).map(e))}return i}}var __awaiter$D=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class HoverProviderResult{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function executeProvider(e,t,i,n,o){return __awaiter$D(this,void 0,void 0,(function*(){try{const r=yield Promise.resolve(e.provideHover(i,n,o));if(r&&isValid(r))return new HoverProviderResult(e,r,t)}catch(r){onUnexpectedExternalError(r)}}))}function getHover(e,t,i,n){const o=e.ordered(t).map(((e,o)=>executeProvider(e,o,t,i,n)));return AsyncIterableObject.fromPromises(o).coalesce()}function getHoverPromise(e,t,i,n){return getHover(e,t,i,n).map((e=>e.hover)).toPromise()}function isValid(e){const t=void 0!==e.range,i=void 0!==e.contents&&e.contents&&e.contents.length>0;return t&&i}registerModelAndPositionCommand("_executeHoverProvider",((e,t,i)=>getHoverPromise(e.get(ILanguageFeaturesService).hoverProvider,t,i,CancellationToken.None)));var __decorate$11=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$10=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const $$6=$$c;class MarkdownHover{constructor(e,t,i,n){this.owner=e,this.range=t,this.contents=i,this.ordinal=n}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let MarkdownHoverParticipant=class{constructor(e,t,i,n,o){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=o,this.hoverOrdinal=2}createLoadingMessage(e){return new MarkdownHover(this,e.range,[(new MarkdownString).appendText(localize("modesContentHover.loading","Loading..."))],2e3)}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];let s=1e3;const a=i.getLineLength(n),l=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:l});"number"==typeof d&&a>=d&&r.push(new MarkdownHover(this,e.range,[{value:localize("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],s++));for(const c of t){const t=c.range.startLineNumber===n?c.range.startColumn:1,i=c.range.endLineNumber===n?c.range.endColumn:o,a=c.options.hoverMessage;if(!a||isEmptyMarkdownString(a))continue;const l=new Range$2(e.range.startLineNumber,t,e.range.startLineNumber,i);r.push(new MarkdownHover(this,l,asArray(a),s++))}return r}computeAsync(e,t,i){if(!this._editor.hasModel()||1!==e.type)return AsyncIterableObject.EMPTY;const n=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(n))return AsyncIterableObject.EMPTY;const o=new Position$1(e.range.startLineNumber,e.range.startColumn);return getHover(this._languageFeaturesService.hoverProvider,n,o,i).filter((e=>!isEmptyMarkdownString(e.hover.contents))).map((t=>{const i=t.hover.range?Range$2.lift(t.hover.range):e.range;return new MarkdownHover(this,i,t.hover.contents,t.ordinal)}))}renderHoverParts(e,t){return renderMarkdownHovers(e,t,this._editor,this._languageService,this._openerService)}};function renderMarkdownHovers(e,t,i,n,o){t.sort(((e,t)=>e.ordinal-t.ordinal));const r=new DisposableStore;for(const s of t)for(const t of s.contents){if(isEmptyMarkdownString(t))continue;const s=$$6("div.hover-row.markdown-hover"),a=append$1(s,$$6("div.hover-contents")),l=r.add(new MarkdownRenderer({editor:i},n,o));r.add(l.onDidRenderAsync((()=>{a.className="hover-contents code-hover-contents",e.onContentsChanged()})));const d=r.add(l.render(t));a.appendChild(d.element),e.fragment.appendChild(s)}return r}MarkdownHoverParticipant=__decorate$11([__param$10(1,ILanguageService),__param$10(2,IOpenerService),__param$10(3,IConfigurationService),__param$10(4,ILanguageFeaturesService)],MarkdownHoverParticipant);var __decorate$10=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$$=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class MarkerCoordinate{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let MarkerList=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event,this._dispoables=new DisposableStore,this._markers=[],this._nextIdx=-1,URI.isUri(e)?this._resourceFilter=t=>t.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),o=(e,t)=>{let i=compare(e.resource.toString(),t.resource.toString());return 0===i&&(i="position"===n?Range$2.compareRangesUsingStarts(e,t)||MarkerSeverity$2.compare(e.severity,t.severity):MarkerSeverity$2.compare(e.severity,t.severity)||Range$2.compareRangesUsingStarts(e,t)),i},r=()=>{this._markers=this._markerService.read({resource:URI.isUri(e)?e:void 0,severities:MarkerSeverity$2.Error|MarkerSeverity$2.Warning|MarkerSeverity$2.Info}),"function"==typeof e&&(this._markers=this._markers.filter((e=>this._resourceFilter(e.resource)))),this._markers.sort(o)};r(),this._dispoables.add(t.onMarkerChanged((e=>{this._resourceFilter&&!e.some((e=>this._resourceFilter(e)))||(r(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new MarkerCoordinate(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=!1,o=this._markers.findIndex((t=>t.resource.toString()===e.uri.toString()));o<0&&(o=binarySearch(this._markers,{resource:e.uri},((e,t)=>compare(e.resource.toString(),t.resource.toString()))),o<0&&(o=~o));for(let r=o;r<this._markers.length;r++){let i=Range$2.lift(this._markers[r]);if(i.isEmpty()){const t=e.getWordAtPosition(i.getStartPosition());t&&(i=new Range$2(i.startLineNumber,t.startColumn,i.startLineNumber,t.endColumn))}if(t&&(i.containsPosition(t)||t.isBeforeOrEqual(i.getStartPosition()))){this._nextIdx=r,n=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}n||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(0===this._markers.length)return!1;let n=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex((t=>t.resource.toString()===e.toString()));if(!(i<0))for(;i<this._markers.length;i++)if(Range$2.containsPosition(this._markers[i],t))return new MarkerCoordinate(this._markers[i],i+1,this._markers.length)}};MarkerList=__decorate$10([__param$$(1,IMarkerService),__param$$(2,IConfigurationService)],MarkerList);const IMarkerNavigationService=createDecorator("IMarkerNavigationService");let MarkerNavigationService=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new LinkedList}getMarkerList(e){for(let t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new MarkerList(e,this._markerService,this._configService)}};MarkerNavigationService=__decorate$10([__param$$(0,IMarkerService),__param$$(1,IConfigurationService)],MarkerNavigationService),registerSingleton(IMarkerNavigationService,MarkerNavigationService,!0);var gotoErrorWidget="",SeverityIcon;(SeverityIcon||(SeverityIcon={})).className=function(e){switch(e){case Severity$2.Ignore:return"severity-ignore "+Codicon.info.classNames;case Severity$2.Info:return Codicon.info.classNames;case Severity$2.Warning:return Codicon.warning.classNames;case Severity$2.Error:return Codicon.error.classNames;default:return""}},registerThemingParticipant(((e,t)=>{const i=e.getColor(problemsErrorIconForeground);if(i){const e=Codicon.error.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.extensions-viewlet > .extensions ${e} {\n\t\t\t\tcolor: ${i};\n\t\t\t}\n\t\t`)}const n=e.getColor(problemsWarningIconForeground);if(n){const e=Codicon.warning.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.extensions-viewlet > .extensions ${e},\n\t\t\t.extension-editor ${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.preferences-editor ${e} {\n\t\t\t\tcolor: ${n};\n\t\t\t}\n\t\t`)}const o=e.getColor(problemsInfoIconForeground);if(o){const e=Codicon.info.cssSelector;t.addRule(`\n\t\t\t.monaco-editor .zone-widget ${e},\n\t\t\t.markers-panel .marker-icon${e},\n\t\t\t.extensions-viewlet > .extensions ${e},\n\t\t\t.text-search-provider-messages .providerMessage ${e},\n\t\t\t.extension-editor ${e} {\n\t\t\t\tcolor: ${o};\n\t\t\t}\n\t\t`)}}));var __decorate$$=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$_=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class MessageWidget{constructor(e,t,i,n,o){this._openerService=n,this._labelService=o,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new DisposableStore,this._editor=t;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(addStandardDisposableListener(this._relatedBlock,"click",(e=>{e.preventDefault();const t=this._relatedDiagnostics.get(e.target);t&&i(t)}))),this._scrollable=new ScrollableElement(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{r.style.left=`-${e.scrollLeft}px`,r.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){dispose(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:o}=e;let r=((null==t?void 0:t.length)||0)+"()".length;o&&(r+="string"==typeof o?o.length:o.value.length);const s=splitLines(i);this._lines=s.length,this._longestLineLength=0;for(const h of s)this._longestLineLength=Math.max(h.length+r,this._longestLineLength);clearNode(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let a=this._messageBlock;for(const h of s)a=document.createElement("div"),a.innerText=h,""===h&&(a.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(a);if(t||o){const e=document.createElement("span");if(e.classList.add("details"),a.appendChild(e),t){const i=document.createElement("span");i.innerText=t,i.classList.add("source"),e.appendChild(i)}if(o)if("string"==typeof o){const t=document.createElement("span");t.innerText=`(${o})`,t.classList.add("code"),e.appendChild(t)}else{this._codeLink=$$c("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(o.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};append$1(this._codeLink,$$c("span")).innerText=o.value,e.appendChild(this._codeLink)}}if(clearNode(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),isNonEmptyArray(n)){const e=this._relatedBlock.appendChild(document.createElement("div"));e.style.paddingTop=`${Math.floor(.66*this._editor.getOption(59))}px`,this._lines+=1;for(const t of n){let i=document.createElement("div"),n=document.createElement("a");n.classList.add("filename"),n.innerText=`${getBaseLabel(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,n.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(n,t);let o=document.createElement("span");o.innerText=t.message,i.appendChild(n),i.appendChild(o),this._lines+=1,e.appendChild(i)}}const l=this._editor.getOption(44),d=Math.ceil(l.typicalFullwidthCharacterWidth*this._longestLineLength*.75),c=l.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:c})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case MarkerSeverity$2.Error:t=localize("Error","Error");break;case MarkerSeverity$2.Warning:t=localize("Warning","Warning");break;case MarkerSeverity$2.Info:t=localize("Info","Info");break;case MarkerSeverity$2.Hint:t=localize("Hint","Hint")}let i=localize("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();if(n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1){i=`${n.getLineContent(e.startLineNumber)}, ${i}`}return i}}let MarkerNavigationWidget=class e extends PeekViewWidget{constructor(e,t,i,n,o,r,s){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},o),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=r,this._labelService=s,this._callOnDispose=new DisposableStore,this._onDidSelectRelatedInformation=new Emitter$1,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=MarkerSeverity$2.Warning,this._backgroundColor=Color.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(editorMarkerNavigationBackground);let t=editorMarkerNavigationError,i=editorMarkerNavigationErrorHeader;this._severity===MarkerSeverity$2.Warning?(t=editorMarkerNavigationWarning,i=editorMarkerNavigationWarningHeader):this._severity===MarkerSeverity$2.Info&&(t=editorMarkerNavigationInfo,i=editorMarkerNavigationInfoHeader);const n=e.getColor(t),o=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:o,primaryHeadingColor:e.getColor(peekViewTitleForeground),secondaryHeadingColor:e.getColor(peekViewTitleInfoForeground)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun((e=>this.editor.focus())));const i=[],n=this._menuService.createMenu(e.TitleMenu,this._contextKeyService);createAndFillInActionBarActions(n,void 0,i),this._actionbarWidget.push(i,{label:!1,icon:!0,index:0}),n.dispose()}_fillTitleIcon(e){this._icon=append$1(e,$$c(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new MessageWidget(this._container,this.editor,(e=>this._onDidSelectRelatedInformation.fire(e)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());let n=Range$2.lift(e);const o=this.editor.getPosition();let r=o&&n.containsPosition(o)?o:n.getStartPosition();super.show(r,this.computeRequiredHeight());const s=this.editor.getModel();if(s){const e=i>1?localize("problems","{0} of {1} problems",t,i):localize("change","{0} of {1} problem",t,i);this.setTitle(basename(s.uri),e)}this._icon.className=`codicon ${SeverityIcon.className(MarkerSeverity$2.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};MarkerNavigationWidget.TitleMenu=new MenuId("gotoErrorTitleMenu"),MarkerNavigationWidget=__decorate$$([__param$_(1,IThemeService),__param$_(2,IOpenerService),__param$_(3,IMenuService),__param$_(4,IInstantiationService),__param$_(5,IContextKeyService),__param$_(6,ILabelService)],MarkerNavigationWidget);let errorDefault=oneOf(editorErrorForeground,editorErrorBorder),warningDefault=oneOf(editorWarningForeground,editorWarningBorder),infoDefault=oneOf(editorInfoForeground,editorInfoBorder);const editorMarkerNavigationError=registerColor("editorMarkerNavigationError.background",{dark:errorDefault,light:errorDefault,hc:contrastBorder},localize("editorMarkerNavigationError","Editor marker navigation widget error color.")),editorMarkerNavigationErrorHeader=registerColor("editorMarkerNavigationError.headerBackground",{dark:transparent(editorMarkerNavigationError,.1),light:transparent(editorMarkerNavigationError,.1),hc:null},localize("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),editorMarkerNavigationWarning=registerColor("editorMarkerNavigationWarning.background",{dark:warningDefault,light:warningDefault,hc:contrastBorder},localize("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),editorMarkerNavigationWarningHeader=registerColor("editorMarkerNavigationWarning.headerBackground",{dark:transparent(editorMarkerNavigationWarning,.1),light:transparent(editorMarkerNavigationWarning,.1),hc:"#0C141F"},localize("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),editorMarkerNavigationInfo=registerColor("editorMarkerNavigationInfo.background",{dark:infoDefault,light:infoDefault,hc:contrastBorder},localize("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),editorMarkerNavigationInfoHeader=registerColor("editorMarkerNavigationInfo.headerBackground",{dark:transparent(editorMarkerNavigationInfo,.1),light:transparent(editorMarkerNavigationInfo,.1),hc:null},localize("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),editorMarkerNavigationBackground=registerColor("editorMarkerNavigation.background",{dark:editorBackground,light:editorBackground,hc:editorBackground},localize("editorMarkerNavigationBackground","Editor marker navigation widget background."));var __decorate$_=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$Z=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$C=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let MarkerController=class e{constructor(e,t,i,n,o){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=o,this._sessionDispoables=new DisposableStore,this._editor=e,this._widgetVisible=CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService)}static get(t){return t.getContribution(e.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(MarkerNavigationWidget,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var t,i,n;(null===(t=this._model)||void 0===t?void 0:t.selected)&&Range$2.containsPosition(null===(i=this._model)||void 0===i?void 0:i.selected.marker,e.position)||null===(n=this._model)||void 0===n||n.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:Range$2.lift(e).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new Position$1(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(t,i){var n,o;return __awaiter$C(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const r=this._getOrCreateModel(i?void 0:this._editor.getModel().uri);if(r.move(t,this._editor.getModel(),this._editor.getPosition()),!r.selected)return;if(r.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const s=yield this._editorService.openCodeEditor({resource:r.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:r.selected.marker}},this._editor);s&&(null===(n=e.get(s))||void 0===n||n.close(),null===(o=e.get(s))||void 0===o||o.nagivate(t,i))}else this._widget.showAtMarker(r.selected.marker,r.selected.index,r.selected.total)}}))}};MarkerController.ID="editor.contrib.markerController",MarkerController=__decorate$_([__param$Z(1,IMarkerNavigationService),__param$Z(2,IContextKeyService),__param$Z(3,ICodeEditorService),__param$Z(4,IInstantiationService)],MarkerController);class MarkerNavigationAction extends EditorAction{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return __awaiter$C(this,void 0,void 0,(function*(){t.hasModel()&&(null===(i=MarkerController.get(t))||void 0===i||i.nagivate(this._next,this._multiFile))}))}}class NextMarkerAction extends MarkerNavigationAction{constructor(){super(!0,!1,{id:NextMarkerAction.ID,label:NextMarkerAction.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:578,weight:100},menuOpts:{menuId:MarkerNavigationWidget.TitleMenu,title:NextMarkerAction.LABEL,icon:registerIcon("marker-navigation-next",Codicon.arrowDown,localize("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}NextMarkerAction.ID="editor.action.marker.next",NextMarkerAction.LABEL=localize("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class PrevMarkerAction extends MarkerNavigationAction{constructor(){super(!1,!1,{id:PrevMarkerAction.ID,label:PrevMarkerAction.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:1602,weight:100},menuOpts:{menuId:MarkerNavigationWidget.TitleMenu,title:PrevMarkerAction.LABEL,icon:registerIcon("marker-navigation-previous",Codicon.arrowUp,localize("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}PrevMarkerAction.ID="editor.action.marker.prev",PrevMarkerAction.LABEL=localize("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class NextMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:localize("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:66,weight:100},menuOpts:{menuId:MenuId.MenubarGoMenu,title:localize({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class PrevMarkerInFilesAction extends MarkerNavigationAction{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:localize("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:1090,weight:100},menuOpts:{menuId:MenuId.MenubarGoMenu,title:localize({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}registerEditorContribution(MarkerController.ID,MarkerController),registerEditorAction(NextMarkerAction),registerEditorAction(PrevMarkerAction),registerEditorAction(NextMarkerInFilesAction),registerEditorAction(PrevMarkerInFilesAction);const CONTEXT_MARKERS_NAVIGATION_VISIBLE=new RawContextKey("markersNavigationVisible",!1),MarkerCommand=EditorCommand.bindToContribution(MarkerController.get);registerEditorCommand(new MarkerCommand({id:"closeMarkersNavigation",precondition:CONTEXT_MARKERS_NAVIGATION_VISIBLE,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}}));var __decorate$Z=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$Y=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const $$5=$$c;class MarkerHover{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const markerCodeActionTrigger={type:1,filter:{include:CodeActionKind.QuickFix}};let MarkerHoverParticipant=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=5,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];for(const s of t){const t=s.range.startLineNumber===n?s.range.startColumn:1,a=s.range.endLineNumber===n?s.range.endColumn:o,l=this._markerDecorationsService.getMarker(i.uri,s);if(!l)continue;const d=new Range$2(e.range.startLineNumber,t,e.range.startLineNumber,a);r.push(new MarkerHover(this,d,l))}return r}renderHoverParts(e,t){if(!t.length)return Disposable.None;const i=new DisposableStore;t.forEach((t=>e.fragment.appendChild(this.renderMarkerHover(t,i))));const n=1===t.length?t[0]:t.sort(((e,t)=>MarkerSeverity$2.compare(e.marker.severity,t.marker.severity)))[0];return this.renderMarkerStatusbar(e,n,i),i}renderMarkerHover(e,t){const i=$$5("div.hover-row"),n=append$1(i,$$5("div.marker.hover-contents")),{source:o,message:r,code:s,relatedInformation:a}=e.marker;this._editor.applyFontInfo(n);const l=append$1(n,$$5("span"));if(l.style.whiteSpace="pre-wrap",l.innerText=r,o||s)if(s&&"string"!=typeof s){const e=$$5("span");if(o){append$1(e,$$5("span")).innerText=o}const i=append$1(e,$$5("a.code-link"));i.setAttribute("href",s.target.toString()),t.add(addDisposableListener(i,"click",(e=>{this._openerService.open(s.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));append$1(i,$$5("span")).innerText=s.value;const r=append$1(n,e);r.style.opacity="0.6",r.style.paddingLeft="6px"}else{const e=append$1(n,$$5("span"));e.style.opacity="0.6",e.style.paddingLeft="6px",e.innerText=o&&s?`${o}(${s})`:o||`(${s})`}if(isNonEmptyArray(a))for(const{message:d,resource:c,startLineNumber:h,startColumn:u}of a){const e=append$1(n,$$5("div"));e.style.marginTop="8px";const i=append$1(e,$$5("a"));i.innerText=`${basename(c)}(${h}, ${u}): `,i.style.cursor="pointer",t.add(addDisposableListener(i,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(c,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:h,startColumn:u}}}).catch(onUnexpectedError)})));const o=append$1(e,$$5("span"));o.innerText=d,this._editor.applyFontInfo(o)}return i}renderMarkerStatusbar(e,t,i){if(t.marker.severity!==MarkerSeverity$2.Error&&t.marker.severity!==MarkerSeverity$2.Warning&&t.marker.severity!==MarkerSeverity$2.Info||e.statusBar.addAction({label:localize("view problem","View Problem"),commandId:NextMarkerAction.ID,run:()=>{var i;e.hide(),null===(i=MarkerController.get(this._editor))||void 0===i||i.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(81)){const n=e.statusBar.append($$5("div"));this.recentMarkerCodeActionsInfo&&(IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker)===IMarkerData.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=localize("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const o=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?Disposable.None:i.add(disposableTimeout((()=>n.textContent=localize("checkingForQuickFixes","Checking for quick fixes...")),200));n.textContent||(n.textContent=String.fromCharCode(160));const r=this.getCodeActions(t.marker);i.add(toDisposable((()=>r.cancel()))),r.then((r=>{if(o.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:r.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return r.dispose(),void(n.textContent=localize("noQuickFixes","No quick fixes available"));n.style.display="none";let s=!1;i.add(toDisposable((()=>{s||r.dispose()}))),e.statusBar.addAction({label:localize("quick fixes","Quick Fix..."),commandId:QuickFixAction.Id,run:t=>{s=!0;const i=QuickFixController.get(this._editor),n=getDomNodePagePosition(t);e.hide(),null==i||i.showCodeActions(markerCodeActionTrigger,r,{x:n.left+6,y:n.top+n.height+6})}})}),onUnexpectedError)}}getCodeActions(e){return createCancelablePromise((t=>getCodeActions(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new Range$2(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),markerCodeActionTrigger,Progress.None,t)))}};MarkerHoverParticipant=__decorate$Z([__param$Y(1,IMarkerDecorationsService),__param$Y(2,IOpenerService),__param$Y(3,ILanguageFeaturesService)],MarkerHoverParticipant),registerThemingParticipant(((e,t)=>{const i=e.getColor(textLinkForeground);i&&t.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${i}; }`);const n=e.getColor(textLinkActiveForeground);n&&t.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${n}; }`)}));var __decorate$Y=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$X=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ModesHoverController=class e{constructor(e,t,i,n,o){this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=n,this._toUnhook=new DisposableStore,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration((e=>{e.hasChanged(53)&&(this._unhookEvents(),this._hookEvents())}))}static get(t){return t.getContribution(e.ID)}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(53);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave(e)),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._isMouseDown=!0;const t=e.target;9!==t.type||t.detail!==ContentHoverWidget.ID?12===t.type&&t.detail===MarginHoverWidget.ID||(12!==t.type&&(this._hoverClicked=!1),this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseMove(e){var t,i,n,o,r;const s=e.target;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&9===s.type&&s.detail===ContentHoverWidget.ID)return;if(this._isHoverSticky&&!(null===(i=null===(t=e.event.browserEvent.view)||void 0===t?void 0:t.getSelection())||void 0===i?void 0:i.isCollapsed))return;if(!this._isHoverSticky&&9===s.type&&s.detail===ContentHoverWidget.ID&&(null===(n=this._contentWidget)||void 0===n?void 0:n.isColorPickerVisible()))return;if(this._isHoverSticky&&12===s.type&&s.detail===MarginHoverWidget.ID)return;if(!this._isHoverEnabled)return void this._hideWidgets();if(!this._getOrCreateContentWidget().maybeShowAt(e))return 2===s.type&&s.position?(null===(r=this._contentWidget)||void 0===r||r.hide(),this._glyphWidget||(this._glyphWidget=new MarginHoverWidget(this._editor,this._languageService,this._openerService)),void this._glyphWidget.startShowingAt(s.position.lineNumber)):void this._hideWidgets();null===(o=this._glyphWidget)||void 0===o||o.hide()}_onKeyDown(e){5!==e.keyCode&&6!==e.keyCode&&57!==e.keyCode&&4!==e.keyCode&&this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||(this._hoverClicked=!1,null===(t=this._glyphWidget)||void 0===t||t.hide(),null===(i=this._contentWidget)||void 0===i||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(ContentHoverController,this._editor)),this._contentWidget}isColorPickerVisible(){var e;return(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||!1}showContentHover(e,t,i){this._getOrCreateContentWidget().startShowingAtRange(e,t,i)}dispose(){var e,t;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),null===(e=this._glyphWidget)||void 0===e||e.dispose(),null===(t=this._contentWidget)||void 0===t||t.dispose()}};ModesHoverController.ID="editor.contrib.hover",ModesHoverController=__decorate$Y([__param$X(1,IInstantiationService),__param$X(2,IOpenerService),__param$X(3,ILanguageService),__param$X(4,IContextKeyService)],ModesHoverController);class ShowHoverAction extends EditorAction{constructor(){super({id:"editor.action.showHover",label:localize({key:"showHover",comment:["Label for action that will trigger the showing of a hover in the editor.","This allows for users to show the hover without using the mouse."]},"Show Hover"),alias:"Show Hover",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2087),weight:100}})}run(e,t){if(!t.hasModel())return;let i=ModesHoverController.get(t);if(!i)return;const n=t.getPosition(),o=new Range$2(n.lineNumber,n.column,n.lineNumber,n.column),r=2===t.getOption(2);i.showContentHover(o,1,r)}}class ShowDefinitionPreviewHoverAction extends EditorAction{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:localize({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=ModesHoverController.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const o=new Range$2(n.lineNumber,n.column,n.lineNumber,n.column),r=GotoDefinitionAtPositionEditorContribution.get(t);if(!r)return;r.startFindDefinitionFromCursor(n).then((()=>{i.showContentHover(o,1,!0)}))}}registerEditorContribution(ModesHoverController.ID,ModesHoverController),registerEditorAction(ShowHoverAction),registerEditorAction(ShowDefinitionPreviewHoverAction),HoverParticipantRegistry.register(MarkdownHoverParticipant),HoverParticipantRegistry.register(MarkerHoverParticipant),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorHoverHighlight);i&&t.addRule(`.monaco-editor .hoverHighlight { background-color: ${i}; }`);const n=e.getColor(editorHoverBackground);n&&t.addRule(`.monaco-editor .monaco-hover { background-color: ${n}; }`);const o=e.getColor(editorHoverBorder);o&&(t.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${o}; }`),t.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${o.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${o.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${o.transparent(.5)}; }`));const r=e.getColor(textLinkForeground);r&&t.addRule(`.monaco-editor .monaco-hover a { color: ${r}; }`);const s=e.getColor(textLinkActiveForeground);s&&t.addRule(`.monaco-editor .monaco-hover a:hover { color: ${s}; }`);const a=e.getColor(editorHoverForeground);a&&t.addRule(`.monaco-editor .monaco-hover { color: ${a}; }`);const l=e.getColor(editorHoverStatusBarBackground);l&&t.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${l}; }`);const d=e.getColor(textCodeBlockBackground);d&&t.addRule(`.monaco-editor .monaco-hover code { background-color: ${d}; }`)}));class ColorContribution extends Disposable{constructor(e){super(),this._editor=e,this._register(e.onMouseDown((e=>this.onMouseDown(e))))}dispose(){super.dispose()}onMouseDown(e){const t=e.target;if(6!==t.type)return;if(!t.detail.injectedText)return;if(t.detail.injectedText.options.attachedData!==ColorDecorationInjectedTextMarker)return;if(!t.range)return;const i=this._editor.getContribution(ModesHoverController.ID);if(i&&!i.isColorPickerVisible()){const e=new Range$2(t.range.startLineNumber,t.range.startColumn+1,t.range.endLineNumber,t.range.endColumn+1);i.showContentHover(e,1,!1)}}}ColorContribution.ID="editor.contrib.colorContribution",registerEditorContribution(ColorContribution.ID,ColorContribution),HoverParticipantRegistry.register(ColorHoverParticipant);class EditOperation{static insert(e,t){return{range:new Range$2(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}class BlockCommentCommand{constructor(e,t,i){this.languageConfigurationService=i,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1;const n=t.length;if(i+n>e.length)return!1;for(let o=0;o<n;o++){const n=e.charCodeAt(i+o),r=t.charCodeAt(o);if(n!==r&&!(n>=65&&n<=90&&n+32===r||r>=65&&r<=90&&r+32===n))return!1}return!0}_createOperationsForBlockComment(e,t,i,n,o,r){const s=e.startLineNumber,a=e.startColumn,l=e.endLineNumber,d=e.endColumn,c=o.getLineContent(s),h=o.getLineContent(l);let u,g=c.lastIndexOf(t,a-1+t.length),p=h.indexOf(i,d-1-i.length);if(-1!==g&&-1!==p)if(s===l){c.substring(g+t.length,p).indexOf(i)>=0&&(g=-1,p=-1)}else{const e=c.substring(g+t.length),n=h.substring(0,p);(e.indexOf(i)>=0||n.indexOf(i)>=0)&&(g=-1,p=-1)}-1!==g&&-1!==p?(n&&g+t.length<c.length&&32===c.charCodeAt(g+t.length)&&(t+=" "),n&&p>0&&32===h.charCodeAt(p-1)&&(i=" "+i,p-=1),u=BlockCommentCommand._createRemoveBlockCommentOperations(new Range$2(s,g+t.length+1,l,p+1),t,i)):(u=BlockCommentCommand._createAddBlockCommentOperations(e,t,i,this._insertSpace),this._usedEndToken=1===u.length?i:null);for(const m of u)r.addTrackedEditOperation(m.range,m.text)}static _createRemoveBlockCommentOperations(e,t,i){let n=[];return Range$2.isEmpty(e)?n.push(EditOperation.delete(new Range$2(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+i.length))):(n.push(EditOperation.delete(new Range$2(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),n.push(EditOperation.delete(new Range$2(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+i.length)))),n}static _createAddBlockCommentOperations(e,t,i,n){let o=[];return Range$2.isEmpty(e)?o.push(EditOperation.replace(new Range$2(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+i)):(o.push(EditOperation.insert(new Position$1(e.startLineNumber,e.startColumn),t+(n?" ":""))),o.push(EditOperation.insert(new Position$1(e.endLineNumber,e.endColumn),(n?" ":"")+i))),o}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn;e.tokenizeIfCheap(i);const o=e.getLanguageIdAtPosition(i,n),r=this.languageConfigurationService.getLanguageConfiguration(o).comments;r&&r.blockCommentStartToken&&r.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(2===i.length){const e=i[0],t=i[1];return new Selection$1(e.range.endLineNumber,e.range.endColumn,t.range.startLineNumber,t.range.startColumn)}{const e=i[0].range,t=this._usedEndToken?-this._usedEndToken.length-1:0;return new Selection$1(e.endLineNumber,e.endColumn+t,e.endLineNumber,e.endColumn+t)}}}class LineCommentCommand{constructor(e,t,i,n,o,r,s){this.languageConfigurationService=e,this._selection=t,this._tabSize=i,this._type=n,this._insertSpace=o,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=s||!1}static _gatherPreflightCommentStrings(e,t,i,n){e.tokenizeIfCheap(t);const o=e.getLanguageIdAtPosition(t,1),r=n.getLanguageConfiguration(o).comments,s=r?r.lineCommentToken:null;if(!s)return null;let a=[];for(let l=0,d=i-t+1;l<d;l++)a[l]={ignore:!1,commentStr:s,commentStrOffset:0,commentStrLength:s.length};return a}static _analyzeLines(e,t,i,n,o,r,s,a){let l,d=!0;l=0===e||1!==e;for(let c=0,h=n.length;c<h;c++){const a=n[c],h=o+c;if(h===o&&s){a.ignore=!0;continue}const u=i.getLineContent(h),g=firstNonWhitespaceIndex(u);if(-1!==g){if(d=!1,a.ignore=!1,a.commentStrOffset=g,l&&!BlockCommentCommand._haystackHasNeedleAtOffset(u,a.commentStr,g)&&(0===e?l=!1:1===e||(a.ignore=!0)),l&&t){const e=g+a.commentStrLength;e<u.length&&32===u.charCodeAt(e)&&(a.commentStrLength+=1)}}else a.ignore=r,a.commentStrOffset=u.length}if(0===e&&d){l=!1;for(let e=0,t=n.length;e<t;e++)n[e].ignore=!1}return{supported:!0,shouldRemoveComments:l,lines:n}}static _gatherPreflightData(e,t,i,n,o,r,s,a){const l=LineCommentCommand._gatherPreflightCommentStrings(i,n,o,a);return null===l?{supported:!1}:LineCommentCommand._analyzeLines(e,t,i,l,n,r,s,a)}_executeLineComments(e,t,i,n){let o;i.shouldRemoveComments?o=LineCommentCommand._createRemoveLineCommentsOperations(i.lines,n.startLineNumber):(LineCommentCommand._normalizeInsertionPoint(e,i.lines,n.startLineNumber,this._tabSize),o=this._createAddLineCommentsOperations(i.lines,n.startLineNumber));const r=new Position$1(n.positionLineNumber,n.positionColumn);for(let s=0,a=o.length;s<a;s++)if(t.addEditOperation(o[s].range,o[s].text),Range$2.isEmpty(o[s].range)&&Range$2.getStartPosition(o[s].range).equals(r)){e.getLineContent(r.lineNumber).length+1===r.column&&(this._deltaColumn=(o[s].text||"").length)}this._selectionId=t.trackSelection(n)}_attemptRemoveBlockComment(e,t,i,n){let o=t.startLineNumber,r=t.endLineNumber,s=n.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn),a=e.getLineContent(o).lastIndexOf(i,s-1),l=e.getLineContent(r).indexOf(n,t.endColumn-1-i.length);return-1!==a&&-1===l&&(l=e.getLineContent(o).indexOf(n,a+i.length),r=o),-1===a&&-1!==l&&(a=e.getLineContent(r).lastIndexOf(i,l),o=r),!t.isEmpty()||-1!==a&&-1!==l||(a=e.getLineContent(o).indexOf(i),-1!==a&&(l=e.getLineContent(o).indexOf(n,a+i.length))),-1!==a&&32===e.getLineContent(o).charCodeAt(a+i.length)&&(i+=" "),-1!==l&&32===e.getLineContent(r).charCodeAt(l-1)&&(n=" "+n,l-=1),-1!==a&&-1!==l?BlockCommentCommand._createRemoveBlockCommentOperations(new Range$2(o,a+i.length+1,r,l+1),i,n):null}_executeBlockComment(e,t,i){e.tokenizeIfCheap(i.startLineNumber);let n=e.getLanguageIdAtPosition(i.startLineNumber,1),o=LanguageConfigurationRegistry.getComments(n);if(!o||!o.blockCommentStartToken||!o.blockCommentEndToken)return;const r=o.blockCommentStartToken,s=o.blockCommentEndToken;let a=this._attemptRemoveBlockComment(e,i,r,s);if(!a){if(i.isEmpty()){const t=e.getLineContent(i.startLineNumber);let n=firstNonWhitespaceIndex(t);-1===n&&(n=t.length),a=BlockCommentCommand._createAddBlockCommentOperations(new Range$2(i.startLineNumber,n+1,i.startLineNumber,t.length+1),r,s,this._insertSpace)}else a=BlockCommentCommand._createAddBlockCommentOperations(new Range$2(i.startLineNumber,e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),r,s,this._insertSpace);1===a.length&&(this._deltaColumn=r.length+1)}this._selectionId=t.trackSelection(i);for(const l of a)t.addEditOperation(l.range,l.text)}getEditOperations(e,t){let i=this._selection;if(this._moveEndPositionDown=!1,i.startLineNumber===i.endLineNumber&&this._ignoreFirstLine)return t.addEditOperation(new Range$2(i.startLineNumber,e.getLineMaxColumn(i.startLineNumber),i.startLineNumber+1,1),i.startLineNumber===e.getLineCount()?"":"\n"),void(this._selectionId=t.trackSelection(i));i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=LineCommentCommand._gatherPreflightData(this._type,this._insertSpace,e,i.startLineNumber,i.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new Selection$1(i.selectionStartLineNumber,i.selectionStartColumn+this._deltaColumn,i.positionLineNumber,i.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){let i=[];for(let n=0,o=e.length;n<o;n++){const o=e[n];o.ignore||i.push(EditOperation.delete(new Range$2(t+n,o.commentStrOffset+1,t+n,o.commentStrOffset+o.commentStrLength+1)))}return i}_createAddLineCommentsOperations(e,t){let i=[];const n=this._insertSpace?" ":"";for(let o=0,r=e.length;o<r;o++){const r=e[o];r.ignore||i.push(EditOperation.insert(new Position$1(t+o,r.commentStrOffset+1),r.commentStr+n))}return i}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){let o,r,s=1073741824;for(let a=0,l=t.length;a<l;a++){if(t[a].ignore)continue;const o=e.getLineContent(i+a);let r=0;for(let e=0,i=t[a].commentStrOffset;r<s&&e<i;e++)r=LineCommentCommand.nextVisibleColumn(r,n,9===o.charCodeAt(e),1);r<s&&(s=r)}s=Math.floor(s/n)*n;for(let a=0,l=t.length;a<l;a++){if(t[a].ignore)continue;const l=e.getLineContent(i+a);let d=0;for(o=0,r=t[a].commentStrOffset;d<s&&o<r;o++)d=LineCommentCommand.nextVisibleColumn(d,n,9===l.charCodeAt(o),1);t[a].commentStrOffset=d>s?o-1:o}}}class CommentLineAction extends EditorAction{constructor(e,t){super(t),this._type=e}run(e,t){const i=e.get(ILanguageConfigurationService);if(!t.hasModel())return;const n=[],o=t.getModel().getOptions(),r=t.getOption(19),s=t.getSelections().map(((e,t)=>({selection:e,index:t,ignoreFirstLine:!1})));s.sort(((e,t)=>Range$2.compareRangesUsingStarts(e.selection,t.selection)));let a=s[0];for(let l=1;l<s.length;l++){const e=s[l];a.selection.endLineNumber===e.selection.startLineNumber&&(a.index<e.index?e.ignoreFirstLine=!0:(a.ignoreFirstLine=!0,a=e))}for(const l of s)n.push(new LineCommentCommand(i,l.selection,o.tabSize,this._type,r.insertSpace,r.ignoreEmptyLines,l.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class ToggleCommentLineAction extends CommentLineAction{constructor(){super(0,{id:"editor.action.commentLine",label:localize("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:localize({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class AddLineCommentAction extends CommentLineAction{constructor(){super(1,{id:"editor.action.addCommentLine",label:localize("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2081),weight:100}})}}class RemoveLineCommentAction extends CommentLineAction{constructor(){super(2,{id:"editor.action.removeCommentLine",label:localize("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2099),weight:100}})}}class BlockCommentAction extends EditorAction{constructor(){super({id:"editor.action.blockComment",label:localize("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"5_insert",title:localize({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,t){const i=e.get(ILanguageConfigurationService);if(!t.hasModel())return;const n=t.getOption(19),o=[],r=t.getSelections();for(const s of r)o.push(new BlockCommentCommand(s,n.insertSpace,i));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}registerEditorAction(ToggleCommentLineAction),registerEditorAction(AddLineCommentAction),registerEditorAction(RemoveLineCommentAction),registerEditorAction(BlockCommentAction);var __decorate$X=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$W=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ContextMenuController=class e{constructor(e,t,i,n,o,r){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=o,this._menuService=r,this._toDispose=new DisposableStore,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu((e=>this._onContextMenu(e)))),this._toDispose.add(this._editor.onMouseWheel((e=>{if(this._contextMenuIsBeingShownCount>0){const t=this._contextViewService.getContextViewElement(),i=e.srcElement;i.shadowRoot&&getShadowRoot(t)===i.shadowRoot||this._contextViewService.hideContextView()}}))),this._toDispose.add(this._editor.onKeyDown((e=>{58===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showContextMenu())})))}static get(t){return t.getContribution(e.ID)}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(20))return this._editor.focus(),void(e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position));if(12===e.target.type)return;if(6===e.target.type&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),6!==e.target.type&&7!==e.target.type&&1!==e.target.type)return;if(this._editor.focus(),e.target.position){let t=!1;for(const i of this._editor.getSelections())if(i.containsPosition(e.target.position)){t=!0;break}t||this._editor.setPosition(e.target.position)}let t=null;1!==e.target.type&&(t={x:e.event.posx-1,width:2,y:e.event.posy-1,height:2}),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(20))return;if(!this._editor.hasModel())return;if(!this._contextMenuService)return void this._editor.focus();const t=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?MenuId.SimpleEditorContext:MenuId.EditorContext);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const i=[],n=this._menuService.createMenu(t,this._contextKeyService),o=n.getActions({arg:e.uri});n.dispose();for(let r of o){const[,t]=r;let n=0;for(const o of t)if(o instanceof SubmenuItemAction){const t=this._getMenuActions(e,o.item.submenu);t.length>0&&(i.push(new SubmenuAction(o.id,o.label,t)),n++)}else i.push(o),n++;n&&i.push(new Separator)}return i.length&&i.pop(),i}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;const i=this._editor.getOption(53);if(this._editor.updateOptions({hover:{enabled:!1}}),!t){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const e=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),i=getDomNodePagePosition(this._editor.getDomNode()),n=i.left+e.left,o=i.top+e.top+e.height;t={x:n,y:o}}const n=this._editor.getOption(115)&&!isIOS;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:n?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>e,getActionViewItem:e=>{const t=this._keybindingFor(e);if(t)return new ActionViewItem(e,e,{label:!0,keybinding:t.getLabel(),isMenu:!0});const i=e;return"function"==typeof i.getActionViewItem?i.getActionViewItem():new ActionViewItem(e,e,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:e=>this._keybindingFor(e),onHide:e=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:i})}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};ContextMenuController.ID="editor.contrib.contextmenu",ContextMenuController=__decorate$X([__param$W(1,IContextMenuService),__param$W(2,IContextViewService),__param$W(3,IContextKeyService),__param$W(4,IKeybindingService),__param$W(5,IMenuService)],ContextMenuController);class ShowContextMenu extends EditorAction{constructor(){super({id:"editor.action.showContextMenu",label:localize("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:1092,weight:100}})}run(e,t){var i;null===(i=ContextMenuController.get(t))||void 0===i||i.showContextMenu()}}registerEditorContribution(ContextMenuController.ID,ContextMenuController),registerEditorAction(ShowContextMenu);class CursorState{constructor(e){this.selections=e}equals(e){const t=this.selections.length;if(t!==e.selections.length)return!1;for(let i=0;i<t;i++)if(!this.selections[i].equalsSelection(e.selections[i]))return!1;return!0}}class StackElement{constructor(e,t,i){this.cursorState=e,this.scrollTop=t,this.scrollLeft=i}}class CursorUndoRedoController extends Disposable{constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(e.onDidChangeModelContent((e=>{this._undoStack=[],this._redoStack=[]}))),this._register(e.onDidChangeCursorSelection((t=>{if(this._isCursorUndoRedo)return;if(!t.oldSelections)return;if(t.oldModelVersionId!==t.modelVersionId)return;const i=new CursorState(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new StackElement(i,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())})))}static get(e){return e.getContribution(CursorUndoRedoController.ID)}cursorUndo(){this._editor.hasModel()&&0!==this._undoStack.length&&(this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){this._editor.hasModel()&&0!==this._redoStack.length&&(this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}}CursorUndoRedoController.ID="editor.contrib.cursorUndoRedoController";class CursorUndo extends EditorAction{constructor(){super({id:"cursorUndo",label:localize("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2099,weight:100}})}run(e,t,i){var n;null===(n=CursorUndoRedoController.get(t))||void 0===n||n.cursorUndo()}}class CursorRedo extends EditorAction{constructor(){super({id:"cursorRedo",label:localize("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(e,t,i){var n;null===(n=CursorUndoRedoController.get(t))||void 0===n||n.cursorRedo()}}registerEditorContribution(CursorUndoRedoController.ID,CursorUndoRedoController),registerEditorAction(CursorUndo),registerEditorAction(CursorRedo);var dnd="";class DragAndDropCommand{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){let i=e.getValueInRange(this.selection);this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new Range$2(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new Selection$1(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new Selection$1(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new Selection$1(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(e,t){return this.targetSelection}}function hasTriggerModifier(e){return isMacintosh?e.altKey:e.ctrlKey}class DragAndDropController extends Disposable{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._dndDecorationIds=[],this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(31)&&!this._editor.getOption(18)&&(hasTriggerModifier(e)&&(this._modifierPressed=!0),this._mouseDown&&hasTriggerModifier(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(31)&&!this._editor.getOption(18)&&(hasTriggerModifier(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===DragAndDropController.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){let t=e.target;if(null===this._dragSelection){let e=(this._editor.getSelections()||[]).filter((e=>t.position&&e.containsPosition(t.position)));if(1!==e.length)return;this._dragSelection=e[0]}hasTriggerModifier(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){let t=new Position$1(e.target.position.lineNumber,e.target.position.column);if(null===this._dragSelection){let i=null;if(e.event.shiftKey){let e=this._editor.getSelection();if(e){const{selectionStartLineNumber:n,selectionStartColumn:o}=e;i=[new Selection$1(n,o,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map((e=>e.containsPosition(t)?new Selection$1(t.lineNumber,t.column,t.lineNumber,t.column):e));this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(hasTriggerModifier(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(DragAndDropController.ID,new DragAndDropCommand(this._dragSelection,t,hasTriggerModifier(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){let t=[{range:new Range$2(e.lineNumber,e.column,e.lineNumber,e.column),options:DragAndDropController._DECORATION_OPTIONS}];this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,t),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,[])}_hitContent(e){return 6===e.type||7===e.type}_hitMargin(e){return 2===e.type||3===e.type||4===e.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}DragAndDropController.ID="editor.contrib.dragAndDrop",DragAndDropController.TRIGGER_KEY_VALUE=isMacintosh?6:5,DragAndDropController._DECORATION_OPTIONS=ModelDecorationOptions.register({description:"dnd-target",className:"dnd-target"}),registerEditorContribution(DragAndDropController.ID,DragAndDropController);class FindDecorations{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map((e=>this._editor.getModel().getDecorationRange(e))).filter((e=>!!e));if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(e){let t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const e=i.options;if(e===FindDecorations._FIND_MATCH_DECORATION||e===FindDecorations._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,o=this._decorations.length;n<o;n++){let o=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(o)){t=this._decorations[n],i=n+1;break}}return null===this._highlightedDecorationId&&null===t||this._editor.changeDecorations((e=>{if(null!==this._highlightedDecorationId&&(e.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),null!==t&&(this._highlightedDecorationId=t,e.changeDecorationOptions(this._highlightedDecorationId,FindDecorations._CURRENT_FIND_MATCH_DECORATION)),null!==this._rangeHighlightDecorationId&&(e.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),null!==t){let i=this._editor.getModel().getDecorationRange(t);if(i.startLineNumber!==i.endLineNumber&&1===i.endColumn){let e=i.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);i=new Range$2(i.startLineNumber,i.startColumn,e,t)}this._rangeHighlightDecorationId=e.addDecoration(i,FindDecorations._RANGE_HIGHLIGHT_DECORATION)}})),i}set(e,t){this._editor.changeDecorations((i=>{let n=FindDecorations._FIND_MATCH_DECORATION,o=[];if(e.length>1e3){n=FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;const t=this._editor.getModel().getLineCount(),i=this._editor.getLayoutInfo().height/t,r=Math.max(2,Math.ceil(3/i));let s=e[0].range.startLineNumber,a=e[0].range.endLineNumber;for(let n=1,l=e.length;n<l;n++){const t=e[n].range;a+r>=t.startLineNumber?t.endLineNumber>a&&(a=t.endLineNumber):(o.push({range:new Range$2(s,1,a,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),s=t.startLineNumber,a=t.endLineNumber)}o.push({range:new Range$2(s,1,a,1),options:FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let r=new Array(e.length);for(let t=0,s=e.length;t<s;t++)r[t]={range:e[t].range,options:n};this._decorations=i.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,o),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach((e=>i.removeDecoration(e))),this._findScopeDecorationIds=[]),(null==t?void 0:t.length)&&(this._findScopeDecorationIds=t.map((e=>i.addDecoration(e,FindDecorations._FIND_SCOPE_DECORATION))))}))}matchBeforePosition(e){if(0===this._decorations.length)return null;for(let t=this._decorations.length-1;t>=0;t--){let i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(n&&!(n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(0===this._decorations.length)return null;for(let t=0,i=this._decorations.length;t<i;t++){let i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(n&&!(n.startLineNumber<e.lineNumber)){if(n.startLineNumber>e.lineNumber)return n;if(!(n.startColumn<e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}}FindDecorations._CURRENT_FIND_MATCH_DECORATION=ModelDecorationOptions.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",showIfCollapsed:!0,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane$1.Center},minimap:{color:themeColorFromId(minimapFindMatch),position:MinimapPosition$1.Inline}}),FindDecorations._FIND_MATCH_DECORATION=ModelDecorationOptions.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",showIfCollapsed:!0,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane$1.Center},minimap:{color:themeColorFromId(minimapFindMatch),position:MinimapPosition$1.Inline}}),FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION=ModelDecorationOptions.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION=ModelDecorationOptions.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:themeColorFromId(overviewRulerFindMatchForeground),position:OverviewRulerLane$1.Center}}),FindDecorations._RANGE_HIGHLIGHT_DECORATION=ModelDecorationOptions.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),FindDecorations._FIND_SCOPE_DECORATION=ModelDecorationOptions.register({description:"find-scope",className:"findScope",isWholeLine:!0});class ReplaceAllCommand{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){let e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort(((e,t)=>Range$2.compareRangesUsingStarts(e.range,t.range)));let i=[],n=e[0];for(let t=1;t<e.length;t++)n.range.endLineNumber===e[t].range.startLineNumber&&n.range.endColumn===e[t].range.startColumn?(n.range=n.range.plusRange(e[t].range),n.text=n.text+e[t].text):(i.push(n),n=e[t]);i.push(n);for(const o of i)t.addEditOperation(o.range,o.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function buildReplaceStringWithCasePreserved(e,t){if(e&&""!==e[0]){const i=validateSpecificSpecialCharacter(e,t,"-"),n=validateSpecificSpecialCharacter(e,t,"_");return i&&!n?buildReplaceStringForSpecificSpecialCharacter(e,t,"-"):!i&&n?buildReplaceStringForSpecificSpecialCharacter(e,t,"_"):e[0].toUpperCase()===e[0]?t.toUpperCase():e[0].toLowerCase()===e[0]?t.toLowerCase():containsUppercaseCharacter(e[0][0])&&t.length>0?t[0].toUpperCase()+t.substr(1):e[0][0].toUpperCase()!==e[0][0]&&t.length>0?t[0].toLowerCase()+t.substr(1):t}return t}function validateSpecificSpecialCharacter(e,t,i){return-1!==e[0].indexOf(i)&&-1!==t.indexOf(i)&&e[0].split(i).length===t.split(i).length}function buildReplaceStringForSpecificSpecialCharacter(e,t,i){const n=t.split(i),o=e[0].split(i);let r="";return n.forEach(((e,t)=>{r+=buildReplaceStringWithCasePreserved([o[t]],e)+i})),r.slice(0,-1)}class StaticValueReplacePattern{constructor(e){this.staticValue=e,this.kind=0}}class DynamicPiecesReplacePattern{constructor(e){this.pieces=e,this.kind=1}}class ReplacePattern{constructor(e){e&&0!==e.length?1===e.length&&null!==e[0].staticValue?this._state=new StaticValueReplacePattern(e[0].staticValue):this._state=new DynamicPiecesReplacePattern(e):this._state=new StaticValueReplacePattern("")}static fromStaticValue(e){return new ReplacePattern([ReplacePiece.staticValue(e)])}get hasReplacementPatterns(){return 1===this._state.kind}buildReplaceString(e,t){if(0===this._state.kind)return t?buildReplaceStringWithCasePreserved(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,o=this._state.pieces.length;n<o;n++){let t=this._state.pieces[n];if(null!==t.staticValue){i+=t.staticValue;continue}let o=ReplacePattern._substitute(t.matchIndex,e);if(null!==t.caseOps&&t.caseOps.length>0){let e=[],i=t.caseOps.length,n=0;for(let r=0,s=o.length;r<s;r++){if(n>=i){e.push(o.slice(r));break}switch(t.caseOps[n]){case"U":e.push(o[r].toUpperCase());break;case"u":e.push(o[r].toUpperCase()),n++;break;case"L":e.push(o[r].toLowerCase());break;case"l":e.push(o[r].toLowerCase()),n++;break;default:e.push(o[r])}}o=e.join("")}i+=o}return i}static _substitute(e,t){if(null===t)return"";if(0===e)return t[0];let i="";for(;e>0;){if(e<t.length){return(t[e]||"")+i}i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class ReplacePiece{constructor(e,t,i){this.staticValue=e,this.matchIndex=t,i&&0!==i.length?this.caseOps=i.slice(0):this.caseOps=null}static staticValue(e){return new ReplacePiece(e,-1,null)}static caseOps(e,t){return new ReplacePiece(null,e,t)}}class ReplacePieceBuilder{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){0!==e.length&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=ReplacePiece.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),0!==this._currentStaticPiece.length&&(this._result[this._resultLen++]=ReplacePiece.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new ReplacePattern(this._result)}}function parseReplaceString(e){if(!e||0===e.length)return new ReplacePattern(null);let t=[],i=new ReplacePieceBuilder(e);for(let n=0,o=e.length;n<o;n++){let r=e.charCodeAt(n);if(92!==r){if(36===r){if(n++,n>=o)break;let r=e.charCodeAt(n);if(36===r){i.emitUnchanged(n-1),i.emitStatic("$",n+1);continue}if(48===r||38===r){i.emitUnchanged(n-1),i.emitMatchIndex(0,n+1,t),t.length=0;continue}if(49<=r&&r<=57){let s=r-48;if(n+1<o){let o=e.charCodeAt(n+1);if(48<=o&&o<=57){n++,s=10*s+(o-48),i.emitUnchanged(n-2),i.emitMatchIndex(s,n+1,t),t.length=0;continue}}i.emitUnchanged(n-1),i.emitMatchIndex(s,n+1,t),t.length=0;continue}}}else{if(n++,n>=o)break;let r=e.charCodeAt(n);switch(r){case 92:i.emitUnchanged(n-1),i.emitStatic("\\",n+1);break;case 110:i.emitUnchanged(n-1),i.emitStatic("\n",n+1);break;case 116:i.emitUnchanged(n-1),i.emitStatic("\t",n+1);break;case 117:case 85:case 108:case 76:i.emitUnchanged(n-1),i.emitStatic("",n+1),t.push(String.fromCharCode(r))}}}return i.finalize()}const CONTEXT_FIND_WIDGET_VISIBLE=new RawContextKey("findWidgetVisible",!1);CONTEXT_FIND_WIDGET_VISIBLE.toNegated();const CONTEXT_FIND_INPUT_FOCUSED=new RawContextKey("findInputFocussed",!1),CONTEXT_REPLACE_INPUT_FOCUSED=new RawContextKey("replaceInputFocussed",!1),ToggleCaseSensitiveKeybinding={primary:545,mac:{primary:2593}},ToggleWholeWordKeybinding={primary:565,mac:{primary:2613}},ToggleRegexKeybinding={primary:560,mac:{primary:2608}},ToggleSearchScopeKeybinding={primary:554,mac:{primary:2602}},TogglePreserveCaseKeybinding={primary:558,mac:{primary:2606}},FIND_IDS={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},MATCHES_LIMIT=19999,RESEARCH_DELAY=240;class FindModelBoundToEditorModel{constructor(e,t){this._toDispose=new DisposableStore,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new TimeoutTimer,this._decorations=new FindDecorations(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new RunOnceScheduler((()=>this.research(!1)),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition((e=>{3!==e.reason&&5!==e.reason&&6!==e.reason||this._decorations.setStartPosition(this._editor.getPosition())}))),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent((e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())}))),this._toDispose.add(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,dispose(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){if(!this._isDisposed&&this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)){this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet((()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}),RESEARCH_DELAY)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)}}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;void 0!==t?null!==t&&(i=Array.isArray(t)?t:[t]):i=this._decorations.getFindScopes(),null!==i&&(i=i.map((e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return 1===e.endColumn&&(t-=1),new Range$2(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e})));let n=this._findMatches(i,!1,MATCHES_LIMIT);this._decorations.set(n,i);const o=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(o);if(0===r&&n.length>0){const e=findFirstInSorted(n.map((e=>e.range)),(e=>Range$2.compareRangesUsingStarts(e,o)>=0));r=e>0?e-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),e&&this._editor.getOption(35).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:n}=e,o=this._editor.getModel();return t||1===n?(1===i?i=o.getLineCount():i--,n=o.getLineMaxColumn(i)):n--,new Position$1(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const t=this._decorations.matchAfterPosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<MATCHES_LIMIT){let t=this._decorations.matchBeforePosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),t=this._decorations.matchBeforePosition(e)),void(t&&this._setCurrentFindMatch(t))}if(this._cannotFind())return;let i=this._decorations.getFindScope(),n=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());let{lineNumber:o,column:r}=e,s=this._editor.getModel(),a=new Position$1(o,r),l=s.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,!1);return l&&l.range.isEmpty()&&l.range.getStartPosition().equals(a)&&(a=this._prevSearchPosition(a),l=s.findPreviousMatch(this._state.searchString,a,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,!1)),l?t||n.containsRange(l.range)?void this._setCurrentFindMatch(l.range):this._moveToPrevMatch(l.range.getStartPosition(),!0):void 0}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0),{lineNumber:i,column:n}=e,o=this._editor.getModel();return t||n===o.getLineMaxColumn(i)?(i===o.getLineCount()?i=1:i++,n=1):n++,new Position$1(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const t=this._decorations.matchBeforePosition(e);return void(t&&this._setCurrentFindMatch(t))}if(this._decorations.getCount()<MATCHES_LIMIT){let t=this._decorations.matchAfterPosition(e);return t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),void(t&&this._setCurrentFindMatch(t))}let t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;let o=this._decorations.getFindScope(),r=FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),o);r.getEndPosition().isBefore(e)&&(e=r.getStartPosition()),e.isBefore(r.getStartPosition())&&(e=r.getStartPosition());let{lineNumber:s,column:a}=e,l=this._editor.getModel(),d=new Position$1(s,a),c=l.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,t);return i&&c&&c.range.isEmpty()&&c.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),c=l.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,t)),c?n||r.containsRange(c.range)?c:this._getNextMatch(c.range.getEndPosition(),t,i,!0):null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?parseReplaceString(this._state.replaceString):ReplacePattern.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){let n=e.buildReplaceString(i.matches,this._state.preserveCase),o=new ReplaceCommand(t,n);this._executeEditorCommand("replace",o),this._decorations.setStartPosition(new Position$1(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map((e=>FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(),e)));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();null===e&&this._state.matchesCount>=MATCHES_LIMIT?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const e=new SearchParams(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(117):null).parseSearchRequest();if(!e)return;let t=e.regex;if(!t.multiline){let e="mu";t.ignoreCase&&(e+="i"),t.global&&(e+="g"),t=new RegExp(t.source,e)}const i=this._editor.getModel(),n=i.getValue(1),o=i.getFullModelRange(),r=this._getReplacePattern();let s;const a=this._state.preserveCase;s=r.hasReplacementPatterns||a?n.replace(t,(function(){return r.buildReplaceString(arguments,a)})):n.replace(t,r.buildReplaceString(null,a));let l=new ReplaceCommandThatPreservesSelection(o,s,this._editor.getSelection());this._executeEditorCommand("replaceAll",l)}_regularReplaceAll(e){const t=this._getReplacePattern();let i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let r=0,s=i.length;r<s;r++)n[r]=t.buildReplaceString(i[r].matches,this._state.preserveCase);let o=new ReplaceAllCommand(this._editor.getSelection(),i.map((e=>e.range)),n);this._executeEditorCommand("replaceAll",o)}selectAllMatches(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes(),t=this._findMatches(e,!1,1073741824).map((e=>new Selection$1(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))),i=this._editor.getSelection();for(let n=0,o=t.length;n<o;n++){if(t[n].equalsRange(i)){t=[i].concat(t.slice(0,n)).concat(t.slice(n+1));break}}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}class FindOptionsWidget extends Widget{constructor(e,t,i,n){super(),this._hideSoon=this._register(new RunOnceScheduler((()=>this._hide()),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const o=n.getColorTheme().getColor(inputActiveOptionBorder),r=n.getColorTheme().getColor(inputActiveOptionForeground),s=n.getColorTheme().getColor(inputActiveOptionBackground);this.caseSensitive=this._register(new CaseSensitiveCheckbox({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:s})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange((()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)}))),this.wholeWords=this._register(new WholeWordsCheckbox({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),isChecked:this._state.wholeWord,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:s})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange((()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)}))),this.regex=this._register(new RegexCheckbox({appendTitle:this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),isChecked:this._state.isRegex,inputActiveOptionBorder:o,inputActiveOptionForeground:r,inputActiveOptionBackground:s})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange((()=>{this._state.change({isRegex:this.regex.checked},!1)}))),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange((e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()}))),this._register(addDisposableNonBubblingMouseOutListener(this._domNode,(e=>this._onMouseOut()))),this._register(addDisposableListener(this._domNode,"mouseover",(e=>this._onMouseOver()))),this._applyTheme(n.getColorTheme()),this._register(n.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return FindOptionsWidget.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(inputActiveOptionBorder),inputActiveOptionForeground:e.getColor(inputActiveOptionForeground),inputActiveOptionBackground:e.getColor(inputActiveOptionBackground)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}}function effectiveOptionValue(e,t){return 1===e||2!==e&&t}FindOptionsWidget.ID="editor.contrib.findOptionsWidget",registerThemingParticipant(((e,t)=>{const i=e.getColor(editorWidgetBackground);i&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${i}; }`);const n=e.getColor(editorWidgetForeground);n&&t.addRule(`.monaco-editor .findOptionsWidget { color: ${n}; }`);const o=e.getColor(widgetShadow);o&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${o}; }`);const r=e.getColor(contrastBorder);r&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${r}; }`)}));class FindReplaceState extends Disposable{constructor(){super(),this._onFindReplaceStateChange=this._register(new Emitter$1),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return effectiveOptionValue(this._isRegexOverride,this._isRegex)}get wholeWord(){return effectiveOptionValue(this._wholeWordOverride,this._wholeWord)}get matchCase(){return effectiveOptionValue(this._matchCaseOverride,this._matchCase)}get preserveCase(){return effectiveOptionValue(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,i){let n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1},o=!1;0===t&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,o=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,o=!0),void 0!==i&&(Range$2.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,o=!0)),o&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){var n;let o={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1},r=!1;const s=this.isRegex,a=this.wholeWord,l=this.matchCase,d=this.preserveCase;void 0!==e.searchString&&this._searchString!==e.searchString&&(this._searchString=e.searchString,o.searchString=!0,r=!0),void 0!==e.replaceString&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,o.replaceString=!0,r=!0),void 0!==e.isRevealed&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,o.isRevealed=!0,r=!0),void 0!==e.isReplaceRevealed&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,o.isReplaceRevealed=!0,r=!0),void 0!==e.isRegex&&(this._isRegex=e.isRegex),void 0!==e.wholeWord&&(this._wholeWord=e.wholeWord),void 0!==e.matchCase&&(this._matchCase=e.matchCase),void 0!==e.preserveCase&&(this._preserveCase=e.preserveCase),void 0!==e.searchScope&&((null===(n=e.searchScope)||void 0===n?void 0:n.every((e=>{var t;return null===(t=this._searchScope)||void 0===t?void 0:t.some((t=>!Range$2.equalsRange(t,e)))})))||(this._searchScope=e.searchScope,o.searchScope=!0,r=!0)),void 0!==e.loop&&this._loop!==e.loop&&(this._loop=e.loop,o.loop=!0,r=!0),void 0!==e.isSearching&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,o.isSearching=!0,r=!0),void 0!==e.filters&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,o.filters=!0,r=!0),this._isRegexOverride=void 0!==e.isRegexOverride?e.isRegexOverride:0,this._wholeWordOverride=void 0!==e.wholeWordOverride?e.wholeWordOverride:0,this._matchCaseOverride=void 0!==e.matchCaseOverride?e.matchCaseOverride:0,this._preserveCaseOverride=void 0!==e.preserveCaseOverride?e.preserveCaseOverride:0,s!==this.isRegex&&(r=!0,o.isRegex=!0),a!==this.wholeWord&&(r=!0,o.wholeWord=!0),l!==this.matchCase&&(r=!0,o.matchCase=!0),d!==this.preserveCase&&(r=!0,o.preserveCase=!0),r&&this._onFindReplaceStateChange.fire(o)}canNavigateBack(){return this.canNavigateInLoop()||1!==this.matchesPosition}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=MATCHES_LIMIT}}var findWidget="";function showHistoryKeybindingHint(e){var t,i;return"Up"===(null===(t=e.lookupKeybinding("history.showPrevious"))||void 0===t?void 0:t.getElectronAccelerator())&&"Down"===(null===(i=e.lookupKeybinding("history.showNext"))||void 0===i?void 0:i.getElectronAccelerator())}var __awaiter$B=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const findSelectionIcon=registerIcon("find-selection",Codicon.selection,localize("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),findCollapsedIcon=registerIcon("find-collapsed",Codicon.chevronRight,localize("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),findExpandedIcon=registerIcon("find-expanded",Codicon.chevronDown,localize("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),findReplaceIcon=registerIcon("find-replace",Codicon.replace,localize("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),findReplaceAllIcon=registerIcon("find-replace-all",Codicon.replaceAll,localize("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),findPreviousMatchIcon=registerIcon("find-previous-match",Codicon.arrowUp,localize("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),findNextMatchIcon=registerIcon("find-next-match",Codicon.arrowDown,localize("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),NLS_FIND_INPUT_LABEL=localize("label.find","Find"),NLS_FIND_INPUT_PLACEHOLDER=localize("placeholder.find","Find"),NLS_PREVIOUS_MATCH_BTN_LABEL=localize("label.previousMatchButton","Previous Match"),NLS_NEXT_MATCH_BTN_LABEL=localize("label.nextMatchButton","Next Match"),NLS_TOGGLE_SELECTION_FIND_TITLE=localize("label.toggleSelectionFind","Find in Selection"),NLS_CLOSE_BTN_LABEL=localize("label.closeButton","Close"),NLS_REPLACE_INPUT_LABEL=localize("label.replace","Replace"),NLS_REPLACE_INPUT_PLACEHOLDER=localize("placeholder.replace","Replace"),NLS_REPLACE_BTN_LABEL=localize("label.replaceButton","Replace"),NLS_REPLACE_ALL_BTN_LABEL=localize("label.replaceAllButton","Replace All"),NLS_TOGGLE_REPLACE_MODE_BTN_LABEL=localize("label.toggleReplaceButton","Toggle Replace"),NLS_MATCHES_COUNT_LIMIT_TITLE=localize("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",MATCHES_LIMIT),NLS_MATCHES_LOCATION=localize("label.matchesLocation","{0} of {1}"),NLS_NO_RESULTS=localize("label.noResults","No results"),FIND_WIDGET_INITIAL_WIDTH=419,PART_WIDTH=275,FIND_INPUT_AREA_WIDTH=PART_WIDTH-54;let MAX_MATCHES_COUNT_WIDTH=69;const FIND_INPUT_AREA_HEIGHT=33,ctrlEnterReplaceAllWarningPromptedKey="ctrlEnterReplaceAll.windows.donotask",ctrlKeyMod=isMacintosh?256:2048;class FindWidgetViewZone{constructor(e){this.afterLineNumber=e,this.heightInPx=FIND_INPUT_AREA_HEIGHT,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function stopPropagationForMultiLineUpwards(e,t,i){const n=!!t.match(/\n/);i&&n&&i.selectionStart>0&&e.stopPropagation()}function stopPropagationForMultiLineDownwards(e,t,i){const n=!!t.match(/\n/);i&&n&&i.selectionEnd<i.value.length&&e.stopPropagation()}class FindWidget extends Widget{constructor(e,t,i,n,o,r,s,a,l){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=o,this._contextKeyService=r,this._storageService=a,this._notificationService=l,this._ctrlEnterReplaceAllWarningPrompted=!!a.getBoolean(ctrlEnterReplaceAllWarningPromptedKey,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new Delayer(500),this._register(toDisposable((()=>this._updateHistoryDelayer.cancel()))),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration((e=>{if(e.hasChanged(81)&&(this._codeEditor.getOption(81)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(131)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(35)){const e=this._codeEditor.getOption(35).addExtraSpaceOnTop;e&&!this._viewZone&&(this._viewZone=new FindWidgetViewZone(0),this._showViewZone()),!e&&this._viewZone&&this._removeViewZone()}}))),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection((()=>{this._isVisible&&this._updateToggleSelectionFindButton()}))),this._register(this._codeEditor.onDidFocusEditorWidget((()=>__awaiter$B(this,void 0,void 0,(function*(){if(this._isVisible){let e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))))),this._findInputFocused=CONTEXT_FIND_INPUT_FOCUSED.bindTo(r),this._findFocusTracker=this._register(trackFocus(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus((()=>{this._findInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._findFocusTracker.onDidBlur((()=>{this._findInputFocused.set(!1)}))),this._replaceInputFocused=CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(r),this._replaceFocusTracker=this._register(trackFocus(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus((()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()}))),this._register(this._replaceFocusTracker.onDidBlur((()=>{this._replaceInputFocused.set(!1)}))),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(35).addExtraSpaceOnTop&&(this._viewZone=new FindWidgetViewZone(0)),this._applyTheme(s.getColorTheme()),this._register(s.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel((()=>{this._isVisible&&(this._viewZoneId=void 0)}))),this._register(this._codeEditor.onDidScrollChange((e=>{e.scrollTopChanged?this._layoutViewZone():setTimeout((()=>{this._layoutViewZone()}),0)})))}getId(){return FindWidget.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?this._codeEditor.getOption(81)||this._isReplaceVisible||(this._isReplaceVisible=!0,this._replaceInput.width=getTotalWidth(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let e=this._state.searchString.length>0&&0===this._state.matchesCount;this._domNode.classList.toggle("no-results",e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,onUnexpectedError)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){let e;if(this._matchesCount.style.minWidth=MAX_MATCHES_COUNT_WIDTH+"px",this._state.matchesCount>=MATCHES_LIMIT?this._matchesCount.title=NLS_MATCHES_COUNT_LIMIT_TITLE:this._matchesCount.title="",this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild),this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=MATCHES_LIMIT&&(t+="+");let i=String(this._state.matchesPosition);"0"===i&&(i="?"),e=format(NLS_MATCHES_LOCATION,i,t)}else e=NLS_NO_RESULTS;this._matchesCount.appendChild(document.createTextNode(e)),alert(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),MAX_MATCHES_COUNT_WIDTH=Math.max(MAX_MATCHES_COUNT_WIDTH,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===NLS_NO_RESULTS)return""===i?localize("ariaSearchNoResultEmpty","{0} found",e):localize("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=localize("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),o=this._codeEditor.getModel();if(o&&t.startLineNumber<=o.getLineCount()&&t.startLineNumber>=1){return`${o.getLineContent(t.startLineNumber)}, ${n}`}return n}return localize("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=!!e&&(e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn),i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let i=!this._codeEditor.getOption(81);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(35).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout((()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")}),0)),this._revealTimeouts.push(setTimeout((()=>{this._findInput.validate()}),200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(35).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=getDomNodePagePosition(i),o=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),r=n.left+(o?o.left:0),s=o?o.top:0;if(this._viewZone&&s<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const i=getTopLeftOffset(this._domNode).left;r>i&&(t=!1);const o=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());n.left+(o?o.left:0)>i&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach((e=>{clearTimeout(e)})),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(35).addExtraSpaceOnTop)return void this._removeViewZone();if(!this._isVisible)return;const t=this._viewZone;void 0===this._viewZoneId&&t&&this._codeEditor.changeViewZones((i=>{t.heightInPx=this._getHeight(),this._viewZoneId=i.addZone(t),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+t.heightInPx)}))}_showViewZone(e=!0){if(!this._isVisible)return;if(!this._codeEditor.getOption(35).addExtraSpaceOnTop)return;void 0===this._viewZone&&(this._viewZone=new FindWidgetViewZone(0));const t=this._viewZone;this._codeEditor.changeViewZones((i=>{if(void 0!==this._viewZoneId){const n=this._getHeight();if(n===t.heightInPx)return;let o=n-t.heightInPx;return t.heightInPx=n,i.layoutZone(this._viewZoneId),void(e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+o))}{let n=this._getHeight();if(n-=this._codeEditor.getOption(75).top,n<=0)return;t.heightInPx=n,this._viewZoneId=i.addZone(t),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+n)}}))}_removeViewZone(){this._codeEditor.changeViewZones((e=>{void 0!==this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))}))}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(inputActiveOptionBorder),inputActiveOptionBackground:e.getColor(inputActiveOptionBackground),inputActiveOptionForeground:e.getColor(inputActiveOptionForeground),inputBackground:e.getColor(inputBackground),inputForeground:e.getColor(inputForeground),inputBorder:e.getColor(inputBorder),inputValidationInfoBackground:e.getColor(inputValidationInfoBackground),inputValidationInfoForeground:e.getColor(inputValidationInfoForeground),inputValidationInfoBorder:e.getColor(inputValidationInfoBorder),inputValidationWarningBackground:e.getColor(inputValidationWarningBackground),inputValidationWarningForeground:e.getColor(inputValidationWarningForeground),inputValidationWarningBorder:e.getColor(inputValidationWarningBorder),inputValidationErrorBackground:e.getColor(inputValidationErrorBackground),inputValidationErrorForeground:e.getColor(inputValidationErrorForeground),inputValidationErrorBorder:e.getColor(inputValidationErrorBorder)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible)return;if(!isInDOM(this._domNode))return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0)return void this._domNode.classList.add("hiddenEditor");this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const t=e.width,i=e.minimap.minimapWidth;let n=!1,o=!1,r=!1;if(this._resized){if(getTotalWidth(this._domNode)>FIND_WIDGET_INITIAL_WIDTH)return this._domNode.style.maxWidth=t-28-i-15+"px",void(this._replaceInput.width=getTotalWidth(this._findInput.domNode))}if(FIND_WIDGET_INITIAL_WIDTH+28+i>=t&&(o=!0),FIND_WIDGET_INITIAL_WIDTH+28+i-MAX_MATCHES_COUNT_WIDTH>=t&&(r=!0),FIND_WIDGET_INITIAL_WIDTH+28+i-MAX_MATCHES_COUNT_WIDTH>=t+50&&(n=!0),this._domNode.classList.toggle("collapsed-find-widget",n),this._domNode.classList.toggle("narrow-find-widget",r),this._domNode.classList.toggle("reduced-find-widget",o),r||n||(this._domNode.style.maxWidth=t-28-i-15+"px"),this._resized){this._findInput.inputBox.layout();let e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return(null===this._cachedHeight||this._cachedHeight!==e)&&(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let e=this._codeEditor.getSelections();e.map((e=>{1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));const t=this._state.currentMatch;return e.startLineNumber===e.endLineNumber||Range$2.equalsRange(e,t)?null:e})).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){return e.equals(3|ctrlKeyMod)?(this._keybindingService.dispatchEvent(e,e.target)||this._findInput.inputBox.insertAtCursor("\n"),void e.preventDefault()):e.equals(2)?(this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?stopPropagationForMultiLineUpwards(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):e.equals(18)?stopPropagationForMultiLineDownwards(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea")):void 0}_onReplaceInputKeyDown(e){return e.equals(3|ctrlKeyMod)?(this._keybindingService.dispatchEvent(e,e.target)||(isWindows&&isNative&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(localize("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey,!0,0,0)),this._replaceInput.inputBox.insertAtCursor("\n")),void e.preventDefault()):e.equals(2)?(this._findInput.focusOnCaseSensitive(),void e.preventDefault()):e.equals(1026)?(this._findInput.focus(),void e.preventDefault()):e.equals(2066)?(this._codeEditor.focus(),void e.preventDefault()):e.equals(16)?stopPropagationForMultiLineUpwards(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):e.equals(18)?stopPropagationForMultiLineDownwards(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea")):void 0}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new ContextScopedFindInput(null,this._contextViewProvider,{width:FIND_INPUT_AREA_WIDTH,label:NLS_FIND_INPUT_LABEL,placeholder:NLS_FIND_INPUT_PLACEHOLDER,appendCaseSensitiveLabel:this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),validation:e=>{if(0===e.length||!this._findInput.getRegex())return null;try{return new RegExp(e,"gu"),null}catch(e2){return{content:e2.message}}},flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>showHistoryKeybindingHint(this._keybindingService)},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown((e=>this._onFindInputKeyDown(e)))),this._register(this._findInput.inputBox.onDidChange((()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)}))),this._register(this._findInput.onDidOptionChange((()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)}))),this._register(this._findInput.onCaseSensitiveKeyDown((e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())}))),this._register(this._findInput.onRegexKeyDown((e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())}))),this._register(this._findInput.inputBox.onDidHeightChange((e=>{this._tryUpdateHeight()&&this._showViewZone()}))),isLinux&&this._register(this._findInput.onMouseDown((e=>this._onFindInputMouseDown(e)))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount(),this._prevBtn=this._register(new SimpleButton({label:NLS_PREVIOUS_MATCH_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),icon:findPreviousMatchIcon,onTrigger:()=>{this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(void 0,onUnexpectedError)}})),this._nextBtn=this._register(new SimpleButton({label:NLS_NEXT_MATCH_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),icon:findNextMatchIcon,onTrigger:()=>{this._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(void 0,onUnexpectedError)}}));let e=document.createElement("div");e.className="find-part",e.appendChild(this._findInput.domNode);const t=document.createElement("div");t.className="find-actions",e.appendChild(t),t.appendChild(this._matchesCount),t.appendChild(this._prevBtn.domNode),t.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new Checkbox({icon:findSelectionIcon,title:NLS_TOGGLE_SELECTION_FIND_TITLE+this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),isChecked:!1})),this._register(this._toggleSelectionFind.onChange((()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let e=this._codeEditor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)}))),t.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new SimpleButton({label:NLS_CLOSE_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),icon:widgetClose,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),t.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new ContextScopedReplaceInput(null,void 0,{label:NLS_REPLACE_INPUT_LABEL,placeholder:NLS_REPLACE_INPUT_PLACEHOLDER,appendPreserveCaseLabel:this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),history:[],flexibleHeight:true,flexibleWidth:true,flexibleMaxHeight:118,showHistoryHint:()=>showHistoryKeybindingHint(this._keybindingService)},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown((e=>this._onReplaceInputKeyDown(e)))),this._register(this._replaceInput.inputBox.onDidChange((()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)}))),this._register(this._replaceInput.inputBox.onDidHeightChange((e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()}))),this._register(this._replaceInput.onDidOptionChange((()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)}))),this._register(this._replaceInput.onPreserveCaseKeyDown((e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())}))),this._replaceBtn=this._register(new SimpleButton({label:NLS_REPLACE_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),icon:findReplaceIcon,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new SimpleButton({label:NLS_REPLACE_ALL_BTN_LABEL+this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),icon:findReplaceAllIcon,onTrigger:()=>{this._controller.replaceAll()}}));let i=document.createElement("div");i.className="replace-part",i.appendChild(this._replaceInput.domNode);const n=document.createElement("div");n.className="replace-actions",i.appendChild(n),n.appendChild(this._replaceBtn.domNode),n.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new SimpleButton({label:NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.style.width=`${FIND_WIDGET_INITIAL_WIDTH}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(i),this._resizeSash=new Sash(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let o=FIND_WIDGET_INITIAL_WIDTH;this._register(this._resizeSash.onDidStart((()=>{o=getTotalWidth(this._domNode)}))),this._register(this._resizeSash.onDidChange((e=>{this._resized=!0;let t=o+e.startX-e.currentX;if(t<FIND_WIDGET_INITIAL_WIDTH)return;t>(parseFloat(getComputedStyle$1(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())}))),this._register(this._resizeSash.onDidReset((()=>{const e=getTotalWidth(this._domNode);if(e<FIND_WIDGET_INITIAL_WIDTH)return;let t=FIND_WIDGET_INITIAL_WIDTH;if(!this._resized||e===FIND_WIDGET_INITIAL_WIDTH){const e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=getTotalWidth(this._findInput.domNode)),this._findInput.inputBox.layout()})))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(2!==e)}}FindWidget.ID="editor.contrib.findWidget";class SimpleButton extends Widget{constructor(e){super(),this._opts=e;let t="button";this._opts.className&&(t=t+" "+this._opts.className),this._opts.icon&&(t=t+" "+ThemeIcon.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this.onclick(this._domNode,(e=>{this._opts.onTrigger(),e.preventDefault()})),this.onkeydown(this._domNode,(e=>{if(e.equals(10)||e.equals(3))return this._opts.onTrigger(),void e.preventDefault();this._opts.onKeyDown&&this._opts.onKeyDown(e)}))}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon))):(this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon)),this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon)))}}registerThemingParticipant(((e,t)=>{const i=(e,i)=>{i&&t.addRule(`.monaco-editor ${e} { background-color: ${i}; }`)};i(".findMatch",e.getColor(editorFindMatchHighlight)),i(".currentFindMatch",e.getColor(editorFindMatch)),i(".findScope",e.getColor(editorFindRangeHighlight));i(".find-widget",e.getColor(editorWidgetBackground));const n=e.getColor(widgetShadow);n&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${n}; }`);const o=e.getColor(editorFindMatchHighlightBorder);o&&t.addRule(`.monaco-editor .findMatch { border: 1px ${"hc"===e.type?"dotted":"solid"} ${o}; box-sizing: border-box; }`);const r=e.getColor(editorFindMatchBorder);r&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${r}; padding: 1px; box-sizing: border-box; }`);const s=e.getColor(editorFindRangeHighlightBorder);s&&t.addRule(`.monaco-editor .findScope { border: 1px ${"hc"===e.type?"dashed":"solid"} ${s}; }`);const a=e.getColor(contrastBorder);a&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${a}; }`);const l=e.getColor(editorWidgetForeground);l&&t.addRule(`.monaco-editor .find-widget { color: ${l}; }`);const d=e.getColor(errorForeground);d&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${d}; }`);const c=e.getColor(editorWidgetResizeBorder);if(c)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${c}; }`);else{const i=e.getColor(editorWidgetBorder);i&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${i}; }`)}const h=e.getColor(toolbarHoverBackground);h&&t.addRule(`\n\t\t.monaco-editor .find-widget .button:not(.disabled):hover,\n\t\t.monaco-editor .find-widget .codicon-find-selection:hover {\n\t\t\tbackground-color: ${h} !important;\n\t\t}\n\t`);const u=e.getColor(focusBorder);u&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${u}; }`)}));var __decorate$W=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$V=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$A=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const SEARCH_STRING_MAX_LENGTH=524288;function getSelectionSearchString(e,t="single",i=!1){if(!e.hasModel())return null;const n=e.getSelection();if("single"===t&&n.startLineNumber===n.endLineNumber||"multiple"===t)if(n.isEmpty()){const t=e.getConfiguredWordAtPosition(n.getStartPosition());if(t&&!1===i)return t.word}else if(e.getModel().getValueLengthInRange(n)<SEARCH_STRING_MAX_LENGTH)return e.getModel().getValueInRange(n);return null}let CommonFindController=class e extends Disposable{constructor(e,t,i,n){super(),this._editor=e,this._findWidgetVisible=CONTEXT_FIND_WIDGET_VISIBLE.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=n,this._updateHistoryDelayer=new Delayer(500),this._state=this._register(new FindReplaceState),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange((e=>this._onStateChanged(e)))),this._model=null,this._register(this._editor.onDidChangeModel((()=>{let e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(35).loop})})))}get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e.map((e=>(1===e.endColumn&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e))).filter((e=>!!e)),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=escapeRegExpCharacters(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e,t){return __awaiter$A(this,void 0,void 0,(function*(){if(this.disposeModel(),!this._editor.hasModel())return;let i=Object.assign(Object.assign({},t),{isRevealed:!0});if("single"===e.seedSearchStringFromSelection){let t=getSelectionSearchString(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);t&&(this._state.isRegex?i.searchString=escapeRegExpCharacters(t):i.searchString=t)}else if("multiple"===e.seedSearchStringFromSelection&&!e.updateSearchScope){let t=getSelectionSearchString(this._editor,e.seedSearchStringFromSelection);t&&(i.searchString=t)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){let e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(i.searchString=e)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){let e=this._editor.getSelections();e.some((e=>!e.isEmpty()))&&(i.searchScope=e)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new FindModelBoundToEditorModel(this._editor,this._state))}))}start(e,t){return this._start(e,t)}moveToNextMatch(){return!!this._model&&(this._model.moveToNextMatch(),!0)}moveToPrevMatch(){return!!this._model&&(this._model.moveToPrevMatch(),!0)}replace(){return!!this._model&&(this._model.replace(),!0)}replaceAll(){return!!this._model&&(this._model.replaceAll(),!0)}selectAllMatches(){return!!this._model&&(this._model.selectAllMatches(),this._editor.focus(),!0)}getGlobalBufferTerm(){return __awaiter$A(this,void 0,void 0,(function*(){return this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}))}setGlobalBufferTerm(e){this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};CommonFindController.ID="editor.contrib.findController",CommonFindController=__decorate$W([__param$V(1,IContextKeyService),__param$V(2,IStorageService),__param$V(3,IClipboardService)],CommonFindController);let FindController=class extends CommonFindController{constructor(e,t,i,n,o,r,s,a){super(e,i,s,a),this._contextViewService=t,this._keybindingService=n,this._themeService=o,this._notificationService=r,this._widget=null,this._findOptionsWidget=null}_start(e,t){const i=Object.create(null,{_start:{get:()=>super._start}});return __awaiter$A(this,void 0,void 0,(function*(){this._widget||this._createFindWidget();const n=this._editor.getSelection();let o=!1;switch(this._editor.getOption(35).autoFindInSelection){case"always":o=!0;break;case"never":o=!1;break;case"multiline":o=!!n&&n.startLineNumber!==n.endLineNumber;break}e.updateSearchScope=e.updateSearchScope||o,yield i._start.call(this,e,t),this._widget&&(2===e.shouldFocus?this._widget.focusReplaceInput():1===e.shouldFocus&&this._widget.focusFindInput())}))}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new FindWidget(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new FindOptionsWidget(this._editor,this._state,this._keybindingService,this._themeService))}};FindController=__decorate$W([__param$V(1,IContextViewService),__param$V(2,IContextKeyService),__param$V(3,IKeybindingService),__param$V(4,IThemeService),__param$V(5,INotificationService),__param$V(6,IStorageService),__param$V(7,IClipboardService)],FindController);const StartFindAction=registerMultiEditorAction(new MultiEditorAction({id:FIND_IDS.StartFindAction,label:localize("startFindAction","Find"),alias:"Find",precondition:ContextKeyExpr.or(EditorContextKeys.focus,ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"3_find",title:localize({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));StartFindAction.addImplementation(0,((e,t,i)=>{const n=CommonFindController.get(t);return!!n&&n.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:t.getOption(35).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop})}));const findArgDescription={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},regex:{type:"boolean"},regexOverride:{type:"number",description:localize("actions.find.isRegexOverride",'Overrides "Use Regular Expression" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},wholeWord:{type:"boolean"},wholeWordOverride:{type:"number",description:localize("actions.find.wholeWordOverride",'Overrides "Match Whole Word" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},matchCase:{type:"boolean"},matchCaseOverride:{type:"number",description:localize("actions.find.matchCaseOverride",'Overrides "Math Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},preserveCase:{type:"boolean"},preserveCaseOverride:{type:"number",description:localize("actions.find.preserveCaseOverride",'Overrides "Preserve Case" flag.\nThe flag will not be saved for the future.\n0: Do Nothing\n1: True\n2: False')},findInSelection:{type:"boolean"}}}}]};class StartFindWithArgsAction extends EditorAction{constructor(){super({id:FIND_IDS.StartFindWithArgs,label:localize("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},description:findArgDescription})}run(e,t,i){return __awaiter$A(this,void 0,void 0,(function*(){const e=CommonFindController.get(t);if(e){const n=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:void 0!==i.replaceString,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:(null==i?void 0:i.findInSelection)||!1,loop:t.getOption(35).loop},n),e.setGlobalBufferTerm(e.getState().searchString)}}))}}class StartFindWithSelectionAction extends EditorAction{constructor(){super({id:FIND_IDS.StartFindWithSelection,label:localize("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return __awaiter$A(this,void 0,void 0,(function*(){const e=CommonFindController.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),e.setGlobalBufferTerm(e.getState().searchString))}))}}class MatchFindAction extends EditorAction{run(e,t){return __awaiter$A(this,void 0,void 0,(function*(){const e=CommonFindController.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:0===e.getState().searchString.length&&"never"!==t.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(e))}))}}class NextMatchFindAction extends MatchFindAction{constructor(){super({id:FIND_IDS.NextMatchFindAction,label:localize("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:EditorContextKeys.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_FIND_INPUT_FOCUSED),primary:3,weight:100}]})}_run(e){return!!e.moveToNextMatch()&&(e.editor.pushUndoStop(),!0)}}class PreviousMatchFindAction extends MatchFindAction{constructor(){super({id:FIND_IDS.PreviousMatchFindAction,label:localize("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:EditorContextKeys.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_FIND_INPUT_FOCUSED),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class SelectionMatchFindAction extends EditorAction{run(e,t){return __awaiter$A(this,void 0,void 0,(function*(){const e=CommonFindController.get(t);if(!e)return;const i="selection"===t.getOption(35).seedSearchStringFromSelection;let n=null;"never"!==t.getOption(35).seedSearchStringFromSelection&&(n=getSelectionSearchString(t,"single",i)),n&&e.setSearchString(n),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:"never"!==t.getOption(35).seedSearchStringFromSelection?"single":"none",seedSearchStringFromNonEmptySelection:i,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(e))}))}}class NextSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:FIND_IDS.NextSelectionMatchFindAction,label:localize("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class PreviousSelectionMatchFindAction extends SelectionMatchFindAction{constructor(){super({id:FIND_IDS.PreviousSelectionMatchFindAction,label:localize("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const StartFindReplaceAction=registerMultiEditorAction(new MultiEditorAction({id:FIND_IDS.StartFindReplaceAction,label:localize("startReplace","Replace"),alias:"Replace",precondition:ContextKeyExpr.or(EditorContextKeys.focus,ContextKeyExpr.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:MenuId.MenubarEditMenu,group:"3_find",title:localize({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));StartFindReplaceAction.addImplementation(0,((e,t,i)=>{if(!t.hasModel()||t.getOption(81))return!1;const n=CommonFindController.get(t);if(!n)return!1;const o=t.getSelection(),r=n.isFindInputFocused(),s=!o.isEmpty()&&o.startLineNumber===o.endLineNumber&&"never"!==t.getOption(35).seedSearchStringFromSelection&&!r,a=r||s?2:1;return n.start({forceRevealReplace:!0,seedSearchStringFromSelection:s?"single":"none",seedSearchStringFromNonEmptySelection:"selection"===t.getOption(35).seedSearchStringFromSelection,seedSearchStringFromGlobalClipboard:"never"!==t.getOption(35).seedSearchStringFromSelection,shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop})})),registerEditorContribution(CommonFindController.ID,FindController),registerEditorAction(StartFindWithArgsAction),registerEditorAction(StartFindWithSelectionAction),registerEditorAction(NextMatchFindAction),registerEditorAction(PreviousMatchFindAction),registerEditorAction(NextSelectionMatchFindAction),registerEditorAction(PreviousSelectionMatchFindAction);const FindCommand=EditorCommand.bindToContribution(CommonFindController.get);registerEditorCommand(new FindCommand({id:FIND_IDS.CloseFindWidgetCommand,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,ContextKeyExpr.not("isComposing")),primary:9,secondary:[1033]}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleCaseSensitiveCommand,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:ToggleCaseSensitiveKeybinding.primary,mac:ToggleCaseSensitiveKeybinding.mac,win:ToggleCaseSensitiveKeybinding.win,linux:ToggleCaseSensitiveKeybinding.linux}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleWholeWordCommand,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:ToggleWholeWordKeybinding.primary,mac:ToggleWholeWordKeybinding.mac,win:ToggleWholeWordKeybinding.win,linux:ToggleWholeWordKeybinding.linux}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleRegexCommand,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:ToggleRegexKeybinding.primary,mac:ToggleRegexKeybinding.mac,win:ToggleRegexKeybinding.win,linux:ToggleRegexKeybinding.linux}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ToggleSearchScopeCommand,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:ToggleSearchScopeKeybinding.primary,mac:ToggleSearchScopeKeybinding.mac,win:ToggleSearchScopeKeybinding.win,linux:ToggleSearchScopeKeybinding.linux}})),registerEditorCommand(new FindCommand({id:FIND_IDS.TogglePreserveCaseCommand,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:TogglePreserveCaseKeybinding.primary,mac:TogglePreserveCaseKeybinding.mac,win:TogglePreserveCaseKeybinding.win,linux:TogglePreserveCaseKeybinding.linux}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceOneAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:3094}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceOneAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_REPLACE_INPUT_FOCUSED),primary:3}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceAllAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:2563}})),registerEditorCommand(new FindCommand({id:FIND_IDS.ReplaceAllAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:ContextKeyExpr.and(EditorContextKeys.focus,CONTEXT_REPLACE_INPUT_FOCUSED),primary:void 0,mac:{primary:2051}}})),registerEditorCommand(new FindCommand({id:FIND_IDS.SelectAllMatchesAction,precondition:CONTEXT_FIND_WIDGET_VISIBLE,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:EditorContextKeys.focus,primary:515}}));var folding="";const MAX_FOLDING_REGIONS=65535,MAX_LINE_NUMBER=16777215,MASK_INDENT=4278190080;class FoldingRegions{constructor(e,t,i){if(e.length!==t.length||e.length>MAX_FOLDING_REGIONS)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new Uint32Array(Math.ceil(e.length/32)),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(t,i)=>{let n=e[e.length-1];return this.getStartLineNumber(n)<=t&&this.getEndLineNumber(n)>=i};for(let i=0,n=this._startIndexes.length;i<n;i++){let n=this._startIndexes[i],o=this._endIndexes[i];if(n>MAX_LINE_NUMBER||o>MAX_LINE_NUMBER)throw new Error("startLineNumber or endLineNumber must not exceed "+MAX_LINE_NUMBER);for(;e.length>0&&!t(n,o);)e.pop();let r=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=n+((255&r)<<24),this._endIndexes[i]=o+((65280&r)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&MAX_LINE_NUMBER}getEndLineNumber(e){return this._endIndexes[e]&MAX_LINE_NUMBER}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){let t=e/32|0,i=e%32;return 0!=(this._collapseStates[t]&1<<i)}setCollapsed(e,t){let i=e/32|0,n=e%32,o=this._collapseStates[i];this._collapseStates[i]=t?o|1<<n:o&~(1<<n)}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new FoldingRegion(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&MASK_INDENT)>>>24)+((this._endIndexes[e]&MASK_INDENT)>>>16);return t===MAX_FOLDING_REGIONS?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(0===i)return-1;for(;t<i;){let n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);-1!==t;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}}class FoldingRegion{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class FoldingModel{constructor(e,t){this._updateEventEmitter=new Emitter$1,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new FoldingRegions(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(e){if(!e.length)return;e=e.sort(((e,t)=>e.regionIndex-t.regionIndex));const t={};this._decorationProvider.changeDecorations((i=>{let n=0,o=-1,r=-1;const s=e=>{for(;n<e;){const e=this._regions.getEndLineNumber(n),t=this._regions.isCollapsed(n);e<=o&&i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(t,e<=r)),t&&e>r&&(r=e),n++}};for(let a of e){let e=a.regionIndex,i=this._editorDecorationIds[e];if(i&&!t[i]){t[i]=!0,s(e);let n=!this._regions.isCollapsed(e);this._regions.setCollapsed(e,n),o=Math.max(o,this._regions.getEndLineNumber(e))}}s(this._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}update(e,t=[]){let i=[],n=-1,o=(o,r)=>{const s=e.getStartLineNumber(o),a=e.getEndLineNumber(o);r||(r=e.isCollapsed(o)),r&&((e,i)=>{for(let n of t)if(e<n&&n<=i)return!0;return!1})(s,a)&&(r=!1),e.setCollapsed(o,r);const l=this._textModel.getLineMaxColumn(s),d={startLineNumber:s,startColumn:Math.max(l-1,1),endLineNumber:s,endColumn:l};i.push({range:d,options:this._decorationProvider.getDecorationOption(r,a<=n)}),r&&a>n&&(n=a)},r=0,s=()=>{for(;r<this._regions.length;){let e=this._regions.isCollapsed(r);if(r++,e)return r-1}return-1},a=0,l=s();for(;-1!==l&&a<e.length;){let t=this._textModel.getDecorationRange(this._editorDecorationIds[l]);if(t){let i=t.startLineNumber;if(t.startColumn===Math.max(t.endColumn-1,1)&&this._textModel.getLineMaxColumn(i)===t.endColumn)for(;a<e.length;){let t=e.getStartLineNumber(a);if(!(i>=t))break;o(a,i===t),a++}}l=s()}for(;a<e.length;)o(a,!1),a++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,i),this._regions=e,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let e=[];for(let t=0;t<this._regions.length;t++)if(this._regions.isCollapsed(t)){let i=this._textModel.getDecorationRange(this._editorDecorationIds[t]);if(i){let n=i.startLineNumber,o=i.endLineNumber+this._regions.getEndLineNumber(t)-this._regions.getStartLineNumber(t);e.push({startLineNumber:n,endLineNumber:o})}}if(e.length>0)return e}applyMemento(e){if(!Array.isArray(e))return;let t=[];for(let i of e){let e=this.getRegionAtLine(i.startLineNumber);e&&!e.isCollapsed&&t.push(e)}this.toggleCollapseState(t)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(e,t){let i=[];if(this._regions){let n=this._regions.findRange(e),o=1;for(;n>=0;){let e=this._regions.toRegion(n);t&&!t(e,o)||i.push(e),o++,n=e.parentIndex}}return i}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let i=[],n=e?e.regionIndex+1:0,o=e?e.endLineNumber:Number.MAX_VALUE;if(t&&2===t.length){const e=[];for(let r=n,s=this._regions.length;r<s;r++){let n=this._regions.toRegion(r);if(!(this._regions.getStartLineNumber(r)<o))break;for(;e.length>0&&!n.containedBy(e[e.length-1]);)e.pop();e.push(n),t(n,e.length)&&i.push(n)}}else for(let r=n,s=this._regions.length;r<s;r++){let e=this._regions.toRegion(r);if(!(this._regions.getStartLineNumber(r)<o))break;t&&!t(e)||i.push(e)}return i}}function toggleCollapseState(e,t,i){let n=[];for(let o of i){let i=e.getRegionAtLine(o);if(i){const o=!i.isCollapsed;if(n.push(i),t>1){let r=e.getRegionsInside(i,((e,i)=>e.isCollapsed!==o&&i<t));n.push(...r)}}}e.toggleCollapseState(n)}function setCollapseStateLevelsDown(e,t,i=Number.MAX_VALUE,n){let o=[];if(n&&n.length>0)for(let r of n){let n=e.getRegionAtLine(r);if(n&&(n.isCollapsed!==t&&o.push(n),i>1)){let r=e.getRegionsInside(n,((e,n)=>e.isCollapsed!==t&&n<i));o.push(...r)}}else{let n=e.getRegionsInside(null,((e,n)=>e.isCollapsed!==t&&n<i));o.push(...n)}e.toggleCollapseState(o)}function setCollapseStateLevelsUp(e,t,i,n){let o=[];for(let r of n){let n=e.getAllRegionsAtLine(r,((e,n)=>e.isCollapsed!==t&&n<=i));o.push(...n)}e.toggleCollapseState(o)}function setCollapseStateUp(e,t,i){let n=[];for(let o of i){let i=e.getAllRegionsAtLine(o,(e=>e.isCollapsed!==t));i.length>0&&n.push(i[0])}e.toggleCollapseState(n)}function setCollapseStateAtLevel(e,t,i,n){let o=e.getRegionsInside(null,((e,o)=>o===t&&e.isCollapsed!==i&&!n.some((t=>e.containsLine(t)))));e.toggleCollapseState(o)}function setCollapseStateForRest(e,t,i){let n=[];for(let r of i){const t=e.getAllRegionsAtLine(r,void 0);t.length>0&&n.push(t[0])}let o=e.getRegionsInside(null,(e=>n.every((t=>!t.containedBy(e)&&!e.containedBy(t)))&&e.isCollapsed!==t));e.toggleCollapseState(o)}function setCollapseStateForMatchingLines(e,t,i){let n=e.textModel,o=e.regions,r=[];for(let s=o.length-1;s>=0;s--)if(i!==o.isCollapsed(s)){let e=o.getStartLineNumber(s);t.test(n.getLineContent(e))&&r.push(o.toRegion(s))}e.toggleCollapseState(r)}function setCollapseStateForType(e,t,i){let n=e.regions,o=[];for(let r=n.length-1;r>=0;r--)i!==n.isCollapsed(r)&&t===n.getType(r)&&o.push(n.toRegion(r));e.toggleCollapseState(o)}function getParentFoldLine(e,t){let i=null,n=t.getRegionAtLine(e);if(null!==n&&(i=n.startLineNumber,e===i)){let e=n.parentIndex;i=-1!==e?t.regions.getStartLineNumber(e):null}return i}function getPreviousFoldLine(e,t){let i=t.getRegionAtLine(e);if(null!==i&&i.startLineNumber===e){if(e!==i.startLineNumber)return i.startLineNumber;{let e=i.parentIndex,n=0;for(-1!==e&&(n=t.regions.getStartLineNumber(i.parentIndex));null!==i;){if(!(i.regionIndex>0))return null;if(i=t.regions.toRegion(i.regionIndex-1),i.startLineNumber<=n)return null;if(i.parentIndex===e)return i.startLineNumber}}}else if(t.regions.length>0)for(i=t.regions.toRegion(t.regions.length-1);null!==i;){if(i.startLineNumber<e)return i.startLineNumber;i=i.regionIndex>0?t.regions.toRegion(i.regionIndex-1):null}return null}function getNextFoldLine(e,t){let i=t.getRegionAtLine(e);if(null!==i&&i.startLineNumber===e){let e=i.parentIndex,n=0;if(-1!==e)n=t.regions.getEndLineNumber(i.parentIndex);else{if(0===t.regions.length)return null;n=t.regions.getEndLineNumber(t.regions.length-1)}for(;null!==i;){if(!(i.regionIndex<t.regions.length))return null;if(i=t.regions.toRegion(i.regionIndex+1),i.startLineNumber>=n)return null;if(i.parentIndex===e)return i.startLineNumber}}else if(t.regions.length>0)for(i=t.regions.toRegion(0);null!==i;){if(i.startLineNumber>e)return i.startLineNumber;i=i.regionIndex<t.regions.length?t.regions.toRegion(i.regionIndex+1):null}return null}class HiddenRangeModel{constructor(e){this._updateEventEmitter=new Emitter$1,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange((e=>this.updateHiddenRanges())),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some((e=>e.range.endLineNumber!==e.range.startLineNumber||0!==countEOL(e.text)[0])))}updateHiddenRanges(){let e=!1,t=[],i=0,n=0,o=Number.MAX_VALUE,r=-1,s=this._foldingModel.regions;for(;i<s.length;i++){if(!s.isCollapsed(i))continue;let a=s.getStartLineNumber(i)+1,l=s.getEndLineNumber(i);o<=a&&l<=r||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===a&&this._hiddenRanges[n].endLineNumber===l?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new Range$2(a,1,l,1))),o=a,r=l)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyMemento(e){if(!Array.isArray(e)||0===e.length)return!1;let t=[];for(let i of e){if(!i.startLineNumber||!i.endLineNumber)return!1;t.push(new Range$2(i.startLineNumber+1,1,i.endLineNumber,1))}return this.applyHiddenRanges(t),!0}getMemento(){return this._hiddenRanges.map((e=>({startLineNumber:e.startLineNumber-1,endLineNumber:e.endLineNumber})))}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return null!==findRange(this._hiddenRanges,e)}adjustSelections(e){let t=!1,i=this._foldingModel.textModel,n=null,o=e=>(n&&isInside(e,n)||(n=findRange(this._hiddenRanges,e)),n?n.startLineNumber-1:null);for(let r=0,s=e.length;r<s;r++){let n=e[r],s=o(n.startLineNumber);s&&(n=n.setStartPosition(s,i.getLineMaxColumn(s)),t=!0);let a=o(n.endLineNumber);a&&(n=n.setEndPosition(a,i.getLineMaxColumn(a)),t=!0),e[r]=n}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function isInside(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}function findRange(e,t){let i=findFirstInSorted(e,(e=>t<e.startLineNumber))-1;return i>=0&&e[i].endLineNumber>=t?e[i]:null}const MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT=5e3,ID_INDENT_PROVIDER="indent";class IndentRangeProvider{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.maxFoldingRegions=i,this.id=ID_INDENT_PROVIDER}dispose(){}compute(e,t){let i=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,n=i&&!!i.offSide,o=i&&i.markers;return Promise.resolve(computeRanges(this.editorModel,n,o,this.maxFoldingRegions,t))}}class RangesCollector$1{constructor(e,t){this._notifyTooManyRegions=t,this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>MAX_LINE_NUMBER||t>MAX_LINE_NUMBER)return;let n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=this._length-1,n=0;i>=0;i--,n++)e[n]=this._startIndexes[i],t[n]=this._endIndexes[i];return new FoldingRegions(e,t)}{this._notifyTooManyRegions&&this._notifyTooManyRegions(this._foldingRangesLimit);let t=0,i=this._indentOccurrences.length;for(let e=0;e<this._indentOccurrences.length;e++){let n=this._indentOccurrences[e];if(n){if(n+t>this._foldingRangesLimit){i=e;break}t+=n}}const n=e.getOptions().tabSize;let o=new Uint32Array(this._foldingRangesLimit),r=new Uint32Array(this._foldingRangesLimit);for(let s=this._length-1,a=0;s>=0;s--){let l=this._startIndexes[s],d=computeIndentLevel(e.getLineContent(l),n);(d<i||d===i&&t++<this._foldingRangesLimit)&&(o[a]=l,r[a]=this._endIndexes[s],a++)}return new FoldingRegions(o,r)}}}function computeRanges(e,t,i,n,o){const r=e.getOptions().tabSize;let s,a=new RangesCollector$1(n=null!=n?n:MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,o);i&&(s=new RegExp(`(${i.start.source})|(?:${i.end.source})`));let l=[],d=e.getLineCount()+1;l.push({indent:-1,endAbove:d,line:d});for(let c=e.getLineCount();c>0;c--){let i,n=e.getLineContent(c),o=computeIndentLevel(n,r),d=l[l.length-1];if(-1!==o){if(s&&(i=n.match(s))){if(!i[1]){l.push({indent:-2,endAbove:c,line:c});continue}{let e=l.length-1;for(;e>0&&-2!==l[e].indent;)e--;if(e>0){l.length=e+1,d=l[e],a.insertFirst(c,d.line,o),d.line=c,d.indent=o,d.endAbove=c;continue}}}if(d.indent>o){do{l.pop(),d=l[l.length-1]}while(d.indent>o);let e=d.endAbove-1;e-c>=1&&a.insertFirst(c,e,o)}d.indent===o?d.endAbove=c:l.push({indent:o,endAbove:c,line:c})}else t&&(d.endAbove=c)}return a.toIndentRanges(e)}const foldingContext={},ID_SYNTAX_PROVIDER="syntax";class SyntaxRangeProvider{constructor(e,t,i,n){this.editorModel=e,this.providers=t,this.limit=n,this.id=ID_SYNTAX_PROVIDER;for(const o of t)"function"==typeof o.onDidChange&&(this.disposables||(this.disposables=new DisposableStore),this.disposables.add(o.onDidChange(i)))}compute(e,t){return collectSyntaxRanges(this.providers,this.editorModel,e).then((e=>{if(e){return sanitizeRanges(e,this.limit,t)}return null}))}dispose(){var e;null===(e=this.disposables)||void 0===e||e.dispose()}}function collectSyntaxRanges(e,t,i){let n=null,o=e.map(((e,o)=>Promise.resolve(e.provideFoldingRanges(t,foldingContext,i)).then((e=>{if(!i.isCancellationRequested&&Array.isArray(e)){Array.isArray(n)||(n=[]);let i=t.getLineCount();for(let t of e)t.start>0&&t.end>t.start&&t.end<=i&&n.push({start:t.start,end:t.end,rank:o,kind:t.kind})}}),onUnexpectedExternalError)));return Promise.all(o).then((e=>n))}class RangesCollector{constructor(e,t){this._notifyTooManyRegions=t,this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>MAX_LINE_NUMBER||t>MAX_LINE_NUMBER)return;let o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=t,this._nestingLevels[o]=n,this._types[o]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let i=0;i<this._length;i++)e[i]=this._startIndexes[i],t[i]=this._endIndexes[i];return new FoldingRegions(e,t,this._types)}{this._notifyTooManyRegions&&this._notifyTooManyRegions(this._foldingRangesLimit);let e=0,t=this._nestingLevelCounts.length;for(let r=0;r<this._nestingLevelCounts.length;r++){let i=this._nestingLevelCounts[r];if(i){if(i+e>this._foldingRangesLimit){t=r;break}e+=i}}let i=new Uint32Array(this._foldingRangesLimit),n=new Uint32Array(this._foldingRangesLimit),o=[];for(let r=0,s=0;r<this._length;r++){let a=this._nestingLevels[r];(a<t||a===t&&e++<this._foldingRangesLimit)&&(i[s]=this._startIndexes[r],n[s]=this._endIndexes[r],o[s]=this._types[r],s++)}return new FoldingRegions(i,n,o)}}}function sanitizeRanges(e,t,i){let n,o=e.sort(((e,t)=>{let i=e.start-t.start;return 0===i&&(i=e.rank-t.rank),i})),r=new RangesCollector(t,i),s=[];for(let a of o)if(n){if(a.start>n.start)if(a.end<=n.end)s.push(n),n=a,r.add(a.start,a.end,a.kind&&a.kind.value,s.length);else{if(a.start>n.end){do{n=s.pop()}while(n&&a.start>n.end);n&&s.push(n),n=a}r.add(a.start,a.end,a.kind&&a.kind.value,s.length)}}else n=a,r.add(a.start,a.end,a.kind&&a.kind.value,s.length);return r.toIndentRanges()}const ID_INIT_PROVIDER="init";class InitializingRangeProvider{constructor(e,t,i,n){if(this.editorModel=e,this.id=ID_INIT_PROVIDER,t.length){let o=t=>({range:{startLineNumber:t.startLineNumber,startColumn:0,endLineNumber:t.endLineNumber,endColumn:e.getLineLength(t.endLineNumber)},options:{description:"folding-initializing-range-provider",stickiness:1}});this.decorationIds=e.deltaDecorations([],t.map(o)),this.timeout=setTimeout(i,n)}}dispose(){this.decorationIds&&(this.editorModel.deltaDecorations(this.decorationIds,[]),this.decorationIds=void 0),"number"==typeof this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(e){let t=[];if(this.decorationIds)for(let i of this.decorationIds){let e=this.editorModel.getDecorationRange(i);e&&t.push({start:e.startLineNumber,end:e.endLineNumber,rank:1})}return Promise.resolve(sanitizeRanges(t,Number.MAX_VALUE))}}const foldingExpandedIcon=registerIcon("folding-expanded",Codicon.chevronDown,localize("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),foldingCollapsedIcon=registerIcon("folding-collapsed",Codicon.chevronRight,localize("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin."));class FoldingDecorationProvider{constructor(e){this.editor=e,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(e,t){return t?FoldingDecorationProvider.HIDDEN_RANGE_DECORATION:e?this.showFoldingHighlights?FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION}deltaDecorations(e,t){return this.editor.deltaDecorations(e,t)}changeDecorations(e){return this.editor.changeDecorations(e)}}FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-collapsed-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingCollapsedIcon)}),FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:1,afterContentClassName:"inline-folded",className:"folded-background",isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingCollapsedIcon)}),FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:ThemeIcon.asClassName(foldingExpandedIcon)}),FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION=ModelDecorationOptions.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+ThemeIcon.asClassName(foldingExpandedIcon)}),FoldingDecorationProvider.HIDDEN_RANGE_DECORATION=ModelDecorationOptions.register({description:"folding-hidden-range-decoration",stickiness:1});var __decorate$V=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$U=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const CONTEXT_FOLDING_ENABLED=new RawContextKey("foldingEnabled",!1);let FoldingController=class e extends Disposable{constructor(e,t,i,n,o,r){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=r,this._tooManyRegionsNotified=!1,this.localToDispose=this._register(new DisposableStore),this.editor=e;const s=this.editor.getOptions();this._isEnabled=s.get(37),this._useFoldingProviders="indentation"!==s.get(38),this._unfoldOnClickAfterEndOfLine=s.get(42),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=s.get(40),this._maxFoldingRegions=s.get(41),this.updateDebounceInfo=o.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new FoldingDecorationProvider(e),this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===s.get(99),this.foldingDecorationProvider.showFoldingHighlights=s.get(39),this.foldingEnabled=CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._notifyTooManyRegions=e=>{this._tooManyRegionsNotified||(n.notify({severity:Severity$2.Warning,sticky:!0,message:localize("maximum fold ranges","The number of foldable regions is limited to a maximum of {0}. Increase configuration option ['Folding Maximum Regions'](command:workbench.action.openSettings?[\"editor.foldingMaximumRegions\"]) to enable more.",e)}),this._tooManyRegionsNotified=!0)},this._register(this.editor.onDidChangeModel((()=>this.onModelChanged()))),this._register(this.editor.onDidChangeConfiguration((e=>{if(e.hasChanged(37)&&(this._isEnabled=this.editor.getOptions().get(37),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(41)&&(this._maxFoldingRegions=this.editor.getOptions().get(41),this._tooManyRegionsNotified=!1,this.onModelChanged()),e.hasChanged(99)||e.hasChanged(39)){const e=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls="mouseover"===e.get(99),this.foldingDecorationProvider.showFoldingHighlights=e.get(39),this.triggerFoldingModelChanged()}e.hasChanged(38)&&(this._useFoldingProviders="indentation"!==this.editor.getOptions().get(38),this.onFoldingStrategyChanged()),e.hasChanged(42)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(42)),e.hasChanged(40)&&(this._foldingImportsByDefault=this.editor.getOptions().get(40))}))),this.onModelChanged()}static get(t){return t.getContribution(e.ID)}saveViewState(){let e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){let t=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)return;if(!e||e.lineCount!==t.getLineCount())return;if(this._currentModelHasFoldedImports=!!e.foldedImports,!e.collapsedRegions)return;e.provider!==ID_SYNTAX_PROVIDER&&e.provider!==ID_INIT_PROVIDER||(this.foldingStateMemento=e);const i=e.collapsedRegions;if(this.hiddenRangeModel.applyMemento(i)){const e=this.getFoldingModel();e&&e.then((e=>{if(e){this._restoringViewState=!0;try{e.applyMemento(i)}finally{this._restoringViewState=!1}}})).then(void 0,onUnexpectedError)}}onModelChanged(){this.localToDispose.clear();let e=this.editor.getModel();this._isEnabled&&e&&!e.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new FoldingModel(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new HiddenRangeModel(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((e=>this.onHiddenRangesChanges(e)))),this.updateScheduler=new Delayer(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new RunOnceScheduler((()=>this.revealCursor()),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((()=>this.onFoldingStrategyChanged()))),this.localToDispose.add(this.editor.onDidChangeModelContent((e=>this.onDidChangeModelContent(e)))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((()=>this.onCursorPositionChanged()))),this.localToDispose.add(this.editor.onMouseDown((e=>this.onEditorMouseDown(e)))),this.localToDispose.add(this.editor.onMouseUp((e=>this.onEditorMouseUp(e)))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new IndentRangeProvider(e,this.languageConfigurationService,this._maxFoldingRegions),this._useFoldingProviders&&this.foldingModel){let t=this.languageFeaturesService.foldingRangeProvider.ordered(this.foldingModel.textModel);if(0===t.length&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions){return this.rangeProvider=new InitializingRangeProvider(e,this.foldingStateMemento.collapsedRegions,(()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()}),3e4)}t.length>0&&(this.rangeProvider=new SyntaxRangeProvider(e,t,(()=>this.triggerFoldingModelChanged()),this._maxFoldingRegions))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){var t;null===(t=this.hiddenRangeModel)||void 0===t||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((()=>{const e=this.foldingModel;if(!e)return null;const t=new StopWatch(!0),i=this.getRangeProvider(e.textModel);let n=this.foldingRegionPromise=createCancelablePromise((e=>i.compute(e,this._notifyTooManyRegions)));return n.then((i=>{if(i&&n===this.foldingRegionPromise){let n;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const e=i.setCollapsedAllOfType(FoldingRangeKind.Imports.value,!0);e&&(n=StableEditorScrollState.capture(this.editor),this._currentModelHasFoldedImports=e)}let o=this.editor.getSelections(),r=o?o.map((e=>e.startLineNumber)):[];e.update(i,r),n&&n.restore(this.editor);const s=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=s)}return e}))})).then(void 0,(e=>(onUnexpectedError(e),null))))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){let e=this.editor.getSelections();e&&this.hiddenRangeModel.adjustSelections(e)&&this.editor.setSelections(e)}this.editor.setHiddenAreas(e)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then((e=>{if(e){let t=this.editor.getSelections();if(t&&t.length>0){let i=[];for(let n of t){let t=n.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(t)&&i.push(...e.getAllRegionsAtLine(t,(e=>e.isCollapsed&&t>e.startLineNumber)))}i.length&&(e.toggleCollapseState(i),this.reveal(t[0].getPosition()))}}})).then(void 0,onUnexpectedError)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range)return;if(!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const t=e.target.detail,n=e.target.element.offsetLeft;if(t.offsetX-n<5)return;i=!0;break}case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()){if(!e.target.detail.isAfterLines)break}return;case 6:if(this.hiddenRangeModel.hasRanges()){let e=this.editor.getModel();if(e&&t.startColumn===e.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.getFoldingModel();if(!t||!this.mouseDownInfo||!e.target)return;let i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,o=e.target.range;if(o&&o.startLineNumber===i){if(n){if(4!==e.target.type)return}else{let e=this.editor.getModel();if(!e||o.startColumn!==e.getLineMaxColumn(i))return}t.then((t=>{if(t){let o=t.getRegionAtLine(i);if(o&&o.startLineNumber===i){let r=o.isCollapsed;if(n||r){let n=[];if(e.event.altKey){let e=e=>!e.containedBy(o)&&!o.containedBy(e),i=t.getRegionsInside(null,e);for(const t of i)t.isCollapsed&&n.push(t);0===n.length&&(n=i)}else{let i=e.event.middleButton||e.event.shiftKey;if(i)for(const e of t.getRegionsInside(o))e.isCollapsed===r&&n.push(e);!r&&i&&0!==n.length||n.push(o)}t.toggleCollapseState(n),this.reveal({lineNumber:i,column:1})}}}})).then(void 0,onUnexpectedError)}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};FoldingController.ID="editor.contrib.folding",FoldingController=__decorate$V([__param$U(1,IContextKeyService),__param$U(2,ILanguageConfigurationService),__param$U(3,INotificationService),__param$U(4,ILanguageFeatureDebounceService),__param$U(5,ILanguageFeaturesService)],FoldingController);class FoldingAction extends EditorAction{runEditorCommand(e,t,i){const n=e.get(ILanguageConfigurationService),o=FoldingController.get(t);if(!o)return;const r=o.getFoldingModel();return r?(this.reportTelemetry(e,t),r.then((e=>{if(e){this.invoke(o,e,t,i,n);const r=t.getSelection();r&&o.reveal(r.getStartPosition())}}))):void 0}getSelectedLines(e){let t=e.getSelections();return t?t.map((e=>e.startLineNumber)):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map((e=>e+1)):this.getSelectedLines(t)}run(e,t){}}function foldingArgumentsConstraint(e){if(!isUndefined(e)){if(!isObject(e))return!1;const t=e;if(!isUndefined(t.levels)&&!isNumber$1(t.levels))return!1;if(!isUndefined(t.direction)&&!isString$1(t.direction))return!1;if(!(isUndefined(t.selectionLines)||isArray(t.selectionLines)&&t.selectionLines.every(isNumber$1)))return!1}return!0}class UnfoldAction extends FoldingAction{constructor(){super({id:"editor.unfold",label:localize("unfoldAction.label","Unfold"),alias:"Unfold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){let o=n&&n.levels||1,r=this.getLineNumbers(n,i);n&&"up"===n.direction?setCollapseStateLevelsUp(t,!1,o,r):setCollapseStateLevelsDown(t,!1,o,r)}}class UnFoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.unfoldRecursively",label:localize("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2137),weight:100}})}invoke(e,t,i,n){setCollapseStateLevelsDown(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class FoldAction extends FoldingAction{constructor(){super({id:"editor.fold",label:localize("foldAction.label","Fold"),alias:"Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:foldingArgumentsConstraint,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){let o=this.getLineNumbers(n,i);const r=n&&n.levels,s=n&&n.direction;"number"!=typeof r&&"string"!=typeof s?setCollapseStateUp(t,!0,o):"up"===s?setCollapseStateLevelsUp(t,!0,r||1,o):setCollapseStateLevelsDown(t,!0,r||1,o)}}class ToggleFoldAction extends FoldingAction{constructor(){super({id:"editor.toggleFold",label:localize("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2090),weight:100}})}invoke(e,t,i){toggleCollapseState(t,1,this.getSelectedLines(i))}}class FoldRecursivelyAction extends FoldingAction{constructor(){super({id:"editor.foldRecursively",label:localize("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2135),weight:100}})}invoke(e,t,i){let n=this.getSelectedLines(i);setCollapseStateLevelsDown(t,!0,Number.MAX_VALUE,n)}}class FoldAllBlockCommentsAction extends FoldingAction{constructor(){super({id:"editor.foldAllBlockComments",label:localize("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2133),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())setCollapseStateForType(t,FoldingRangeKind.Comment.value,!0);else{const e=i.getModel();if(!e)return;const n=o.getLanguageConfiguration(e.getLanguageId()).comments;if(n&&n.blockCommentStartToken){setCollapseStateForMatchingLines(t,new RegExp("^\\s*"+escapeRegExpCharacters(n.blockCommentStartToken)),!0)}}}}class FoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.foldAllMarkerRegions",label:localize("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2077),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())setCollapseStateForType(t,FoldingRangeKind.Region.value,!0);else{const e=i.getModel();if(!e)return;const n=o.getLanguageConfiguration(e.getLanguageId()).foldingRules;if(n&&n.markers&&n.markers.start){setCollapseStateForMatchingLines(t,new RegExp(n.markers.start),!0)}}}}class UnfoldAllRegionsAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:localize("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2078),weight:100}})}invoke(e,t,i,n,o){if(t.regions.hasTypes())setCollapseStateForType(t,FoldingRangeKind.Region.value,!1);else{const e=i.getModel();if(!e)return;const n=o.getLanguageConfiguration(e.getLanguageId()).foldingRules;if(n&&n.markers&&n.markers.start){setCollapseStateForMatchingLines(t,new RegExp(n.markers.start),!1)}}}}class FoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.foldAllExcept",label:localize("foldAllExcept.label","Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2131),weight:100}})}invoke(e,t,i){setCollapseStateForRest(t,!0,this.getSelectedLines(i))}}class UnfoldAllRegionsExceptAction extends FoldingAction{constructor(){super({id:"editor.unfoldAllExcept",label:localize("unfoldAllExcept.label","Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2129),weight:100}})}invoke(e,t,i){setCollapseStateForRest(t,!1,this.getSelectedLines(i))}}class FoldAllAction extends FoldingAction{constructor(){super({id:"editor.foldAll",label:localize("foldAllAction.label","Fold All"),alias:"Fold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2069),weight:100}})}invoke(e,t,i){setCollapseStateLevelsDown(t,!0)}}class UnfoldAllAction extends FoldingAction{constructor(){super({id:"editor.unfoldAll",label:localize("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2088),weight:100}})}invoke(e,t,i){setCollapseStateLevelsDown(t,!1)}}class FoldLevelAction extends FoldingAction{getFoldingLevel(){return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length))}invoke(e,t,i){setCollapseStateAtLevel(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}}FoldLevelAction.ID_PREFIX="editor.foldLevel",FoldLevelAction.ID=e=>FoldLevelAction.ID_PREFIX+e;class GotoParentFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoParentFold",label:localize("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(e,t,i){let n=this.getSelectedLines(i);if(n.length>0){let e=getParentFoldLine(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}class GotoPreviousFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoPreviousFold",label:localize("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(e,t,i){let n=this.getSelectedLines(i);if(n.length>0){let e=getPreviousFoldLine(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}class GotoNextFoldAction extends FoldingAction{constructor(){super({id:"editor.gotoNextFold",label:localize("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:100}})}invoke(e,t,i){let n=this.getSelectedLines(i);if(n.length>0){let e=getNextFoldLine(n[0],t);null!==e&&i.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}}registerEditorContribution(FoldingController.ID,FoldingController),registerEditorAction(UnfoldAction),registerEditorAction(UnFoldRecursivelyAction),registerEditorAction(FoldAction),registerEditorAction(FoldRecursivelyAction),registerEditorAction(FoldAllAction),registerEditorAction(UnfoldAllAction),registerEditorAction(FoldAllBlockCommentsAction),registerEditorAction(FoldAllRegionsAction),registerEditorAction(UnfoldAllRegionsAction),registerEditorAction(FoldAllRegionsExceptAction),registerEditorAction(UnfoldAllRegionsExceptAction),registerEditorAction(ToggleFoldAction),registerEditorAction(GotoParentFoldAction),registerEditorAction(GotoPreviousFoldAction),registerEditorAction(GotoNextFoldAction);for(let e=1;e<=7;e++)registerInstantiatedEditorAction(new FoldLevelAction({id:FoldLevelAction.ID(e),label:localize("foldLevelAction.label","Fold Level {0}",e),alias:`Fold Level ${e}`,precondition:CONTEXT_FOLDING_ENABLED,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2048|21+e),weight:100}}));const foldBackgroundBackground=registerColor("editor.foldBackground",{light:transparent(editorSelectionBackground,.3),dark:transparent(editorSelectionBackground,.3),hc:null},localize("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0),editorFoldForeground=registerColor("editorGutter.foldingControlForeground",{dark:iconForeground,light:iconForeground,hc:iconForeground},localize("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));registerThemingParticipant(((e,t)=>{const i=e.getColor(foldBackgroundBackground);i&&t.addRule(`.monaco-editor .folded-background { background-color: ${i}; }`);const n=e.getColor(editorFoldForeground);n&&t.addRule(`\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingExpandedIcon)},\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingCollapsedIcon)} {\n\t\t\tcolor: ${n} !important;\n\t\t}\n\t\t`)}));class EditorFontZoomIn extends EditorAction{constructor(){super({id:"editor.action.fontZoomIn",label:localize("EditorFontZoomIn.label","Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}run(e,t){EditorZoom.setZoomLevel(EditorZoom.getZoomLevel()+1)}}class EditorFontZoomOut extends EditorAction{constructor(){super({id:"editor.action.fontZoomOut",label:localize("EditorFontZoomOut.label","Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}run(e,t){EditorZoom.setZoomLevel(EditorZoom.getZoomLevel()-1)}}class EditorFontZoomReset extends EditorAction{constructor(){super({id:"editor.action.fontZoomReset",label:localize("EditorFontZoomReset.label","Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}run(e,t){EditorZoom.setZoomLevel(0)}}registerEditorAction(EditorFontZoomIn),registerEditorAction(EditorFontZoomOut),registerEditorAction(EditorFontZoomReset);class FormattingEdit{static _handleEolEdits(e,t){let i,n=[];for(let o of t)"number"==typeof o.eol&&(i=o.eol),o.range&&"string"==typeof o.text&&n.push(o);return"number"==typeof i&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range);return i.getFullModelRange().equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const n=FormattingEdit._handleEolEdits(e,t);1===n.length&&FormattingEdit._isFullModelReplaceEdit(e,n[0])?e.executeEdits("formatEditsCommand",n.map((e=>EditOperation.replace(Range$2.lift(e.range),e.text)))):e.executeEdits("formatEditsCommand",n.map((e=>EditOperation.replaceMove(Range$2.lift(e.range),e.text)))),i&&e.pushUndoStop()}}class ExtensionIdentifier{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return"string"==typeof e?e.toLowerCase():e._lower}}var __awaiter$z=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function alertFormattingEdits(e){if(!(e=e.filter((e=>e.range))).length)return;let{range:t}=e[0];for(let o=1;o<e.length;o++)t=Range$2.plusRange(t,e[o].range);const{startLineNumber:i,endLineNumber:n}=t;i===n?1===e.length?alert(localize("hint11","Made 1 formatting edit on line {0}",i)):alert(localize("hintn1","Made {0} formatting edits on line {1}",e.length,i)):1===e.length?alert(localize("hint1n","Made 1 formatting edit between lines {0} and {1}",i,n)):alert(localize("hintnn","Made {0} formatting edits between lines {1} and {2}",e.length,i,n))}function getRealAndSyntheticDocumentFormattersOrdered(e,t,i){const n=[],o=new Set,r=e.ordered(i);for(const a of r)n.push(a),a.extensionId&&o.add(ExtensionIdentifier.toKey(a.extensionId));const s=t.ordered(i);for(const a of s){if(a.extensionId){if(o.has(ExtensionIdentifier.toKey(a.extensionId)))continue;o.add(ExtensionIdentifier.toKey(a.extensionId))}n.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits:(e,t,i)=>a.provideDocumentRangeFormattingEdits(e,e.getFullModelRange(),t,i)})}return n}class FormattingConflicts{static setFormatterSelector(e){return{dispose:FormattingConflicts._selectors.unshift(e)}}static select(e,t,i){return __awaiter$z(this,void 0,void 0,(function*(){if(0===e.length)return;const n=Iterable.first(FormattingConflicts._selectors);return n?yield n(e,t,i):void 0}))}}function formatDocumentRangesWithSelectedProvider(e,t,i,n,o,r){return __awaiter$z(this,void 0,void 0,(function*(){const s=e.get(IInstantiationService),{documentRangeFormattingEditProvider:a}=e.get(ILanguageFeaturesService),l=isCodeEditor(t)?t.getModel():t,d=a.ordered(l),c=yield FormattingConflicts.select(d,l,n);c&&(o.report(c),yield s.invokeFunction(formatDocumentRangesWithProvider,c,t,i,r))}))}function formatDocumentRangesWithProvider(e,t,i,n,o){return __awaiter$z(this,void 0,void 0,(function*(){const r=e.get(IEditorWorkerService);let s,a;isCodeEditor(i)?(s=i.getModel(),a=new EditorStateCancellationTokenSource(i,5,void 0,o)):(s=i,a=new TextModelCancellationTokenSource(i,o));let l=[],d=0;for(let e of asArray(n).sort(Range$2.compareRangesUsingStarts))d>0&&Range$2.areIntersectingOrTouching(l[d-1],e)?l[d-1]=Range$2.fromPositions(l[d-1].getStartPosition(),e.getEndPosition()):d=l.push(e);const c=e=>__awaiter$z(this,void 0,void 0,(function*(){return(yield t.provideDocumentRangeFormattingEdits(s,e,s.getFormattingOptions(),a.token))||[]})),h=(e,t)=>{if(!e.length||!t.length)return!1;const i=e.reduce(((e,t)=>Range$2.plusRange(e,t.range)),e[0].range);if(!t.some((e=>Range$2.intersectRanges(i,e.range))))return!1;for(let n of e)for(let e of t)if(Range$2.intersectRanges(n.range,e.range))return!0;return!1},u=[],g=[];try{for(let e of l){if(a.token.isCancellationRequested)return!0;g.push(yield c(e))}for(let e=0;e<l.length;++e)for(let t=e+1;t<l.length;++t){if(a.token.isCancellationRequested)return!0;if(h(g[e],g[t])){const i=Range$2.plusRange(l[e],l[t]),n=yield c(i);l.splice(t,1),l.splice(e,1),l.push(i),g.splice(t,1),g.splice(e,1),g.push(n),e=0,t=0}}for(let e of g){if(a.token.isCancellationRequested)return!0;const t=yield r.computeMoreMinimalEdits(s.uri,e);t&&u.push(...t)}}finally{a.dispose()}if(0===u.length)return!1;if(isCodeEditor(i))FormattingEdit.execute(i,u,!0),alertFormattingEdits(u),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1);else{const[{range:e}]=u,t=new Selection$1(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],u.map((e=>({text:e.text,range:Range$2.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(Range$2.areIntersectingOrTouching(i,t))return[new Selection$1(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function formatDocumentWithSelectedProvider(e,t,i,n,o){return __awaiter$z(this,void 0,void 0,(function*(){const r=e.get(IInstantiationService),s=e.get(ILanguageFeaturesService),a=isCodeEditor(t)?t.getModel():t,l=getRealAndSyntheticDocumentFormattersOrdered(s.documentFormattingEditProvider,s.documentRangeFormattingEditProvider,a),d=yield FormattingConflicts.select(l,a,i);d&&(n.report(d),yield r.invokeFunction(formatDocumentWithProvider,d,t,i,o))}))}function formatDocumentWithProvider(e,t,i,n,o){return __awaiter$z(this,void 0,void 0,(function*(){const r=e.get(IEditorWorkerService);let s,a,l;isCodeEditor(i)?(s=i.getModel(),a=new EditorStateCancellationTokenSource(i,5,void 0,o)):(s=i,a=new TextModelCancellationTokenSource(i,o));try{const e=yield t.provideDocumentFormattingEdits(s,s.getFormattingOptions(),a.token);if(l=yield r.computeMoreMinimalEdits(s.uri,e),a.token.isCancellationRequested)return!0}finally{a.dispose()}if(!l||0===l.length)return!1;if(isCodeEditor(i))FormattingEdit.execute(i,l,2!==n),2!==n&&(alertFormattingEdits(l),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1));else{const[{range:e}]=l,t=new Selection$1(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],l.map((e=>({text:e.text,range:Range$2.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(Range$2.areIntersectingOrTouching(i,t))return[new Selection$1(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function getDocumentRangeFormattingEditsUntilResult(e,t,i,n,o,r){return __awaiter$z(this,void 0,void 0,(function*(){const s=t.documentRangeFormattingEditProvider.ordered(i);for(const t of s){let s=yield Promise.resolve(t.provideDocumentRangeFormattingEdits(i,n,o,r)).catch(onUnexpectedExternalError);if(isNonEmptyArray(s))return yield e.computeMoreMinimalEdits(i.uri,s)}}))}function getDocumentFormattingEditsUntilResult(e,t,i,n,o){return __awaiter$z(this,void 0,void 0,(function*(){const r=getRealAndSyntheticDocumentFormattersOrdered(t.documentFormattingEditProvider,t.documentRangeFormattingEditProvider,i);for(const t of r){let r=yield Promise.resolve(t.provideDocumentFormattingEdits(i,n,o)).catch(onUnexpectedExternalError);if(isNonEmptyArray(r))return yield e.computeMoreMinimalEdits(i.uri,r)}}))}function getOnTypeFormattingEdits(e,t,i,n,o,r,s){const a=t.onTypeFormattingEditProvider.ordered(i);return 0===a.length||a[0].autoFormatTriggerCharacters.indexOf(o)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(i,n,o,r,s)).catch(onUnexpectedExternalError).then((t=>e.computeMoreMinimalEdits(i.uri,t)))}FormattingConflicts._selectors=new LinkedList,CommandsRegistry.registerCommand("_executeFormatRangeProvider",(function(e,...t){return __awaiter$z(this,void 0,void 0,(function*(){const[i,n,o]=t;assertType(URI.isUri(i)),assertType(Range$2.isIRange(n));const r=e.get(ITextModelService),s=e.get(IEditorWorkerService),a=e.get(ILanguageFeaturesService),l=yield r.createModelReference(i);try{return getDocumentRangeFormattingEditsUntilResult(s,a,l.object.textEditorModel,Range$2.lift(n),o,CancellationToken.None)}finally{l.dispose()}}))})),CommandsRegistry.registerCommand("_executeFormatDocumentProvider",(function(e,...t){return __awaiter$z(this,void 0,void 0,(function*(){const[i,n]=t;assertType(URI.isUri(i));const o=e.get(ITextModelService),r=e.get(IEditorWorkerService),s=e.get(ILanguageFeaturesService),a=yield o.createModelReference(i);try{return getDocumentFormattingEditsUntilResult(r,s,a.object.textEditorModel,n,CancellationToken.None)}finally{a.dispose()}}))})),CommandsRegistry.registerCommand("_executeFormatOnTypeProvider",(function(e,...t){return __awaiter$z(this,void 0,void 0,(function*(){const[i,n,o,r]=t;assertType(URI.isUri(i)),assertType(Position$1.isIPosition(n)),assertType("string"==typeof o);const s=e.get(ITextModelService),a=e.get(IEditorWorkerService),l=e.get(ILanguageFeaturesService),d=yield s.createModelReference(i);try{return getOnTypeFormattingEdits(a,l,d.object.textEditorModel,Position$1.lift(n),o,r,CancellationToken.None)}finally{d.dispose()}}))}));var __decorate$U=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$T=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$y=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let FormatOnType=class{constructor(e,t,i){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._disposables=new DisposableStore,this._sessionDisposables=new DisposableStore,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(49)&&this._update()})))}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(49))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;let i=new CharacterSet;for(let n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType((e=>{let t=e.charCodeAt(e.length-1);i.has(t)&&this._trigger(String.fromCharCode(t))})))}_trigger(e){if(!this._editor.hasModel())return;if(this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=new CancellationTokenSource$1,o=this._editor.onDidChangeModelContent((e=>{if(e.isFlush)return n.cancel(),void o.dispose();for(let t=0,r=e.changes.length;t<r;t++){if(e.changes[t].range.endLineNumber<=i.lineNumber)return n.cancel(),void o.dispose()}}));getOnTypeFormattingEdits(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),n.token).then((e=>{n.token.isCancellationRequested||isNonEmptyArray(e)&&(FormattingEdit.execute(this._editor,e,!0),alertFormattingEdits(e))})).finally((()=>{o.dispose()}))}};FormatOnType.ID="editor.contrib.autoFormat",FormatOnType=__decorate$U([__param$T(1,ILanguageFeaturesService),__param$T(2,IEditorWorkerService)],FormatOnType);let FormatOnPaste=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new DisposableStore,this._callOnModel=new DisposableStore,this._callOnDispose.add(e.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(48)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range:e})=>this._trigger(e))))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider,this.editor,e,2,Progress.None,CancellationToken.None).catch(onUnexpectedError))}};FormatOnPaste.ID="editor.contrib.formatOnPaste",FormatOnPaste=__decorate$U([__param$T(1,ILanguageFeaturesService),__param$T(2,IInstantiationService)],FormatOnPaste);class FormatDocumentAction extends EditorAction{constructor(){super({id:"editor.action.formatDocument",label:localize("formatDocument.label","Format Document"),alias:"Format Document",precondition:ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor,EditorContextKeys.writable,EditorContextKeys.hasDocumentFormattingProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(e,t){return __awaiter$y(this,void 0,void 0,(function*(){if(t.hasModel()){const i=e.get(IInstantiationService),n=e.get(IEditorProgressService);yield n.showWhile(i.invokeFunction(formatDocumentWithSelectedProvider,t,1,Progress.None,CancellationToken.None),250)}}))}}class FormatSelectionAction extends EditorAction{constructor(){super({id:"editor.action.formatSelection",label:localize("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2084),weight:100},contextMenuOpts:{when:EditorContextKeys.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(e,t){return __awaiter$y(this,void 0,void 0,(function*(){if(!t.hasModel())return;const i=e.get(IInstantiationService),n=t.getModel(),o=t.getSelections().map((e=>e.isEmpty()?new Range$2(e.startLineNumber,1,e.startLineNumber,n.getLineMaxColumn(e.startLineNumber)):e)),r=e.get(IEditorProgressService);yield r.showWhile(i.invokeFunction(formatDocumentRangesWithSelectedProvider,t,o,1,Progress.None,CancellationToken.None),250)}))}}registerEditorContribution(FormatOnType.ID,FormatOnType),registerEditorContribution(FormatOnPaste.ID,FormatOnPaste),registerEditorAction(FormatDocumentAction),registerEditorAction(FormatSelectionAction),CommandsRegistry.registerCommand("editor.action.format",(e=>__awaiter$y(void 0,void 0,void 0,(function*(){const t=e.get(ICodeEditorService).getFocusedCodeEditor();if(!t||!t.hasModel())return;const i=e.get(ICommandService);t.getSelection().isEmpty()?yield i.executeCommand("editor.action.formatDocument"):yield i.executeCommand("editor.action.formatSelection")}))));var __decorate$T=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$S=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$x=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class TreeElement{remove(){this.parent&&this.parent.children.delete(this.id)}static findId(e,t){let i;"string"==typeof e?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,void 0!==t.children.get(i)&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let o=0;void 0!==t.children.get(n);o++)n=`${i}_${o}`;return n}static empty(e){return 0===e.children.size}}class OutlineElement extends TreeElement{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class OutlineGroup extends TreeElement{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class OutlineModel extends TreeElement{constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}static create(e,t,i){const n=new CancellationTokenSource$1(i),o=new OutlineModel(t.uri),r=e.ordered(t),s=r.map(((e,i)=>{var r;let s=TreeElement.findId(`provider_${i}`,o),a=new OutlineGroup(s,o,null!==(r=e.displayName)&&void 0!==r?r:"Unknown Outline Provider",i);return Promise.resolve(e.provideDocumentSymbols(t,n.token)).then((e=>{for(const t of e||[])OutlineModel._makeOutlineElement(t,a);return a}),(e=>(onUnexpectedExternalError(e),a))).then((e=>{TreeElement.empty(e)?e.remove():o._groups.set(s,e)}))})),a=e.onDidChange((()=>{equals$1(e.ordered(t),r)||n.cancel()}));return Promise.all(s).then((()=>n.token.isCancellationRequested&&!i.isCancellationRequested?OutlineModel.create(e,t,i):o._compact())).finally((()=>{a.dispose()}))}static _makeOutlineElement(e,t){let i=TreeElement.findId(e,t),n=new OutlineElement(i,t,e);if(e.children)for(const o of e.children)OutlineModel._makeOutlineElement(o,n);t.children.set(n.id,n)}_compact(){let e=0;for(const[t,i]of this._groups)0===i.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{let e=Iterable.first(this._groups.values());for(let[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof OutlineElement?e.push(t.symbol):e.push(...Iterable.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>Range$2.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return OutlineModel._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>Position$1.compare(Range$2.getStartPosition(e.range),Range$2.getStartPosition(t.range))||Position$1.compare(Range$2.getEndPosition(t.range),Range$2.getEndPosition(e.range))))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&OutlineModel._flattenDocumentSymbols(e,n.children,n.name)}}const IOutlineModelService=createDecorator("IOutlineModelService");let OutlineModelService=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new DisposableStore,this._cache=new LRUCache(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved((e=>{this._cache.delete(e.id)})))}dispose(){this._disposables.dispose()}getOrCreate(e,t){return __awaiter$x(this,void 0,void 0,(function*(){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let o=this._cache.get(e.id);if(!o||o.versionId!==e.getVersionId()||!equals$1(o.provider,n)){let t=new CancellationTokenSource$1;o={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:t,promise:OutlineModel.create(i,e,t.token),model:void 0},this._cache.set(e.id,o);const r=Date.now();o.promise.then((t=>{o.model=t,this._debounceInformation.update(e,Date.now()-r)})).catch((t=>{this._cache.delete(e.id)}))}if(o.model)return o.model;o.promiseCnt+=1;const r=t.onCancellationRequested((()=>{0==--o.promiseCnt&&(o.source.cancel(),this._cache.delete(e.id))}));try{return yield o.promise}finally{r.dispose()}}))}};OutlineModelService=__decorate$T([__param$S(0,ILanguageFeaturesService),__param$S(1,ILanguageFeatureDebounceService),__param$S(2,IModelService)],OutlineModelService),registerSingleton(IOutlineModelService,OutlineModelService,!0);var __awaiter$w=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};CommandsRegistry.registerCommand("_executeDocumentSymbolProvider",(function(e,...t){return __awaiter$w(this,void 0,void 0,(function*(){const[i]=t;assertType(URI.isUri(i));const n=e.get(IOutlineModelService),o=e.get(ITextModelService),r=yield o.createModelReference(i);try{return(yield n.getOrCreate(r.object.textEditorModel,CancellationToken.None)).getTopLevelSymbols()}finally{r.dispose()}}))}));const inlineSuggestCommitId="editor.action.inlineSuggest.commit";class GhostText{constructor(e,t,i=0){this.lineNumber=e,this.parts=t,this.additionalReservedLineCount=i}renderForScreenReader(e){if(0===this.parts.length)return"";const t=this.parts[this.parts.length-1];return applyEdits(e.substr(0,t.column-1),this.parts.map((e=>({range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join("\n")})))).substring(this.parts[0].column-1)}}class PositionOffsetTransformer{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)"\n"===e.charAt(t)&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}function applyEdits(e,t){const i=new PositionOffsetTransformer(e),n=t.map((e=>{const t=Range$2.lift(e.range);return{startOffset:i.getOffset(t.getStartPosition()),endOffset:i.getOffset(t.getEndPosition()),text:e.text}}));n.sort(((e,t)=>t.startOffset-e.startOffset));for(const o of n)e=e.substring(0,o.startOffset)+o.text+e.substring(o.endOffset);return e}class GhostTextPart{constructor(e,t,i){this.column=e,this.lines=t,this.preview=i}}class BaseGhostTextWidgetModel extends Disposable{constructor(e){super(),this.editor=e,this._expanded=void 0,this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(106)&&void 0===this._expanded&&this.onDidChangeEmitter.fire()})))}setExpanded(e){this._expanded=!0,this.onDidChangeEmitter.fire()}}function normalizedInlineCompletionsEquals(e,t){return e===t||!(!e||!t)&&(e.range.equalsRange(t.range)&&e.text===t.text&&e.command===t.command)}function inlineCompletionToGhostText(e,t,i,n,o=0){if(e.range.startLineNumber!==e.range.endLineNumber)return;const r=t.getLineContent(e.range.startLineNumber),s=getLeadingWhitespace(r).length;if(e.range.startColumn-1<=s){const t=getLeadingWhitespace(e.text).length,i=r.substring(e.range.startColumn-1,s),n=Range$2.fromPositions(e.range.getStartPosition().delta(0,i.length),e.range.getEndPosition()),o=e.text.startsWith(i)?e.text.substring(i.length):e.text.substring(t);e={range:n,text:o,command:e.command}}const a=t.getValueInRange(e.range),l=cachingDiff(a,e.text);if(!l)return;const d=e.range.startLineNumber,c=new Array;if("prefix"===i){const e=l.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==a.length)return}const h=e.text.length-o;for(const u of l){const t=e.range.startColumn+u.originalStart+u.originalLength;if("subwordSmart"===i&&n&&n.lineNumber===e.range.startLineNumber&&t<n.column)return;if(u.originalLength>0)return;if(0===u.modifiedLength)continue;const o=u.modifiedStart+u.modifiedLength,r=Math.max(u.modifiedStart,Math.min(o,h)),s=e.text.substring(u.modifiedStart,r),a=e.text.substring(r,Math.max(u.modifiedStart,o));if(s.length>0){const e=splitLines(s);c.push(new GhostTextPart(t,e,!1))}if(a.length>0){const e=splitLines(a);c.push(new GhostTextPart(t,e,!0))}}return new GhostText(d,c,0)}let lastRequest;function cachingDiff(e,t){if((null==lastRequest?void 0:lastRequest.originalValue)===e&&(null==lastRequest?void 0:lastRequest.newValue)===t)return null==lastRequest?void 0:lastRequest.changes;{const i=smartDiff(e,t);return lastRequest={originalValue:e,newValue:t,changes:i},i}}function smartDiff(e,t){if(e.length>5e3||t.length>5e3)return;function i(e){let t=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n>t&&(t=n)}return t}const n=Math.max(i(e),i(t));function o(e){if(e<0)throw new Error("unexpected");return n+e+1}function r(e){let t=0,i=0;const n=new Int32Array(e.length);for(let r=0,s=e.length;r<s;r++){const s=100*i+t;"("===e[r]?(n[r]=o(2*s),t++):")"===e[r]?(n[r]=o(2*s+1),1===t&&i++,t=Math.max(t-1,0)):n[r]=e.charCodeAt(r)}return n}const s=r(e),a=r(t);return new LcsDiff({getElements:()=>s},{getElements:()=>a}).ComputeDiff(!1).changes}function fixBracketsInLine(e,t){const i=new DenseKeyProvider,n=new LanguageAgnosticBracketTokens(i,(e=>t.getLanguageConfiguration(e))),o=parseDocument(new TextBufferTokenizer(new StaticTokenizerSource([e]),n),[],void 0,!0);let r="";const s=e.getLineContent();return function e(t,i){if(2===t.kind)if(e(t.openingBracket,i),i=lengthAdd(i,t.openingBracket.length),t.child&&(e(t.child,i),i=lengthAdd(i,t.child.length)),t.closingBracket)e(t.closingBracket,i),i=lengthAdd(i,t.closingBracket.length);else{const e=n.getSingleLanguageBracketTokens(t.openingBracket.languageId).findClosingTokenText(t.openingBracket.bracketIds);r+=e}else if(3===t.kind);else if(0===t.kind||1===t.kind)r+=s.substring(lengthGetColumnCountIfZeroLineCount(i),lengthGetColumnCountIfZeroLineCount(lengthAdd(i,t.length)));else if(4===t.kind)for(const n of t.children)e(n,i),i=lengthAdd(i,n.length)}(o,lengthZero),r}class StaticTokenizerSource{constructor(e){this.lines=e}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}getLineTokens(e){return this.lines[e-1]}}var __decorate$S=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$R=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$v=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let InlineCompletionsModel=class extends Disposable{constructor(e,t,i,n,o,r){super(),this.editor=e,this.cache=t,this.commandService=i,this.languageConfigurationService=n,this.languageFeaturesService=o,this.debounceService=r,this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new MutableDisposable),this.active=!1,this.disposed=!1,this.debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:200}),this._register(i.onDidExecuteCommand((t=>{new Set([CoreEditingCommands.Tab.id,CoreEditingCommands.DeleteLeft.id,CoreEditingCommands.DeleteRight.id,inlineSuggestCommitId,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&this.handleUserInput()}))),this._register(this.editor.onDidType((e=>{this.handleUserInput()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.session&&!this.session.isValid&&this.hide()}))),this._register(toDisposable((()=>{this.disposed=!0}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this.hide()})))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout((()=>{this.disposed||this.startSessionIfTriggered()}),0)}get session(){return this.completionSession.value}get ghostText(){var e;return null===(e=this.session)||void 0===e?void 0:e.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(e){var t;null===(t=this.session)||void 0===t||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&(null===(t=this.session)||void 0===t||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(55).enabled&&(this.session&&this.session.isValid||this.trigger(InlineCompletionTriggerKind$1.Automatic))}trigger(e){this.completionSession.value?e===InlineCompletionTriggerKind$1.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext():(this.completionSession.value=new InlineCompletionsSession(this.editor,this.editor.getPosition(),(()=>this.active),this.commandService,this.cache,e,this.languageConfigurationService,this.languageFeaturesService.inlineCompletionsProvider,this.debounceValue),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((()=>{this.onDidChangeEmitter.fire()}))))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;null===(e=this.session)||void 0===e||e.commitCurrentCompletion()}showNext(){var e;null===(e=this.session)||void 0===e||e.showNextInlineCompletion()}showPrevious(){var e;null===(e=this.session)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return __awaiter$v(this,void 0,void 0,(function*(){const t=yield null===(e=this.session)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};InlineCompletionsModel=__decorate$S([__param$R(2,ICommandService),__param$R(3,ILanguageConfigurationService),__param$R(4,ILanguageFeaturesService),__param$R(5,ILanguageFeatureDebounceService)],InlineCompletionsModel);class InlineCompletionsSession extends BaseGhostTextWidgetModel{constructor(e,t,i,n,o,r,s,a,l){let d;super(e),this.triggerPosition=t,this.shouldUpdate=i,this.commandService=n,this.cache=o,this.initialTriggerKind=r,this.languageConfigurationService=s,this.registry=a,this.debounce=l,this.minReservedLineCount=0,this.updateOperation=this._register(new MutableDisposable),this.updateSoon=this._register(new RunOnceScheduler((()=>{let e=this.initialTriggerKind;return this.initialTriggerKind=InlineCompletionTriggerKind$1.Automatic,this.update(e)}),50)),this.currentlySelectedCompletionId=void 0,this._register(this.onDidChange((()=>{const e=this.currentCompletion;if(e&&e.sourceInlineCompletion!==d){d=e.sourceInlineCompletion;const t=e.sourceProvider;t.handleItemDidShow&&t.handleItemDidShow(e.sourceInlineCompletions,d)}}))),this._register(toDisposable((()=>{this.cache.clear()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.cache.value&&this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeModelContent((e=>{this.scheduleAutomaticUpdate()}))),this._register(this.registry.onDidChange((()=>{this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}))),this.scheduleAutomaticUpdate()}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;const e=this.cache.value.completions.findIndex((e=>e.semanticId===this.currentlySelectedCompletionId));return-1===e?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){var e;return __awaiter$v(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const t=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[];if(t.length>0){const e=(this.fixAndGetIndexOfCurrentSelection()+1)%t.length;this.currentlySelectedCompletionId=t[e].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}showPreviousInlineCompletion(){var e;return __awaiter$v(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const t=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[];if(t.length>0){const e=(this.fixAndGetIndexOfCurrentSelection()+t.length-1)%t.length;this.currentlySelectedCompletionId=t[e].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}ensureUpdateWithExplicitContext(){var e;return __awaiter$v(this,void 0,void 0,(function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===InlineCompletionTriggerKind$1.Explicit?yield this.updateOperation.value.promise:yield this.update(InlineCompletionTriggerKind$1.Explicit):(null===(e=this.cache.value)||void 0===e?void 0:e.triggerKind)!==InlineCompletionTriggerKind$1.Explicit&&(yield this.update(InlineCompletionTriggerKind$1.Explicit))}))}hasMultipleInlineCompletions(){var e;return __awaiter$v(this,void 0,void 0,(function*(){return yield this.ensureUpdateWithExplicitContext(),((null===(e=this.cache.value)||void 0===e?void 0:e.completions.length)||0)>1}))}get ghostText(){const e=this.currentCompletion,t=this.editor.getOptions().get(55).mode;return e?inlineCompletionToGhostText(e,this.editor.getModel(),t,this.editor.getPosition()):void 0}get currentCompletion(){const e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}update(e){return __awaiter$v(this,void 0,void 0,(function*(){if(!this.shouldUpdate())return;const t=this.editor.getPosition(),i=new Date,n=createCancelablePromise((n=>__awaiter$v(this,void 0,void 0,(function*(){let o;try{o=yield provideInlineCompletions(this.registry,t,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},n,this.languageConfigurationService);const r=new Date;this.debounce.update(this.editor.getModel(),r.getTime()-i.getTime())}catch(e2){return void onUnexpectedError(e2)}n.isCancellationRequested||(this.cache.setValue(this.editor,o,e),this.onDidChangeEmitter.fire())})))),o=new UpdateOperation(n,e);this.updateOperation.value=o,yield n,this.updateOperation.value===o&&this.updateOperation.clear()}))}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;const e=this.currentCompletion;e&&this.commit(e)}commit(e){const t=this.cache.clearAndLeak();this.editor.executeEdits("inlineSuggestion.accept",[EditOperation.replaceMove(e.range,e.text)]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally((()=>{null==t||t.dispose()})).then(void 0,onUnexpectedExternalError):null==t||t.dispose(),this.onDidChangeEmitter.fire()}}class UpdateOperation{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}}class SynchronizedInlineCompletionsCache extends Disposable{constructor(e,t,i,n){super(),this.triggerKind=n;const o=e.deltaDecorations([],t.items.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))));this._register(toDisposable((()=>{e.deltaDecorations(o,[])}))),this.completions=t.items.map(((e,t)=>new CachedInlineCompletion(e,o[t]))),this._register(e.onDidChangeModelContent((()=>{let t=!1;const n=e.getModel();for(const e of this.completions){const i=n.getDecorationRange(e.decorationId);i?e.synchronizedRange.equalsRange(i)||(t=!0,e.synchronizedRange=i):onUnexpectedError(new Error("Decoration has no range"))}t&&i()}))),this._register(t)}}class CachedInlineCompletion{constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}toLiveInlineCompletion(){return{text:this.inlineCompletion.text,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion}}}function getDefaultRange(e,t){const i=t.getWordAtPosition(e),n=t.getLineMaxColumn(e.lineNumber);return i?new Range$2(e.lineNumber,i.startColumn,e.lineNumber,n):Range$2.fromPositions(e,e.with(void 0,n))}function provideInlineCompletions(e,t,i,n,o=CancellationToken.None,r){return __awaiter$v(this,void 0,void 0,(function*(){const s=getDefaultRange(t,i),a=e.all(i),l=yield Promise.all(a.map((e=>__awaiter$v(this,void 0,void 0,(function*(){const r=yield Promise.resolve(e.provideInlineCompletions(i,t,n,o)).catch(onUnexpectedExternalError);return{completions:r,provider:e,dispose:()=>{r&&e.freeInlineCompletions(r)}}}))))),d=new Map;for(const e of l){const t=e.completions;if(t)for(const n of t.items){const o=n.range?Range$2.lift(n.range):s;if(o.startLineNumber!==o.endLineNumber)continue;const a=r&&n.completeBracketPairs?closeBrackets(n.text,o.getStartPosition(),i,r):n.text,l={text:a,range:o,command:n.command,sourceProvider:e.provider,sourceInlineCompletions:t,sourceInlineCompletion:n};d.set(JSON.stringify({text:a,range:n.range}),l)}}return{items:[...d.values()],dispose:()=>{for(const e of l)e.dispose()}}}))}function closeBrackets(e,t,i,n){const o=i.getLineContent(t.lineNumber).substring(0,t.column-1)+e,r=i.tokenizeLineWithEdit(t,o.length-(t.column-1),e),s=null==r?void 0:r.sliceAndInflate(t.column-1,o.length,0);if(!s)return e;return fixBracketsInLine(s,n)}function minimizeInlineCompletion(e,t){if(!t)return t;const i=e.getValueInRange(t.range),n=commonPrefixLength(i,t.text),o=e.getOffsetAt(t.range.getStartPosition())+n,r=e.getPositionAt(o),s=commonSuffixLength(i.substr(n),t.text),a=e.getPositionAt(Math.max(o,e.getOffsetAt(t.range.getEndPosition())-s));return{range:Range$2.fromPositions(r,a),text:t.text.substr(n,t.text.length-n-s)}}var snippetSession="";const IWorkspaceContextService=createDecorator("contextService");function isSingleFolderWorkspaceIdentifier(e){const t=e;return"string"==typeof(null==t?void 0:t.id)&&URI.isUri(t.uri)}function toWorkspaceIdentifier(e){return e.configuration?{id:e.id,configPath:e.configuration}:1===e.folders.length?{id:e.id,uri:e.folders[0].uri}:void 0}class WorkspaceFolder{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const WORKSPACE_EXTENSION="code-workspace";localize("codeWorkspace","Code Workspace");const _data=new Uint8Array(16),_hex=[];for(let e=0;e<256;e++)_hex.push(e.toString(16).padStart(2,"0"));let _fillRandomValues;function generateUuid(){_fillRandomValues(_data),_data[6]=15&_data[6]|64,_data[8]=63&_data[8]|128;let e=0,t="";return t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+="-",t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+="-",t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+="-",t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+="-",t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t+=_hex[_data[e++]],t}_fillRandomValues="object"==typeof crypto&&"function"==typeof crypto.getRandomValues?crypto.getRandomValues.bind(crypto):function(e){for(let t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random());return e},Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0});class CompositeSnippetVariableResolver{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){let i=t.resolve(e);if(void 0!==i)return i}}}class SelectionBasedVariableResolver{constructor(e,t,i,n){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=n}resolve(e){const{name:t}=e;if("SELECTION"===t||"TM_SELECTED_TEXT"===t){let t=this._model.getValueInRange(this._selection)||void 0,i=this._selection.startLineNumber!==this._selection.endLineNumber;if(!t&&this._overtypingCapturer){const e=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);e&&(t=e.value,i=e.multiline)}if(t&&i&&e.snippet){const i=getLeadingWhitespace(this._model.getLineContent(this._selection.startLineNumber),0,this._selection.startColumn-1);let n=i;e.snippet.walk((t=>t!==e&&(t instanceof Text&&(n=getLeadingWhitespace(splitLines(t.value).pop())),!0)));const o=commonPrefixLength(n,i);t=t.replace(/(\r\n|\r|\n)(.*)/g,((e,t,i)=>`${t}${n.substr(o)}${i}`))}return t}if("TM_CURRENT_LINE"===t)return this._model.getLineContent(this._selection.positionLineNumber);if("TM_CURRENT_WORD"===t){const e=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return e&&e.word||void 0}return"TM_LINE_INDEX"===t?String(this._selection.positionLineNumber-1):"TM_LINE_NUMBER"===t?String(this._selection.positionLineNumber):void 0}}class ModelBasedVariableResolver{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if("TM_FILENAME"===t)return basename$1(this._model.uri.fsPath);if("TM_FILENAME_BASE"===t){const e=basename$1(this._model.uri.fsPath),t=e.lastIndexOf(".");return t<=0?e:e.slice(0,t)}return"TM_DIRECTORY"===t?"."===dirname$1(this._model.uri.fsPath)?"":this._labelService.getUriLabel(dirname(this._model.uri)):"TM_FILEPATH"===t?this._labelService.getUriLabel(this._model.uri):"RELATIVE_FILEPATH"===t?this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0}):void 0}}class ClipboardBasedVariableResolver{constructor(e,t,i,n){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=n}resolve(e){if("CLIPBOARD"!==e.name)return;const t=this._readClipboardText();if(t){if(this._spread){const e=t.split(/\r\n|\n|\r/).filter((e=>!isFalsyOrWhitespace(e)));if(e.length===this._selectionCount)return e[this._selectionIdx]}return t}}}class CommentBasedVariableResolver{constructor(e,t){this._model=e,this._selection=t}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=LanguageConfigurationRegistry.getComments(i);if(n)return"LINE_COMMENT"===t?n.lineCommentToken||void 0:"BLOCK_COMMENT_START"===t?n.blockCommentStartToken||void 0:"BLOCK_COMMENT_END"===t&&n.blockCommentEndToken||void 0}}class TimeBasedVariableResolver{constructor(){this._date=new Date}resolve(e){const{name:t}=e;return"CURRENT_YEAR"===t?String(this._date.getFullYear()):"CURRENT_YEAR_SHORT"===t?String(this._date.getFullYear()).slice(-2):"CURRENT_MONTH"===t?String(this._date.getMonth().valueOf()+1).padStart(2,"0"):"CURRENT_DATE"===t?String(this._date.getDate().valueOf()).padStart(2,"0"):"CURRENT_HOUR"===t?String(this._date.getHours().valueOf()).padStart(2,"0"):"CURRENT_MINUTE"===t?String(this._date.getMinutes().valueOf()).padStart(2,"0"):"CURRENT_SECOND"===t?String(this._date.getSeconds().valueOf()).padStart(2,"0"):"CURRENT_DAY_NAME"===t?TimeBasedVariableResolver.dayNames[this._date.getDay()]:"CURRENT_DAY_NAME_SHORT"===t?TimeBasedVariableResolver.dayNamesShort[this._date.getDay()]:"CURRENT_MONTH_NAME"===t?TimeBasedVariableResolver.monthNames[this._date.getMonth()]:"CURRENT_MONTH_NAME_SHORT"===t?TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()]:"CURRENT_SECONDS_UNIX"===t?String(Math.floor(this._date.getTime()/1e3)):void 0}}TimeBasedVariableResolver.dayNames=[localize("Sunday","Sunday"),localize("Monday","Monday"),localize("Tuesday","Tuesday"),localize("Wednesday","Wednesday"),localize("Thursday","Thursday"),localize("Friday","Friday"),localize("Saturday","Saturday")],TimeBasedVariableResolver.dayNamesShort=[localize("SundayShort","Sun"),localize("MondayShort","Mon"),localize("TuesdayShort","Tue"),localize("WednesdayShort","Wed"),localize("ThursdayShort","Thu"),localize("FridayShort","Fri"),localize("SaturdayShort","Sat")],TimeBasedVariableResolver.monthNames=[localize("January","January"),localize("February","February"),localize("March","March"),localize("April","April"),localize("May","May"),localize("June","June"),localize("July","July"),localize("August","August"),localize("September","September"),localize("October","October"),localize("November","November"),localize("December","December")],TimeBasedVariableResolver.monthNamesShort=[localize("JanuaryShort","Jan"),localize("FebruaryShort","Feb"),localize("MarchShort","Mar"),localize("AprilShort","Apr"),localize("MayShort","May"),localize("JuneShort","Jun"),localize("JulyShort","Jul"),localize("AugustShort","Aug"),localize("SeptemberShort","Sep"),localize("OctoberShort","Oct"),localize("NovemberShort","Nov"),localize("DecemberShort","Dec")];class WorkspaceBasedVariableResolver{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=toWorkspaceIdentifier(this._workspaceService.getWorkspace());return t?"WORKSPACE_NAME"===e.name?this._resolveWorkspaceName(t):"WORKSPACE_FOLDER"===e.name?this._resoveWorkspacePath(t):void 0:void 0}_resolveWorkspaceName(e){if(isSingleFolderWorkspaceIdentifier(e))return basename$1(e.uri.path);let t=basename$1(e.configPath.path);return t.endsWith(WORKSPACE_EXTENSION)&&(t=t.substr(0,t.length-WORKSPACE_EXTENSION.length-1)),t}_resoveWorkspacePath(e){if(isSingleFolderWorkspaceIdentifier(e))return normalizeDriveLetter(e.uri.fsPath);let t=basename$1(e.configPath.path),i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?normalizeDriveLetter(i):"/"}}class RandomBasedVariableResolver{resolve(e){const{name:t}=e;return"RANDOM"===t?Math.random().toString().slice(-6):"RANDOM_HEX"===t?Math.random().toString(16).slice(-6):"UUID"===t?generateUuid():void 0}}class OneSnippet{constructor(e,t,i,n){this._editor=e,this._snippet=t,this._offset=i,this._snippetLineLeadingWhitespace=n,this._nestingLevel=1,this._placeholderGroups=groupBy(t.placeholders,Placeholder.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.deltaDecorations([...this._placeholderDecorations.values()],[]),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations((t=>{for(const i of this._snippet.placeholders){const n=this._snippet.offset(i),o=this._snippet.fullLen(i),r=Range$2.fromPositions(e.getPositionAt(this._offset+n),e.getPositionAt(this._offset+n+o)),s=i.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive,a=t.addDecoration(r,s);this._placeholderDecorations.set(i,a)}}))}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let e=[];for(const t of this._placeholderGroups[this._placeholderGroupsIdx])if(t.transform){const i=this._placeholderDecorations.get(t),n=this._editor.getModel().getDecorationRange(i),o=this._editor.getModel().getValueInRange(n),r=t.transform.resolve(o).split(/\r\n|\r|\n/);for(let e=1;e<r.length;e++)r[e]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+r[e]);e.push(EditOperation.replace(n,r.join(this._editor.getModel().getEOL())))}e.length>0&&this._editor.executeEdits("snippet.placeholderTransform",e)}let t=!1;!0===e&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):!1===e&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations((e=>{const i=new Set,n=[];for(const o of this._placeholderGroups[this._placeholderGroupsIdx]){const r=this._placeholderDecorations.get(o),s=this._editor.getModel().getDecorationRange(r);n.push(new Selection$1(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(o),e.changeDecorationOptions(r,o.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),i.add(o);for(const t of this._snippet.enclosingPlaceholders(o)){const n=this._placeholderDecorations.get(t);e.changeDecorationOptions(n,t.isFinalTabstop?OneSnippet._decor.activeFinal:OneSnippet._decor.active),i.add(t)}}for(const[t,o]of this._placeholderDecorations)i.has(t)||e.changeDecorationOptions(o,t.isFinalTabstop?OneSnippet._decor.inactiveFinal:OneSnippet._decor.inactive);return n}));return t?this.move(e):null!=i?i:[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof Placeholder){const e=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(e).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||0===this._placeholderGroups.length}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const n of t){if(n.isFinalTabstop)break;i||(i=[],e.set(n.index,i));const t=this._placeholderDecorations.get(n),o=this._editor.getModel().getDecorationRange(t);if(!o){e.delete(n.index);break}i.push(o)}}return e}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations((i=>{for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const o=e.shift(),r=o._snippet.placeholderInfo.last.index;for(const e of o._snippet.placeholderInfo.all)e.isFinalTabstop?e.index=n.index+(r+1)/this._nestingLevel:e.index=n.index+e.index/this._nestingLevel;this._snippet.replace(n,o._snippet.children);const s=this._placeholderDecorations.get(n);i.removeDecoration(s),this._placeholderDecorations.delete(n);for(const e of o._snippet.placeholders){const n=o._snippet.offset(e),r=o._snippet.fullLen(e),s=Range$2.fromPositions(t.getPositionAt(o._offset+n),t.getPositionAt(o._offset+n+r)),a=i.addDecoration(s,OneSnippet._decor.inactive);this._placeholderDecorations.set(e,a)}}this._placeholderGroups=groupBy(this._snippet.placeholders,Placeholder.compareByIndex)}))}}OneSnippet._decor={active:ModelDecorationOptions.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:ModelDecorationOptions.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:ModelDecorationOptions.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:ModelDecorationOptions.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const _defaultOptions$1={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};class SnippetSession{constructor(e,t,i=_defaultOptions$1){this._templateMerges=[],this._snippets=[],this._editor=e,this._template=t,this._options=i}static adjustWhitespace(e,t,i,n,o){const r=getLeadingWhitespace(e.getLineContent(t.lineNumber),0,t.column-1);let s;return i.walk((t=>{if(!(t instanceof Text)||t.parent instanceof Choice)return!0;const o=t.value.split(/\r\n|\r|\n/);if(n){const n=i.offset(t);if(0===n)o[0]=e.normalizeIndentation(o[0]);else{s=null!=s?s:i.toString();let t=s.charCodeAt(n-1);10!==t&&13!==t||(o[0]=e.normalizeIndentation(r+o[0]))}for(let t=1;t<o.length;t++)o[t]=e.normalizeIndentation(r+o[t])}const a=o.join(e.getEOL());return a!==t.value&&(t.parent.replace(t,[new Text(a)]),s=void 0),!0})),r}static adjustSelection(e,t,i,n){if(0!==i||0!==n){const{positionLineNumber:o,positionColumn:r}=t,s=r-i,a=r+n,l=e.validateRange({startLineNumber:o,startColumn:s,endLineNumber:o,endColumn:a});t=Selection$1.createWithDirection(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn,t.getDirection())}return t}static createEditsAndSnippets(e,t,i,n,o,r,s,a){const l=[],d=[];if(!e.hasModel())return{edits:l,snippets:d};const c=e.getModel(),h=e.invokeWithinContext((e=>e.get(IWorkspaceContextService))),u=e.invokeWithinContext((e=>new ModelBasedVariableResolver(e.get(ILabelService),c))),g=()=>s;let p=0,m=c.getValueInRange(SnippetSession.adjustSelection(c,e.getSelection(),i,0)),f=c.getValueInRange(SnippetSession.adjustSelection(c,e.getSelection(),0,n)),_=c.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber);const C=e.getSelections().map(((e,t)=>({selection:e,idx:t}))).sort(((e,t)=>Range$2.compareRangesUsingStarts(e.selection,t.selection)));for(const{selection:v,idx:b}of C){let s=SnippetSession.adjustSelection(c,v,i,0),S=SnippetSession.adjustSelection(c,v,0,n);m!==c.getValueInRange(s)&&(s=v),f!==c.getValueInRange(S)&&(S=v);const y=v.setStartPosition(s.startLineNumber,s.startColumn).setEndPosition(S.endLineNumber,S.endColumn),w=(new SnippetParser).parse(t,!0,o),E=y.getStartPosition(),L=SnippetSession.adjustWhitespace(c,E,w,r||b>0&&_!==c.getLineFirstNonWhitespaceColumn(v.positionLineNumber),!0);w.resolveVariables(new CompositeSnippetVariableResolver([u,new ClipboardBasedVariableResolver(g,b,C.length,"spread"===e.getOption(71)),new SelectionBasedVariableResolver(c,v,b,a),new CommentBasedVariableResolver(c,v),new TimeBasedVariableResolver,new WorkspaceBasedVariableResolver(h),new RandomBasedVariableResolver]));const x=c.getOffsetAt(E)+p;p+=w.toString().length-c.getValueLengthInRange(y),l[b]=EditOperation.replace(y,w.toString()),l[b].identifier={major:b,minor:0},d[b]=new OneSnippet(e,w,x,L)}return{edits:l,snippets:d}}dispose(){dispose(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=SnippetSession.createEditsAndSnippets(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer);this._snippets=t,this._editor.executeEdits("snippet",e,(e=>this._snippets[0].hasPlaceholder?this._move(!0):e.filter((e=>!!e.identifier)).map((e=>Selection$1.fromPositions(e.range.getEndPosition()))))),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=_defaultOptions$1){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:n}=SnippetSession.createEditsAndSnippets(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer);this._editor.executeEdits("snippet",i,(e=>{for(const t of this._snippets)t.merge(n);return this._snippets[0].hasPlaceholder?this._move(void 0):e.filter((e=>!!e.identifier)).map((e=>Selection$1.fromPositions(e.range.getEndPosition())))}))}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const n=i.move(e);t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(const i of this._snippets){const n=i.computePossibleSelections();if(0===t.size)for(const[i,o]of n){o.sort(Range$2.compareRangesUsingStarts);for(const n of e)if(o[0].containsRange(n)){t.set(i,[]);break}}if(0===t.size)return!1;t.forEach(((e,t)=>{e.push(...n.get(t))}))}e.sort(Range$2.compareRangesUsingStarts);for(let[i,n]of t)if(n.length===e.length){n.sort(Range$2.compareRangesUsingStarts);for(let o=0;o<n.length;o++)n[o].containsRange(e[o])||t.delete(i)}else t.delete(i);return t.size>0}}var __decorate$R=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$Q=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const _defaultOptions={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let SnippetController2=class e{constructor(t,i,n,o){this._editor=t,this._instantiationService=i,this._logService=n,this._snippetListener=new DisposableStore,this._modelVersionId=-1,this._inSnippet=e.InSnippetMode.bindTo(o),this._hasNextTabstop=e.HasNextTabstop.bindTo(o),this._hasPrevTabstop=e.HasPrevTabstop.bindTo(o)}static get(t){return t.getContribution(e.ID)}dispose(){var e;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),null===(e=this._session)||void 0===e||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,void 0===t?_defaultOptions:Object.assign(Object.assign({},_defaultOptions),t))}catch(e2){this.cancel(),this._logService.error(e2),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){this._editor.hasModel()&&(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(e,t):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new SnippetSession(this._editor,e,t),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent((e=>e.isFlush&&this.cancel()))),this._snippetListener.add(this._editor.onDidChangeModel((()=>this.cancel()))),this._snippetListener.add(this._editor.onDidChangeCursorSelection((()=>this._updateState()))))}_updateState(){if(this._session&&this._editor.hasModel()){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel())return void(this._currentChoice=void 0);const{choice:e}=this._session;if(e){if(this._currentChoice!==e){this._currentChoice=e,this._editor.setSelections(this._editor.getSelections().map((e=>Selection$1.fromPositions(e.getStartPosition()))));const[t]=e.options;this._instantiationService.invokeFunction(showSimpleSuggestions,this._editor,e.options.map(((e,i)=>({kind:13,label:e.value,insertText:e.value,sortText:"a".repeat(i+1),range:Range$2.fromPositions(this._editor.getPosition(),this._editor.getPosition().delta(0,t.value.length))}))))}}else this._currentChoice=void 0}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),null===(t=this._session)||void 0===t||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session&&this._session.prev(),this._updateState()}next(){this._session&&this._session.next(),this._updateState()}isInSnippet(){return Boolean(this._inSnippet.get())}};SnippetController2.ID="snippetController2",SnippetController2.InSnippetMode=new RawContextKey("inSnippetMode",!1,localize("inSnippetMode","Whether the editor in current in snippet mode")),SnippetController2.HasNextTabstop=new RawContextKey("hasNextTabstop",!1,localize("hasNextTabstop","Whether there is a next tab stop when in snippet mode")),SnippetController2.HasPrevTabstop=new RawContextKey("hasPrevTabstop",!1,localize("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode")),SnippetController2=__decorate$R([__param$Q(1,IInstantiationService),__param$Q(2,ILogService),__param$Q(3,IContextKeyService)],SnippetController2),registerEditorContribution(SnippetController2.ID,SnippetController2);const CommandCtor=EditorCommand.bindToContribution(SnippetController2.get);registerEditorCommand(new CommandCtor({id:"jumpToNextSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasNextTabstop),handler:e=>e.next(),kbOpts:{weight:130,kbExpr:EditorContextKeys.editorTextFocus,primary:2}})),registerEditorCommand(new CommandCtor({id:"jumpToPrevSnippetPlaceholder",precondition:ContextKeyExpr.and(SnippetController2.InSnippetMode,SnippetController2.HasPrevTabstop),handler:e=>e.prev(),kbOpts:{weight:130,kbExpr:EditorContextKeys.editorTextFocus,primary:1026}})),registerEditorCommand(new CommandCtor({id:"leaveSnippet",precondition:SnippetController2.InSnippetMode,handler:e=>e.cancel(!0),kbOpts:{weight:130,kbExpr:EditorContextKeys.editorTextFocus,primary:9,secondary:[1033]}})),registerEditorCommand(new CommandCtor({id:"acceptSnippet",precondition:SnippetController2.InSnippetMode,handler:e=>e.finish()}));var __decorate$Q=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$P=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class Memory{constructor(e){this.name=e}select(e,t,i){if(0===i.length)return 0;let n=i[0].score[0];for(let o=0;o<i.length;o++){const{score:e,completion:t}=i[o];if(e[0]!==n)break;if(t.preselect)return o}return 0}}class NoMemory extends Memory{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class LRUMemory extends Memory{constructor(){super("recentlyUsed"),this._cache=new LRUCache(300,.66),this._seq=0}memorize(e,t,i){const n=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(0===i.length)return 0;const n=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(n))return super.select(e,t,i);let o=i[0].score[0],r=-1,s=-1,a=-1;for(let l=0;l<i.length&&i[l].score[0]===o;l++){const t=`${e.getLanguageId()}/${i[l].textLabel}`,n=this._cache.peek(t);if(n&&n.touch>a&&n.type===i[l].completion.kind&&n.insertText===i[l].completion.insertText&&(a=n.touch,s=l),i[l].completion.preselect&&-1===r)return l}return-1!==s?s:-1!==r?r:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();for(const[t,i]of e)i.touch=0,i.type="number"==typeof i.type?i.type:CompletionItemKinds.fromString(i.type),this._cache.set(t,i);this._seq=this._cache.size}}class PrefixMemory extends Memory{constructor(){super("recentlyUsedByPrefix"),this._trie=TernarySearchTree.forStrings(),this._seq=0}memorize(e,t,i){const{word:n}=e.getWordUntilPosition(t),o=`${e.getLanguageId()}/${n}`;this._trie.set(o,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){let{word:n}=e.getWordUntilPosition(t);if(!n)return super.select(e,t,i);let o=`${e.getLanguageId()}/${n}`,r=this._trie.get(o);if(r||(r=this._trie.findSubstr(o)),r)for(let s=0;s<i.length;s++){let{kind:e,insertText:t}=i[s].completion;if(e===r.type&&t===r.insertText)return s}return super.select(e,t,i)}toJSON(){let e=[];return this._trie.forEach(((t,i)=>e.push([i,t]))),e.sort(((e,t)=>-(e[1].touch-t[1].touch))).forEach(((e,t)=>e[1].touch=t)),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type="number"==typeof i.type?i.type:CompletionItemKinds.fromString(i.type),this._trie.set(t,i)}}}let SuggestMemoryService=class e{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new DisposableStore,this._persistSoon=new RunOnceScheduler((()=>this._saveState()),500),this._disposables.add(e.onWillSaveState((e=>{e.reason===WillSaveStateReason.SHUTDOWN&&this._saveState()})))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(t,i){var n;const o=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:t.getLanguageIdAtPosition(i.lineNumber,i.column),resource:t.uri});if((null===(n=this._strategy)||void 0===n?void 0:n.name)!==o){this._saveState();const t=e._strategyCtors.get(o)||NoMemory;this._strategy=new t;try{const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=this._storageService.get(`${e._storagePrefix}/${o}`,t);i&&this._strategy.fromJSON(JSON.parse(i))}catch(e2){}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${e._storagePrefix}/${this._strategy.name}`,i,t,1)}}};SuggestMemoryService._strategyCtors=new Map([["recentlyUsedByPrefix",PrefixMemory],["recentlyUsed",LRUMemory],["first",NoMemory]]),SuggestMemoryService._storagePrefix="suggest/memories",SuggestMemoryService=__decorate$Q([__param$P(0,IStorageService),__param$P(1,IConfigurationService)],SuggestMemoryService);const ISuggestMemoryService=createDecorator("ISuggestMemories");registerSingleton(ISuggestMemoryService,SuggestMemoryService,!0);var __decorate$P=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$O=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let WordContextKey=class e{constructor(t,i){this._editor=t,this._enabled=!1,this._ckAtEnd=e.AtEnd.bindTo(i),this._configListener=this._editor.onDidChangeConfiguration((e=>e.hasChanged(111)&&this._update())),this._update()}dispose(){var e;this._configListener.dispose(),null===(e=this._selectionListener)||void 0===e||e.dispose(),this._ckAtEnd.reset()}_update(){const e="on"===this._editor.getOption(111);if(this._enabled!==e)if(this._enabled=e,this._enabled){const e=()=>{if(!this._editor.hasModel())return void this._ckAtEnd.set(!1);const e=this._editor.getModel(),t=this._editor.getSelection(),i=e.getWordAtPosition(t.getStartPosition());i?this._ckAtEnd.set(i.endColumn===t.getStartPosition().column):this._ckAtEnd.set(!1)};this._selectionListener=this._editor.onDidChangeCursorSelection(e),e()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}};WordContextKey.AtEnd=new RawContextKey("atEndOfWord",!1),WordContextKey=__decorate$P([__param$O(1,IContextKeyService)],WordContextKey);var __decorate$O=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$N=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let SuggestAlternatives=class e{constructor(t,i){this._editor=t,this._index=0,this._ckOtherSuggestions=e.OtherSuggestions.bindTo(i)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),null===(e=this._listener)||void 0===e||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:t,index:i},n){if(0===t.items.length)return void this.reset();e._moveIndex(!0,t,i)!==i?(this._acceptNext=n,this._model=t,this._index=i,this._listener=this._editor.onDidChangeCursorPosition((()=>{this._ignore||this.reset()})),this._ckOtherSuggestions.set(!0)):this.reset()}static _moveIndex(e,t,i){let n=i;for(;n=(n+t.items.length+(e?1:-1))%t.items.length,n!==i&&t.items[n].completion.additionalTextEdits;);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(t){if(this._model)try{this._ignore=!0,this._index=e._moveIndex(t,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};SuggestAlternatives.OtherSuggestions=new RawContextKey("hasOtherSuggestions",!1),SuggestAlternatives=__decorate$O([__param$N(1,IContextKeyService)],SuggestAlternatives);class CommitCharacterController{constructor(e,t,i){this._disposables=new DisposableStore,this._disposables.add(t.onDidShow((()=>this._onItem(t.getFocusedItem())))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType((n=>{if(this._active&&!t.isFrozen()){const t=n.charCodeAt(n.length-1);this._active.acceptCharacters.has(t)&&e.getOption(0)&&i(this._active.item)}})))}_onItem(e){if(!e||!isNonEmptyArray(e.item.completion.commitCharacters))return void this.reset();if(this._active&&this._active.item.item===e.item)return;const t=new CharacterSet;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}var __awaiter$u=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class BracketSelectionRangeProvider{provideSelectionRanges(e,t){return __awaiter$u(this,void 0,void 0,(function*(){const i=[];for(const n of t){const t=[];i.push(t);const o=new Map;yield new Promise((t=>BracketSelectionRangeProvider._bracketsRightYield(t,0,e,n,o))),yield new Promise((i=>BracketSelectionRangeProvider._bracketsLeftYield(i,0,e,n,o,t)))}return i}))}static _bracketsRightYield(e,t,i,n,o){const r=new Map,s=Date.now();for(;;){if(t>=BracketSelectionRangeProvider._maxRounds){e();break}if(!n){e();break}let a=i.bracketPairs.findNextBracket(n);if(!a){e();break}if(Date.now()-s>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsRightYield(e,t+1,i,n,o)));break}const l=a.close[0];if(a.isOpen){let e=r.has(l)?r.get(l):0;r.set(l,e+1)}else{let e=r.has(l)?r.get(l):0;if(e-=1,r.set(l,Math.max(0,e)),e<0){let e=o.get(l);e||(e=new LinkedList,o.set(l,e)),e.push(a.range)}}n=a.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,n,o,r){const s=new Map,a=Date.now();for(;;){if(t>=BracketSelectionRangeProvider._maxRounds&&0===o.size){e();break}if(!n){e();break}let l=i.bracketPairs.findPrevBracket(n);if(!l){e();break}if(Date.now()-a>BracketSelectionRangeProvider._maxDuration){setTimeout((()=>BracketSelectionRangeProvider._bracketsLeftYield(e,t+1,i,n,o,r)));break}const d=l.close[0];if(l.isOpen){let e=s.has(d)?s.get(d):0;if(e-=1,s.set(d,Math.max(0,e)),e<0){let e=o.get(d);if(e){let t=e.shift();0===e.size&&o.delete(d);const n=Range$2.fromPositions(l.range.getEndPosition(),t.getStartPosition()),s=Range$2.fromPositions(l.range.getStartPosition(),t.getEndPosition());r.push({range:n}),r.push({range:s}),BracketSelectionRangeProvider._addBracketLeading(i,s,r)}}}else{let e=s.has(d)?s.get(d):0;s.set(d,e+1)}n=l.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const n=t.startLineNumber,o=e.getLineFirstNonWhitespaceColumn(n);0!==o&&o!==t.startColumn&&(i.push({range:Range$2.fromPositions(new Position$1(n,o),t.getEndPosition())}),i.push({range:Range$2.fromPositions(new Position$1(n,1),t.getEndPosition())}));const r=n-1;if(r>0){const n=e.getLineFirstNonWhitespaceColumn(r);n===t.startColumn&&n!==e.getLineLastNonWhitespaceColumn(r)&&(i.push({range:Range$2.fromPositions(new Position$1(r,n),t.getEndPosition())}),i.push({range:Range$2.fromPositions(new Position$1(r,1),t.getEndPosition())}))}}}BracketSelectionRangeProvider._maxDuration=30,BracketSelectionRangeProvider._maxRounds=2;var __awaiter$t=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class WordDistance{static create(e,t){return __awaiter$t(this,void 0,void 0,(function*(){if(!t.getOption(106).localityBonus)return WordDistance.None;if(!t.hasModel())return WordDistance.None;const i=t.getModel(),n=t.getPosition();if(!e.canComputeWordRanges(i.uri))return WordDistance.None;const[o]=yield(new BracketSelectionRangeProvider).provideSelectionRanges(i,[n]);if(0===o.length)return WordDistance.None;const r=yield e.computeWordRanges(i.uri,o[0].range);if(!r)return WordDistance.None;const s=i.getWordUntilPosition(n);return delete r[s.word],new class extends WordDistance{distance(e,i){if(!n.equals(t.getPosition()))return 0;if(17===i.kind)return 2<<20;let s="string"==typeof i.label?i.label:i.label.label,a=r[s];if(isFalsyOrEmpty(a))return 2<<20;let l=binarySearch(a,Range$2.fromPositions(e),Range$2.compareRangesUsingStarts),d=l>=0?a[l]:a[Math.max(0,~l-1)],c=o.length;for(const t of o){if(!Range$2.containsRange(t.range,d))break;c-=1}return c}}}))}}WordDistance.None=new class extends WordDistance{distance(){return 0}};class CompletionModel{constructor(e,t,i,n,o,r,s){this.clipboardText=s,this._snippetCompareFn=CompletionModel._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=n,this._options=o,this._refilterKind=1,this._lineContext=i,"top"===r?this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsUp:"bottom"===r&&(this._snippetCompareFn=CompletionModel._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){this._lineContext.leadingLineContent===e.leadingLineContent&&this._lineContext.characterCountDelta===e.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}get allProvider(){return this._ensureCachedState(),this._providerInfo.keys()}get incomplete(){this._ensureCachedState();const e=new Set;for(let[t,i]of this._providerInfo)i&&e.add(t);return e}adopt(e){let t=[];for(let i=0;i<this._items.length;)e.has(this._items[i].provider)?i++:(t.push(this._items[i]),this._items[i]=this._items[this._items.length-1],this._items.pop());return this._refilterKind=1,t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){0!==this._refilterKind&&this._createCachedState()}_createCachedState(){this._providerInfo=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",o="";const r=1===this._refilterKind?this._items:this._filteredItems,s=[],a=!this._options.filterGraceful||r.length>2e3?fuzzyScore:fuzzyScoreGracefulAggressive;for(let l=0;l<r.length;l++){const d=r[l];if(d.isInvalid)continue;this._providerInfo.set(d.provider,Boolean(d.container.incomplete));const c=d.position.column-d.editStart.column,h=c+i-(d.position.column-this._column);if(n.length!==h&&(n=0===h?"":t.slice(-h),o=n.toLowerCase()),d.word=n,0===h)d.score=FuzzyScore.Default;else{let e=0;for(;e<c;){const t=n.charCodeAt(e);if(32!==t&&9!==t)break;e+=1}if(e>=h)d.score=FuzzyScore.Default;else if("string"==typeof d.completion.filterText){let t=a(n,o,e,d.completion.filterText,d.filterTextLow,0,!1);if(!t)continue;0===compareIgnoreCase(d.completion.filterText,d.textLabel)?d.score=t:(d.score=anyScore(n,o,e,d.textLabel,d.labelLow,0),d.score[0]=t[0])}else{let t=a(n,o,e,d.textLabel,d.labelLow,0,!1);if(!t)continue;d.score=t}}d.idx=l,d.distance=this._wordDistance.distance(d.position,d.completion),s.push(d),e.push(d.textLabel.length)}this._filteredItems=s.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?quickSelect(e.length-.85,e,((e,t)=>e-t)):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return CompletionModel._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return CompletionModel._compareCompletionItems(e,t)}}var __decorate$N=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$M=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$s=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class LineContext{constructor(e,t,i,n){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.auto=i,this.shy=n}static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenizeIfCheap(i.lineNumber);const n=t.getWordAtPosition(i);return!!n&&(n.endColumn===i.column&&!!isNaN(Number(n.word)))}}function canShowQuickSuggest(e,t,i){if(!Boolean(t.getContextKeyValue("inlineSuggestionVisible")))return!0;const n=i.getValue("editor.inlineSuggest.allowQuickSuggestions");return void 0!==n&&Boolean(n)}function canShowSuggestOnTriggerCharacters(e,t,i){if(!Boolean(t.getContextKeyValue("inlineSuggestionVisible")))return!0;const n=i.getValue("editor.inlineSuggest.allowSuggestOnTriggerCharacters");return void 0!==n&&Boolean(n)}let SuggestModel=class e{constructor(e,t,i,n,o,r,s,a){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=n,this._logService=o,this._contextKeyService=r,this._configurationService=s,this._languageFeaturesService=a,this._toDispose=new DisposableStore,this._quickSuggestDelay=10,this._triggerCharacterListener=new DisposableStore,this._triggerQuickSuggest=new TimeoutTimer,this._state=0,this._completionDisposables=new DisposableStore,this._onDidCancel=new Emitter$1,this._onDidTrigger=new Emitter$1,this._onDidSuggest=new Emitter$1,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new Selection$1(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeModelLanguage((()=>{this._updateTriggerCharacters(),this.cancel()}))),this._toDispose.add(this._editor.onDidChangeConfiguration((()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()}))),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange((()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})));let l=!1;this._toDispose.add(this._editor.onDidCompositionStart((()=>{l=!0}))),this._toDispose.add(this._editor.onDidCompositionEnd((()=>{l=!1,this._onCompositionEnd()}))),this._toDispose.add(this._editor.onDidChangeCursorSelection((e=>{l||this._onCursorChange(e)}))),this._toDispose.add(this._editor.onDidChangeModelContent((()=>{l||this._refilterCompletionItems()}))),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){dispose(this._triggerCharacterListener),dispose([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getOption(80),(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&0!==this._quickSuggestDelay||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(81)||!this._editor.hasModel()||!this._editor.getOption(109))return;const e=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const t of i.triggerCharacters||[]){let n=e.get(t);n||(n=new Set,n.add(getSnippetSuggestSupport()),e.set(t,n)),n.add(i)}const t=t=>{if(!canShowSuggestOnTriggerCharacters(this._editor,this._contextKeyService,this._configurationService))return;if(LineContext.shouldAutoTrigger(this._editor))return;if(!t){const e=this._editor.getPosition();t=this._editor.getModel().getLineContent(e.lineNumber).substr(0,e.column-1)}let i="";isLowSurrogate(t.charCodeAt(t.length-1))?isHighSurrogate(t.charCodeAt(t.length-2))&&(i=t.substr(t.length-2)):i=t.charAt(t.length-1);const n=e.get(i);if(n){const e=this._completionModel?{items:this._completionModel.adopt(n),clipboardText:this._completionModel.clipboardText}:void 0;this.trigger({auto:!0,shy:!1,triggerCharacter:i},Boolean(this._completionModel),n,e)}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd((()=>t())))}get state(){return this._state}cancel(e=!1){var t;0!==this._state&&(this._triggerQuickSuggest.cancel(),null===(t=this._requestToken)||void 0===t||t.cancel(),this._requestToken=void 0,this._state=0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){0!==this._state&&(this._editor.hasModel()&&this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.trigger({auto:2===this._state,shy:!1},!0):this.cancel())}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||0!==e.reason&&3!==e.reason||"keyboard"!==e.source&&"deleteLeft"!==e.source?this.cancel():0===this._state&&0===e.reason?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():0!==this._state&&3===e.reason&&this._refilterCompletionItems()}_onCompositionEnd(){0===this._state?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){var e;!1!==this._editor.getOption(79)&&(this._editor.getOption(106).snippetsPreventQuickSuggestions&&(null===(e=SnippetController2.get(this._editor))||void 0===e?void 0:e.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet((()=>{if(0!==this._state)return;if(!LineContext.shouldAutoTrigger(this._editor))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=this._editor.getOption(79);if(!1!==i){if(!0===i);else{e.tokenizeIfCheap(t.lineNumber);const n=e.getLineTokens(t.lineNumber),o=n.getStandardTokenType(n.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(!(i.other&&0===o||i.comments&&1===o||i.strings&&2===o))return}canShowQuickSuggest(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(e)&&this.trigger({auto:!0,shy:!1})}}),this._quickSuggestDelay)))}_refilterCompletionItems(){Promise.resolve().then((()=>{if(0===this._state)return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=new LineContext(e,t,2===this._state,!1);this._onNewContext(i)}))}trigger(t,i=!1,n,o){var r;if(!this._editor.hasModel())return;const s=this._editor.getModel(),a=t.auto,l=new LineContext(s,this._editor.getPosition(),a,t.shy);this.cancel(i),this._state=a?2:1,this._onDidTrigger.fire({auto:a,shy:t.shy,position:this._editor.getPosition()}),this._context=l;let d={triggerKind:null!==(r=t.triggerKind)&&void 0!==r?r:0};t.triggerCharacter&&(d={triggerKind:1,triggerCharacter:t.triggerCharacter}),this._requestToken=new CancellationTokenSource$1;const c=this._editor.getOption(101);let h=1;switch(c){case"top":h=0;break;case"bottom":h=2}const{itemKind:u,showDeprecated:g}=e._createSuggestFilter(this._editor),p=WordDistance.create(this._editorWorkerService,this._editor),m=provideSuggestionItems(this._languageFeaturesService.completionProvider,s,this._editor.getPosition(),new CompletionOptions(h,u,n,g),d,this._requestToken.token);Promise.all([m,p]).then((([e,i])=>__awaiter$s(this,void 0,void 0,(function*(){var n;if(null===(n=this._requestToken)||void 0===n||n.dispose(),!this._editor.hasModel())return;let r=null==o?void 0:o.clipboardText;if(!r&&e.needsClipboard&&(r=yield this._clipboardService.readText()),0===this._state)return;const s=this._editor.getModel();let l=e.items;if(o){const e=getSuggestionComparator(h);l=l.concat(o.items).sort(e)}const d=new LineContext(s,this._editor.getPosition(),a,t.shy);this._completionModel=new CompletionModel(l,this._context.column,{leadingLineContent:d.leadingLineContent,characterCountDelta:d.column-this._context.column},i,this._editor.getOption(106),this._editor.getOption(101),r),this._completionDisposables.add(e.disposable),this._onNewContext(d),this._reportDurationsTelemetry(e.durations)})))).catch(onUnexpectedError)}_reportDurationsTelemetry(e){this._telemetryGate++%230==0&&setTimeout((()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)}))}static _createSuggestFilter(e){const t=new Set;"none"===e.getOption(101)&&t.add(27);const i=e.getOption(106);return i.showMethods||t.add(0),i.showFunctions||t.add(1),i.showConstructors||t.add(2),i.showFields||t.add(3),i.showVariables||t.add(4),i.showClasses||t.add(5),i.showStructs||t.add(6),i.showInterfaces||t.add(7),i.showModules||t.add(8),i.showProperties||t.add(9),i.showEvents||t.add(10),i.showOperators||t.add(11),i.showUnits||t.add(12),i.showValues||t.add(13),i.showConstants||t.add(14),i.showEnums||t.add(15),i.showEnumMembers||t.add(16),i.showKeywords||t.add(17),i.showWords||t.add(18),i.showColors||t.add(19),i.showFiles||t.add(20),i.showReferences||t.add(21),i.showColors||t.add(22),i.showFolders||t.add(23),i.showTypeParameters||t.add(24),i.showSnippets||t.add(27),i.showUsers||t.add(25),i.showIssues||t.add(26),{itemKind:t,showDeprecated:i.showDeprecated}}_onNewContext(e){if(this._context)if(e.lineNumber===this._context.lineNumber)if(getLeadingWhitespace(e.leadingLineContent)===getLeadingWhitespace(this._context.leadingLineContent)){if(e.column<this._context.column)e.leadingWord.word?this.trigger({auto:this._context.auto,shy:!1},!0):this.cancel();else if(this._completionModel)if(0!==e.leadingWord.word.length&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){const e=new Set(this._languageFeaturesService.completionProvider.all(this._editor.getModel()));for(let i of this._completionModel.allProvider)e.delete(i);const t=this._completionModel.adopt(new Set);this.trigger({auto:this._context.auto,shy:!1},!0,e,{items:t,clipboardText:this._completionModel.clipboardText})}else if(e.column>this._context.column&&this._completionModel.incomplete.size>0&&0!==e.leadingWord.word.length){const{incomplete:e}=this._completionModel,t=this._completionModel.adopt(e);this.trigger({auto:2===this._state,shy:!1,triggerKind:2},!0,e,{items:t,clipboardText:this._completionModel.clipboardText})}else{let t=this._completionModel.lineContext,i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},0===this._completionModel.items.length){if(LineContext.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<e.leadingWord.startColumn)return void this.trigger({auto:this._context.auto,shy:!1},!0);if(this._context.auto)return void this.cancel();if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&0===e.leadingWord.word.length)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,shy:this._context.shy,isFrozen:i})}}else this.cancel();else this.cancel()}};SuggestModel=__decorate$N([__param$M(1,IEditorWorkerService),__param$M(2,IClipboardService),__param$M(3,ITelemetryService),__param$M(4,ILogService),__param$M(5,IContextKeyService),__param$M(6,IConfigurationService),__param$M(7,ILanguageFeaturesService)],SuggestModel);class OvertypingCapturer{constructor(e,t){this._disposables=new DisposableStore,this._lastOvertyped=[],this._empty=!0,this._disposables.add(e.onWillType((()=>{if(!this._empty)return;if(!e.hasModel())return;const t=e.getSelections(),i=t.length;let n=!1;for(let e=0;e<i;e++)if(!t[e].isEmpty()){n=!0;break}if(!n)return;this._lastOvertyped=[];const o=e.getModel();for(let e=0;e<i;e++){const i=t[e];if(o.getValueLengthInRange(i)>OvertypingCapturer._maxSelectionLength)return;this._lastOvertyped[e]={value:o.getValueInRange(i),multiline:i.startLineNumber!==i.endLineNumber}}this._empty=!1}))),this._disposables.add(t.onDidCancel((e=>{this._empty||e.retrigger||(this._empty=!0)})))}getLastOvertypedInfo(e){if(!this._empty&&e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}OvertypingCapturer._maxSelectionLength=51200;var codicon="",codiconModifiers="";function formatRule(e){let t=e.definition;for(;t instanceof Codicon;)t=t.definition;return`.codicon-${e.id}:before { content: '${t.fontCharacter}'; }`}var suggest="",__decorate$M=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$L=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class StatusBarViewItem extends MenuEntryActionViewItem{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();this.label&&(this.label.textContent=localize("ddd","{0} ({1})",this._action.label,StatusBarViewItem.symbolPrintEnter(e)))}static symbolPrintEnter(e){var t;return null===(t=e.getLabel())||void 0===t?void 0:t.replace(/\benter\b/gi,"⏎")}}let SuggestWidgetStatus=class{constructor(e,t,i,n){this._menuService=i,this._contextKeyService=n,this._menuDisposables=new DisposableStore,this.element=append$1(e,$$c(".suggest-status-bar"));const o=e=>e instanceof MenuItemAction?t.createInstance(StatusBarViewItem,e,void 0):void 0;this._leftActions=new ActionBar(this.element,{actionViewItemProvider:o}),this._rightActions=new ActionBar(this.element,{actionViewItemProvider:o}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(suggestWidgetStatusbarMenu,this._contextKeyService),t=()=>{const t=[],i=[];for(let[n,o]of e.getActions())"left"===n?t.push(...o):i.push(...o);this._leftActions.clear(),this._leftActions.push(t),this._rightActions.clear(),this._rightActions.push(i)};this._menuDisposables.add(e.onDidChange((()=>t()))),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};SuggestWidgetStatus=__decorate$M([__param$L(1,IInstantiationService),__param$L(2,IMenuService),__param$L(3,IContextKeyService)],SuggestWidgetStatus);const SYMBOL_ICON_ARRAY_FOREGROUND=registerColor("symbolIcon.arrayForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_BOOLEAN_FOREGROUND=registerColor("symbolIcon.booleanForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_CLASS_FOREGROUND=registerColor("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},localize("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_COLOR_FOREGROUND=registerColor("symbolIcon.colorForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_CONSTANT_FOREGROUND=registerColor("symbolIcon.constantForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_CONSTRUCTOR_FOREGROUND=registerColor("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},localize("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_ENUMERATOR_FOREGROUND=registerColor("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},localize("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND=registerColor("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},localize("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_EVENT_FOREGROUND=registerColor("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hc:"#EE9D28"},localize("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_FIELD_FOREGROUND=registerColor("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},localize("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_FILE_FOREGROUND=registerColor("symbolIcon.fileForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_FOLDER_FOREGROUND=registerColor("symbolIcon.folderForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_FUNCTION_FOREGROUND=registerColor("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},localize("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_INTERFACE_FOREGROUND=registerColor("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},localize("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_KEY_FOREGROUND=registerColor("symbolIcon.keyForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_KEYWORD_FOREGROUND=registerColor("symbolIcon.keywordForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_METHOD_FOREGROUND=registerColor("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hc:"#B180D7"},localize("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_MODULE_FOREGROUND=registerColor("symbolIcon.moduleForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_NAMESPACE_FOREGROUND=registerColor("symbolIcon.namespaceForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_NULL_FOREGROUND=registerColor("symbolIcon.nullForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_NUMBER_FOREGROUND=registerColor("symbolIcon.numberForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_OBJECT_FOREGROUND=registerColor("symbolIcon.objectForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_OPERATOR_FOREGROUND=registerColor("symbolIcon.operatorForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_PACKAGE_FOREGROUND=registerColor("symbolIcon.packageForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_PROPERTY_FOREGROUND=registerColor("symbolIcon.propertyForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_REFERENCE_FOREGROUND=registerColor("symbolIcon.referenceForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_SNIPPET_FOREGROUND=registerColor("symbolIcon.snippetForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_STRING_FOREGROUND=registerColor("symbolIcon.stringForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_STRUCT_FOREGROUND=registerColor("symbolIcon.structForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_TEXT_FOREGROUND=registerColor("symbolIcon.textForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_TYPEPARAMETER_FOREGROUND=registerColor("symbolIcon.typeParameterForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_UNIT_FOREGROUND=registerColor("symbolIcon.unitForeground",{dark:foreground,light:foreground,hc:foreground},localize("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),SYMBOL_ICON_VARIABLE_FOREGROUND=registerColor("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hc:"#75BEFF"},localize("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));registerThemingParticipant(((e,t)=>{const i=e.getColor(SYMBOL_ICON_ARRAY_FOREGROUND);i&&t.addRule(`${Codicon.symbolArray.cssSelector} { color: ${i}; }`);const n=e.getColor(SYMBOL_ICON_BOOLEAN_FOREGROUND);n&&t.addRule(`${Codicon.symbolBoolean.cssSelector} { color: ${n}; }`);const o=e.getColor(SYMBOL_ICON_CLASS_FOREGROUND);o&&t.addRule(`${Codicon.symbolClass.cssSelector} { color: ${o}; }`);const r=e.getColor(SYMBOL_ICON_METHOD_FOREGROUND);r&&t.addRule(`${Codicon.symbolMethod.cssSelector} { color: ${r}; }`);const s=e.getColor(SYMBOL_ICON_COLOR_FOREGROUND);s&&t.addRule(`${Codicon.symbolColor.cssSelector} { color: ${s}; }`);const a=e.getColor(SYMBOL_ICON_CONSTANT_FOREGROUND);a&&t.addRule(`${Codicon.symbolConstant.cssSelector} { color: ${a}; }`);const l=e.getColor(SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);l&&t.addRule(`${Codicon.symbolConstructor.cssSelector} { color: ${l}; }`);const d=e.getColor(SYMBOL_ICON_ENUMERATOR_FOREGROUND);d&&t.addRule(`\n\t\t\t${Codicon.symbolValue.cssSelector},${Codicon.symbolEnum.cssSelector} { color: ${d}; }`);const c=e.getColor(SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);c&&t.addRule(`${Codicon.symbolEnumMember.cssSelector} { color: ${c}; }`);const h=e.getColor(SYMBOL_ICON_EVENT_FOREGROUND);h&&t.addRule(`${Codicon.symbolEvent.cssSelector} { color: ${h}; }`);const u=e.getColor(SYMBOL_ICON_FIELD_FOREGROUND);u&&t.addRule(`${Codicon.symbolField.cssSelector} { color: ${u}; }`);const g=e.getColor(SYMBOL_ICON_FILE_FOREGROUND);g&&t.addRule(`${Codicon.symbolFile.cssSelector} { color: ${g}; }`);const p=e.getColor(SYMBOL_ICON_FOLDER_FOREGROUND);p&&t.addRule(`${Codicon.symbolFolder.cssSelector} { color: ${p}; }`);const m=e.getColor(SYMBOL_ICON_FUNCTION_FOREGROUND);m&&t.addRule(`${Codicon.symbolFunction.cssSelector} { color: ${m}; }`);const f=e.getColor(SYMBOL_ICON_INTERFACE_FOREGROUND);f&&t.addRule(`${Codicon.symbolInterface.cssSelector} { color: ${f}; }`);const _=e.getColor(SYMBOL_ICON_KEY_FOREGROUND);_&&t.addRule(`${Codicon.symbolKey.cssSelector} { color: ${_}; }`);const C=e.getColor(SYMBOL_ICON_KEYWORD_FOREGROUND);C&&t.addRule(`${Codicon.symbolKeyword.cssSelector} { color: ${C}; }`);const v=e.getColor(SYMBOL_ICON_MODULE_FOREGROUND);v&&t.addRule(`${Codicon.symbolModule.cssSelector} { color: ${v}; }`);const b=e.getColor(SYMBOL_ICON_NAMESPACE_FOREGROUND);b&&t.addRule(`${Codicon.symbolNamespace.cssSelector} { color: ${b}; }`);const S=e.getColor(SYMBOL_ICON_NULL_FOREGROUND);S&&t.addRule(`${Codicon.symbolNull.cssSelector} { color: ${S}; }`);const y=e.getColor(SYMBOL_ICON_NUMBER_FOREGROUND);y&&t.addRule(`${Codicon.symbolNumber.cssSelector} { color: ${y}; }`);const w=e.getColor(SYMBOL_ICON_OBJECT_FOREGROUND);w&&t.addRule(`${Codicon.symbolObject.cssSelector} { color: ${w}; }`);const E=e.getColor(SYMBOL_ICON_OPERATOR_FOREGROUND);E&&t.addRule(`${Codicon.symbolOperator.cssSelector} { color: ${E}; }`);const L=e.getColor(SYMBOL_ICON_PACKAGE_FOREGROUND);L&&t.addRule(`${Codicon.symbolPackage.cssSelector} { color: ${L}; }`);const x=e.getColor(SYMBOL_ICON_PROPERTY_FOREGROUND);x&&t.addRule(`${Codicon.symbolProperty.cssSelector} { color: ${x}; }`);const D=e.getColor(SYMBOL_ICON_REFERENCE_FOREGROUND);D&&t.addRule(`${Codicon.symbolReference.cssSelector} { color: ${D}; }`);const I=e.getColor(SYMBOL_ICON_SNIPPET_FOREGROUND);I&&t.addRule(`${Codicon.symbolSnippet.cssSelector} { color: ${I}; }`);const k=e.getColor(SYMBOL_ICON_STRING_FOREGROUND);k&&t.addRule(`${Codicon.symbolString.cssSelector} { color: ${k}; }`);const T=e.getColor(SYMBOL_ICON_STRUCT_FOREGROUND);T&&t.addRule(`${Codicon.symbolStruct.cssSelector} { color: ${T}; }`);const N=e.getColor(SYMBOL_ICON_TEXT_FOREGROUND);N&&t.addRule(`${Codicon.symbolText.cssSelector} { color: ${N}; }`);const M=e.getColor(SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);M&&t.addRule(`${Codicon.symbolTypeParameter.cssSelector} { color: ${M}; }`);const R=e.getColor(SYMBOL_ICON_UNIT_FOREGROUND);R&&t.addRule(`${Codicon.symbolUnit.cssSelector} { color: ${R}; }`);const A=e.getColor(SYMBOL_ICON_VARIABLE_FOREGROUND);A&&t.addRule(`${Codicon.symbolVariable.cssSelector} { color: ${A}; }`)}));class ResizableHTMLElement{constructor(){let e;this._onDidWillResize=new Emitter$1,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new Emitter$1,this.onDidResize=this._onDidResize.event,this._sashListener=new DisposableStore,this._size=new Dimension(0,0),this._minSize=new Dimension(0,0),this._maxSize=new Dimension(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Sash(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Sash(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Sash(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:OrthogonalEdge.North}),this._southSash=new Sash(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:OrthogonalEdge.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let t=0,i=0;this._sashListener.add(Event$1.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)((()=>{void 0===e&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)}))),this._sashListener.add(Event$1.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)((()=>{void 0!==e&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(this._eastSash.onDidChange((n=>{e&&(i=n.currentX-n.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))}))),this._sashListener.add(this._westSash.onDidChange((n=>{e&&(i=-(n.currentX-n.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))}))),this._sashListener.add(this._northSash.onDidChange((n=>{e&&(t=-(n.currentY-n.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))}))),this._sashListener.add(this._southSash.onDidChange((n=>{e&&(t=n.currentY-n.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))}))),this._sashListener.add(Event$1.any(this._eastSash.onDidReset,this._westSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))),this._sashListener.add(Event$1.any(this._northSash.onDidReset,this._southSash.onDidReset)((e=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))})))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,n){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:n}=this._minSize,{height:o,width:r}=this._maxSize;e=Math.max(i,Math.min(o,e)),t=Math.max(n,Math.min(r,t));const s=new Dimension(t,e);Dimension.equals(s,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=s,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}var __decorate$L=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$K=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};function canExpandCompletionItem(e){return!!e&&Boolean(e.completion.documentation||e.completion.detail&&e.completion.detail!==e.completion.label)}let SuggestDetailsWidget=class{constructor(e,t){this._editor=e,this._onDidClose=new Emitter$1,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new Emitter$1,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new DisposableStore,this._renderDisposeable=new DisposableStore,this._borderWidth=1,this._size=new Dimension(330,0),this.domNode=$$c(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(MarkdownRenderer,{editor:e}),this._body=$$c(".body"),this._scrollbar=new DomScrollableElement(this._body,{}),append$1(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=append$1(this._body,$$c(".header")),this._close=append$1(this._header,$$c("span"+Codicon.close.cssSelector)),this._close.title=localize("details.close","Close"),this._type=append$1(this._header,$$c("p.type")),this._docs=append$1(this._body,$$c("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._configureFont()})))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(44),i=t.getMassagedFontFamily(isSafari?EDITOR_FONT_DEFAULTS.fontFamily:null),n=e.get(107)||t.fontSize,o=e.get(108)||t.lineHeight,r=t.fontWeight,s=`${n}px`,a=`${o}px`;this.domNode.style.fontSize=s,this.domNode.style.lineHeight=""+o/n,this.domNode.style.fontWeight=r,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=a,this._close.style.width=a}getLayoutInfo(){const e=this._editor.getOption(108)||this._editor.getOption(44).lineHeight,t=this._borderWidth;return{lineHeight:e,borderWidth:t,borderHeight:2*t,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=localize("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,2*this.getLayoutInfo().lineHeight),this._onDidChangeContents.fire(this)}renderItem(e,t){var i,n;this._renderDisposeable.clear();let{detail:o,documentation:r}=e.completion;if(t){let t="";t+=`score: ${e.score[0]}\n`,t+=`prefix: ${null!==(i=e.word)&&void 0!==i?i:"(no prefix)"}\n`,t+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}\n`,t+=`distance: ${e.distance} (localityBonus-setting)\n`,t+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}\n`,t+=`commit_chars: ${null===(n=e.completion.commitCharacters)||void 0===n?void 0:n.join("")}\n`,r=(new MarkdownString).appendCodeblock("empty",t),o=`Provider: ${e.provider._debugDisplayName}`}if(t||canExpandCompletionItem(e)){if(this.domNode.classList.remove("no-docs","no-type"),o){const e=o.length>1e5?`${o.substr(0,1e5)}…`:o;this._type.textContent=e,this._type.title=e,show(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gim.test(e))}else clearNode(this._type),this._type.title="",hide(this._type),this.domNode.classList.add("no-type");if(clearNode(this._docs),"string"==typeof r)this._docs.classList.remove("markdown-docs"),this._docs.textContent=r;else if(r){this._docs.classList.add("markdown-docs"),clearNode(this._docs);const e=this._markdownRenderer.render(r);this._docs.appendChild(e.element),this._renderDisposeable.add(e),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync((()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)})))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=e=>{e.preventDefault(),e.stopPropagation()},this._close.onclick=e=>{e.preventDefault(),e.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}else this.clearContents()}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get size(){return this._size}layout(e,t){const i=new Dimension(e,t);Dimension.equals(i,this._size)||(this._size=i,size(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};SuggestDetailsWidget=__decorate$L([__param$K(1,IInstantiationService)],SuggestDetailsWidget);class SuggestDetailsOverlay{constructor(e,t){let i,n;this.widget=e,this._editor=t,this._disposables=new DisposableStore,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new ResizableHTMLElement,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let o=0,r=0;this._disposables.add(this._resizable.onDidWillResize((()=>{i=this._topLeft,n=this._resizable.size}))),this._disposables.add(this._resizable.onDidResize((e=>{if(i&&n){this.widget.layout(e.dimension.width,e.dimension.height);let t=!1;e.west&&(r=n.width-e.dimension.width,t=!0),e.north&&(o=n.height-e.dimension.height,t=!0),t&&this._applyTopLeft({top:i.top+o,left:i.left+r})}e.done&&(i=void 0,n=void 0,o=0,r=0,this._userSize=e.dimension)}))),this._disposables.add(this.widget.onDidChangeContents((()=>{var e;this._anchorBox&&this._placeAtAnchor(this._anchorBox,null!==(e=this._userSize)&&void 0!==e?e:this.widget.size,this._preferAlignAtTop)})))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){var i;const n=e.getBoundingClientRect();this._anchorBox=n,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,null!==(i=this._userSize)&&void 0!==i?i:this.widget.size,t)}_placeAtAnchor(e,t,i){var n;const o=getClientArea(document.body),r=this.widget.getLayoutInfo(),s=new Dimension(220,2*r.lineHeight),a=e.top,l=function(){const i=o.width-(e.left+e.width+r.borderWidth+r.horizontalPadding),n=-r.borderWidth+e.left+e.width,l=new Dimension(i,o.height-e.top-r.borderHeight-r.verticalPadding),d=l.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:n,fit:i-t.width,maxSizeTop:l,maxSizeBottom:d,minSize:s.with(Math.min(i,s.width))}}(),d=[l,function(){const i=e.left-r.borderWidth-r.horizontalPadding,n=Math.max(r.horizontalPadding,e.left-t.width-r.borderWidth),l=new Dimension(i,o.height-e.top-r.borderHeight-r.verticalPadding),d=l.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:n,fit:i-t.width,maxSizeTop:l,maxSizeBottom:d,minSize:s.with(Math.min(i,s.width))}}(),function(){const i=e.left,n=-r.borderWidth+e.top+e.height,a=new Dimension(e.width-r.borderHeight,o.height-e.top-e.height-r.verticalPadding);return{top:n,left:i,fit:a.height-t.height,maxSizeBottom:a,maxSizeTop:a,minSize:s.with(a.width)}}()],c=null!==(n=d.find((e=>e.fit>=0)))&&void 0!==n?n:d.sort(((e,t)=>t.fit-e.fit))[0],h=e.top+e.height-r.borderHeight;let u,g=t.height;const p=Math.max(c.maxSizeTop.height,c.maxSizeBottom.height);let m;g>p&&(g=p),i?g<=c.maxSizeTop.height?(u=!0,m=c.maxSizeTop):(u=!1,m=c.maxSizeBottom):g<=c.maxSizeBottom.height?(u=!1,m=c.maxSizeBottom):(u=!0,m=c.maxSizeTop),this._applyTopLeft({left:c.left,top:u?c.top:h-g}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!u,c===l,u,c!==l),this._resizable.minSize=c.minSize,this._resizable.maxSize=m,this._resizable.layout(g,Math.min(m.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}}var FileKind,FileKind2;FileKind2=FileKind||(FileKind={}),FileKind2[FileKind2.FILE=0]="FILE",FileKind2[FileKind2.FOLDER=1]="FOLDER",FileKind2[FileKind2.ROOT_FOLDER=2]="ROOT_FOLDER";const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function getIconClasses(e,t,i,n){const o=n===FileKind.ROOT_FOLDER?["rootfolder-icon"]:n===FileKind.FOLDER?["folder-icon"]:["file-icon"];if(i){let r;if(i.scheme===Schemas.data){r=DataUri.parseMetaData(i).get(DataUri.META_DATA_LABEL)}else{const e=i.path.match(fileIconDirectoryRegex);e?(r=cssEscape(e[2].toLowerCase()),e[1]&&o.push(`${cssEscape(e[1].toLowerCase())}-name-dir-icon`)):r=cssEscape(i.authority.toLowerCase())}if(n===FileKind.FOLDER)o.push(`${r}-name-folder-icon`);else{if(r){if(o.push(`${r}-name-file-icon`),o.push("name-file-icon"),r.length<=255){const e=r.split(".");for(let t=1;t<e.length;t++)o.push(`${e.slice(t).join(".")}-ext-file-icon`)}o.push("ext-file-icon")}const n=detectLanguageId(e,t,i);n&&o.push(`${cssEscape(n)}-lang-file-icon`)}}return o}function detectLanguageId(e,t,i){if(!i)return null;let n=null;if(i.scheme===Schemas.data){const e=DataUri.parseMetaData(i).get(DataUri.META_DATA_MIME);e&&(n=t.getLanguageIdByMimeType(e))}else{const t=e.getModel(i);t&&(n=t.getLanguageId())}return n&&n!==PLAINTEXT_LANGUAGE_ID?n:t.guessLanguageIdByFilepathOrFirstLine(i)}function cssEscape(e){return e.replace(/[\11\12\14\15\40]/g,"/")}var __decorate$K=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$J=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},_a$4;function getAriaId(e){return`suggest-aria-id:${e}`}const suggestMoreInfoIcon=registerIcon("suggest-more-info",Codicon.chevronRight,localize("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),_completionItemColor=new(_a$4=class e{extract(t,i){if(t.textLabel.match(e._regexStrict))return i[0]=t.textLabel,!0;if(t.completion.detail&&t.completion.detail.match(e._regexStrict))return i[0]=t.completion.detail,!0;if("string"==typeof t.completion.documentation){const n=e._regexRelaxed.exec(t.completion.documentation);if(n&&(0===n.index||n.index+n[0].length===t.completion.documentation.length))return i[0]=n[0],!0}return!1}},_a$4._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,_a$4._regexStrict=new RegExp(`^${_a$4._regexRelaxed.source}$`,"i"),_a$4);let ItemRenderer=class{constructor(e,t,i,n){this._editor=e,this._modelService=t,this._languageService=i,this._themeService=n,this._onDidToggleDetails=new Emitter$1,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=Object.create(null);t.disposables=new DisposableStore,t.root=e,t.root.classList.add("show-file-icons"),t.icon=append$1(e,$$c(".icon")),t.colorspan=append$1(t.icon,$$c("span.colorspan"));const i=append$1(e,$$c(".contents")),n=append$1(i,$$c(".main"));t.iconContainer=append$1(n,$$c(".icon-label.codicon")),t.left=append$1(n,$$c("span.left")),t.right=append$1(n,$$c("span.right")),t.iconLabel=new IconLabel(t.left,{supportHighlights:!0,supportIcons:!0}),t.disposables.add(t.iconLabel),t.parametersLabel=append$1(t.left,$$c("span.signature-label")),t.qualifierLabel=append$1(t.left,$$c("span.qualifier-label")),t.detailsLabel=append$1(t.right,$$c("span.details-label")),t.readMore=append$1(t.right,$$c("span.readMore"+ThemeIcon.asCSSSelector(suggestMoreInfoIcon))),t.readMore.title=localize("readMore","Read More");const o=()=>{const e=this._editor.getOptions(),i=e.get(44),o=i.getMassagedFontFamily(isSafari?EDITOR_FONT_DEFAULTS.fontFamily:null),r=i.fontFeatureSettings,s=e.get(107)||i.fontSize,a=e.get(108)||i.lineHeight,l=i.fontWeight,d=`${s}px`,c=`${a}px`;t.root.style.fontSize=d,t.root.style.fontWeight=l,n.style.fontFamily=o,n.style.fontFeatureSettings=r,n.style.lineHeight=c,t.icon.style.height=c,t.icon.style.width=c,t.readMore.style.height=c,t.readMore.style.width=c};return o(),t.disposables.add(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(44)||e.hasChanged(107)||e.hasChanged(108))&&o()}))),t}renderElement(e,t,i){const{completion:n}=e;i.root.id=getAriaId(t),i.colorspan.style.backgroundColor="";const o={labelEscapeNewLines:!0,matches:createMatches(e.score)};let r=[];if(19===n.kind&&_completionItemColor.extract(e,r))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=r[0];else if(20===n.kind&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const t=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:e.textLabel}),FileKind.FILE),r=getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:n.detail}),FileKind.FILE);o.extraClasses=t.length>r.length?t:r}else 23===n.kind&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",o.extraClasses=flatten([getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:e.textLabel}),FileKind.FOLDER),getIconClasses(this._modelService,this._languageService,URI.from({scheme:"fake",path:n.detail}),FileKind.FOLDER)])):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...CSSIcon.asClassNameArray(CompletionItemKinds.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(o.extraClasses=(o.extraClasses||[]).concat(["deprecated"]),o.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,o),"string"==typeof n.label?(i.parametersLabel.textContent="",i.detailsLabel.textContent=stripNewLines(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=stripNewLines(n.label.detail||""),i.detailsLabel.textContent=stripNewLines(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(106).showInlineDetails?show(i.detailsLabel):hide(i.detailsLabel),canExpandCompletionItem(e)?(i.right.classList.add("can-expand-details"),show(i.readMore),i.readMore.onmousedown=e=>{e.stopPropagation(),e.preventDefault()},i.readMore.onclick=e=>{e.stopPropagation(),e.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),hide(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};function stripNewLines(e){return e.replace(/\r\n|\r|\n/g,"")}ItemRenderer=__decorate$K([__param$J(1,IModelService),__param$J(2,ILanguageService),__param$J(3,IThemeService)],ItemRenderer);var __decorate$J=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$I=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$r=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};registerColor("editorSuggestWidget.background",{dark:editorWidgetBackground,light:editorWidgetBackground,hc:editorWidgetBackground},localize("editorSuggestWidgetBackground","Background color of the suggest widget.")),registerColor("editorSuggestWidget.border",{dark:editorWidgetBorder,light:editorWidgetBorder,hc:editorWidgetBorder},localize("editorSuggestWidgetBorder","Border color of the suggest widget."));const editorSuggestWidgetForeground=registerColor("editorSuggestWidget.foreground",{dark:editorForeground,light:editorForeground,hc:editorForeground},localize("editorSuggestWidgetForeground","Foreground color of the suggest widget."));registerColor("editorSuggestWidget.selectedForeground",{dark:quickInputListFocusForeground,light:quickInputListFocusForeground,hc:quickInputListFocusForeground},localize("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget.")),registerColor("editorSuggestWidget.selectedIconForeground",{dark:quickInputListFocusIconForeground,light:quickInputListFocusIconForeground,hc:quickInputListFocusIconForeground},localize("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const editorSuggestWidgetSelectedBackground=registerColor("editorSuggestWidget.selectedBackground",{dark:quickInputListFocusBackground,light:quickInputListFocusBackground,hc:quickInputListFocusBackground},localize("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));registerColor("editorSuggestWidget.highlightForeground",{dark:listHighlightForeground,light:listHighlightForeground,hc:listHighlightForeground},localize("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget.")),registerColor("editorSuggestWidget.focusHighlightForeground",{dark:listFocusHighlightForeground,light:listFocusHighlightForeground,hc:listFocusHighlightForeground},localize("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused.")),registerColor("editorSuggestWidgetStatus.foreground",{dark:transparent(editorSuggestWidgetForeground,.5),light:transparent(editorSuggestWidgetForeground,.5),hc:transparent(editorSuggestWidgetForeground,.5)},localize("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class PersistedWidgetSize{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof EmbeddedCodeEditorWidget}`}restore(){var e;const t=null!==(e=this._service.get(this._key,0))&&void 0!==e?e:"";try{const e=JSON.parse(t);if(Dimension.is(e))return Dimension.lift(e)}catch(i){}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}let SuggestWidget=class e{constructor(e,t,i,n,o){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new TimeoutTimer,this._disposables=new DisposableStore,this._onDidSelect=new Emitter$1,this._onDidFocus=new Emitter$1,this._onDidHide=new Emitter$1,this._onDidShow=new Emitter$1,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new Emitter$1,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new ResizableHTMLElement,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new SuggestContentWidget(this,e),this._persistedSize=new PersistedWidgetSize(t,e);class r{constructor(e,t,i=!1,n=!1){this.persistedSize=e,this.currentSize=t,this.persistHeight=i,this.persistWidth=n}}let s;this._disposables.add(this.element.onDidWillResize((()=>{this._contentWidget.lockPreference(),s=new r(this._persistedSize.restore(),this.element.size)}))),this._disposables.add(this.element.onDidResize((e=>{var t,i,n,o;if(this._resize(e.dimension.width,e.dimension.height),s&&(s.persistHeight=s.persistHeight||!!e.north||!!e.south,s.persistWidth=s.persistWidth||!!e.east||!!e.west),e.done){if(s){const{itemHeight:e,defaultSize:r}=this.getLayoutInfo(),a=Math.round(e/2);let{width:l,height:d}=this.element.size;(!s.persistHeight||Math.abs(s.currentSize.height-d)<=a)&&(d=null!==(i=null===(t=s.persistedSize)||void 0===t?void 0:t.height)&&void 0!==i?i:r.height),(!s.persistWidth||Math.abs(s.currentSize.width-l)<=a)&&(l=null!==(o=null===(n=s.persistedSize)||void 0===n?void 0:n.width)&&void 0!==o?o:r.width),this._persistedSize.store(new Dimension(l,d))}this._contentWidget.unlockPreference(),s=void 0}}))),this._messageElement=append$1(this.element.domNode,$$c(".message")),this._listElement=append$1(this.element.domNode,$$c(".tree"));const a=o.createInstance(SuggestDetailsWidget,this.editor);a.onDidClose(this.toggleDetails,this,this._disposables),this._details=new SuggestDetailsOverlay(a,this.editor);const l=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(106).showIcons);l();const d=o.createInstance(ItemRenderer,this.editor);this._disposables.add(d),this._disposables.add(d.onDidToggleDetails((()=>this.toggleDetails()))),this._list=new List("SuggestWidget",this._listElement,{getHeight:e=>this.getLayoutInfo().itemHeight,getTemplateId:e=>"suggestion"},[d],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>localize("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:e=>{let t=e.textLabel;if("string"!=typeof e.completion.label){const{detail:i,description:n}=e.completion.label;i&&n?t=localize("label.full","{0}{1}, {2}",t,i,n):i?t=localize("label.detail","{0}{1}",t,i):n&&(t=localize("label.desc","{0}, {1}",t,n))}if(!e.isResolved||!this._isDetailsVisible())return t;const{documentation:i,detail:n}=e.completion;return localize("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",t,format("{0}{1}",n||"",i?"string"==typeof i?i:i.value:""))}}}),this._status=o.createInstance(SuggestWidgetStatus,this.element.domNode);const c=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(106).showStatusBar);c(),this._disposables.add(attachListStyler(this._list,n,{listInactiveFocusBackground:editorSuggestWidgetSelectedBackground,listInactiveFocusOutline:activeContrastBorder})),this._disposables.add(n.onDidColorThemeChange((e=>this._onThemeChange(e)))),this._onThemeChange(n.getColorTheme()),this._disposables.add(this._list.onMouseDown((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onTap((e=>this._onListMouseDownOrTap(e)))),this._disposables.add(this._list.onDidChangeSelection((e=>this._onListSelection(e)))),this._disposables.add(this._list.onDidChangeFocus((e=>this._onListFocus(e)))),this._disposables.add(this.editor.onDidChangeCursorSelection((()=>this._onCursorSelectionChanged()))),this._disposables.add(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(106)&&(c(),l())}))),this._ctxSuggestWidgetVisible=Context$2.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=Context$2.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=Context$2.MultipleSuggestions.bindTo(i),this._disposables.add(addStandardDisposableListener(this._details.widget.domNode,"keydown",(e=>{this._onDetailsKeydown.fire(e)}))),this._disposables.add(this.editor.onMouseDown((e=>this._onEditorMouseDown(e))))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){0!==this._state&&this._contentWidget.layout()}_onListMouseDownOrTap(e){void 0!==e.element&&void 0!==e.index&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth="hc"===e.type?2:1}_onListFocus(e){var t;if(this._ignoreFocusEvents)return;if(!e.elements.length)return this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),void this.editor.setAriaOptions({activeDescendant:void 0});if(!this._completionModel)return;const i=e.elements[0],n=e.indexes[0];i!==this._focusedItem&&(null===(t=this._currentSuggestionDetails)||void 0===t||t.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=i,this._list.reveal(n),this._currentSuggestionDetails=createCancelablePromise((e=>__awaiter$r(this,void 0,void 0,(function*(){const t=disposableTimeout((()=>{this._isDetailsVisible()&&this.showDetails(!0)}),250),n=e.onCancellationRequested((()=>t.dispose())),o=yield i.resolve(e);return t.dispose(),n.dispose(),o})))),this._currentSuggestionDetails.then((()=>{n>=this._list.length||i!==this._list.element(n)||(this._ignoreFocusEvents=!0,this._list.splice(n,1,[i]),this._list.setFocus([n]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:getAriaId(n)}))})).catch(onUnexpectedError)),this._onDidFocus.fire({item:i,index:n,model:this._completionModel})}_setState(t){if(this._state!==t)switch(this._state=t,this.element.domNode.classList.toggle("frozen",4===t),this.element.domNode.classList.remove("message"),t){case 0:hide(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=e.LOADING_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=e.NO_SUGGESTIONS_MESSAGE,hide(this._listElement,this._status.element),show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:case 4:hide(this._messageElement),show(this._listElement,this._status.element),this._show();break;case 5:hide(this._messageElement),show(this._listElement,this._status.element),this._details.show(),this._show()}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet((()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)}),100)}showTriggered(e,t){0===this._state&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=disposableTimeout((()=>this._setState(1)),t)))}showSuggestions(e,t,i,n){var o,r;if(this._contentWidget.setPosition(this.editor.getPosition()),null===(o=this._loadingTimeout)||void 0===o||o.dispose(),null===(r=this._currentSuggestionDetails)||void 0===r||r.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&2!==this._state&&0!==this._state)return void this._setState(4);const s=this._completionModel.items.length,a=0===s;if(this._ctxSuggestWidgetMultipleSuggestions.set(s>1),a)return this._setState(n?0:2),void(this._completionModel=void 0);this._focusedItem=void 0,this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus([t]),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(0!==this._state&&2!==this._state&&1!==this._state&&this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){5===this._state?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):3===this._state&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):!canExpandCompletionItem(this._list.getFocusedElements()[0])&&!this._explainMode||3!==this._state&&5!==this._state&&4!==this._state||(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add("shows-details")}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var e;null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const t=this._persistedSize.restore(),i=Math.ceil(4.3*this.getLayoutInfo().itemHeight);t&&t.height<i&&this._persistedSize.store(t.with(void 0,i))}isFrozen(){return 4===this._state}_afterRender(e){null!==e?2!==this._state&&1!==this._state&&(this._isDetailsVisible()&&this._details.show(),this._positionDetails()):this._isDetailsVisible()&&this._details.hide()}_layout(e){var t,i,n;if(!this.editor.hasModel())return;if(!this.editor.getDomNode())return;const o=getClientArea(document.body),r=this.getLayoutInfo();e||(e=r.defaultSize);let s=e.height,a=e.width;if(this._status.element.style.lineHeight=`${r.itemHeight}px`,2===this._state||1===this._state)s=r.itemHeight+r.borderHeight,a=r.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new Dimension(a,s),this._contentWidget.setPreference(2);else{const l=o.width-r.borderHeight-2*r.horizontalPadding;a>l&&(a=l);const d=this._completionModel?this._completionModel.stats.pLabelLen*r.typicalHalfwidthCharacterWidth:a,c=r.statusBarHeight+this._list.contentHeight+r.borderHeight,h=r.itemHeight+r.statusBarHeight,u=getDomNodePagePosition(this.editor.getDomNode()),g=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),p=u.top+g.top+g.height,m=Math.min(o.height-p-r.verticalPadding,c),f=u.top+g.top-r.verticalPadding,_=Math.min(f,c);let C=Math.min(Math.max(_,m)+r.borderHeight,c);s===(null===(t=this._cappedHeight)||void 0===t?void 0:t.capped)&&(s=this._cappedHeight.wanted),s<h&&(s=h),s>C&&(s=C);const v=150;s>m||this._forceRenderingAbove&&f>v?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),C=_):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),C=m),this.element.preferredSize=new Dimension(d,r.defaultSize.height),this.element.maxSize=new Dimension(l,C),this.element.minSize=new Dimension(220,h),this._cappedHeight=s===c?{wanted:null!==(n=null===(i=this._cappedHeight)||void 0===i?void 0:i.wanted)&&void 0!==n?n:e.height,capped:s}:void 0}this._resize(a,s)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),t=Math.min(n,t);const{statusBarHeight:o}=this.getLayoutInfo();this._list.layout(t-o,e),this._listElement.style.height=t-o+"px",this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){var e;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,2===(null===(e=this._contentWidget.getPosition())||void 0===e?void 0:e.preference[0]))}getLayoutInfo(){const e=this.editor.getOption(44),t=clamp(this.editor.getOption(108)||e.lineHeight,8,1e3),i=this.editor.getOption(106).showStatusBar&&2!==this._state&&1!==this._state?t:0,n=this._details.widget.borderWidth,o=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:o,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new Dimension(430,i+12*t+o)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};SuggestWidget.LOADING_MESSAGE=localize("suggestWidget.loading","Loading..."),SuggestWidget.NO_SUGGESTIONS_MESSAGE=localize("suggestWidget.noSuggestions","No suggestions."),SuggestWidget=__decorate$J([__param$I(1,IStorageService),__param$I(2,IContextKeyService),__param$I(3,IThemeService),__param$I(4,IInstantiationService)],SuggestWidget);class SuggestContentWidget{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return!this._hidden&&this._position&&this._preference?{position:this._position,preference:[this._preference]}:null}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new Dimension(t+2*i+n,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}var __decorate$I=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$H=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class LineSuffix{constructor(e,t){this._model=e,this._position=t;if(e.getLineMaxColumn(t.lineNumber)!==t.column){const i=e.getOffsetAt(t),n=e.getPositionAt(i+1);this._marker=e.deltaDecorations([],[{range:Range$2.fromPositions(t,n),options:{description:"suggest-line-suffix",stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}return this._model.getLineMaxColumn(e.lineNumber)-e.column}}let SuggestController=class e{constructor(e,t,i,n,o,r,s){this._memoryService=t,this._commandService=i,this._contextKeyService=n,this._instantiationService=o,this._logService=r,this._telemetryService=s,this._lineSuffix=new MutableDisposable,this._toDispose=new DisposableStore,this._selectors=new PriorityRegistry((e=>e.priority)),this._telemetryGate=0,this.editor=e,this.model=o.createInstance(SuggestModel,this.editor);const a=Context$2.InsertMode.bindTo(n);a.set(e.getOption(106).insertMode),this.model.onDidTrigger((()=>a.set(e.getOption(106).insertMode))),this.widget=this._toDispose.add(new IdleValue((()=>{const e=this._instantiationService.createInstance(SuggestWidget,this.editor);this._toDispose.add(e),this._toDispose.add(e.onDidSelect((e=>this._insertSuggestion(e,0)),this));const t=new CommitCharacterController(this.editor,e,(e=>this._insertSuggestion(e,2)));this._toDispose.add(t),this._toDispose.add(this.model.onDidSuggest((e=>{0===e.completionModel.items.length&&t.reset()})));const i=Context$2.MakesTextEdit.bindTo(this._contextKeyService),n=Context$2.HasInsertAndReplaceRange.bindTo(this._contextKeyService),o=Context$2.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(toDisposable((()=>{i.reset(),n.reset(),o.reset()}))),this._toDispose.add(e.onDidFocus((({item:e})=>{const t=this.editor.getPosition(),r=e.editStart.column,s=t.column;let a=!0;if(!("smart"!==this.editor.getOption(1)||2!==this.model.state||e.completion.additionalTextEdits||4&e.completion.insertTextRules||s-r!==e.completion.insertText.length)){a=this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:r,endLineNumber:t.lineNumber,endColumn:s})!==e.completion.insertText}i.set(a),n.set(!Position$1.equals(e.editInsertEnd,e.editReplaceEnd)),o.set(Boolean(e.provider.resolveCompletionItem)||Boolean(e.completion.documentation)||e.completion.detail!==e.completion.label)}))),this._toDispose.add(e.onDetailsKeyDown((e=>{e.toKeybinding().equals(new SimpleKeybinding(!0,!1,!1,!1,33))||isMacintosh&&e.toKeybinding().equals(new SimpleKeybinding(!1,!1,!1,!0,33))?e.stopPropagation():e.toKeybinding().isModifierKey()||this.editor.focus()}))),e}))),this._overtypingCapturer=this._toDispose.add(new IdleValue((()=>this._toDispose.add(new OvertypingCapturer(this.editor,this.model))))),this._alternatives=this._toDispose.add(new IdleValue((()=>this._toDispose.add(new SuggestAlternatives(this.editor,this._contextKeyService))))),this._toDispose.add(o.createInstance(WordContextKey,e)),this._toDispose.add(this.model.onDidTrigger((e=>{this.widget.value.showTriggered(e.auto,e.shy?250:50),this._lineSuffix.value=new LineSuffix(this.editor.getModel(),e.position)}))),this._toDispose.add(this.model.onDidSuggest((e=>{if(!e.shy){let t=-1;for(const i of this._selectors.itemsOrderedByPriorityDesc)if(t=i.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items),-1!==t)break;-1===t&&(t=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items)),this.widget.value.showSuggestions(e.completionModel,t,e.isFrozen,e.auto)}}))),this._toDispose.add(this.model.onDidCancel((e=>{e.retrigger||this.widget.value.hideWidget()}))),this._toDispose.add(this.editor.onDidBlurEditorWidget((()=>{this.model.cancel(),this.model.clear()})));let l=Context$2.AcceptSuggestionsOnEnter.bindTo(n),d=()=>{const e=this.editor.getOption(1);l.set("on"===e||"smart"===e)};this._toDispose.add(this.editor.onDidChangeConfiguration((()=>d()))),d()}static get(t){return t.getContribution(e.ID)}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(e,t){if(!e||!e.item)return this._alternatives.value.reset(),this.model.cancel(),void this.model.clear();if(!this.editor.hasModel())return;const i=SnippetController2.get(this.editor);if(!i)return;const n=this.editor.getModel(),o=n.getAlternativeVersionId(),{item:r}=e,s=[],a=new CancellationTokenSource$1;1&t||this.editor.pushUndoStop();const l=this.getOverwriteInfo(r,Boolean(8&t));if(this._memoryService.memorize(n,this.editor.getPosition(),r),Array.isArray(r.completion.additionalTextEdits)){const e=StableEditorScrollState.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map((e=>EditOperation.replace(Range$2.lift(e.range),e.text)))),e.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!r.isResolved){const e=new StopWatch(!0);let i;const o=n.onDidChangeContent((e=>{if(e.isFlush)return a.cancel(),void o.dispose();for(let t of e.changes){const e=Range$2.getEndPosition(t.range);i&&!Position$1.isBefore(e,i)||(i=e)}}));let l=t;t|=2;let d=!1,c=this.editor.onWillType((()=>{c.dispose(),d=!0,2&l||this.editor.pushUndoStop()}));s.push(r.resolve(a.token).then((()=>{if(!r.completion.additionalTextEdits||a.token.isCancellationRequested)return!1;if(i&&r.completion.additionalTextEdits.some((e=>Position$1.isBefore(i,Range$2.getStartPosition(e.range)))))return!1;d&&this.editor.pushUndoStop();const e=StableEditorScrollState.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map((e=>EditOperation.replace(Range$2.lift(e.range),e.text)))),e.restoreRelativeVerticalPositionOfCursor(this.editor),!d&&2&l||this.editor.pushUndoStop(),!0})).then((t=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",e.elapsed(),t),o.dispose(),c.dispose()})))}let{insertText:d}=r.completion;4&r.completion.insertTextRules||(d=SnippetParser.escape(d)),i.insert(d,{overwriteBefore:l.overwriteBefore,overwriteAfter:l.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(1&r.completion.insertTextRules),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),2&t||this.editor.pushUndoStop(),r.completion.command?r.completion.command.id===TriggerSuggestAction.id?this.model.trigger({auto:!0,shy:!1},!0):(s.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch(onUnexpectedError)),this.model.cancel()):this.model.cancel(),4&t&&this._alternatives.value.set(e,(e=>{for(a.cancel();n.canUndo();){o!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(e,3|(8&t?8:0));break}})),this._alertCompletionItem(r),Promise.all(s).finally((()=>{this._reportSuggestionAcceptedTelemetry(n,e),this.model.clear(),a.dispose()}))}_reportSuggestionAcceptedTelemetry(e,t){var i;if(this._telemetryGate++%100!=0)return;const n=(null!==(i=t.item.provider._debugDisplayName)&&void 0!==i?i:"unknown").split("(",1)[0].toLowerCase();this._telemetryService.publicLog2("suggest.acceptedSuggestion",{providerId:n,basenameHash:hash(basename(e.uri)).toString(16),languageId:e.getLanguageId(),fileExtension:extname(e.uri)})}getOverwriteInfo(e,t){assertType(this.editor.hasModel());let i="replace"===this.editor.getOption(106).insertMode;t&&(i=!i);const n=e.position.column-e.editStart.column,o=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column;return{overwriteBefore:n+(this.editor.getPosition().column-e.position.column),overwriteAfter:o+(this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0)}}_alertCompletionItem(e){if(isNonEmptyArray(e.completion.additionalTextEdits)){alert(localize("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length))}}triggerSuggest(e,t){this.editor.hasModel()&&(this.model.trigger({auto:null!=t&&t,shy:!1},!1,e),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},n=e=>{if(4&e.completion.insertTextRules||e.completion.additionalTextEdits)return!0;const t=this.editor.getPosition(),i=e.editStart.column,n=t.column;if(n-i!==e.completion.insertText.length)return!0;return this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:i,endLineNumber:t.lineNumber,endColumn:n})!==e.completion.insertText};Event$1.once(this.model.onDidTrigger)((e=>{let t=[];Event$1.any(this.model.onDidTrigger,this.model.onDidCancel)((()=>{dispose(t),i()}),void 0,t),this.model.onDidSuggest((({completionModel:e})=>{if(dispose(t),0===e.items.length)return void i();const o=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.items),r=e.items[o];n(r)?(this.editor.pushUndoStop(),this._insertSuggestion({index:o,item:r,model:e},7)):i()}),void 0,t)})),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};SuggestController.ID="editor.contrib.suggestController",SuggestController=__decorate$I([__param$H(1,ISuggestMemoryService),__param$H(2,ICommandService),__param$H(3,IContextKeyService),__param$H(4,IInstantiationService),__param$H(5,ILogService),__param$H(6,ITelemetryService)],SuggestController);class PriorityRegistry{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(-1!==this._items.indexOf(e))throw new Error("Value is already registered");return this._items.push(e),this._items.sort(((e,t)=>this.prioritySelector(t)-this.prioritySelector(e))),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}class TriggerSuggestAction extends EditorAction{constructor(){super({id:TriggerSuggestAction.id,label:localize("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasCompletionItemProvider),kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,i){const n=SuggestController.get(t);if(!n)return;let o;i&&"object"==typeof i&&!0===i.auto&&(o=!0),n.triggerSuggest(void 0,o)}}TriggerSuggestAction.id="editor.action.triggerSuggest",registerEditorContribution(SuggestController.ID,SuggestController),registerEditorAction(TriggerSuggestAction);const weight$1=190,SuggestCommand=EditorCommand.bindToContribution(SuggestController.get);registerEditorCommand(new SuggestCommand({id:"acceptSelectedSuggestion",precondition:Context$2.Visible,handler(e){e.acceptSelectedSuggestion(!0,!1)}})),KeybindingsRegistry.registerKeybindingRule({id:"acceptSelectedSuggestion",when:ContextKeyExpr.and(Context$2.Visible,EditorContextKeys.textInputFocus),primary:2,weight:weight$1}),KeybindingsRegistry.registerKeybindingRule({id:"acceptSelectedSuggestion",when:ContextKeyExpr.and(Context$2.Visible,EditorContextKeys.textInputFocus,Context$2.AcceptSuggestionsOnEnter,Context$2.MakesTextEdit),primary:3,weight:weight$1}),MenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:localize("accept.insert","Insert")},group:"left",order:1,when:Context$2.HasInsertAndReplaceRange.toNegated()}),MenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:localize("accept.insert","Insert")},group:"left",order:1,when:ContextKeyExpr.and(Context$2.HasInsertAndReplaceRange,Context$2.InsertMode.isEqualTo("insert"))}),MenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu,{command:{id:"acceptSelectedSuggestion",title:localize("accept.replace","Replace")},group:"left",order:1,when:ContextKeyExpr.and(Context$2.HasInsertAndReplaceRange,Context$2.InsertMode.isEqualTo("replace"))}),registerEditorCommand(new SuggestCommand({id:"acceptAlternativeSelectedSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,EditorContextKeys.textInputFocus),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:1027,secondary:[1026]},handler(e){e.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$2.HasInsertAndReplaceRange,Context$2.InsertMode.isEqualTo("insert")),title:localize("accept.replace","Replace")},{menuId:suggestWidgetStatusbarMenu,group:"left",order:2,when:ContextKeyExpr.and(Context$2.HasInsertAndReplaceRange,Context$2.InsertMode.isEqualTo("replace")),title:localize("accept.insert","Insert")}]})),CommandsRegistry.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion"),registerEditorCommand(new SuggestCommand({id:"hideSuggestWidget",precondition:Context$2.Visible,handler:e=>e.cancelSuggestWidget(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:9,secondary:[1033]}})),registerEditorCommand(new SuggestCommand({id:"selectNextSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectNextSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),registerEditorCommand(new SuggestCommand({id:"selectNextPageSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectNextPageSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:12,secondary:[2060]}})),registerEditorCommand(new SuggestCommand({id:"selectLastSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectLastSuggestion()})),registerEditorCommand(new SuggestCommand({id:"selectPrevSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectPrevSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),registerEditorCommand(new SuggestCommand({id:"selectPrevPageSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectPrevPageSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:11,secondary:[2059]}})),registerEditorCommand(new SuggestCommand({id:"selectFirstSuggestion",precondition:ContextKeyExpr.and(Context$2.Visible,Context$2.MultipleSuggestions),handler:e=>e.selectFirstSuggestion()})),registerEditorCommand(new SuggestCommand({id:"toggleSuggestionDetails",precondition:Context$2.Visible,handler:e=>e.toggleSuggestionDetails(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$2.DetailsVisible,Context$2.CanResolve),title:localize("detail.more","show less")},{menuId:suggestWidgetStatusbarMenu,group:"right",order:1,when:ContextKeyExpr.and(Context$2.DetailsVisible.toNegated(),Context$2.CanResolve),title:localize("detail.less","show more")}]})),registerEditorCommand(new SuggestCommand({id:"toggleExplainMode",precondition:Context$2.Visible,handler:e=>e.toggleExplainMode(),kbOpts:{weight:100,primary:2133}})),registerEditorCommand(new SuggestCommand({id:"toggleSuggestionFocus",precondition:Context$2.Visible,handler:e=>e.toggleSuggestionFocus(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:2570,mac:{primary:778}}})),registerEditorCommand(new SuggestCommand({id:"insertBestCompletion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),WordContextKey.AtEnd,Context$2.Visible.toNegated(),SuggestAlternatives.OtherSuggestions.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:(e,t)=>{e.triggerSuggestAndAcceptBest(isObject(t)?Object.assign({fallback:"tab"},t):{fallback:"tab"})},kbOpts:{weight:weight$1,primary:2}})),registerEditorCommand(new SuggestCommand({id:"insertNextSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$2.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:e=>e.acceptNextSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:2}})),registerEditorCommand(new SuggestCommand({id:"insertPrevSuggestion",precondition:ContextKeyExpr.and(EditorContextKeys.textInputFocus,ContextKeyExpr.equals("config.editor.tabCompletion","on"),SuggestAlternatives.OtherSuggestions,Context$2.Visible.toNegated(),SnippetController2.InSnippetMode.toNegated()),handler:e=>e.acceptPrevSuggestion(),kbOpts:{weight:weight$1,kbExpr:EditorContextKeys.textInputFocus,primary:1026}})),registerEditorAction(class extends EditorAction{constructor(){super({id:"editor.action.resetSuggestSize",label:localize("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(e,t){var i;null===(i=SuggestController.get(t))||void 0===i||i.resetWidgetSize()}});class SuggestWidgetInlineCompletionProvider extends Disposable{constructor(e,t){super(),this.editor=e,this.suggestControllerPreselector=t,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new RunOnceScheduler((()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())}),100)),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const i=SuggestController.get(this.editor);if(i){this._register(i.registerSelector({priority:100,select:(e,t,n)=>{const o=this.editor.getModel(),r=minimizeInlineCompletion(o,this.suggestControllerPreselector());if(!r)return-1;const s=Position$1.lift(t),a=findMaxBy(n.map(((e,t)=>{const n=suggestionToSuggestItemInfo(i,s,e,this.isShiftKeyPressed),a=minimizeInlineCompletion(o,null==n?void 0:n.normalizedInlineCompletion);if(!a)return;return{index:t,valid:rangeStartsWith(r.range,a.range)&&r.text.startsWith(a.text),prefixLength:a.text.length,suggestItem:e}})).filter((e=>e&&e.valid)),compareBy((e=>e.prefixLength),numberComparator));return a?a.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(i.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(i.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)}))),this._register(i.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(Event$1.once(i.model.onDidTrigger)((e=>{t()})))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItem:this._currentSuggestItemInfo}}update(e){const t=this.getSuggestItemInfo();let i=!1;suggestItemInfoEquals(this._currentSuggestItemInfo,t)||(this._currentSuggestItemInfo=t,i=!0),this._isActive!==e&&(this._isActive=e,i=!0),i&&this.onDidChangeEmitter.fire()}getSuggestItemInfo(){const e=SuggestController.get(this.editor);if(!e)return;if(!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem();return t?suggestionToSuggestItemInfo(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=SuggestController.get(this.editor);e&&e.stopForceRenderingAbove()}forceRenderingAbove(){const e=SuggestController.get(this.editor);e&&e.forceRenderingAbove()}}function rangeStartsWith(e,t){return t.startLineNumber===e.startLineNumber&&t.startColumn===e.startColumn&&(t.endLineNumber<e.endLineNumber||t.endLineNumber===e.endLineNumber&&t.endColumn<=e.endColumn)}function suggestItemInfoEquals(e,t){return e===t||!(!e||!t)&&(e.completionItemKind===t.completionItemKind&&e.isSnippetText===t.isSnippetText&&normalizedInlineCompletionsEquals(e.normalizedInlineCompletion,t.normalizedInlineCompletion))}function suggestionToSuggestItemInfo(e,t,i,n){if(Array.isArray(i.completion.additionalTextEdits)&&i.completion.additionalTextEdits.length>0)return{completionItemKind:i.completion.kind,isSnippetText:!1,normalizedInlineCompletion:{range:Range$2.fromPositions(t,t),text:""}};let{insertText:o}=i.completion,r=!1;if(4&i.completion.insertTextRules){const i=(new SnippetParser).parse(o),n=e.editor.getModel();if(i.children.length>100)return;SnippetSession.adjustWhitespace(n,t,i,!0,!0),o=i.toString(),r=!0}const s=e.getOverwriteInfo(i,n);return{isSnippetText:r,completionItemKind:i.completion.kind,normalizedInlineCompletion:{text:o,range:Range$2.fromPositions(t.delta(0,-s.overwriteBefore),t.delta(0,Math.max(s.overwriteAfter,0)))}}}var __decorate$H=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$G=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$q=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let SuggestWidgetPreviewModel=class extends BaseGhostTextWidgetModel{constructor(e,t,i){super(e),this.cache=t,this.languageFeaturesService=i,this.suggestionInlineCompletionSource=this._register(new SuggestWidgetInlineCompletionProvider(this.editor,(()=>{var e,t;return null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()}))),this.updateOperation=this._register(new MutableDisposable),this.updateCacheSoon=this._register(new RunOnceScheduler((()=>this.updateCache()),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange((()=>{this.updateCacheSoon.schedule();this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);const e=this.ghostText;e&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,sum(e.parts.map((e=>e.lines.length-1))))),this.minReservedLineCount>=1?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()}))),this._register(this.cache.onDidChange((()=>{this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire()}))),this._register(toDisposable((()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove())))}get isActive(){return void 0!==this.suggestionInlineCompletionSource.state}isSuggestionPreviewEnabled(){return this.editor.getOption(106).preview}updateCache(){return __awaiter$q(this,void 0,void 0,(function*(){const e=this.suggestionInlineCompletionSource.state;if(!e||!e.selectedItem)return;const t={text:e.selectedItem.normalizedInlineCompletion.text,range:e.selectedItem.normalizedInlineCompletion.range,isSnippetText:e.selectedItem.isSnippetText,completionKind:e.selectedItem.completionItemKind},i=this.editor.getPosition(),n=createCancelablePromise((e=>__awaiter$q(this,void 0,void 0,(function*(){let n;try{n=yield provideInlineCompletions(this.languageFeaturesService.inlineCompletionsProvider,i,this.editor.getModel(),{triggerKind:InlineCompletionTriggerKind$1.Automatic,selectedSuggestionInfo:t},e)}catch(e2){return void onUnexpectedError(e2)}e.isCancellationRequested||(this.cache.setValue(this.editor,n,InlineCompletionTriggerKind$1.Automatic),this.onDidChangeEmitter.fire())})))),o=new UpdateOperation(n,InlineCompletionTriggerKind$1.Automatic);this.updateOperation.value=o,yield n,this.updateOperation.value===o&&this.updateOperation.clear()}))}get ghostText(){var e,t,i;const n=this.isSuggestionPreviewEnabled(),o=minimizeInlineCompletion(this.editor.getModel(),null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()),r=this.suggestionInlineCompletionSource.state,s=minimizeInlineCompletion(this.editor.getModel(),null===(i=null==r?void 0:r.selectedItem)||void 0===i?void 0:i.normalizedInlineCompletion),a=o&&s&&o.text.startsWith(s.text)&&o.range.equalsRange(s.range);if(!n&&!a)return;const l=a?o:s||o,d=a?l.text.length-s.text.length:0;return this.toGhostText(l,d)}toGhostText(e,t){const i=this.editor.getOptions().get(106).previewMode;return e?inlineCompletionToGhostText(e,this.editor.getModel(),i,this.editor.getPosition(),t)||new GhostText(e.range.endLineNumber,[],this.minReservedLineCount):void 0}};function sum(e){return e.reduce(((e,t)=>e+t),0)}function createDisposableRef(e,t){return{object:e,dispose:()=>null==t?void 0:t.dispose()}}SuggestWidgetPreviewModel=__decorate$H([__param$G(2,ILanguageFeaturesService)],SuggestWidgetPreviewModel);var __decorate$G=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$F=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$p=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class DelegatingModel extends Disposable{constructor(){super(...arguments),this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new MutableDisposable)}get targetModel(){var e;return null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object}setTargetModel(e){var t;(null===(t=this.currentModelRef.value)||void 0===t?void 0:t.object)!==e&&(this.currentModelRef.clear(),this.currentModelRef.value=e?createDisposableRef(e,e.onDidChange((()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()}))):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}get ghostText(){var e,t;return this.hasCachedGhostText||(this.cachedGhostText=null===(t=null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object)||void 0===t?void 0:t.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}setExpanded(e){var t;null===(t=this.targetModel)||void 0===t||t.setExpanded(e)}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}}let GhostTextModel=class extends DelegatingModel{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.sharedCache=this._register(new SharedInlineCompletionCache),this.suggestWidgetAdapterModel=this._register(this.instantiationService.createInstance(SuggestWidgetPreviewModel,this.editor,this.sharedCache)),this.inlineCompletionsModel=this._register(this.instantiationService.createInstance(InlineCompletionsModel,this.editor,this.sharedCache)),this._register(this.suggestWidgetAdapterModel.onDidChange((()=>{this.updateModel()}))),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(e){var t;const i=null===(t=this.activeInlineCompletionsModel)||void 0===t?void 0:t.ghostText;return!!i&&i.parts.some((t=>e.containsPosition(new Position$1(i.lineNumber,t.column))))}triggerInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.trigger(InlineCompletionTriggerKind$1.Explicit)}commitInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.commitCurrentSuggestion()}hideInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.hide()}showNextInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showNext()}showPreviousInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showPrevious()}hasMultipleInlineCompletions(){var e;return __awaiter$p(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeInlineCompletionsModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};GhostTextModel=__decorate$G([__param$F(1,IInstantiationService)],GhostTextModel);class SharedInlineCompletionCache extends Disposable{constructor(){super(...arguments),this.onDidChangeEmitter=new Emitter$1,this.onDidChange=this.onDidChangeEmitter.event,this.cache=this._register(new MutableDisposable)}get value(){return this.cache.value}setValue(e,t,i){this.cache.value=new SynchronizedInlineCompletionsCache(e,t,(()=>this.onDidChangeEmitter.fire()),i)}clearAndLeak(){return this.cache.clearAndLeak()}clear(){this.cache.clear()}}var ghostText="",__decorate$F=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$E=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},_a$3;const ttPolicy$2=null===(_a$3=window.trustedTypes)||void 0===_a$3?void 0:_a$3.createPolicy("editorGhostText",{createHTML:e=>e});let GhostTextWidget=class extends Disposable{constructor(e,t,i,n){super(),this.editor=e,this.model=t,this.instantiationService=i,this.languageService=n,this.disposed=!1,this.partsWidget=this._register(this.instantiationService.createInstance(DecorationsWidget,this.editor)),this.additionalLinesWidget=this._register(new AdditionalLinesWidget(this.editor,this.languageService.languageIdCodec)),this.viewMoreContentWidget=void 0,this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(29)||e.hasChanged(105)||e.hasChanged(88)||e.hasChanged(83)||e.hasChanged(45)||e.hasChanged(44)||e.hasChanged(59))&&this.update()}))),this._register(toDisposable((()=>{var e;this.disposed=!0,this.update(),null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0}))),this._register(t.onDidChange((()=>{this.update()}))),this.update()}shouldShowHoverAtViewZone(e){return this.additionalLinesWidget.viewZoneId===e}update(){var e;const t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed)return this.partsWidget.clear(),void this.additionalLinesWidget.clear();const i=new Array,n=new Array;function o(e,t){if(n.length>0){const i=n[n.length-1];t&&i.decorations.push(new LineDecoration(i.content.length+1,i.content.length+1+e[0].length,t,0)),i.content+=e[0],e=e.slice(1)}for(const i of e)n.push({content:i,decorations:t?[new LineDecoration(1,i.length+1,t,0)]:[]})}const r=this.editor.getModel().getLineContent(t.lineNumber);let s;this.editor.getModel().getLineTokens(t.lineNumber);let a=0;for(const l of t.parts){let e=l.lines;void 0===s?(i.push({column:l.column,text:e[0],preview:l.preview}),e=e.slice(1)):o([r.substring(a,l.column-1)],void 0),e.length>0&&(o(e,"ghost-text"),void 0===s&&l.column<=r.length&&(s=l.column)),a=l.column-1}void 0!==s&&o([r.substring(a)],void 0),this.partsWidget.setParts(t.lineNumber,i,void 0!==s?{column:s,length:r.length+1-s}:void 0),this.additionalLinesWidget.updateLines(t.lineNumber,n,t.additionalReservedLineCount),t.parts.some((e=>e.lines.length<0))?this.viewMoreContentWidget=this.renderViewMoreLines(new Position$1(t.lineNumber,this.editor.getModel().getLineMaxColumn(t.lineNumber)),"",0):(null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0)}renderViewMoreLines(e,t,i){const n=this.editor.getOption(44),o=document.createElement("div");o.className="suggest-preview-additional-widget",applyFontInfo(o,n);const r=document.createElement("span");r.className="content-spacer",r.append(t),o.append(r);const s=document.createElement("span");s.className="content-newline suggest-preview-text",s.append("⏎  "),o.append(s);const a=new DisposableStore,l=document.createElement("div");return l.className="button suggest-preview-text",l.append(`+${i} lines…`),a.add(addStandardDisposableListener(l,"mousedown",(e=>{var t;null===(t=this.model)||void 0===t||t.setExpanded(!0),e.preventDefault(),this.editor.focus()}))),o.append(l),new ViewMoreLinesContentWidget(this.editor,e,o,a)}};GhostTextWidget=__decorate$F([__param$E(2,IInstantiationService),__param$E(3,ILanguageService)],GhostTextWidget);class DecorationsWidget{constructor(e){this.editor=e,this.decorationIds=[],this.disposableStore=new DisposableStore}dispose(){this.clear(),this.disposableStore.dispose()}clear(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}setParts(e,t,i){this.disposableStore.clear();if(!this.editor.getModel())return;const n=new Array;i&&n.push({range:Range$2.fromPositions(new Position$1(e,i.column),new Position$1(e,i.column+i.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}}),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,t.map((t=>({range:Range$2.fromPositions(new Position$1(e,t.column)),options:{description:"ghost-text",after:{content:t.text,inlineClassName:t.preview?"ghost-text-decoration-preview":"ghost-text-decoration"},showIfCollapsed:!0}}))).concat(n))}}class AdditionalLinesWidget{constructor(e,t){this.editor=e,this.languageIdCodec=t,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:o}=n.getOptions();this.editor.changeViewZones((n=>{this._viewZoneId&&(n.removeZone(this._viewZoneId),this._viewZoneId=void 0);const r=Math.max(t.length,i);if(r>0){const i=document.createElement("div");renderLines(i,o,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=n.addZone({afterLineNumber:e,heightInLines:r,domNode:i,afterColumnAffinity:1})}}))}}function renderLines(e,t,i,n,o){const r=n.get(29),s=n.get(105),a=n.get(83),l=n.get(45),d=n.get(44),c=n.get(59),h=createStringBuilder(1e4);h.appendASCIIString('<div class="suggest-preview-text">');for(let p=0,m=i.length;p<m;p++){const e=i[p],n=e.content;h.appendASCIIString('<div class="view-line'),h.appendASCIIString('" style="top:'),h.appendASCIIString(String(p*c)),h.appendASCIIString('px;width:1000000px;">');const u=isBasicASCII(n),g=containsRTL(n),m=LineTokens.createEmpty(n,o);renderViewLine(new RenderLineInput(d.isMonospace&&!r,d.canUseHalfwidthRightwardsArrow,n,!1,u,g,0,m,e.decorations,t,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,s,"none",a,l!==EditorFontLigatures.OFF,null),h),h.appendASCIIString("</div>")}h.appendASCIIString("</div>"),applyFontInfo(e,d);const u=h.build(),g=ttPolicy$2?ttPolicy$2.createHTML(u):u;e.innerHTML=g}class ViewMoreLinesContentWidget extends Disposable{constructor(e,t,i,n){super(),this.editor=e,this.position=t,this.domNode=i,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(n),this._register(toDisposable((()=>{this.editor.removeContentWidget(this)}))),this.editor.addContentWidget(this)}getId(){return"editor.widget.viewMoreLinesWidget"}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}}registerThemingParticipant(((e,t)=>{const i=e.getColor(ghostTextForeground);i&&(t.addRule(`.monaco-editor .ghost-text-decoration { color: ${i.toString()} !important; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${i.toString()} !important; }`),t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { color: ${i.toString()} !important; }`));const n=e.getColor(ghostTextBackground);n&&(t.addRule(`.monaco-editor .ghost-text-decoration { background-color: ${n.toString()}; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { background-color: ${n.toString()}; }`),t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { background-color: ${n.toString()}; }`));const o=e.getColor(ghostTextBorder);o&&(t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${o}; }`),t.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${o}; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${o}; }`))}));var __decorate$E=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$D=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$o=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let GhostTextController=class e extends Disposable{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.triggeredExplicitly=!1,this.activeController=this._register(new MutableDisposable),this.activeModelDidChangeEmitter=this._register(new Emitter$1),this._register(this.editor.onDidChangeModel((()=>{this.updateModelController()}))),this._register(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(106)&&this.updateModelController(),e.hasChanged(55)&&this.updateModelController()}))),this.updateModelController()}static get(t){return t.getContribution(e.ID)}get activeModel(){var e;return null===(e=this.activeController.value)||void 0===e?void 0:e.model}updateModelController(){const e=this.editor.getOption(106),t=this.editor.getOption(55);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(ActiveGhostTextController,this.editor):void 0,this.activeModelDidChangeEmitter.fire()}shouldShowHoverAt(e){var t;return(null===(t=this.activeModel)||void 0===t?void 0:t.shouldShowHoverAt(e))||!1}shouldShowHoverAtViewZone(e){var t,i;return(null===(i=null===(t=this.activeController.value)||void 0===t?void 0:t.widget)||void 0===i?void 0:i.shouldShowHoverAtViewZone(e))||!1}trigger(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),null===(e=this.activeModel)||void 0===e||e.triggerInlineCompletion()}commit(){var e;null===(e=this.activeModel)||void 0===e||e.commitInlineCompletion()}hide(){var e;null===(e=this.activeModel)||void 0===e||e.hideInlineCompletion()}showNextInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showNextInlineCompletion()}showPreviousInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return __awaiter$o(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};GhostTextController.inlineSuggestionVisible=new RawContextKey("inlineSuggestionVisible",!1,localize("inlineSuggestionVisible","Whether an inline suggestion is visible")),GhostTextController.inlineSuggestionHasIndentation=new RawContextKey("inlineSuggestionHasIndentation",!1,localize("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),GhostTextController.inlineSuggestionHasIndentationLessThanTabSize=new RawContextKey("inlineSuggestionHasIndentationLessThanTabSize",!0,localize("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),GhostTextController.ID="editor.contrib.ghostTextController",GhostTextController=__decorate$E([__param$D(1,IInstantiationService)],GhostTextController);class GhostTextContextKeys{constructor(e){this.contextKeyService=e,this.inlineCompletionVisible=GhostTextController.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=GhostTextController.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=GhostTextController.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)}}let ActiveGhostTextController=class extends Disposable{constructor(e,t,i){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.contextKeys=new GhostTextContextKeys(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(GhostTextModel,this.editor)),this.widget=this._register(this.instantiationService.createInstance(GhostTextWidget,this.editor,this.model)),this._register(toDisposable((()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)}))),this._register(this.model.onDidChange((()=>{this.updateContextKeys()}))),this.updateContextKeys()}updateContextKeys(){var e;this.contextKeys.inlineCompletionVisible.set(void 0!==(null===(e=this.model.activeInlineCompletionsModel)||void 0===e?void 0:e.ghostText));let t=!1,i=!0;const n=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&n&&n.parts.length>0){const{column:e,lines:o}=n.parts[0],r=o[0];if(e<=this.editor.getModel().getLineIndentColumn(n.lineNumber)){let e=firstNonWhitespaceIndex(r);-1===e&&(e=r.length-1),t=e>0;const n=this.editor.getModel().getOptions().tabSize;i=CursorColumns.visibleColumnFromColumn(r,e+1,n)<n}}this.contextKeys.inlineCompletionSuggestsIndentation.set(t),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(i)}};ActiveGhostTextController=__decorate$E([__param$D(1,IInstantiationService),__param$D(2,IContextKeyService)],ActiveGhostTextController);const GhostTextCommand=EditorCommand.bindToContribution(GhostTextController.get),commitInlineSuggestionAction=new GhostTextCommand({id:inlineSuggestCommitId,precondition:GhostTextController.inlineSuggestionVisible,handler(e){e.commit(),e.editor.focus()}});registerEditorCommand(commitInlineSuggestionAction),KeybindingsRegistry.registerKeybindingRule({primary:2,weight:200,id:commitInlineSuggestionAction.id,when:ContextKeyExpr.and(commitInlineSuggestionAction.precondition,EditorContextKeys.tabMovesFocus.toNegated(),GhostTextController.inlineSuggestionHasIndentationLessThanTabSize)}),registerEditorCommand(new GhostTextCommand({id:"editor.action.inlineSuggest.hide",precondition:GhostTextController.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler(e){e.hide()}}));class ShowNextInlineSuggestionAction extends EditorAction{constructor(){super({id:ShowNextInlineSuggestionAction.ID,label:localize("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,GhostTextController.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(e,t){return __awaiter$o(this,void 0,void 0,(function*(){const e=GhostTextController.get(t);e&&(e.showNextInlineCompletion(),t.focus())}))}}ShowNextInlineSuggestionAction.ID="editor.action.inlineSuggest.showNext";class ShowPreviousInlineSuggestionAction extends EditorAction{constructor(){super({id:ShowPreviousInlineSuggestionAction.ID,label:localize("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:ContextKeyExpr.and(EditorContextKeys.writable,GhostTextController.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(e,t){return __awaiter$o(this,void 0,void 0,(function*(){const e=GhostTextController.get(t);e&&(e.showPreviousInlineCompletion(),t.focus())}))}}ShowPreviousInlineSuggestionAction.ID="editor.action.inlineSuggest.showPrevious";class TriggerInlineSuggestionAction extends EditorAction{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:localize("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:EditorContextKeys.writable})}run(e,t){return __awaiter$o(this,void 0,void 0,(function*(){const e=GhostTextController.get(t);e&&e.trigger()}))}}var __decorate$D=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$C=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class InlineCompletionsHover{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}}let InlineCompletionsHoverParticipant=class{constructor(e,t,i,n,o,r,s){this._editor=e,this._commandService=t,this._menuService=i,this._contextKeyService=n,this._languageService=o,this._openerService=r,this.accessibilityService=s,this.hoverOrdinal=3}suggestHoverAnchor(e){const t=GhostTextController.get(this._editor);if(!t)return null;const i=e.target;if(8===i.type){const e=i.detail;if(t.shouldShowHoverAtViewZone(e.viewZoneId))return new HoverForeignElementAnchor(1e3,this,Range$2.fromPositions(e.positionBefore||e.position,e.positionBefore||e.position))}if(7===i.type&&t.shouldShowHoverAt(i.range))return new HoverForeignElementAnchor(1e3,this,i.range);if(6===i.type){if(i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new HoverForeignElementAnchor(1e3,this,i.range)}return null}computeSync(e,t){const i=GhostTextController.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new InlineCompletionsHover(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new DisposableStore,n=t[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(e,n,i);const o=i.add(this._menuService.createMenu(MenuId.InlineCompletionsActions,this._contextKeyService)),r=e.statusBar.addAction({label:localize("showNextInlineSuggestion","Next"),commandId:ShowNextInlineSuggestionAction.ID,run:()=>this._commandService.executeCommand(ShowNextInlineSuggestionAction.ID)}),s=e.statusBar.addAction({label:localize("showPreviousInlineSuggestion","Previous"),commandId:ShowPreviousInlineSuggestionAction.ID,run:()=>this._commandService.executeCommand(ShowPreviousInlineSuggestionAction.ID)});e.statusBar.addAction({label:localize("acceptInlineSuggestion","Accept"),commandId:commitInlineSuggestionAction.id,run:()=>this._commandService.executeCommand(commitInlineSuggestionAction.id)});const a=[r,s];for(const l of a)l.setEnabled(!1);n.hasMultipleSuggestions().then((e=>{for(const t of a)t.setEnabled(e)}));for(const[l,d]of o.getActions())for(const t of d)t instanceof MenuItemAction&&e.statusBar.addAction({label:t.label,commandId:t.item.id,run:()=>this._commandService.executeCommand(t.item.id)});return i}renderScreenReaderText(e,t,i){var n,o;const r=$$c,s=r("div.hover-row.markdown-hover"),a=append$1(s,r("div.hover-contents")),l=i.add(new MarkdownRenderer({editor:this._editor},this._languageService,this._openerService)),d=null===(o=null===(n=t.controller.activeModel)||void 0===n?void 0:n.inlineCompletionsModel)||void 0===o?void 0:o.ghostText;if(d){const t=this._editor.getModel().getLineContent(d.lineNumber);(t=>{i.add(l.onDidRenderAsync((()=>{a.className="hover-contents code-hover-contents",e.onContentsChanged()})));const n=localize("inlineSuggestionFollows","Suggestion:"),o=i.add(l.render((new MarkdownString).appendText(n).appendCodeblock("text",t)));a.replaceChildren(o.element)})(d.renderForScreenReader(t))}e.fragment.appendChild(s)}};function getSpaceCnt(e,t){let i=0;for(let n=0;n<e.length;n++)"\t"===e.charAt(n)?i+=t:i++;return i}function generateIndent(e,t,i){e=e<0?0:e;let n="";if(!i){let i=Math.floor(e/t);e%=t;for(let e=0;e<i;e++)n+="\t"}for(let o=0;o<e;o++)n+=" ";return n}function getReindentEditOperations(e,t,i,n,o){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return[];const r=t.getLanguageConfiguration(e.getLanguageId()).indentationRules;if(!r)return[];for(n=Math.min(n,e.getLineCount());i<=n&&r.unIndentedLinePattern;){let t=e.getLineContent(i);if(!r.unIndentedLinePattern.test(t))break;i++}if(i>n-1)return[];const{tabSize:s,indentSize:a,insertSpaces:l}=e.getOptions(),d=(e,t)=>(t=t||1,ShiftCommand.shiftIndent(e,e.length+t,s,a,l)),c=(e,t)=>(t=t||1,ShiftCommand.unshiftIndent(e,e.length+t,s,a,l));let h,u=[],g=e.getLineContent(i),p=g;if(null!=o){h=o;let e=getLeadingWhitespace(g);p=h+g.substring(e.length),r.decreaseIndentPattern&&r.decreaseIndentPattern.test(p)&&(h=c(h),p=h+g.substring(e.length)),g!==p&&u.push(EditOperation.replaceMove(new Selection$1(i,1,i,e.length+1),normalizeIndentation(h,a,l)))}else h=getLeadingWhitespace(g);let m=h;r.increaseIndentPattern&&r.increaseIndentPattern.test(p)?(m=d(m),h=d(h)):r.indentNextLinePattern&&r.indentNextLinePattern.test(p)&&(m=d(m));for(let f=++i;f<=n;f++){let t=e.getLineContent(f),i=getLeadingWhitespace(t),n=m+t.substring(i.length);r.decreaseIndentPattern&&r.decreaseIndentPattern.test(n)&&(m=c(m),h=c(h)),i!==m&&u.push(EditOperation.replaceMove(new Selection$1(f,1,f,i.length+1),normalizeIndentation(m,a,l))),r.unIndentedLinePattern&&r.unIndentedLinePattern.test(t)||(r.increaseIndentPattern&&r.increaseIndentPattern.test(n)?(h=d(h),m=h):m=r.indentNextLinePattern&&r.indentNextLinePattern.test(n)?d(m):h)}return u}InlineCompletionsHoverParticipant=__decorate$D([__param$C(1,ICommandService),__param$C(2,IMenuService),__param$C(3,IContextKeyService),__param$C(4,ILanguageService),__param$C(5,IOpenerService),__param$C(6,IAccessibilityService)],InlineCompletionsHoverParticipant),registerEditorContribution(GhostTextController.ID,GhostTextController),registerEditorAction(TriggerInlineSuggestionAction),registerEditorAction(ShowNextInlineSuggestionAction),registerEditorAction(ShowPreviousInlineSuggestionAction),HoverParticipantRegistry.register(InlineCompletionsHoverParticipant);class IndentationToSpacesAction extends EditorAction{constructor(){super({id:IndentationToSpacesAction.ID,label:localize("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:EditorContextKeys.writable})}run(e,t){let i=t.getModel();if(!i)return;let n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new IndentationToSpacesCommand(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}}IndentationToSpacesAction.ID="editor.action.indentationToSpaces";class IndentationToTabsAction extends EditorAction{constructor(){super({id:IndentationToTabsAction.ID,label:localize("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:EditorContextKeys.writable})}run(e,t){let i=t.getModel();if(!i)return;let n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new IndentationToTabsCommand(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}}IndentationToTabsAction.ID="editor.action.indentationToTabs";class ChangeIndentationSizeAction extends EditorAction{constructor(e,t){super(t),this.insertSpaces=e}run(e,t){const i=e.get(IQuickInputService),n=e.get(IModelService);let o=t.getModel();if(!o)return;const r=n.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget),s=[1,2,3,4,5,6,7,8].map((e=>({id:e.toString(),label:e.toString(),description:e===r.tabSize?localize("configuredTabSize","Configured Tab Size"):void 0}))),a=Math.min(o.getOptions().tabSize-1,7);setTimeout((()=>{i.pick(s,{placeHolder:localize({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:s[a]}).then((e=>{e&&o&&!o.isDisposed()&&o.updateOptions({tabSize:parseInt(e.label,10),insertSpaces:this.insertSpaces})}))}),50)}}class IndentUsingTabs extends ChangeIndentationSizeAction{constructor(){super(!1,{id:IndentUsingTabs.ID,label:localize("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}IndentUsingTabs.ID="editor.action.indentUsingTabs";class IndentUsingSpaces extends ChangeIndentationSizeAction{constructor(){super(!0,{id:IndentUsingSpaces.ID,label:localize("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}IndentUsingSpaces.ID="editor.action.indentUsingSpaces";class DetectIndentation extends EditorAction{constructor(){super({id:DetectIndentation.ID,label:localize("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(e,t){const i=e.get(IModelService);let n=t.getModel();if(!n)return;const o=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(o.insertSpaces,o.tabSize)}}DetectIndentation.ID="editor.action.detectIndentation";class ReindentLinesAction extends EditorAction{constructor(){super({id:"editor.action.reindentlines",label:localize("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:EditorContextKeys.writable})}run(e,t){const i=e.get(ILanguageConfigurationService);let n=t.getModel();if(!n)return;let o=getReindentEditOperations(n,i,1,n.getLineCount());o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class ReindentSelectedLinesAction extends EditorAction{constructor(){super({id:"editor.action.reindentselectedlines",label:localize("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:EditorContextKeys.writable})}run(e,t){const i=e.get(ILanguageConfigurationService);let n=t.getModel();if(!n)return;let o=t.getSelections();if(null===o)return;let r=[];for(let s of o){let e=s.startLineNumber,t=s.endLineNumber;if(e!==t&&1===s.endColumn&&t--,1===e){if(e===t)continue}else e--;let o=getReindentEditOperations(n,i,e,t);r.push(...o)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class AutoIndentOnPasteCommand{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(let i of e)i.range&&"string"==typeof i.text&&this._edits.push(i)}getEditOperations(e,t){for(let n of this._edits)t.addEditOperation(Range$2.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class AutoIndentOnPaste{constructor(e){this.callOnDispose=new DisposableStore,this.callOnModel=new DisposableStore,this.editor=e,this.callOnDispose.add(e.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(9)<4||this.editor.getOption(48)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range:e})=>{this.trigger(e)})))}trigger(e){let t=this.editor.getSelections();if(null===t||t.length>1)return;const i=this.editor.getModel();if(!i)return;if(!i.isCheapToTokenize(e.getStartPosition().lineNumber))return;const n=this.editor.getOption(9),{tabSize:o,indentSize:r,insertSpaces:s}=i.getOptions();let a=[],l={shiftIndent:e=>ShiftCommand.shiftIndent(e,e.length+1,o,r,s),unshiftIndent:e=>ShiftCommand.unshiftIndent(e,e.length+1,o,r,s)},d=e.startLineNumber;for(;d<=e.endLineNumber&&this.shouldIgnoreLine(i,d);)d++;if(d>e.endLineNumber)return;let c=i.getLineContent(d);if(!/\S/.test(c.substring(0,e.startColumn-1))){const e=LanguageConfigurationRegistry.getGoodIndentForLine(n,i,i.getLanguageId(),d,l);if(null!==e){let t=getLeadingWhitespace(c),n=getSpaceCnt(e,o);if(n!==getSpaceCnt(t,o)){let e=generateIndent(n,o,s);a.push({range:new Range$2(d,1,d,t.length+1),text:e}),c=e+c.substr(t.length)}else{let e=LanguageConfigurationRegistry.getIndentMetadata(i,d);if(0===e||8===e)return}}}const h=d;for(;d<e.endLineNumber&&!/\S/.test(i.getLineContent(d+1));)d++;if(d!==e.endLineNumber){let t={getLineTokens:e=>i.getLineTokens(e),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(e,t)=>i.getLanguageIdAtPosition(e,t),getLineContent:e=>e===h?c:i.getLineContent(e)},r=LanguageConfigurationRegistry.getGoodIndentForLine(n,t,i.getLanguageId(),d+1,l);if(null!==r){let t=getSpaceCnt(r,o),n=getSpaceCnt(getLeadingWhitespace(i.getLineContent(d+1)),o);if(t!==n){let r=t-n;for(let t=d+1;t<=e.endLineNumber;t++){let e=getLeadingWhitespace(i.getLineContent(t)),n=generateIndent(getSpaceCnt(e,o)+r,o,s);n!==e&&a.push({range:new Range$2(t,1,t,e.length+1),text:n})}}}}if(a.length>0){this.editor.pushUndoStop();let e=new AutoIndentOnPasteCommand(a,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.forceTokenization(t);let i=e.getLineFirstNonWhitespaceColumn(t);if(0===i)return!0;let n=e.getLineTokens(t);if(n.getCount()>0){let e=n.findTokenIndexAtOffset(i);if(e>=0&&1===n.getStandardTokenType(e))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}}function getIndentationEditOperations(e,t,i,n){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return;let o="";for(let s=0;s<i;s++)o+=" ";let r=new RegExp(o,"gi");for(let s=1,a=e.getLineCount();s<=a;s++){let i=e.getLineFirstNonWhitespaceColumn(s);if(0===i&&(i=e.getLineMaxColumn(s)),1===i)continue;const a=new Range$2(s,1,s,i),l=e.getValueInRange(a),d=n?l.replace(/\t/gi,o):l.replace(r,"\t");t.addEditOperation(a,d)}}AutoIndentOnPaste.ID="editor.contrib.autoIndentOnPaste";class IndentationToSpacesCommand{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),getIndentationEditOperations(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class IndentationToTabsCommand{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),getIndentationEditOperations(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}registerEditorContribution(AutoIndentOnPaste.ID,AutoIndentOnPaste),registerEditorAction(IndentationToSpacesAction),registerEditorAction(IndentationToTabsAction),registerEditorAction(IndentUsingTabs),registerEditorAction(IndentUsingSpaces),registerEditorAction(DetectIndentation),registerEditorAction(ReindentLinesAction),registerEditorAction(ReindentSelectedLinesAction);var __awaiter$n=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class InlayHintAnchor{constructor(e,t){this.range=e,this.direction=t}}class InlayHintItem{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new InlayHintItem(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}resolve(e){return __awaiter$n(this,void 0,void 0,(function*(){if("function"==typeof this.provider.resolveInlayHint){if(this._currentResolve){if(yield this._currentResolve,e.isCancellationRequested)return;return this.resolve(e)}this._isResolved||(this._currentResolve=this._doResolve(e).finally((()=>this._currentResolve=void 0))),yield this._currentResolve}}))}_doResolve(e){var t,i;return __awaiter$n(this,void 0,void 0,(function*(){try{const n=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=null!==(t=null==n?void 0:n.tooltip)&&void 0!==t?t:this.hint.tooltip,this.hint.label=null!==(i=null==n?void 0:n.label)&&void 0!==i?i:this.hint.label,this._isResolved=!0}catch(n){onUnexpectedExternalError(n),this._isResolved=!1}}))}}class InlayHintsFragments{constructor(e,t,i){this._disposables=new DisposableStore,this.ranges=e,this.provider=new Set;const n=[];for(const[o,r]of t){this._disposables.add(o),this.provider.add(r);for(const e of o.hints){let t=i.validatePosition(e.position),o="before";const s=InlayHintsFragments._getRangeAtPosition(i,t);let a;s.getStartPosition().isBefore(t)?(a=Range$2.fromPositions(s.getStartPosition(),t),o="after"):(a=Range$2.fromPositions(t,s.getEndPosition()),o="before"),n.push(new InlayHintItem(e,new InlayHintAnchor(a,o),r))}}this.items=n.sort(((e,t)=>Position$1.compare(e.hint.position,t.hint.position)))}static create(e,t,i,n){return __awaiter$n(this,void 0,void 0,(function*(){const o=[],r=e.ordered(t).reverse().map((e=>i.map((i=>__awaiter$n(this,void 0,void 0,(function*(){try{const r=yield e.provideInlayHints(t,i,n);(null==r?void 0:r.hints.length)&&o.push([r,e])}catch(r){onUnexpectedExternalError(r)}}))))));if(yield Promise.all(r.flat()),n.isCancellationRequested||t.isDisposed())throw new CancellationError;return new InlayHintsFragments(i,o,t)}))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new Range$2(i,n.startColumn,i,n.endColumn);e.tokenizeIfCheap(i);const o=e.getLineTokens(i),r=t.column-1,s=o.findTokenIndexAtOffset(r);let a=o.getStartOffset(s),l=o.getEndOffset(s);return l-a==1&&(a===r&&s>1?(a=o.getStartOffset(s-1),l=o.getEndOffset(s-1)):l===r&&s<o.getCount()-1&&(a=o.getStartOffset(s+1),l=o.getEndOffset(s+1))),new Range$2(i,a+1,i,l+1)}}function asCommandLink(e){return URI.from({scheme:Schemas.command,path:e.id,query:e.arguments&&encodeURIComponent(JSON.stringify(e.arguments))}).toString()}var __awaiter$m=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function showGoToContextMenu(e,t,i,n){var o;return __awaiter$m(this,void 0,void 0,(function*(){const r=e.get(ITextModelService),s=e.get(IContextMenuService),a=e.get(ICommandService),l=e.get(IInstantiationService),d=e.get(INotificationService);if(yield n.item.resolve(CancellationToken.None),!n.part.location)return;const c=n.part.location,h=[],u=new Set(MenuRegistry.getMenuItems(MenuId.EditorContext).map((e=>isIMenuItem(e)?e.command.id:"")));for(const e of EditorExtensionsRegistry.getEditorActions())e instanceof SymbolNavigationAction&&u.has(e.id)&&h.push(new Action(e.id,e.label,void 0,!0,(()=>__awaiter$m(this,void 0,void 0,(function*(){const i=yield r.createModelReference(c.uri);try{yield l.invokeFunction(e.run.bind(e),t,new SymbolNavigationAnchor(i.object.textEditorModel,Range$2.getStartPosition(c.range)))}finally{i.dispose()}})))));if(n.part.command){const{command:e}=n.part;h.push(new Separator),h.push(new Action(e.id,e.title,void 0,!0,(()=>__awaiter$m(this,void 0,void 0,(function*(){var t;try{yield a.executeCommand(e.id,...null!==(t=e.arguments)&&void 0!==t?t:[])}catch(i){d.notify({severity:Severity.Error,source:n.item.provider.displayName,message:i})}})))))}const g=t.getOption(115);s.showContextMenu({domForShadowRoot:g&&null!==(o=t.getDomNode())&&void 0!==o?o:void 0,getAnchor:()=>{const e=getDomNodePagePosition(i);return{x:e.left,y:e.top+e.height+8}},getActions:()=>h,onHide:()=>{t.focus()},autoSelectFirstItem:!0})}))}function goToDefinitionWithLocation(e,t,i,n){return __awaiter$m(this,void 0,void 0,(function*(){const o=e.get(ITextModelService),r=yield o.createModelReference(n.uri);yield i.invokeWithinContext((e=>__awaiter$m(this,void 0,void 0,(function*(){const o=t.hasSideBySideModifier,s=e.get(IContextKeyService),a=PeekContext.inPeekEditor.getValue(s),l=!o&&i.getOption(78)&&!a;return new DefinitionAction({openToSide:o,openInPeek:l,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(e,i,{model:r.object.textEditorModel,position:Range$2.getStartPosition(n.range)})})))),r.dispose()}))}var __decorate$C=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$B=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$l=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class InlayHintsCache{constructor(){this._entries=new LRUCache(50)}get(e){const t=InlayHintsCache._key(e);return this._entries.get(t)}set(e,t){const i=InlayHintsCache._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const IInlayHintsCache=createDecorator("IInlayHintsCache");registerSingleton(IInlayHintsCache,InlayHintsCache,!0);class RenderedInlayHintLabelPart{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return"string"==typeof e?{label:e}:e[this.index]}}class ActiveInlayHintInfo{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}let InlayHintsController=class e{constructor(e,t,i,n,o,r,s){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=o,this._notificationService=r,this._instaService=s,this._disposables=new DisposableStore,this._sessionDisposables=new DisposableStore,this._decorationsMetadata=new Map,this._ruleFactory=new DynamicCssRules(this._editor),this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(127)&&this._update()}))),this._update()}static get(t){var i;return null!==(i=t.getContribution(e.ID))&&void 0!==i?i:void 0}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){if(this._sessionDisposables.clear(),this._removeAllDecorations(),!this._editor.getOption(127).enabled)return;const e=this._editor.getModel();if(!e||!this._languageFeaturesService.inlayHintsProvider.has(e))return;const t=this._inlayHintsCache.get(e);let i;t&&this._updateHintsDecorators([e.getFullModelRange()],t),this._sessionDisposables.add(toDisposable((()=>{e.isDisposed()||this._cacheHintsForFastRestore(e)})));let n=new Set;const o=new RunOnceScheduler((()=>__awaiter$l(this,void 0,void 0,(function*(){const t=Date.now();null==i||i.dispose(!0),i=new CancellationTokenSource$1;const r=e.onWillDispose((()=>null==i?void 0:i.cancel()));try{const s=i.token,a=yield InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider,e,this._getHintsRanges(),s);if(o.delay=this._debounceInfo.update(e,Date.now()-t),s.isCancellationRequested)return void a.dispose();for(const e of a.provider)"function"!=typeof e.onDidChangeInlayHints||n.has(e)||(n.add(e),this._sessionDisposables.add(e.onDidChangeInlayHints((()=>{o.isScheduled()||o.schedule()}))));this._sessionDisposables.add(a),this._updateHintsDecorators(a.ranges,a.items),this._cacheHintsForFastRestore(e)}catch(s){onUnexpectedError(s)}finally{i.dispose(),r.dispose()}}))),this._debounceInfo.get(e));this._sessionDisposables.add(o),this._sessionDisposables.add(toDisposable((()=>null==i?void 0:i.dispose(!0)))),o.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((e=>{!e.scrollTopChanged&&o.isScheduled()||o.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((e=>{const t=Math.max(o.delay,1250);o.schedule(t)}))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installDblClickGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new DisposableStore,t=e.add(new ClickLinkGesture(this._editor)),i=new DisposableStore;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown((e=>{const[t]=e,n=this._getInlayHintLabelPart(t),o=this._editor.getModel();if(!n||!o)return void i.clear();const r=new CancellationTokenSource$1;i.add(toDisposable((()=>r.dispose(!0)))),n.item.resolve(r.token),this._activeInlayHintPart=n.part.command||n.part.location?new ActiveInlayHintInfo(n,t.hasTriggerModifier):void 0;const s=n.item.hint.position.lineNumber,a=new Range$2(s,1,s,o.getLineMaxColumn(s)),l=new Set;for(const i of this._decorationsMetadata.values())a.containsRange(i.item.anchor.range)&&l.add(i.item);this._updateHintsDecorators([a],Array.from(l)),i.add(toDisposable((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([a],Array.from(l))})))}))),e.add(t.onCancel((()=>i.clear()))),e.add(t.onExecute((e=>__awaiter$l(this,void 0,void 0,(function*(){const t=this._getInlayHintLabelPart(e);if(t){const i=t.part;i.location?this._instaService.invokeFunction(goToDefinitionWithLocation,e,this._editor,i.location):Command.is(i.command)&&(yield this._invokeCommand(i.command,t.item))}}))))),e}_installDblClickGesture(){return this._editor.onMouseUp((e=>__awaiter$l(this,void 0,void 0,(function*(){if(2!==e.event.detail)return;const t=this._getInlayHintLabelPart(e);t&&(e.event.preventDefault(),yield t.item.resolve(CancellationToken.None),t.item.hint.command&&(yield this._invokeCommand(t.item.hint.command,t.item)))}))))}_installContextMenu(){return this._editor.onContextMenu((e=>__awaiter$l(this,void 0,void 0,(function*(){if(!(e.event.target instanceof HTMLElement))return;const t=this._getInlayHintLabelPart(e);t&&(yield this._instaService.invokeFunction(showGoToContextMenu,this._editor,e.event.target,t))}))))}_getInlayHintLabelPart(e){var t;if(6!==e.target.type)return;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof ModelDecorationInjectedTextOptions&&(null==i?void 0:i.attachedData)instanceof RenderedInlayHintLabelPart?i.attachedData:void 0}_invokeCommand(e,t){var i;return __awaiter$l(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(e.id,...null!==(i=e.arguments)&&void 0!==i?i:[])}catch(n){this._notificationService.notify({severity:Severity.Error,source:t.provider.displayName,message:n})}}))}_cacheHintsForFastRestore(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;let o=n.item;const r=e.getDecorationRange(i);if(r){const e=new InlayHintAnchor(r,n.item.anchor.direction);o=n.item.with({anchor:e})}t.set(n.item,o)}this._inlayHintsCache.set(e,Array.from(t.values()))}_getHintsRanges(){const e=this._editor.getModel(),t=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[];for(const n of t.sort(Range$2.compareRangesUsingStarts)){const t=e.validateRange(new Range$2(n.startLineNumber-30,n.startColumn,n.endLineNumber+30,n.endColumn));0!==i.length&&Range$2.areIntersectingOrTouching(i[i.length-1],t)?i[i.length-1]=Range$2.plusRange(i[i.length-1],t):i.push(t)}return i}_updateHintsDecorators(t,i){var n,o;const r=[],s=(e,t,i,n,o)=>{r.push({item:e,classNameRef:t,decoration:{range:e.anchor.range,options:{description:"InlayHint",showIfCollapsed:e.anchor.range.isEmpty(),collapseOnReplaceEdit:!e.anchor.range.isEmpty(),stickiness:0,[e.anchor.direction]:{content:i,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:t.className,cursorStops:n,attachedData:o}}}})},a=(e,t)=>{const i=this._ruleFactory.createClassNameRef({width:(l/3|0)+"px",display:"inline-block"});s(e,i," ",t?InjectedTextCursorStops$1.Right:InjectedTextCursorStops$1.None)},{fontSize:l,fontFamily:d}=this._getLayoutInfo(),c="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(c,d);for(const g of i){g.hint.paddingLeft&&a(g,!1);const t="string"==typeof g.hint.label?[{label:g.hint.label}]:g.hint.label;for(let e=0;e<t.length;e++){const i=t[e],o=0===e,r=e===t.length-1,a={fontSize:`${l}px`,fontFamily:`var(${c}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,verticalAlign:"middle"};g.hint.command&&(a.cursor="pointer"),this._fillInColors(a,g.hint),(i.command||i.location)&&(null===(n=this._activeInlayHintPart)||void 0===n?void 0:n.part.item)===g&&this._activeInlayHintPart.part.index===e&&(a.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(a.color=themeColorFromId(editorActiveLinkForeground),a.cursor="pointer")),o&&r?(a.padding=`1px ${0|Math.max(1,l/4)}px`,a.borderRadius=(l/4|0)+"px"):o?(a.padding=`1px 0 1px ${0|Math.max(1,l/4)}px`,a.borderRadius=`${l/4|0}px 0 0 ${l/4|0}px`):r?(a.padding=`1px ${0|Math.max(1,l/4)}px 1px 0`,a.borderRadius=`0 ${l/4|0}px ${l/4|0}px 0`):a.padding="1px 0 1px 0",s(g,this._ruleFactory.createClassNameRef(a),fixSpace(i.label),r&&!g.hint.paddingRight?InjectedTextCursorStops$1.Right:InjectedTextCursorStops$1.None,new RenderedInlayHintLabelPart(g,e))}if(g.hint.paddingRight&&a(g,!0),r.length>e._MAX_DECORATORS)break}const h=[];for(const e of t)for(const{id:t}of null!==(o=this._editor.getDecorationsInRange(e))&&void 0!==o?o:[]){const e=this._decorationsMetadata.get(t);e&&(h.push(t),e.classNameRef.dispose(),this._decorationsMetadata.delete(t))}const u=this._editor.deltaDecorations(h,r.map((e=>e.decoration)));for(let e=0;e<u.length;e++){const t=r[e];this._decorationsMetadata.set(u[e],{item:t.item,classNameRef:t.classNameRef})}}_fillInColors(e,t){t.kind===InlayHintKind$1.Parameter?(e.backgroundColor=themeColorFromId(editorInlayHintParameterBackground),e.color=themeColorFromId(editorInlayHintParameterForeground)):t.kind===InlayHintKind$1.Type?(e.backgroundColor=themeColorFromId(editorInlayHintTypeBackground),e.color=themeColorFromId(editorInlayHintTypeForeground)):(e.backgroundColor=themeColorFromId(editorInlayHintBackground),e.color=themeColorFromId(editorInlayHintForeground))}_getLayoutInfo(){const e=this._editor.getOption(127),t=this._editor.getOption(46);let i=e.fontSize;(!i||i<5||i>t)&&(i=.9*t|0);return{fontSize:i,fontFamily:e.fontFamily||this._editor.getOption(43)}}_removeAllDecorations(){this._editor.deltaDecorations(Array.from(this._decorationsMetadata.keys()),[]);for(let e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}};function fixSpace(e){return e.replace(/[ \t]/g," ")}InlayHintsController.ID="editor.contrib.InlayHints",InlayHintsController._MAX_DECORATORS=1500,InlayHintsController=__decorate$C([__param$B(1,ILanguageFeaturesService),__param$B(2,ILanguageFeatureDebounceService),__param$B(3,IInlayHintsCache),__param$B(4,ICommandService),__param$B(5,INotificationService),__param$B(6,IInstantiationService)],InlayHintsController),CommandsRegistry.registerCommand("_executeInlayHintProvider",((e,...t)=>__awaiter$l(void 0,void 0,void 0,(function*(){const[i,n]=t;assertType(URI.isUri(i)),assertType(Range$2.isIRange(n));const{inlayHintsProvider:o}=e.get(ILanguageFeaturesService),r=yield e.get(ITextModelService).createModelReference(i);try{const e=yield InlayHintsFragments.create(o,r.object.textEditorModel,[Range$2.lift(n)],CancellationToken.None),t=e.items.map((e=>e.hint));return setTimeout((()=>e.dispose()),0),t}finally{r.dispose()}}))));var __decorate$B=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$A=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$k=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},__asyncValues=globalThis&&globalThis.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};class InlayHintsHoverAnchor extends HoverForeignElementAnchor{constructor(e,t){super(10,t,e.item.anchor.range),this.part=e}}let InlayHintsHover=class extends MarkdownHoverParticipant{constructor(e,t,i,n,o,r){super(e,t,i,n,r),this._resolverService=o,this.hoverOrdinal=6}suggestHoverAnchor(e){var t;if(!InlayHintsController.get(this._editor))return null;if(6!==e.target.type)return null;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof ModelDecorationInjectedTextOptions&&i.attachedData instanceof RenderedInlayHintLabelPart?new InlayHintsHoverAnchor(i.attachedData,this):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof InlayHintsHoverAnchor?new AsyncIterableObject((t=>__awaiter$k(this,void 0,void 0,(function*(){var n,o;const{part:r}=e;if(yield r.item.resolve(i),i.isCancellationRequested)return;let s,a;if("string"==typeof r.item.hint.tooltip?s=(new MarkdownString).appendText(r.item.hint.tooltip):r.item.hint.tooltip&&(s=r.item.hint.tooltip),s&&t.emitOne(new MarkdownHover(this,e.range,[s],0)),"string"==typeof r.part.tooltip?a=(new MarkdownString).appendText(r.part.tooltip):r.part.tooltip&&(a=r.part.tooltip),a&&t.emitOne(new MarkdownHover(this,e.range,[a],1)),r.part.location||r.part.command){let i;const n="altKey"===this._editor.getOption(70)?isMacintosh?localize("links.navigate.kb.meta.mac","cmd + click"):localize("links.navigate.kb.meta","ctrl + click"):isMacintosh?localize("links.navigate.kb.alt.mac","option + click"):localize("links.navigate.kb.alt","alt + click");r.part.location&&r.part.command?i=(new MarkdownString).appendText(localize("hint.defAndCommand","Go to Definition ({0}), right click for more",n)):r.part.location?i=(new MarkdownString).appendText(localize("hint.def","Go to Definition ({0})",n)):r.part.command&&(i=new MarkdownString(`[${localize("hint.cmd","Execute Command")}](${asCommandLink(r.part.command)} "${r.part.command.title}") (${n})`,{isTrusted:!0})),i&&t.emitOne(new MarkdownHover(this,e.range,[i],1e4))}const l=yield this._resolveInlayHintLabelPartHover(r,i);try{for(var d,c=__asyncValues(l);!(d=yield c.next()).done;){let e=d.value;t.emitOne(e)}}catch(h){n={error:h}}finally{try{d&&!d.done&&(o=c.return)&&(yield o.call(c))}finally{if(n)throw n.error}}})))):AsyncIterableObject.EMPTY}_resolveInlayHintLabelPartHover(e,t){return __awaiter$k(this,void 0,void 0,(function*(){if(!e.part.location)return AsyncIterableObject.EMPTY;const{uri:i,range:n}=e.part.location,o=yield this._resolverService.createModelReference(i);try{const i=o.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(i)?getHover(this._languageFeaturesService.hoverProvider,i,new Position$1(n.startLineNumber,n.startColumn),t).filter((e=>!isEmptyMarkdownString(e.hover.contents))).map((t=>new MarkdownHover(this,e.item.anchor.range,t.hover.contents,2+t.ordinal))):AsyncIterableObject.EMPTY}finally{o.dispose()}}))}};InlayHintsHover=__decorate$B([__param$A(1,ILanguageService),__param$A(2,IOpenerService),__param$A(3,IConfigurationService),__param$A(4,ITextModelService),__param$A(5,ILanguageFeaturesService)],InlayHintsHover),registerEditorContribution(InlayHintsController.ID,InlayHintsController),HoverParticipantRegistry.register(InlayHintsHover);class InPlaceReplaceCommand{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new Selection$1(i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn),i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn)):new Selection$1(i.endLineNumber,i.endColumn-this._text.length,i.endLineNumber,i.endColumn)}}var __decorate$A=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$z=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let InPlaceReplaceController=class e{constructor(e,t){this.decorationIds=[],this.editor=e,this.editorWorkerService=t}static get(t){return t.getContribution(e.ID)}dispose(){}run(t,i){this.currentRequest&&this.currentRequest.cancel();const n=this.editor.getSelection(),o=this.editor.getModel();if(!o||!n)return;let r=n;if(r.startLineNumber!==r.endLineNumber)return;const s=new EditorState$1(this.editor,5),a=o.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=createCancelablePromise((e=>this.editorWorkerService.navigateValueSet(a,r,i))),this.currentRequest.then((i=>{if(!i||!i.range||!i.value)return;if(!s.validate(this.editor))return;let n=Range$2.lift(i.range),o=i.range,a=i.value.length-(r.endColumn-r.startColumn);o={startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.startColumn+i.value.length},a>1&&(r=new Selection$1(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn+a-1));const l=new InPlaceReplaceCommand(n,r,i.value);this.editor.pushUndoStop(),this.editor.executeCommand(t,l),this.editor.pushUndoStop(),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[{range:o,options:e.DECORATION}]),this.decorationRemover&&this.decorationRemover.cancel(),this.decorationRemover=timeout(350),this.decorationRemover.then((()=>this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[]))).catch(onUnexpectedError)})).catch(onUnexpectedError)):Promise.resolve(void 0)}};InPlaceReplaceController.ID="editor.contrib.inPlaceReplaceController",InPlaceReplaceController.DECORATION=ModelDecorationOptions.register({description:"in-place-replace",className:"valueSetReplacement"}),InPlaceReplaceController=__decorate$A([__param$z(1,IEditorWorkerService)],InPlaceReplaceController);class InPlaceReplaceUp extends EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.up",label:localize("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3154,weight:100}})}run(e,t){const i=InPlaceReplaceController.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}class InPlaceReplaceDown extends EditorAction{constructor(){super({id:"editor.action.inPlaceReplace.down",label:localize("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3156,weight:100}})}run(e,t){const i=InPlaceReplaceController.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}registerEditorContribution(InPlaceReplaceController.ID,InPlaceReplaceController),registerEditorAction(InPlaceReplaceUp),registerEditorAction(InPlaceReplaceDown),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorBracketMatchBorder);i&&t.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${i}; }`)}));class ExpandLineSelectionAction extends EditorAction{constructor(){super({id:"expandLineSelection",label:localize("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:EditorContextKeys.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,CursorMoveCommands.expandLineSelection(n,n.getCursorStates())),n.revealPrimaryCursor(i.source,!0)}}registerEditorAction(ExpandLineSelectionAction);class TrimTrailingWhitespaceCommand{constructor(e,t){this._selection=e,this._cursors=t,this._selectionId=null}getEditOperations(e,t){const i=trimTrailingWhitespace(e,this._cursors);for(let n=0,o=i.length;n<o;n++){const e=i[n];t.addEditOperation(e.range,e.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function trimTrailingWhitespace(e,t){t.sort(((e,t)=>e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber));for(let s=t.length-2;s>=0;s--)t[s].lineNumber===t[s+1].lineNumber&&t.splice(s,1);const i=[];let n=0,o=0;const r=t.length;for(let s=1,a=e.getLineCount();s<=a;s++){const a=e.getLineContent(s),l=a.length+1;let d=0;if(o<r&&t[o].lineNumber===s&&(d=t[o].column,o++,d===l))continue;if(0===a.length)continue;const c=lastNonWhitespaceIndex(a);let h=0;if(-1===c)h=1;else{if(c===a.length-1)continue;h=c+2}h=Math.max(d,h),i[n++]=EditOperation.delete(new Range$2(s,h,s,l))}return i}class CopyLinesCommand{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));let n=[];for(let r=i.startLineNumber;r<=i.endLineNumber;r++)n.push(e.getLineContent(r));const o=n.join("\n");""===o&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new Range$2(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new Range$2(i.startLineNumber,1,i.startLineNumber,1),o+"\n"):t.addEditOperation(new Range$2(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+o),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let e=i.startLineNumber,t=i.startColumn,n=i.endLineNumber,o=i.endColumn;0!==this._startLineNumberDelta&&(e+=this._startLineNumberDelta,t=1),0!==this._endLineNumberDelta&&(n+=this._endLineNumberDelta,o=1),i=Selection$1.createWithDirection(e,t,n,o,this._selectionDirection)}return i}}class MoveLinesCommand{constructor(e,t,i){this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){let i=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===i)return void(this._selectionId=t.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=t.trackSelection(this._selection));this._moveEndPositionDown=!1;let n=this._selection;n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._moveEndPositionDown=!0,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const{tabSize:o,indentSize:r,insertSpaces:s}=e.getOptions();let a=this.buildIndentConverter(o,r,s),l={getLineTokens:t=>e.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i),getLineContent:null};if(n.startLineNumber===n.endLineNumber&&1===e.getLineMaxColumn(n.startLineNumber)){let i=n.startLineNumber,o=this._isMovingDown?i+1:i-1;1===e.getLineMaxColumn(o)?t.addEditOperation(new Range$2(1,1,1,1),null):(t.addEditOperation(new Range$2(i,1,i,1),e.getLineContent(o)),t.addEditOperation(new Range$2(o,1,o,e.getLineMaxColumn(o)),null)),n=new Selection$1(o,1,o,1)}else{let i,r;if(this._isMovingDown){i=n.endLineNumber+1,r=e.getLineContent(i),t.addEditOperation(new Range$2(i-1,e.getLineMaxColumn(i-1),i,e.getLineMaxColumn(i)),null);let d=r;if(this.shouldAutoIndent(e,n)){let c=this.matchEnterRule(e,a,o,i,n.startLineNumber-1);if(null!==c){let t=generateIndent(c+getSpaceCnt(getLeadingWhitespace(e.getLineContent(i)),o),o,s);d=t+this.trimLeft(r)}else{l.getLineContent=t=>t===n.startLineNumber?e.getLineContent(i):e.getLineContent(t);let t=LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(i,1),n.startLineNumber,a);if(null!==t){let n=getLeadingWhitespace(e.getLineContent(i)),a=getSpaceCnt(t,o);if(a!==getSpaceCnt(n,o)){let e=generateIndent(a,o,s);d=e+this.trimLeft(r)}}}t.addEditOperation(new Range$2(n.startLineNumber,1,n.startLineNumber,1),d+"\n");let h=this.matchEnterRuleMovingDown(e,a,o,n.startLineNumber,i,d);if(null!==h)0!==h&&this.getIndentEditsOfMovingBlock(e,t,n,o,s,h);else{l.getLineContent=t=>t===n.startLineNumber?d:t>=n.startLineNumber+1&&t<=n.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);let r=LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(i,1),n.startLineNumber+1,a);if(null!==r){const i=getLeadingWhitespace(e.getLineContent(n.startLineNumber)),a=getSpaceCnt(r,o),l=getSpaceCnt(i,o);if(a!==l){const i=a-l;this.getIndentEditsOfMovingBlock(e,t,n,o,s,i)}}}}else t.addEditOperation(new Range$2(n.startLineNumber,1,n.startLineNumber,1),d+"\n")}else if(i=n.startLineNumber-1,r=e.getLineContent(i),t.addEditOperation(new Range$2(i,1,i+1,1),null),t.addEditOperation(new Range$2(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+r),this.shouldAutoIndent(e,n)){l.getLineContent=t=>t===i?e.getLineContent(n.startLineNumber):e.getLineContent(t);let r=this.matchEnterRule(e,a,o,n.startLineNumber,n.startLineNumber-2);if(null!==r)0!==r&&this.getIndentEditsOfMovingBlock(e,t,n,o,s,r);else{let r=LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(n.startLineNumber,1),i,a);if(null!==r){let i=getLeadingWhitespace(e.getLineContent(n.startLineNumber)),a=getSpaceCnt(r,o),l=getSpaceCnt(i,o);if(a!==l){let i=a-l;this.getIndentEditsOfMovingBlock(e,t,n,o,s,i)}}}}}this._selectionId=t.trackSelection(n)}buildIndentConverter(e,t,i){return{shiftIndent:n=>ShiftCommand.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>ShiftCommand.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,o){if(o){let r=o.indentation;o.indentAction===IndentAction$1.None||o.indentAction===IndentAction$1.Indent?r=o.indentation+o.appendText:o.indentAction===IndentAction$1.IndentOutdent?r=o.indentation:o.indentAction===IndentAction$1.Outdent&&(r=t.unshiftIndent(o.indentation)+o.appendText);let s=e.getLineContent(n);if(this.trimLeft(s).indexOf(this.trimLeft(r))>=0){let o=getLeadingWhitespace(e.getLineContent(n)),s=getLeadingWhitespace(r),a=LanguageConfigurationRegistry.getIndentMetadata(e,n);return null!==a&&2&a&&(s=t.unshiftIndent(s)),getSpaceCnt(s,i)-getSpaceCnt(o,i)}}return null}matchEnterRuleMovingDown(e,t,i,n,o,r){if(lastNonWhitespaceIndex(r)>=0){let r=e.getLineMaxColumn(o),s=LanguageConfigurationRegistry.getEnterAction(this._autoIndent,e,new Range$2(o,r,o,r));return this.parseEnterResult(e,t,i,n,s)}{let o=n-1;for(;o>=1;){if(lastNonWhitespaceIndex(e.getLineContent(o))>=0)break;o--}if(o<1||n>e.getLineCount())return null;let r=e.getLineMaxColumn(o),s=LanguageConfigurationRegistry.getEnterAction(this._autoIndent,e,new Range$2(o,r,o,r));return this.parseEnterResult(e,t,i,n,s)}}matchEnterRule(e,t,i,n,o,r){let s=o;for(;s>=1;){let t;if(t=s===o&&void 0!==r?r:e.getLineContent(s),lastNonWhitespaceIndex(t)>=0)break;s--}if(s<1||n>e.getLineCount())return null;let a=e.getLineMaxColumn(s),l=LanguageConfigurationRegistry.getEnterAction(this._autoIndent,e,new Range$2(s,a,s,a));return this.parseEnterResult(e,t,i,n,l)}trimLeft(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4)return!1;if(!e.isCheapToTokenize(t.startLineNumber))return!1;let i=e.getLanguageIdAtPosition(t.startLineNumber,1);return i===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==LanguageConfigurationRegistry.getIndentRulesSupport(i)}getIndentEditsOfMovingBlock(e,t,i,n,o,r){for(let s=i.startLineNumber;s<=i.endLineNumber;s++){let a=getLeadingWhitespace(e.getLineContent(s)),l=generateIndent(getSpaceCnt(a,n)+r,n,o);l!==a&&(t.addEditOperation(new Range$2(s,1,s,a.length+1),l),s===i.endLineNumber&&i.endColumn<=a.length+1&&""===l&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}}class SortLinesCommand{constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}static getCollator(){return SortLinesCommand._COLLATOR||(SortLinesCommand._COLLATOR=new Intl.Collator),SortLinesCommand._COLLATOR}getEditOperations(e,t){let i=sortLines(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(null===e)return!1;let n=getSortData(e,t,i);if(!n)return!1;for(let o=0,r=n.before.length;o<r;o++)if(n.before[o]!==n.after[o])return!0;return!1}}function getSortData(e,t,i){let n=t.startLineNumber,o=t.endLineNumber;if(1===t.endColumn&&o--,n>=o)return null;let r=[];for(let a=n;a<=o;a++)r.push(e.getLineContent(a));let s=r.slice(0);return s.sort(SortLinesCommand.getCollator().compare),!0===i&&(s=s.reverse()),{startLineNumber:n,endLineNumber:o,before:r,after:s}}function sortLines(e,t,i){let n=getSortData(e,t,i);return n?EditOperation.replace(new Range$2(n.startLineNumber,1,n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),n.after.join("\n")):null}SortLinesCommand._COLLATOR=null;class AbstractCopyLinesAction extends EditorAction{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map(((e,t)=>({selection:e,index:t,ignore:!1})));i.sort(((e,t)=>Range$2.compareRangesUsingStarts(e.selection,t.selection)));let n=i[0];for(let r=1;r<i.length;r++){const e=i[r];n.selection.endLineNumber===e.selection.startLineNumber&&(n.index<e.index?e.ignore=!0:(n.ignore=!0,n=e))}const o=[];for(const r of i)o.push(new CopyLinesCommand(r.selection,this.down,r.ignore));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class CopyLinesUpAction extends AbstractCopyLinesAction{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:localize("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class CopyLinesDownAction extends AbstractCopyLinesAction{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:localize("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class DuplicateSelectionAction extends EditorAction{constructor(){super({id:"editor.action.duplicateSelection",label:localize("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:EditorContextKeys.writable,menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],o=t.getSelections(),r=t.getModel();for(const s of o)if(s.isEmpty())n.push(new CopyLinesCommand(s,!0));else{const e=new Selection$1(s.endLineNumber,s.endColumn,s.endLineNumber,s.endColumn);n.push(new ReplaceCommandThatSelectsText(e,r.getValueInRange(s)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class AbstractMoveLinesAction extends EditorAction{constructor(e,t){super(t),this.down=e}run(e,t){let i=[],n=t.getSelections()||[];const o=t.getOption(9);for(const r of n)i.push(new MoveLinesCommand(r,this.down,o));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class MoveLinesUpAction extends AbstractMoveLinesAction{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:localize("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class MoveLinesDownAction extends AbstractMoveLinesAction{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:localize("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"2_line",title:localize({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class AbstractSortLinesAction extends EditorAction{constructor(e,t){super(t),this.descending=e}run(e,t){const i=t.getSelections()||[];for(const o of i)if(!SortLinesCommand.canRun(t.getModel(),o,this.descending))return;let n=[];for(let o=0,r=i.length;o<r;o++)n[o]=new SortLinesCommand(i[o],this.descending);t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class SortLinesAscendingAction extends AbstractSortLinesAction{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:localize("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:EditorContextKeys.writable})}}class SortLinesDescendingAction extends AbstractSortLinesAction{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:localize("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:EditorContextKeys.writable})}}class DeleteDuplicateLinesAction extends EditorAction{constructor(){super({id:"editor.action.removeDuplicateLines",label:localize("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:EditorContextKeys.writable})}run(e,t){if(!t.hasModel())return;let i=t.getModel();if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return;let n=[],o=[],r=0;for(let s of t.getSelections()){let e=new Set,t=[];for(let n=s.startLineNumber;n<=s.endLineNumber;n++){let o=i.getLineContent(n);e.has(o)||(t.push(o),e.add(o))}let a=new Selection$1(s.startLineNumber,1,s.endLineNumber,i.getLineMaxColumn(s.endLineNumber)),l=s.startLineNumber-r,d=new Selection$1(l,1,l+t.length-1,t[t.length-1].length);n.push(EditOperation.replace(a,t.join("\n"))),o.push(d),r+=s.endLineNumber-s.startLineNumber+1-t.length}t.pushUndoStop(),t.executeEdits(this.id,n,o),t.pushUndoStop()}}class TrimTrailingWhitespaceAction extends EditorAction{constructor(){super({id:TrimTrailingWhitespaceAction.ID,label:localize("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:KeyChord(2089,2102),weight:100}})}run(e,t,i){let n=[];"auto-save"===i.reason&&(n=(t.getSelections()||[]).map((e=>new Position$1(e.positionLineNumber,e.positionColumn))));let o=t.getSelection();if(null===o)return;let r=new TrimTrailingWhitespaceCommand(o,n);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop()}}TrimTrailingWhitespaceAction.ID="editor.action.trimTrailingWhitespace";class DeleteLinesAction extends EditorAction{constructor(){super({id:"editor.action.deleteLines",label:localize("lines.delete","Delete Line"),alias:"Delete Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;let i=this._getLinesToRemove(t),n=t.getModel();if(1===n.getLineCount()&&1===n.getLineMaxColumn(1))return;let o=0,r=[],s=[];for(let a=0,l=i.length;a<l;a++){const e=i[a];let t=e.startLineNumber,l=e.endLineNumber,d=1,c=n.getLineMaxColumn(l);l<n.getLineCount()?(l+=1,c=1):t>1&&(t-=1,d=n.getLineMaxColumn(t)),r.push(EditOperation.replace(new Selection$1(t,d,l,c),"")),s.push(new Selection$1(t-o,e.positionColumn,t-o,e.positionColumn)),o+=e.endLineNumber-e.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,r,s),t.pushUndoStop()}_getLinesToRemove(e){let t=e.getSelections().map((e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort(((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber));let i=[],n=t[0];for(let o=1;o<t.length;o++)n.endLineNumber+1>=t[o].startLineNumber?n.endLineNumber=t[o].endLineNumber:(i.push(n),n=t[o]);return i.push(n),i}}class IndentLinesAction extends EditorAction{constructor(){super({id:"editor.action.indentLines",label:localize("lines.indent","Indent Line"),alias:"Indent Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2137,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,TypeOperations.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class OutdentLinesAction extends EditorAction{constructor(){super({id:"editor.action.outdentLines",label:localize("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2135,weight:100}})}run(e,t){CoreEditingCommands.Outdent.runEditorCommand(e,t,null)}}class InsertLineBeforeAction extends EditorAction{constructor(){super({id:"editor.action.insertLineBefore",label:localize("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,TypeOperations.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class InsertLineAfterAction extends EditorAction{constructor(){super({id:"editor.action.insertLineAfter",label:localize("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,TypeOperations.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class AbstractDeleteAllToBoundaryAction extends EditorAction{run(e,t){if(!t.hasModel())return;const i=t.getSelection();let n=this._getRangesToDelete(t),o=[];for(let a=0,l=n.length-1;a<l;a++){let e=n[a],t=n[a+1];null===Range$2.intersectRanges(e,t)?o.push(e):n[a+1]=Range$2.plusRange(e,t)}o.push(n[n.length-1]);let r=this._getEndCursorState(i,o),s=o.map((e=>EditOperation.replace(e,"")));t.pushUndoStop(),t.executeEdits(this.id,s,r),t.pushUndoStop()}}class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllLeft",label:localize("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null,n=[],o=0;return t.forEach((t=>{let r;if(1===t.endColumn&&o>0){let e=t.startLineNumber-o;r=new Selection$1(e,t.startColumn,e,t.startColumn)}else r=new Selection$1(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);o+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?i=r:n.push(r)})),i&&n.unshift(i),n}_getRangesToDelete(e){let t=e.getSelections();if(null===t)return[];let i=t,n=e.getModel();return null===n?[]:(i.sort(Range$2.compareRangesUsingStarts),i=i.map((e=>{if(e.isEmpty()){if(1===e.startColumn){let t=Math.max(1,e.startLineNumber-1),i=1===e.startLineNumber?1:n.getLineContent(t).length+1;return new Range$2(t,i,e.startLineNumber,1)}return new Range$2(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new Range$2(e.startLineNumber,1,e.endLineNumber,e.endColumn)})),i)}}class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction{constructor(){super({id:"deleteAllRight",label:localize("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null,n=[];for(let o=0,r=t.length,s=0;o<r;o++){let r=t[o],a=new Selection$1(r.startLineNumber-s,r.startColumn,r.startLineNumber-s,r.startColumn);r.intersectRanges(e)?i=a:n.push(a)}return i&&n.unshift(i),n}_getRangesToDelete(e){let t=e.getModel();if(null===t)return[];let i=e.getSelections();if(null===i)return[];let n=i.map((e=>{if(e.isEmpty()){const i=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===i?new Range$2(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new Range$2(e.startLineNumber,e.startColumn,e.startLineNumber,i)}return e}));return n.sort(Range$2.compareRangesUsingStarts),n}}class JoinLinesAction extends EditorAction{constructor(){super({id:"editor.action.joinLines",label:localize("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){let i=t.getSelections();if(null===i)return;let n=t.getSelection();if(null===n)return;i.sort(Range$2.compareRangesUsingStarts);let o=[],r=i.reduce(((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(n.equalsSelection(e)&&(n=t),t):t.startLineNumber>e.endLineNumber+1?(o.push(e),t):new Selection$1(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(o.push(e),t):new Selection$1(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)));o.push(r);let s=t.getModel();if(null===s)return;let a=[],l=[],d=n,c=0;for(let h=0,u=o.length;h<u;h++){let e,t,i=o[h],r=i.startLineNumber,u=1,g=0,p=s.getLineContent(i.endLineNumber).length-i.endColumn;if(i.isEmpty()||i.startLineNumber===i.endLineNumber){let n=i.getStartPosition();n.lineNumber<s.getLineCount()?(e=r+1,t=s.getLineMaxColumn(e)):(e=n.lineNumber,t=s.getLineMaxColumn(n.lineNumber))}else e=i.endLineNumber,t=s.getLineMaxColumn(e);let m=s.getLineContent(r);for(let n=r+1;n<=e;n++){let e=s.getLineContent(n),t=s.getLineFirstNonWhitespaceColumn(n);if(t>=1){let i=!0;""===m&&(i=!1),!i||" "!==m.charAt(m.length-1)&&"\t"!==m.charAt(m.length-1)||(i=!1,m=m.replace(/[\s\uFEFF\xA0]+$/g," "));let n=e.substr(t-1);m+=(i?" ":"")+n,g=i?n.length+1:n.length}else g=0}let f=new Range$2(r,u,e,t);if(!f.isEmpty()){let e;i.isEmpty()?(a.push(EditOperation.replace(f,m)),e=new Selection$1(f.startLineNumber-c,m.length-g+1,r-c,m.length-g+1)):i.startLineNumber===i.endLineNumber?(a.push(EditOperation.replace(f,m)),e=new Selection$1(i.startLineNumber-c,i.startColumn,i.endLineNumber-c,i.endColumn)):(a.push(EditOperation.replace(f,m)),e=new Selection$1(i.startLineNumber-c,i.startColumn,i.startLineNumber-c,m.length-p)),null!==Range$2.intersectRanges(f,n)?d=e:l.push(e)}c+=f.endLineNumber-f.startLineNumber}l.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,a,l),t.pushUndoStop()}}class TransposeAction extends EditorAction{constructor(){super({id:"editor.action.transpose",label:localize("editor.transpose","Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:EditorContextKeys.writable})}run(e,t){let i=t.getSelections();if(null===i)return;let n=t.getModel();if(null===n)return;let o=[];for(let r=0,s=i.length;r<s;r++){let e=i[r];if(!e.isEmpty())continue;let t=e.getStartPosition(),s=n.getLineMaxColumn(t.lineNumber);if(t.column>=s){if(t.lineNumber===n.getLineCount())continue;let e=new Range$2(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i=n.getValueInRange(e).split("").reverse().join("");o.push(new ReplaceCommand(new Selection$1(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i))}else{let e=new Range$2(t.lineNumber,Math.max(1,t.column-1),t.lineNumber,t.column+1),i=n.getValueInRange(e).split("").reverse().join("");o.push(new ReplaceCommandThatPreservesSelection(e,i,new Selection$1(t.lineNumber,t.column+1,t.lineNumber,t.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class AbstractCaseAction extends EditorAction{run(e,t){const i=t.getSelections();if(null===i)return;const n=t.getModel();if(null===n)return;const o=t.getOption(117),r=[];for(const s of i)if(s.isEmpty()){const e=s.getStartPosition(),i=t.getConfiguredWordAtPosition(e);if(!i)continue;const a=new Range$2(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn),l=n.getValueInRange(a);r.push(EditOperation.replace(a,this._modifyText(l,o)))}else{const e=n.getValueInRange(s);r.push(EditOperation.replace(s,this._modifyText(e,o)))}t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop()}}class UpperCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToUppercase",label:localize("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:EditorContextKeys.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}class LowerCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToLowercase",label:localize("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:EditorContextKeys.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}class BackwardsCompatibleRegExp{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}isSupported(){return null!==this.get()}}class TitleCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToTitlecase",label:localize("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:EditorContextKeys.writable})}_modifyText(e,t){const i=TitleCaseAction.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,(e=>e.toLocaleUpperCase())):e}}TitleCaseAction.titleBoundary=new BackwardsCompatibleRegExp("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class SnakeCaseAction extends AbstractCaseAction{constructor(){super({id:"editor.action.transformToSnakecase",label:localize("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:EditorContextKeys.writable})}_modifyText(e,t){const i=SnakeCaseAction.caseBoundary.get(),n=SnakeCaseAction.singleLetters.get();return i&&n?e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase():e}}SnakeCaseAction.caseBoundary=new BackwardsCompatibleRegExp("(\\p{Ll})(\\p{Lu})","gmu"),SnakeCaseAction.singleLetters=new BackwardsCompatibleRegExp("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu"),registerEditorAction(CopyLinesUpAction),registerEditorAction(CopyLinesDownAction),registerEditorAction(DuplicateSelectionAction),registerEditorAction(MoveLinesUpAction),registerEditorAction(MoveLinesDownAction),registerEditorAction(SortLinesAscendingAction),registerEditorAction(SortLinesDescendingAction),registerEditorAction(DeleteDuplicateLinesAction),registerEditorAction(TrimTrailingWhitespaceAction),registerEditorAction(DeleteLinesAction),registerEditorAction(IndentLinesAction),registerEditorAction(OutdentLinesAction),registerEditorAction(InsertLineBeforeAction),registerEditorAction(InsertLineAfterAction),registerEditorAction(DeleteAllLeftAction),registerEditorAction(DeleteAllRightAction),registerEditorAction(JoinLinesAction),registerEditorAction(TransposeAction),registerEditorAction(UpperCaseAction),registerEditorAction(LowerCaseAction),SnakeCaseAction.caseBoundary.isSupported()&&SnakeCaseAction.singleLetters.isSupported()&&registerEditorAction(SnakeCaseAction),TitleCaseAction.titleBoundary.isSupported()&&registerEditorAction(TitleCaseAction);var __decorate$z=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$y=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$j=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE=new RawContextKey("LinkedEditingInputVisible",!1),DECORATION_CLASS_NAME="linked-editing-decoration";let LinkedEditingContribution=class e extends Disposable{constructor(e,t,i,n,o){super(),this.languageConfigurationService=n,this._localToDispose=this._register(new DisposableStore),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(t),this._debounceInformation=o.for(this._providers,"Linked Editing",{min:200}),this._currentDecorations=[],this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new DisposableStore),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(62)||e.hasChanged(82))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}static get(t){return t.getContribution(e.ID)}reinitialize(e){const t=this._editor.getModel(),i=null!==t&&(this._editor.getOption(62)||this._editor.getOption(82))&&this._providers.has(t);if(i===this._enabled&&!e)return;if(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||null===t)return;this._localToDispose.add(Event$1.runAndSubscribe(t.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()})));const n=new Delayer(this._debounceInformation.get(t)),o=()=>{var e;this._rangeUpdateTriggerPromise=n.trigger((()=>this.updateRanges()),null!==(e=this._debounceDuration)&&void 0!==e?e:this._debounceInformation.get(t))},r=new Delayer(0),s=e=>{this._rangeSyncTriggerPromise=r.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{o()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const i=t.getDecorationRange(this._currentDecorations[0]);if(i&&e.changes.every((e=>i.intersectRanges(e.range))))return void s(this._currentDecorations)}o()}))),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._currentDecorations||0===e.length)return;const t=this._editor.getModel(),i=t.getDecorationRange(e[0]);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const e=n.match(this._currentWordPattern);if((e?e[0].length:0)!==n.length)return this.clearRanges()}let o=[];for(let r=1,s=e.length;r<s;r++){const i=t.getDecorationRange(e[r]);if(i)if(i.startLineNumber!==i.endLineNumber)o.push({range:i,text:n});else{let e=t.getValueInRange(i),r=n,s=i.startColumn,a=i.endColumn;const l=commonPrefixLength(e,r);s+=l,e=e.substr(l),r=r.substr(l);const d=commonSuffixLength(e,r);a-=d,e=e.substr(0,e.length-d),r=r.substr(0,r.length-d),s===a&&0===r.length||o.push({range:new Range$2(i.startLineNumber,s,i.endLineNumber,a),text:r})}}if(0!==o.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,[]),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(t=!1){return __awaiter$j(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const i=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1)return void this.clearRanges();const n=this._editor.getModel(),o=n.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===o){if(i.equals(this._currentRequestPosition))return;if(this._currentDecorations&&this._currentDecorations.length>0){const e=n.getDecorationRange(this._currentDecorations[0]);if(e&&e.containsPosition(i))return}}this._currentRequestPosition=i,this._currentRequestModelVersion=o;const r=createCancelablePromise((t=>__awaiter$j(this,void 0,void 0,(function*(){try{const s=new StopWatch(!1),a=yield getLinkedEditingRanges(this._providers,n,i,t);if(this._debounceInformation.update(n,s.elapsed()),r!==this._currentRequest)return;if(this._currentRequest=null,o!==n.getVersionId())return;let l=[];(null==a?void 0:a.ranges)&&(l=a.ranges),this._currentWordPattern=(null==a?void 0:a.wordPattern)||this._languageWordPattern;let d=!1;for(let e=0,t=l.length;e<t;e++)if(Range$2.containsPosition(l[e],i)){if(d=!0,0!==e){const t=l[e];l.splice(e,1),l.unshift(t)}break}if(!d)return void this.clearRanges();const c=l.map((t=>({range:t,options:e.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,c)}catch(s){isCancellationError(s)||onUnexpectedError(s),this._currentRequest!==r&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=r,r}))}};LinkedEditingContribution.ID="editor.contrib.linkedEditing",LinkedEditingContribution.DECORATION=ModelDecorationOptions.register({description:"linked-editing",stickiness:0,className:DECORATION_CLASS_NAME}),LinkedEditingContribution=__decorate$z([__param$y(1,IContextKeyService),__param$y(2,ILanguageFeaturesService),__param$y(3,ILanguageConfigurationService),__param$y(4,ILanguageFeatureDebounceService)],LinkedEditingContribution);class LinkedEditingAction extends EditorAction{constructor(){super({id:"editor.action.linkedEditing",label:localize("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(ICodeEditorService),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return URI.isUri(n)&&Position$1.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(o),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),onUnexpectedError):super.runCommand(e,t)}run(e,t){const i=LinkedEditingContribution.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const LinkedEditingCommand=EditorCommand.bindToContribution(LinkedEditingContribution.get);function getLinkedEditingRanges(e,t,i,n){return first(e.ordered(t).map((e=>()=>__awaiter$j(this,void 0,void 0,(function*(){try{return yield e.provideLinkedEditingRanges(t,i,n)}catch(e2){return void onUnexpectedExternalError(e2)}})))),(e=>!!e&&isNonEmptyArray(null==e?void 0:e.ranges)))}registerEditorCommand(new LinkedEditingCommand({id:"cancelLinkedEditingInput",precondition:CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,handler:e=>e.clearRanges(),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));const editorLinkedEditingBackground=registerColor("editor.linkedEditingBackground",{dark:Color.fromHex("#f00").transparent(.3),light:Color.fromHex("#f00").transparent(.3),hc:Color.fromHex("#f00").transparent(.3)},localize("editorLinkedEditingBackground","Background color when the editor auto renames on type."));registerThemingParticipant(((e,t)=>{const i=e.getColor(editorLinkedEditingBackground);i&&t.addRule(`.monaco-editor .${DECORATION_CLASS_NAME} { background: ${i}; border-left-color: ${i}; }`)})),registerModelAndPositionCommand("_executeLinkedEditingProvider",((e,t,i)=>{const{linkedEditingRangeProvider:n}=e.get(ILanguageFeaturesService);return getLinkedEditingRanges(n,t,i,CancellationToken.None)})),registerEditorContribution(LinkedEditingContribution.ID,LinkedEditingContribution),registerEditorAction(LinkedEditingAction);var links="",__awaiter$i=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class Link$1{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(e){return __awaiter$i(this,void 0,void 0,(function*(){return this._link.url?this._link.url:"function"==typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,e)).then((t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}))}}class LinksList{constructor(e){this._disposables=new DisposableStore;let t=[];for(const[i,n]of e){const e=i.links.map((e=>new Link$1(e,n)));t=LinksList._union(t,e),isDisposable(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){let i,n,o,r,s=[];for(i=0,o=0,n=e.length,r=t.length;i<n&&o<r;){const n=e[i],r=t[o];if(Range$2.areIntersectingOrTouching(n.range,r.range)){i++;continue}Range$2.compareRangesUsingStarts(n.range,r.range)<0?(s.push(n),i++):(s.push(r),o++)}for(;i<n;i++)s.push(e[i]);for(;o<r;o++)s.push(t[o]);return s}}function getLinks(e,t,i){const n=[],o=e.ordered(t).reverse().map(((e,o)=>Promise.resolve(e.provideLinks(t,i)).then((t=>{t&&(n[o]=[t,e])}),onUnexpectedExternalError)));return Promise.all(o).then((()=>{const e=new LinksList(coalesce(n));return i.isCancellationRequested?(e.dispose(),new LinksList([])):e}))}CommandsRegistry.registerCommand("_executeLinkProvider",((e,...t)=>__awaiter$i(void 0,void 0,void 0,(function*(){let[i,n]=t;assertType(i instanceof URI),"number"!=typeof n&&(n=0);const{linkProvider:o}=e.get(ILanguageFeaturesService),r=e.get(IModelService).getModel(i);if(!r)return[];const s=yield getLinks(o,r,CancellationToken.None);if(!s)return[];for(let e=0;e<Math.min(n,s.links.length);e++)yield s.links[e].resolve(CancellationToken.None);const a=s.links.slice(0);return s.dispose(),a}))));var __decorate$y=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$x=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$h=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let LinkDetector=class e extends Disposable{constructor(e,t,i,n,o){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=n,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=o.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new RunOnceScheduler((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new ClickLinkGesture(e));this._register(r.onMouseMoveOrRelevantKeyDown((([e,t])=>{this._onEditorMouseMove(e,t)}))),this._register(r.onExecute((e=>{this.onEditorMouseUp(e)}))),this._register(r.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(63)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(e.onDidChangeModelContent((e=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(e.onDidChangeModel((e=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(e.onDidChangeModelLanguage((e=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((e=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}static get(t){return t.getContribution(e.ID)}computeLinksNow(){return __awaiter$h(this,void 0,void 0,(function*(){if(!this.editor.hasModel()||!this.editor.getOption(63))return;const e=this.editor.getModel();if(this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=createCancelablePromise((t=>getLinks(this.providers,e,t)));try{const t=new StopWatch(!1);if(this.activeLinksList=yield this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){onUnexpectedError(t)}finally{this.computePromise=null}}}))}updateDecorations(e){const t="altKey"===this.editor.getOption(70),i=[],n=Object.keys(this.currentOccurrences);for(const s of n){const e=this.currentOccurrences[s];i.push(e.decorationId)}const o=[];if(e)for(const s of e)o.push(LinkOccurrence.decoration(s,t));const r=this.editor.deltaDecorations(i,o);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let s=0,a=r.length;s<a;s++){const t=new LinkOccurrence(e[s],r[s]);this.currentOccurrences[t.decorationId]=t}}_onEditorMouseMove(e,t){const i="altKey"===this.editor.getOption(70);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations((e=>{t.activate(e,i),this.activeLinkDecorationId=t.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getOption(70);if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((i=>{t.deactivate(i,e)})),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(CancellationToken.None).then((e=>{if("string"==typeof e&&this.editor.hasModel()){const t=this.editor.getModel().uri;if(t.scheme===Schemas.file&&e.startsWith(`${Schemas.file}:`)){const i=URI.parse(e);if(i.scheme===Schemas.file){const n=originalFSPath(i);let o=null;n.startsWith("/./")?o=`.${n.substr(1)}`:n.startsWith("//./")&&(o=`.${n.substr(2)}`),o&&(e=joinPath(t,o))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0})}),(e=>{const t=e instanceof Error?e.message:e;"invalid"===t?this.notificationService.warn(localize("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):"missing"===t?this.notificationService.warn(localize("missing.url","Failed to open this link because its target is missing.")):onUnexpectedError(e)}))}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const e=this.currentOccurrences[i.id];if(e)return e}return null}isEnabled(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};LinkDetector.ID="editor.linkDetector",LinkDetector=__decorate$y([__param$x(1,IOpenerService),__param$x(2,INotificationService),__param$x(3,ILanguageFeaturesService),__param$x(4,ILanguageFeatureDebounceService)],LinkDetector);const decoration={general:ModelDecorationOptions.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:ModelDecorationOptions.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class LinkOccurrence{constructor(e,t){this.link=e,this.decorationId=t}static decoration(e,t){return{range:e.range,options:LinkOccurrence._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n=Object.assign({},i?decoration.active:decoration.general);return n.hoverMessage=getHoverMessage(e,t),n}activate(e,t){e.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,LinkOccurrence._getOptions(this.link,t,!1))}}function getHoverMessage(e,t){const i=e.url&&/^command:/i.test(e.url.toString()),n=e.tooltip?e.tooltip:i?localize("links.navigate.executeCmd","Execute command"):localize("links.navigate.follow","Follow link"),o=t?isMacintosh?localize("links.navigate.kb.meta.mac","cmd + click"):localize("links.navigate.kb.meta","ctrl + click"):isMacintosh?localize("links.navigate.kb.alt.mac","option + click"):localize("links.navigate.kb.alt","alt + click");if(e.url){let t="";if(/^command:/i.test(e.url.toString())){const i=e.url.toString().match(/^command:([^?#]+)/);if(i){t=` "${localize("tooltip.explanation","Execute command {0}",i[1])}"`}}return new MarkdownString("",!0).appendMarkdown(`[${n}](${e.url.toString(!0).replace(/ /g,"%20")}${t}) (${o})`)}return(new MarkdownString).appendText(`${n} (${o})`)}class OpenLinkAction extends EditorAction{constructor(){super({id:"editor.action.openLink",label:localize("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=LinkDetector.get(t);if(!i)return;if(!t.hasModel())return;const n=t.getSelections();for(const o of n){const e=i.getLinkOccurrence(o.getEndPosition());e&&i.openLinkOccurrence(e,!1)}}}registerEditorContribution(LinkDetector.ID,LinkDetector),registerEditorAction(OpenLinkAction),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorActiveLinkForeground);i&&t.addRule(`.monaco-editor .detected-link-active { color: ${i} !important; }`)}));var __decorate$x=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$w=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};function announceCursorChange(e,t){const i=t.filter((t=>!e.find((e=>e.equals(t)))));if(i.length>=1){const e=i.map((e=>`line ${e.viewState.position.lineNumber} column ${e.viewState.position.column}`)).join(", ");status(1===i.length?localize("cursorAdded","Cursor added: {0}",e):localize("cursorsAdded","Cursors added: {0}",e))}}class InsertCursorAbove extends EditorAction{constructor(){super({id:"editor.action.insertCursorAbove",label:localize("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&!1===i.logicalLine&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,CursorMoveCommands.addCursorUp(o,r,n)),o.revealTopMostCursor(i.source),announceCursorChange(r,o.getCursorStates())}}class InsertCursorBelow extends EditorAction{constructor(){super({id:"editor.action.insertCursorBelow",label:localize("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&!1===i.logicalLine&&(n=!1);const o=t._getViewModel();if(o.cursorConfig.readOnly)return;o.model.pushStackElement();const r=o.getCursorStates();o.setCursorStates(i.source,3,CursorMoveCommands.addCursorDown(o,r,n)),o.revealBottomMostCursor(i.source),announceCursorChange(r,o.getCursorStates())}}class InsertCursorAtEndOfEachLineSelected extends EditorAction{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:localize("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let n=e.startLineNumber;n<e.endLineNumber;n++){let e=t.getLineMaxColumn(n);i.push(new Selection$1(n,e,n,e))}e.endColumn>1&&i.push(new Selection$1(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections(),o=t._getViewModel(),r=o.getCursorStates();let s=[];n.forEach((e=>this.getCursorsForSelection(e,i,s))),s.length>0&&t.setSelections(s),announceCursorChange(r,o.getCursorStates())}}class InsertCursorAtEndOfLineSelected extends EditorAction{constructor(){super({id:"editor.action.addCursorsToBottom",label:localize("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=t.getModel().getLineCount();let o=[];for(let a=i[0].startLineNumber;a<=n;a++)o.push(new Selection$1(a,i[0].startColumn,a,i[0].endColumn));const r=t._getViewModel(),s=r.getCursorStates();o.length>0&&t.setSelections(o),announceCursorChange(s,r.getCursorStates())}}class InsertCursorAtTopOfLineSelected extends EditorAction{constructor(){super({id:"editor.action.addCursorsToTop",label:localize("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections();let n=[];for(let s=i[0].startLineNumber;s>=1;s--)n.push(new Selection$1(s,i[0].startColumn,s,i[0].endColumn));const o=t._getViewModel(),r=o.getCursorStates();n.length>0&&t.setSelections(n),announceCursorChange(r,o.getCursorStates())}}class MultiCursorSessionResult{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class MultiCursorSession{constructor(e,t,i,n,o,r,s){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=o,this.matchCase=r,this.currentMatch=s}static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new MultiCursorSession(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let n,o,r=!1;const s=e.getSelections();1===s.length&&s[0].isEmpty()?(r=!0,n=!0,o=!0):(n=i.wholeWord,o=i.matchCase);const a=e.getSelection();let l,d=null;if(a.isEmpty()){const t=e.getConfiguredWordAtPosition(a.getStartPosition());if(!t)return null;l=t.word,d=new Selection$1(a.startLineNumber,t.startColumn,a.startLineNumber,t.endColumn)}else l=e.getModel().getValueInRange(a).replace(/\r\n/g,"\n");return new MultiCursorSession(e,t,r,l,n,o,d)}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new MultiCursorSessionResult(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new MultiCursorSessionResult(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1);return i?new Selection$1(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new MultiCursorSessionResult(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new MultiCursorSessionResult(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1);return i?new Selection$1(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(){return this._editor.hasModel()?(this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(117):null,!1,1073741824)):[]}}class MultiCursorSelectionController extends Disposable{constructor(e){super(),this._sessionDispose=this._register(new DisposableStore),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}static get(e){return e.getContribution(MultiCursorSelectionController.ID)}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=MultiCursorSession.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e=>{this._ignoreSelectionChange||this._endSession()}))),this._sessionDispose.add(this._editor.onDidBlurEditorText((()=>{this._endSession()}))),this._sessionDispose.add(e.getState().onFindReplaceStateChange((e=>{(e.matchCase||e.wholeWord)&&this._endSession()})))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new Selection$1(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const i=e.getState().matchCase;if(!modelRangesContainSameText(this._editor.getModel(),t,i)){const e=this._editor.getModel();let i=[];for(let n=0,o=t.length;n<o;n++)i[n]=this._expandEmptyToWord(e,t[n]);return void this._editor.setSelections(i)}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex)t=this._editor.getModel().findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(117):null,!1,1073741824);else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll()}if(i.searchScope){const e=i.searchScope;let n=[];t.forEach((t=>{e.forEach((e=>{t.range.endLineNumber<=e.endLineNumber&&t.range.startLineNumber>=e.startLineNumber&&n.push(t)}))})),t=n}if(t.length>0){const e=this._editor.getSelection();for(let i=0,n=t.length;i<n;i++){const n=t[i];if(n.range.intersectRanges(e)){t[i]=t[0],t[0]=n;break}}this._setSelections(t.map((e=>new Selection$1(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn))))}}}MultiCursorSelectionController.ID="editor.contrib.multiCursorController";class MultiCursorSelectionControllerAction extends EditorAction{run(e,t){const i=MultiCursorSelectionController.get(t);if(!i)return;const n=CommonFindController.get(t);if(!n)return;const o=t._getViewModel();if(o){const e=o.getCursorStates();this._run(i,n),announceCursorChange(e,o.getCursorStates())}}}class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:localize("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:2082,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:localize("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:localize("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:KeyChord(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:localize("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class SelectHighlightsAction extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.selectHighlights",label:localize("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.focus,primary:3114,weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"3_multi",title:localize({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class CompatChangeAll extends MultiCursorSelectionControllerAction{constructor(){super({id:"editor.action.changeAll",label:localize("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.editorTextFocus),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class SelectionHighlighterState{constructor(e,t,i,n,o){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=n,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,o&&this._model===o._model&&this._searchText===o._searchText&&this._matchCase===o._matchCase&&this._wordSeparators===o._wordSeparators&&this._modelVersionId===o._modelVersionId&&(this._cachedFindMatches=o._cachedFindMatches)}findMatches(){return null===this._cachedFindMatches&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map((e=>e.range)),this._cachedFindMatches.sort(Range$2.compareRangesUsingStarts)),this._cachedFindMatches}}let SelectionHighlighter=class e extends Disposable{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(97),this.decorations=[],this.updateSoon=this._register(new RunOnceScheduler((()=>this._update()),300)),this.state=null,this._register(e.onDidChangeConfiguration((t=>{this._isEnabled=e.getOption(97)}))),this._register(e.onDidChangeCursorSelection((e=>{this._isEnabled&&(e.selection.isEmpty()?3===e.reason?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())}))),this._register(e.onDidChangeModel((e=>{this._setState(null)}))),this._register(e.onDidChangeModelContent((e=>{this._isEnabled&&this.updateSoon.schedule()})));const i=CommonFindController.get(e);i&&this._register(i.getState().onFindReplaceStateChange((e=>{this._update()})))}_update(){this._setState(e._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t)return null;if(!i.hasModel())return null;const n=i.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;const o=MultiCursorSelectionController.get(i);if(!o)return null;const r=CommonFindController.get(i);if(!r)return null;let s=o.getSession(r);if(!s){const e=i.getSelections();if(e.length>1){const t=r.getState().matchCase;if(!modelRangesContainSameText(i.getModel(),e,t))return null}s=MultiCursorSession.create(i,r)}if(!s)return null;if(s.currentMatch)return null;if(/^[ \t]+$/.test(s.searchText))return null;if(s.searchText.length>200)return null;const a=r.getState(),l=a.matchCase;if(a.isRevealed){let e=a.searchString;l||(e=e.toLowerCase());let t=s.searchText;if(l||(t=t.toLowerCase()),e===t&&s.matchCase===a.matchCase&&s.wholeWord===a.wholeWord&&!a.isRegex)return null}return new SelectionHighlighterState(i.getModel(),s.searchText,s.matchCase,s.wholeWord?i.getOption(117):null,e)}_setState(t){if(this.state=t,!this.state)return void(this.decorations=this.editor.deltaDecorations(this.decorations,[]));if(!this.editor.hasModel())return;const i=this.editor.getModel();if(i.isTooLargeForTokenization())return;const n=this.state.findMatches(),o=this.editor.getSelections();o.sort(Range$2.compareRangesUsingStarts);const r=[];for(let e=0,l=0,d=n.length,c=o.length;e<d;){const t=n[e];if(l>=c)r.push(t),e++;else{const i=Range$2.compareRangesUsingStarts(t,o[l]);i<0?(!o[l].isEmpty()&&Range$2.areIntersecting(t,o[l])||r.push(t),e++):(i>0||e++,l++)}}const s=this._languageFeaturesService.documentHighlightProvider.has(i)&&this.editor.getOption(72),a=r.map((t=>({range:t,options:s?e._SELECTION_HIGHLIGHT:e._SELECTION_HIGHLIGHT_OVERVIEW})));this.decorations=this.editor.deltaDecorations(this.decorations,a)}dispose(){this._setState(null),super.dispose()}};function modelRangesContainSameText(e,t,i){const n=getValueInRange(e,t[0],!i);for(let o=1,r=t.length;o<r;o++){const r=t[o];if(r.isEmpty())return!1;if(n!==getValueInRange(e,r,!i))return!1}return!0}function getValueInRange(e,t,i){const n=e.getValueInRange(t);return i?n.toLowerCase():n}SelectionHighlighter.ID="editor.contrib.selectionHighlighter",SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW=ModelDecorationOptions.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition$1.Inline},overviewRuler:{color:themeColorFromId(overviewRulerSelectionHighlightForeground),position:OverviewRulerLane$1.Center}}),SelectionHighlighter._SELECTION_HIGHLIGHT=ModelDecorationOptions.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),SelectionHighlighter=__decorate$x([__param$w(1,ILanguageFeaturesService)],SelectionHighlighter),registerEditorContribution(MultiCursorSelectionController.ID,MultiCursorSelectionController),registerEditorContribution(SelectionHighlighter.ID,SelectionHighlighter),registerEditorAction(InsertCursorAbove),registerEditorAction(InsertCursorBelow),registerEditorAction(InsertCursorAtEndOfEachLineSelected),registerEditorAction(AddSelectionToNextFindMatchAction),registerEditorAction(AddSelectionToPreviousFindMatchAction),registerEditorAction(MoveSelectionToNextFindMatchAction),registerEditorAction(MoveSelectionToPreviousFindMatchAction),registerEditorAction(SelectHighlightsAction),registerEditorAction(CompatChangeAll),registerEditorAction(InsertCursorAtEndOfLineSelected),registerEditorAction(InsertCursorAtTopOfLineSelected);var __awaiter$g=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const Context$1={Visible:new RawContextKey("parameterHintsVisible",!1),MultipleSignatures:new RawContextKey("parameterHintsMultipleSignatures",!1)};function provideSignatureHelp(e,t,i,n,o){return __awaiter$g(this,void 0,void 0,(function*(){const r=e.ordered(t);for(const e of r)try{const r=yield e.provideSignatureHelp(t,i,o,n);if(r)return r}catch(s){onUnexpectedExternalError(s)}}))}CommandsRegistry.registerCommand("_executeSignatureHelpProvider",((e,...t)=>__awaiter$g(void 0,void 0,void 0,(function*(){const[i,n,o]=t;assertType(URI.isUri(i)),assertType(Position$1.isIPosition(n)),assertType("string"==typeof o||!o);const r=e.get(ILanguageFeaturesService),s=yield e.get(ITextModelService).createModelReference(i);try{const e=yield provideSignatureHelp(r.signatureHelpProvider,s.object.textEditorModel,Position$1.lift(n),{triggerKind:SignatureHelpTriggerKind$1.Invoke,isRetrigger:!1,triggerCharacter:o},CancellationToken.None);if(!e)return;return setTimeout((()=>e.dispose()),0),e.value}finally{s.dispose()}}))));var parameterHints="",__awaiter$f=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},ParameterHintState;!function(e){e.Default={type:0};e.Pending=class{constructor(e,t){this.request=e,this.previouslyActiveHints=t,this.type=2}};e.Active=class{constructor(e){this.hints=e,this.type=1}}}(ParameterHintState||(ParameterHintState={}));class ParameterHintsModel extends Disposable{constructor(e,t,i=ParameterHintsModel.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new Emitter$1),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=ParameterHintState.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new MutableDisposable),this.triggerChars=new CharacterSet,this.retriggerChars=new CharacterSet,this.triggerId=0,this.editor=e,this.providers=t,this.throttledDelayer=new Delayer(i),this._register(this.editor.onDidBlurEditorWidget((()=>this.cancel()))),this._register(this.editor.onDidChangeConfiguration((()=>this.onEditorConfigurationChange()))),this._register(this.editor.onDidChangeModel((e=>this.onModelChanged()))),this._register(this.editor.onDidChangeModelLanguage((e=>this.onModelChanged()))),this._register(this.editor.onDidChangeCursorSelection((e=>this.onCursorChange(e)))),this._register(this.editor.onDidChangeModelContent((e=>this.onModelContentChange()))),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType((e=>this.onDidType(e)))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){2===this._state.type&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=ParameterHintState.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const i=this.editor.getModel();if(!i||!this.providers.has(i))return;const n=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger((()=>this.doTrigger(n)),t).catch(onUnexpectedError)}next(){if(1!==this.state.type)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t%e==e-1,n=this.editor.getOption(76).cycle;!(e<2||i)||n?this.updateActiveSignature(i&&n?0:t+1):this.cancel()}previous(){if(1!==this.state.type)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=0===t,n=this.editor.getOption(76).cycle;!(e<2||i)||n?this.updateActiveSignature(i&&n?e-1:t-1):this.cancel()}updateActiveSignature(e){1===this.state.type&&(this.state=new ParameterHintState.Active(Object.assign(Object.assign({},this.state.hints),{activeSignature:e})),this._onChangedHints.fire(this.state.hints))}doTrigger(e){return __awaiter$f(this,void 0,void 0,(function*(){const t=1===this.state.type||2===this.state.type,i=this.getLastActiveHints();if(this.cancel(!0),0===this._pendingTriggers.length)return!1;const n=this._pendingTriggers.reduce(mergeTriggerContexts);this._pendingTriggers=[];const o={triggerKind:n.triggerKind,triggerCharacter:n.triggerCharacter,isRetrigger:t,activeSignatureHelp:i};if(!this.editor.hasModel())return!1;const r=this.editor.getModel(),s=this.editor.getPosition();this.state=new ParameterHintState.Pending(createCancelablePromise((e=>provideSignatureHelp(this.providers,r,s,o,e))),i);try{const t=yield this.state.request;return e!==this.triggerId?(null==t||t.dispose(),!1):t&&t.value.signatures&&0!==t.value.signatures.length?(this.state=new ParameterHintState.Active(t.value),this._lastSignatureHelpResult.value=t,this._onChangedHints.fire(this.state.hints),!0):(null==t||t.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1)}catch(a){return e===this.triggerId&&(this.state=ParameterHintState.Default),onUnexpectedError(a),!1}}))}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return 1===this.state.type||2===this.state.type||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars=new CharacterSet,this.retriggerChars=new CharacterSet;const e=this.editor.getModel();if(e)for(const t of this.providers.ordered(e)){for(const e of t.signatureHelpTriggerCharacters||[])this.triggerChars.add(e.charCodeAt(0)),this.retriggerChars.add(e.charCodeAt(0));for(const e of t.signatureHelpRetriggerCharacters||[])this.retriggerChars.add(e.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,i=e.charCodeAt(t);(this.triggerChars.has(i)||this.isTriggered&&this.retriggerChars.has(i))&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){"mouse"===e.source?this.cancel():this.isTriggered&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:SignatureHelpTriggerKind$1.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(76).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}}function mergeTriggerContexts(e,t){switch(t.triggerKind){case SignatureHelpTriggerKind$1.Invoke:return t;case SignatureHelpTriggerKind$1.ContentChange:return e;case SignatureHelpTriggerKind$1.TriggerCharacter:default:return t}}ParameterHintsModel.DEFAULT_DELAY=120;var __decorate$w=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$v=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const $$4=$$c,parameterHintsNextIcon=registerIcon("parameter-hints-next",Codicon.chevronDown,localize("parameterHintsNextIcon","Icon for show next parameter hint.")),parameterHintsPreviousIcon=registerIcon("parameter-hints-previous",Codicon.chevronUp,localize("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let ParameterHintsWidget=class e extends Disposable{constructor(e,t,i,n,o){super(),this.editor=e,this.renderDisposeables=this._register(new DisposableStore),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new MarkdownRenderer({editor:e},n,i)),this.model=this._register(new ParameterHintsModel(e,o.signatureHelpProvider)),this.keyVisible=Context$1.Visible.bindTo(t),this.keyMultipleSignatures=Context$1.MultipleSignatures.bindTo(t),this._register(this.model.onChangedHints((e=>{e?(this.show(),this.render(e)):this.hide()})))}createParameterHintDOMNodes(){const e=$$4(".editor-widget.parameter-hints-widget"),t=append$1(e,$$4(".phwrapper"));t.tabIndex=-1;const i=append$1(t,$$4(".controls")),n=append$1(i,$$4(".button"+ThemeIcon.asCSSSelector(parameterHintsPreviousIcon))),o=append$1(i,$$4(".overloads")),r=append$1(i,$$4(".button"+ThemeIcon.asCSSSelector(parameterHintsNextIcon)));this._register(addDisposableListener(n,"click",(e=>{EventHelper.stop(e),this.previous()}))),this._register(addDisposableListener(r,"click",(e=>{EventHelper.stop(e),this.next()})));const s=$$4(".body"),a=new DomScrollableElement(s,{});this._register(a),t.appendChild(a.getDomNode());const l=append$1(s,$$4(".signature")),d=append$1(s,$$4(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:l,overloads:o,docs:d,scrollbar:a},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection((e=>{this.visible&&this.editor.layoutContentWidget(this)})));const c=()=>{if(!this.domNodes)return;const e=this.editor.getOption(44);this.domNodes.element.style.fontSize=`${e.fontSize}px`,this.domNodes.element.style.lineHeight=""+e.lineHeight/e.fontSize};c(),this._register(Event$1.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter((e=>e.hasChanged(44))).on(c,null)),this._register(this.editor.onDidLayoutChange((e=>this.updateMaxHeight()))),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout((()=>{this.domNodes&&this.domNodes.element.classList.add("visible")}),100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes&&this.domNodes.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){var t;if(this.renderDisposeables.clear(),!this.domNodes)return;const i=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",i),this.keyMultipleSignatures.set(i),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const n=e.signatures[e.activeSignature];if(!n)return;const o=append$1(this.domNodes.signature,$$4(".code")),r=this.editor.getOption(44);o.style.fontSize=`${r.fontSize}px`,o.style.fontFamily=r.fontFamily;const s=n.parameters.length>0,a=null!==(t=n.activeParameter)&&void 0!==t?t:e.activeParameter;if(s)this.renderParameters(o,n,a);else{append$1(o,$$4("span")).textContent=n.label}const l=n.parameters[a];if(null==l?void 0:l.documentation){const e=$$4("span.documentation");if("string"==typeof l.documentation)e.textContent=l.documentation;else{const t=this.renderMarkdownDocs(l.documentation);e.appendChild(t.element)}append$1(this.domNodes.docs,$$4("p",{},e))}if(void 0===n.documentation);else if("string"==typeof n.documentation)append$1(this.domNodes.docs,$$4("p",{},n.documentation));else{const e=this.renderMarkdownDocs(n.documentation);append$1(this.domNodes.docs,e.element)}const d=this.hasDocs(n,l);if(this.domNodes.signature.classList.toggle("has-docs",d),this.domNodes.docs.classList.toggle("empty",!d),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,l){let e="";const t=n.parameters[a];e=Array.isArray(t.label)?n.label.substring(t.label[0],t.label[1]):t.label,t.documentation&&(e+="string"==typeof t.documentation?`, ${t.documentation}`:`, ${t.documentation.value}`),n.documentation&&(e+="string"==typeof n.documentation?`, ${n.documentation}`:`, ${n.documentation.value}`),this.announcedLabel!==e&&(alert(localize("hint","{0}, hint",e)),this.announcedLabel=e)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{var e;null===(e=this.domNodes)||void 0===e||e.scrollbar.scanDomNode()}}));return t.element.classList.add("markdown-docs"),t}hasDocs(e,t){return!!(t&&"string"==typeof t.documentation&&assertIsDefined(t.documentation).length>0)||(!!(t&&"object"==typeof t.documentation&&assertIsDefined(t.documentation).value.length>0)||(!!(e.documentation&&"string"==typeof e.documentation&&assertIsDefined(e.documentation).length>0)||!!(e.documentation&&"object"==typeof e.documentation&&assertIsDefined(e.documentation.value).length>0)))}renderParameters(e,t,i){const[n,o]=this.getParameterLabelOffsets(t,i),r=document.createElement("span");r.textContent=t.label.substring(0,n);const s=document.createElement("span");s.textContent=t.label.substring(n,o),s.className="parameter active";const a=document.createElement("span");a.textContent=t.label.substring(o),append$1(e,r,s,a)}getParameterLabelOffsets(e,t){const i=e.parameters[t];if(i){if(Array.isArray(i.label))return i.label;if(i.label.length){const t=new RegExp(`(\\W|^)${escapeRegExpCharacters(i.label)}(?=\\W|$)`,"g");t.test(e.label);const n=t.lastIndex-i.label.length;return n>=0?[n,t.lastIndex]:[0,0]}return[0,0]}return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}cancel(){this.model.cancel()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return e.ID}trigger(e){this.model.trigger(e,0)}updateMaxHeight(){if(!this.domNodes)return;const e=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=e;const t=this.domNodes.element.getElementsByClassName("phwrapper");t.length&&(t[0].style.maxHeight=e)}};ParameterHintsWidget.ID="editor.widget.parameterHintsWidget",ParameterHintsWidget=__decorate$w([__param$v(1,IContextKeyService),__param$v(2,IOpenerService),__param$v(3,ILanguageService),__param$v(4,ILanguageFeaturesService)],ParameterHintsWidget);const editorHoverWidgetHighlightForeground=registerColor("editorHoverWidget.highlightForeground",{dark:listHighlightForeground,light:listHighlightForeground,hc:listHighlightForeground},localize("editorHoverWidgetHighlightForeground","Foreground color of the active item in the parameter hint."));registerThemingParticipant(((e,t)=>{const i=e.getColor(editorHoverBorder);if(i){const n=e.type===ColorScheme.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .parameter-hints-widget { border: ${n}px solid ${i}; }`),t.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${i.transparent(.5)}; }`)}const n=e.getColor(editorHoverBackground);n&&t.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${n}; }`);const o=e.getColor(textLinkForeground);o&&t.addRule(`.monaco-editor .parameter-hints-widget a { color: ${o}; }`);const r=e.getColor(textLinkActiveForeground);r&&t.addRule(`.monaco-editor .parameter-hints-widget a:hover { color: ${r}; }`);const s=e.getColor(editorHoverForeground);s&&t.addRule(`.monaco-editor .parameter-hints-widget { color: ${s}; }`);const a=e.getColor(textCodeBlockBackground);a&&t.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${a}; }`);const l=e.getColor(editorHoverWidgetHighlightForeground);l&&t.addRule(`.monaco-editor .parameter-hints-widget .parameter.active { color: ${l}}`)}));var __decorate$v=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$u=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ParameterHintsController=class e extends Disposable{constructor(e,t){super(),this.editor=e,this.widget=this._register(t.createInstance(ParameterHintsWidget,this.editor))}static get(t){return t.getContribution(e.ID)}cancel(){this.widget.cancel()}previous(){this.widget.previous()}next(){this.widget.next()}trigger(e){this.widget.trigger(e)}};ParameterHintsController.ID="editor.controller.parameterHints",ParameterHintsController=__decorate$v([__param$u(1,IInstantiationService)],ParameterHintsController);class TriggerParameterHintsAction extends EditorAction{constructor(){super({id:"editor.action.triggerParameterHints",label:localize("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:EditorContextKeys.hasSignatureHelpProvider,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:3082,weight:100}})}run(e,t){const i=ParameterHintsController.get(t);i&&i.trigger({triggerKind:SignatureHelpTriggerKind$1.Invoke})}}registerEditorContribution(ParameterHintsController.ID,ParameterHintsController),registerEditorAction(TriggerParameterHintsAction);const weight=175,ParameterHintsCommand=EditorCommand.bindToContribution(ParameterHintsController.get);registerEditorCommand(new ParameterHintsCommand({id:"closeParameterHints",precondition:Context$1.Visible,handler:e=>e.cancel(),kbOpts:{weight:weight,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}})),registerEditorCommand(new ParameterHintsCommand({id:"showPrevParameterHint",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.MultipleSignatures),handler:e=>e.previous(),kbOpts:{weight:weight,kbExpr:EditorContextKeys.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),registerEditorCommand(new ParameterHintsCommand({id:"showNextParameterHint",precondition:ContextKeyExpr.and(Context$1.Visible,Context$1.MultipleSignatures),handler:e=>e.next(),kbOpts:{weight:weight,kbExpr:EditorContextKeys.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));const ITextResourceConfigurationService=createDecorator("textResourceConfigurationService"),ITextResourcePropertiesService=createDecorator("textResourcePropertiesService");var renameInputField="",__decorate$u=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$t=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const CONTEXT_RENAME_INPUT_VISIBLE=new RawContextKey("renameInputVisible",!1,localize("renameInputVisible","Whether the rename input widget is visible"));let RenameInputField=class{constructor(e,t,i,n,o){this._editor=e,this._acceptKeybindings=t,this._themeService=i,this._keybindingService=n,this._disposables=new DisposableStore,this.allowEditorOverflow=!0,this._visibleContextKey=CONTEXT_RENAME_INPUT_VISIBLE.bindTo(o),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(44)&&this._updateFont()}))),this._disposables.add(i.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){if(!this._domNode){this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._input=document.createElement("input"),this._input.className="rename-input",this._input.type="text",this._input.setAttribute("aria-label",localize("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._input),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label);const e=()=>{var e,t;const[i,n]=this._acceptKeybindings;this._keybindingService.lookupKeybinding(i),this._label.innerText=localize({key:"label",comment:['placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"']},"{0} to Rename, {1} to Preview",null===(e=this._keybindingService.lookupKeybinding(i))||void 0===e?void 0:e.getLabel(),null===(t=this._keybindingService.lookupKeybinding(n))||void 0===t?void 0:t.getLabel())};e(),this._disposables.add(this._keybindingService.onDidUpdateKeybindings(e)),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())}return this._domNode}_updateStyles(e){var t,i,n,o;if(!this._input||!this._domNode)return;const r=e.getColor(widgetShadow);this._domNode.style.backgroundColor=String(null!==(t=e.getColor(editorWidgetBackground))&&void 0!==t?t:""),this._domNode.style.boxShadow=r?` 0 0 8px 2px ${r}`:"",this._domNode.style.color=String(null!==(i=e.getColor(inputForeground))&&void 0!==i?i:""),this._input.style.backgroundColor=String(null!==(n=e.getColor(inputBackground))&&void 0!==n?n:"");const s=e.getColor(inputBorder);this._input.style.borderWidth=s?"1px":"0px",this._input.style.borderStyle=s?"solid":"none",this._input.style.borderColor=null!==(o=null==s?void 0:s.toString())&&void 0!==o?o:"none"}_updateFont(){if(!this._input||!this._label)return;const e=this._editor.getOption(44);this._input.style.fontFamily=e.fontFamily,this._input.style.fontWeight=e.fontWeight,this._input.style.fontSize=`${e.fontSize}px`,this._label.style.fontSize=.8*e.fontSize+"px"}getPosition(){return this._visible?{position:this._position,preference:[2,1]}:null}afterRender(e){e||this.cancelInput(!0)}acceptInput(e){this._currentAcceptInput&&this._currentAcceptInput(e)}cancelInput(e){this._currentCancelInput&&this._currentCancelInput(e)}getInput(e,t,i,n,o,r){this._domNode.classList.toggle("preview",o),this._position=new Position$1(e.startLineNumber,e.startColumn),this._input.value=t,this._input.setAttribute("selectionStart",i.toString()),this._input.setAttribute("selectionEnd",n.toString()),this._input.size=Math.max(1.1*(e.endColumn-e.startColumn),20);const s=new DisposableStore;return new Promise((e=>{this._currentCancelInput=t=>(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e(t),!0),this._currentAcceptInput=i=>{0!==this._input.value.trim().length&&this._input.value!==t?(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e({newName:this._input.value,wantsPreview:o&&i})):this.cancelInput(!0)},s.add(r.onCancellationRequested((()=>this.cancelInput(!0)))),s.add(this._editor.onDidBlurEditorWidget((()=>this.cancelInput(!1)))),this._show()})).finally((()=>{s.dispose(),this._hide()}))}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout((()=>{this._input.focus(),this._input.setSelectionRange(parseInt(this._input.getAttribute("selectionStart")),parseInt(this._input.getAttribute("selectionEnd")))}),100)}_hide(){this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}};RenameInputField=__decorate$u([__param$t(2,IThemeService),__param$t(3,IKeybindingService),__param$t(4,IContextKeyService)],RenameInputField);var __decorate$t=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$s=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$e=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class RenameSkeleton{constructor(e,t,i){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=i.ordered(e)}hasProvider(){return this._providers.length>0}resolveRenameLocation(e){return __awaiter$e(this,void 0,void 0,(function*(){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const i=this._providers[this._providerRenameIdx];if(!i.resolveRenameLocation)break;let n=yield i.resolveRenameLocation(this.model,this.position,e);if(n){if(!n.rejectReason)return n;t.push(n.rejectReason)}}const i=this.model.getWordAtPosition(this.position);return i?{range:new Range$2(this.position.lineNumber,i.startColumn,this.position.lineNumber,i.endColumn),text:i.word,rejectReason:t.length>0?t.join("\n"):void 0}:{range:Range$2.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join("\n"):void 0}}))}provideRenameEdits(e,t){return __awaiter$e(this,void 0,void 0,(function*(){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}))}_provideRenameEdits(e,t,i,n){return __awaiter$e(this,void 0,void 0,(function*(){const o=this._providers[t];if(!o)return{edits:[],rejectReason:i.join("\n")};const r=yield o.provideRenameEdits(this.model,this.position,e,n);return r?r.rejectReason?this._provideRenameEdits(e,t+1,i.concat(r.rejectReason),n):r:this._provideRenameEdits(e,t+1,i.concat(localize("no result","No result.")),n)}))}}function rename(e,t,i,n){return __awaiter$e(this,void 0,void 0,(function*(){const o=new RenameSkeleton(t,i,e),r=yield o.resolveRenameLocation(CancellationToken.None);return(null==r?void 0:r.rejectReason)?{edits:[],rejectReason:r.rejectReason}:o.provideRenameEdits(n,CancellationToken.None)}))}let RenameController=class e{constructor(e,t,i,n,o,r,s,a){this.editor=e,this._instaService=t,this._notificationService=i,this._bulkEditService=n,this._progressService=o,this._logService=r,this._configService=s,this._languageFeaturesService=a,this._dispoableStore=new DisposableStore,this._cts=new CancellationTokenSource$1,this._renameInputField=this._dispoableStore.add(new IdleValue((()=>this._dispoableStore.add(this._instaService.createInstance(RenameInputField,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"])))))}static get(t){return t.getContribution(e.ID)}dispose(){this._dispoableStore.dispose(),this._cts.dispose(!0)}run(){var e,t;return __awaiter$e(this,void 0,void 0,(function*(){if(this._cts.dispose(!0),!this.editor.hasModel())return;const i=this.editor.getPosition(),n=new RenameSkeleton(this.editor.getModel(),i,this._languageFeaturesService.renameProvider);if(!n.hasProvider())return;let o;this._cts=new EditorStateCancellationTokenSource(this.editor,5);try{const e=n.resolveRenameLocation(this._cts.token);this._progressService.showWhile(e,250),o=yield e}catch(e2){return void(null===(e=MessageController.get(this.editor))||void 0===e||e.showMessage(e2||localize("resolveRenameLocationFailed","An unknown error occurred while resolving rename location"),i))}if(!o)return;if(o.rejectReason)return void(null===(t=MessageController.get(this.editor))||void 0===t||t.showMessage(o.rejectReason,i));if(this._cts.token.isCancellationRequested)return;this._cts.dispose(),this._cts=new EditorStateCancellationTokenSource(this.editor,5,o.range);let r=this.editor.getSelection(),s=0,a=o.text.length;Range$2.isEmpty(r)||Range$2.spansMultipleLines(r)||!Range$2.containsRange(o.range,r)||(s=Math.max(0,r.startColumn-o.range.startColumn),a=Math.min(o.range.endColumn,r.endColumn)-o.range.startColumn);const l=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),d=yield this._renameInputField.value.getInput(o.range,o.text,s,a,l,this._cts.token);if("boolean"==typeof d)return void(d&&this.editor.focus());this.editor.focus();const c=raceCancellation(n.provideRenameEdits(d.newName,this._cts.token),this._cts.token).then((e=>__awaiter$e(this,void 0,void 0,(function*(){e&&this.editor.hasModel()&&(e.rejectReason?this._notificationService.info(e.rejectReason):(this.editor.setSelection(Range$2.fromPositions(this.editor.getSelection().getPosition())),this._bulkEditService.apply(ResourceEdit.convert(e),{editor:this.editor,showPreview:d.wantsPreview,label:localize("label","Renaming '{0}'",null==o?void 0:o.text),quotableLabel:localize("quotableLabel","Renaming {0}",null==o?void 0:o.text)}).then((e=>{e.ariaSummary&&alert(localize("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",o.text,d.newName,e.ariaSummary))})).catch((e=>{this._notificationService.error(localize("rename.failedApply","Rename failed to apply edits")),this._logService.error(e)}))))}))),(e=>{this._notificationService.error(localize("rename.failed","Rename failed to compute edits")),this._logService.error(e)}));return this._progressService.showWhile(c,250),c}))}acceptRenameInput(e){this._renameInputField.value.acceptInput(e)}cancelRenameInput(){this._renameInputField.value.cancelInput(!0)}};RenameController.ID="editor.contrib.renameController",RenameController=__decorate$t([__param$s(1,IInstantiationService),__param$s(2,INotificationService),__param$s(3,IBulkEditService),__param$s(4,IEditorProgressService),__param$s(5,ILogService),__param$s(6,ITextResourceConfigurationService),__param$s(7,ILanguageFeaturesService)],RenameController);class RenameAction extends EditorAction{constructor(){super({id:"editor.action.rename",label:localize("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:ContextKeyExpr.and(EditorContextKeys.writable,EditorContextKeys.hasRenameProvider),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(e,t){const i=e.get(ICodeEditorService),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return URI.isUri(n)&&Position$1.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(o),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),onUnexpectedError):super.runCommand(e,t)}run(e,t){const i=RenameController.get(t);return i?i.run():Promise.resolve()}}registerEditorContribution(RenameController.ID,RenameController),registerEditorAction(RenameAction);const RenameCommand=EditorCommand.bindToContribution(RenameController.get);registerEditorCommand(new RenameCommand({id:"acceptRenameInput",precondition:CONTEXT_RENAME_INPUT_VISIBLE,handler:e=>e.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:EditorContextKeys.focus,primary:3}})),registerEditorCommand(new RenameCommand({id:"acceptRenameInputWithPreview",precondition:ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE,ContextKeyExpr.has("config.editor.rename.enablePreview")),handler:e=>e.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:EditorContextKeys.focus,primary:1027}})),registerEditorCommand(new RenameCommand({id:"cancelRenameInput",precondition:CONTEXT_RENAME_INPUT_VISIBLE,handler:e=>e.cancelRenameInput(),kbOpts:{weight:199,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}})),registerModelAndPositionCommand("_executeDocumentRenameProvider",(function(e,t,i,...n){const[o]=n;assertType("string"==typeof o);const{renameProvider:r}=e.get(ILanguageFeaturesService);return rename(r,t,i,o)})),registerModelAndPositionCommand("_executePrepareRename",(function(e,t,i){return __awaiter$e(this,void 0,void 0,(function*(){const{renameProvider:n}=e.get(ILanguageFeaturesService),o=new RenameSkeleton(t,i,n),r=yield o.resolveRenameLocation(CancellationToken.None);if(null==r?void 0:r.rejectReason)throw new Error(r.rejectReason);return r}))})),Registry.as(Extensions$3.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:localize("enablePreview","Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});class WordSelectionRangeProvider{provideSelectionRanges(e,t){const i=[];for(const n of t){const t=[];i.push(t),this._addInWordRanges(t,e,n),this._addWordRanges(t,e,n),this._addWhitespaceLine(t,e,n),t.push({range:e.getFullModelRange()})}return i}_addInWordRanges(e,t,i){const n=t.getWordAtPosition(i);if(!n)return;let{word:o,startColumn:r}=n,s=i.column-r,a=s,l=s,d=0;for(;a>=0;a--){let e=o.charCodeAt(a);if(a!==s&&(95===e||45===e))break;if(isLowerAsciiLetter(e)&&isUpperAsciiLetter(d))break;d=e}for(a+=1;l<o.length;l++){let e=o.charCodeAt(l);if(isUpperAsciiLetter(e)&&isLowerAsciiLetter(d))break;if(95===e||45===e)break;d=e}a<l&&e.push({range:new Range$2(i.lineNumber,r+a,i.lineNumber,r+l)})}_addWordRanges(e,t,i){const n=t.getWordAtPosition(i);n&&e.push({range:new Range$2(i.lineNumber,n.startColumn,i.lineNumber,n.endColumn)})}_addWhitespaceLine(e,t,i){t.getLineLength(i.lineNumber)>0&&0===t.getLineFirstNonWhitespaceColumn(i.lineNumber)&&0===t.getLineLastNonWhitespaceColumn(i.lineNumber)&&e.push({range:new Range$2(i.lineNumber,1,i.lineNumber,t.getLineMaxColumn(i.lineNumber))})}}var __decorate$s=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$r=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$d=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class SelectionRanges{constructor(e,t){this.index=e,this.ranges=t}mov(e){let t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const i=new SelectionRanges(t,this.ranges);return i.ranges[t].equalsRange(this.ranges[this.index])?i.mov(e):i}}let SmartSelectController=class e{constructor(e,t){this._editor=e,this._languageFeaturesService=t,this._ignoreSelection=!1}static get(t){return t.getContribution(e.ID)}dispose(){var e;null===(e=this._selectionListener)||void 0===e||e.dispose()}run(e){return __awaiter$d(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),i=this._editor.getModel();if(this._state||(yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider,i,t.map((e=>e.getPosition())),this._editor.getOption(102),CancellationToken.None).then((e=>{var i;if(isNonEmptyArray(e)&&e.length===t.length&&this._editor.hasModel()&&equals$1(this._editor.getSelections(),t,((e,t)=>e.equalsSelection(t)))){for(let i=0;i<e.length;i++)e[i]=e[i].filter((e=>e.containsPosition(t[i].getStartPosition())&&e.containsPosition(t[i].getEndPosition()))),e[i].unshift(t[i]);this._state=e.map((e=>new SelectionRanges(0,e))),null===(i=this._selectionListener)||void 0===i||i.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition((()=>{var e;this._ignoreSelection||(null===(e=this._selectionListener)||void 0===e||e.dispose(),this._state=void 0)}))}}))),!this._state)return;this._state=this._state.map((t=>t.mov(e)));const n=this._state.map((e=>Selection$1.fromPositions(e.ranges[e.index].getStartPosition(),e.ranges[e.index].getEndPosition())));this._ignoreSelection=!0;try{this._editor.setSelections(n)}finally{this._ignoreSelection=!1}}))}};SmartSelectController.ID="editor.contrib.smartSelectController",SmartSelectController=__decorate$s([__param$r(1,ILanguageFeaturesService)],SmartSelectController);class AbstractSmartSelect extends EditorAction{constructor(e,t){super(t),this._forward=e}run(e,t){return __awaiter$d(this,void 0,void 0,(function*(){let e=SmartSelectController.get(t);e&&(yield e.run(this._forward))}))}}class GrowSelectionAction extends AbstractSmartSelect{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:localize("smartSelect.expand","Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSmartSelectGrow",comment:["&& denotes a mnemonic"]},"&&Expand Selection"),order:2}})}}CommandsRegistry.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class ShrinkSelectionAction extends AbstractSmartSelect{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:localize("smartSelect.shrink","Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:MenuId.MenubarSelectionMenu,group:"1_basic",title:localize({key:"miSmartSelectShrink",comment:["&& denotes a mnemonic"]},"&&Shrink Selection"),order:3}})}}function provideSelectionRanges(e,t,i,n,o){return __awaiter$d(this,void 0,void 0,(function*(){const r=e.all(t).concat(new WordSelectionRangeProvider);1===r.length&&r.unshift(new BracketSelectionRangeProvider);let s=[],a=[];for(const e of r)s.push(Promise.resolve(e.provideSelectionRanges(t,i,o)).then((e=>{if(isNonEmptyArray(e)&&e.length===i.length)for(let t=0;t<i.length;t++){a[t]||(a[t]=[]);for(const n of e[t])Range$2.isIRange(n.range)&&Range$2.containsPosition(n.range,i[t])&&a[t].push(Range$2.lift(n.range))}}),onUnexpectedExternalError));return yield Promise.all(s),a.map((e=>{if(0===e.length)return[];e.sort(((e,t)=>Position$1.isBefore(e.getStartPosition(),t.getStartPosition())?1:Position$1.isBefore(t.getStartPosition(),e.getStartPosition())||Position$1.isBefore(e.getEndPosition(),t.getEndPosition())?-1:Position$1.isBefore(t.getEndPosition(),e.getEndPosition())?1:0));let i,o=[];for(const t of e)(!i||Range$2.containsRange(t,i)&&!Range$2.equalsRange(t,i))&&(o.push(t),i=t);if(!n.selectLeadingAndTrailingWhitespace)return o;let r=[o[0]];for(let n=1;n<o.length;n++){const e=o[n-1],i=o[n];if(i.startLineNumber!==e.startLineNumber||i.endLineNumber!==e.endLineNumber){const n=new Range$2(e.startLineNumber,t.getLineFirstNonWhitespaceColumn(e.startLineNumber),e.endLineNumber,t.getLineLastNonWhitespaceColumn(e.endLineNumber));n.containsRange(e)&&!n.equalsRange(e)&&i.containsRange(n)&&!i.equalsRange(n)&&r.push(n);const o=new Range$2(e.startLineNumber,1,e.endLineNumber,t.getLineMaxColumn(e.endLineNumber));o.containsRange(e)&&!o.equalsRange(n)&&i.containsRange(o)&&!i.equalsRange(o)&&r.push(o)}r.push(i)}return r}))}))}registerEditorContribution(SmartSelectController.ID,SmartSelectController),registerEditorAction(GrowSelectionAction),registerEditorAction(ShrinkSelectionAction),CommandsRegistry.registerCommand("_executeSelectionRangeProvider",(function(e,...t){return __awaiter$d(this,void 0,void 0,(function*(){const[i,n]=t;assertType(URI.isUri(i));const o=e.get(ILanguageFeaturesService).selectionRangeProvider,r=yield e.get(ITextModelService).createModelReference(i);try{return provideSelectionRanges(o,r.object.textEditorModel,n,{selectLeadingAndTrailingWhitespace:!0},CancellationToken.None)}finally{r.dispose()}}))}));class ForceRetokenizeAction extends EditorAction{constructor(){super({id:"editor.action.forceRetokenize",label:localize("forceRetokenize","Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();i.resetTokenization();const n=new StopWatch(!0);i.forceTokenization(i.getLineCount()),n.stop()}}registerEditorAction(ForceRetokenizeAction);class ToggleTabFocusModeAction extends EditorAction{constructor(){super({id:ToggleTabFocusModeAction.ID,label:localize({key:"toggle.tabMovesFocus",comment:["Turn on/off use of tab key for moving focus around VS Code"]},"Toggle Tab Key Moves Focus"),alias:"Toggle Tab Key Moves Focus",precondition:void 0,kbOpts:{kbExpr:null,primary:2091,mac:{primary:1323},weight:100}})}run(e,t){const i=!TabFocus.getTabFocusMode();TabFocus.setTabFocusMode(i),alert(i?localize("toggle.tabMovesFocus.on","Pressing Tab will now move focus to the next focusable element"):localize("toggle.tabMovesFocus.off","Pressing Tab will now insert the tab character"))}}ToggleTabFocusModeAction.ID="editor.action.toggleTabFocusMode",registerEditorAction(ToggleTabFocusModeAction);var unicodeHighlighter="";class UnicodeTextModelHighlighter{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,o=i?i.endLineNumber:e.getLineCount(),r=new CodePointHighlighter(t),s=r.getCandidateCodePoints();let a;a="allNonBasicAscii"===s?new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):new RegExp(`${buildRegExpCharClassExpr(Array.from(s))}`,"g");const l=new Searcher(null,a),d=[];let c,h=!1,u=0,g=0,p=0;e:for(let m=n,f=o;m<=f;m++){const t=e.getLineContent(m),i=t.length;l.reset(0);do{if(c=l.next(t),c){let e=c.index,n=c.index+c[0].length;if(e>0){isHighSurrogate(t.charCodeAt(e-1))&&e--}if(n+1<i){isHighSurrogate(t.charCodeAt(n-1))&&n++}const o=t.substring(e,n),s=getWordAtText(e+1,DEFAULT_WORD_REGEXP,t,0),a=r.shouldHighlightNonBasicASCII(o,s?s.word:null);if(0!==a){3===a?u++:2===a?g++:1===a?p++:assertNever();const t=1e3;if(d.length>=t){h=!0;break e}d.push(new Range$2(m,e+1,m,n+1))}}}while(c)}return{ranges:d,hasMore:h,ambiguousCharacterCount:u,invisibleCharacterCount:g,nonBasicAsciiCharacterCount:p}}static computeUnicodeHighlightReason(e,t){const i=new CodePointHighlighter(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const n=e.codePointAt(0),o=i.ambiguousCharacters.getPrimaryConfusable(n),r=AmbiguousCharacters.getLocales().filter((e=>!AmbiguousCharacters.getInstance(new Set([...t.allowedLocales,e])).isAmbiguous(n)));return{kind:0,confusableWith:String.fromCodePoint(o),notAmbiguousInLocales:r}}case 1:return{kind:2}}}}function buildRegExpCharClassExpr(e,t){return`[${escapeRegExpCharacters(e.map((e=>String.fromCodePoint(e))).join(""))}]`}class CodePointHighlighter{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=AmbiguousCharacters.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of InvisibleCharacters.codePoints)isAllowedInvisibleCharacter(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,o=!1;if(t)for(let r of t){const e=r.codePointAt(0),t=isBasicASCII(r);n=n||t,t||this.ambiguousCharacters.isAmbiguous(e)||InvisibleCharacters.isInvisibleCharacter(e)||(o=!0)}return!n&&o?0:this.options.invisibleCharacters&&!isAllowedInvisibleCharacter(e)&&InvisibleCharacters.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function isAllowedInvisibleCharacter(e){return" "===e||"\n"===e||"\t"===e}var bannerController="",__decorate$r=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$q=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let Link=class extends Disposable{constructor(e,t,i={},n){var o;super(),this._link=t,this._enabled=!0,this.el=append$1(e,$$c("a.monaco-link",{tabIndex:null!==(o=t.tabIndex)&&void 0!==o?o:0,href:t.href,title:t.title},t.label)),this.el.setAttribute("role","button");const r=this._register(new DomEmitter(this.el,"click")),s=this._register(new DomEmitter(this.el,"keypress")),a=Event$1.chain(s.event).map((e=>new StandardKeyboardEvent(e))).filter((e=>3===e.keyCode)).event,l=this._register(new DomEmitter(this.el,EventType.Tap)).event;this._register(Gesture.addTarget(this.el));const d=Event$1.any(r.event,a,l);this._register(d((e=>{this.enabled&&(EventHelper.stop(e,!0),(null==i?void 0:i.opener)?i.opener(this._link.href):n.open(this._link.href,{allowCommands:!0}))}))),this.enabled=!0}get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}};Link=__decorate$r([__param$q(3,IOpenerService)],Link),registerThemingParticipant(((e,t)=>{const i=e.getColor(textLinkForeground);i&&t.addRule(`.monaco-link { color: ${i}; }`);const n=e.getColor(textLinkActiveForeground);n&&t.addRule(`.monaco-link:hover { color: ${n}; }`)}));var __decorate$q=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$p=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const BANNER_ELEMENT_HEIGHT=26;let BannerController=class extends Disposable{constructor(e,t){super(),this._editor=e,this.instantiationService=t,this.banner=this._register(this.instantiationService.createInstance(Banner))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(e){this.banner.show(Object.assign(Object.assign({},e),{onClose:()=>{this.hide(),e.onClose&&e.onClose()}})),this._editor.setBanner(this.banner.element,BANNER_ELEMENT_HEIGHT)}};BannerController=__decorate$q([__param$p(1,IInstantiationService)],BannerController);let Banner=class extends Disposable{constructor(e){super(),this.instantiationService=e,this.markdownRenderer=this.instantiationService.createInstance(MarkdownRenderer,{}),this.element=$$c("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(e){return e.ariaLabel?e.ariaLabel:"string"==typeof e.message?e.message:void 0}getBannerMessage(e){if("string"==typeof e){const t=$$c("span");return t.innerText=e,t}return this.markdownRenderer.render(e).element}clear(){clearNode(this.element)}show(e){clearNode(this.element);const t=this.getAriaLabel(e);t&&this.element.setAttribute("aria-label",t);const i=append$1(this.element,$$c("div.icon-container"));i.setAttribute("aria-hidden","true"),e.icon&&i.appendChild($$c(`div${ThemeIcon.asCSSSelector(e.icon)}`));const n=append$1(this.element,$$c("div.message-container"));if(n.setAttribute("aria-hidden","true"),n.appendChild(this.getBannerMessage(e.message)),this.messageActionsContainer=append$1(this.element,$$c("div.message-actions-container")),e.actions)for(const r of e.actions)this._register(this.instantiationService.createInstance(Link,this.messageActionsContainer,Object.assign(Object.assign({},r),{tabIndex:-1}),{}));const o=append$1(this.element,$$c("div.action-container"));this.actionBar=this._register(new ActionBar(o)),this.actionBar.push(this._register(new Action("banner.close","Close Banner",ThemeIcon.asClassName(widgetClose),!0,(()=>{"function"==typeof e.onClose&&e.onClose()}))),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};Banner=__decorate$q([__param$p(0,IInstantiationService)],Banner);const IWorkspaceTrustManagementService=createDecorator("workspaceTrustManagementService");var __decorate$p=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$o=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$c=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const warningIcon=registerIcon("extensions-warning-message",Codicon.warning,localize("warningIcon","Icon shown with a warning message in the extensions editor."));let UnicodeHighlighter=class extends Disposable{constructor(e,t,i,n){super(),this._editor=e,this._editorWorkerService=t,this._workspaceTrustService=i,this._highlighter=null,this._bannerClosed=!1,this._updateState=e=>{if(e&&e.hasMore){if(this._bannerClosed)return;const t=Math.max(e.ambiguousCharacterCount,e.nonBasicAsciiCharacterCount,e.invisibleCharacterCount);let i;if(e.nonBasicAsciiCharacterCount>=t)i={message:localize("unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters","This document contains many non-basic ASCII unicode characters"),command:new DisableHighlightingOfNonBasicAsciiCharactersAction};else if(e.ambiguousCharacterCount>=t)i={message:localize("unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters","This document contains many ambiguous unicode characters"),command:new DisableHighlightingOfAmbiguousCharactersAction};else{if(!(e.invisibleCharacterCount>=t))throw new Error("Unreachable");i={message:localize("unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters","This document contains many invisible unicode characters"),command:new DisableHighlightingOfInvisibleCharactersAction}}this._bannerController.show({id:"unicodeHighlightBanner",message:i.message,icon:warningIcon,actions:[{label:i.command.shortLabel,href:`command:${i.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(n.createInstance(BannerController,e)),this._register(this._editor.onDidChangeModel((()=>{this._bannerClosed=!1,this._updateHighlighter()}))),this._options=e.getOption(113),this._register(i.onDidChangeTrust((e=>{this._updateHighlighter()}))),this._register(e.onDidChangeConfiguration((t=>{t.hasChanged(113)&&(this._options=e.getOption(113),this._updateHighlighter())}))),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const e=resolveOptions(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([e.nonBasicASCII,e.ambiguousCharacters,e.invisibleCharacters].every((e=>!1===e)))return;const t={nonBasicASCII:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments,includeStrings:e.includeStrings,allowedCodePoints:Object.keys(e.allowedCharacters).map((e=>e.codePointAt(0))),allowedLocales:Object.keys(e.allowedLocales).map((e=>{if("_os"===e){return(new Intl.NumberFormat).resolvedOptions().locale}return"_vscode"===e?language:e}))};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new DocumentUnicodeHighlighter(this._editor,t,this._updateState,this._editorWorkerService):this._highlighter=new ViewportUnicodeHighlighter(this._editor,t,this._updateState)}getDecorationInfo(e){return this._highlighter?this._highlighter.getDecorationInfo(e):null}};function resolveOptions(e,t){return{nonBasicASCII:t.nonBasicASCII===inUntrustedWorkspace?!e:t.nonBasicASCII,ambiguousCharacters:t.ambiguousCharacters,invisibleCharacters:t.invisibleCharacters,includeComments:t.includeComments===inUntrustedWorkspace?!e:t.includeComments,includeStrings:t.includeStrings===inUntrustedWorkspace?!e:t.includeStrings,allowedCharacters:t.allowedCharacters,allowedLocales:t.allowedLocales}}UnicodeHighlighter.ID="editor.contrib.unicodeHighlighter",UnicodeHighlighter=__decorate$p([__param$o(1,IEditorWorkerService),__param$o(2,IWorkspaceTrustManagementService),__param$o(3,IInstantiationService)],UnicodeHighlighter);let DocumentUnicodeHighlighter=class extends Disposable{constructor(e,t,i,n){super(),this._editor=e,this._options=t,this._updateState=i,this._editorWorkerService=n,this._model=this._editor.getModel(),this._decorationIds=new Set,this._updateSoon=this._register(new RunOnceScheduler((()=>this._update()),250)),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorationIds=new Set(this._model.deltaDecorations(Array.from(this._decorationIds),[])),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void(this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),[])));const e=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then((t=>{if(this._model.isDisposed())return;if(this._model.getVersionId()!==e)return;this._updateState(t);const i=[];if(!t.hasMore)for(const e of t.ranges)i.push({range:e,options:Decorations.instance.getDecorationFromOptions(this._options)});this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),i))}))}getDecorationInfo(e){if(!this._decorationIds.has(e))return null;const t=this._editor.getModel(),i=t.getDecorationRange(e),n={range:i,options:Decorations.instance.getDecorationFromOptions(this._options),id:e,ownerId:0};if(!isModelDecorationVisible(t,n))return null;return{reason:computeReason(t.getValueInRange(i),this._options),inComment:isModelDecorationInComment(t,n),inString:isModelDecorationInString(t,n)}}};DocumentUnicodeHighlighter=__decorate$p([__param$o(3,IEditorWorkerService)],DocumentUnicodeHighlighter);class ViewportUnicodeHighlighter extends Disposable{constructor(e,t,i){super(),this._editor=e,this._options=t,this._updateState=i,this._model=this._editor.getModel(),this._decorationIds=new Set,this._updateSoon=this._register(new RunOnceScheduler((()=>this._update()),250)),this._register(this._editor.onDidLayoutChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidScrollChange((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeHiddenAreas((()=>{this._updateSoon.schedule()}))),this._register(this._editor.onDidChangeModelContent((()=>{this._updateSoon.schedule()}))),this._updateSoon.schedule()}dispose(){this._decorationIds=new Set(this._model.deltaDecorations(Array.from(this._decorationIds),[])),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII())return void(this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),[])));const e=this._editor.getVisibleRanges(),t=[],i={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const n of e){const e=UnicodeTextModelHighlighter.computeUnicodeHighlights(this._model,this._options,n);for(const t of e.ranges)i.ranges.push(t);i.ambiguousCharacterCount+=i.ambiguousCharacterCount,i.invisibleCharacterCount+=i.invisibleCharacterCount,i.nonBasicAsciiCharacterCount+=i.nonBasicAsciiCharacterCount,i.hasMore=i.hasMore||e.hasMore}if(!i.hasMore)for(const n of i.ranges)t.push({range:n,options:Decorations.instance.getDecorationFromOptions(this._options)});this._updateState(i),this._decorationIds=new Set(this._editor.deltaDecorations(Array.from(this._decorationIds),t))}getDecorationInfo(e){if(!this._decorationIds.has(e))return null;const t=this._editor.getModel(),i=t.getDecorationRange(e),n=t.getValueInRange(i),o={range:i,options:Decorations.instance.getDecorationFromOptions(this._options),id:e,ownerId:0};return isModelDecorationVisible(t,o)?{reason:computeReason(n,this._options),inComment:isModelDecorationInComment(t,o),inString:isModelDecorationInString(t,o)}:null}}let UnicodeHighlighterHoverParticipant=class{constructor(e,t,i){this._editor=e,this._languageService=t,this._openerService=i,this.hoverOrdinal=4}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),n=this._editor.getContribution(UnicodeHighlighter.ID);if(!n)return[];const o=[];let r=300;for(const s of t){const e=n.getDecorationInfo(s.id);if(!e)continue;const t=i.getValueInRange(s.range).codePointAt(0),a=formatCodePointMarkdown(t);let l;switch(e.reason.kind){case 0:l=localize("unicodeHighlight.characterIsAmbiguous","The character {0} could be confused with the character {1}, which is more common in source code.",a,formatCodePointMarkdown(e.reason.confusableWith.codePointAt(0)));break;case 1:l=localize("unicodeHighlight.characterIsInvisible","The character {0} is invisible.",a);break;case 2:l=localize("unicodeHighlight.characterIsNonBasicAscii","The character {0} is not a basic ASCII character.",a)}const d={codePoint:t,reason:e.reason,inComment:e.inComment,inString:e.inString},c=[{value:`${l} [${localize("unicodeHighlight.adjustSettings","Adjust settings")}](command:${ShowExcludeOptions.ID}?${encodeURIComponent(JSON.stringify(d))})`,isTrusted:!0}];o.push(new MarkdownHover(this,s.range,c,r++))}return o}renderHoverParts(e,t){return renderMarkdownHovers(e,t,this._editor,this._languageService,this._openerService)}};function codePointToHex(e){return`U+${e.toString(16).padStart(4,"0")}`}function formatCodePointMarkdown(e){let t=`\`${codePointToHex(e)}\``;return InvisibleCharacters.isInvisibleCharacter(e)||(t+=` "${renderCodePointAsInlineCode(e)}"`),t}function renderCodePointAsInlineCode(e){return 96===e?"`` ` ``":"`"+String.fromCodePoint(e)+"`"}function computeReason(e,t){return UnicodeTextModelHighlighter.computeUnicodeHighlightReason(e,t)}UnicodeHighlighterHoverParticipant=__decorate$p([__param$o(1,ILanguageService),__param$o(2,IOpenerService)],UnicodeHighlighterHoverParticipant);class Decorations{constructor(){this.map=new Map}getDecorationFromOptions(e){return this.getDecoration(!e.includeComments,!e.includeStrings)}getDecoration(e,t){const i=`${e}${t}`;let n=this.map.get(i);return n||(n=ModelDecorationOptions.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:e,hideInStringTokens:t}),this.map.set(i,n)),n}}Decorations.instance=new Decorations;class DisableHighlightingInCommentsAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingInComments","Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingInComments.shortLabel","Disable Highlight In Comments")}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){let t=null==e?void 0:e.get(IConfigurationService);t&&this.runAction(t)}))}runAction(e){return __awaiter$c(this,void 0,void 0,(function*(){yield e.updateValue(unicodeHighlightConfigKeys.includeComments,!1,1)}))}}class DisableHighlightingInStringsAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingInStrings","Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingInStrings.shortLabel","Disable Highlight In Strings")}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){let t=null==e?void 0:e.get(IConfigurationService);t&&this.runAction(t)}))}runAction(e){return __awaiter$c(this,void 0,void 0,(function*(){yield e.updateValue(unicodeHighlightConfigKeys.includeStrings,!1,1)}))}}class DisableHighlightingOfAmbiguousCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfAmbiguousCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel","Disable Ambiguous Highlight")}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){let t=null==e?void 0:e.get(IConfigurationService);t&&this.runAction(t)}))}runAction(e){return __awaiter$c(this,void 0,void 0,(function*(){yield e.updateValue(unicodeHighlightConfigKeys.ambiguousCharacters,!1,1)}))}}DisableHighlightingOfAmbiguousCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";class DisableHighlightingOfInvisibleCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfInvisibleCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel","Disable Invisible Highlight")}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){let t=null==e?void 0:e.get(IConfigurationService);t&&this.runAction(t)}))}runAction(e){return __awaiter$c(this,void 0,void 0,(function*(){yield e.updateValue(unicodeHighlightConfigKeys.invisibleCharacters,!1,1)}))}}DisableHighlightingOfInvisibleCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";class DisableHighlightingOfNonBasicAsciiCharactersAction extends EditorAction{constructor(){super({id:DisableHighlightingOfNonBasicAsciiCharactersAction.ID,label:localize("action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=localize("unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel","Disable Non ASCII Highlight")}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){let t=null==e?void 0:e.get(IConfigurationService);t&&this.runAction(t)}))}runAction(e){return __awaiter$c(this,void 0,void 0,(function*(){yield e.updateValue(unicodeHighlightConfigKeys.nonBasicASCII,!1,1)}))}}DisableHighlightingOfNonBasicAsciiCharactersAction.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";class ShowExcludeOptions extends EditorAction{constructor(){super({id:ShowExcludeOptions.ID,label:localize("action.unicodeHighlight.showExcludeOptions","Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}run(e,t,i){return __awaiter$c(this,void 0,void 0,(function*(){const{codePoint:t,reason:n,inString:o,inComment:r}=i,s=String.fromCodePoint(t),a=e.get(IQuickInputService),l=e.get(IConfigurationService);const d=[];if(0===n.kind)for(const e of n.notAmbiguousInLocales)d.push({label:localize("unicodeHighlight.allowCommonCharactersInLanguage",'Allow unicode characters that are more common in the language "{0}".',e),run:()=>__awaiter$c(this,void 0,void 0,(function*(){excludeLocaleFromBeingHighlighted(l,[e])}))});var c;if(d.push({label:(c=t,InvisibleCharacters.isInvisibleCharacter(c)?localize("unicodeHighlight.excludeInvisibleCharFromBeingHighlighted","Exclude {0} (invisible character) from being highlighted",codePointToHex(c)):localize("unicodeHighlight.excludeCharFromBeingHighlighted","Exclude {0} from being highlighted",`${codePointToHex(c)} "${s}"`)),run:()=>excludeCharFromBeingHighlighted(l,[t])}),r){const e=new DisableHighlightingInCommentsAction;d.push({label:e.label,run:()=>__awaiter$c(this,void 0,void 0,(function*(){return e.runAction(l)}))})}else if(o){const e=new DisableHighlightingInStringsAction;d.push({label:e.label,run:()=>__awaiter$c(this,void 0,void 0,(function*(){return e.runAction(l)}))})}if(0===n.kind){const e=new DisableHighlightingOfAmbiguousCharactersAction;d.push({label:e.label,run:()=>__awaiter$c(this,void 0,void 0,(function*(){return e.runAction(l)}))})}else if(1===n.kind){const e=new DisableHighlightingOfInvisibleCharactersAction;d.push({label:e.label,run:()=>__awaiter$c(this,void 0,void 0,(function*(){return e.runAction(l)}))})}else if(2===n.kind){const e=new DisableHighlightingOfNonBasicAsciiCharactersAction;d.push({label:e.label,run:()=>__awaiter$c(this,void 0,void 0,(function*(){return e.runAction(l)}))})}else expectNever(n);const h=yield a.pick(d,{title:localize("unicodeHighlight.configureUnicodeHighlightOptions","Configure Unicode Highlight Options")});h&&(yield h.run())}))}}function excludeCharFromBeingHighlighted(e,t){return __awaiter$c(this,void 0,void 0,(function*(){const i=e.getValue(unicodeHighlightConfigKeys.allowedCharacters);let n;n="object"==typeof i&&i?i:{};for(const e of t)n[String.fromCodePoint(e)]=!0;yield e.updateValue(unicodeHighlightConfigKeys.allowedCharacters,n,1)}))}function excludeLocaleFromBeingHighlighted(e,t){var i;return __awaiter$c(this,void 0,void 0,(function*(){const n=null===(i=e.inspect(unicodeHighlightConfigKeys.allowedLocales).user)||void 0===i?void 0:i.value;let o;o="object"==typeof n&&n?Object.assign({},n):{};for(const e of t)o[e]=!0;yield e.updateValue(unicodeHighlightConfigKeys.allowedLocales,o,1)}))}function expectNever(e){throw new Error(`Unexpected value: ${e}`)}ShowExcludeOptions.ID="editor.action.unicodeHighlight.showExcludeOptions",registerEditorAction(DisableHighlightingOfAmbiguousCharactersAction),registerEditorAction(DisableHighlightingOfInvisibleCharactersAction),registerEditorAction(DisableHighlightingOfNonBasicAsciiCharactersAction),registerEditorAction(ShowExcludeOptions),registerEditorContribution(UnicodeHighlighter.ID,UnicodeHighlighter),HoverParticipantRegistry.register(UnicodeHighlighterHoverParticipant);const IDialogService=createDecorator("dialogService");var __decorate$o=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$n=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$b=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const ignoreUnusualLineTerminators="ignoreUnusualLineTerminators";function writeIgnoreState(e,t,i){e.setModelProperty(t.uri,ignoreUnusualLineTerminators,i)}function readIgnoreState(e,t){return e.getModelProperty(t.uri,ignoreUnusualLineTerminators)}let UnusualLineTerminatorsDetector=class extends Disposable{constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._config=this._editor.getOption(114),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(114)&&(this._config=this._editor.getOption(114),this._checkForUnusualLineTerminators())}))),this._register(this._editor.onDidChangeModel((()=>{this._checkForUnusualLineTerminators()}))),this._register(this._editor.onDidChangeModelContent((e=>{e.isUndoing||this._checkForUnusualLineTerminators()})))}_checkForUnusualLineTerminators(){return __awaiter$b(this,void 0,void 0,(function*(){if("off"===this._config)return;if(!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators())return;if(!0===readIgnoreState(this._codeEditorService,e))return;if(this._editor.getOption(81))return;if("auto"===this._config)return void e.removeUnusualLineTerminators(this._editor.getSelections());(yield this._dialogService.confirm({title:localize("unusualLineTerminators.title","Unusual Line Terminators"),message:localize("unusualLineTerminators.message","Detected unusual line terminators"),detail:localize("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",basename(e.uri)),primaryButton:localize("unusualLineTerminators.fix","Remove Unusual Line Terminators"),secondaryButton:localize("unusualLineTerminators.ignore","Ignore")})).confirmed?e.removeUnusualLineTerminators(this._editor.getSelections()):writeIgnoreState(this._codeEditorService,e,!0)}))}};function reverseEndianness(e){for(let t=0,i=e.length;t<i;t+=4){const i=e[t+0],n=e[t+1],o=e[t+2],r=e[t+3];e[t+0]=r,e[t+1]=o,e[t+2]=n,e[t+3]=i}}function toLittleEndianBuffer(e){const t=new Uint8Array(e.buffer,e.byteOffset,4*e.length);return isLittleEndian()||reverseEndianness(t),VSBuffer.wrap(t)}function encodeSemanticTokensDto(e){const t=new Uint32Array(encodeSemanticTokensDtoSize(e));let i=0;if(t[i++]=e.id,"full"===e.type)t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const n of e.deltas)t[i++]=n.start,t[i++]=n.deleteCount,n.data?(t[i++]=n.data.length,t.set(n.data,i),i+=n.data.length):t[i++]=0}return toLittleEndianBuffer(t)}function encodeSemanticTokensDtoSize(e){let t=0;if(t+=2,"full"===e.type)t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}UnusualLineTerminatorsDetector.ID="editor.contrib.unusualLineTerminatorsDetector",UnusualLineTerminatorsDetector=__decorate$o([__param$n(1,IDialogService),__param$n(2,ICodeEditorService)],UnusualLineTerminatorsDetector),registerEditorContribution(UnusualLineTerminatorsDetector.ID,UnusualLineTerminatorsDetector);var __awaiter$a=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function isSemanticTokens(e){return e&&!!e.data}function isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}class DocumentSemanticTokensResult{constructor(e,t,i){this.provider=e,this.tokens=t,this.error=i}}function hasDocumentSemanticTokensProvider(e,t){return e.has(t)}function getDocumentSemanticTokensProviders(e,t){const i=e.orderedGroups(t);return i.length>0?i[0]:[]}function getDocumentSemanticTokens(e,t,i,n,o){return __awaiter$a(this,void 0,void 0,(function*(){const r=getDocumentSemanticTokensProviders(e,t),s=yield Promise.all(r.map((e=>__awaiter$a(this,void 0,void 0,(function*(){let r,s=null;try{r=yield e.provideDocumentSemanticTokens(t,e===i?n:null,o)}catch(a){s=a,r=null}return r&&(isSemanticTokens(r)||isSemanticTokensEdits(r))||(r=null),new DocumentSemanticTokensResult(e,r,s)})))));for(const e of s){if(e.error)throw e.error;if(e.tokens)return e}return s.length>0?s[0]:null}))}function _getDocumentSemanticTokensProviderHighestGroup(e,t){const i=e.orderedGroups(t);return i.length>0?i[0]:null}class DocumentRangeSemanticTokensResult{constructor(e,t){this.provider=e,this.tokens=t}}function hasDocumentRangeSemanticTokensProvider(e,t){return e.has(t)}function getDocumentRangeSemanticTokensProviders(e,t){const i=e.orderedGroups(t);return i.length>0?i[0]:[]}function getDocumentRangeSemanticTokens(e,t,i,n){return __awaiter$a(this,void 0,void 0,(function*(){const o=getDocumentRangeSemanticTokensProviders(e,t),r=yield Promise.all(o.map((e=>__awaiter$a(this,void 0,void 0,(function*(){let o;try{o=yield e.provideDocumentRangeSemanticTokens(t,i,n)}catch(r){onUnexpectedExternalError(r),o=null}return o&&isSemanticTokens(o)||(o=null),new DocumentRangeSemanticTokensResult(e,o)})))));for(const e of r)if(e.tokens)return e;return r.length>0?r[0]:null}))}CommandsRegistry.registerCommand("_provideDocumentSemanticTokensLegend",((e,...t)=>__awaiter$a(void 0,void 0,void 0,(function*(){const[i]=t;assertType(i instanceof URI);const n=e.get(IModelService).getModel(i);if(!n)return;const{documentSemanticTokensProvider:o}=e.get(ILanguageFeaturesService),r=_getDocumentSemanticTokensProviderHighestGroup(o,n);return r?r[0].getLegend():e.get(ICommandService).executeCommand("_provideDocumentRangeSemanticTokensLegend",i)})))),CommandsRegistry.registerCommand("_provideDocumentSemanticTokens",((e,...t)=>__awaiter$a(void 0,void 0,void 0,(function*(){const[i]=t;assertType(i instanceof URI);const n=e.get(IModelService).getModel(i);if(!n)return;const{documentSemanticTokensProvider:o}=e.get(ILanguageFeaturesService);if(!hasDocumentSemanticTokensProvider(o,n))return e.get(ICommandService).executeCommand("_provideDocumentRangeSemanticTokens",i,n.getFullModelRange());const r=yield getDocumentSemanticTokens(o,n,null,null,CancellationToken.None);if(!r)return;const{provider:s,tokens:a}=r;if(!a||!isSemanticTokens(a))return;const l=encodeSemanticTokensDto({id:0,type:"full",data:a.data});return a.resultId&&s.releaseDocumentSemanticTokens(a.resultId),l})))),CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokensLegend",((e,...t)=>__awaiter$a(void 0,void 0,void 0,(function*(){const[i,n]=t;assertType(i instanceof URI);const o=e.get(IModelService).getModel(i);if(!o)return;const{documentRangeSemanticTokensProvider:r}=e.get(ILanguageFeaturesService),s=getDocumentRangeSemanticTokensProviders(r,o);if(0===s.length)return;if(1===s.length)return s[0].getLegend();if(!n||!Range$2.isIRange(n))return s[0].getLegend();const a=yield getDocumentRangeSemanticTokens(r,o,Range$2.lift(n),CancellationToken.None);return a?a.provider.getLegend():void 0})))),CommandsRegistry.registerCommand("_provideDocumentRangeSemanticTokens",((e,...t)=>__awaiter$a(void 0,void 0,void 0,(function*(){const[i,n]=t;assertType(i instanceof URI),assertType(Range$2.isIRange(n));const o=e.get(IModelService).getModel(i);if(!o)return;const{documentRangeSemanticTokensProvider:r}=e.get(ILanguageFeaturesService),s=yield getDocumentRangeSemanticTokens(r,o,Range$2.lift(n),CancellationToken.None);return s&&s.tokens?encodeSemanticTokensDto({id:0,type:"full",data:s.tokens.data}):void 0}))));class SparseMultilineTokens{constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}static create(e,t){return new SparseMultilineTokens(e,new SparseMultilineTokensStorage(t))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null}getRange(){const e=this._tokens.getRange();return e?new Range$2(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn):e}removeTokens(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber,[n,o,r]=this._tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new SparseMultilineTokens(this._startLineNumber,n),new SparseMultilineTokens(this._startLineNumber+r,o)]}applyEdit(e,t){const[i,n,o]=countEOL(t);this.acceptEdit(e,i,n,o,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,n,o){this._acceptDeleteRange(e),this._acceptInsertText(new Position$1(e.startLineNumber,e.startColumn),t,i,n,o),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){const e=i-t;return void(this._startLineNumber-=e)}const n=this._tokens.getMaxDeltaLine();if(!(t>=n+1)){if(t<0&&i>=n+1)return this._startLineNumber=0,void this._tokens.clear();if(t<0){const n=-t;this._startLineNumber-=n,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,n,o){if(0===t&&0===i)return;const r=e.lineNumber-this._startLineNumber;if(r<0)return void(this._startLineNumber+=t);r>=this._tokens.getMaxDeltaLine()+1||this._tokens.acceptInsertText(r,e.column-1,t,i,n,o)}}class SparseMultilineTokensStorage{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){const t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return 0===e?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(0===e)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),n=this._getEndCharacter(e-1);return new Range$2(0,t+1,i,n+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return 0===this._getTokenCount()}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const n=t+Math.floor((i-t)/2),o=this._getDeltaLine(n);if(o<e)t=n+1;else{if(!(o>e)){let o=n;for(;o>t&&this._getDeltaLine(o-1)===e;)o--;let r=n;for(;r<i&&this._getDeltaLine(r+1)===e;)r++;return new SparseLineTokens(this._tokens.subarray(4*o,4*r+4))}i=n-1}}return this._getDeltaLine(t)===e?new SparseLineTokens(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,n){const o=this._tokens,r=this._tokenCount;let s=0,a=!1,l=0;for(let d=0;d<r;d++){const r=4*d,c=o[r],h=o[r+1],u=o[r+2],g=o[r+3];if((c>e||c===e&&u>=t)&&(c<i||c===i&&h<=n))a=!0;else{if(0===s&&(l=c),a){const e=4*s;o[e]=c-l,o[e+1]=h,o[e+2]=u,o[e+3]=g}s++}}return this._tokenCount=s,l}split(e,t,i,n){const o=this._tokens,r=this._tokenCount,s=[],a=[];let l=s,d=0,c=0;for(let h=0;h<r;h++){const r=4*h,s=o[r],u=o[r+1],g=o[r+2],p=o[r+3];if(s>e||s===e&&g>=t){if(s<i||s===i&&u<=n)continue;l!==a&&(l=a,d=0,c=s)}l[d++]=s-c,l[d++]=u,l[d++]=g,l[d++]=p}return[new SparseMultilineTokensStorage(new Uint32Array(s)),new SparseMultilineTokensStorage(new Uint32Array(a)),c]}acceptDeleteRange(e,t,i,n,o){const r=this._tokens,s=this._tokenCount,a=n-t;let l=0,d=!1;for(let c=0;c<s;c++){const h=4*c;let u=r[h],g=r[h+1],p=r[h+2];const m=r[h+3];if(u<t||u===t&&p<=i){l++;continue}if(u===t&&g<i)u===n&&p>o?p-=o-i:p=i;else if(u===t&&g===i){if(!(u===n&&p>o)){d=!0;continue}p-=o-i}else if(u<n||u===n&&g<o){if(!(u===n&&p>o)){d=!0;continue}u===t?(g=i,p=g+(p-o)):(g=0,p=g+(p-o))}else if(u>n){if(0===a&&!d){l=s;break}u-=a}else{if(!(u===n&&g>=o))throw new Error("Not possible!");e&&0===u&&(g+=e,p+=e),u-=a,g-=o-i,p-=o-i}const f=4*l;r[f]=u,r[f+1]=g,r[f+2]=p,r[f+3]=m,l++}this._tokenCount=l}acceptInsertText(e,t,i,n,o,r){const s=0===i&&1===n&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),a=this._tokens,l=this._tokenCount;for(let d=0;d<l;d++){const r=4*d;let l=a[r],c=a[r+1],h=a[r+2];if(!(l<e||l===e&&h<t)){if(l===e&&h===t){if(!s)continue;h+=1}else if(l===e&&c<t&&t<h)0===i?h+=n:h=t;else{if(l===e&&c===t&&s)continue;if(l===e)if(l+=i,0===i)c+=n,h+=n;else{const e=h-c;c=o+(c-t),h=c+e}else l+=i}a[r]=l,a[r+1]=c,a[r+2]=h}}}}class SparseLineTokens{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}var __decorate$n=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$m=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let SemanticTokensProviderStyling=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hashTable=new HashTable,this._hasWarnedOverlappingTokens=!1}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),o=this._hashTable.get(e,t,n);let r;if(o)r=o.metadata,this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling [CACHED] ${e} / ${t}: foreground ${TokenMetadata.getForeground(r)}, fontStyle ${TokenMetadata.getFontStyle(r).toString(2)}`);else{let o=this._legend.tokenTypes[e];const s=[];if(o){let e=t;for(let t=0;e>0&&t<this._legend.tokenModifiers.length;t++)1&e&&s.push(this._legend.tokenModifiers[t]),e>>=1;e>0&&this._logService.getLevel()===LogLevel.Trace&&(this._logService.trace(`SemanticTokensProviderStyling: unknown token modifier index: ${t.toString(2)} for legend: ${JSON.stringify(this._legend.tokenModifiers)}`),s.push("not-in-legend"));const n=this._themeService.getColorTheme().getTokenStyleMetadata(o,s,i);if(void 0===n)r=2147483647;else{if(r=0,void 0!==n.italic){r|=1|(n.italic?1:0)<<10}if(void 0!==n.bold){r|=2|(n.bold?2:0)<<10}if(void 0!==n.underline){r|=4|(n.underline?4:0)<<10}if(void 0!==n.strikethrough){r|=8|(n.strikethrough?8:0)<<10}if(n.foreground){r|=16|n.foreground<<14}0===r&&(r=2147483647)}}else this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling: unknown token type index: ${e} for legend: ${JSON.stringify(this._legend.tokenTypes)}`),r=2147483647,o="not-in-legend";this._hashTable.add(e,t,n,r),this._logService.getLevel()===LogLevel.Trace&&this._logService.trace(`SemanticTokensProviderStyling ${e} (${o}) / ${t} (${s.join(" ")}): foreground ${TokenMetadata.getForeground(r)}, fontStyle ${TokenMetadata.getFontStyle(r).toString(2)}`)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0)}};function toMultilineTokens2(e,t,i){const n=e.data,o=e.data.length/5|0,r=Math.max(Math.ceil(o/1024),400),s=[];let a=0,l=1,d=0;for(;a<o;){const e=a;let c=Math.min(e+r,o);if(c<o){let t=c;for(;t-1>e&&0===n[5*t];)t--;if(t-1===e){let e=c;for(;e+1<o&&0===n[5*e];)e++;c=e}else c=t}let h=new Uint32Array(4*(c-e)),u=0,g=0,p=0,m=0,f=0;for(;a<c;){const e=5*a,o=n[e],r=n[e+1],s=l+o|0,c=0===o?d+r|0:r,_=n[e+2],C=n[e+3],v=n[e+4],b=t.getMetadata(C,v,i);2147483647!==b&&(0===g&&(g=s),p===s&&f>c&&(t.warnOverlappingSemanticTokens(s,c+1),m<c?h[u-4+2]=c:u-=4),h[u]=s-g,h[u+1]=c,h[u+2]=c+_,h[u+3]=b,u+=4,p=s,m=c,f=c+_),l=s,d=c,a++}u!==h.length&&(h=h.subarray(0,u));const _=SparseMultilineTokens.create(g,h);s.push(_)}return s}SemanticTokensProviderStyling=__decorate$n([__param$m(1,IThemeService),__param$m(2,ILanguageService),__param$m(3,ILogService)],SemanticTokensProviderStyling);class HashTableEntry{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}class HashTable{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let o=this._elements[n];for(;o;){if(o.tokenTypeIndex===e&&o.tokenModifierSet===t&&o.languageId===i)return o;o=o.next}return null}add(e,t,i,n){if(this._elementsCount++,0!==this._growCount&&this._elementsCount>=this._growCount){const e=this._elements;this._currentLengthIndex++,this._currentLength=HashTable._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<HashTable._SIZES.length?2/3*this._currentLength:0),this._elements=[],HashTable._nullOutEntries(this._elements,this._currentLength);for(const t of e){let e=t;for(;e;){const t=e.next;e.next=null,this._add(e),e=t}}}this._add(new HashTableEntry(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}}HashTable._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];var __decorate$m=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$l=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};function MODEL_ID(e){return e.toString()}function computeModelSha1(e){const t=new StringSHA1,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}class ModelData{constructor(e,t,i){this._modelEventListeners=new DisposableStore,this.model=e,this._languageSelection=null,this._languageSelectionListener=null,this._modelEventListeners.add(e.onWillDispose((()=>t(e)))),this._modelEventListeners.add(e.onDidChangeLanguage((t=>i(e,t))))}_disposeLanguageSelection(){this._languageSelectionListener&&(this._languageSelectionListener.dispose(),this._languageSelectionListener=null)}dispose(){this._modelEventListeners.dispose(),this._disposeLanguageSelection()}setLanguage(e){this._disposeLanguageSelection(),this._languageSelection=e,this._languageSelectionListener=this._languageSelection.onDidChange((()=>this.model.setMode(e.languageId))),this.model.setMode(e.languageId)}}const DEFAULT_EOL=isLinux||isMacintosh?1:2;class DisposedModelInfo{constructor(e,t,i,n,o,r,s,a){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=o,this.sha1=r,this.versionId=s,this.alternativeVersionId=a}}let ModelService=class e extends Disposable{constructor(e,t,i,n,o,r,s,a,l){super(),this._configurationService=e,this._resourcePropertiesService=t,this._themeService=i,this._logService=n,this._undoRedoService=o,this._languageService=r,this._languageConfigurationService=s,this._languageFeatureDebounceService=a,this._onModelAdded=this._register(new Emitter$1),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new Emitter$1),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new Emitter$1),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._semanticStyling=this._register(new SemanticStyling(this._themeService,this._languageService,this._logService)),this._register(this._configurationService.onDidChangeConfiguration((()=>this._updateModelOptions()))),this._updateModelOptions(),this._register(new SemanticColoringFeature(this._semanticStyling,this,this._themeService,this._configurationService,this._languageFeatureDebounceService,l))}static _readModelOptions(e,t){var i;let n=EDITOR_MODEL_DEFAULTS.tabSize;if(e.editor&&void 0!==e.editor.tabSize){const t=parseInt(e.editor.tabSize,10);isNaN(t)||(n=t),n<1&&(n=1)}let o=n;if(e.editor&&void 0!==e.editor.indentSize&&"tabSize"!==e.editor.indentSize){const t=parseInt(e.editor.indentSize,10);isNaN(t)||(o=t),o<1&&(o=1)}let r=EDITOR_MODEL_DEFAULTS.insertSpaces;e.editor&&void 0!==e.editor.insertSpaces&&(r="false"!==e.editor.insertSpaces&&Boolean(e.editor.insertSpaces));let s=DEFAULT_EOL;const a=e.eol;"\r\n"===a?s=2:"\n"===a&&(s=1);let l=EDITOR_MODEL_DEFAULTS.trimAutoWhitespace;e.editor&&void 0!==e.editor.trimAutoWhitespace&&(l="false"!==e.editor.trimAutoWhitespace&&Boolean(e.editor.trimAutoWhitespace));let d=EDITOR_MODEL_DEFAULTS.detectIndentation;e.editor&&void 0!==e.editor.detectIndentation&&(d="false"!==e.editor.detectIndentation&&Boolean(e.editor.detectIndentation));let c=EDITOR_MODEL_DEFAULTS.largeFileOptimizations;e.editor&&void 0!==e.editor.largeFileOptimizations&&(c="false"!==e.editor.largeFileOptimizations&&Boolean(e.editor.largeFileOptimizations));let h=EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions;return(null===(i=e.editor)||void 0===i?void 0:i.bracketPairColorization)&&"object"==typeof e.editor.bracketPairColorization&&(h={enabled:!!e.editor.bracketPairColorization.enabled}),{isForSimpleWidget:t,tabSize:n,indentSize:o,insertSpaces:r,detectIndentation:d,defaultEOL:s,trimAutoWhitespace:l,largeFileOptimizations:c,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&"string"==typeof i&&"auto"!==i?i:3===OS||2===OS?"\n":"\r\n"}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return"boolean"!=typeof e||e}getCreationOptions(t,i,n){let o=this._modelCreationOptionsByLanguageAndResource[t+i];if(!o){const r=this._configurationService.getValue("editor",{overrideIdentifier:t,resource:i}),s=this._getEOL(i,t);o=e._readModelOptions({editor:r,eol:s},n),this._modelCreationOptionsByLanguageAndResource[t+i]=o}return o}_updateModelOptions(){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,o=i.length;n<o;n++){const o=i[n],r=this._models[o],s=r.model.getLanguageId(),a=r.model.uri,l=t[s+a],d=this.getCreationOptions(s,a,r.model.isForSimpleWidget);e._setModelOptionsForModel(r.model,d,l)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&1===e.getLineCount()&&e.setEOL(1===t.defaultEOL?0:1),i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&equals(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions)||(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(MODEL_ID(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(MODEL_ID(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(MODEL_ID(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach((e=>{e.sharesUndoRedoStack||t.push(e)})),t.sort(((e,t)=>e.time-t.time));t.length>0&&this._disposedModelsHeapSize>e;){const e=t.shift();this._removeDisposedModel(e.uri),null!==e.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(e.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const o=this.getCreationOptions(t,i,n),r=new TextModel(e,t,o,i,this._undoRedoService,this._languageService,this._languageConfigurationService);if(i&&this._disposedModels.has(MODEL_ID(i))){const e=this._removeDisposedModel(i),t=this._undoRedoService.getElements(i),n=computeModelSha1(r)===e.sha1;if(n||e.sharesUndoRedoStack){for(const e of t.past)isEditStackElement(e)&&e.matchesResource(i)&&e.setModel(r);for(const e of t.future)isEditStackElement(e)&&e.matchesResource(i)&&e.setModel(r);this._undoRedoService.setElementsValidFlag(i,!0,(e=>isEditStackElement(e)&&e.matchesResource(i))),n&&(r._overwriteVersionId(e.versionId),r._overwriteAlternativeVersionId(e.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(e.initialUndoRedoSnapshot))}else null!==e.initialUndoRedoSnapshot&&this._undoRedoService.restoreSnapshot(e.initialUndoRedoSnapshot)}const s=MODEL_ID(r.uri);if(this._models[s])throw new Error("ModelService: Cannot add model because it already exists!");const a=new ModelData(r,(e=>this._onWillDispose(e)),((e,t)=>this._onDidChangeLanguage(e,t)));return this._models[s]=a,a}createModel(e,t,i,n=!1){let o;return t?(o=this._createModelData(e,t.languageId,i,n),this.setMode(o.model,t)):o=this._createModelData(e,PLAINTEXT_LANGUAGE_ID,i,n),this._onModelAdded.fire(o.model),o.model}setMode(e,t){if(!t)return;const i=this._models[MODEL_ID(e.uri)];i&&i.setLanguage(t)}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(this._models[n].model)}return e}getModel(e){const t=MODEL_ID(e),i=this._models[t];return i?i.model:null}getSemanticTokensProviderStyling(e){return this._semanticStyling.get(e)}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===Schemas.file||e.scheme===Schemas.vscodeRemote||e.scheme===Schemas.userData||e.scheme===Schemas.vscodeNotebookCell||"fake-fs"===e.scheme}_onWillDispose(t){const i=MODEL_ID(t.uri),n=this._models[i],o=this._undoRedoService.getUriComparisonKey(t.uri)!==t.uri.toString();let r=!1,s=0;if(o||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(t.uri)){const e=this._undoRedoService.getElements(t.uri);if(e.past.length>0||e.future.length>0){for(const i of e.past)isEditStackElement(i)&&i.matchesResource(t.uri)&&(r=!0,s+=i.heapSize(t.uri),i.setModel(t.uri));for(const i of e.future)isEditStackElement(i)&&i.matchesResource(t.uri)&&(r=!0,s+=i.heapSize(t.uri),i.setModel(t.uri))}}const a=e.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK;if(r)if(!o&&s>a){const e=n.model.getInitialUndoRedoSnapshot();null!==e&&this._undoRedoService.restoreSnapshot(e)}else this._ensureDisposedModelsHeapSize(a-s),this._undoRedoService.setElementsValidFlag(t.uri,!1,(e=>isEditStackElement(e)&&e.matchesResource(t.uri))),this._insertDisposedModel(new DisposedModelInfo(t.uri,n.model.getInitialUndoRedoSnapshot(),Date.now(),o,s,computeModelSha1(t),t.getVersionId(),t.getAlternativeVersionId()));else if(!o){const e=n.model.getInitialUndoRedoSnapshot();null!==e&&this._undoRedoService.restoreSnapshot(e)}delete this._models[i],n.dispose(),delete this._modelCreationOptionsByLanguageAndResource[t.getLanguageId()+t.uri],this._onModelRemoved.fire(t)}_onDidChangeLanguage(t,i){const n=i.oldLanguage,o=t.getLanguageId(),r=this.getCreationOptions(n,t.uri,t.isForSimpleWidget),s=this.getCreationOptions(o,t.uri,t.isForSimpleWidget);e._setModelOptionsForModel(t,s,r),this._onModelModeChanged.fire({model:t,oldLanguageId:n})}};ModelService.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20971520,ModelService=__decorate$m([__param$l(0,IConfigurationService),__param$l(1,ITextResourcePropertiesService),__param$l(2,IThemeService),__param$l(3,ILogService),__param$l(4,IUndoRedoService),__param$l(5,ILanguageService),__param$l(6,ILanguageConfigurationService),__param$l(7,ILanguageFeatureDebounceService),__param$l(8,ILanguageFeaturesService)],ModelService);const SEMANTIC_HIGHLIGHTING_SETTING_ID="editor.semanticHighlighting";function isSemanticColoringEnabled(e,t,i){var n;const o=null===(n=i.getValue(SEMANTIC_HIGHLIGHTING_SETTING_ID,{overrideIdentifier:e.getLanguageId(),resource:e.uri}))||void 0===n?void 0:n.enabled;return"boolean"==typeof o?o:t.getColorTheme().semanticHighlighting}let SemanticColoringFeature=class extends Disposable{constructor(e,t,i,n,o,r){super(),this._watchers=Object.create(null),this._semanticStyling=e;const s=e=>{this._watchers[e.uri.toString()]=new ModelSemanticColoring(e,this._semanticStyling,i,o,r)},a=(e,t)=>{t.dispose(),delete this._watchers[e.uri.toString()]},l=()=>{for(let e of t.getModels()){const t=this._watchers[e.uri.toString()];isSemanticColoringEnabled(e,i,n)?t||s(e):t&&a(e,t)}};this._register(t.onModelAdded((e=>{isSemanticColoringEnabled(e,i,n)&&s(e)}))),this._register(t.onModelRemoved((e=>{const t=this._watchers[e.uri.toString()];t&&a(e,t)}))),this._register(n.onDidChangeConfiguration((e=>{e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)&&l()}))),this._register(i.onDidColorThemeChange(l))}};SemanticColoringFeature=__decorate$m([__param$l(1,IModelService),__param$l(2,IThemeService),__param$l(3,IConfigurationService),__param$l(4,ILanguageFeatureDebounceService),__param$l(5,ILanguageFeaturesService)],SemanticColoringFeature);class SemanticStyling extends Disposable{constructor(e,t,i){super(),this._themeService=e,this._languageService=t,this._logService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange((()=>{this._caches=new WeakMap})))}get(e){return this._caches.has(e)||this._caches.set(e,new SemanticTokensProviderStyling(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}}class SemanticTokensResponse{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}let ModelSemanticColoring=class e extends Disposable{constructor(t,i,n,o,r){super(),this._isDisposed=!1,this._model=t,this._semanticStyling=i,this._provider=r.documentSemanticTokensProvider,this._debounceInformation=o.for(this._provider,"DocumentSemanticTokens",{min:e.REQUEST_MIN_DELAY,max:e.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new RunOnceScheduler((()=>this._fetchDocumentSemanticTokensNow()),e.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._register(this._model.onDidChangeContent((()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(this._model.onDidChangeLanguage((()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)})));const s=()=>{dispose(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const e of this._provider.all(t))"function"==typeof e.onDidChange&&this._documentProvidersChangeListeners.push(e.onDidChange((()=>this._fetchDocumentSemanticTokens.schedule(0))))};s(),this._register(this._provider.onDidChange((()=>{s(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._register(n.onDidColorThemeChange((e=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))}))),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!hasDocumentSemanticTokensProvider(this._provider,this._model))return void(this._currentDocumentResponse&&this._model.setSemanticTokens(null,!1));const e=new CancellationTokenSource$1,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=getDocumentSemanticTokens(this._provider,this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e;const o=[],r=this._model.onDidChangeContent((e=>{o.push(e)})),s=new StopWatch(!1);n.then((e=>{if(this._debounceInformation.update(this._model,s.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),e){const{provider:t,tokens:i}=e,n=this._semanticStyling.get(t);this._setDocumentSemanticTokens(t,i||null,n,o)}else this._setDocumentSemanticTokens(null,null,null,o)}),(e=>{e&&(isCancellationError(e)||"string"==typeof e.message&&-1!==e.message.indexOf("busy"))||onUnexpectedError(e),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),o.length>0&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))}))}static _copy(e,t,i,n,o){for(let r=0;r<o;r++)i[n+r]=e[t+r]}_setDocumentSemanticTokens(t,i,n,o){const r=this._currentDocumentResponse,s=()=>{o.length>0&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed)t&&i&&t.releaseDocumentSemanticTokens(i.resultId);else if(t&&n){if(!i)return this._model.setSemanticTokens(null,!0),void s();if(isSemanticTokensEdits(i)){if(!r)return void this._model.setSemanticTokens(null,!0);if(0===i.edits.length)i={resultId:i.resultId,data:r.data};else{let t=0;for(const e of i.edits)t+=(e.data?e.data.length:0)-e.deleteCount;const n=r.data,o=new Uint32Array(n.length+t);let s=n.length,a=o.length;for(let r=i.edits.length-1;r>=0;r--){const t=i.edits[r],l=s-(t.start+t.deleteCount);l>0&&(e._copy(n,s-l,o,a-l,l),a-=l),t.data&&(e._copy(t.data,0,o,a-t.data.length,t.data.length),a-=t.data.length),s=t.start}s>0&&e._copy(n,0,o,0,s),i={resultId:i.resultId,data:o}}}if(isSemanticTokens(i)){this._currentDocumentResponse=new SemanticTokensResponse(t,i.resultId,i.data);const e=toMultilineTokens2(i,n,this._model.getLanguageId());if(o.length>0)for(const t of o)for(const i of e)for(const e of t.changes)i.applyEdit(e.range,e.text);this._model.setSemanticTokens(e,!0)}else this._model.setSemanticTokens(null,!0);s()}else this._model.setSemanticTokens(null,!1)}};ModelSemanticColoring.REQUEST_MIN_DELAY=300,ModelSemanticColoring.REQUEST_MAX_DELAY=2e3,ModelSemanticColoring=__decorate$m([__param$l(2,IThemeService),__param$l(3,ILanguageFeatureDebounceService),__param$l(4,ILanguageFeaturesService)],ModelSemanticColoring);var __decorate$l=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$k=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ViewportSemanticTokensContribution=class extends Disposable{constructor(e,t,i,n,o,r){super(),this._modelService=t,this._themeService=i,this._configurationService=n,this._editor=e,this._provider=r.documentRangeSemanticTokensProvider,this._debounceInformation=o.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new RunOnceScheduler((()=>this._tokenizeViewportNow()),100)),this._outstandingRequests=[];const s=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange((()=>{s()}))),this._register(this._editor.onDidChangeModel((()=>{this._cancelAll(),s()}))),this._register(this._editor.onDidChangeModelContent((e=>{this._cancelAll(),s()}))),this._register(this._provider.onDidChange((()=>{this._cancelAll(),s()}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)&&(this._cancelAll(),s())}))),this._register(this._themeService.onDidColorThemeChange((()=>{this._cancelAll(),s()})))}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,i=this._outstandingRequests.length;t<i;t++)if(this._outstandingRequests[t]===e)return void this._outstandingRequests.splice(t,1)}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.hasCompleteSemanticTokens())return;if(!isSemanticColoringEnabled(e,this._themeService,this._configurationService))return void(e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1));if(!hasDocumentRangeSemanticTokensProvider(this._provider,e))return void(e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1));const t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map((t=>this._requestRange(e,t))))}_requestRange(e,t){const i=e.getVersionId(),n=createCancelablePromise((i=>Promise.resolve(getDocumentRangeSemanticTokens(this._provider,e,t,i)))),o=new StopWatch(!1);return n.then((n=>{if(this._debounceInformation.update(e,o.elapsed()),!n||!n.tokens||e.isDisposed()||e.getVersionId()!==i)return;const{provider:r,tokens:s}=n,a=this._modelService.getSemanticTokensProviderStyling(r);e.setPartialSemanticTokens(t,toMultilineTokens2(s,a,e.getLanguageId()))})).then((()=>this._removeOutstandingRequest(n)),(()=>this._removeOutstandingRequest(n))),n}};ViewportSemanticTokensContribution.ID="editor.contrib.viewportSemanticTokens",ViewportSemanticTokensContribution=__decorate$l([__param$k(1,IModelService),__param$k(2,IThemeService),__param$k(3,IConfigurationService),__param$k(4,ILanguageFeatureDebounceService),__param$k(5,ILanguageFeaturesService)],ViewportSemanticTokensContribution),registerEditorContribution(ViewportSemanticTokensContribution.ID,ViewportSemanticTokensContribution);var __decorate$k=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$j=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const editorWordHighlight=registerColor("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hc:null},localize("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0),editorWordHighlightStrong=registerColor("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hc:null},localize("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0),editorWordHighlightBorder=registerColor("editor.wordHighlightBorder",{light:null,dark:null,hc:activeContrastBorder},localize("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable.")),editorWordHighlightStrongBorder=registerColor("editor.wordHighlightStrongBorder",{light:null,dark:null,hc:activeContrastBorder},localize("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable.")),overviewRulerWordHighlightForeground=registerColor("editorOverviewRuler.wordHighlightForeground",{dark:"#A0A0A0CC",light:"#A0A0A0CC",hc:"#A0A0A0CC"},localize("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),overviewRulerWordHighlightStrongForeground=registerColor("editorOverviewRuler.wordHighlightStrongForeground",{dark:"#C0A0C0CC",light:"#C0A0C0CC",hc:"#C0A0C0CC"},localize("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),ctxHasWordHighlights=new RawContextKey("hasWordHighlights",!1);function getOccurrencesAtPosition(e,t,i,n){return first(e.ordered(t).map((e=>()=>Promise.resolve(e.provideDocumentHighlights(t,i,n)).then(void 0,onUnexpectedExternalError))),isNonEmptyArray)}class OccurenceAtPositionRequest{constructor(e,t,i){this._model=e,this._selection=t,this._wordSeparators=i,this._wordRange=this._getCurrentWordRange(e,t),this._result=null}get result(){return this._result||(this._result=createCancelablePromise((e=>this._compute(this._model,this._selection,this._wordSeparators,e)))),this._result}_getCurrentWordRange(e,t){const i=e.getWordAtPosition(t.getPosition());return i?new Range$2(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):null}isValid(e,t,i){const n=t.startLineNumber,o=t.startColumn,r=t.endColumn,s=this._getCurrentWordRange(e,t);let a=Boolean(this._wordRange&&this._wordRange.equalsRange(s));for(let l=0,d=i.length;!a&&l<d;l++){let t=e.getDecorationRange(i[l]);t&&t.startLineNumber===n&&t.startColumn<=o&&t.endColumn>=r&&(a=!0)}return a}cancel(){this.result.cancel()}}class SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(e,t,i,n){super(e,t,i),this._providers=n}_compute(e,t,i,n){return getOccurrencesAtPosition(this._providers,e,t.getPosition(),n).then((e=>e||[]))}}class TextualOccurenceAtPositionRequest extends OccurenceAtPositionRequest{constructor(e,t,i){super(e,t,i),this._selectionIsEmpty=t.isEmpty()}_compute(e,t,i,n){return timeout(250,n).then((()=>{if(!t.isEmpty())return[];const n=e.getWordAtPosition(t.getPosition());if(!n||n.word.length>1e3)return[];return e.findMatches(n.word,!0,!1,!0,i,!1).map((e=>({range:e.range,kind:DocumentHighlightKind$1.Text})))}))}isValid(e,t,i){const n=t.isEmpty();return this._selectionIsEmpty===n&&super.isValid(e,t,i)}}function computeOccurencesAtPosition(e,t,i,n){return e.has(t)?new SemanticOccurenceAtPositionRequest(t,i,n,e):new TextualOccurenceAtPositionRequest(t,i,n)}registerModelAndPositionCommand("_executeDocumentHighlights",((e,t,i)=>getOccurrencesAtPosition(e.get(ILanguageFeaturesService).documentHighlightProvider,t,i,CancellationToken.None)));class WordHighlighter{constructor(e,t,i){this.toUnhook=new DisposableStore,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=e,this.providers=t,this._hasWordHighlights=ctxHasWordHighlights.bindTo(i),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(72),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition((e=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(e)}))),this.toUnhook.add(e.onDidChangeModelContent((e=>{this._stopAll()}))),this.toUnhook.add(e.onDidChangeConfiguration((e=>{let t=this.editor.getOption(72);this.occurrencesHighlight!==t&&(this.occurrencesHighlight=t,this._stopAll())}))),this._decorationIds=[],this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this._decorationIds.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return coalesce(this._decorationIds.map((e=>this.model.getDecorationRange(e))).sort(Range$2.compareRangesUsingStarts))}moveNext(){let e=this._getSortedHighlights(),t=(e.findIndex((e=>e.containsPosition(this.editor.getPosition())))+1)%e.length,i=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(i.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(i);const n=this._getWord();if(n){alert(`${this.editor.getModel().getLineContent(i.startLineNumber)}, ${t+1} of ${e.length} for '${n.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){let e=this._getSortedHighlights(),t=(e.findIndex((e=>e.containsPosition(this.editor.getPosition())))-1+e.length)%e.length,i=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(i.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(i);const n=this._getWord();if(n){alert(`${this.editor.getModel().getLineContent(i.startLineNumber)}, ${t+1} of ${e.length} for '${n.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this._decorationIds.length>0&&(this._decorationIds=this.editor.deltaDecorations(this._decorationIds,[]),this._hasWordHighlights.set(!1))}_stopAll(){this._removeDecorations(),-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),null!==this.workerRequest&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){this.occurrencesHighlight&&3===e.reason?this._run():this._stopAll()}_getWord(){let e=this.editor.getSelection(),t=e.startLineNumber,i=e.startColumn;return this.model.getWordAtPosition({lineNumber:t,column:i})}_run(){let e=this.editor.getSelection();if(e.startLineNumber!==e.endLineNumber)return void this._stopAll();let t=e.startColumn,i=e.endColumn;const n=this._getWord();if(!n||n.startColumn>t||n.endColumn<i)return void this._stopAll();const o=this.workerRequest&&this.workerRequest.isValid(this.model,e,this._decorationIds);if(this.lastCursorPositionChangeTime=(new Date).getTime(),o)this.workerRequestCompleted&&-1!==this.renderDecorationsTimer&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();let e=++this.workerRequestTokenId;this.workerRequestCompleted=!1,this.workerRequest=computeOccurencesAtPosition(this.providers,this.model,this.editor.getSelection(),this.editor.getOption(117)),this.workerRequest.result.then((t=>{e===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=t||[],this._beginRenderDecorations())}),onUnexpectedError)}}_beginRenderDecorations(){let e=(new Date).getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout((()=>{this.renderDecorations()}),t-e)}renderDecorations(){this.renderDecorationsTimer=-1;let e=[];for(const t of this.workerRequestValue)t.range&&e.push({range:t.range,options:WordHighlighter._getDecorationOptions(t.kind)});this._decorationIds=this.editor.deltaDecorations(this._decorationIds,e),this._hasWordHighlights.set(this.hasDecorations())}static _getDecorationOptions(e){return e===DocumentHighlightKind$1.Write?this._WRITE_OPTIONS:e===DocumentHighlightKind$1.Text?this._TEXT_OPTIONS:this._REGULAR_OPTIONS}dispose(){this._stopAll(),this.toUnhook.dispose()}}WordHighlighter._WRITE_OPTIONS=ModelDecorationOptions.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:themeColorFromId(overviewRulerWordHighlightStrongForeground),position:OverviewRulerLane$1.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition$1.Inline}}),WordHighlighter._TEXT_OPTIONS=ModelDecorationOptions.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight",overviewRuler:{color:themeColorFromId(overviewRulerSelectionHighlightForeground),position:OverviewRulerLane$1.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition$1.Inline}}),WordHighlighter._REGULAR_OPTIONS=ModelDecorationOptions.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:themeColorFromId(overviewRulerWordHighlightForeground),position:OverviewRulerLane$1.Center},minimap:{color:themeColorFromId(minimapSelectionOccurrenceHighlight),position:MinimapPosition$1.Inline}});let WordHighlighterContribution=class e extends Disposable{constructor(e,t,i){super(),this.wordHighlighter=null;const n=()=>{e.hasModel()&&(this.wordHighlighter=new WordHighlighter(e,i.documentHighlightProvider,t))};this._register(e.onDidChangeModel((e=>{this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),n()}))),n()}static get(t){return t.getContribution(e.ID)}saveViewState(){return!(!this.wordHighlighter||!this.wordHighlighter.hasDecorations())}moveNext(){this.wordHighlighter&&this.wordHighlighter.moveNext()}moveBack(){this.wordHighlighter&&this.wordHighlighter.moveBack()}restoreViewState(e){this.wordHighlighter&&e&&this.wordHighlighter.restore()}dispose(){this.wordHighlighter&&(this.wordHighlighter.dispose(),this.wordHighlighter=null),super.dispose()}};WordHighlighterContribution.ID="editor.contrib.wordHighlighter",WordHighlighterContribution=__decorate$k([__param$j(1,IContextKeyService),__param$j(2,ILanguageFeaturesService)],WordHighlighterContribution);class WordHighlightNavigationAction extends EditorAction{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=WordHighlighterContribution.get(t);i&&(this._isNext?i.moveNext():i.moveBack())}}class NextWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:localize("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:65,weight:100}})}}class PrevWordHighlightAction extends WordHighlightNavigationAction{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:localize("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:ctxHasWordHighlights,kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:1089,weight:100}})}}class TriggerWordHighlightAction extends EditorAction{constructor(){super({id:"editor.action.wordHighlight.trigger",label:localize("wordHighlight.trigger.label","Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:ctxHasWordHighlights.toNegated(),kbOpts:{kbExpr:EditorContextKeys.editorTextFocus,primary:0,weight:100}})}run(e,t,i){const n=WordHighlighterContribution.get(t);n&&n.restoreViewState(!0)}}registerEditorContribution(WordHighlighterContribution.ID,WordHighlighterContribution),registerEditorAction(NextWordHighlightAction),registerEditorAction(PrevWordHighlightAction),registerEditorAction(TriggerWordHighlightAction),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorSelectionHighlight);i&&(t.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${i}; }`),t.addRule(`.monaco-editor .selectionHighlight { background-color: ${i.transparent(.5)}; }`));const n=e.getColor(editorWordHighlight);n&&t.addRule(`.monaco-editor .wordHighlight { background-color: ${n}; }`);const o=e.getColor(editorWordHighlightStrong);o&&t.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${o}; }`);const r=e.getColor(editorSelectionHighlightBorder);r&&t.addRule(`.monaco-editor .selectionHighlight { border: 1px ${"hc"===e.type?"dotted":"solid"} ${r}; box-sizing: border-box; }`);const s=e.getColor(editorWordHighlightBorder);s&&t.addRule(`.monaco-editor .wordHighlight { border: 1px ${"hc"===e.type?"dashed":"solid"} ${s}; box-sizing: border-box; }`);const a=e.getColor(editorWordHighlightStrongBorder);a&&t.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${"hc"===e.type?"dashed":"solid"} ${a}; box-sizing: border-box; }`)}));class MoveWordCommand extends EditorCommand{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){if(!t.hasModel())return;const n=getMapForWordSeparators(t.getOption(117)),o=t.getModel(),r=t.getSelections().map((e=>{const t=new Position$1(e.positionLineNumber,e.positionColumn),i=this._move(n,o,t,this._wordNavigationType);return this._moveTo(e,i,this._inSelectionMode)}));if(o.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,r.map((e=>CursorState$1.fromModelSelection(e)))),1===r.length){const e=new Position$1(r[0].positionLineNumber,r[0].positionColumn);t.revealPosition(e,0)}}_moveTo(e,t,i){return i?new Selection$1(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new Selection$1(t.lineNumber,t.column,t.lineNumber,t.column)}}class WordLeftCommand extends MoveWordCommand{_move(e,t,i,n){return WordOperations.moveWordLeft(e,t,i,n)}}class WordRightCommand extends MoveWordCommand{_move(e,t,i,n){return WordOperations.moveWordRight(e,t,i,n)}}class CursorWordStartLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class CursorWordEndLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class CursorWordLeft extends WordLeftCommand{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:2063,mac:{primary:527},weight:100}})}}class CursorWordStartLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class CursorWordEndLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class CursorWordLeftSelect extends WordLeftCommand{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class CursorWordAccessibilityLeft extends WordLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,i,n){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),t,i,n)}}class CursorWordAccessibilityLeftSelect extends WordLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,i,n){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),t,i,n)}}class CursorWordStartRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class CursorWordEndRight extends WordRightCommand{constructor(){var e;super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:2065,mac:{primary:529},weight:100}})}}class CursorWordRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class CursorWordStartRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class CursorWordEndRightSelect extends WordRightCommand{constructor(){var e;super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:ContextKeyExpr.and(EditorContextKeys.textInputFocus,null===(e=ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED,IsWindowsContext))||void 0===e?void 0:e.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class CursorWordRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class CursorWordAccessibilityRight extends WordRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,i,n){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),t,i,n)}}class CursorWordAccessibilityRightSelect extends WordRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,i,n){return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue),t,i,n)}}class DeleteWordCommand extends EditorCommand{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=e.get(ILanguageConfigurationService);if(!t.hasModel())return;const o=getMapForWordSeparators(t.getOption(117)),r=t.getModel(),s=t.getSelections(),a=t.getOption(5),l=t.getOption(8),d=n.getLanguageConfiguration(r.getLanguageId()).getAutoClosingPairs(),c=t._getViewModel(),h=s.map((e=>{const i=this._delete({wordSeparators:o,model:r,selection:e,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(6),autoClosingBrackets:a,autoClosingQuotes:l,autoClosingPairs:d,autoClosedCharacters:c.getCursorAutoClosedCharacters()},this._wordNavigationType);return new ReplaceCommand(i,"")}));t.pushUndoStop(),t.executeCommands(this.id,h),t.pushUndoStop()}}class DeleteWordLeftCommand extends DeleteWordCommand{_delete(e,t){let i=WordOperations.deleteWordLeft(e,t);return i||new Range$2(1,1,1,1)}}class DeleteWordRightCommand extends DeleteWordCommand{_delete(e,t){let i=WordOperations.deleteWordRight(e,t);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new Range$2(n,o,n,o)}}class DeleteWordStartLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:EditorContextKeys.writable})}}class DeleteWordEndLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:EditorContextKeys.writable})}}class DeleteWordLeft extends DeleteWordLeftCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class DeleteWordStartRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:EditorContextKeys.writable})}}class DeleteWordEndRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:EditorContextKeys.writable})}}class DeleteWordRight extends DeleteWordRightCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class DeleteInsideWord extends EditorAction{constructor(){super({id:"deleteInsideWord",precondition:EditorContextKeys.writable,label:localize("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(e,t,i){if(!t.hasModel())return;const n=getMapForWordSeparators(t.getOption(117)),o=t.getModel(),r=t.getSelections().map((e=>{const t=WordOperations.deleteInsideWord(n,o,e);return new ReplaceCommand(t,"")}));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}registerEditorCommand(new CursorWordStartLeft),registerEditorCommand(new CursorWordEndLeft),registerEditorCommand(new CursorWordLeft),registerEditorCommand(new CursorWordStartLeftSelect),registerEditorCommand(new CursorWordEndLeftSelect),registerEditorCommand(new CursorWordLeftSelect),registerEditorCommand(new CursorWordStartRight),registerEditorCommand(new CursorWordEndRight),registerEditorCommand(new CursorWordRight),registerEditorCommand(new CursorWordStartRightSelect),registerEditorCommand(new CursorWordEndRightSelect),registerEditorCommand(new CursorWordRightSelect),registerEditorCommand(new CursorWordAccessibilityLeft),registerEditorCommand(new CursorWordAccessibilityLeftSelect),registerEditorCommand(new CursorWordAccessibilityRight),registerEditorCommand(new CursorWordAccessibilityRightSelect),registerEditorCommand(new DeleteWordStartLeft),registerEditorCommand(new DeleteWordEndLeft),registerEditorCommand(new DeleteWordLeft),registerEditorCommand(new DeleteWordStartRight),registerEditorCommand(new DeleteWordEndRight),registerEditorCommand(new DeleteWordRight),registerEditorAction(DeleteInsideWord);class DeleteWordPartLeft extends DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){let i=WordPartOperations.deleteWordPartLeft(e);return i||new Range$2(1,1,1,1)}}class DeleteWordPartRight extends DeleteWordCommand{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:EditorContextKeys.writable,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){let i=WordPartOperations.deleteWordPartRight(e);if(i)return i;const n=e.model.getLineCount(),o=e.model.getLineMaxColumn(n);return new Range$2(n,o,n,o)}}class WordPartLeftCommand extends MoveWordCommand{_move(e,t,i,n){return WordPartOperations.moveWordPartLeft(e,t,i)}}class CursorWordPartLeft extends WordPartLeftCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}CommandsRegistry.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class CursorWordPartLeftSelect extends WordPartLeftCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}CommandsRegistry.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class WordPartRightCommand extends MoveWordCommand{_move(e,t,i,n){return WordPartOperations.moveWordPartRight(e,t,i)}}class CursorWordPartRight extends WordPartRightCommand{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class CursorWordPartRightSelect extends WordPartRightCommand{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:EditorContextKeys.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}var AccessibilityHelpNLS,AccessibilityHelpNLS2,InspectTokensNLS,GoToLineNLS,QuickHelpNLS,QuickCommandNLS,QuickCommandNLS2,QuickOutlineNLS,QuickOutlineNLS2,StandaloneCodeEditorNLS,StandaloneCodeEditorNLS2,ToggleHighContrastNLS,StandaloneServicesNLS;registerEditorCommand(new DeleteWordPartLeft),registerEditorCommand(new DeleteWordPartRight),registerEditorCommand(new CursorWordPartLeft),registerEditorCommand(new CursorWordPartLeftSelect),registerEditorCommand(new CursorWordPartRight),registerEditorCommand(new CursorWordPartRightSelect),AccessibilityHelpNLS2=AccessibilityHelpNLS||(AccessibilityHelpNLS={}),AccessibilityHelpNLS2.noSelection=localize("noSelection","No selection"),AccessibilityHelpNLS2.singleSelectionRange=localize("singleSelectionRange","Line {0}, Column {1} ({2} selected)"),AccessibilityHelpNLS2.singleSelection=localize("singleSelection","Line {0}, Column {1}"),AccessibilityHelpNLS2.multiSelectionRange=localize("multiSelectionRange","{0} selections ({1} characters selected)"),AccessibilityHelpNLS2.multiSelection=localize("multiSelection","{0} selections"),AccessibilityHelpNLS2.emergencyConfOn=localize("emergencyConfOn","Now changing the setting `accessibilitySupport` to 'on'."),AccessibilityHelpNLS2.openingDocs=localize("openingDocs","Now opening the Editor Accessibility documentation page."),AccessibilityHelpNLS2.readonlyDiffEditor=localize("readonlyDiffEditor"," in a read-only pane of a diff editor."),AccessibilityHelpNLS2.editableDiffEditor=localize("editableDiffEditor"," in a pane of a diff editor."),AccessibilityHelpNLS2.readonlyEditor=localize("readonlyEditor"," in a read-only code editor"),AccessibilityHelpNLS2.editableEditor=localize("editableEditor"," in a code editor"),AccessibilityHelpNLS2.changeConfigToOnMac=localize("changeConfigToOnMac","To configure the editor to be optimized for usage with a Screen Reader press Command+E now."),AccessibilityHelpNLS2.changeConfigToOnWinLinux=localize("changeConfigToOnWinLinux","To configure the editor to be optimized for usage with a Screen Reader press Control+E now."),AccessibilityHelpNLS2.auto_on=localize("auto_on","The editor is configured to be optimized for usage with a Screen Reader."),AccessibilityHelpNLS2.auto_off=localize("auto_off","The editor is configured to never be optimized for usage with a Screen Reader, which is not the case at this time."),AccessibilityHelpNLS2.tabFocusModeOnMsg=localize("tabFocusModeOnMsg","Pressing Tab in the current editor will move focus to the next focusable element. Toggle this behavior by pressing {0}."),AccessibilityHelpNLS2.tabFocusModeOnMsgNoKb=localize("tabFocusModeOnMsgNoKb","Pressing Tab in the current editor will move focus to the next focusable element. The command {0} is currently not triggerable by a keybinding."),AccessibilityHelpNLS2.tabFocusModeOffMsg=localize("tabFocusModeOffMsg","Pressing Tab in the current editor will insert the tab character. Toggle this behavior by pressing {0}."),AccessibilityHelpNLS2.tabFocusModeOffMsgNoKb=localize("tabFocusModeOffMsgNoKb","Pressing Tab in the current editor will insert the tab character. The command {0} is currently not triggerable by a keybinding."),AccessibilityHelpNLS2.openDocMac=localize("openDocMac","Press Command+H now to open a browser window with more information related to editor accessibility."),AccessibilityHelpNLS2.openDocWinLinux=localize("openDocWinLinux","Press Control+H now to open a browser window with more information related to editor accessibility."),AccessibilityHelpNLS2.outroMsg=localize("outroMsg","You can dismiss this tooltip and return to the editor by pressing Escape or Shift+Escape."),AccessibilityHelpNLS2.showAccessibilityHelpAction=localize("showAccessibilityHelpAction","Show Accessibility Help"),(InspectTokensNLS||(InspectTokensNLS={})).inspectTokensAction=localize("inspectTokens","Developer: Inspect Tokens"),(GoToLineNLS||(GoToLineNLS={})).gotoLineActionLabel=localize("gotoLineActionLabel","Go to Line/Column..."),(QuickHelpNLS||(QuickHelpNLS={})).helpQuickAccessActionLabel=localize("helpQuickAccess","Show all Quick Access Providers"),QuickCommandNLS2=QuickCommandNLS||(QuickCommandNLS={}),QuickCommandNLS2.quickCommandActionLabel=localize("quickCommandActionLabel","Command Palette"),QuickCommandNLS2.quickCommandHelp=localize("quickCommandActionHelp","Show And Run Commands"),QuickOutlineNLS2=QuickOutlineNLS||(QuickOutlineNLS={}),QuickOutlineNLS2.quickOutlineActionLabel=localize("quickOutlineActionLabel","Go to Symbol..."),QuickOutlineNLS2.quickOutlineByCategoryActionLabel=localize("quickOutlineByCategoryActionLabel","Go to Symbol by Category..."),StandaloneCodeEditorNLS2=StandaloneCodeEditorNLS||(StandaloneCodeEditorNLS={}),StandaloneCodeEditorNLS2.editorViewAccessibleLabel=localize("editorViewAccessibleLabel","Editor content"),StandaloneCodeEditorNLS2.accessibilityHelpMessage=localize("accessibilityHelpMessage","Press Alt+F1 for Accessibility Options."),(ToggleHighContrastNLS||(ToggleHighContrastNLS={})).toggleHighContrast=localize("toggleHighContrast","Toggle High Contrast Theme"),(StandaloneServicesNLS||(StandaloneServicesNLS={})).bulkEditServiceSummary=localize("bulkEditServiceSummary","Made {0} edits in {1} files");var accessibilityHelp="",__decorate$j=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$i=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE=new RawContextKey("accessibilityHelpWidgetVisible",!1);let AccessibilityHelpController=class e extends Disposable{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(AccessibilityHelpWidget,this._editor))}static get(t){return t.getContribution(e.ID)}show(){this._widget.show()}hide(){this._widget.hide()}};function getSelectionLabel(e,t){return e&&0!==e.length?1===e.length?t?format(AccessibilityHelpNLS.singleSelectionRange,e[0].positionLineNumber,e[0].positionColumn,t):format(AccessibilityHelpNLS.singleSelection,e[0].positionLineNumber,e[0].positionColumn):t?format(AccessibilityHelpNLS.multiSelectionRange,e.length,t):e.length>0?format(AccessibilityHelpNLS.multiSelection,e.length):"":AccessibilityHelpNLS.noSelection}AccessibilityHelpController.ID="editor.contrib.accessibilityHelpController",AccessibilityHelpController=__decorate$j([__param$i(1,IInstantiationService)],AccessibilityHelpController);let AccessibilityHelpWidget=class e extends Widget{constructor(e,t,i,n){super(),this._contextKeyService=t,this._keybindingService=i,this._openerService=n,this._editor=e,this._isVisibleKey=CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE.bindTo(this._contextKeyService),this._domNode=createFastDomNode(document.createElement("div")),this._domNode.setClassName("accessibilityHelpWidget"),this._domNode.setDisplay("none"),this._domNode.setAttribute("role","dialog"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode=createFastDomNode(document.createElement("div")),this._contentDomNode.setAttribute("role","document"),this._domNode.appendChild(this._contentDomNode),this._isVisible=!1,this._register(this._editor.onDidLayoutChange((()=>{this._isVisible&&this._layout()}))),this._register(addStandardDisposableListener(this._contentDomNode.domNode,"keydown",(e=>{if(this._isVisible&&(e.equals(2083)&&(alert(AccessibilityHelpNLS.emergencyConfOn),this._editor.updateOptions({accessibilitySupport:"on"}),clearNode(this._contentDomNode.domNode),this._buildContent(),this._contentDomNode.domNode.focus(),e.preventDefault(),e.stopPropagation()),e.equals(2086))){alert(AccessibilityHelpNLS.openingDocs);let t=this._editor.getRawOptions().accessibilityHelpUrl;void 0===t&&(t="https://go.microsoft.com/fwlink/?linkid=852450"),this._openerService.open(URI.parse(t)),e.preventDefault(),e.stopPropagation()}}))),this.onblur(this._contentDomNode.domNode,(()=>{this.hide()})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay("block"),this._domNode.setAttribute("aria-hidden","false"),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(e,t,i){const n=this._keybindingService.lookupKeybinding(e);return n?format(t,n.getAriaLabel()):format(i,e)}_buildContent(){const e=this._editor.getOptions(),t=this._editor.getSelections();let i=0;if(t){const e=this._editor.getModel();e&&t.forEach((t=>{i+=e.getValueLengthInRange(t)}))}let n=getSelectionLabel(t,i);e.get(54)?e.get(81)?n+=AccessibilityHelpNLS.readonlyDiffEditor:n+=AccessibilityHelpNLS.editableDiffEditor:e.get(81)?n+=AccessibilityHelpNLS.readonlyEditor:n+=AccessibilityHelpNLS.editableEditor;const o=isMacintosh?AccessibilityHelpNLS.changeConfigToOnMac:AccessibilityHelpNLS.changeConfigToOnWinLinux;switch(e.get(2)){case 0:n+="\n\n - "+o;break;case 2:n+="\n\n - "+AccessibilityHelpNLS.auto_on;break;case 1:n+="\n\n - "+AccessibilityHelpNLS.auto_off,n+=" "+o}e.get(130)?n+="\n\n - "+this._descriptionForCommand(ToggleTabFocusModeAction.ID,AccessibilityHelpNLS.tabFocusModeOnMsg,AccessibilityHelpNLS.tabFocusModeOnMsgNoKb):n+="\n\n - "+this._descriptionForCommand(ToggleTabFocusModeAction.ID,AccessibilityHelpNLS.tabFocusModeOffMsg,AccessibilityHelpNLS.tabFocusModeOffMsgNoKb);n+="\n\n - "+(isMacintosh?AccessibilityHelpNLS.openDocMac:AccessibilityHelpNLS.openDocWinLinux),n+="\n\n"+AccessibilityHelpNLS.outroMsg,this._contentDomNode.domNode.appendChild(renderFormattedText(n)),this._contentDomNode.domNode.setAttribute("aria-label",n)}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay("none"),this._domNode.setAttribute("aria-hidden","true"),this._contentDomNode.domNode.tabIndex=-1,clearNode(this._contentDomNode.domNode),this._editor.focus())}_layout(){const t=this._editor.getLayoutInfo(),i=Math.max(5,Math.min(e.WIDTH,t.width-40)),n=Math.max(5,Math.min(e.HEIGHT,t.height-40));this._domNode.setWidth(i),this._domNode.setHeight(n);const o=Math.round((t.height-n)/2);this._domNode.setTop(o);const r=Math.round((t.width-i)/2);this._domNode.setLeft(r)}};AccessibilityHelpWidget.ID="editor.contrib.accessibilityHelpWidget",AccessibilityHelpWidget.WIDTH=500,AccessibilityHelpWidget.HEIGHT=300,AccessibilityHelpWidget=__decorate$j([__param$i(1,IContextKeyService),__param$i(2,IKeybindingService),__param$i(3,IOpenerService)],AccessibilityHelpWidget);class ShowAccessibilityHelpAction extends EditorAction{constructor(){super({id:"editor.action.showAccessibilityHelp",label:AccessibilityHelpNLS.showAccessibilityHelpAction,alias:"Show Accessibility Help",precondition:void 0,kbOpts:{primary:571,weight:100,linux:{primary:1595,secondary:[571]}}})}run(e,t){const i=AccessibilityHelpController.get(t);i&&i.show()}}registerEditorContribution(AccessibilityHelpController.ID,AccessibilityHelpController),registerEditorAction(ShowAccessibilityHelpAction);const AccessibilityHelpCommand=EditorCommand.bindToContribution(AccessibilityHelpController.get);var AccessibilitySupport,AccessibilitySupport2,CompletionItemInsertTextRule,CompletionItemInsertTextRule2,CompletionItemKind,CompletionItemKind2,CompletionItemTag,CompletionItemTag2,CompletionTriggerKind,CompletionTriggerKind2,ContentWidgetPositionPreference,ContentWidgetPositionPreference2,CursorChangeReason,CursorChangeReason2,DefaultEndOfLine,DefaultEndOfLine2,DocumentHighlightKind,EditorAutoIndentStrategy,EditorAutoIndentStrategy2,EditorOption,EditorOption2,EndOfLinePreference,EndOfLinePreference2,EndOfLineSequence,EndOfLineSequence2,IndentAction,InjectedTextCursorStops,InlayHintKind,InlineCompletionTriggerKind,KeyCode$1,KeyCode2,MarkerSeverity$1,MarkerTag$1,MarkerTag2,MinimapPosition,MouseTargetType,MouseTargetType2,OverlayWidgetPositionPreference,OverlayWidgetPositionPreference2,OverviewRulerLane,PositionAffinity,PositionAffinity2,RenderLineNumbersType,RenderLineNumbersType2,RenderMinimap,RenderMinimap2,ScrollType,ScrollType2,ScrollbarVisibility,ScrollbarVisibility2,SelectionDirection$1,SelectionDirection2,SignatureHelpTriggerKind,SymbolKind,SymbolKind2,SymbolTag,SymbolTag2,TextEditorCursorBlinkingStyle,TextEditorCursorBlinkingStyle2,TextEditorCursorStyle,TrackedRangeStickiness,TrackedRangeStickiness2,WrappingIndent,WrappingIndent2;registerEditorCommand(new AccessibilityHelpCommand({id:"closeAccessibilityHelp",precondition:CONTEXT_ACCESSIBILITY_WIDGET_VISIBLE,handler:e=>e.hide(),kbOpts:{weight:200,kbExpr:EditorContextKeys.focus,primary:9,secondary:[1033]}})),registerThemingParticipant(((e,t)=>{const i=e.getColor(editorWidgetBackground);i&&t.addRule(`.monaco-editor .accessibilityHelpWidget { background-color: ${i}; }`);const n=e.getColor(editorWidgetForeground);n&&t.addRule(`.monaco-editor .accessibilityHelpWidget { color: ${n}; }`);const o=e.getColor(widgetShadow);o&&t.addRule(`.monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px ${o}; }`);const r=e.getColor(contrastBorder);r&&t.addRule(`.monaco-editor .accessibilityHelpWidget { border: 2px solid ${r}; }`)})),AccessibilitySupport2=AccessibilitySupport||(AccessibilitySupport={}),AccessibilitySupport2[AccessibilitySupport2.Unknown=0]="Unknown",AccessibilitySupport2[AccessibilitySupport2.Disabled=1]="Disabled",AccessibilitySupport2[AccessibilitySupport2.Enabled=2]="Enabled",CompletionItemInsertTextRule2=CompletionItemInsertTextRule||(CompletionItemInsertTextRule={}),CompletionItemInsertTextRule2[CompletionItemInsertTextRule2.KeepWhitespace=1]="KeepWhitespace",CompletionItemInsertTextRule2[CompletionItemInsertTextRule2.InsertAsSnippet=4]="InsertAsSnippet",CompletionItemKind2=CompletionItemKind||(CompletionItemKind={}),CompletionItemKind2[CompletionItemKind2.Method=0]="Method",CompletionItemKind2[CompletionItemKind2.Function=1]="Function",CompletionItemKind2[CompletionItemKind2.Constructor=2]="Constructor",CompletionItemKind2[CompletionItemKind2.Field=3]="Field",CompletionItemKind2[CompletionItemKind2.Variable=4]="Variable",CompletionItemKind2[CompletionItemKind2.Class=5]="Class",CompletionItemKind2[CompletionItemKind2.Struct=6]="Struct",CompletionItemKind2[CompletionItemKind2.Interface=7]="Interface",CompletionItemKind2[CompletionItemKind2.Module=8]="Module",CompletionItemKind2[CompletionItemKind2.Property=9]="Property",CompletionItemKind2[CompletionItemKind2.Event=10]="Event",CompletionItemKind2[CompletionItemKind2.Operator=11]="Operator",CompletionItemKind2[CompletionItemKind2.Unit=12]="Unit",CompletionItemKind2[CompletionItemKind2.Value=13]="Value",CompletionItemKind2[CompletionItemKind2.Constant=14]="Constant",CompletionItemKind2[CompletionItemKind2.Enum=15]="Enum",CompletionItemKind2[CompletionItemKind2.EnumMember=16]="EnumMember",CompletionItemKind2[CompletionItemKind2.Keyword=17]="Keyword",CompletionItemKind2[CompletionItemKind2.Text=18]="Text",CompletionItemKind2[CompletionItemKind2.Color=19]="Color",CompletionItemKind2[CompletionItemKind2.File=20]="File",CompletionItemKind2[CompletionItemKind2.Reference=21]="Reference",CompletionItemKind2[CompletionItemKind2.Customcolor=22]="Customcolor",CompletionItemKind2[CompletionItemKind2.Folder=23]="Folder",CompletionItemKind2[CompletionItemKind2.TypeParameter=24]="TypeParameter",CompletionItemKind2[CompletionItemKind2.User=25]="User",CompletionItemKind2[CompletionItemKind2.Issue=26]="Issue",CompletionItemKind2[CompletionItemKind2.Snippet=27]="Snippet",CompletionItemTag2=CompletionItemTag||(CompletionItemTag={}),CompletionItemTag2[CompletionItemTag2.Deprecated=1]="Deprecated",CompletionTriggerKind2=CompletionTriggerKind||(CompletionTriggerKind={}),CompletionTriggerKind2[CompletionTriggerKind2.Invoke=0]="Invoke",CompletionTriggerKind2[CompletionTriggerKind2.TriggerCharacter=1]="TriggerCharacter",CompletionTriggerKind2[CompletionTriggerKind2.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions",ContentWidgetPositionPreference2=ContentWidgetPositionPreference||(ContentWidgetPositionPreference={}),ContentWidgetPositionPreference2[ContentWidgetPositionPreference2.EXACT=0]="EXACT",ContentWidgetPositionPreference2[ContentWidgetPositionPreference2.ABOVE=1]="ABOVE",ContentWidgetPositionPreference2[ContentWidgetPositionPreference2.BELOW=2]="BELOW",CursorChangeReason2=CursorChangeReason||(CursorChangeReason={}),CursorChangeReason2[CursorChangeReason2.NotSet=0]="NotSet",CursorChangeReason2[CursorChangeReason2.ContentFlush=1]="ContentFlush",CursorChangeReason2[CursorChangeReason2.RecoverFromMarkers=2]="RecoverFromMarkers",CursorChangeReason2[CursorChangeReason2.Explicit=3]="Explicit",CursorChangeReason2[CursorChangeReason2.Paste=4]="Paste",CursorChangeReason2[CursorChangeReason2.Undo=5]="Undo",CursorChangeReason2[CursorChangeReason2.Redo=6]="Redo",DefaultEndOfLine2=DefaultEndOfLine||(DefaultEndOfLine={}),DefaultEndOfLine2[DefaultEndOfLine2.LF=1]="LF",DefaultEndOfLine2[DefaultEndOfLine2.CRLF=2]="CRLF",function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"}(DocumentHighlightKind||(DocumentHighlightKind={})),EditorAutoIndentStrategy2=EditorAutoIndentStrategy||(EditorAutoIndentStrategy={}),EditorAutoIndentStrategy2[EditorAutoIndentStrategy2.None=0]="None",EditorAutoIndentStrategy2[EditorAutoIndentStrategy2.Keep=1]="Keep",EditorAutoIndentStrategy2[EditorAutoIndentStrategy2.Brackets=2]="Brackets",EditorAutoIndentStrategy2[EditorAutoIndentStrategy2.Advanced=3]="Advanced",EditorAutoIndentStrategy2[EditorAutoIndentStrategy2.Full=4]="Full",EditorOption2=EditorOption||(EditorOption={}),EditorOption2[EditorOption2.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",EditorOption2[EditorOption2.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",EditorOption2[EditorOption2.accessibilitySupport=2]="accessibilitySupport",EditorOption2[EditorOption2.accessibilityPageSize=3]="accessibilityPageSize",EditorOption2[EditorOption2.ariaLabel=4]="ariaLabel",EditorOption2[EditorOption2.autoClosingBrackets=5]="autoClosingBrackets",EditorOption2[EditorOption2.autoClosingDelete=6]="autoClosingDelete",EditorOption2[EditorOption2.autoClosingOvertype=7]="autoClosingOvertype",EditorOption2[EditorOption2.autoClosingQuotes=8]="autoClosingQuotes",EditorOption2[EditorOption2.autoIndent=9]="autoIndent",EditorOption2[EditorOption2.automaticLayout=10]="automaticLayout",EditorOption2[EditorOption2.autoSurround=11]="autoSurround",EditorOption2[EditorOption2.bracketPairColorization=12]="bracketPairColorization",EditorOption2[EditorOption2.guides=13]="guides",EditorOption2[EditorOption2.codeLens=14]="codeLens",EditorOption2[EditorOption2.codeLensFontFamily=15]="codeLensFontFamily",EditorOption2[EditorOption2.codeLensFontSize=16]="codeLensFontSize",EditorOption2[EditorOption2.colorDecorators=17]="colorDecorators",EditorOption2[EditorOption2.columnSelection=18]="columnSelection",EditorOption2[EditorOption2.comments=19]="comments",EditorOption2[EditorOption2.contextmenu=20]="contextmenu",EditorOption2[EditorOption2.copyWithSyntaxHighlighting=21]="copyWithSyntaxHighlighting",EditorOption2[EditorOption2.cursorBlinking=22]="cursorBlinking",EditorOption2[EditorOption2.cursorSmoothCaretAnimation=23]="cursorSmoothCaretAnimation",EditorOption2[EditorOption2.cursorStyle=24]="cursorStyle",EditorOption2[EditorOption2.cursorSurroundingLines=25]="cursorSurroundingLines",EditorOption2[EditorOption2.cursorSurroundingLinesStyle=26]="cursorSurroundingLinesStyle",EditorOption2[EditorOption2.cursorWidth=27]="cursorWidth",EditorOption2[EditorOption2.disableLayerHinting=28]="disableLayerHinting",EditorOption2[EditorOption2.disableMonospaceOptimizations=29]="disableMonospaceOptimizations",EditorOption2[EditorOption2.domReadOnly=30]="domReadOnly",EditorOption2[EditorOption2.dragAndDrop=31]="dragAndDrop",EditorOption2[EditorOption2.emptySelectionClipboard=32]="emptySelectionClipboard",EditorOption2[EditorOption2.extraEditorClassName=33]="extraEditorClassName",EditorOption2[EditorOption2.fastScrollSensitivity=34]="fastScrollSensitivity",EditorOption2[EditorOption2.find=35]="find",EditorOption2[EditorOption2.fixedOverflowWidgets=36]="fixedOverflowWidgets",EditorOption2[EditorOption2.folding=37]="folding",EditorOption2[EditorOption2.foldingStrategy=38]="foldingStrategy",EditorOption2[EditorOption2.foldingHighlight=39]="foldingHighlight",EditorOption2[EditorOption2.foldingImportsByDefault=40]="foldingImportsByDefault",EditorOption2[EditorOption2.foldingMaximumRegions=41]="foldingMaximumRegions",EditorOption2[EditorOption2.unfoldOnClickAfterEndOfLine=42]="unfoldOnClickAfterEndOfLine",EditorOption2[EditorOption2.fontFamily=43]="fontFamily",EditorOption2[EditorOption2.fontInfo=44]="fontInfo",EditorOption2[EditorOption2.fontLigatures=45]="fontLigatures",EditorOption2[EditorOption2.fontSize=46]="fontSize",EditorOption2[EditorOption2.fontWeight=47]="fontWeight",EditorOption2[EditorOption2.formatOnPaste=48]="formatOnPaste",EditorOption2[EditorOption2.formatOnType=49]="formatOnType",EditorOption2[EditorOption2.glyphMargin=50]="glyphMargin",EditorOption2[EditorOption2.gotoLocation=51]="gotoLocation",EditorOption2[EditorOption2.hideCursorInOverviewRuler=52]="hideCursorInOverviewRuler",EditorOption2[EditorOption2.hover=53]="hover",EditorOption2[EditorOption2.inDiffEditor=54]="inDiffEditor",EditorOption2[EditorOption2.inlineSuggest=55]="inlineSuggest",EditorOption2[EditorOption2.letterSpacing=56]="letterSpacing",EditorOption2[EditorOption2.lightbulb=57]="lightbulb",EditorOption2[EditorOption2.lineDecorationsWidth=58]="lineDecorationsWidth",EditorOption2[EditorOption2.lineHeight=59]="lineHeight",EditorOption2[EditorOption2.lineNumbers=60]="lineNumbers",EditorOption2[EditorOption2.lineNumbersMinChars=61]="lineNumbersMinChars",EditorOption2[EditorOption2.linkedEditing=62]="linkedEditing",EditorOption2[EditorOption2.links=63]="links",EditorOption2[EditorOption2.matchBrackets=64]="matchBrackets",EditorOption2[EditorOption2.minimap=65]="minimap",EditorOption2[EditorOption2.mouseStyle=66]="mouseStyle",EditorOption2[EditorOption2.mouseWheelScrollSensitivity=67]="mouseWheelScrollSensitivity",EditorOption2[EditorOption2.mouseWheelZoom=68]="mouseWheelZoom",EditorOption2[EditorOption2.multiCursorMergeOverlapping=69]="multiCursorMergeOverlapping",EditorOption2[EditorOption2.multiCursorModifier=70]="multiCursorModifier",EditorOption2[EditorOption2.multiCursorPaste=71]="multiCursorPaste",EditorOption2[EditorOption2.occurrencesHighlight=72]="occurrencesHighlight",EditorOption2[EditorOption2.overviewRulerBorder=73]="overviewRulerBorder",EditorOption2[EditorOption2.overviewRulerLanes=74]="overviewRulerLanes",EditorOption2[EditorOption2.padding=75]="padding",EditorOption2[EditorOption2.parameterHints=76]="parameterHints",EditorOption2[EditorOption2.peekWidgetDefaultFocus=77]="peekWidgetDefaultFocus",EditorOption2[EditorOption2.definitionLinkOpensInPeek=78]="definitionLinkOpensInPeek",EditorOption2[EditorOption2.quickSuggestions=79]="quickSuggestions",EditorOption2[EditorOption2.quickSuggestionsDelay=80]="quickSuggestionsDelay",EditorOption2[EditorOption2.readOnly=81]="readOnly",EditorOption2[EditorOption2.renameOnType=82]="renameOnType",EditorOption2[EditorOption2.renderControlCharacters=83]="renderControlCharacters",EditorOption2[EditorOption2.renderFinalNewline=84]="renderFinalNewline",EditorOption2[EditorOption2.renderLineHighlight=85]="renderLineHighlight",EditorOption2[EditorOption2.renderLineHighlightOnlyWhenFocus=86]="renderLineHighlightOnlyWhenFocus",EditorOption2[EditorOption2.renderValidationDecorations=87]="renderValidationDecorations",EditorOption2[EditorOption2.renderWhitespace=88]="renderWhitespace",EditorOption2[EditorOption2.revealHorizontalRightPadding=89]="revealHorizontalRightPadding",EditorOption2[EditorOption2.roundedSelection=90]="roundedSelection",EditorOption2[EditorOption2.rulers=91]="rulers",EditorOption2[EditorOption2.scrollbar=92]="scrollbar",EditorOption2[EditorOption2.scrollBeyondLastColumn=93]="scrollBeyondLastColumn",EditorOption2[EditorOption2.scrollBeyondLastLine=94]="scrollBeyondLastLine",EditorOption2[EditorOption2.scrollPredominantAxis=95]="scrollPredominantAxis",EditorOption2[EditorOption2.selectionClipboard=96]="selectionClipboard",EditorOption2[EditorOption2.selectionHighlight=97]="selectionHighlight",EditorOption2[EditorOption2.selectOnLineNumbers=98]="selectOnLineNumbers",EditorOption2[EditorOption2.showFoldingControls=99]="showFoldingControls",EditorOption2[EditorOption2.showUnused=100]="showUnused",EditorOption2[EditorOption2.snippetSuggestions=101]="snippetSuggestions",EditorOption2[EditorOption2.smartSelect=102]="smartSelect",EditorOption2[EditorOption2.smoothScrolling=103]="smoothScrolling",EditorOption2[EditorOption2.stickyTabStops=104]="stickyTabStops",EditorOption2[EditorOption2.stopRenderingLineAfter=105]="stopRenderingLineAfter",EditorOption2[EditorOption2.suggest=106]="suggest",EditorOption2[EditorOption2.suggestFontSize=107]="suggestFontSize",EditorOption2[EditorOption2.suggestLineHeight=108]="suggestLineHeight",EditorOption2[EditorOption2.suggestOnTriggerCharacters=109]="suggestOnTriggerCharacters",EditorOption2[EditorOption2.suggestSelection=110]="suggestSelection",EditorOption2[EditorOption2.tabCompletion=111]="tabCompletion",EditorOption2[EditorOption2.tabIndex=112]="tabIndex",EditorOption2[EditorOption2.unicodeHighlighting=113]="unicodeHighlighting",EditorOption2[EditorOption2.unusualLineTerminators=114]="unusualLineTerminators",EditorOption2[EditorOption2.useShadowDOM=115]="useShadowDOM",EditorOption2[EditorOption2.useTabStops=116]="useTabStops",EditorOption2[EditorOption2.wordSeparators=117]="wordSeparators",EditorOption2[EditorOption2.wordWrap=118]="wordWrap",EditorOption2[EditorOption2.wordWrapBreakAfterCharacters=119]="wordWrapBreakAfterCharacters",EditorOption2[EditorOption2.wordWrapBreakBeforeCharacters=120]="wordWrapBreakBeforeCharacters",EditorOption2[EditorOption2.wordWrapColumn=121]="wordWrapColumn",EditorOption2[EditorOption2.wordWrapOverride1=122]="wordWrapOverride1",EditorOption2[EditorOption2.wordWrapOverride2=123]="wordWrapOverride2",EditorOption2[EditorOption2.wrappingIndent=124]="wrappingIndent",EditorOption2[EditorOption2.wrappingStrategy=125]="wrappingStrategy",EditorOption2[EditorOption2.showDeprecated=126]="showDeprecated",EditorOption2[EditorOption2.inlayHints=127]="inlayHints",EditorOption2[EditorOption2.editorClassName=128]="editorClassName",EditorOption2[EditorOption2.pixelRatio=129]="pixelRatio",EditorOption2[EditorOption2.tabFocusMode=130]="tabFocusMode",EditorOption2[EditorOption2.layoutInfo=131]="layoutInfo",EditorOption2[EditorOption2.wrappingInfo=132]="wrappingInfo",EndOfLinePreference2=EndOfLinePreference||(EndOfLinePreference={}),EndOfLinePreference2[EndOfLinePreference2.TextDefined=0]="TextDefined",EndOfLinePreference2[EndOfLinePreference2.LF=1]="LF",EndOfLinePreference2[EndOfLinePreference2.CRLF=2]="CRLF",EndOfLineSequence2=EndOfLineSequence||(EndOfLineSequence={}),EndOfLineSequence2[EndOfLineSequence2.LF=0]="LF",EndOfLineSequence2[EndOfLineSequence2.CRLF=1]="CRLF",function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"}(IndentAction||(IndentAction={})),function(e){e[e.Both=0]="Both",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.None=3]="None"}(InjectedTextCursorStops||(InjectedTextCursorStops={})),function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"}(InlayHintKind||(InlayHintKind={})),function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"}(InlineCompletionTriggerKind||(InlineCompletionTriggerKind={})),KeyCode2=KeyCode$1||(KeyCode$1={}),KeyCode2[KeyCode2.DependsOnKbLayout=-1]="DependsOnKbLayout",KeyCode2[KeyCode2.Unknown=0]="Unknown",KeyCode2[KeyCode2.Backspace=1]="Backspace",KeyCode2[KeyCode2.Tab=2]="Tab",KeyCode2[KeyCode2.Enter=3]="Enter",KeyCode2[KeyCode2.Shift=4]="Shift",KeyCode2[KeyCode2.Ctrl=5]="Ctrl",KeyCode2[KeyCode2.Alt=6]="Alt",KeyCode2[KeyCode2.PauseBreak=7]="PauseBreak",KeyCode2[KeyCode2.CapsLock=8]="CapsLock",KeyCode2[KeyCode2.Escape=9]="Escape",KeyCode2[KeyCode2.Space=10]="Space",KeyCode2[KeyCode2.PageUp=11]="PageUp",KeyCode2[KeyCode2.PageDown=12]="PageDown",KeyCode2[KeyCode2.End=13]="End",KeyCode2[KeyCode2.Home=14]="Home",KeyCode2[KeyCode2.LeftArrow=15]="LeftArrow",KeyCode2[KeyCode2.UpArrow=16]="UpArrow",KeyCode2[KeyCode2.RightArrow=17]="RightArrow",KeyCode2[KeyCode2.DownArrow=18]="DownArrow",KeyCode2[KeyCode2.Insert=19]="Insert",KeyCode2[KeyCode2.Delete=20]="Delete",KeyCode2[KeyCode2.Digit0=21]="Digit0",KeyCode2[KeyCode2.Digit1=22]="Digit1",KeyCode2[KeyCode2.Digit2=23]="Digit2",KeyCode2[KeyCode2.Digit3=24]="Digit3",KeyCode2[KeyCode2.Digit4=25]="Digit4",KeyCode2[KeyCode2.Digit5=26]="Digit5",KeyCode2[KeyCode2.Digit6=27]="Digit6",KeyCode2[KeyCode2.Digit7=28]="Digit7",KeyCode2[KeyCode2.Digit8=29]="Digit8",KeyCode2[KeyCode2.Digit9=30]="Digit9",KeyCode2[KeyCode2.KeyA=31]="KeyA",KeyCode2[KeyCode2.KeyB=32]="KeyB",KeyCode2[KeyCode2.KeyC=33]="KeyC",KeyCode2[KeyCode2.KeyD=34]="KeyD",KeyCode2[KeyCode2.KeyE=35]="KeyE",KeyCode2[KeyCode2.KeyF=36]="KeyF",KeyCode2[KeyCode2.KeyG=37]="KeyG",KeyCode2[KeyCode2.KeyH=38]="KeyH",KeyCode2[KeyCode2.KeyI=39]="KeyI",KeyCode2[KeyCode2.KeyJ=40]="KeyJ",KeyCode2[KeyCode2.KeyK=41]="KeyK",KeyCode2[KeyCode2.KeyL=42]="KeyL",KeyCode2[KeyCode2.KeyM=43]="KeyM",KeyCode2[KeyCode2.KeyN=44]="KeyN",KeyCode2[KeyCode2.KeyO=45]="KeyO",KeyCode2[KeyCode2.KeyP=46]="KeyP",KeyCode2[KeyCode2.KeyQ=47]="KeyQ",KeyCode2[KeyCode2.KeyR=48]="KeyR",KeyCode2[KeyCode2.KeyS=49]="KeyS",KeyCode2[KeyCode2.KeyT=50]="KeyT",KeyCode2[KeyCode2.KeyU=51]="KeyU",KeyCode2[KeyCode2.KeyV=52]="KeyV",KeyCode2[KeyCode2.KeyW=53]="KeyW",KeyCode2[KeyCode2.KeyX=54]="KeyX",KeyCode2[KeyCode2.KeyY=55]="KeyY",KeyCode2[KeyCode2.KeyZ=56]="KeyZ",KeyCode2[KeyCode2.Meta=57]="Meta",KeyCode2[KeyCode2.ContextMenu=58]="ContextMenu",KeyCode2[KeyCode2.F1=59]="F1",KeyCode2[KeyCode2.F2=60]="F2",KeyCode2[KeyCode2.F3=61]="F3",KeyCode2[KeyCode2.F4=62]="F4",KeyCode2[KeyCode2.F5=63]="F5",KeyCode2[KeyCode2.F6=64]="F6",KeyCode2[KeyCode2.F7=65]="F7",KeyCode2[KeyCode2.F8=66]="F8",KeyCode2[KeyCode2.F9=67]="F9",KeyCode2[KeyCode2.F10=68]="F10",KeyCode2[KeyCode2.F11=69]="F11",KeyCode2[KeyCode2.F12=70]="F12",KeyCode2[KeyCode2.F13=71]="F13",KeyCode2[KeyCode2.F14=72]="F14",KeyCode2[KeyCode2.F15=73]="F15",KeyCode2[KeyCode2.F16=74]="F16",KeyCode2[KeyCode2.F17=75]="F17",KeyCode2[KeyCode2.F18=76]="F18",KeyCode2[KeyCode2.F19=77]="F19",KeyCode2[KeyCode2.NumLock=78]="NumLock",KeyCode2[KeyCode2.ScrollLock=79]="ScrollLock",KeyCode2[KeyCode2.Semicolon=80]="Semicolon",KeyCode2[KeyCode2.Equal=81]="Equal",KeyCode2[KeyCode2.Comma=82]="Comma",KeyCode2[KeyCode2.Minus=83]="Minus",KeyCode2[KeyCode2.Period=84]="Period",KeyCode2[KeyCode2.Slash=85]="Slash",KeyCode2[KeyCode2.Backquote=86]="Backquote",KeyCode2[KeyCode2.BracketLeft=87]="BracketLeft",KeyCode2[KeyCode2.Backslash=88]="Backslash",KeyCode2[KeyCode2.BracketRight=89]="BracketRight",KeyCode2[KeyCode2.Quote=90]="Quote",KeyCode2[KeyCode2.OEM_8=91]="OEM_8",KeyCode2[KeyCode2.IntlBackslash=92]="IntlBackslash",KeyCode2[KeyCode2.Numpad0=93]="Numpad0",KeyCode2[KeyCode2.Numpad1=94]="Numpad1",KeyCode2[KeyCode2.Numpad2=95]="Numpad2",KeyCode2[KeyCode2.Numpad3=96]="Numpad3",KeyCode2[KeyCode2.Numpad4=97]="Numpad4",KeyCode2[KeyCode2.Numpad5=98]="Numpad5",KeyCode2[KeyCode2.Numpad6=99]="Numpad6",KeyCode2[KeyCode2.Numpad7=100]="Numpad7",KeyCode2[KeyCode2.Numpad8=101]="Numpad8",KeyCode2[KeyCode2.Numpad9=102]="Numpad9",KeyCode2[KeyCode2.NumpadMultiply=103]="NumpadMultiply",KeyCode2[KeyCode2.NumpadAdd=104]="NumpadAdd",KeyCode2[KeyCode2.NUMPAD_SEPARATOR=105]="NUMPAD_SEPARATOR",KeyCode2[KeyCode2.NumpadSubtract=106]="NumpadSubtract",KeyCode2[KeyCode2.NumpadDecimal=107]="NumpadDecimal",KeyCode2[KeyCode2.NumpadDivide=108]="NumpadDivide",KeyCode2[KeyCode2.KEY_IN_COMPOSITION=109]="KEY_IN_COMPOSITION",KeyCode2[KeyCode2.ABNT_C1=110]="ABNT_C1",KeyCode2[KeyCode2.ABNT_C2=111]="ABNT_C2",KeyCode2[KeyCode2.AudioVolumeMute=112]="AudioVolumeMute",KeyCode2[KeyCode2.AudioVolumeUp=113]="AudioVolumeUp",KeyCode2[KeyCode2.AudioVolumeDown=114]="AudioVolumeDown",KeyCode2[KeyCode2.BrowserSearch=115]="BrowserSearch",KeyCode2[KeyCode2.BrowserHome=116]="BrowserHome",KeyCode2[KeyCode2.BrowserBack=117]="BrowserBack",KeyCode2[KeyCode2.BrowserForward=118]="BrowserForward",KeyCode2[KeyCode2.MediaTrackNext=119]="MediaTrackNext",KeyCode2[KeyCode2.MediaTrackPrevious=120]="MediaTrackPrevious",KeyCode2[KeyCode2.MediaStop=121]="MediaStop",KeyCode2[KeyCode2.MediaPlayPause=122]="MediaPlayPause",KeyCode2[KeyCode2.LaunchMediaPlayer=123]="LaunchMediaPlayer",KeyCode2[KeyCode2.LaunchMail=124]="LaunchMail",KeyCode2[KeyCode2.LaunchApp2=125]="LaunchApp2",KeyCode2[KeyCode2.Clear=126]="Clear",KeyCode2[KeyCode2.MAX_VALUE=127]="MAX_VALUE",function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"}(MarkerSeverity$1||(MarkerSeverity$1={})),MarkerTag2=MarkerTag$1||(MarkerTag$1={}),MarkerTag2[MarkerTag2.Unnecessary=1]="Unnecessary",MarkerTag2[MarkerTag2.Deprecated=2]="Deprecated",function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"}(MinimapPosition||(MinimapPosition={})),MouseTargetType2=MouseTargetType||(MouseTargetType={}),MouseTargetType2[MouseTargetType2.UNKNOWN=0]="UNKNOWN",MouseTargetType2[MouseTargetType2.TEXTAREA=1]="TEXTAREA",MouseTargetType2[MouseTargetType2.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",MouseTargetType2[MouseTargetType2.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",MouseTargetType2[MouseTargetType2.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",MouseTargetType2[MouseTargetType2.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",MouseTargetType2[MouseTargetType2.CONTENT_TEXT=6]="CONTENT_TEXT",MouseTargetType2[MouseTargetType2.CONTENT_EMPTY=7]="CONTENT_EMPTY",MouseTargetType2[MouseTargetType2.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",MouseTargetType2[MouseTargetType2.CONTENT_WIDGET=9]="CONTENT_WIDGET",MouseTargetType2[MouseTargetType2.OVERVIEW_RULER=10]="OVERVIEW_RULER",MouseTargetType2[MouseTargetType2.SCROLLBAR=11]="SCROLLBAR",MouseTargetType2[MouseTargetType2.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",MouseTargetType2[MouseTargetType2.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR",OverlayWidgetPositionPreference2=OverlayWidgetPositionPreference||(OverlayWidgetPositionPreference={}),OverlayWidgetPositionPreference2[OverlayWidgetPositionPreference2.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",OverlayWidgetPositionPreference2[OverlayWidgetPositionPreference2.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",OverlayWidgetPositionPreference2[OverlayWidgetPositionPreference2.TOP_CENTER=2]="TOP_CENTER",function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"}(OverviewRulerLane||(OverviewRulerLane={})),PositionAffinity2=PositionAffinity||(PositionAffinity={}),PositionAffinity2[PositionAffinity2.Left=0]="Left",PositionAffinity2[PositionAffinity2.Right=1]="Right",PositionAffinity2[PositionAffinity2.None=2]="None",RenderLineNumbersType2=RenderLineNumbersType||(RenderLineNumbersType={}),RenderLineNumbersType2[RenderLineNumbersType2.Off=0]="Off",RenderLineNumbersType2[RenderLineNumbersType2.On=1]="On",RenderLineNumbersType2[RenderLineNumbersType2.Relative=2]="Relative",RenderLineNumbersType2[RenderLineNumbersType2.Interval=3]="Interval",RenderLineNumbersType2[RenderLineNumbersType2.Custom=4]="Custom",RenderMinimap2=RenderMinimap||(RenderMinimap={}),RenderMinimap2[RenderMinimap2.None=0]="None",RenderMinimap2[RenderMinimap2.Text=1]="Text",RenderMinimap2[RenderMinimap2.Blocks=2]="Blocks",ScrollType2=ScrollType||(ScrollType={}),ScrollType2[ScrollType2.Smooth=0]="Smooth",ScrollType2[ScrollType2.Immediate=1]="Immediate",ScrollbarVisibility2=ScrollbarVisibility||(ScrollbarVisibility={}),ScrollbarVisibility2[ScrollbarVisibility2.Auto=1]="Auto",ScrollbarVisibility2[ScrollbarVisibility2.Hidden=2]="Hidden",ScrollbarVisibility2[ScrollbarVisibility2.Visible=3]="Visible",SelectionDirection2=SelectionDirection$1||(SelectionDirection$1={}),SelectionDirection2[SelectionDirection2.LTR=0]="LTR",SelectionDirection2[SelectionDirection2.RTL=1]="RTL",function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"}(SignatureHelpTriggerKind||(SignatureHelpTriggerKind={})),SymbolKind2=SymbolKind||(SymbolKind={}),SymbolKind2[SymbolKind2.File=0]="File",SymbolKind2[SymbolKind2.Module=1]="Module",SymbolKind2[SymbolKind2.Namespace=2]="Namespace",SymbolKind2[SymbolKind2.Package=3]="Package",SymbolKind2[SymbolKind2.Class=4]="Class",SymbolKind2[SymbolKind2.Method=5]="Method",SymbolKind2[SymbolKind2.Property=6]="Property",SymbolKind2[SymbolKind2.Field=7]="Field",SymbolKind2[SymbolKind2.Constructor=8]="Constructor",SymbolKind2[SymbolKind2.Enum=9]="Enum",SymbolKind2[SymbolKind2.Interface=10]="Interface",SymbolKind2[SymbolKind2.Function=11]="Function",SymbolKind2[SymbolKind2.Variable=12]="Variable",SymbolKind2[SymbolKind2.Constant=13]="Constant",SymbolKind2[SymbolKind2.String=14]="String",SymbolKind2[SymbolKind2.Number=15]="Number",SymbolKind2[SymbolKind2.Boolean=16]="Boolean",SymbolKind2[SymbolKind2.Array=17]="Array",SymbolKind2[SymbolKind2.Object=18]="Object",SymbolKind2[SymbolKind2.Key=19]="Key",SymbolKind2[SymbolKind2.Null=20]="Null",SymbolKind2[SymbolKind2.EnumMember=21]="EnumMember",SymbolKind2[SymbolKind2.Struct=22]="Struct",SymbolKind2[SymbolKind2.Event=23]="Event",SymbolKind2[SymbolKind2.Operator=24]="Operator",SymbolKind2[SymbolKind2.TypeParameter=25]="TypeParameter",SymbolTag2=SymbolTag||(SymbolTag={}),SymbolTag2[SymbolTag2.Deprecated=1]="Deprecated",TextEditorCursorBlinkingStyle2=TextEditorCursorBlinkingStyle||(TextEditorCursorBlinkingStyle={}),TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Hidden=0]="Hidden",TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Blink=1]="Blink",TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Smooth=2]="Smooth",TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Phase=3]="Phase",TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Expand=4]="Expand",TextEditorCursorBlinkingStyle2[TextEditorCursorBlinkingStyle2.Solid=5]="Solid",function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"}(TextEditorCursorStyle||(TextEditorCursorStyle={})),TrackedRangeStickiness2=TrackedRangeStickiness||(TrackedRangeStickiness={}),TrackedRangeStickiness2[TrackedRangeStickiness2.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",TrackedRangeStickiness2[TrackedRangeStickiness2.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",TrackedRangeStickiness2[TrackedRangeStickiness2.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",TrackedRangeStickiness2[TrackedRangeStickiness2.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter",WrappingIndent2=WrappingIndent||(WrappingIndent={}),WrappingIndent2[WrappingIndent2.None=0]="None",WrappingIndent2[WrappingIndent2.Same=1]="Same",WrappingIndent2[WrappingIndent2.Indent=2]="Indent",WrappingIndent2[WrappingIndent2.DeepIndent=3]="DeepIndent";class KeyMod$1{static chord(e,t){return KeyChord(e,t)}}function createMonacoBaseAPI(){return{editor:void 0,languages:void 0,CancellationTokenSource:CancellationTokenSource$1,Emitter:Emitter$1,KeyCode:KeyCode$1,KeyMod:KeyMod$1,Position:Position$1,Range:Range$2,Selection:Selection$1,SelectionDirection:SelectionDirection$1,MarkerSeverity:MarkerSeverity$1,MarkerTag:MarkerTag$1,Uri:URI,Token:Token$2}}KeyMod$1.CtrlCmd=2048,KeyMod$1.Shift=1024,KeyMod$1.Alt=512,KeyMod$1.WinCtrl=256;var standaloneTokens="";const INITIALIZE="$initialize";let webWorkerWarningLogged=!1;function logOnceWebWorkerWarning(e){isWeb&&(webWorkerWarningLogged||(webWorkerWarningLogged=!0))}class RequestMessage{constructor(e,t,i,n){this.vsWorker=e,this.req=t,this.method=i,this.args=n,this.type=0}}class ReplyMessage{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class SubscribeEventMessage{constructor(e,t,i,n){this.vsWorker=e,this.req=t,this.eventName=i,this.arg=n,this.type=2}}class EventMessage{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class UnsubscribeEventMessage{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class SimpleWorkerProtocol{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const i=String(++this._lastSentReq);return new Promise(((n,o)=>{this._pendingReplies[i]={resolve:n,reject:o},this._send(new RequestMessage(this._workerId,i,e,t))}))}listen(e,t){let i=null;const n=new Emitter$1({onFirstListenerAdd:()=>{i=String(++this._lastSentReq),this._pendingEmitters.set(i,n),this._send(new SubscribeEventMessage(this._workerId,i,e,t))},onLastListenerRemove:()=>{this._pendingEmitters.delete(i),this._send(new UnsubscribeEventMessage(this._workerId,i)),i=null}});return n.event}handleMessage(e){e&&e.vsWorker&&(-1!==this._workerId&&e.vsWorker!==this._workerId||this._handleMessage(e))}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq])return;let t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;return e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),void t.reject(i)}t.resolve(e.res)}_handleRequestMessage(e){let t=e.req;this._handler.handleMessage(e.method,e.args).then((e=>{this._send(new ReplyMessage(this._workerId,t,e,void 0))}),(e=>{e.detail instanceof Error&&(e.detail=transformErrorForSerialization(e.detail)),this._send(new ReplyMessage(this._workerId,t,void 0,transformErrorForSerialization(e)))}))}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.eventName,e.arg)((e=>{this._send(new EventMessage(this._workerId,t,e))}));this._pendingEvents.set(t,i)}_handleEventMessage(e){this._pendingEmitters.has(e.req)&&this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){this._pendingEvents.has(e.req)&&(this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req))}_send(e){let t=[];if(0===e.type)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else 1===e.type&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class SimpleWorkerClient extends Disposable{constructor(e,t,i){super();let n=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",(e=>{this._protocol.handleMessage(e)}),(e=>{n&&n(e)}))),this._protocol=new SimpleWorkerProtocol({sendMessage:(e,t)=>{this._worker.postMessage(e,t)},handleMessage:(e,t)=>{if("function"!=typeof i[e])return Promise.reject(new Error("Missing method "+e+" on main thread host."));try{return Promise.resolve(i[e].apply(i,t))}catch(e2){return Promise.reject(e2)}},handleEvent:(e,t)=>{if(propertyIsDynamicEvent(e)){const n=i[e].call(i,t);if("function"!=typeof n)throw new Error(`Missing dynamic event ${e} on main thread host.`);return n}if(propertyIsEvent(e)){const t=i[e];if("function"!=typeof t)throw new Error(`Missing event ${e} on main thread host.`);return t}throw new Error(`Malformed event name ${e}`)}}),this._protocol.setWorkerId(this._worker.getId());let o=null;void 0!==globals.require&&"function"==typeof globals.require.getConfig?o=globals.require.getConfig():void 0!==globals.requirejs&&(o=globals.requirejs.s.contexts._.config);const r=getAllMethodNames(i);this._onModuleLoaded=this._protocol.sendMessage(INITIALIZE,[this._worker.getId(),JSON.parse(JSON.stringify(o)),t,r]);const s=(e,t)=>this._request(e,t),a=(e,t)=>this._protocol.listen(e,t);this._lazyProxy=new Promise(((e,i)=>{n=i,this._onModuleLoaded.then((t=>{e(createProxyObject(t,s,a))}),(e=>{i(e),this._onError("Worker failed to load "+t,e)}))}))}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise(((i,n)=>{this._onModuleLoaded.then((()=>{this._protocol.sendMessage(e,t).then(i,n)}),n)}))}_onError(e,t){}}function propertyIsEvent(e){return"o"===e[0]&&"n"===e[1]&&isUpperAsciiLetter(e.charCodeAt(2))}function propertyIsDynamicEvent(e){return/^onDynamic/.test(e)&&isUpperAsciiLetter(e.charCodeAt(9))}function createProxyObject(e,t,i){const n=e=>function(){const i=Array.prototype.slice.call(arguments,0);return t(e,i)},o=e=>function(t){return i(e,t)};let r={};for(const s of e)propertyIsDynamicEvent(s)?r[s]=o(s):propertyIsEvent(s)?r[s]=i(s,void 0):r[s]=n(s);return r}var _a$2;const ttPolicy$1=null===(_a$2=window.trustedTypes)||void 0===_a$2?void 0:_a$2.createPolicy("defaultWorkerFactory",{createScriptURL:e=>e});function getWorker(e){if(globals.MonacoEnvironment){if("function"==typeof globals.MonacoEnvironment.getWorker)return globals.MonacoEnvironment.getWorker("workerMain.js",e);if("function"==typeof globals.MonacoEnvironment.getWorkerUrl){const t=globals.MonacoEnvironment.getWorkerUrl("workerMain.js",e);return new Worker(ttPolicy$1?ttPolicy$1.createScriptURL(t):t,{name:e})}}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function isPromiseLike(e){return"function"==typeof e.then}class WebWorker{constructor(e,t,i,n,o){this.id=t;const r=getWorker(i);isPromiseLike(r)?this.worker=r:this.worker=Promise.resolve(r),this.postMessage(e,[]),this.worker.then((e=>{e.onmessage=function(e){n(e.data)},e.onmessageerror=o,"function"==typeof e.addEventListener&&e.addEventListener("error",o)}))}getId(){return this.id}postMessage(e,t){this.worker&&this.worker.then((i=>i.postMessage(e,t)))}dispose(){this.worker&&this.worker.then((e=>e.terminate())),this.worker=null}}class DefaultWorkerFactory{constructor(e){this._label=e,this._webWorkerFailedBeforeError=!1}create(e,t,i){let n=++DefaultWorkerFactory.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new WebWorker(e,n,this._label||"anonymous"+n,t,(e=>{logOnceWebWorkerWarning(e),this._webWorkerFailedBeforeError=e,i(e)}))}}DefaultWorkerFactory.LAST_WORKER_ID=0;const MINIMUM_MATCHING_CHARACTER_LENGTH=3;function computeDiff(e,t,i,n){return new LcsDiff(e,t,i).ComputeDiff(n)}class LineSequence{constructor(e){const t=[],i=[];for(let n=0,o=e.length;n<o;n++)t[n]=getFirstNonBlankColumn(e[n],1),i[n]=getLastNonBlankColumn(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],o=[],r=[];let s=0;for(let a=t;a<=i;a++){const t=this.lines[a],i=e?this._startColumns[a]:1,l=e?this._endColumns[a]:t.length+1;for(let e=i;e<l;e++)n[s]=t.charCodeAt(e-1),o[s]=a+1,r[s]=e,s++}return new CharSequence(n,o,r)}}class CharSequence{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}getElements(){return this._charCodes}getStartLineNumber(e){return this._lineNumbers[e]}getStartColumn(e){return this._columns[e]}getEndLineNumber(e){return this._lineNumbers[e]}getEndColumn(e){return this._columns[e]+1}}class CharChange{constructor(e,t,i,n,o,r,s,a){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=o,this.modifiedStartColumn=r,this.modifiedEndLineNumber=s,this.modifiedEndColumn=a}static createFromDiffChange(e,t,i){let n,o,r,s,a,l,d,c;return 0===e.originalLength?(n=0,o=0,r=0,s=0):(n=t.getStartLineNumber(e.originalStart),o=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),s=t.getEndColumn(e.originalStart+e.originalLength-1)),0===e.modifiedLength?(a=0,l=0,d=0,c=0):(a=i.getStartLineNumber(e.modifiedStart),l=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),c=i.getEndColumn(e.modifiedStart+e.modifiedLength-1)),new CharChange(n,o,r,s,a,l,d,c)}}function postProcessCharChanges(e){if(e.length<=1)return e;const t=[e[0]];let i=t[0];for(let n=1,o=e.length;n<o;n++){const o=e[n],r=o.originalStart-(i.originalStart+i.originalLength),s=o.modifiedStart-(i.modifiedStart+i.modifiedLength);Math.min(r,s)<MINIMUM_MATCHING_CHARACTER_LENGTH?(i.originalLength=o.originalStart+o.originalLength-i.originalStart,i.modifiedLength=o.modifiedStart+o.modifiedLength-i.modifiedStart):(t.push(o),i=o)}return t}class LineChange{constructor(e,t,i,n,o){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=o}static createFromDiffResult(e,t,i,n,o,r,s){let a,l,d,c,h;if(0===t.originalLength?(a=i.getStartLineNumber(t.originalStart)-1,l=0):(a=i.getStartLineNumber(t.originalStart),l=i.getEndLineNumber(t.originalStart+t.originalLength-1)),0===t.modifiedLength?(d=n.getStartLineNumber(t.modifiedStart)-1,c=0):(d=n.getStartLineNumber(t.modifiedStart),c=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),r&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&o()){const r=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),a=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);let l=computeDiff(r,a,o,!0).changes;s&&(l=postProcessCharChanges(l)),h=[];for(let e=0,t=l.length;e<t;e++)h.push(CharChange.createFromDiffChange(l[e],r,a))}return new LineChange(a,l,d,c,h)}}class DiffComputer{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new LineSequence(e),this.modified=new LineSequence(t),this.continueLineDiff=createContinueProcessingPredicate(i.maxComputationTime),this.continueCharDiff=createContinueProcessingPredicate(0===i.maxComputationTime?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(1===this.original.lines.length&&0===this.original.lines[0].length)return 1===this.modified.lines.length&&0===this.modified.lines[0].length?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};if(1===this.modified.lines.length&&0===this.modified.lines[0].length)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:[{modifiedEndColumn:0,modifiedEndLineNumber:0,modifiedStartColumn:0,modifiedStartLineNumber:0,originalEndColumn:0,originalEndLineNumber:0,originalStartColumn:0,originalStartLineNumber:0}]}]};const e=computeDiff(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[i],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:e}}const n=[];let o=0,r=0;for(let s=-1,a=t.length;s<a;s++){const e=s+1<a?t[s+1]:null,i=e?e.originalStart:this.originalLines.length,l=e?e.modifiedStart:this.modifiedLines.length;for(;o<i&&r<l;){const e=this.originalLines[o],t=this.modifiedLines[r];if(e!==t){{let i=getFirstNonBlankColumn(e,1),s=getFirstNonBlankColumn(t,1);for(;i>1&&s>1;){if(e.charCodeAt(i-2)!==t.charCodeAt(s-2))break;i--,s--}(i>1||s>1)&&this._pushTrimWhitespaceCharChange(n,o+1,1,i,r+1,1,s)}{let i=getLastNonBlankColumn(e,1),s=getLastNonBlankColumn(t,1);const a=e.length+1,l=t.length+1;for(;i<a&&s<l;){if(e.charCodeAt(i-1)!==e.charCodeAt(s-1))break;i++,s++}(i<a||s<l)&&this._pushTrimWhitespaceCharChange(n,o+1,i,a,r+1,s,l)}}o++,r++}e&&(n.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace,e,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),o+=e.originalLength,r+=e.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,o,r,s){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,o,r,s))return;let a;this.shouldComputeCharChanges&&(a=[new CharChange(t,i,t,n,o,r,o,s)]),e.push(new LineChange(t,t,o,o,a))}_mergeTrimWhitespaceCharChange(e,t,i,n,o,r,s){const a=e.length;if(0===a)return!1;const l=e[a-1];return 0!==l.originalEndLineNumber&&0!==l.modifiedEndLineNumber&&(l.originalEndLineNumber+1===t&&l.modifiedEndLineNumber+1===o&&(l.originalEndLineNumber=t,l.modifiedEndLineNumber=o,this.shouldComputeCharChanges&&l.charChanges&&l.charChanges.push(new CharChange(t,i,t,n,o,r,o,s)),!0))}}function getFirstNonBlankColumn(e,t){const i=firstNonWhitespaceIndex(e);return-1===i?t:i+1}function getLastNonBlankColumn(e,t){const i=lastNonWhitespaceIndex(e);return-1===i?t:i+2}function createContinueProcessingPredicate(e){if(0===e)return()=>!0;const t=Date.now();return()=>Date.now()-t<e}class MirrorTextModel{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return null===this._cachedTextValue&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Position$1(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new PrefixSumComputer(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber!==e.endLineNumber)this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber);else{if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1))}}_acceptInsertText(e,t){if(0===t.length)return;const i=splitLines(t);if(1===i.length)return void this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let o=1;o<i.length;o++)this._lines.splice(e.lineNumber+o-1,0,i[o]),n[o-1]=i[o].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}class Uint8Matrix{constructor(e,t,i){const n=new Uint8Array(e*t);for(let o=0,r=e*t;o<r;o++)n[o]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class StateMachine{constructor(e){let t=0,i=0;for(let o=0,r=e.length;o<r;o++){const[n,r,s]=e[o];r>t&&(t=r),n>i&&(i=n),s>i&&(i=s)}t++,i++;const n=new Uint8Matrix(i,t,0);for(let o=0,r=e.length;o<r;o++){const[t,i,r]=e[o];n.set(t,i,r)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let _stateMachine=null;function getStateMachine(){return null===_stateMachine&&(_stateMachine=new StateMachine([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),_stateMachine}let _classifier=null;function getClassifier(){if(null===_classifier){_classifier=new CharacterClassifier(0);const e=" \t<>'\"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…";for(let i=0;i<e.length;i++)_classifier.set(e.charCodeAt(i),1);const t=".,;";for(let i=0;i<t.length;i++)_classifier.set(t.charCodeAt(i),2)}return _classifier}class LinkComputer{static _createLink(e,t,i,n,o){let r=o-1;do{const i=t.charCodeAt(r);if(2!==e.get(i))break;r--}while(r>n);if(n>0){const e=t.charCodeAt(n-1),i=t.charCodeAt(r);(40===e&&41===i||91===e&&93===i||123===e&&125===i)&&r--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:r+2},url:t.substring(n,r+1)}}static computeLinks(e,t=getStateMachine()){const i=getClassifier(),n=[];for(let o=1,r=e.getLineCount();o<=r;o++){const r=e.getLineContent(o),s=r.length;let a=0,l=0,d=0,c=1,h=!1,u=!1,g=!1,p=!1;for(;a<s;){let e=!1;const s=r.charCodeAt(a);if(13===c){let t;switch(s){case 40:h=!0,t=0;break;case 41:t=h?0:1;break;case 91:g=!0,u=!0,t=0;break;case 93:g=!1,t=u?0:1;break;case 123:p=!0,t=0;break;case 125:t=p?0:1;break;case 39:t=34===d||96===d?0:1;break;case 34:t=39===d||96===d?0:1;break;case 96:t=39===d||34===d?0:1;break;case 42:t=42===d?1:0;break;case 124:t=124===d?1:0;break;case 32:t=g?0:1;break;default:t=i.get(s)}1===t&&(n.push(LinkComputer._createLink(i,r,o,l,a)),e=!0)}else if(12===c){let t;91===s?(u=!0,t=0):t=i.get(s),1===t?e=!0:c=13}else c=t.nextState(c,s),0===c&&(e=!0);e&&(c=1,h=!1,u=!1,p=!1,l=a+1,d=s),a++}13===c&&n.push(LinkComputer._createLink(i,r,o,l,s))}return n}}function computeLinks(e){return e&&"function"==typeof e.getLineCount&&"function"==typeof e.getLineContent?LinkComputer.computeLinks(e):[]}class BasicInplaceReplace{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,o){if(e&&t){const i=this.doNavigateValueSet(t,o);if(i)return{range:e,value:i}}if(i&&n){const e=this.doNavigateValueSet(n,o);if(e)return{range:i,value:e}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return null!==i?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e),o=parseFloat(e);return isNaN(n)||isNaN(o)||n!==o?null:0!==n||t?(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let o=0,r=e.length;null===n&&o<r;o++)n=this.valueSetReplace(e[o],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}}BasicInplaceReplace.INSTANCE=new BasicInplaceReplace;var __awaiter$9=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class MirrorModel extends MirrorTextModel{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=getWordAtText(e.column,ensureValidWordDefinition(t),this._lines[e.lineNumber-1],0);return i?new Range$2(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,o="",r=0,s=[];return{*[Symbol.iterator](){for(;;)if(r<s.length){const e=o.substring(s[r].start,s[r].end);r+=1,yield e}else{if(!(n<t.length))break;o=t[n],s=i(o,e),r=0,n+=1}}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),o=[];for(const r of n)o.push({word:i.substring(r.start,r.end),startColumn:r.start+1,endColumn:r.end+1});return o}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&0!==n[0].length;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if((e=this._validateRange(e)).startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,o=[];o.push(this._lines[i].substring(e.startColumn-1));for(let r=i+1;r<n;r++)o.push(this._lines[r]);return o.push(this._lines[n].substring(0,e.endColumn-1)),o.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!Position$1.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const e=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>e&&(i=e,n=!0)}return n?{lineNumber:t,column:i}:e}}class EditorSimpleWorker{constructor(e,t){this._host=e,this._models=Object.create(null),this._foreignModuleFactory=t,this._foreignModule=null}dispose(){this._models=Object.create(null)}_getModel(e){return this._models[e]}_getModels(){const e=[];return Object.keys(this._models).forEach((t=>e.push(this._models[t]))),e}acceptNewModel(e){this._models[e.url]=new MirrorModel(URI.parse(e.url),e.lines,e.EOL,e.versionId)}acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}acceptRemovedModel(e){this._models[e]&&delete this._models[e]}computeUnicodeHighlights(e,t,i){return __awaiter$9(this,void 0,void 0,(function*(){const n=this._getModel(e);return n?UnicodeTextModelHighlighter.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}))}computeDiff(e,t,i,n){return __awaiter$9(this,void 0,void 0,(function*(){const o=this._getModel(e),r=this._getModel(t);if(!o||!r)return null;const s=o.getLinesContent(),a=r.getLinesContent(),l=new DiffComputer(s,a,{shouldComputeCharChanges:!0,shouldPostProcessCharChanges:!0,shouldIgnoreTrimWhitespace:i,shouldMakePrettyDiff:!0,maxComputationTime:n}).computeDiff(),d=!(l.changes.length>0)&&this._modelsAreIdentical(o,r);return{quitEarly:l.quitEarly,identical:d,changes:l.changes}}))}_modelsAreIdentical(e,t){const i=e.getLineCount();if(i!==t.getLineCount())return!1;for(let n=1;n<=i;n++){if(e.getLineContent(n)!==t.getLineContent(n))return!1}return!0}computeMoreMinimalEdits(e,t){return __awaiter$9(this,void 0,void 0,(function*(){const i=this._getModel(e);if(!i)return t;const n=[];let o;t=t.slice(0).sort(((e,t)=>{if(e.range&&t.range)return Range$2.compareRangesUsingStarts(e.range,t.range);return(e.range?0:1)-(t.range?0:1)}));for(let{range:e,text:r,eol:s}of t){if("number"==typeof s&&(o=s),Range$2.isEmpty(e)&&!r)continue;const t=i.getValueInRange(e);if(r=r.replace(/\r\n|\n|\r/g,i.eol),t===r)continue;if(Math.max(r.length,t.length)>EditorSimpleWorker._diffLimit){n.push({range:e,text:r});continue}const a=stringDiff(t,r,!1),l=i.offsetAt(Range$2.lift(e).getStartPosition());for(const e of a){const t=i.positionAt(l+e.originalStart),o=i.positionAt(l+e.originalStart+e.originalLength),s={text:r.substr(e.modifiedStart,e.modifiedLength),range:{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:o.lineNumber,endColumn:o.column}};i.getValueInRange(s.range)!==s.text&&n.push(s)}}return"number"==typeof o&&n.push({eol:o,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),n}))}computeLinks(e){return __awaiter$9(this,void 0,void 0,(function*(){const t=this._getModel(e);return t?computeLinks(t):null}))}textualSuggest(e,t,i,n){return __awaiter$9(this,void 0,void 0,(function*(){const o=new StopWatch(!0),r=new RegExp(i,n),s=new Set;e:for(let i of e){const e=this._getModel(i);if(e)for(let i of e.words(r))if(i!==t&&isNaN(Number(i))&&(s.add(i),s.size>EditorSimpleWorker._suggestionsLimit))break e}return{words:Array.from(s),duration:o.elapsed()}}))}computeWordRanges(e,t,i,n){return __awaiter$9(this,void 0,void 0,(function*(){const o=this._getModel(e);if(!o)return Object.create(null);const r=new RegExp(i,n),s=Object.create(null);for(let e=t.startLineNumber;e<t.endLineNumber;e++){const t=o.getLineWords(e,r);for(const i of t){if(!isNaN(Number(i.word)))continue;let t=s[i.word];t||(t=[],s[i.word]=t),t.push({startLineNumber:e,startColumn:i.startColumn,endLineNumber:e,endColumn:i.endColumn})}}return s}))}navigateValueSet(e,t,i,n,o){return __awaiter$9(this,void 0,void 0,(function*(){const r=this._getModel(e);if(!r)return null;const s=new RegExp(n,o);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const a=r.getValueInRange(t),l=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},s);if(!l)return null;const d=r.getValueInRange(l);return BasicInplaceReplace.INSTANCE.navigateValueSet(t,a,l,d,i)}))}loadForeignModule(e,t,i){const n={host:createProxyObject$1(i,((e,t)=>this._host.fhr(e,t))),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(n,t),Promise.resolve(getAllMethodNames(this._foreignModule))):Promise.reject(new Error("Unexpected usage"))}fmr(e,t){if(!this._foreignModule||"function"!=typeof this._foreignModule[e])return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(e2){return Promise.reject(e2)}}}EditorSimpleWorker._diffLimit=1e5,EditorSimpleWorker._suggestionsLimit=1e4,"function"==typeof importScripts&&(globals.monaco=createMonacoBaseAPI());var __decorate$i=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$h=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$8=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const STOP_SYNC_MODEL_DELTA_TIME_MS=6e4,STOP_WORKER_DELTA_TIME_MS=3e5;function canSyncModel(e,t){const i=e.getModel(t);return!!i&&!i.isTooLargeForSyncing()}let EditorWorkerService=class extends Disposable{constructor(e,t,i,n,o){super(),this._modelService=e,this._workerManager=this._register(new WorkerManager(this._modelService,n)),this._logService=i,this._register(o.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:(e,t)=>canSyncModel(this._modelService,e.uri)?this._workerManager.withWorker().then((t=>t.computeLinks(e.uri))).then((e=>e&&{links:e})):Promise.resolve({links:[]})})),this._register(o.completionProvider.register("*",new WordBasedCompletionItemProvider(this._workerManager,t,this._modelService,n)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return canSyncModel(this._modelService,e)}computedUnicodeHighlights(e,t,i){return this._workerManager.withWorker().then((n=>n.computedUnicodeHighlights(e,t,i)))}computeDiff(e,t,i,n){return this._workerManager.withWorker().then((o=>o.computeDiff(e,t,i,n)))}computeMoreMinimalEdits(e,t){if(isNonEmptyArray(t)){if(!canSyncModel(this._modelService,e))return Promise.resolve(t);const i=StopWatch.create(!0),n=this._workerManager.withWorker().then((i=>i.computeMoreMinimalEdits(e,t)));return n.finally((()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),i.elapsed()))),Promise.race([n,timeout(1e3).then((()=>t))])}return Promise.resolve(void 0)}canNavigateValueSet(e){return canSyncModel(this._modelService,e)}navigateValueSet(e,t,i){return this._workerManager.withWorker().then((n=>n.navigateValueSet(e,t,i)))}canComputeWordRanges(e){return canSyncModel(this._modelService,e)}computeWordRanges(e,t){return this._workerManager.withWorker().then((i=>i.computeWordRanges(e,t)))}};EditorWorkerService=__decorate$i([__param$h(0,IModelService),__param$h(1,ITextResourceConfigurationService),__param$h(2,ILogService),__param$h(3,ILanguageConfigurationService),__param$h(4,ILanguageFeaturesService)],EditorWorkerService);class WordBasedCompletionItemProvider{constructor(e,t,i,n){this.languageConfigurationService=n,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}provideCompletionItems(e,t){return __awaiter$8(this,void 0,void 0,(function*(){const i=this._configurationService.getValue(e.uri,t,"editor");if(!i.wordBasedSuggestions)return;const n=[];if("currentDocument"===i.wordBasedSuggestionsMode)canSyncModel(this._modelService,e.uri)&&n.push(e.uri);else for(const t of this._modelService.getModels())canSyncModel(this._modelService,t.uri)&&(t===e?n.unshift(t.uri):"allDocuments"!==i.wordBasedSuggestionsMode&&t.getLanguageId()!==e.getLanguageId()||n.push(t.uri));if(0===n.length)return;const o=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),r=e.getWordAtPosition(t),s=r?new Range$2(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):Range$2.fromPositions(t),a=s.setEndPosition(t.lineNumber,t.column),l=yield this._workerManager.withWorker(),d=yield l.textualSuggest(n,null==r?void 0:r.word,o);return d?{duration:d.duration,suggestions:d.words.map((e=>({kind:18,label:e,insertText:e,range:{insert:a,replace:s}})))}:void 0}))}}class WorkerManager extends Disposable{constructor(e,t){super(),this.languageConfigurationService=t,this._modelService=e,this._editorWorkerClient=null,this._lastWorkerUsedTime=(new Date).getTime();this._register(new IntervalTimer).cancelAndSet((()=>this._checkStopIdleWorker()),Math.round(STOP_WORKER_DELTA_TIME_MS/2)),this._register(this._modelService.onModelRemoved((e=>this._checkStopEmptyWorker())))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;0===this._modelService.getModels().length&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;(new Date).getTime()-this._lastWorkerUsedTime>STOP_WORKER_DELTA_TIME_MS&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=(new Date).getTime(),this._editorWorkerClient||(this._editorWorkerClient=new EditorWorkerClient(this._modelService,!1,"editorWorkerService",this.languageConfigurationService)),Promise.resolve(this._editorWorkerClient)}}class EditorModelManager extends Disposable{constructor(e,t,i){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const e=new IntervalTimer;e.cancelAndSet((()=>this._checkStopModelSync()),Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS/2)),this._register(e)}}dispose(){for(let e in this._syncedModels)dispose(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t){for(const i of e){const e=i.toString();this._syncedModels[e]||this._beginModelSync(i,t),this._syncedModels[e]&&(this._syncedModelsLastUsedTime[e]=(new Date).getTime())}}_checkStopModelSync(){const e=(new Date).getTime(),t=[];for(let i in this._syncedModelsLastUsedTime){e-this._syncedModelsLastUsedTime[i]>STOP_SYNC_MODEL_DELTA_TIME_MS&&t.push(i)}for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i)return;if(!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const o=new DisposableStore;o.add(i.onDidChangeContent((e=>{this._proxy.acceptModelChanged(n.toString(),e)}))),o.add(i.onWillDispose((()=>{this._stopModelSync(n)}))),o.add(toDisposable((()=>{this._proxy.acceptRemovedModel(n)}))),this._syncedModels[n]=o}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],dispose(t)}}class SynchronousWorkerClient{constructor(e){this._instance=e,this._proxyObj=Promise.resolve(this._instance)}dispose(){this._instance.dispose()}getProxyObject(){return this._proxyObj}}class EditorWorkerHost{constructor(e){this._workerClient=e}fhr(e,t){return this._workerClient.fhr(e,t)}}class EditorWorkerClient extends Disposable{constructor(e,t,i,n){super(),this.languageConfigurationService=n,this._disposed=!1,this._modelService=e,this._keepIdleModels=t,this._workerFactory=new DefaultWorkerFactory(i),this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(new SimpleWorkerClient(this._workerFactory,"vs/editor/common/services/editorSimpleWorker",new EditorWorkerHost(this)))}catch(e){logOnceWebWorkerWarning(e),this._worker=new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this),null))}return this._worker}_getProxy(){return this._getOrCreateWorker().getProxyObject().then(void 0,(e=>(logOnceWebWorkerWarning(e),this._worker=new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this),null)),this._getOrCreateWorker().getProxyObject())))}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new EditorModelManager(e,this._modelService,this._keepIdleModels))),this._modelManager}_withSyncedResources(e,t=!1){return __awaiter$8(this,void 0,void 0,(function*(){return this._disposed?Promise.reject(canceled()):this._getProxy().then((i=>(this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i)))}))}computedUnicodeHighlights(e,t,i){return this._withSyncedResources([e]).then((n=>n.computeUnicodeHighlights(e.toString(),t,i)))}computeDiff(e,t,i,n){return this._withSyncedResources([e,t],!0).then((o=>o.computeDiff(e.toString(),t.toString(),i,n)))}computeMoreMinimalEdits(e,t){return this._withSyncedResources([e]).then((i=>i.computeMoreMinimalEdits(e.toString(),t)))}computeLinks(e){return this._withSyncedResources([e]).then((t=>t.computeLinks(e.toString())))}textualSuggest(e,t,i){return __awaiter$8(this,void 0,void 0,(function*(){const n=yield this._withSyncedResources(e),o=i.source,r=regExpFlags(i);return n.textualSuggest(e.map((e=>e.toString())),t,o,r)}))}computeWordRanges(e,t){return this._withSyncedResources([e]).then((i=>{const n=this._modelService.getModel(e);if(!n)return Promise.resolve(null);const o=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),r=o.source,s=regExpFlags(o);return i.computeWordRanges(e.toString(),t,r,s)}))}navigateValueSet(e,t,i){return this._withSyncedResources([e]).then((n=>{const o=this._modelService.getModel(e);if(!o)return null;const r=this.languageConfigurationService.getLanguageConfiguration(o.getLanguageId()).getWordDefinition(),s=r.source,a=regExpFlags(r);return n.navigateValueSet(e.toString(),t,i,s,a)}))}dispose(){super.dispose(),this._disposed=!0}}function createWebWorker$1(e,t,i){return new MonacoWebWorkerImpl(e,t,i)}class MonacoWebWorkerImpl extends EditorWorkerClient{constructor(e,t,i){super(e,i.keepIdleModels||!1,i.label,t),this._foreignModuleId=i.moduleId,this._foreignModuleCreateData=i.createData||null,this._foreignModuleHost=i.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||"function"!=typeof this._foreignModuleHost[e])return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(e2){return Promise.reject(e2)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then((e=>{const t=this._foreignModuleHost?getAllMethodNames(this._foreignModuleHost):[];return e.loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then((t=>{this._foreignModuleCreateData=null;const i=(t,i)=>e.fmr(t,i),n=(e,t)=>function(){const i=Array.prototype.slice.call(arguments,0);return t(e,i)},o={};for(const e of t)o[e]=n(e,i);return o}))}))),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this._withSyncedResources(e).then((e=>this.getProxy()))}}function isFuzzyActionArr(e){return Array.isArray(e)}function isFuzzyAction(e){return!isFuzzyActionArr(e)}function isString(e){return"string"==typeof e}function isIAction(e){return!isString(e)}function empty(e){return!e}function fixCase(e,t){return e.ignoreCase&&t?t.toLowerCase():t}function sanitize(e){return e.replace(/[&<>'"_]/g,"-")}function log(e,t){}function createError(e,t){return new Error(`${e.languageId}: ${t}`)}function substituteMatches(e,t,i,n,o){let r=null;return t.replace(/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g,(function(t,s,a,l,d,c,h,u,g){return empty(a)?empty(l)?!empty(d)&&d<n.length?fixCase(e,n[d]):!empty(h)&&e&&"string"==typeof e[h]?e[h]:(null===r&&(r=o.split("."),r.unshift(o)),!empty(c)&&c<r.length?fixCase(e,r[c]):""):fixCase(e,i):"$"}))}function findRules(e,t){let i=t;for(;i&&i.length>0;){const t=e.tokenizer[i];if(t)return t;const n=i.lastIndexOf(".");i=n<0?null:i.substr(0,n)}return null}function stateExists(e,t){let i=t;for(;i&&i.length>0;){if(e.stateNames[i])return!0;const t=i.lastIndexOf(".");i=t<0?null:i.substr(0,t)}return!1}const CACHE_STACK_DEPTH=5;class MonarchStackElementFactory{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==e&&e.depth>=this._maxCacheDepth)return new MonarchStackElement(e,t);let i=MonarchStackElement.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new MonarchStackElement(e,t),this._entries[i]=n,n)}}MonarchStackElementFactory._INSTANCE=new MonarchStackElementFactory(CACHE_STACK_DEPTH);class MonarchStackElement{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;null!==e;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;null!==e&&null!==t;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return null===e&&null===t}equals(e){return MonarchStackElement._equals(this,e)}push(e){return MonarchStackElementFactory.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return MonarchStackElementFactory.create(this.parent,e)}}class EmbeddedLanguageData{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new EmbeddedLanguageData(this.languageId,this.state)}}class MonarchLineStateFactory{constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}static create(e,t){return this._INSTANCE.create(e,t)}create(e,t){if(null!==t)return new MonarchLineState(e,t);if(null!==e&&e.depth>=this._maxCacheDepth)return new MonarchLineState(e,t);const i=MonarchStackElement.getStackElementId(e);let n=this._entries[i];return n||(n=new MonarchLineState(e,null),this._entries[i]=n,n)}}MonarchLineStateFactory._INSTANCE=new MonarchLineStateFactory(CACHE_STACK_DEPTH);class MonarchLineState{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:MonarchLineStateFactory.create(this.stack,this.embeddedLanguageData)}equals(e){return e instanceof MonarchLineState&&(!!this.stack.equals(e.stack)&&(null===this.embeddedLanguageData&&null===e.embeddedLanguageData||null!==this.embeddedLanguageData&&null!==e.embeddedLanguageData&&this.embeddedLanguageData.equals(e.embeddedLanguageData)))}}class MonarchClassicTokensCollector{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new Token$2(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,s=TokenizationRegistry.get(o);if(!s)return this.enterLanguage(o),this.emit(n,""),r;const a=s.tokenize(e,t,r);if(0!==n)for(const l of a.tokens)this._tokens.push(new Token$2(l.offset+n,l.type,l.language));else this._tokens=this._tokens.concat(a.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,a.endState}finalize(e){return new TokenizationResult(this._tokens,e)}}class MonarchModernTokensCollector{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t);this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=null!==e?e.length:0,o=t.length,r=null!==i?i.length:0;if(0===n&&0===o&&0===r)return new Uint32Array(0);if(0===n&&0===o)return i;if(0===o&&0===r)return e;const s=new Uint32Array(n+o+r);null!==e&&s.set(e);for(let a=0;a<o;a++)s[n+a]=t[a];return null!==i&&s.set(i,n+o),s}nestedLanguageTokenize(e,t,i,n){const o=i.languageId,r=i.state,s=TokenizationRegistry.get(o);if(!s)return this.enterLanguage(o),this.emit(n,""),r;const a=s.tokenizeEncoded(e,t,r);if(0!==n)for(let l=0,d=a.tokens.length;l<d;l+=2)a.tokens[l]+=n;return this._prependTokens=MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,a.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,a.endState}finalize(e){return new EncodedTokenizationResult(MonarchModernTokensCollector._merge(this._prependTokens,this._tokens,null),e)}}class MonarchTokenizer{constructor(e,t,i,n){this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let o=!1;this._tokenizationRegistryListener=TokenizationRegistry.onDidChange((e=>{if(o)return;let t=!1;for(let i=0,n=e.changedLanguages.length;i<n;i++){const n=e.changedLanguages[i];if(this._embeddedLanguages[n]){t=!0;break}}t&&(o=!0,TokenizationRegistry.fire([this._languageId]),o=!1)}))}dispose(){this._tokenizationRegistryListener.dispose()}getLoadStatus(){const e=[];for(let t in this._embeddedLanguages){const i=TokenizationRegistry.get(t);if(i){if(i instanceof MonarchTokenizer){const t=i.getLoadStatus();!1===t.loaded&&e.push(t.promise)}}else TokenizationRegistry.isResolved(t)||e.push(TokenizationRegistry.getOrCreate(t))}return 0===e.length?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then((e=>{}))}}getInitialState(){const e=MonarchStackElementFactory.create(null,this._lexer.start);return MonarchLineStateFactory.create(e,null)}tokenize(e,t,i){const n=new MonarchClassicTokensCollector,o=this._tokenize(e,t,i,n);return n.finalize(o)}tokenizeEncoded(e,t,i){const n=new MonarchModernTokensCollector(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),o=this._tokenize(e,t,i,n);return n.finalize(o)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=findRules(this._lexer,t.stack.state),!i))throw createError(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,o=!1;for(const r of i){if(!isIAction(r.action)||"@pop"!==r.action.nextEmbedded)continue;o=!0;let t=r.regex;const i=r.regex.source;if("^(?:"===i.substr(0,4)&&")"===i.substr(i.length-1,1)){const e=(t.ignoreCase?"i":"")+(t.unicode?"u":"");t=new RegExp(i.substr(4,i.length-5),e)}const s=e.search(t);-1===s||0!==s&&r.matchOnlyAtLineStart||(-1===n||s<n)&&(n=s)}if(!o)throw createError(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,o){const r=this._findLeavingNestedLanguageOffset(e,i);if(-1===r){const r=o.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return MonarchLineStateFactory.create(i.stack,new EmbeddedLanguageData(i.embeddedLanguageData.languageId,r))}const s=e.substring(0,r);s.length>0&&o.nestedLanguageTokenize(s,!1,i.embeddedLanguageData,n);const a=e.substring(r);return this._myTokenize(a,t,i,n+r,o)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,o){o.enterLanguage(this._languageId);const r=e.length,s=t&&this._lexer.includeLF?e+"\n":e,a=s.length;let l=i.embeddedLanguageData,d=i.stack,c=0,h=null,u=!0;for(;u||c<a;){const i=c,g=d.depth,p=h?h.groups.length:0,m=d.state;let f=null,_=null,C=null,v=null,b=null;if(h){f=h.matches;const e=h.groups.shift();_=e.matched,C=e.action,v=h.rule,0===h.groups.length&&(h=null)}else{if(!u&&c>=a)break;u=!1;let e=this._lexer.tokenizer[m];if(!e&&(e=findRules(this._lexer,m),!e))throw createError(this._lexer,"tokenizer state is not defined: "+m);let t=s.substr(c);for(const i of e)if((0===c||!i.matchOnlyAtLineStart)&&(f=t.match(i.regex),f)){_=f[0],C=i.action;break}}if(f||(f=[""],_=""),C||(c<a&&(f=[s.charAt(c)],_=f[0]),C=this._lexer.defaultToken),null===_)break;for(c+=_.length;isFuzzyAction(C)&&isIAction(C)&&C.test;)C=C.test(_,f,m,c===a);let S=null;if("string"==typeof C||Array.isArray(C))S=C;else if(C.group)S=C.group;else if(null!==C.token&&void 0!==C.token){if(S=C.tokenSubst?substituteMatches(this._lexer,C.token,_,f,m):C.token,C.nextEmbedded)if("@pop"===C.nextEmbedded){if(!l)throw createError(this._lexer,"cannot pop embedded language if not inside one");l=null}else{if(l)throw createError(this._lexer,"cannot enter embedded language from within an embedded language");b=substituteMatches(this._lexer,C.nextEmbedded,_,f,m)}if(C.goBack&&(c=Math.max(0,c-C.goBack)),C.switchTo&&"string"==typeof C.switchTo){let e=substituteMatches(this._lexer,C.switchTo,_,f,m);if("@"===e[0]&&(e=e.substr(1)),!findRules(this._lexer,e))throw createError(this._lexer,"trying to switch to a state '"+e+"' that is undefined in rule: "+this._safeRuleName(v));d=d.switchTo(e)}else{if(C.transform&&"function"==typeof C.transform)throw createError(this._lexer,"action.transform not supported");if(C.next)if("@push"===C.next){if(d.depth>=this._lexer.maxStack)throw createError(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(m)}else if("@pop"===C.next){if(d.depth<=1)throw createError(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(v));d=d.pop()}else if("@popall"===C.next)d=d.popall();else{let e=substituteMatches(this._lexer,C.next,_,f,m);if("@"===e[0]&&(e=e.substr(1)),!findRules(this._lexer,e))throw createError(this._lexer,"trying to set a next state '"+e+"' that is undefined in rule: "+this._safeRuleName(v));d=d.push(e)}}C.log&&"string"==typeof C.log&&log(this._lexer,this._lexer.languageId+": "+substituteMatches(this._lexer,C.log,_,f,m))}if(null===S)throw createError(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(v));const y=i=>{const r=this._languageService.getLanguageIdByLanguageName(i)||this._languageService.getLanguageIdByMimeType(i)||i,s=this._getNestedEmbeddedLanguageData(r);if(c<a){const i=e.substr(c);return this._nestedTokenize(i,t,MonarchLineStateFactory.create(d,s),n+c,o)}return MonarchLineStateFactory.create(d,s)};if(Array.isArray(S)){if(h&&h.groups.length>0)throw createError(this._lexer,"groups cannot be nested: "+this._safeRuleName(v));if(f.length!==S.length+1)throw createError(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(v));let e=0;for(let t=1;t<f.length;t++)e+=f[t].length;if(e!==_.length)throw createError(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(v));h={rule:v,matches:f,groups:[]};for(let t=0;t<S.length;t++)h.groups[t]={action:S[t],matched:f[t+1]};c-=_.length}else{{if("@rematch"===S&&(c-=_.length,_="",f=null,S="",null!==b))return y(b);if(0===_.length){if(0===a||g!==d.depth||m!==d.state||(h?h.groups.length:0)!==p)continue;throw createError(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(v))}let e=null;if(isString(S)&&0===S.indexOf("@brackets")){const t=S.substr("@brackets".length),i=findBracket(this._lexer,_);if(!i)throw createError(this._lexer,"@brackets token returned but no bracket defined as: "+_);e=sanitize(i.token+t)}else{e=sanitize(""===S?"":S+this._lexer.tokenPostfix)}i<r&&o.emit(i+n,e)}if(null!==b)return y(b)}}return MonarchLineStateFactory.create(d,l)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new EmbeddedLanguageData(e,NullState);e!==this._languageId&&(TokenizationRegistry.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=TokenizationRegistry.get(e);return new EmbeddedLanguageData(e,t?t.getInitialState():NullState)}}function findBracket(e,t){if(!t)return null;t=fixCase(e,t);const i=e.brackets;for(const n of i){if(n.open===t)return{token:n.token,bracketType:1};if(n.close===t)return{token:n.token,bracketType:-1}}return null}var __awaiter$7=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},_a$1;const ttPolicy=null===(_a$1=window.trustedTypes)||void 0===_a$1?void 0:_a$1.createPolicy("standaloneColorizer",{createHTML:e=>e});class Colorizer{static colorizeElement(e,t,i,n){const o=(n=n||{}).theme||"vs",r=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!r)return Promise.resolve();const s=t.getLanguageIdByMimeType(r)||r;e.setTheme(o);const a=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+o;return this.colorize(t,a||"",s,n).then((e=>{var t;const n=null!==(t=null==ttPolicy?void 0:ttPolicy.createHTML(e))&&void 0!==t?t:e;i.innerHTML=n}),(e=>{}))}static colorize(e,t,i,n){return __awaiter$7(this,void 0,void 0,(function*(){const o=e.languageIdCodec;let r=4;n&&"number"==typeof n.tabSize&&(r=n.tabSize),startsWithUTF8BOM(t)&&(t=t.substr(1));const s=splitLines(t);if(!e.isRegisteredLanguageId(i))return _fakeColorize(s,r,o);const a=yield TokenizationRegistry.getOrCreate(i);return a?_colorize(s,r,a,o):_fakeColorize(s,r,o)}))}static colorizeLine(e,t,i,n,o=4){const r=ViewLineRenderingData.isBasicASCII(e,t),s=ViewLineRenderingData.containsRTL(e,r,i);return renderViewLine2(new RenderLineInput(!1,!0,e,!1,r,s,0,n,[],o,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.forceTokenization(t);const o=e.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),o,i)}}function _colorize(e,t,i,n){return new Promise(((o,r)=>{const s=()=>{const a=_actualColorize(e,t,i,n);if(i instanceof MonarchTokenizer){const e=i.getLoadStatus();if(!1===e.loaded)return void e.promise.then(s,r)}o(a)};s()}))}function _fakeColorize(e,t,i){let n=[];const o=new Uint32Array(2);o[0]=0,o[1]=16793600;for(let r=0,s=e.length;r<s;r++){const s=e[r];o[0]=s.length;const a=new LineTokens(o,s,i),l=ViewLineRenderingData.isBasicASCII(s,!0),d=ViewLineRenderingData.containsRTL(s,l,!0),c=renderViewLine2(new RenderLineInput(!1,!0,s,!1,l,d,0,a,[],t,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(c.html),n.push("<br/>")}return n.join("")}function _actualColorize(e,t,i,n){let o=[],r=i.getInitialState();for(let s=0,a=e.length;s<a;s++){const a=e[s],l=i.tokenizeEncoded(a,!0,r);LineTokens.convertToEndOffset(l.tokens,a.length);const d=new LineTokens(l.tokens,a,n),c=ViewLineRenderingData.isBasicASCII(a,!0),h=ViewLineRenderingData.containsRTL(a,c,!0),u=renderViewLine2(new RenderLineInput(!1,!0,a,!1,c,h,0,d.inflate(),[],t,0,0,0,0,-1,"none",!1,!1,null));o=o.concat(u.html),o.push("<br/>"),r=l.endState}return o.join("")}var __decorate$h=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$g=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let AbstractCodeEditorService=class extends Disposable{constructor(e){super(),this._themeService=e,this._onCodeEditorAdd=this._register(new Emitter$1),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new Emitter$1),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onDiffEditorAdd=this._register(new Emitter$1),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new Emitter$1),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map((e=>this._codeEditors[e]))}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}removeDiffEditor(e){delete this._diffEditors[e.getId()]&&this._onDiffEditorRemove.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map((e=>this._diffEditors[e]))}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach((t=>t.removeDecorations(e)))))}setModelProperty(e,t,i){const n=e.toString();let o;this._modelProperties.has(n)?o=this._modelProperties.get(n):(o=new Map,this._modelProperties.set(n,o)),o.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i)){return this._modelProperties.get(i).get(t)}}};AbstractCodeEditorService=__decorate$h([__param$g(0,IThemeService)],AbstractCodeEditorService);var __decorate$g=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$f=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let StandaloneCodeEditorService=class extends AbstractCodeEditorService{constructor(e,t){super(t),this.onCodeEditorAdd((()=>this._checkContextKey())),this.onCodeEditorRemove((()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}openCodeEditor(e,t,i){return t?Promise.resolve(this.doOpenEditor(t,e)):Promise.resolve(null)}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const i=t.resource.scheme;if(i===Schemas.http||i===Schemas.https)return windowOpenNoOpener(t.resource.toString()),e}return null}const i=t.options?t.options.selection:null;if(i)if("number"==typeof i.endLineNumber&&"number"==typeof i.endColumn)e.setSelection(i),e.revealRangeInCenter(i,1);else{const t={lineNumber:i.startLineNumber,column:i.startColumn};e.setPosition(t),e.revealPositionInCenter(t,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};StandaloneCodeEditorService=__decorate$g([__param$f(0,IContextKeyService),__param$f(1,IThemeService)],StandaloneCodeEditorService),registerSingleton(ICodeEditorService,StandaloneCodeEditorService);const ILayoutService=createDecorator("layoutService");var __decorate$f=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$e=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let StandaloneLayoutService=class{constructor(e){this._codeEditorService=e,this.onDidLayout=Event$1.None}get dimension(){return this._dimension||(this._dimension=getClientArea(window.document.body)),this._dimension}get hasContainer(){return!1}get container(){throw new Error("ILayoutService.container is not available in the standalone editor!")}focus(){var e;null===(e=this._codeEditorService.getFocusedCodeEditor())||void 0===e||e.focus()}};StandaloneLayoutService=__decorate$f([__param$e(0,ICodeEditorService)],StandaloneLayoutService);let EditorScopedLayoutService=class extends StandaloneLayoutService{constructor(e,t){super(t),this._container=e}get hasContainer(){return!1}get container(){return this._container}};EditorScopedLayoutService=__decorate$f([__param$e(1,ICodeEditorService)],EditorScopedLayoutService),registerSingleton(ILayoutService,StandaloneLayoutService);var __decorate$e=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$d=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$6=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function getResourceLabel(e){return e.scheme===Schemas.file?e.fsPath:e.path}let stackElementCounter=0;class ResourceStackElement{constructor(e,t,i,n,o,r,s){this.id=++stackElementCounter,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=s,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceReasonPair{constructor(e,t){this.resourceLabel=e,this.reason=t}}class RemovedResources{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements){(0===n.reason?e:t).push(n.resourceLabel)}let i=[];return e.length>0&&i.push(localize({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(localize({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join("\n")}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class WorkspaceStackElement{constructor(e,t,i,n,o,r,s){this.id=++stackElementCounter,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=o,this.sourceId=r,this.sourceOrder=s,this.removedResources=null,this.invalidatedResources=null}canSplit(){return"function"==typeof this.actual.split}removeResource(e,t,i){this.removedResources||(this.removedResources=new RemovedResources),this.removedResources.has(t)||this.removedResources.set(t,new ResourceReasonPair(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),0===this.invalidatedResources.size&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new RemovedResources),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new ResourceReasonPair(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class ResourceEditStack{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)1===e.type&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)1===e.type&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){let e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join("\n")}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){1===e.type?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)1===t.type&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new ResourceEditStackSnapshot(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,o=-1;for(let s=0,a=this._past.length;s<a;s++,n++){const r=this._past[s];i&&(n>=t||r.id!==e.elements[n])&&(i=!1,o=0),i||1!==r.type||r.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let s=this._future.length-1;s>=0;s--,n++){const o=this._future[s];i&&(n>=t||o.id!==e.elements[n])&&(i=!1,r=s),i||1!==o.type||o.removeResource(this.resourceLabel,this.strResource,0)}-1!==o&&(this._past=this._past.slice(0,o)),-1!==r&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return 0===this._past.length?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return 0===this._future.length?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class EditStackSnapshot{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const missingEditStack=new ResourceEditStack("","");missingEditStack.locked=!0;let UndoRedoService=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){let t=[];for(const i of this._editStacks)t.push(i[1].toString())}pushElement(e,t=UndoRedoGroup.None,i=UndoRedoSource.None){if(0===e.type){const n=getResourceLabel(e.resource),o=this.getUriComparisonKey(e.resource);this._pushElement(new ResourceStackElement(e,n,o,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,o=[],r=[];for(const t of e.resources){const e=getResourceLabel(t),i=this.getUriComparisonKey(t);n.has(i)||(n.add(i),o.push(e),r.push(i))}1===o.length?this._pushElement(new ResourceStackElement(e,o[0],r[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new WorkspaceStackElement(e,o,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const i=e.resourceLabels[t],n=e.strResources[t];let o;this._editStacks.has(n)?o=this._editStacks.get(n):(o=new ResourceEditStack(i,n),this._editStacks.set(n,o)),o.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const e=this._editStacks.get(t);if(e.hasFutureElements())return null;const i=e.getClosestPastElement();return i?i.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const e=getResourceLabel(o.resource),t=this.getUriComparisonKey(o.resource),i=new ResourceStackElement(o,e,t,0,0,0,0);n.set(i.strResource,i)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const o of i){const e=getResourceLabel(o.resource),t=this.getUriComparisonKey(o.resource),i=new ResourceStackElement(o,e,t,0,0,0,0);n.set(i.strResource,i)}for(const o of e.strResources){if(t&&t.has(o))continue;this._editStacks.get(o).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t="string"==typeof e?e:this.getUriComparisonKey(e);if(this._editStacks.has(t)){this._editStacks.get(t).dispose(),this._editStacks.delete(t)}}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);if(this._editStacks.has(n)){this._editStacks.get(n).setElementsValidFlag(t,i)}}createSnapshot(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).createSnapshot(e)}return new ResourceEditStackSnapshot(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),i.hasPastElements()||i.hasFutureElements()||(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).getElements()}return{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&(r.sourceId===e&&(!t||r.sourceOrder>t.sourceOrder)&&(t=r,i=n))}return[t,i]}canUndo(e){if(e instanceof UndoRedoSource){const[,t]=this._findClosestUndoElementWithSource(e.id);return!!t}const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).hasPastElements()}return!1}_onError(e,t){onUnexpectedError(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,o){const r=this._acquireLocks(i);let s;try{s=t()}catch(a){return r(),n.dispose(),this._onError(a,e)}return s?s.then((()=>(r(),n.dispose(),o())),(t=>(r(),n.dispose(),this._onError(t,e)))):(r(),n.dispose(),o())}_invokeWorkspacePrepare(e){return __awaiter$6(this,void 0,void 0,(function*(){if(void 0===e.actual.prepareUndoRedo)return Disposable.None;const t=e.actual.prepareUndoRedo();return void 0===t?Disposable.None:t}))}_invokeResourcePrepare(e,t){if(1!==e.actual.type||void 0===e.actual.prepareUndoRedo)return t(Disposable.None);const i=e.actual.prepareUndoRedo();return i?isDisposable(i)?t(i):i.then((e=>t(e))):t(Disposable.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||missingEditStack);return new EditStackSnapshot(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new WorkspaceVerificationError(this._undo(e,0,!0));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new WorkspaceVerificationError}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,localize({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const s of i.editStacks)s.getClosestPastElement()!==t&&o.push(s.resourceLabel);if(o.length>0)return this._tryToSplitAndUndo(e,t,null,localize({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const s of i.editStacks)s.locked&&r.push(s.resourceLabel);return r.length>0?this._tryToSplitAndUndo(e,t,null,localize({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,localize({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),o=this._checkWorkspaceUndo(e,t,n,!1);return o?o.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const i=t.getSecondClosestPastElement();if(i&&i.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}_confirmAndExecuteWorkspaceUndo(e,t,i,n){return __awaiter$6(this,void 0,void 0,(function*(){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){const o=yield this._dialogService.show(Severity$2.Info,localize("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),[localize({key:"ok",comment:["{0} denotes a number that is > 1"]},"Undo in {0} Files",i.editStacks.length),localize("nok","Undo this File"),localize("cancel","Cancel")],{cancelId:2});if(2===o.choice)return;if(1===o.choice)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const r=this._checkWorkspaceUndo(e,t,i,!1);if(r)return r.returnValue;n=!0}let o;try{o=yield this._invokeWorkspacePrepare(t)}catch(s){return this._onError(s,t)}const r=this._checkWorkspaceUndo(e,t,i,!0);if(r)return o.dispose(),r.returnValue;for(const e of i.editStacks)e.moveBackward(t);return this._safeInvokeWithLocks(t,(()=>t.actual.undo()),i,o,(()=>this._continueUndoInGroup(t.groupId,n)))}))}_resourceUndo(e,t,i){if(t.isValid){if(!e.locked)return this._invokeResourcePrepare(t,(n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,(()=>t.actual.undo()),new EditStackSnapshot([e]),n,(()=>this._continueUndoInGroup(t.groupId,i))))));{const e=localize({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(e)}}else e.flushAllElements()}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestPastElement();r&&(r.groupId===e&&(!t||r.groupOrder>t.groupOrder)&&(t=r,i=n))}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);return i?this._undo(i,0,t):void 0}undo(e){if(e instanceof UndoRedoSource){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return"string"==typeof e?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),o=n.getClosestPastElement();if(!o)return;if(o.groupId){const[e,n]=this._findClosestUndoElementInGroup(o.groupId);if(o!==e&&n)return this._undo(n,t,i)}if((o.sourceId!==t||o.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,o);try{return 1===o.type?this._workspaceUndo(e,o,i):this._resourceUndo(n,o,i)}finally{}}_confirmAndContinueUndo(e,t,i){return __awaiter$6(this,void 0,void 0,(function*(){if(1!==(yield this._dialogService.show(Severity$2.Info,localize("confirmDifferentSource","Would you like to undo '{0}'?",i.label),[localize("confirmDifferentSource.yes","Yes"),localize("confirmDifferentSource.no","No")],{cancelId:1})).choice)return this._undo(e,t,!0)}))}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&(r.sourceId===e&&(!t||r.sourceOrder<t.sourceOrder)&&(t=r,i=n))}return[t,i]}canRedo(e){if(e instanceof UndoRedoSource){const[,t]=this._findClosestRedoElementWithSource(e.id);return!!t}const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){return this._editStacks.get(t).hasFutureElements()}return!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new WorkspaceVerificationError(this._redo(e));for(const o of t.strResources)this.removeElements(o);return this._notificationService.warn(n),new WorkspaceVerificationError}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,localize({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const o=[];for(const s of i.editStacks)s.getClosestFutureElement()!==t&&o.push(s.resourceLabel);if(o.length>0)return this._tryToSplitAndRedo(e,t,null,localize({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,o.join(", ")));const r=[];for(const s of i.editStacks)s.locked&&r.push(s.resourceLabel);return r.length>0?this._tryToSplitAndRedo(e,t,null,localize({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,localize({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}_executeWorkspaceRedo(e,t,i){return __awaiter$6(this,void 0,void 0,(function*(){let n;try{n=yield this._invokeWorkspacePrepare(t)}catch(r){return this._onError(r,t)}const o=this._checkWorkspaceRedo(e,t,i,!0);if(o)return n.dispose(),o.returnValue;for(const e of i.editStacks)e.moveForward(t);return this._safeInvokeWithLocks(t,(()=>t.actual.redo()),i,n,(()=>this._continueRedoInGroup(t.groupId)))}))}_resourceRedo(e,t){if(t.isValid){if(!e.locked)return this._invokeResourcePrepare(t,(i=>(e.moveForward(t),this._safeInvokeWithLocks(t,(()=>t.actual.redo()),new EditStackSnapshot([e]),i,(()=>this._continueRedoInGroup(t.groupId))))));{const e=localize({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(e)}}else e.flushAllElements()}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,o]of this._editStacks){const r=o.getClosestFutureElement();r&&(r.groupId===e&&(!t||r.groupOrder<t.groupOrder)&&(t=r,i=n))}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);return t?this._redo(t):void 0}redo(e){if(e instanceof UndoRedoSource){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return"string"==typeof e?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[e,t]=this._findClosestRedoElementInGroup(i.groupId);if(i!==e&&t)return this._redo(t)}try{return 1===i.type?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};UndoRedoService=__decorate$e([__param$d(0,IDialogService),__param$d(1,INotificationService)],UndoRedoService);class WorkspaceVerificationError{constructor(e){this.returnValue=e}}registerSingleton(IUndoRedoService,UndoRedoService);const editorConfigurationBaseNode=Object.freeze({id:"editor",order:5,type:"object",title:localize("editorConfigurationTitle","Editor"),scope:5}),editorConfiguration=Object.assign(Object.assign({},editorConfigurationBaseNode),{properties:{"editor.tabSize":{type:"number",default:EDITOR_MODEL_DEFAULTS.tabSize,minimum:1,markdownDescription:localize("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.insertSpaces":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.insertSpaces,markdownDescription:localize("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.")},"editor.detectIndentation":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.detectIndentation,markdownDescription:localize("detectIndentation","Controls whether `#editor.tabSize#` and `#editor.insertSpaces#` will be automatically detected when a file is opened based on the file contents.")},"editor.trimAutoWhitespace":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.trimAutoWhitespace,description:localize("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:EDITOR_MODEL_DEFAULTS.largeFileOptimizations,description:localize("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{type:"boolean",default:!0,description:localize("wordBasedSuggestions","Controls whether completions should be computed based on words in the document.")},"editor.wordBasedSuggestionsMode":{enum:["currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[localize("wordBasedSuggestionsMode.currentDocument","Only suggest words from the active document."),localize("wordBasedSuggestionsMode.matchingDocuments","Suggest words from all open documents of the same language."),localize("wordBasedSuggestionsMode.allDocuments","Suggest words from all open documents.")],description:localize("wordBasedSuggestionsMode","Controls from which documents word based completions are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[localize("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),localize("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),localize("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:localize("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:localize("stablePeek","Keep peek editors open even when double clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:localize("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.language.brackets":{type:"array",default:!1,description:localize("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:"array",default:!1,description:localize("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:localize("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:localize("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:5e3,description:localize("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:50,description:localize("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:!0,description:localize("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:!0,description:localize("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:!0,description:localize("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:!1,description:localize("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:"inherit",markdownEnumDescriptions:[localize("wordWrap.off","Lines will never wrap."),localize("wordWrap.on","Lines will wrap at the viewport width."),localize("wordWrap.inherit","Lines will wrap according to the `#editor.wordWrap#` setting.")]}}});function isConfigurationPropertySchema(e){return void 0!==e.type||void 0!==e.anyOf}for(const e of editorOptionsRegistry){const t=e.schema;if(void 0!==t)if(isConfigurationPropertySchema(t))editorConfiguration.properties[`editor.${e.name}`]=t;else for(const e in t)Object.hasOwnProperty.call(t,e)&&(editorConfiguration.properties[e]=t[e])}let cachedEditorConfigurationKeys=null;function getEditorConfigurationKeys(){return null===cachedEditorConfigurationKeys&&(cachedEditorConfigurationKeys=Object.create(null),Object.keys(editorConfiguration.properties).forEach((e=>{cachedEditorConfigurationKeys[e]=!0}))),cachedEditorConfigurationKeys}function isEditorConfigurationKey(e){return getEditorConfigurationKeys()[`editor.${e}`]||!1}function isDiffEditorConfigurationKey(e){return getEditorConfigurationKeys()[`diffEditor.${e}`]||!1}const configurationRegistry=Registry.as(Extensions$3.Configuration);configurationRegistry.registerConfiguration(editorConfiguration);class ConfigurationModel{constructor(e={},t=[],i=[]){this._contents=e,this._keys=t,this._overrides=i,this.isFrozen=!1,this.overrideConfigurations=new Map}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return 0===this._keys.length&&0===Object.keys(this._contents).length&&0===this._overrides.length}getValue(e){return e?getConfigurationValue(this.contents,e):this.contents}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?getConfigurationValue(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=deepClone(this.contents),i=deepClone(this.overrides),n=[...this.keys];for(const o of e){this.mergeContents(t,o.contents);for(const e of o.overrides){const[t]=i.filter((t=>equals$1(t.identifiers,e.identifiers)));t?(this.mergeContents(t.contents,e.contents),t.keys.push(...e.keys),t.keys=distinct(t.keys)):i.push(deepClone(e))}for(const e of o.keys)-1===n.indexOf(e)&&n.push(e)}return new ConfigurationModel(t,n,i)}freeze(){return this.isFrozen=!0,this}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||"object"!=typeof t||!Object.keys(t).length)return this;let i={};for(const n of distinct([...Object.keys(this.contents),...Object.keys(t)])){let e=this.contents[n],o=t[n];o&&("object"==typeof e&&"object"==typeof o?(e=deepClone(e),this.mergeContents(e,o)):e=o),i[n]=e}return new ConfigurationModel(i,this.keys,this.overrides)}mergeContents(e,t){for(const i of Object.keys(t))i in e&&isObject(e[i])&&isObject(t[i])?this.mergeContents(e[i],t[i]):e[i]=deepClone(t[i])}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?deepFreeze(e):e}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=e=>{e&&(i?this.mergeContents(i,e):i=deepClone(e))};for(const o of this.overrides)equals$1(o.identifiers,[e])?t=o.contents:o.identifiers.includes(e)&&n(o.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.addKey(e),addToValueTree(this.contents,e,t,(e=>{throw new Error(e)}))}removeValue(e){this.removeKey(e)&&removeFromValueTree(this.contents,e)}addKey(e){let t=this.keys.length;for(let i=0;i<t;i++)0===e.indexOf(this.keys[i])&&(t=i);this.keys.splice(t,1,e)}removeKey(e){let t=this.keys.indexOf(e);return-1!==t&&(this.keys.splice(t,1),!0)}}class DefaultConfigurationModel extends ConfigurationModel{constructor(e={}){const t=Registry.as(Extensions$3.Configuration).getConfigurationProperties(),i=Object.keys(t),n=Object.create(null),o=[];for(const r in t){const i=e[r];addToValueTree(n,r,void 0!==i?i:t[r].default,(e=>{}))}for(const r of Object.keys(n))OVERRIDE_PROPERTY_REGEX.test(r)&&o.push({identifiers:overrideIdentifiersFromKey(r),keys:Object.keys(n[r]),contents:toValuesTree(n[r],(e=>{}))});super(n,i,o)}}class Configuration{constructor(e,t,i=new ConfigurationModel,n=new ConfigurationModel,o=new ResourceMap,r=new ConfigurationModel,s=new ResourceMap,a=!0){this._defaultConfiguration=e,this._localUserConfiguration=t,this._remoteUserConfiguration=i,this._workspaceConfiguration=n,this._folderConfigurations=o,this._memoryConfiguration=r,this._memoryConfigurationByResource=s,this._freeze=a,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new ResourceMap,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidateConfigurationModel(t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=new ConfigurationModel,this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,void 0===t?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidateConfigurationModel(t,i),o=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource&&this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration,s=t.overrideIdentifier?this._defaultConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._defaultConfiguration.freeze().getValue(e),a=t.overrideIdentifier?this.userConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.userConfiguration.freeze().getValue(e),l=t.overrideIdentifier?this.localUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.localUserConfiguration.freeze().getValue(e),d=t.overrideIdentifier?this.remoteUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.remoteUserConfiguration.freeze().getValue(e),c=i?t.overrideIdentifier?this._workspaceConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._workspaceConfiguration.freeze().getValue(e):void 0,h=o?t.overrideIdentifier?o.freeze().override(t.overrideIdentifier).getValue(e):o.freeze().getValue(e):void 0,u=t.overrideIdentifier?r.override(t.overrideIdentifier).getValue(e):r.getValue(e),g=n.getValue(e),p=distinct(flatten(n.overrides.map((e=>e.identifiers)))).filter((t=>void 0!==n.getOverrideValue(e,t)));return{defaultValue:s,userValue:a,userLocalValue:l,userRemoteValue:d,workspaceValue:c,workspaceFolderValue:h,memoryValue:u,value:g,default:void 0!==s?{value:this._defaultConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,user:void 0!==a?{value:this.userConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userLocal:void 0!==l?{value:this.localUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userRemote:void 0!==d?{value:this.remoteUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspace:void 0!==c?{value:this._workspaceConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspaceFolder:void 0!==h?{value:null==o?void 0:o.freeze().getValue(e),override:t.overrideIdentifier?null==o?void 0:o.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,memory:void 0!==u?{value:r.getValue(e),override:t.overrideIdentifier?r.getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,overrideIdentifiers:p.length?p:void 0}}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidateConfigurationModel(e,t){let i=this.getConsolidatedConfigurationModelForResource(e,t);return e.overrideIdentifier?i.override(e.overrideIdentifier):i}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const o=this._memoryConfigurationByResource.get(e);o&&(i=i.merge(o))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._freeze&&(t=t.freeze()),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce(((e,t)=>{const{contents:i,overrides:n,keys:o}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:o}]),e}),[])}}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.user),n=this.parseConfigurationModel(e.workspace),o=e.folders.reduce(((e,t)=>(e.set(URI.revive(t[0]),this.parseConfigurationModel(t[1])),e)),new ResourceMap);return new Configuration(t,i,new ConfigurationModel,n,o,new ConfigurationModel,new ResourceMap,!1)}static parseConfigurationModel(e){return new ConfigurationModel(e.contents,e.keys,e.overrides).freeze()}}class ConfigurationChangeEvent{constructor(e,t,i,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this._previousConfiguration=void 0;const o=new Set;e.keys.forEach((e=>o.add(e))),e.overrides.forEach((([,e])=>e.forEach((e=>o.add(e))))),this.affectedKeys=[...o.values()];const r=new ConfigurationModel;this.affectedKeys.forEach((e=>r.setValue(e,{}))),this.affectedKeysTree=r.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=Configuration.parse(this.previous.data)),this._previousConfiguration}affectsConfiguration(e,t){var i;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(t){return!equals(this.previousConfiguration?this.previousConfiguration.getValue(e,t,null===(i=this.previous)||void 0===i?void 0:i.workspace):void 0,this.currentConfiguraiton.getValue(e,t,this.currentWorkspace))}return!0}return!1}doesAffectedKeysTreeContains(e,t){let i,n=toValuesTree({[t]:!0},(()=>{}));for(;"object"==typeof n&&(i=Object.keys(n)[0]);){if(!(e=e[i]))return!1;n=n[i]}return!0}}const HIGH_FREQ_COMMANDS=/^(cursor|delete)/;class AbstractKeybindingService extends Disposable{constructor(e,t,i,n,o){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=o,this._onDidUpdateKeybindings=this._register(new Emitter$1),this._currentChord=null,this._currentChordChecker=new IntervalTimer,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new TimeoutTimer,this._logging=!1}get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:Event$1.None}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){const i=this.resolveKeyboardEvent(e);if(i.isChord())return null;const[n]=i.getDispatchParts();if(null===n)return null;const o=this._contextKeyService.getContext(t),r=this._currentChord?this._currentChord.keypress:null;return this._getResolver().resolve(o,r,n)}_enterChordMode(e,t){this._currentChord={keypress:e,label:t},this._currentChordStatusMessage=this._notificationService.status(localize("first.chord","({0}) was pressed. Waiting for second key of chord...",t));const i=Date.now();this._currentChordChecker.cancelAndSet((()=>{this._documentHasFocus()?Date.now()-i>5e3&&this._leaveChordMode():this._leaveChordMode()}),500)}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChord=null}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchParts();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=KeybindingModifierSet.EMPTY,null===this._currentSingleModifier?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet((()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null}),300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[o]=i.getParts();return this._ignoreSingleModifiers=new KeybindingModifierSet(o),null!==this._currentSingleModifier&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.isChord())return!1;let o=null,r=null;if(i){const[t]=e.getSingleModifierDispatchParts();o=t,r=t}else[o]=e.getDispatchParts(),r=this._currentChord?this._currentChord.keypress:null;if(null===o)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const s=this._contextKeyService.getContext(t),a=e.getLabel(),l=this._getResolver().resolve(s,r,o);return this._logService.trace("KeybindingService#dispatch",a,null==l?void 0:l.commandId),l&&l.enterChord?(n=!0,this._enterChordMode(o,a),n):(this._currentChord&&(l&&l.commandId||(this._notificationService.status(localize("missing.chord","The key combination ({0}, {1}) is not a command.",this._currentChord.label,a),{hideAfter:1e4}),n=!0)),this._leaveChordMode(),l&&l.commandId&&(l.bubble||(n=!0),void 0===l.commandArgs?this._commandService.executeCommand(l.commandId).then(void 0,(e=>this._notificationService.warn(e))):this._commandService.executeCommand(l.commandId,l.commandArgs).then(void 0,(e=>this._notificationService.warn(e))),HIGH_FREQ_COMMANDS.test(l.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:l.commandId,from:"keybinding"})),n)}mightProducePrintableCharacter(e){return!e.ctrlKey&&!e.metaKey&&(e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30)}}class KeybindingModifierSet{constructor(e){this._ctrlKey=!!e&&e.ctrlKey,this._shiftKey=!!e&&e.shiftKey,this._altKey=!!e&&e.altKey,this._metaKey=!!e&&e.metaKey}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}}KeybindingModifierSet.EMPTY=new KeybindingModifierSet(null);class KeybindingResolver{constructor(e,t,i){this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const n of e){const e=n.command;e&&"-"!==e.charAt(0)&&this._defaultBoundCommands.set(e,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=KeybindingResolver.handleRemovals([].concat(e).concat(t));for(let n=0,o=this._keybindings.length;n<o;n++){let e=this._keybindings[n];0!==e.keypressParts.length&&(e.when&&0===e.when.type||this._addKeyPress(e.keypressParts[0],e))}}static _isTargetedForRemoval(e,t,i,n){if(t&&e.keypressParts[0]!==t)return!1;if(i&&e.keypressParts[1]!==i)return!1;if(n){if(!e.when)return!1;if(!expressionsAreEqualWithConstantSubstitution(n,e.when))return!1}return!0}static handleRemovals(e){const t=new Map;for(let n=0,o=e.length;n<o;n++){const i=e[n];if(i.command&&"-"===i.command.charAt(0)){const e=i.command.substring(1);t.has(e)?t.get(e).push(i):t.set(e,[i])}}if(0===t.size)return e;const i=[];for(let n=0,o=e.length;n<o;n++){const o=e[n];if(!o.command||0===o.command.length){i.push(o);continue}if("-"===o.command.charAt(0))continue;const r=t.get(o.command);if(!r||!o.isDefault){i.push(o);continue}let s=!1;for(const e of r){const t=e.keypressParts[0],i=e.keypressParts[1],n=e.when;if(this._isTargetedForRemoval(o,t,i,n)){s=!0;break}}s||i.push(o)}return i}_addKeyPress(e,t){const i=this._map.get(e);if(void 0===i)return this._map.set(e,[t]),void this._addToLookupMap(t);for(let n=i.length-1;n>=0;n--){let e=i[n];if(e.command===t.command)continue;const o=e.keypressParts.length>1,r=t.keypressParts.length>1;o&&r&&e.keypressParts[1]!==t.keypressParts[1]||KeybindingResolver.whenIsEntirelyIncluded(e.when,t.when)&&this._removeFromLookupMap(e)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);void 0===t?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);if(void 0!==t)for(let i=0,n=t.length;i<n;i++)if(t[i]===e)return void t.splice(i,1)}static whenIsEntirelyIncluded(e,t){return!t||1===t.type||!(!e||1===e.type)&&implies(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(void 0===i||0===i.length)return null;if(1===i.length)return i[0];for(let n=i.length-1;n>=0;n--){const e=i[n];if(t.contextMatchesRules(e.when))return e}return i[i.length-1]}resolve(e,t,i){this._log(`| Resolving ${i}${t?` chorded from ${t}`:""}`);let n=null;if(null!==t){const e=this._map.get(t);if(void 0===e)return this._log("\\ No keybinding entries."),null;n=[];for(let t=0,o=e.length;t<o;t++){let o=e[t];o.keypressParts[1]===i&&n.push(o)}}else{const e=this._map.get(i);if(void 0===e)return this._log("\\ No keybinding entries."),null;n=e}let o=this._findCommand(e,n);return o?null===t&&o.keypressParts.length>1&&null!==o.keypressParts[1]?(this._log(`\\ From ${n.length} keybinding entries, matched chord, when: ${printWhenExplanation(o.when)}, source: ${printSourceExplanation(o)}.`),{enterChord:!0,leaveChord:!1,commandId:null,commandArgs:null,bubble:!1}):(this._log(`\\ From ${n.length} keybinding entries, matched ${o.command}, when: ${printWhenExplanation(o.when)}, source: ${printSourceExplanation(o)}.`),{enterChord:!1,leaveChord:o.keypressParts.length>1,commandId:o.command,commandArgs:o.commandArgs,bubble:o.bubble}):(this._log(`\\ From ${n.length} keybinding entries, no when clauses matched the context.`),null)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){let n=t[i];if(KeybindingResolver._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return!t||t.evaluate(e)}}function printWhenExplanation(e){return e?`${e.serialize()}`:"no when condition"}function printSourceExplanation(e){return e.extensionId?e.isBuiltinExtension?`built-in extension ${e.extensionId}`:`user extension ${e.extensionId}`:e.isDefault?"built-in":"user"}class ResolvedKeybindingItem{constructor(e,t,i,n,o,r,s){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.keypressParts=e?removeElementsAfterNulls(e.getDispatchParts()):[],e&&0===this.keypressParts.length&&(this.keypressParts=removeElementsAfterNulls(e.getSingleModifierDispatchParts())),this.bubble=!!t&&94===t.charCodeAt(0),this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=o,this.extensionId=r,this.isBuiltinExtension=s}}function removeElementsAfterNulls(e){let t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];if(!n)return t;t.push(n)}return t}class BaseResolvedKeybinding extends ResolvedKeybinding{constructor(e,t){if(super(),0===t.length)throw illegalArgument("parts");this._os=e,this._parts=t}getLabel(){return UILabelProvider.toLabel(this._os,this._parts,(e=>this._getLabel(e)))}getAriaLabel(){return AriaLabelProvider.toLabel(this._os,this._parts,(e=>this._getAriaLabel(e)))}getElectronAccelerator(){return this._parts.length>1||this._parts[0].isDuplicateModifierCase()?null:ElectronAcceleratorLabelProvider.toLabel(this._os,this._parts,(e=>this._getElectronAccelerator(e)))}isChord(){return this._parts.length>1}getParts(){return this._parts.map((e=>this._getPart(e)))}_getPart(e){return new ResolvedKeybindingPart(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchParts(){return this._parts.map((e=>this._getDispatchPart(e)))}getSingleModifierDispatchParts(){return this._parts.map((e=>this._getSingleModifierDispatchPart(e)))}}class USLayoutResolvedKeybinding extends BaseResolvedKeybinding{constructor(e,t){super(t,e.parts)}_keyCodeToUILabel(e){if(2===this._os)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return KeyCodeUtils.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":KeyCodeUtils.toString(e.keyCode)}_getElectronAccelerator(e){return KeyCodeUtils.toElectronAccelerator(e.keyCode)}_getDispatchPart(e){return USLayoutResolvedKeybinding.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=KeyCodeUtils.toString(e.keyCode),t}_getSingleModifierDispatchPart(e){return 5!==e.keyCode||e.shiftKey||e.altKey||e.metaKey?4!==e.keyCode||e.ctrlKey||e.altKey||e.metaKey?6!==e.keyCode||e.ctrlKey||e.shiftKey||e.metaKey?57!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey?null:"meta":"alt":"shift":"ctrl"}static _scanCodeToKeyCode(e){const t=IMMUTABLE_CODE_TO_KEY_CODE[e];if(-1!==t)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 83;case 52:return 81;case 53:return 87;case 54:return 89;case 55:return 88;case 56:return 0;case 57:return 80;case 58:return 90;case 59:return 86;case 60:return 82;case 61:return 84;case 62:return 85;case 106:return 92}return 0}static _resolveSimpleUserBinding(e){if(!e)return null;if(e instanceof SimpleKeybinding)return e;const t=this._scanCodeToKeyCode(e.scanCode);return 0===t?null:new SimpleKeybinding(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveUserBinding(e,t){const i=removeElementsAfterNulls(e.map((e=>this._resolveSimpleUserBinding(e))));return i.length>0?[new USLayoutResolvedKeybinding(new ChordKeybinding(i),t)]:[]}}var contextview="",LayoutAnchorMode,LayoutAnchorMode2;function layout(e,t,i){const n=i.mode===LayoutAnchorMode.ALIGN?i.offset:i.offset+i.size,o=i.mode===LayoutAnchorMode.ALIGN?i.offset+i.size:i.offset;return 0===i.position?t<=e-n?n:t<=o?o-t:Math.max(e-t,0):t<=o?o-t:t<=e-n?n:0}LayoutAnchorMode2=LayoutAnchorMode||(LayoutAnchorMode={}),LayoutAnchorMode2[LayoutAnchorMode2.AVOID=0]="AVOID",LayoutAnchorMode2[LayoutAnchorMode2.ALIGN=1]="ALIGN";class ContextView extends Disposable{constructor(e,t){super(),this.container=null,this.delegate=null,this.toDisposeOnClean=Disposable.None,this.toDisposeOnSetContainer=Disposable.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=$$c(".context-view"),this.useFixedPosition=!1,this.useShadowDOM=!1,hide(this.view),this.setContainer(e,t),this._register(toDisposable((()=>this.setContainer(null,1))))}setContainer(e,t){var i;if(this.container&&(this.toDisposeOnSetContainer.dispose(),this.shadowRoot?(this.shadowRoot.removeChild(this.view),this.shadowRoot=null,null===(i=this.shadowRootHostElement)||void 0===i||i.remove(),this.shadowRootHostElement=null):this.container.removeChild(this.view),this.container=null),e){if(this.container=e,this.useFixedPosition=1!==t,this.useShadowDOM=3===t,this.useShadowDOM){this.shadowRootHostElement=$$c(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const e=document.createElement("style");e.textContent=SHADOW_ROOT_CSS,this.shadowRoot.appendChild(e),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild($$c("slot"))}else this.container.appendChild(this.view);const i=new DisposableStore;ContextView.BUBBLE_UP_EVENTS.forEach((e=>{i.add(addStandardDisposableListener(this.container,e,(e=>{this.onDOMEvent(e,!1)})))})),ContextView.BUBBLE_DOWN_EVENTS.forEach((e=>{i.add(addStandardDisposableListener(this.container,e,(e=>{this.onDOMEvent(e,!0)}),!0))})),this.toDisposeOnSetContainer=i}}show(e){this.isVisible()&&this.hide(),clearNode(this.view),this.view.className="context-view",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex="2500",this.view.style.position=this.useFixedPosition?"fixed":"absolute",show(this.view),this.toDisposeOnClean=e.render(this.view)||Disposable.None,this.delegate=e,this.doLayout(),this.delegate.focus&&this.delegate.focus()}getViewElement(){return this.view}layout(){this.isVisible()&&(!1!==this.delegate.canRelayout||isIOS&&BrowserFeatures.pointerEvents?(this.delegate.layout&&this.delegate.layout(),this.doLayout()):this.hide())}doLayout(){if(!this.isVisible())return;let e,t=this.delegate.getAnchor();if(isHTMLElement(t)){let i=getDomNodePagePosition(t);e={top:i.top,left:i.left,width:i.width,height:i.height}}else e={top:t.y,left:t.x,width:t.width||1,height:t.height||2};const i=getTotalWidth(this.view),n=getTotalHeight(this.view),o=this.delegate.anchorPosition||0,r=this.delegate.anchorAlignment||0;let s,a;if(0===(this.delegate.anchorAxisAlignment||0)){const t={offset:e.top-window.pageYOffset,size:e.height,position:0===o?0:1},l={offset:e.left,size:e.width,position:0===r?0:1,mode:LayoutAnchorMode.ALIGN};s=layout(window.innerHeight,n,t)+window.pageYOffset,Range$1.intersects({start:s,end:s+n},{start:t.offset,end:t.offset+t.size})&&(l.mode=LayoutAnchorMode.AVOID),a=layout(window.innerWidth,i,l)}else{const t={offset:e.left,size:e.width,position:0===r?0:1},l={offset:e.top,size:e.height,position:0===o?0:1,mode:LayoutAnchorMode.ALIGN};a=layout(window.innerWidth,i,t),Range$1.intersects({start:a,end:a+i},{start:t.offset,end:t.offset+t.size})&&(l.mode=LayoutAnchorMode.AVOID),s=layout(window.innerHeight,n,l)+window.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(0===o?"bottom":"top"),this.view.classList.add(0===r?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const l=getDomNodePagePosition(this.container);this.view.style.top=s-(this.useFixedPosition?getDomNodePagePosition(this.view).top:l.top)+"px",this.view.style.left=a-(this.useFixedPosition?getDomNodePagePosition(this.view).left:l.left)+"px",this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,(null==t?void 0:t.onHide)&&t.onHide(e),this.toDisposeOnClean.dispose(),hide(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,document.activeElement):t&&!isAncestor$1(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}}ContextView.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],ContextView.BUBBLE_DOWN_EVENTS=["click"];let SHADOW_ROOT_CSS='\n\t:host {\n\t\tall: initial; /* 1st rule so subsequent properties are reset. */\n\t}\n\n\t@font-face {\n\t\tfont-family: "codicon";\n\t\tfont-display: block;\n\t\tsrc: url("./codicon.ttf?5d4d76ab2ce5108968ad644d591a16a6") format("truetype");\n\t}\n\n\t.codicon[class*=\'codicon-\'] {\n\t\tfont: normal normal normal 16px/1 codicon;\n\t\tdisplay: inline-block;\n\t\ttext-decoration: none;\n\t\ttext-rendering: auto;\n\t\ttext-align: center;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t\tuser-select: none;\n\t\t-webkit-user-select: none;\n\t\t-ms-user-select: none;\n\t}\n\n\t:host {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;\n\t}\n\n\t:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }\n\t:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }\n\t:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }\n\t:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }\n\t:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }\n\n\t:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }\n\t:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }\n\t:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }\n\t:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }\n\t:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }\n\n\t:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }\n\t:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }\n';var __decorate$d=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$c=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ContextViewService=class extends Disposable{constructor(e){super(),this.layoutService=e,this.currentViewDisposable=Disposable.None,this.container=e.hasContainer?e.container:null,this.contextView=this._register(new ContextView(this.container,1)),this.layout(),this._register(e.onDidLayout((()=>this.layout())))}setContainer(e,t){this.contextView.setContainer(e,t||1)}showContextView(e,t,i){t?t!==this.container&&(this.container=t,this.setContainer(t,i?3:2)):this.layoutService.hasContainer&&this.container!==this.layoutService.container&&(this.container=this.layoutService.container,this.setContainer(this.container,1)),this.contextView.show(e);const n=toDisposable((()=>{this.currentViewDisposable===n&&this.hideContextView()}));return this.currentViewDisposable=n,n}getContextViewElement(){return this.contextView.getViewElement()}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e)}};ContextViewService=__decorate$d([__param$c(0,ILayoutService)],ContextViewService);const GLOBSTAR="**",GLOB_SPLIT="/",PATH_REGEX="[/\\\\]",NO_PATH_REGEX="[^/\\\\]",ALL_FORWARD_SLASHES=/\//g;function starsToRegExp(e){switch(e){case 0:return"";case 1:return`${NO_PATH_REGEX}*?`;default:return`(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}|${PATH_REGEX}${NO_PATH_REGEX}+)*?`}}function splitGlobAware(e,t){if(!e)return[];const i=[];let n=!1,o=!1,r="";for(const s of e){switch(s){case t:if(!n&&!o){i.push(r),r="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":o=!0;break;case"]":o=!1}r+=s}return r&&i.push(r),i}function parseRegExp(e){if(!e)return"";let t="";const i=splitGlobAware(e,GLOB_SPLIT);if(i.every((e=>e===GLOBSTAR)))t=".*";else{let e=!1;i.forEach(((n,o)=>{if(n===GLOBSTAR)return void(e||(t+=starsToRegExp(2),e=!0));let r=!1,s="",a=!1,l="";for(const e of n)if("}"!==e&&r)s+=e;else if(!a||"]"===e&&l)switch(e){case"{":r=!0;continue;case"[":a=!0;continue;case"}":{const e=`(?:${splitGlobAware(s,",").map((e=>parseRegExp(e))).join("|")})`;t+=e,r=!1,s="";break}case"]":t+="["+l+"]",a=!1,l="";break;case"?":t+=NO_PATH_REGEX;continue;case"*":t+=starsToRegExp(1);continue;default:t+=escapeRegExpCharacters(e)}else{let t;t="-"===e?e:"^"!==e&&"!"!==e||l?e===GLOB_SPLIT?"":escapeRegExpCharacters(e):"^",l+=t}o<i.length-1&&(i[o+1]!==GLOBSTAR||o+2<i.length)&&(t+=PATH_REGEX),e=!1}))}return t}const T1=/^\*\*\/\*\.[\w\.-]+$/,T2=/^\*\*\/([\w\.-]+)\/?$/,T3=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,T3_2=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,T4=/^\*\*((\/[\w\.-]+)+)\/?$/,T5=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,CACHE=new LRUCache(1e4),FALSE=function(){return!1},NULL=function(){return null};function parsePattern(e,t){if(!e)return NULL;let i;i="string"!=typeof e?e.pattern:e,i=i.trim();const n=`${i}_${!!t.trimForExclusions}`;let o,r=CACHE.get(n);if(r)return wrapRelativePattern(r,e);if(T1.test(i)){const e=i.substr(4);r=function(t,n){return"string"==typeof t&&t.endsWith(e)?i:null}}else r=(o=T2.exec(trimForExclusions(i,t)))?trivia2(o[1],i):(t.trimForExclusions?T3_2:T3).test(i)?trivia3(i,t):(o=T4.exec(trimForExclusions(i,t)))?trivia4and5(o[1].substr(1),i,!0):(o=T5.exec(trimForExclusions(i,t)))?trivia4and5(o[1],i,!1):toRegExp(i);return CACHE.set(n,r),wrapRelativePattern(r,e)}function wrapRelativePattern(e,t){return"string"==typeof t?e:function(i,n){return isEqualOrParent(i,t.base,!isLinux)?e(i.substr(t.base.length+1),n):null}}function trimForExclusions(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substr(0,e.length-2):e}function trivia2(e,t){const i=`/${e}`,n=`\\${e}`,o=function(o,r){return"string"!=typeof o?null:r?r===e?t:null:o===e||o.endsWith(i)||o.endsWith(n)?t:null},r=[e];return o.basenames=r,o.patterns=[t],o.allBasenames=r,o}function trivia3(e,t){const i=aggregateBasenameMatches(e.slice(1,-1).split(",").map((e=>parsePattern(e,t))).filter((e=>e!==NULL)),e),n=i.length;if(!n)return NULL;if(1===n)return i[0];const o=function(t,n){for(let o=0,r=i.length;o<r;o++)if(i[o](t,n))return e;return null},r=i.find((e=>!!e.allBasenames));r&&(o.allBasenames=r.allBasenames);const s=i.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);return s.length&&(o.allPaths=s),o}function trivia4and5(e,t,i){const n=sep===posix.sep,o=n?e:e.replace(ALL_FORWARD_SLASHES,sep),r=sep+o,s=posix.sep+e,a=i?function(i,a){return"string"!=typeof i||i!==o&&!i.endsWith(r)&&(n||i!==e&&!i.endsWith(s))?null:t}:function(i,r){return"string"!=typeof i||i!==o&&(n||i!==e)?null:t};return a.allPaths=[(i?"*/":"./")+e],a}function toRegExp(e){try{const t=new RegExp(`^${parseRegExp(e)}$`);return function(i){return t.lastIndex=0,"string"==typeof i&&t.test(i)?e:null}}catch(t){return NULL}}function match(e,t,i){return!(!e||"string"!=typeof t)&&parse(e)(t,void 0,i)}function parse(e,t={}){if(!e)return FALSE;if("string"==typeof e||isRelativePattern(e)){const i=parsePattern(e,t);if(i===NULL)return FALSE;const n=function(e,t){return!!i(e,t)};return i.allBasenames&&(n.allBasenames=i.allBasenames),i.allPaths&&(n.allPaths=i.allPaths),n}return parsedExpression(e,t)}function isRelativePattern(e){const t=e;return!!t&&("string"==typeof t.base&&"string"==typeof t.pattern)}function parsedExpression(e,t){const i=aggregateBasenameMatches(Object.getOwnPropertyNames(e).map((i=>parseExpressionPattern(i,e[i],t))).filter((e=>e!==NULL))),n=i.length;if(!n)return NULL;if(!i.some((e=>!!e.requiresSiblings))){if(1===n)return i[0];const e=function(e,t){for(let n=0,o=i.length;n<o;n++){const o=i[n](e,t);if(o)return o}return null},t=i.find((e=>!!e.allBasenames));t&&(e.allBasenames=t.allBasenames);const o=i.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);return o.length&&(e.allPaths=o),e}const o=function(e,t,n){let o;for(let r=0,s=i.length;r<s;r++){const s=i[r];s.requiresSiblings&&n&&(t||(t=basename$1(e)),o||(o=t.substr(0,t.length-extname$1(e).length)));const a=s(e,t,o,n);if(a)return a}return null},r=i.find((e=>!!e.allBasenames));r&&(o.allBasenames=r.allBasenames);const s=i.reduce(((e,t)=>t.allPaths?e.concat(t.allPaths):e),[]);return s.length&&(o.allPaths=s),o}function parseExpressionPattern(e,t,i){if(!1===t)return NULL;const n=parsePattern(e,i);if(n===NULL)return NULL;if("boolean"==typeof t)return n;if(t){const i=t.when;if("string"==typeof i){const t=(t,o,r,s)=>{if(!s||!n(t,o))return null;const a=s(i.replace("$(basename)",r));return isThenable$1(a)?a.then((t=>t?e:null)):a?e:null};return t.requiresSiblings=!0,t}}return n}function aggregateBasenameMatches(e,t){const i=e.filter((e=>!!e.basenames));if(i.length<2)return e;const n=i.reduce(((e,t)=>{const i=t.basenames;return i?e.concat(i):e}),[]);let o;if(t){o=[];for(let e=0,i=n.length;e<i;e++)o.push(t)}else o=i.reduce(((e,t)=>{const i=t.patterns;return i?e.concat(i):e}),[]);const r=function(e,t){if("string"!=typeof e)return null;if(!t){let i;for(i=e.length;i>0;i--){const t=e.charCodeAt(i-1);if(47===t||92===t)break}t=e.substr(i)}const i=n.indexOf(t);return-1!==i?o[i]:null};r.basenames=n,r.patterns=o,r.allBasenames=n;const s=e.filter((e=>!e.basenames));return s.push(r),s}let registeredAssociations=[],nonUserRegisteredAssociations=[],userRegisteredAssociations=[];function registerPlatformLanguageAssociation(e,t=!1){_registerLanguageAssociation(e,!1,t)}function _registerLanguageAssociation(e,t,i){const n=toLanguageAssociationItem(e,t);registeredAssociations.push(n),n.userConfigured?userRegisteredAssociations.push(n):nonUserRegisteredAssociations.push(n),i&&!n.userConfigured&&registeredAssociations.forEach((e=>{e.mime===n.mime||e.userConfigured||(n.extension&&(e.extension,n.extension),n.filename&&(e.filename,n.filename),n.filepattern&&(e.filepattern,n.filepattern),n.firstline&&(e.firstline,n.firstline))}))}function toLanguageAssociationItem(e,t){return{id:e.id,mime:e.mime,filename:e.filename,extension:e.extension,filepattern:e.filepattern,firstline:e.firstline,userConfigured:t,filenameLowercase:e.filename?e.filename.toLowerCase():void 0,extensionLowercase:e.extension?e.extension.toLowerCase():void 0,filepatternLowercase:e.filepattern?parse(e.filepattern.toLowerCase()):void 0,filepatternOnPath:!!e.filepattern&&e.filepattern.indexOf(posix.sep)>=0}}function clearPlatformLanguageAssociations(){registeredAssociations=registeredAssociations.filter((e=>e.userConfigured)),nonUserRegisteredAssociations=[]}function getMimeTypes(e,t){let i;if(e)switch(e.scheme){case Schemas.file:i=e.fsPath;break;case Schemas.data:i=DataUri.parseMetaData(e).get(DataUri.META_DATA_LABEL);break;default:i=e.path}if(!i)return[Mimes.unknown];i=i.toLowerCase();const n=basename$1(i),o=getMimeByPath(i,n,userRegisteredAssociations);if(o)return[o,Mimes.text];const r=getMimeByPath(i,n,nonUserRegisteredAssociations);if(r)return[r,Mimes.text];if(t){const e=getMimeByFirstline(t);if(e)return[e,Mimes.text]}return[Mimes.unknown]}function getMimeByPath(e,t,i){var n;let o,r,s;for(let a=i.length-1;a>=0;a--){const l=i[a];if(t===l.filenameLowercase){o=l;break}if(l.filepattern&&(!r||l.filepattern.length>r.filepattern.length)){const i=l.filepatternOnPath?e:t;(null===(n=l.filepatternLowercase)||void 0===n?void 0:n.call(l,i))&&(r=l)}l.extension&&(!s||l.extension.length>s.extension.length)&&t.endsWith(l.extensionLowercase)&&(s=l)}return o?o.mime:r?r.mime:s?s.mime:void 0}function getMimeByFirstline(e){if(startsWithUTF8BOM(e)&&(e=e.substr(1)),e.length>0)for(let t=registeredAssociations.length-1;t>=0;t--){const i=registeredAssociations[t];if(!i.firstline)continue;const n=e.match(i.firstline);if(n&&n.length>0)return i.mime}}const hasOwnProperty=Object.prototype.hasOwnProperty,NULL_LANGUAGE_ID="vs.editor.nullLanguage";LanguageConfigurationRegistry.register(NULL_LANGUAGE_ID,{});class LanguageIdCodec{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(NULL_LANGUAGE_ID,0),this._register(PLAINTEXT_LANGUAGE_ID,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||NULL_LANGUAGE_ID}}class LanguagesRegistry extends Disposable{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new Emitter$1),this.onDidChange=this._onDidChange.event,LanguagesRegistry.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new LanguageIdCodec,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(ModesRegistry.onDidChangeLanguages((e=>{this._initializeFromRegistry()}))))}dispose(){LanguagesRegistry.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},clearPlatformLanguageAssociations();const e=[].concat(ModesRegistry.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach((e=>{const t=this._languages[e];t.name&&(this._nameMap[t.name]=t.identifier),t.aliases.forEach((e=>{this._lowercaseNameMap[e.toLowerCase()]=t.identifier})),t.mimetypes.forEach((e=>{this._mimeTypesMap[e]=t.identifier}))})),Registry.as(Extensions$3.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;hasOwnProperty.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(let e of t.extensions)registerPlatformLanguageAssociation({id:i,mime:n,extension:e},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(let a of t.filenames)registerPlatformLanguageAssociation({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(let a of t.filenamePatterns)registerPlatformLanguageAssociation({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if("string"==typeof t.firstLine&&t.firstLine.length>0){let e=t.firstLine;"^"!==e.charAt(0)&&(e="^"+e);try{const t=new RegExp(e);regExpLeadsToEndlessLoop(t)||registerPlatformLanguageAssociation({id:i,mime:n,firstline:t},this._warnOnOverwrite)}catch(s){onUnexpectedError(s)}}e.aliases.push(i);let o=null;if(void 0!==t.aliases&&Array.isArray(t.aliases)&&(o=0===t.aliases.length?[null]:t.aliases),null!==o)for(const a of o)a&&0!==a.length&&e.aliases.push(a);const r=null!==o&&o.length>0;if(r&&null===o[0]);else{const t=(r?o[0]:null)||i;!r&&e.name||(e.name=t)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return!!e&&hasOwnProperty.call(this._languages,e)}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return hasOwnProperty.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&hasOwnProperty.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){if(!e&&!t)return[];return coalesce(getMimeTypes(e,t).map((e=>this.getLanguageIdByMimeType(e))))}}LanguagesRegistry.instanceCount=0;class LanguageService extends Disposable{constructor(e=!1){super(),this._onDidEncounterLanguage=this._register(new Emitter$1),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event,this._onDidChange=this._register(new Emitter$1({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,LanguageService.instanceCount++,this._encounteredLanguages=new Set,this._registry=this._register(new LanguagesRegistry(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange((()=>this._onDidChange.fire())))}dispose(){LanguageService.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){return firstOrDefault(this._registry.guessLanguageIdByFilepathOrFirstLine(e,t),null)}createById(e){return new LanguageSelection(this.onDidChange,(()=>this._createAndGetLanguageIdentifier(e)))}createByFilepathOrFirstLine(e,t){return new LanguageSelection(this.onDidChange,(()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)}))}_createAndGetLanguageIdentifier(e){return e&&this.isRegisteredLanguageId(e)||(e=PLAINTEXT_LANGUAGE_ID),this._encounteredLanguages.has(e)||(this._encounteredLanguages.add(e),TokenizationRegistry.getOrCreate(e),this._onDidEncounterLanguage.fire(e)),e}}LanguageService.instanceCount=0;class LanguageSelection{constructor(e,t){this._onDidChangeLanguages=e,this._selector=t,this._listener=null,this._emitter=null,this.languageId=this._selector()}_dispose(){this._listener&&(this._listener.dispose(),this._listener=null),this._emitter&&(this._emitter.dispose(),this._emitter=null)}get onDidChange(){return this._listener||(this._listener=this._onDidChangeLanguages((()=>this._evaluate()))),this._emitter||(this._emitter=new Emitter$1({onLastListenerRemove:()=>{this._dispose()}})),this._emitter.event}_evaluate(){const e=this._selector();e!==this.languageId&&(this.languageId=e,this._emitter&&this._emitter.fire(this.languageId))}}const MENU_MNEMONIC_REGEX=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,MENU_ESCAPED_MNEMONIC_REGEX=/(&amp;)?(&amp;)([^\s&])/g;var Direction,Direction2;Direction2=Direction||(Direction={}),Direction2[Direction2.Right=0]="Right",Direction2[Direction2.Left=1]="Left";class Menu$1 extends ActionBar{constructor(e,t,i={}){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const n=document.createElement("div");n.classList.add("monaco-menu"),n.setAttribute("role","presentation"),super(n,{orientation:1,actionViewItemProvider:e=>this.doGetActionViewItem(e,i,o),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...isMacintosh||isLinux?[10]:[]],keyDown:!0}}),this.menuElement=n,this.actionsList.setAttribute("role","menu"),this.actionsList.tabIndex=0,this.menuDisposables=this._register(new DisposableStore),this.initializeOrUpdateStyleSheet(e,{}),this._register(Gesture.addTarget(n)),addDisposableListener(n,EventType$1.KEY_DOWN,(e=>{new StandardKeyboardEvent(e).equals(2)&&e.preventDefault()})),i.enableMnemonics&&this.menuDisposables.add(addDisposableListener(n,EventType$1.KEY_DOWN,(e=>{const t=e.key.toLocaleLowerCase();if(this.mnemonics.has(t)){EventHelper.stop(e,!0);const i=this.mnemonics.get(t);if(1===i.length&&(i[0]instanceof SubmenuMenuActionViewItem&&i[0].container&&this.focusItemByElement(i[0].container),i[0].onClick(e)),i.length>1){const e=i.shift();e&&e.container&&(this.focusItemByElement(e.container),i.push(e)),this.mnemonics.set(t,i)}}}))),isLinux&&this._register(addDisposableListener(n,EventType$1.KEY_DOWN,(e=>{const t=new StandardKeyboardEvent(e);t.equals(14)||t.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),EventHelper.stop(e,!0)):(t.equals(13)||t.equals(12))&&(this.focusedItem=0,this.focusPrevious(),EventHelper.stop(e,!0))}))),this._register(addDisposableListener(this.domNode,EventType$1.MOUSE_OUT,(e=>{isAncestor$1(e.relatedTarget,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),e.stopPropagation())}))),this._register(addDisposableListener(this.actionsList,EventType$1.MOUSE_OVER,(e=>{let t=e.target;if(t&&isAncestor$1(t,this.actionsList)&&t!==this.actionsList){for(;t.parentElement!==this.actionsList&&null!==t.parentElement;)t=t.parentElement;if(t.classList.contains("action-item")){const e=this.focusedItem;this.setFocusedItem(t),e!==this.focusedItem&&this.updateFocus()}}}))),this._register(Gesture.addTarget(this.actionsList)),this._register(addDisposableListener(this.actionsList,EventType.Tap,(e=>{let t=e.initialTarget;if(t&&isAncestor$1(t,this.actionsList)&&t!==this.actionsList){for(;t.parentElement!==this.actionsList&&null!==t.parentElement;)t=t.parentElement;if(t.classList.contains("action-item")){const e=this.focusedItem;this.setFocusedItem(t),e!==this.focusedItem&&this.updateFocus()}}})));let o={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new DomScrollableElement(n,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const r=this.scrollableElement.getDomNode();r.style.position="",this._register(addDisposableListener(n,EventType.Change,(e=>{EventHelper.stop(e,!0);const t=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:t-e.translationY})}))),this._register(addDisposableListener(r,EventType$1.MOUSE_UP,(e=>{e.preventDefault()}))),n.style.maxHeight=`${Math.max(10,window.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((e=>{var t;return!(null===(t=i.submenuIds)||void 0===t?void 0:t.has(e.id))})),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter((e=>!(e instanceof MenuSeparatorActionViewItem))).forEach(((e,t,i)=>{e.updatePositionInSet(t+1,i.length)}))}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(isInShadowDOM(e)?this.styleSheet=createStyleSheet(e):(Menu$1.globalStyleSheet||(Menu$1.globalStyleSheet=createStyleSheet()),this.styleSheet=Menu$1.globalStyleSheet)),this.styleSheet.textContent=getMenuWidgetCSS(t,isInShadowDOM(e))}style(e){const t=this.getContainer();this.initializeOrUpdateStyleSheet(t,e);const i=e.foregroundColor?`${e.foregroundColor}`:"",n=e.backgroundColor?`${e.backgroundColor}`:"",o=e.borderColor?`1px solid ${e.borderColor}`:"",r=e.shadowColor?`0 2px 4px ${e.shadowColor}`:"";t.style.border=o,this.domNode.style.color=i,this.domNode.style.backgroundColor=n,t.style.boxShadow=r,this.viewItems&&this.viewItems.forEach((t=>{(t instanceof BaseMenuActionViewItem||t instanceof MenuSeparatorActionViewItem)&&t.style(e)}))}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){if(e===this.actionsList.children[t]){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),void 0!==this.focusedItem&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof Separator)return new MenuSeparatorActionViewItem(t.context,e,{icon:!0});if(e instanceof SubmenuAction){const n=new SubmenuMenuActionViewItem(e,e.actions,i,Object.assign(Object.assign({},t),{submenuIds:new Set([...t.submenuIds||[],e.id])}));if(t.enableMnemonics){const e=n.getMnemonic();if(e&&n.isEnabled()){let t=[];this.mnemonics.has(e)&&(t=this.mnemonics.get(e)),t.push(n),this.mnemonics.set(e,t)}}return n}{const i={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const n=t.getKeyBinding(e);if(n){const e=n.getLabel();e&&(i.keybinding=e)}}const n=new BaseMenuActionViewItem(t.context,e,i);if(t.enableMnemonics){const e=n.getMnemonic();if(e&&n.isEnabled()){let t=[];this.mnemonics.has(e)&&(t=this.mnemonics.get(e)),t.push(n),this.mnemonics.set(e,t)}}return n}}}class BaseMenuActionViewItem extends BaseActionViewItem{constructor(e,t,i={}){if(i.isMenu=!0,super(t,t,i),this.options=i,this.options.icon=void 0!==i.icon&&i.icon,this.options.label=void 0===i.label||i.label,this.cssClass="",this.options.label&&i.enableMnemonics){let e=this.getAction().label;if(e){let t=MENU_MNEMONIC_REGEX.exec(e);t&&(this.mnemonic=(t[1]?t[1]:t[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new RunOnceScheduler((()=>{this.element&&(this._register(addDisposableListener(this.element,EventType$1.MOUSE_UP,(e=>{if(EventHelper.stop(e,!0),isFirefox){if(new StandardMouseEvent(e).rightButton)return;this.onClick(e)}else setTimeout((()=>{this.onClick(e)}),0)}))),this._register(addDisposableListener(this.element,EventType$1.CONTEXT_MENU,(e=>{EventHelper.stop(e,!0)}))))}),100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=append$1(this.element,$$c("a.action-menu-item")),this._action.id===Separator.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=append$1(this.item,$$c("span.menu-item-check"+Codicon.menuSelection.cssSelector)),this.check.setAttribute("role","none"),this.label=append$1(this.item,$$c("span.action-label")),this.options.label&&this.options.keybinding&&(append$1(this.item,$$c("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item&&this.item.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){if(this.label&&this.options.label){clearNode(this.label);let e=stripIcons(this.getAction().label);if(e){const t=cleanMnemonic(e);this.options.enableMnemonics||(e=t),this.label.setAttribute("aria-label",t.replace(/&&/g,"&"));const i=MENU_MNEMONIC_REGEX.exec(e);if(i){e=escape(e),MENU_ESCAPED_MNEMONIC_REGEX.lastIndex=0;let t=MENU_ESCAPED_MNEMONIC_REGEX.exec(e);for(;t&&t[1];)t=MENU_ESCAPED_MNEMONIC_REGEX.exec(e);const n=e=>e.replace(/&amp;&amp;/g,"&amp;");t?this.label.append(ltrim(n(e.substr(0,t.index))," "),$$c("u",{"aria-hidden":"true"},t[3]),rtrim(n(e.substr(t.index+t[0].length))," ")):this.label.innerText=n(e).trim(),this.item&&this.item.setAttribute("aria-keyshortcuts",(i[1]?i[1]:i[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.getAction().class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.getAction().enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.getAction().checked;this.item.classList.toggle("checked",!!e),void 0!==e?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){if(!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`thin solid ${this.menuStyle.selectionBorderColor}`:"";this.item&&(this.item.style.color=t?t.toString():"",this.item.style.backgroundColor=i?i.toString():""),this.check&&(this.check.style.color=t?t.toString():""),this.container&&(this.container.style.border=n)}style(e){this.menuStyle=e,this.applyStyle()}}class SubmenuMenuActionViewItem extends BaseMenuActionViewItem{constructor(e,t,i,n){super(e,e,n),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new DisposableStore),this.mouseOver=!1,this.expandDirection=n&&void 0!==n.expandDirection?n.expandDirection:Direction.Right,this.showScheduler=new RunOnceScheduler((()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))}),250),this.hideScheduler=new RunOnceScheduler((()=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))}),750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=append$1(this.item,$$c("span.submenu-indicator"+Codicon.menuSubmenu.cssSelector)),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(addDisposableListener(this.element,EventType$1.KEY_UP,(e=>{let t=new StandardKeyboardEvent(e);(t.equals(17)||t.equals(3))&&(EventHelper.stop(e,!0),this.createSubmenu(!0))}))),this._register(addDisposableListener(this.element,EventType$1.KEY_DOWN,(e=>{let t=new StandardKeyboardEvent(e);getActiveElement()===this.item&&(t.equals(17)||t.equals(3))&&EventHelper.stop(e,!0)}))),this._register(addDisposableListener(this.element,EventType$1.MOUSE_OVER,(e=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())}))),this._register(addDisposableListener(this.element,EventType$1.MOUSE_LEAVE,(e=>{this.mouseOver=!1}))),this._register(addDisposableListener(this.element,EventType$1.FOCUS_OUT,(e=>{this.element&&!isAncestor$1(getActiveElement(),this.element)&&this.hideScheduler.schedule()}))),this._register(this.parentData.parent.onScroll((()=>{this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!1)}))))}updateEnabled(){}onClick(e){EventHelper.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch(t){}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const o={top:0,left:0};return o.left=layout(e.width,t.width,{position:n===Direction.Right?0:1,offset:i.left,size:i.width}),o.left>=i.left&&o.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(o.left=i.left+10),i.top+=10,i.height=0),o.top=layout(e.height,t.height,{position:0,offset:i.top,size:0}),o.top+t.height===i.top&&o.top+i.height+t.height<=e.height&&(o.top+=i.height),o}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=append$1(this.element,$$c("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Menu$1(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new EmptySubmenuAction],this.submenuOptions),this.menuStyle&&this.parentData.submenu.style(this.menuStyle);const n=this.element.getBoundingClientRect(),o={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},r=this.submenuContainer.getBoundingClientRect(),{top:s,left:a}=this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth,window.innerHeight),Dimension.lift(r),o,this.expandDirection);this.submenuContainer.style.left=a-r.left+"px",this.submenuContainer.style.top=s-r.top+"px",this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_UP,(e=>{new StandardKeyboardEvent(e).equals(15)&&(EventHelper.stop(e,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))}))),this.submenuDisposables.add(addDisposableListener(this.submenuContainer,EventType$1.KEY_DOWN,(e=>{new StandardKeyboardEvent(e).equals(15)&&EventHelper.stop(e,!0)}))),this.submenuDisposables.add(this.parentData.submenu.onDidCancel((()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)}))),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){var t;this.item&&(null===(t=this.item)||void 0===t||t.setAttribute("aria-expanded",e))}applyStyle(){if(super.applyStyle(),!this.menuStyle)return;const e=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=e?`${e}`:""),this.parentData.submenu&&this.parentData.submenu.style(this.menuStyle)}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class MenuSeparatorActionViewItem extends ActionViewItem{style(e){this.label&&(this.label.style.borderBottomColor=e.separatorColor?`${e.separatorColor}`:"")}}function cleanMnemonic(e){const t=MENU_MNEMONIC_REGEX,i=t.exec(e);if(!i)return e;const n=!i[1];return e.replace(t,n?"$2$3":"").trim()}function getMenuWidgetCSS(e,t){let i=`\n.monaco-menu {\n\tfont-size: 13px;\n\n}\n\n${formatRule(Codicon.menuSelection)}\n${formatRule(Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 = √φ */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\topacity: 0.4;\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid #bbb;\n\tpadding-top: 1px;\n\tmargin-left: .8em;\n\tmargin-right: .8em;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tpadding: 0.5em 0 0 0;\n\tmargin-bottom: 0.5em;\n\twidth: 100%;\n\theight: 0px !important;\n\tmargin-left: .8em !important;\n\tmargin-right: .8em !important;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tborder: thin solid transparent; /* prevents jumping behaviour on hover or focus */\n}\n\n\n/* High Contrast Theming */\n:host-context(.hc-black) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .5em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 1.8em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tpadding: 0.2em 0 0 0;\n\tmargin-bottom: 0.2em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}`;if(t){i+="\n\t\t\t/* Arrows */\n\t\t\t.monaco-scrollable-element > .scrollbar > .scra {\n\t\t\t\tcursor: pointer;\n\t\t\t\tfont-size: 11px !important;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .visible {\n\t\t\t\topacity: 1;\n\n\t\t\t\t/* Background rule added for IE9 - to allow clicks on dom node */\n\t\t\t\tbackground:rgba(0,0,0,0);\n\n\t\t\t\ttransition: opacity 100ms linear;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible {\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible.fade {\n\t\t\t\ttransition: opacity 800ms linear;\n\t\t\t}\n\n\t\t\t/* Scrollable Content Inset Shadow */\n\t\t\t.monaco-scrollable-element > .shadow {\n\t\t\t\tposition: absolute;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 3px;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 3px;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top-left-corner {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t";const t=e.scrollbarShadow;t&&(i+=`\n\t\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\t\tbox-shadow: ${t} 0 6px 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\t\tbox-shadow: ${t} 6px 0 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\t\tbox-shadow: ${t} 6px 6px 6px -6px inset;\n\t\t\t\t}\n\t\t\t`);const n=e.scrollbarSliderBackground;n&&(i+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\t\tbackground: ${n};\n\t\t\t\t}\n\t\t\t`);const o=e.scrollbarSliderHoverBackground;o&&(i+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\t\tbackground: ${o};\n\t\t\t\t}\n\t\t\t`);const r=e.scrollbarSliderActiveBackground;r&&(i+=`\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\t\tbackground: ${r};\n\t\t\t\t}\n\t\t\t`)}return i}var contextMenuHandler="";class ContextMenuHandler{constructor(e,t,i,n,o){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.themeService=o,this.focusToReturn=null,this.block=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;let i;this.focusToReturn=document.activeElement;let n=isHTMLElement(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:n=>{let o=e.getMenuClassName?e.getMenuClassName():"";o&&(n.className+=" "+o),this.options.blockMouse&&(this.block=n.appendChild($$c(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",addDisposableListener(this.block,EventType$1.MOUSE_DOWN,(e=>e.stopPropagation())));const r=new DisposableStore,s=e.actionRunner||new ActionRunner;return s.onBeforeRun(this.onActionRun,this,r),s.onDidRun(this.onDidActionRun,this,r),i=new Menu$1(n,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:s,getKeyBinding:e.getKeyBinding?e.getKeyBinding:e=>this.keybindingService.lookupKeybinding(e.id)}),r.add(attachMenuStyler(i,this.themeService)),i.onDidCancel((()=>this.contextViewService.hideContextView(!0)),null,r),i.onDidBlur((()=>this.contextViewService.hideContextView(!0)),null,r),r.add(addDisposableListener(window,EventType$1.BLUR,(()=>this.contextViewService.hideContextView(!0)))),r.add(addDisposableListener(window,EventType$1.MOUSE_DOWN,(e=>{if(e.defaultPrevented)return;let t=new StandardMouseEvent(e),i=t.target;if(!t.rightButton){for(;i;){if(i===n)return;i=i.parentElement}this.contextViewService.hideContextView(!0)}}))),combinedDisposable(r,i)},focus:()=>{i&&i.focus(!!e.autoSelectFirstItem)},onHide:t=>{e.onHide&&e.onHide(!!t),this.block&&(this.block.remove(),this.block=null),this.focusToReturn&&this.focusToReturn.focus()}},n,!!n)}onActionRun(e){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1),this.focusToReturn&&this.focusToReturn.focus()}onDidActionRun(e){e.error&&!isCancellationError(e.error)&&this.notificationService.error(e.error)}}var __decorate$c=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$b=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let ContextMenuService=class extends Disposable{constructor(e,t,i,n,o){super(),this._onDidShowContextMenu=new Emitter$1,this._onDidHideContextMenu=new Emitter$1,this.contextMenuHandler=new ContextMenuHandler(i,e,t,n,o)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},e),{onHide:t=>{e.onHide&&e.onHide(t),this._onDidHideContextMenu.fire()}})),ModifierKeyEmitter.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};var EditorOpenSource,EditorOpenSource2;ContextMenuService=__decorate$c([__param$b(0,ITelemetryService),__param$b(1,INotificationService),__param$b(2,IContextViewService),__param$b(3,IKeybindingService),__param$b(4,IThemeService)],ContextMenuService),EditorOpenSource2=EditorOpenSource||(EditorOpenSource={}),EditorOpenSource2[EditorOpenSource2.API=0]="API",EditorOpenSource2[EditorOpenSource2.USER=1]="USER";var __decorate$b=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$a=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$5=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let CommandOpener=class{constructor(e){this._commandService=e}open(e,t){return __awaiter$5(this,void 0,void 0,(function*(){if(!matchesScheme(e,Schemas.command))return!1;if(!(null==t?void 0:t.allowCommands))return!0;"string"==typeof e&&(e=URI.parse(e));let i=[];try{i=parse$1(decodeURIComponent(e.query))}catch(n){try{i=parse$1(e.query)}catch(o){}}return Array.isArray(i)||(i=[i]),yield this._commandService.executeCommand(e.path,...i),!0}))}};CommandOpener=__decorate$b([__param$a(0,ICommandService)],CommandOpener);let EditorOpener=class{constructor(e){this._editorService=e}open(e,t){return __awaiter$5(this,void 0,void 0,(function*(){"string"==typeof e&&(e=URI.parse(e));const{selection:i,uri:n}=extractSelection(e);return(e=n).scheme===Schemas.file&&(e=normalizePath(e)),yield this._editorService.openCodeEditor({resource:e,options:Object.assign({selection:i,source:(null==t?void 0:t.fromUserGesture)?EditorOpenSource.USER:EditorOpenSource.API},null==t?void 0:t.editorOptions)},this._editorService.getFocusedCodeEditor(),null==t?void 0:t.openToSide),!0}))}};EditorOpener=__decorate$b([__param$a(0,ICodeEditorService)],EditorOpener);let OpenerService=class{constructor(e,t){this._openers=new LinkedList,this._validators=new LinkedList,this._resolvers=new LinkedList,this._resolvedUriTargets=new ResourceMap((e=>e.with({path:null,fragment:null,query:null}).toString())),this._externalOpeners=new LinkedList,this._defaultExternalOpener={openExternal:e=>__awaiter$5(this,void 0,void 0,(function*(){return matchesSomeScheme(e,Schemas.http,Schemas.https)?windowOpenNoOpener(e):window.location.href=e,!0}))},this._openers.push({open:(e,t)=>__awaiter$5(this,void 0,void 0,(function*(){return!(!(null==t?void 0:t.openExternal)&&!matchesSomeScheme(e,Schemas.mailto,Schemas.http,Schemas.https,Schemas.vsls))&&(yield this._doOpenExternal(e,t),!0)}))}),this._openers.push(new CommandOpener(t)),this._openers.push(new EditorOpener(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}registerValidator(e){return{dispose:this._validators.push(e)}}registerExternalUriResolver(e){return{dispose:this._resolvers.push(e)}}setDefaultExternalOpener(e){this._defaultExternalOpener=e}registerExternalOpener(e){return{dispose:this._externalOpeners.push(e)}}open(e,t){var i;return __awaiter$5(this,void 0,void 0,(function*(){const n="string"==typeof e?URI.parse(e):e,o=null!==(i=this._resolvedUriTargets.get(n))&&void 0!==i?i:e;for(const e of this._validators)if(!(yield e.shouldOpen(o)))return!1;for(const i of this._openers){if(yield i.open(e,t))return!0}return!1}))}resolveExternalUri(e,t){return __awaiter$5(this,void 0,void 0,(function*(){for(const n of this._resolvers)try{const i=yield n.resolveExternalUri(e,t);if(i)return this._resolvedUriTargets.has(i.resolved)||this._resolvedUriTargets.set(i.resolved,e),i}catch(i){}throw new Error("Could not resolve external URI: "+e.toString())}))}_doOpenExternal(e,t){return __awaiter$5(this,void 0,void 0,(function*(){const i="string"==typeof e?URI.parse(e):e;let n,o;try{n=(yield this.resolveExternalUri(i,t)).resolved}catch(r){n=i}if(o="string"==typeof e&&i.toString()===n.toString()?e:encodeURI(n.toString(!0)),null==t?void 0:t.allowContributedOpeners){const e="string"==typeof(null==t?void 0:t.allowContributedOpeners)?null==t?void 0:t.allowContributedOpeners:void 0;for(const t of this._externalOpeners){if(yield t.openExternal(o,{sourceUri:i,preferredOpenerId:e},CancellationToken.None))return!0}}return this._defaultExternalOpener.openExternal(o,{sourceUri:i},CancellationToken.None)}))}dispose(){this._validators.clear()}};OpenerService=__decorate$b([__param$a(0,ICodeEditorService),__param$a(1,ICommandService)],OpenerService);var __decorate$a=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$9=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};class MarkerDecorations extends Disposable{constructor(e){super(),this.model=e,this._markersData=new Map,this._register(toDisposable((()=>{this.model.deltaDecorations([...this._markersData.keys()],[]),this._markersData.clear()})))}update(e,t){const i=[...this._markersData.keys()];this._markersData.clear();const n=this.model.deltaDecorations(i,t);for(let o=0;o<n.length;o++)this._markersData.set(n[o],e[o]);return 0!==i.length||0!==n.length}getMarker(e){return this._markersData.get(e.id)}}let MarkerDecorationsService=class extends Disposable{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new Emitter$1),this._markerDecorations=new ResourceMap,e.getModels().forEach((e=>this._onModelAdded(e))),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach((e=>e.dispose())),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach((e=>{const t=this._markerDecorations.get(e);t&&this._updateDecorations(t)}))}_onModelAdded(e){const t=new MarkerDecorations(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),e.uri.scheme!==Schemas.inMemory&&e.uri.scheme!==Schemas.internal&&e.uri.scheme!==Schemas.vscode||this._markerService&&this._markerService.read({resource:e.uri}).map((e=>e.owner)).forEach((t=>this._markerService.remove(t,[e.uri])))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500}),i=t.map((t=>({range:this._createDecorationRange(e.model,t),options:this._createDecorationOption(t)})));e.update(t,i)&&this._onDidChangeMarker.fire(e.model)}_createDecorationRange(e,t){let i=Range$2.lift(t);if(t.severity!==MarkerSeverity$2.Hint||this._hasMarkerTag(t,1)||this._hasMarkerTag(t,2)||(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const t=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(1===t||i.endColumn>=t)return i;const n=e.getWordAtPosition(i.getStartPosition());n&&(i=new Range$2(i.startLineNumber,n.startColumn,i.endLineNumber,n.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&1===t.startColumn&&i.startLineNumber===i.endLineNumber){let n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new Range$2(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,o,r;switch(e.severity){case MarkerSeverity$2.Hint:t=this._hasMarkerTag(e,2)?void 0:this._hasMarkerTag(e,1)?"squiggly-unnecessary":"squiggly-hint",n=0;break;case MarkerSeverity$2.Warning:t="squiggly-warning",i=themeColorFromId(overviewRulerWarning),n=20,r={color:themeColorFromId(minimapWarning),position:MinimapPosition$1.Inline};break;case MarkerSeverity$2.Info:t="squiggly-info",i=themeColorFromId(overviewRulerInfo),n=10;break;case MarkerSeverity$2.Error:default:t="squiggly-error",i=themeColorFromId(overviewRulerError),n=30,r={color:themeColorFromId(minimapError),position:MinimapPosition$1.Inline}}return e.tags&&(-1!==e.tags.indexOf(1)&&(o="squiggly-inline-unnecessary"),-1!==e.tags.indexOf(2)&&(o="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:OverviewRulerLane$1.Right},minimap:r,zIndex:n,inlineClassName:o}}_hasMarkerTag(e,t){return!!e.tags&&e.tags.indexOf(t)>=0}};MarkerDecorationsService=__decorate$a([__param$9(0,IModelService),__param$9(1,IMarkerService)],MarkerDecorationsService);var standaloneQuickInput="",button="";const defaultOptions={buttonBackground:Color.fromHex("#0E639C"),buttonHoverBackground:Color.fromHex("#006BB3"),buttonForeground:Color.white};class Button extends Disposable{constructor(e,t){super(),this._onDidClick=this._register(new Emitter$1),this.options=t||Object.create(null),mixin(this.options,defaultOptions,!1),this.buttonForeground=this.options.buttonForeground,this.buttonBackground=this.options.buttonBackground,this.buttonHoverBackground=this.options.buttonHoverBackground,this.buttonSecondaryForeground=this.options.buttonSecondaryForeground,this.buttonSecondaryBackground=this.options.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=this.options.buttonSecondaryHoverBackground,this.buttonBorder=this.options.buttonBorder,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),e.appendChild(this._element),this._register(Gesture.addTarget(this._element)),[EventType$1.CLICK,EventType.Tap].forEach((e=>{this._register(addDisposableListener(this._element,e,(e=>{this.enabled?this._onDidClick.fire(e):EventHelper.stop(e)})))})),this._register(addDisposableListener(this._element,EventType$1.KEY_DOWN,(e=>{const t=new StandardKeyboardEvent(e);let i=!1;this.enabled&&(t.equals(3)||t.equals(10))?(this._onDidClick.fire(e),i=!0):t.equals(9)&&(this._element.blur(),i=!0),i&&EventHelper.stop(t,!0)}))),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OVER,(e=>{this._element.classList.contains("disabled")||this.setHoverBackground()}))),this._register(addDisposableListener(this._element,EventType$1.MOUSE_OUT,(e=>{this.applyStyles()}))),this.focusTracker=this._register(trackFocus(this._element)),this._register(this.focusTracker.onDidFocus((()=>this.setHoverBackground()))),this._register(this.focusTracker.onDidBlur((()=>this.applyStyles()))),this.applyStyles()}get onDidClick(){return this._onDidClick.event}setHoverBackground(){let e;e=this.options.secondary?this.buttonSecondaryHoverBackground?this.buttonSecondaryHoverBackground.toString():null:this.buttonHoverBackground?this.buttonHoverBackground.toString():null,e&&(this._element.style.backgroundColor=e)}style(e){this.buttonForeground=e.buttonForeground,this.buttonBackground=e.buttonBackground,this.buttonHoverBackground=e.buttonHoverBackground,this.buttonSecondaryForeground=e.buttonSecondaryForeground,this.buttonSecondaryBackground=e.buttonSecondaryBackground,this.buttonSecondaryHoverBackground=e.buttonSecondaryHoverBackground,this.buttonBorder=e.buttonBorder,this.applyStyles()}applyStyles(){if(this._element){let e,t;this.options.secondary?(t=this.buttonSecondaryForeground?this.buttonSecondaryForeground.toString():"",e=this.buttonSecondaryBackground?this.buttonSecondaryBackground.toString():""):(t=this.buttonForeground?this.buttonForeground.toString():"",e=this.buttonBackground?this.buttonBackground.toString():"");const i=this.buttonBorder?this.buttonBorder.toString():"";this._element.style.color=t,this._element.style.backgroundColor=e,this._element.style.borderWidth=i?"1px":"",this._element.style.borderStyle=i?"solid":"",this._element.style.borderColor=i}}get element(){return this._element}set label(e){this._element.classList.add("monaco-text-button"),this.options.supportIcons?reset(this._element,...renderLabelWithIcons(e)):this._element.textContent=e,"string"==typeof this.options.title?this._element.title=this.options.title:this.options.title&&(this._element.title=e)}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}}var progressbar="";const CSS_DONE="done",CSS_ACTIVE="active",CSS_INFINITE="infinite",CSS_INFINITE_LONG_RUNNING="infinite-long-running",CSS_DISCRETE="discrete",defaultOpts={progressBarBackground:Color.fromHex("#0E70C0")};class ProgressBar extends Disposable{constructor(e,t){super(),this.options=t||Object.create(null),mixin(this.options,defaultOpts,!1),this.workedVal=0,this.progressBarBackground=this.options.progressBarBackground,this.showDelayedScheduler=this._register(new RunOnceScheduler((()=>show(this.element)),0)),this.longRunningScheduler=this._register(new RunOnceScheduler((()=>this.infiniteLongRunning()),ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e)}create(e){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.element.appendChild(this.bit),this.applyStyles()}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(CSS_ACTIVE,CSS_INFINITE,CSS_INFINITE_LONG_RUNNING,CSS_DISCRETE),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(CSS_DONE),this.element.classList.contains(CSS_INFINITE)?(this.bit.style.opacity="0",e?setTimeout((()=>this.off()),200):this.off()):(this.bit.style.width="inherit",e?setTimeout((()=>this.off()),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(CSS_DISCRETE,CSS_DONE,CSS_INFINITE_LONG_RUNNING),this.element.classList.add(CSS_ACTIVE,CSS_INFINITE),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(CSS_INFINITE_LONG_RUNNING)}getContainer(){return this.element}style(e){this.progressBarBackground=e.progressBarBackground,this.applyStyles()}applyStyles(){if(this.bit){const e=this.progressBarBackground?this.progressBarBackground.toString():"";this.bit.style.backgroundColor=e}}}ProgressBar.LONG_RUNNING_INFINITE_THRESHOLD=1e4;var quickInput="";const iconPathToClass={},iconClassGenerator=new IdGenerator("quick-input-button-icon-");function getIconClass(e){if(!e)return;let t;const i=e.dark.toString();return iconPathToClass[i]?t=iconPathToClass[i]:(t=iconClassGenerator.nextId(),createCSSRule(`.${t}`,`background-image: ${asCSSUrl(e.light||e.dark)}`),createCSSRule(`.vs-dark .${t}, .hc-black .${t}`,`background-image: ${asCSSUrl(e.dark)}`),iconPathToClass[i]=t),t}const $$3=$$c;class QuickInputBox extends Disposable{constructor(e){super(),this.parent=e,this.onKeyDown=e=>addDisposableListener(this.inputBox.inputElement,EventType$1.KEY_DOWN,(t=>{e(new StandardKeyboardEvent(t))})),this.onMouseDown=e=>addDisposableListener(this.inputBox.inputElement,EventType$1.MOUSE_DOWN,(t=>{e(new StandardMouseEvent(t))})),this.onDidChange=e=>this.inputBox.onDidChange(e),this.container=append$1(this.parent,$$3(".quick-input-box")),this.inputBox=this._register(new InputBox(this.container,void 0))}get value(){return this.inputBox.value}set value(e){this.inputBox.value=e}select(e=null){this.inputBox.select(e)}isSelectionAtEnd(){return this.inputBox.isSelectionAtEnd()}get placeholder(){return this.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.inputBox.setPlaceHolder(e)}get ariaLabel(){return this.inputBox.getAriaLabel()}set ariaLabel(e){this.inputBox.setAriaLabel(e)}get password(){return"password"===this.inputBox.inputElement.type}set password(e){this.inputBox.inputElement.type=e?"password":"text"}setAttribute(e,t){this.inputBox.inputElement.setAttribute(e,t)}removeAttribute(e){this.inputBox.inputElement.removeAttribute(e)}showDecoration(e){e===Severity$2.Ignore?this.inputBox.hideMessage():this.inputBox.showMessage({type:e===Severity$2.Info?1:e===Severity$2.Warning?2:3,content:""})}stylesForType(e){return this.inputBox.stylesForType(e===Severity$2.Info?1:e===Severity$2.Warning?2:3)}setFocus(){this.inputBox.focus()}layout(){this.inputBox.layout()}style(e){this.inputBox.style(e)}}var keybindingLabel="";const $$2=$$c;class KeybindingLabel{constructor(e,t,i){this.os=t,this.keyElements=new Set,this.options=i||Object.create(null),this.labelBackground=this.options.keybindingLabelBackground,this.labelForeground=this.options.keybindingLabelForeground,this.labelBorder=this.options.keybindingLabelBorder,this.labelBottomBorder=this.options.keybindingLabelBottomBorder,this.labelShadow=this.options.keybindingLabelShadow,this.domNode=append$1(e,$$2(".monaco-keybinding")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&KeybindingLabel.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){let[e,t]=this.keybinding.getParts();e&&this.renderPart(this.domNode,e,this.matches?this.matches.firstPart:null),t&&(append$1(this.domNode,$$2("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderPart(this.domNode,t,this.matches?this.matches.chordPart:null)),this.domNode.title=this.keybinding.getAriaLabel()||""}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.applyStyles(),this.didEverRender=!0}clear(){clearNode(this.domNode),this.keyElements.clear()}renderPart(e,t,i){const n=UILabelProvider.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,Boolean(null==i?void 0:i.ctrlKey),n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,Boolean(null==i?void 0:i.shiftKey),n.separator),t.altKey&&this.renderKey(e,n.altKey,Boolean(null==i?void 0:i.altKey),n.separator),t.metaKey&&this.renderKey(e,n.metaKey,Boolean(null==i?void 0:i.metaKey),n.separator);const o=t.keyLabel;o&&this.renderKey(e,o,Boolean(null==i?void 0:i.keyCode),"")}renderKey(e,t,i,n){append$1(e,this.createKeyElement(t,i?".highlight":"")),n&&append$1(e,$$2("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){append$1(e,this.createKeyElement(localize("unbound","Unbound")))}createKeyElement(e,t=""){const i=$$2("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),i}style(e){this.labelBackground=e.keybindingLabelBackground,this.labelForeground=e.keybindingLabelForeground,this.labelBorder=e.keybindingLabelBorder,this.labelBottomBorder=e.keybindingLabelBottomBorder,this.labelShadow=e.keybindingLabelShadow,this.applyStyles()}applyStyles(){var e;if(this.element){for(const t of this.keyElements)this.labelBackground&&(t.style.backgroundColor=null===(e=this.labelBackground)||void 0===e?void 0:e.toString()),this.labelBorder&&(t.style.borderColor=this.labelBorder.toString()),this.labelBottomBorder&&(t.style.borderBottomColor=this.labelBottomBorder.toString()),this.labelShadow&&(t.style.boxShadow=`inset 0 -1px 0 ${this.labelShadow}`);this.labelForeground&&(this.element.style.color=this.labelForeground.toString())}}static areSame(e,t){return e===t||!e&&!t||!!e&&!!t&&equals(e.firstPart,t.firstPart)&&equals(e.chordPart,t.chordPart)}}const intlFileNameCollatorBaseNumeric=new IdleValue((()=>{const e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}));function compareFileNames(e,t,i=!1){const n=e||"",o=t||"",r=intlFileNameCollatorBaseNumeric.value.collator.compare(n,o);return intlFileNameCollatorBaseNumeric.value.collatorIsNumeric&&0===r&&n!==o?n<o?-1:1:r}function compareAnything(e,t,i){const n=e.toLowerCase(),o=t.toLowerCase(),r=compareByPrefix(e,t,i);if(r)return r;const s=n.endsWith(i);if(s!==o.endsWith(i))return s?-1:1;const a=compareFileNames(n,o);return 0!==a?a:n.localeCompare(o)}function compareByPrefix(e,t,i){const n=e.toLowerCase(),o=t.toLowerCase(),r=n.startsWith(i),s=o.startsWith(i);if(r!==s)return r?-1:1;if(r&&s){if(n.length<o.length)return-1;if(n.length>o.length)return 1}return 0}new IdleValue((()=>({collator:new Intl.Collator(void 0,{numeric:!0})}))),new IdleValue((()=>({collator:new Intl.Collator(void 0,{numeric:!0,sensitivity:"accent"})})));var __decorate$9=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__awaiter$4=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const $$1=$$c;class ListElement{constructor(e){this.hidden=!1,this._onChecked=new Emitter$1,this.onChecked=this._onChecked.event,Object.assign(this,e)}get checked(){return!!this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire(e))}dispose(){this._onChecked.dispose()}}class ListElementRenderer{get templateId(){return ListElementRenderer.ID}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=[],t.toDisposeTemplate=[],t.entry=append$1(e,$$1(".quick-input-list-entry"));const i=append$1(t.entry,$$1("label.quick-input-list-label"));t.toDisposeTemplate.push(addStandardDisposableListener(i,EventType$1.CLICK,(e=>{t.checkbox.offsetParent||e.preventDefault()}))),t.checkbox=append$1(i,$$1("input.quick-input-list-checkbox")),t.checkbox.type="checkbox",t.toDisposeTemplate.push(addStandardDisposableListener(t.checkbox,EventType$1.CHANGE,(e=>{t.element.checked=t.checkbox.checked})));const n=append$1(i,$$1(".quick-input-list-rows")),o=append$1(n,$$1(".quick-input-list-row")),r=append$1(n,$$1(".quick-input-list-row"));t.label=new IconLabel(o,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0});const s=append$1(o,$$1(".quick-input-list-entry-keybinding"));t.keybinding=new KeybindingLabel(s,OS);const a=append$1(r,$$1(".quick-input-list-label-meta"));return t.detail=new IconLabel(a,{supportHighlights:!0,supportIcons:!0}),t.separator=append$1(t.entry,$$1(".quick-input-list-separator")),t.actionBar=new ActionBar(t.entry),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.push(t.actionBar),t}renderElement(e,t,i){i.toDisposeElement=dispose(i.toDisposeElement),i.element=e,i.checkbox.checked=e.checked,i.toDisposeElement.push(e.onChecked((e=>i.checkbox.checked=e)));const{labelHighlights:n,descriptionHighlights:o,detailHighlights:r}=e,s=Object.create(null);s.matches=n||[],s.descriptionTitle=e.saneDescription,s.descriptionMatches=o||[],s.extraClasses=e.item.iconClasses,s.italic=e.item.italic,s.strikethrough=e.item.strikethrough,i.label.setLabel(e.saneLabel,e.saneDescription,s),i.keybinding.set(e.item.keybinding),e.saneDetail&&i.detail.setLabel(e.saneDetail,void 0,{matches:r,title:e.saneDetail}),e.separator&&e.separator.label?(i.separator.textContent=e.separator.label,i.separator.style.display=""):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!e.separator),i.actionBar.clear();const a=e.item.buttons;a&&a.length?(i.actionBar.push(a.map(((t,i)=>{let n=t.iconClass||(t.iconPath?getIconClass(t.iconPath):void 0);t.alwaysVisible&&(n=n?`${n} always-visible`:"always-visible");const o=new Action(`id-${i}`,"",n,!0,(()=>__awaiter$4(this,void 0,void 0,(function*(){e.fireButtonTriggered({button:t,item:e.item})}))));return o.tooltip=t.tooltip||"",o})),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){i.toDisposeElement=dispose(i.toDisposeElement)}disposeTemplate(e){e.toDisposeElement=dispose(e.toDisposeElement),e.toDisposeTemplate=dispose(e.toDisposeTemplate)}}ListElementRenderer.ID="listelement";class ListElementDelegate{getHeight(e){return e.saneDetail?44:22}getTemplateId(e){return ListElementRenderer.ID}}var QuickInputListFocus,QuickInputListFocus2;QuickInputListFocus2=QuickInputListFocus||(QuickInputListFocus={}),QuickInputListFocus2[QuickInputListFocus2.First=1]="First",QuickInputListFocus2[QuickInputListFocus2.Second=2]="Second",QuickInputListFocus2[QuickInputListFocus2.Last=3]="Last",QuickInputListFocus2[QuickInputListFocus2.Next=4]="Next",QuickInputListFocus2[QuickInputListFocus2.Previous=5]="Previous",QuickInputListFocus2[QuickInputListFocus2.NextPage=6]="NextPage",QuickInputListFocus2[QuickInputListFocus2.PreviousPage=7]="PreviousPage";class QuickInputList{constructor(e,t,i){this.parent=e,this.inputElements=[],this.elements=[],this.elementsToIndexes=new Map,this.matchOnDescription=!1,this.matchOnDetail=!1,this.matchOnLabel=!0,this.matchOnMeta=!0,this.sortByLabel=!0,this._onChangedAllVisibleChecked=new Emitter$1,this.onChangedAllVisibleChecked=this._onChangedAllVisibleChecked.event,this._onChangedCheckedCount=new Emitter$1,this.onChangedCheckedCount=this._onChangedCheckedCount.event,this._onChangedVisibleCount=new Emitter$1,this.onChangedVisibleCount=this._onChangedVisibleCount.event,this._onChangedCheckedElements=new Emitter$1,this.onChangedCheckedElements=this._onChangedCheckedElements.event,this._onButtonTriggered=new Emitter$1,this.onButtonTriggered=this._onButtonTriggered.event,this._onKeyDown=new Emitter$1,this.onKeyDown=this._onKeyDown.event,this._onLeave=new Emitter$1,this.onLeave=this._onLeave.event,this._fireCheckedEvents=!0,this.elementDisposables=[],this.disposables=[],this.id=t,this.container=append$1(this.parent,$$1(".quick-input-list"));const n=new ListElementDelegate,o=new QuickInputAccessibilityProvider;this.list=i.createList("QuickInput",this.container,n,[new ListElementRenderer],{identityProvider:{getId:e=>e.saneLabel},setRowLineHeight:!1,multipleSelectionSupport:!1,horizontalScrolling:!1,accessibilityProvider:o}),this.list.getHTMLElement().id=t,this.disposables.push(this.list),this.disposables.push(this.list.onKeyDown((e=>{const t=new StandardKeyboardEvent(e);switch(t.keyCode){case 10:this.toggleCheckbox();break;case 31:(isMacintosh?e.metaKey:e.ctrlKey)&&this.list.setFocus(range(this.list.length));break;case 16:{const e=this.list.getFocus();1===e.length&&0===e[0]&&this._onLeave.fire();break}case 18:{const e=this.list.getFocus();1===e.length&&e[0]===this.list.length-1&&this._onLeave.fire();break}}this._onKeyDown.fire(t)}))),this.disposables.push(this.list.onMouseDown((e=>{2!==e.browserEvent.button&&e.browserEvent.preventDefault()}))),this.disposables.push(addDisposableListener(this.container,EventType$1.CLICK,(e=>{(e.x||e.y)&&this._onLeave.fire()}))),this.disposables.push(this.list.onMouseMiddleClick((e=>{this._onLeave.fire()}))),this.disposables.push(this.list.onContextMenu((e=>{"number"==typeof e.index&&(e.browserEvent.preventDefault(),this.list.setSelection([e.index]))}))),this.disposables.push(this._onChangedAllVisibleChecked,this._onChangedCheckedCount,this._onChangedVisibleCount,this._onChangedCheckedElements,this._onButtonTriggered,this._onLeave,this._onKeyDown)}get onDidChangeFocus(){return Event$1.map(this.list.onDidChangeFocus,(e=>e.elements.map((e=>e.item))))}get onDidChangeSelection(){return Event$1.map(this.list.onDidChangeSelection,(e=>({items:e.elements.map((e=>e.item)),event:e.browserEvent})))}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}getAllVisibleChecked(){return this.allVisibleChecked(this.elements,!1)}allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const n=e[i];if(!n.hidden){if(!n.checked)return!1;t=!0}}return t}getCheckedCount(){let e=0;const t=this.elements;for(let i=0,n=t.length;i<n;i++)t[i].checked&&e++;return e}getVisibleCount(){let e=0;const t=this.elements;for(let i=0,n=t.length;i<n;i++)t[i].hidden||e++;return e}setAllVisibleChecked(e){try{this._fireCheckedEvents=!1,this.elements.forEach((t=>{t.hidden||(t.checked=e)}))}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}setElements(e){this.elementDisposables=dispose(this.elementDisposables);const t=e=>this.fireButtonTriggered(e);this.inputElements=e,this.elements=e.reduce(((i,n,o)=>{var r,s,a;if("separator"!==n.type){const l=o&&e[o-1],d=n.label&&n.label.replace(/\r?\n/g," "),c=n.meta&&n.meta.replace(/\r?\n/g," "),h=n.description&&n.description.replace(/\r?\n/g," "),u=n.detail&&n.detail.replace(/\r?\n/g," "),g=n.ariaLabel||[d,h,u].map((e=>getCodiconAriaLabel(e))).filter((e=>!!e)).join(", "),p=this.parent.classList.contains("show-checkboxes");i.push(new ListElement({hasCheckbox:p,index:o,item:n,saneLabel:d,saneMeta:c,saneAriaLabel:g,saneDescription:h,saneDetail:u,labelHighlights:null===(r=n.highlights)||void 0===r?void 0:r.label,descriptionHighlights:null===(s=n.highlights)||void 0===s?void 0:s.description,detailHighlights:null===(a=n.highlights)||void 0===a?void 0:a.detail,checked:!1,separator:l&&"separator"===l.type?l:void 0,fireButtonTriggered:t}))}return i}),[]),this.elementDisposables.push(...this.elements),this.elementDisposables.push(...this.elements.map((e=>e.onChecked((()=>this.fireCheckedEvents()))))),this.elementsToIndexes=this.elements.reduce(((e,t,i)=>(e.set(t.item,i),e)),new Map),this.list.splice(0,this.list.length),this.list.splice(0,this.list.length,this.elements),this._onChangedVisibleCount.fire(this.elements.length)}getFocusedElements(){return this.list.getFocusedElements().map((e=>e.item))}setFocusedElements(e){if(this.list.setFocus(e.filter((e=>this.elementsToIndexes.has(e))).map((e=>this.elementsToIndexes.get(e)))),e.length>0){const e=this.list.getFocus()[0];"number"==typeof e&&this.list.reveal(e)}}getActiveDescendant(){return this.list.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){this.list.setSelection(e.filter((e=>this.elementsToIndexes.has(e))).map((e=>this.elementsToIndexes.get(e))))}getCheckedElements(){return this.elements.filter((e=>e.checked)).map((e=>e.item))}setCheckedElements(e){try{this._fireCheckedEvents=!1;const t=new Set;for(const i of e)t.add(i);for(const e of this.elements)e.checked=t.has(e.item)}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}set enabled(e){this.list.getHTMLElement().style.pointerEvents=e?"":"none"}focus(e){if(!this.list.length)return;switch(e===QuickInputListFocus.Next&&this.list.getFocus()[0]===this.list.length-1&&(e=QuickInputListFocus.First),e===QuickInputListFocus.Previous&&0===this.list.getFocus()[0]&&(e=QuickInputListFocus.Last),e===QuickInputListFocus.Second&&this.list.length<2&&(e=QuickInputListFocus.First),e){case QuickInputListFocus.First:this.list.focusFirst();break;case QuickInputListFocus.Second:this.list.focusNth(1);break;case QuickInputListFocus.Last:this.list.focusLast();break;case QuickInputListFocus.Next:this.list.focusNext();break;case QuickInputListFocus.Previous:this.list.focusPrevious();break;case QuickInputListFocus.NextPage:this.list.focusNextPage();break;case QuickInputListFocus.PreviousPage:this.list.focusPreviousPage()}const t=this.list.getFocus()[0];"number"==typeof t&&this.list.reveal(t)}clearFocus(){this.list.setFocus([])}domFocus(){this.list.domFocus()}layout(e){this.list.getHTMLElement().style.maxHeight=e?`calc(${44*Math.floor(e/44)}px)`:"",this.list.layout()}filter(e){if(!(this.sortByLabel||this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))return this.list.layout(),!1;if((e=e.trim())&&(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail)){let t;this.elements.forEach((i=>{const n=this.matchOnLabel?withNullAsUndefined(matchesFuzzyIconAware(e,parseLabelWithIcons(i.saneLabel))):void 0,o=this.matchOnDescription?withNullAsUndefined(matchesFuzzyIconAware(e,parseLabelWithIcons(i.saneDescription||""))):void 0,r=this.matchOnDetail?withNullAsUndefined(matchesFuzzyIconAware(e,parseLabelWithIcons(i.saneDetail||""))):void 0,s=this.matchOnMeta?withNullAsUndefined(matchesFuzzyIconAware(e,parseLabelWithIcons(i.saneMeta||""))):void 0;if(n||o||r||s?(i.labelHighlights=n,i.descriptionHighlights=o,i.detailHighlights=r,i.hidden=!1):(i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!i.item.alwaysShow),i.separator=void 0,!this.sortByLabel){const e=i.index&&this.inputElements[i.index-1];t=e&&"separator"===e.type?e:t,t&&!i.hidden&&(i.separator=t,t=void 0)}}))}else this.elements.forEach((e=>{e.labelHighlights=void 0,e.descriptionHighlights=void 0,e.detailHighlights=void 0,e.hidden=!1;const t=e.index&&this.inputElements[e.index-1];e.separator=t&&"separator"===t.type?t:void 0}));const t=this.elements.filter((e=>!e.hidden));if(this.sortByLabel&&e){const i=e.toLowerCase();t.sort(((e,t)=>compareEntries(e,t,i)))}return this.elementsToIndexes=t.reduce(((e,t,i)=>(e.set(t.item,i),e)),new Map),this.list.splice(0,this.list.length,t),this.list.setFocus([]),this.list.layout(),this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedVisibleCount.fire(t.length),!0}toggleCheckbox(){try{this._fireCheckedEvents=!1;const e=this.list.getFocusedElements(),t=this.allVisibleChecked(e);for(const i of e)i.checked=!t}finally{this._fireCheckedEvents=!0,this.fireCheckedEvents()}}display(e){this.container.style.display=e?"":"none"}isDisplayed(){return"none"!==this.container.style.display}dispose(){this.elementDisposables=dispose(this.elementDisposables),this.disposables=dispose(this.disposables)}fireCheckedEvents(){this._fireCheckedEvents&&(this._onChangedAllVisibleChecked.fire(this.getAllVisibleChecked()),this._onChangedCheckedCount.fire(this.getCheckedCount()),this._onChangedCheckedElements.fire(this.getCheckedElements()))}fireButtonTriggered(e){this._onButtonTriggered.fire(e)}style(e){this.list.style(e)}}function compareEntries(e,t,i){const n=e.labelHighlights||[],o=t.labelHighlights||[];return n.length&&!o.length?-1:!n.length&&o.length?1:0===n.length&&0===o.length?0:compareAnything(e.saneLabel,t.saneLabel,i)}__decorate$9([memoize],QuickInputList.prototype,"onDidChangeFocus",null),__decorate$9([memoize],QuickInputList.prototype,"onDidChangeSelection",null);class QuickInputAccessibilityProvider{getWidgetAriaLabel(){return localize("quickInput","Quick Input")}getAriaLabel(e){return e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(e.hasCheckbox)return{value:e.checked,onDidChange:e.onChecked}}}var __awaiter$3=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const $=$$c,backButton={iconClass:Codicon.quickInputBack.classNames,tooltip:localize("quickInput.back","Back"),handle:-1};class QuickInput extends Disposable{constructor(e){super(),this.ui=e,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._buttons=[],this.noValidationMessage=QuickInput.noPromptMessage,this._severity=Severity$2.Ignore,this.buttonsUpdated=!1,this.onDidTriggerButtonEmitter=this._register(new Emitter$1),this.onDidHideEmitter=this._register(new Emitter$1),this.onDisposeEmitter=this._register(new Emitter$1),this.visibleDisposables=this._register(new DisposableStore),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!isIOS;this._ignoreFocusOut=e&&!isIOS,t&&this.update()}get buttons(){return this._buttons}set buttons(e){this._buttons=e,this.buttonsUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton((e=>{-1!==this.buttons.indexOf(e)&&this.onDidTriggerButtonEmitter.fire(e)}))),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=QuickInputHideReason.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:e||"&nbsp;"===this.ui.title.innerHTML||(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this.busy&&!this.busyDelay&&(this.busyDelay=new TimeoutTimer,this.busyDelay.setIfNotSet((()=>{this.visible&&this.ui.progressBar.infinite()}),800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const e=this.buttons.filter((e=>e===backButton));this.ui.leftActionBar.push(e.map(((e,t)=>{const i=new Action(`id-${t}`,"",e.iconClass||getIconClass(e.iconPath),!0,(()=>__awaiter$3(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(e)}))));return i.tooltip=e.tooltip||"",i})),{icon:!0,label:!1}),this.ui.rightActionBar.clear();const t=this.buttons.filter((e=>e!==backButton));this.ui.rightActionBar.push(t.map(((e,t)=>{const i=new Action(`id-${t}`,"",e.iconClass||getIconClass(e.iconPath),!0,(()=>__awaiter$3(this,void 0,void 0,(function*(){this.onDidTriggerButtonEmitter.fire(e)}))));return i.tooltip=e.tooltip||"",i})),{icon:!0,label:!1})}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,reset(this.ui.message,...renderLabelWithIcons(i))),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?localize("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==Severity$2.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}}QuickInput.noPromptMessage=localize("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");class QuickPick extends QuickInput{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new Emitter$1),this.onWillAcceptEmitter=this._register(new Emitter$1),this.onDidAcceptEmitter=this._register(new Emitter$1),this.onDidCustomEmitter=this._register(new Emitter$1),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._sortByLabel=!0,this._autoFocusOnList=!0,this._keepScrollPosition=!1,this._itemActivation=this.ui.isScreenReaderOptimized()?ItemActivation.NONE:ItemActivation.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new Emitter$1),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new Emitter$1),this.onDidTriggerItemButtonEmitter=this._register(new Emitter$1),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){if(this._value!==e){if(this._value=e,t||this.update(),this.visible){this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst()}this.onDidChangeValueEmitter.fire(this._value)}}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get autoFocusOnList(){return this._autoFocusOnList}set autoFocusOnList(e){this._autoFocusOnList=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?NO_KEY_MODS:this.ui.keyMods}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.autoFocusOnList&&(this.canSelectMany||this.ui.list.focus(QuickInputListFocus.First))}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange((e=>{this.doSetValue(e,!0)}))),this.visibleDisposables.add(this.ui.inputBox.onMouseDown((e=>{this.autoFocusOnList||this.ui.list.clearFocus()}))),this.visibleDisposables.add((this._hideInput?this.ui.list:this.ui.inputBox).onKeyDown((e=>{switch(e.keyCode){case 18:this.ui.list.focus(QuickInputListFocus.Next),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(e,!0);break;case 16:this.ui.list.getFocusedElements().length?this.ui.list.focus(QuickInputListFocus.Previous):this.ui.list.focus(QuickInputListFocus.Last),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(e,!0);break;case 12:this.ui.list.focus(QuickInputListFocus.NextPage),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(e,!0);break;case 11:this.ui.list.focus(QuickInputListFocus.PreviousPage),this.canSelectMany&&this.ui.list.domFocus(),EventHelper.stop(e,!0);break;case 17:if(!this._canAcceptInBackground)return;if(!this.ui.inputBox.isSelectionAtEnd())return;this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!0));break;case 14:!e.ctrlKey&&!e.metaKey||e.shiftKey||e.altKey||(this.ui.list.focus(QuickInputListFocus.First),EventHelper.stop(e,!0));break;case 13:!e.ctrlKey&&!e.metaKey||e.shiftKey||e.altKey||(this.ui.list.focus(QuickInputListFocus.Last),EventHelper.stop(e,!0))}}))),this.visibleDisposables.add(this.ui.onDidAccept((()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)}))),this.visibleDisposables.add(this.ui.onDidCustom((()=>{this.onDidCustomEmitter.fire()}))),this.visibleDisposables.add(this.ui.list.onDidChangeFocus((e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&equals$1(e,this._activeItems,((e,t)=>e===t))||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))}))),this.visibleDisposables.add(this.ui.list.onDidChangeSelection((({items:e,event:t})=>{this.canSelectMany?e.length&&this.ui.list.setSelectedElements([]):this.selectedItemsToConfirm!==this._selectedItems&&equals$1(e,this._selectedItems,((e,t)=>e===t))||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(t instanceof MouseEvent&&1===t.button))}))),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements((e=>{this.canSelectMany&&(this.selectedItemsToConfirm!==this._selectedItems&&equals$1(e,this._selectedItems,((e,t)=>e===t))||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e)))}))),this.visibleDisposables.add(this.ui.list.onButtonTriggered((e=>this.onDidTriggerItemButtonEmitter.fire(e)))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return addDisposableListener(this.ui.container,EventType$1.KEY_UP,(e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new StandardKeyboardEvent(e),i=t.keyCode;this._quickNavigate.keybindings.some((e=>{const[n,o]=e.getParts();return!o&&(n.shiftKey&&4===i?!(t.ctrlKey||t.altKey||t.metaKey):!(!n.altKey||6!==i)||(!(!n.ctrlKey||5!==i)||!(!n.metaKey||57!==i)))}))&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)}))}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this._hideInput&&this._items.length>0;this.ui.container.classList.toggle("hidden-input",t&&!this.description);const i={title:!!this.title||!!this.step||!!this.buttons.length,description:!!this.description,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!t,progressBar:!t,visibleCount:!0,count:this.canSelectMany,ok:"default"===this.ok?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");const n=this.ariaLabel||this.placeholder||QuickPick.DEFAULT_ARIA_LABEL;if(this.ui.inputBox.ariaLabel!==n&&(this.ui.inputBox.ariaLabel=n),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated)switch(this.itemsUpdated=!1,this.ui.list.setElements(this.items),this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this.ui.checkAll.checked=this.ui.list.getAllVisibleChecked(),this.ui.visibleCount.setCount(this.ui.list.getVisibleCount()),this.ui.count.setCount(this.ui.list.getCheckedCount()),this._itemActivation){case ItemActivation.NONE:this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.SECOND:this.ui.list.focus(QuickInputListFocus.Second),this._itemActivation=ItemActivation.FIRST;break;case ItemActivation.LAST:this.ui.list.focus(QuickInputListFocus.Last),this._itemActivation=ItemActivation.FIRST;break;default:this.trySelectFirst()}this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",this.ui.setComboboxAccessibility(!0),i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(QuickInputListFocus.First)),this.keepScrollPosition&&(this.scrollTop=e)}}QuickPick.DEFAULT_ARIA_LABEL=localize("quickInputBox.ariaLabel","Type to narrow down results.");class QuickInputController extends Disposable{constructor(e){super(),this.options=e,this.comboboxAccessibility=!1,this.enabled=!0,this.onDidAcceptEmitter=this._register(new Emitter$1),this.onDidCustomEmitter=this._register(new Emitter$1),this.onDidTriggerButtonEmitter=this._register(new Emitter$1),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new Emitter$1),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new Emitter$1),this.onHide=this.onHideEmitter.event,this.idPrefix=e.idPrefix,this.parentElement=e.container,this.styles=e.styles,this.registerKeyModsListeners()}registerKeyModsListeners(){const e=e=>{this.keyMods.ctrlCmd=e.ctrlKey||e.metaKey,this.keyMods.alt=e.altKey};this._register(addDisposableListener(window,EventType$1.KEY_DOWN,e,!0)),this._register(addDisposableListener(window,EventType$1.KEY_UP,e,!0)),this._register(addDisposableListener(window,EventType$1.MOUSE_DOWN,e,!0))}getUI(){if(this.ui)return this.ui;const e=append$1(this.parentElement,$(".quick-input-widget.show-file-icons"));e.tabIndex=-1,e.style.display="none";const t=createStyleSheet(e),i=append$1(e,$(".quick-input-titlebar")),n=this._register(new ActionBar(i));n.domNode.classList.add("quick-input-left-action-bar");const o=append$1(i,$(".quick-input-title")),r=this._register(new ActionBar(i));r.domNode.classList.add("quick-input-right-action-bar");const s=append$1(e,$(".quick-input-description")),a=append$1(e,$(".quick-input-header")),l=append$1(a,$("input.quick-input-check-all"));l.type="checkbox",this._register(addStandardDisposableListener(l,EventType$1.CHANGE,(e=>{const t=l.checked;y.setAllVisibleChecked(t)}))),this._register(addDisposableListener(l,EventType$1.CLICK,(e=>{(e.x||e.y)&&u.setFocus()})));const d=append$1(a,$(".quick-input-description")),c=append$1(a,$(".quick-input-and-message")),h=append$1(c,$(".quick-input-filter")),u=this._register(new QuickInputBox(h));u.setAttribute("aria-describedby",`${this.idPrefix}message`);const g=append$1(h,$(".quick-input-visible-count"));g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true");const p=new CountBadge(g,{countFormat:localize({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")}),m=append$1(h,$(".quick-input-count"));m.setAttribute("aria-live","polite");const f=new CountBadge(m,{countFormat:localize({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")}),_=append$1(a,$(".quick-input-action")),C=new Button(_);C.label=localize("ok","OK"),this._register(C.onDidClick((e=>{this.onDidAcceptEmitter.fire()})));const v=append$1(a,$(".quick-input-action")),b=new Button(v);b.label=localize("custom","Custom"),this._register(b.onDidClick((e=>{this.onDidCustomEmitter.fire()})));const S=append$1(c,$(`#${this.idPrefix}message.quick-input-message`)),y=this._register(new QuickInputList(e,this.idPrefix+"list",this.options));this._register(y.onChangedAllVisibleChecked((e=>{l.checked=e}))),this._register(y.onChangedVisibleCount((e=>{p.setCount(e)}))),this._register(y.onChangedCheckedCount((e=>{f.setCount(e)}))),this._register(y.onLeave((()=>{setTimeout((()=>{u.setFocus(),this.controller instanceof QuickPick&&this.controller.canSelectMany&&y.clearFocus()}),0)}))),this._register(y.onDidChangeFocus((()=>{this.comboboxAccessibility&&this.getUI().inputBox.setAttribute("aria-activedescendant",this.getUI().list.getActiveDescendant()||"")})));const w=new ProgressBar(e);w.getContainer().classList.add("quick-input-progress");const E=trackFocus(e);return this._register(E),this._register(addDisposableListener(e,EventType$1.FOCUS,(e=>{this.previousFocusElement=e.relatedTarget instanceof HTMLElement?e.relatedTarget:void 0}),!0)),this._register(E.onDidBlur((()=>{this.getUI().ignoreFocusOut||this.options.ignoreFocusOut()||this.hide(QuickInputHideReason.Blur),this.previousFocusElement=void 0}))),this._register(addDisposableListener(e,EventType$1.FOCUS,(e=>{u.setFocus()}))),this._register(addDisposableListener(e,EventType$1.KEY_DOWN,(t=>{const i=new StandardKeyboardEvent(t);switch(i.keyCode){case 3:EventHelper.stop(t,!0),this.onDidAcceptEmitter.fire();break;case 9:EventHelper.stop(t,!0),this.hide(QuickInputHideReason.Gesture);break;case 2:if(!i.altKey&&!i.ctrlKey&&!i.metaKey){const n=[".action-label.codicon"];e.classList.contains("show-checkboxes")?n.push("input"):n.push("input[type=text]"),this.getUI().list.isDisplayed()&&n.push(".monaco-list");const o=e.querySelectorAll(n.join(", "));i.shiftKey&&i.target===o[0]?(EventHelper.stop(t,!0),o[o.length-1].focus()):i.shiftKey||i.target!==o[o.length-1]||(EventHelper.stop(t,!0),o[0].focus())}}}))),this.ui={container:e,styleSheet:t,leftActionBar:n,titleBar:i,title:o,description1:s,description2:d,rightActionBar:r,checkAll:l,filterContainer:h,inputBox:u,visibleCountContainer:g,visibleCount:p,countContainer:m,count:f,okContainer:_,ok:C,message:S,customButtonContainer:v,customButton:b,list:y,progressBar:w,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,isScreenReaderOptimized:()=>this.options.isScreenReaderOptimized(),show:e=>this.show(e),hide:()=>this.hide(),setVisibilities:e=>this.setVisibilities(e),setComboboxAccessibility:e=>this.setComboboxAccessibility(e),setEnabled:e=>this.setEnabled(e),setContextKey:e=>this.options.setContextKey(e)},this.updateStyles(),this.ui}pick(e,t={},i=CancellationToken.None){return new Promise(((n,o)=>{let r=e=>{r=n,t.onKeyMods&&t.onKeyMods(s.keyMods),n(e)};if(i.isCancellationRequested)return void r(void 0);const s=this.createQuickPick();let a;const l=[s,s.onDidAccept((()=>{if(s.canSelectMany)r(s.selectedItems.slice()),s.hide();else{const e=s.activeItems[0];e&&(r(e),s.hide())}})),s.onDidChangeActive((e=>{const i=e[0];i&&t.onDidFocus&&t.onDidFocus(i)})),s.onDidChangeSelection((e=>{if(!s.canSelectMany){const t=e[0];t&&(r(t),s.hide())}})),s.onDidTriggerItemButton((e=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton(Object.assign(Object.assign({},e),{removeItem:()=>{const t=s.items.indexOf(e.item);if(-1!==t){const e=s.items.slice(),i=e.splice(t,1),n=s.activeItems.filter((e=>e!==i[0])),o=s.keepScrollPosition;s.keepScrollPosition=!0,s.items=e,n&&(s.activeItems=n),s.keepScrollPosition=o}}})))),s.onDidChangeValue((e=>{!a||e||1===s.activeItems.length&&s.activeItems[0]===a||(s.activeItems=[a])})),i.onCancellationRequested((()=>{s.hide()})),s.onDidHide((()=>{dispose(l),r(void 0)}))];s.title=t.title,s.canSelectMany=!!t.canPickMany,s.placeholder=t.placeHolder,s.ignoreFocusOut=!!t.ignoreFocusLost,s.matchOnDescription=!!t.matchOnDescription,s.matchOnDetail=!!t.matchOnDetail,s.matchOnLabel=void 0===t.matchOnLabel||t.matchOnLabel,s.autoFocusOnList=void 0===t.autoFocusOnList||t.autoFocusOnList,s.quickNavigate=t.quickNavigate,s.contextKey=t.contextKey,s.busy=!0,Promise.all([e,t.activeItem]).then((([e,t])=>{a=t,s.busy=!1,s.items=e,s.canSelectMany&&(s.selectedItems=e.filter((e=>"separator"!==e.type&&e.picked))),a&&(s.activeItems=[a])})),s.show(),Promise.resolve(e).then(void 0,(e=>{o(e),s.hide()}))}))}createQuickPick(){const e=this.getUI();return new QuickPick(e)}show(e){const t=this.getUI();this.onShowEmitter.fire();const i=this.controller;this.controller=e,i&&i.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",t.rightActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(Severity$2.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),reset(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,this.setComboboxAccessibility(!1),t.inputBox.ariaLabel="";const n=this.options.backKeybindingLabel();backButton.tooltip=n?localize("quickInput.backWithKeybinding","Back ({0})",n):localize("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus()}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=!e.description||e.inputBox||e.checkAll?"none":"",t.checkAll.style.display=e.checkAll?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.display(!!e.list),t.container.classList[e.checkBox?"add":"remove"]("show-checkboxes"),this.updateLayout()}setComboboxAccessibility(e){if(e!==this.comboboxAccessibility){const t=this.getUI();this.comboboxAccessibility=e,this.comboboxAccessibility?(t.inputBox.setAttribute("role","combobox"),t.inputBox.setAttribute("aria-haspopup","true"),t.inputBox.setAttribute("aria-autocomplete","list"),t.inputBox.setAttribute("aria-activedescendant",t.list.getActiveDescendant()||"")):(t.inputBox.removeAttribute("role"),t.inputBox.removeAttribute("aria-haspopup"),t.inputBox.removeAttribute("aria-autocomplete"),t.inputBox.removeAttribute("aria-activedescendant"))}}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.getAction().enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.getAction().enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){var t;const i=this.controller;if(i){const n=!(null===(t=this.ui)||void 0===t?void 0:t.container.contains(document.activeElement));if(this.controller=null,this.onHideEmitter.fire(),this.getUI().container.style.display="none",!n){let e=this.previousFocusElement;for(;e&&!e.offsetParent;)e=withNullAsUndefined(e.parentElement);(null==e?void 0:e.offsetParent)?(e.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}i.didHide(e)}}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(.62*this.dimension.width,QuickInputController.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&.4*this.dimension.height)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,contrastBorder:n,widgetShadow:o}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e?e.toString():"",this.ui.container.style.backgroundColor=t?t.toString():"",this.ui.container.style.color=i?i.toString():"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=o?`0 0 8px 2px ${o}`:"",this.ui.inputBox.style(this.styles.inputBox),this.ui.count.style(this.styles.countBadge),this.ui.ok.style(this.styles.button),this.ui.customButton.style(this.styles.button),this.ui.progressBar.style(this.styles.progressBar),this.ui.list.style(this.styles.list);const r=[];this.styles.list.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.list.pickerGroupBorder}; }`),this.styles.list.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.list.pickerGroupForeground}; }`),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const s=r.join("\n");s!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=s)}}}var DefaultQuickAccessFilterValue,DefaultQuickAccessFilterValue2;QuickInputController.MAX_WIDTH=600,DefaultQuickAccessFilterValue2=DefaultQuickAccessFilterValue||(DefaultQuickAccessFilterValue={}),DefaultQuickAccessFilterValue2[DefaultQuickAccessFilterValue2.PRESERVE=0]="PRESERVE",DefaultQuickAccessFilterValue2[DefaultQuickAccessFilterValue2.LAST=1]="LAST";const Extensions={Quickaccess:"workbench.contributions.quickaccess"};class QuickAccessRegistry{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return 0===e.prefix.length?this.defaultProvider=e:this.providers.push(e),this.providers.sort(((e,t)=>t.prefix.length-e.prefix.length)),toDisposable((()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)}))}getQuickAccessProviders(){return coalesce([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find((t=>e.startsWith(t.prefix)))||void 0||this.defaultProvider}}Registry.add(Extensions.Quickaccess,new QuickAccessRegistry);var __decorate$8=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$8=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let QuickAccessController=class extends Disposable{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=Registry.as(Extensions.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){var n;const[o,r]=this.getOrInstantiateProvider(e),s=this.visibleQuickAccess,a=null==s?void 0:s.descriptor;if(s&&r&&a===r)return e===r.prefix||(null==i?void 0:i.preserveValue)||(s.picker.value=e),void this.adjustValueSelection(s.picker,r,i);if(r&&!(null==i?void 0:i.preserveValue)){let t;if(s&&a&&a!==r){const e=s.value.substr(a.prefix.length);e&&(t=`${r.prefix}${e}`)}if(!t){const e=null==o?void 0:o.defaultFilterValue;e===DefaultQuickAccessFilterValue.LAST?t=this.lastAcceptedPickerValues.get(r):"string"==typeof e&&(t=`${r.prefix}${e}`)}"string"==typeof t&&(e=t)}const l=new DisposableStore,d=l.add(this.quickInputService.createQuickPick());let c;d.value=e,this.adjustValueSelection(d,r,i),d.placeholder=null==r?void 0:r.placeholder,d.quickNavigate=null==i?void 0:i.quickNavigateConfiguration,d.hideInput=!!d.quickNavigate&&!s,("number"==typeof(null==i?void 0:i.itemActivation)||(null==i?void 0:i.quickNavigateConfiguration))&&(d.itemActivation=null!==(n=null==i?void 0:i.itemActivation)&&void 0!==n?n:ItemActivation.SECOND),d.contextKey=null==r?void 0:r.contextKey,d.filterValue=e=>e.substring(r?r.prefix.length:0),(null==r?void 0:r.placeholder)&&(d.ariaLabel=null==r?void 0:r.placeholder),t&&(c=new DeferredPromise,l.add(once$1(d.onWillAccept)((e=>{e.veto(),d.hide()})))),l.add(this.registerPickerListeners(d,o,r,e));const h=l.add(new CancellationTokenSource$1);return o&&l.add(o.provide(d,h.token)),once$1(d.onDidHide)((()=>{0===d.selectedItems.length&&h.cancel(),l.dispose(),null==c||c.complete(d.selectedItems.slice(0))})),d.show(),t?null==c?void 0:c.p:void 0}adjustValueSelection(e,t,i){var n;let o;o=(null==i?void 0:i.preserveValue)?[e.value.length,e.value.length]:[null!==(n=null==t?void 0:t.prefix.length)&&void 0!==n?n:0,e.value.length],e.valueSelection=o}registerPickerListeners(e,t,i,n){const o=new DisposableStore,r=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return o.add(toDisposable((()=>{r===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)}))),o.add(e.onDidChangeValue((e=>{const[i]=this.getOrInstantiateProvider(e);i!==t?this.show(e,{preserveValue:!0}):r.value=e}))),i&&o.add(e.onDidAccept((()=>{this.lastAcceptedPickerValues.set(i,e.value)}))),o}getOrInstantiateProvider(e){const t=this.registry.getQuickAccessProvider(e);if(!t)return[void 0,void 0];let i=this.mapProviderToDescriptor.get(t);return i||(i=this.instantiationService.createInstance(t.ctor),this.mapProviderToDescriptor.set(t,i)),[i,t]}};QuickAccessController=__decorate$8([__param$8(0,IQuickInputService),__param$8(1,IInstantiationService)],QuickAccessController);var __decorate$7=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$7=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let QuickInputService=class extends Themable{constructor(e,t,i,n,o){super(i),this.instantiationService=e,this.contextKeyService=t,this.accessibilityService=n,this.layoutService=o,this.contexts=new Map}get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(QuickAccessController))),this._quickAccess}createController(e=this.layoutService,t){var i,n;const o={idPrefix:"quickInput_",container:e.container,ignoreFocusOut:()=>!1,isScreenReaderOptimized:()=>this.accessibilityService.isScreenReaderOptimized(),backKeybindingLabel:()=>{},setContextKey:e=>this.setContextKey(e),returnFocus:()=>e.focus(),createList:(e,t,i,n,o)=>this.instantiationService.createInstance(WorkbenchList,e,t,i,n,o),styles:this.computeStyles()},r=this._register(new QuickInputController(Object.assign(Object.assign({},o),t)));return r.layout(e.dimension,null!==(n=null===(i=e.offset)||void 0===i?void 0:i.top)&&void 0!==n?n:0),this._register(e.onDidLayout((t=>{var i,n;return r.layout(t,null!==(n=null===(i=e.offset)||void 0===i?void 0:i.top)&&void 0!==n?n:0)}))),this._register(r.onShow((()=>this.resetContextKeys()))),this._register(r.onHide((()=>this.resetContextKeys()))),r}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new RawContextKey(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),t&&t.get()||(this.resetContextKeys(),t&&t.set(!0))}resetContextKeys(){this.contexts.forEach((e=>{e.get()&&e.reset()}))}pick(e,t={},i=CancellationToken.None){return this.controller.pick(e,t,i)}createQuickPick(){return this.controller.createQuickPick()}updateStyles(){this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:Object.assign({},computeStyles(this.theme,{quickInputBackground:quickInputBackground,quickInputForeground:quickInputForeground,quickInputTitleBackground:quickInputTitleBackground,contrastBorder:contrastBorder,widgetShadow:widgetShadow})),inputBox:computeStyles(this.theme,{inputForeground:inputForeground,inputBackground:inputBackground,inputBorder:inputBorder,inputValidationInfoBackground:inputValidationInfoBackground,inputValidationInfoForeground:inputValidationInfoForeground,inputValidationInfoBorder:inputValidationInfoBorder,inputValidationWarningBackground:inputValidationWarningBackground,inputValidationWarningForeground:inputValidationWarningForeground,inputValidationWarningBorder:inputValidationWarningBorder,inputValidationErrorBackground:inputValidationErrorBackground,inputValidationErrorForeground:inputValidationErrorForeground,inputValidationErrorBorder:inputValidationErrorBorder}),countBadge:computeStyles(this.theme,{badgeBackground:badgeBackground,badgeForeground:badgeForeground,badgeBorder:contrastBorder}),button:computeStyles(this.theme,{buttonForeground:buttonForeground,buttonBackground:buttonBackground,buttonHoverBackground:buttonHoverBackground,buttonBorder:contrastBorder}),progressBar:computeStyles(this.theme,{progressBarBackground:progressBarBackground}),keybindingLabel:computeStyles(this.theme,{keybindingLabelBackground:keybindingLabelBackground,keybindingLabelForeground:keybindingLabelForeground,keybindingLabelBorder:keybindingLabelBorder,keybindingLabelBottomBorder:keybindingLabelBottomBorder,keybindingLabelShadow:widgetShadow}),list:computeStyles(this.theme,{listBackground:quickInputBackground,listInactiveFocusForeground:quickInputListFocusForeground,listInactiveSelectionIconForeground:quickInputListFocusIconForeground,listInactiveFocusBackground:quickInputListFocusBackground,listFocusOutline:activeContrastBorder,listInactiveFocusOutline:activeContrastBorder,pickerGroupBorder:pickerGroupBorder,pickerGroupForeground:pickerGroupForeground})}}};QuickInputService=__decorate$7([__param$7(0,IInstantiationService),__param$7(1,IContextKeyService),__param$7(2,IThemeService),__param$7(3,IAccessibilityService),__param$7(4,ILayoutService)],QuickInputService);var __decorate$6=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$6=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let EditorScopedQuickInputService=class extends QuickInputService{constructor(e,t,i,n,o,r){super(t,i,n,o,new EditorScopedLayoutService(e.getContainerDomNode(),r)),this.host=void 0;const s=QuickInputEditorContribution.get(e);if(s){const t=s.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return t.getDomNode()},get dimension(){return e.getLayoutInfo()},get onDidLayout(){return e.onDidLayoutChange},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};EditorScopedQuickInputService=__decorate$6([__param$6(1,IInstantiationService),__param$6(2,IContextKeyService),__param$6(3,IThemeService),__param$6(4,IAccessibilityService),__param$6(5,ICodeEditorService)],EditorScopedQuickInputService);let StandaloneQuickInputService=class{constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(EditorScopedQuickInputService,e);this.mapEditorToService.set(e,t),once$1(e.onDidDispose)((()=>{i.dispose(),this.mapEditorToService.delete(e)}))}return t}get quickAccess(){return this.activeService.quickAccess}pick(e,t={},i=CancellationToken.None){return this.activeService.pick(e,t,i)}createQuickPick(){return this.activeService.createQuickPick()}};StandaloneQuickInputService=__decorate$6([__param$6(0,IInstantiationService),__param$6(1,ICodeEditorService)],StandaloneQuickInputService);class QuickInputEditorContribution{constructor(e){this.editor=e,this.widget=new QuickInputEditorWidget(this.editor)}static get(e){return e.getContribution(QuickInputEditorContribution.ID)}dispose(){this.widget.dispose()}}QuickInputEditorContribution.ID="editor.controller.quickInput";class QuickInputEditorWidget{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return QuickInputEditorWidget.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}QuickInputEditorWidget.ID="editor.contrib.quickInputWidget",registerEditorContribution(QuickInputEditorContribution.ID,QuickInputEditorContribution);class ParsedTokenThemeRule{constructor(e,t,i,n,o){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=o}}function parseTokenTheme(e){if(!e||!Array.isArray(e))return[];const t=[];let i=0;for(let n=0,o=e.length;n<o;n++){const o=e[n];let r=-1;if("string"==typeof o.fontStyle){r=0;const e=o.fontStyle.split(" ");for(let t=0,i=e.length;t<i;t++){switch(e[t]){case"italic":r|=1;break;case"bold":r|=2;break;case"underline":r|=4;break;case"strikethrough":r|=8}}}let s=null;"string"==typeof o.foreground&&(s=o.foreground);let a=null;"string"==typeof o.background&&(a=o.background),t[i++]=new ParsedTokenThemeRule(o.token||"",n,r,s,a)}return t}function resolveParsedTokenThemeRules(e,t){e.sort(((e,t)=>{const i=strcmp(e.token,t.token);return 0!==i?i:e.index-t.index}));let i=0,n="000000",o="ffffff";for(;e.length>=1&&""===e[0].token;){const t=e.shift();-1!==t.fontStyle&&(i=t.fontStyle),null!==t.foreground&&(n=t.foreground),null!==t.background&&(o=t.background)}const r=new ColorMap;for(let c of t)r.getId(c);const s=r.getId(n),a=r.getId(o),l=new ThemeTrieElementRule(i,s,a),d=new ThemeTrieElement(l);for(let c=0,h=e.length;c<h;c++){const t=e[c];d.insert(t.token,t.fontStyle,r.getId(t.foreground),r.getId(t.background))}return new TokenTheme(r,d)}const colorRegExp=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class ColorMap{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(null===e)return 0;const t=e.match(colorRegExp);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=Color.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class TokenTheme{constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(parseTokenTheme(e),t)}static createFromParsedTokenTheme(e,t){return resolveParsedTokenThemeRules(e,t)}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(void 0===i){const e=this._match(t),n=toStandardTokenType(t);i=(e.metadata|n<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|regexp)\b/;function toStandardTokenType(e){const t=e.match(STANDARD_TOKEN_TYPE_REGEXP);if(!t)return 0;switch(t[1]){case"comment":return 1;case"string":return 2;case"regex":case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function strcmp(e,t){return e<t?-1:e>t?1:0}class ThemeTrieElementRule{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<10|this._foreground<<14|this._background<<23)>>>0}clone(){return new ThemeTrieElementRule(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){-1!==e&&(this._fontStyle=e),0!==t&&(this._foreground=t),0!==i&&(this._background=i),this.metadata=(this._fontStyle<<10|this._foreground<<14|this._background<<23)>>>0}}class ThemeTrieElement{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(""===e)return this._mainRule;const t=e.indexOf(".");let i,n;-1===t?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const o=this._children.get(i);return void 0!==o?o.match(n):this._mainRule}insert(e,t,i,n){if(""===e)return void this._mainRule.acceptOverwrite(t,i,n);const o=e.indexOf(".");let r,s;-1===o?(r=e,s=""):(r=e.substring(0,o),s=e.substring(o+1));let a=this._children.get(r);void 0===a&&(a=new ThemeTrieElement(this._mainRule.clone()),this._children.set(r,a)),a.insert(s,t,i,n)}}function generateTokensCSSForColorMap(e){const t=[];for(let i=1,n=e.length;i<n;i++){const n=e[i];t[i]=`.mtk${i} { color: ${n}; }`}return t.push(".mtki { font-style: italic; }"),t.push(".mtkb { font-weight: bold; }"),t.push(".mtku { text-decoration: underline; text-underline-position: under; }"),t.push(".mtks { text-decoration: line-through; }"),t.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),t.join("\n")}const vs={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[editorBackground]:"#FFFFFE",[editorForeground]:"#000000",[editorInactiveSelection]:"#E5EBF1",[editorIndentGuides]:"#D3D3D3",[editorActiveIndentGuides]:"#939393",[editorSelectionHighlight]:"#ADD6FF4D"}},vs_dark={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#1E1E1E",[editorForeground]:"#D4D4D4",[editorInactiveSelection]:"#3A3D41",[editorIndentGuides]:"#404040",[editorActiveIndentGuides]:"#707070",[editorSelectionHighlight]:"#ADD6FF26"}},hc_black={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[editorBackground]:"#000000",[editorForeground]:"#FFFFFF",[editorIndentGuides]:"#FFFFFF",[editorActiveIndentGuides]:"#FFFFFF"}};function getIconsStyleSheet(e){const t=new Emitter$1,i=getIconRegistry();return i.onDidChange((()=>t.fire())),null==e||e.onDidProductIconThemeChange((()=>t.fire())),{onDidChange:t.event,getCSS(){const t=e?e.getProductIconTheme():new UnthemedProductIconTheme,n={},o=e=>{const i=t.getIcon(e);if(!i)return;const o=i.font;return o?(n[o.id]=o.definition,`.codicon-${e.id}:before { content: '${i.fontCharacter}'; font-family: ${asCSSPropertyValue(o.id)}; }`):`.codicon-${e.id}:before { content: '${i.fontCharacter}'; }`},r=[];for(let e of i.getIcons()){const t=o(e);t&&r.push(t)}for(let e in n){const t=n[e],i=t.weight?`font-weight: ${t.weight};`:"",o=t.style?`font-style: ${t.style};`:"",s=t.src.map((e=>`${asCSSUrl(e.location)} format('${e.format}')`)).join(", ");r.push(`@font-face { src: ${s}; font-family: ${asCSSPropertyValue(e)};${i}${o} font-display: block; }`)}return r.join("\n")}}}class UnthemedProductIconTheme{getIcon(e){const t=getIconRegistry();let i=e.defaults;for(;ThemeIcon.isThemeIcon(i);){const e=t.getIcon(i.id);if(!e)return;i=e.defaults}return i}}const VS_THEME_NAME="vs",VS_DARK_THEME_NAME="vs-dark",HC_BLACK_THEME_NAME="hc-black",colorRegistry=Registry.as(Extensions$4.ColorContribution),themingRegistry=Registry.as(Extensions$8.ThemingContribution);class StandaloneTheme{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(isBuiltinTheme(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(let t in this.themeData.colors)e.set(t,Color.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=getBuiltinRules(this.themeData.base);for(let i in t.colors)e.has(i)||e.set(i,Color.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);return i||(!1!==t?this.getDefault(e):void 0)}getDefault(e){let t=this.defaultColors[e];return t||(t=colorRegistry.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return Object.prototype.hasOwnProperty.call(this.getColors(),e)}get type(){switch(this.base){case VS_THEME_NAME:return ColorScheme.LIGHT;case HC_BLACK_THEME_NAME:return ColorScheme.HIGH_CONTRAST;default:return ColorScheme.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const i=getBuiltinRules(this.themeData.base);e=i.rules,i.encodedTokensColors&&(t=i.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const t={token:""};i&&(t.foreground=i),n&&(t.background=n),e.push(t)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=TokenTheme.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const n=this.tokenTheme._match([e].concat(t).join(".")).metadata,o=TokenMetadata.getForeground(n),r=TokenMetadata.getFontStyle(n);return{foreground:o,italic:Boolean(1&r),bold:Boolean(2&r),underline:Boolean(4&r),strikethrough:Boolean(8&r)}}}function isBuiltinTheme(e){return e===VS_THEME_NAME||e===VS_DARK_THEME_NAME||e===HC_BLACK_THEME_NAME}function getBuiltinRules(e){switch(e){case VS_THEME_NAME:return vs;case VS_DARK_THEME_NAME:return vs_dark;case HC_BLACK_THEME_NAME:return hc_black}}function newBuiltInTheme(e){const t=getBuiltinRules(e);return new StandaloneTheme(e,t)}class StandaloneThemeService extends Disposable{constructor(){super(),this._onColorThemeChange=this._register(new Emitter$1),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new Emitter$1),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new UnthemedProductIconTheme,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(VS_THEME_NAME,newBuiltInTheme(VS_THEME_NAME)),this._knownThemes.set(VS_DARK_THEME_NAME,newBuiltInTheme(VS_DARK_THEME_NAME)),this._knownThemes.set(HC_BLACK_THEME_NAME,newBuiltInTheme(HC_BLACK_THEME_NAME));const e=getIconsStyleSheet(this);this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(VS_THEME_NAME),e.onDidChange((()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),addMatchMediaChangeListener("(forced-colors: active)",(()=>{this._updateActualTheme()}))}registerEditorContainer(e){return isInShadowDOM(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=createStyleSheet(),this._globalStyleElement.className="monaco-colors",this._globalStyleElement.textContent=this._allCSS,this._styleElements.push(this._globalStyleElement)),Disposable.None}_registerShadowDomContainer(e){const t=createStyleSheet(e);return t.className="monaco-colors",t.textContent=this._allCSS,this._styleElements.push(t),{dispose:()=>{for(let e=0;e<this._styleElements.length;e++)if(this._styleElements[e]===t)return void this._styleElements.splice(e,1)}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!isBuiltinTheme(t.base)&&!isBuiltinTheme(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new StandaloneTheme(e,t)),isBuiltinTheme(e)&&this._knownThemes.forEach((t=>{t.base===e&&t.notifyBaseUpdated()})),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;t=this._knownThemes.has(e)?this._knownThemes.get(e):this._knownThemes.get(VS_THEME_NAME),this._desiredTheme=t,this._updateActualTheme()}_updateActualTheme(){const e=this._autoDetectHighContrast&&window.matchMedia("(forced-colors: active)").matches?this._knownThemes.get(HC_BLACK_THEME_NAME):this._desiredTheme;this._theme!==e&&(this._theme=e,this._updateThemeOrColorMap())}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._updateActualTheme()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:i=>{t[i]||(e.push(i),t[i]=!0)}};themingRegistry.getThemingParticipants().forEach((e=>e(this._theme,i,this._environment)));const n=[];for(const r of colorRegistry.getColors()){const e=this._theme.getColor(r.id,!0);e&&n.push(`${asCssVariableName(r.id)}: ${e.toString()};`)}i.addRule(`.monaco-editor { ${n.join("\n")} }`);const o=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(generateTokensCSSForColorMap(o)),this._themeCSS=e.join("\n"),this._updateCSS(),TokenizationRegistry.setColorMap(o),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}\n${this._themeCSS}`,this._styleElements.forEach((e=>e.textContent=this._allCSS))}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const IStandaloneThemeService=createDecorator("themeService");var __decorate$5=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$5=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let AccessibilityService=class extends Disposable{constructor(e,t){super(),this._contextKeyService=e,this._configurationService=t,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Emitter$1,this._accessibilityModeEnabledContext=CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);const i=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.accessibilitySupport")&&(i(),this._onDidChangeScreenReaderOptimized.fire())}))),i(),this.onDidChangeScreenReaderOptimized((()=>i()))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return"on"===e||"auto"===e&&2===this._accessibilitySupport}getAccessibilitySupport(){return this._accessibilitySupport}};AccessibilityService=__decorate$5([__param$5(0,IContextKeyService),__param$5(1,IConfigurationService)],AccessibilityService);var __decorate$4=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$4=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let MenuService=class{constructor(e){this._commandService=e}createMenu(e,t,i){return new Menu(e,Object.assign({emitEventsForSubmenuChanges:!1,eventDebounceDelay:50},i),this._commandService,t,this)}};MenuService=__decorate$4([__param$4(0,ICommandService)],MenuService);let Menu=class e{constructor(e,t,i,n,o){this._id=e,this._options=t,this._commandService=i,this._contextKeyService=n,this._menuService=o,this._disposables=new DisposableStore,this._menuGroups=[],this._contextKeys=new Set,this._build();const r=new RunOnceScheduler((()=>{this._build(),this._onDidChange.fire(this)}),t.eventDebounceDelay);this._disposables.add(r),this._disposables.add(MenuRegistry.onDidChangeMenu((t=>{t.has(e)&&r.schedule()})));const s=this._disposables.add(new DisposableStore);this._onDidChange=new Emitter$1({onFirstListenerAdd:()=>{const e=new RunOnceScheduler((()=>this._onDidChange.fire(this)),t.eventDebounceDelay);s.add(e),s.add(n.onDidChangeContext((t=>{t.affectsSome(this._contextKeys)&&e.schedule()})))},onLastListenerRemove:s.clear.bind(s)}),this.onDidChange=this._onDidChange.event}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}_build(){this._menuGroups.length=0,this._contextKeys.clear();const t=MenuRegistry.getMenuItems(this._id);let i;t.sort(e._compareMenuItems);for(const e of t){const t=e.group||"";i&&i[0]===t||(i=[t,[]],this._menuGroups.push(i)),i[1].push(e),this._collectContextKeys(e)}}_collectContextKeys(t){if(e._fillInKbExprKeys(t.when,this._contextKeys),isIMenuItem(t)){if(t.command.precondition&&e._fillInKbExprKeys(t.command.precondition,this._contextKeys),t.command.toggled){const i=t.command.toggled.condition||t.command.toggled;e._fillInKbExprKeys(i,this._contextKeys)}}else this._options.emitEventsForSubmenuChanges&&MenuRegistry.getMenuItems(t.submenu).forEach(this._collectContextKeys,this)}getActions(e){const t=[];for(let i of this._menuGroups){const[n,o]=i,r=[];for(const t of o)if(this._contextKeyService.contextMatchesRules(t.when)){const i=isIMenuItem(t)?new MenuItemAction(t.command,t.alt,e,this._contextKeyService,this._commandService):new SubmenuItemAction(t,this._menuService,this._contextKeyService,e);r.push(i)}r.length>0&&t.push([n,r])}return t}static _fillInKbExprKeys(e,t){if(e)for(let i of e.keys())t.add(i)}static _compareMenuItems(t,i){let n=t.group,o=i.group;if(n!==o){if(!n)return 1;if(!o)return-1;if("navigation"===n)return-1;if("navigation"===o)return 1;let e=n.localeCompare(o);if(0!==e)return e}let r=t.order||0,s=i.order||0;return r<s?-1:r>s?1:e._compareTitles(isIMenuItem(t)?t.command.title:t.title,isIMenuItem(i)?i.command.title:i.title)}static _compareTitles(e,t){const i="string"==typeof e?e:e.original,n="string"==typeof t?t:t.original;return i.localeCompare(n)}};Menu=__decorate$4([__param$4(2,ICommandService),__param$4(3,IContextKeyService),__param$4(4,IMenuService)],Menu);var __decorate$3=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$3=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$2=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};let BrowserClipboardService=class extends Disposable{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",(isSafari||isWebkitWebView)&&this.installWebKitWriteTextWorkaround()}installWebKitWriteTextWorkaround(){const e=()=>{const e=new DeferredPromise;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=e,navigator.clipboard.write([new ClipboardItem({"text/plain":e.p})]).catch((t=>__awaiter$2(this,void 0,void 0,(function*(){t instanceof Error&&"NotAllowedError"===t.name&&e.isRejected||this.logService.error(t)}))))};this.layoutService.hasContainer&&(this._register(addDisposableListener(this.layoutService.container,"click",e)),this._register(addDisposableListener(this.layoutService.container,"keydown",e)))}writeText(e,t){return __awaiter$2(this,void 0,void 0,(function*(){if(t)return void this.mapTextToType.set(t,e);if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return yield navigator.clipboard.writeText(e)}catch(o){}const i=document.activeElement,n=document.body.appendChild($$c("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),document.execCommand("copy"),i instanceof HTMLElement&&i.focus(),document.body.removeChild(n)}))}readText(e){return __awaiter$2(this,void 0,void 0,(function*(){if(e)return this.mapTextToType.get(e)||"";try{return yield navigator.clipboard.readText()}catch(t){return""}}))}readFindText(){return __awaiter$2(this,void 0,void 0,(function*(){return this.findText}))}writeFindText(e){return __awaiter$2(this,void 0,void 0,(function*(){this.findText=e}))}};BrowserClipboardService=__decorate$3([__param$3(0,ILayoutService),__param$3(1,ILogService)],BrowserClipboardService);var __decorate$2=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$2=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};const KEYBINDING_CONTEXT_ATTR="data-keybinding-context";class Context{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}setValue(e,t){return this._value[e]!==t&&(this._value[e]=t,!0)}removeValue(e){return e in this._value&&(delete this._value[e],!0)}getValue(e){const t=this._value[e];return void 0===t&&this._parent?this._parent.getValue(e):t}}class NullContext extends Context{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}}NullContext.INSTANCE=new NullContext;class ConfigAwareContextValuesContainer extends Context{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=TernarySearchTree.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration((e=>{if(6===e.source){const e=Array.from(Iterable.map(this._values,(([e])=>e)));this._values.clear(),i.fire(new ArrayContextKeyChangeEvent(e))}else{const t=[];for(const i of e.affectedKeys){const e=`config.${i}`,n=this._values.findSuperstr(e);void 0!==n&&(t.push(...Iterable.map(n,(([e])=>e))),this._values.deleteSuperstr(e)),this._values.has(e)&&(t.push(e),this._values.delete(e))}i.fire(new ArrayContextKeyChangeEvent(t))}}))}dispose(){this._listener.dispose()}getValue(e){if(0!==e.indexOf(ConfigAwareContextValuesContainer._keyPrefix))return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(ConfigAwareContextValuesContainer._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:n=Array.isArray(i)?JSON.stringify(i):i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}}ConfigAwareContextValuesContainer._keyPrefix="config.";class ContextKey{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){void 0===this._defaultValue?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class SimpleContextKeyChangeEvent{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}}class ArrayContextKeyChangeEvent{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}}class CompositeContextKeyChangeEvent{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}}class AbstractContextKeyService{constructor(e){this._onDidChangeContext=new PauseableEmitter({merge:e=>new CompositeContextKeyChangeEvent(e)}),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ContextKey(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ScopedContextKeyService(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return!e||e.evaluate(t)}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new SimpleContextKeyChangeEvent(e))}getContext(e){return this._isDisposed?NullContext.INSTANCE:this.getContextValuesContainer(findContextAttr(e))}}let ContextKeyService=class extends AbstractContextKeyService{constructor(e){super(0),this._contexts=new Map,this._toDispose=new DisposableStore,this._lastContextId=0;const t=new ConfigAwareContextValuesContainer(this._myContextId,e,this._onDidChangeContext);this._contexts.set(this._myContextId,t),this._toDispose.add(t)}dispose(){this._onDidChangeContext.dispose(),this._isDisposed=!0,this._toDispose.dispose()}getContextValuesContainer(e){return this._isDisposed?NullContext.INSTANCE:this._contexts.get(e)||NullContext.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");let t=++this._lastContextId;return this._contexts.set(t,new Context(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};ContextKeyService=__decorate$2([__param$2(0,IConfigurationService)],ContextKeyService);class ScopedContextKeyService extends AbstractContextKeyService{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=new MutableDisposable,this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)){let e="";this._domNode.classList&&(e=Array.from(this._domNode.classList.values()).join(", "))}this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(this._onDidChangeContext.fire,this._onDidChangeContext)}dispose(){this._isDisposed||(this._onDidChangeContext.dispose(),this._parent.disposeContext(this._myContextId),this._parentChangeListener.dispose(),this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR),this._isDisposed=!0)}getContextValuesContainer(e){return this._isDisposed?NullContext.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function findContextAttr(e){for(;e;){if(e.hasAttribute(KEYBINDING_CONTEXT_ATTR)){const t=e.getAttribute(KEYBINDING_CONTEXT_ATTR);return t?parseInt(t,10):NaN}e=e.parentElement}return 0}CommandsRegistry.registerCommand(SET_CONTEXT_COMMAND_ID,(function(e,t,i){e.get(IContextKeyService).createKey(String(t),i)})),CommandsRegistry.registerCommand({id:"getContextKeyInfo",handler:()=>[...RawContextKey.all()].sort(((e,t)=>e.key.localeCompare(t.key))),description:{description:localize("getContextKeyInfo","A command that returns information about context keys"),args:[]}}),CommandsRegistry.registerCommand("_generateContextKeyInfo",(function(){const e=[],t=new Set;for(let i of RawContextKey.all())t.has(i.key)||(t.add(i.key),e.push(i));e.sort(((e,t)=>e.key.localeCompare(t.key)))}));class Node$1{constructor(e){this.incoming=new Map,this.outgoing=new Map,this.data=e}}class Graph{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(let t of this._nodes.values())0===t.outgoing.size&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(this._hashFn(t),n),n.incoming.set(this._hashFn(e),i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(let i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new Node$1(e),this._nodes.set(t,i)),i}isEmpty(){return 0===this._nodes.size}toString(){let e=[];for(let[t,i]of this._nodes)e.push(`${t}, (incoming)[${[...i.incoming.keys()].join(", ")}], (outgoing)[${[...i.outgoing.keys()].join(",")}]`);return e.join("\n")}findCycleSlow(){for(let[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(let[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const e=this._findCycle(n,t);if(e)return e;t.delete(i)}}}class CyclicDependencyError extends Error{constructor(e){var t;super("cyclic dependency between services"),this.message=null!==(t=e.findCycleSlow())&&void 0!==t?t:`UNABLE to detect cycle, dumping graph: \n${e.toString()}`}}class InstantiationService{constructor(e=new ServiceCollection,t=!1,i){this._activeInstantiations=new Set,this._services=e,this._strict=t,this._parent=i,this._services.set(IInstantiationService,this)}createChild(e){return new InstantiationService(e,this._strict,this)}invokeFunction(e,...t){let i=Trace.traceInvocation(e),n=!1;try{return e({get:e=>{if(n)throw illegalState("service accessor is only valid during the invocation of its target method");const t=this._getOrCreateServiceInstance(e,i);if(!t)throw new Error(`[invokeFunction] unknown service '${e}'`);return t}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){let i,n;return e instanceof SyncDescriptor?(i=Trace.traceCreation(e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Trace.traceCreation(e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){let n=_util.getServiceDependencies(e).sort(((e,t)=>e.index-t.index)),o=[];for(const s of n){let t=this._getOrCreateServiceInstance(s.id,i);t||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${s.id}.`,!1),o.push(t)}let r=n.length>0?n[0].index:t.length;if(t.length!==r){let e=r-t.length;t=e>0?t.concat(new Array(e)):t.slice(0,r)}return new e(...[...t,...o])}_setServiceInstance(e,t){if(this._services.get(e)instanceof SyncDescriptor)this._services.set(e,t);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setServiceInstance(e,t)}}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){let i=this._getServiceInstanceOrDescriptor(e);return i instanceof SyncDescriptor?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const n=new Graph((e=>e.id.toString()));let o=0;const r=[{id:e,desc:t,_trace:i}];for(;r.length;){const t=r.pop();if(n.lookupOrInsertNode(t),o++>1e3)throw new CyclicDependencyError(n);for(let i of _util.getServiceDependencies(t.desc.ctor)){let o=this._getServiceInstanceOrDescriptor(i.id);if(o||this._throwIfStrict(`[createInstance] ${e} depends on ${i.id} which is NOT registered.`,!0),o instanceof SyncDescriptor){const e={id:i.id,desc:o,_trace:t._trace.branch(i.id,!0)};n.insertEdge(t,e),r.push(e)}}}for(;;){const e=n.roots();if(0===e.length){if(!n.isEmpty())throw new CyclicDependencyError(n);break}for(const{data:t}of e){if(this._getServiceInstanceOrDescriptor(t.id)instanceof SyncDescriptor){const e=this._createServiceInstanceWithOwner(t.id,t.desc.ctor,t.desc.staticArguments,t.desc.supportsDelayedInstantiation,t._trace);this._setServiceInstance(t.id,e)}n.removeNode(t)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,o){if(this._services.get(e)instanceof SyncDescriptor)return this._createServiceInstance(t,i,n,o);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,o);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t=[],i,n){if(i){const i=new IdleValue((()=>this._createInstance(e,t,n)));return new Proxy(Object.create(null),{get(e,t){if(t in e)return e[t];let n=i.value,o=n[t];return"function"!=typeof o||(o=o.bind(n),e[t]=o),o},set:(e,t,n)=>(i.value[t]=n,!0)})}return this._createInstance(e,t,n)}_throwIfStrict(e,t){if(this._strict)throw new Error(e)}}class Trace{constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}static traceInvocation(e){return Trace._None}static traceCreation(e){return Trace._None}branch(e,t){let i=new Trace(2,e.toString());return this._dep.push([e,t,i]),i}stop(){let e=Date.now()-this._start;Trace._totals+=e;let t=!1;this.type,this.name,function e(i,n){let o=[],r=new Array(i+1).join("\t");for(const[s,a,l]of n._dep)if(a&&l){t=!0,o.push(`${r}CREATES -> ${s}`);let n=e(i+1,l);n&&o.push(n)}else o.push(`${r}uses -> ${s}`);return o.join("\n")}(1,this),e.toFixed(2),Trace._totals.toFixed(2)}}Trace._None=new class extends Trace{constructor(){super(-1,null)}stop(){}branch(){return this}},Trace._totals=0;class DoubleResourceMap{constructor(){this._byResource=new ResourceMap,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let o=this._byOwner.get(t);o||(o=new ResourceMap,this._byOwner.set(t,o)),o.set(e,i)}get(e,t){let i=this._byResource.get(e);return null==i?void 0:i.get(t)}delete(e,t){let i=!1,n=!1,o=this._byResource.get(e);o&&(i=o.delete(t));let r=this._byOwner.get(t);if(r&&(n=r.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){var t,i,n,o;return"string"==typeof e?null!==(i=null===(t=this._byOwner.get(e))||void 0===t?void 0:t.values())&&void 0!==i?i:Iterable.empty():URI.isUri(e)?null!==(o=null===(n=this._byResource.get(e))||void 0===n?void 0:n.values())&&void 0!==o?o:Iterable.empty():Iterable.map(Iterable.concat(...this._byOwner.values()),(e=>e[1]))}}class MarkerStats{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new ResourceMap,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const e=this._data.get(t);e&&this._substract(e);const i=this._resourceStats(t);this._add(i),this._data.set(t,i)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(e.scheme===Schemas.inMemory||e.scheme===Schemas.walkThrough||e.scheme===Schemas.walkThroughSnippet)return t;for(const{severity:i}of this._service.read({resource:e}))i===MarkerSeverity$2.Error?t.errors+=1:i===MarkerSeverity$2.Warning?t.warnings+=1:i===MarkerSeverity$2.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class MarkerService{constructor(){this._onMarkerChanged=new DebounceEmitter({delay:0,merge:MarkerService._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new DoubleResourceMap,this._stats=new MarkerStats(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(isFalsyOrEmpty(i)){this._data.delete(t,e)&&this._onMarkerChanged.fire([t])}else{const n=[];for(const o of i){const i=MarkerService._toMarker(e,t,o);i&&n.push(i)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:o,message:r,source:s,startLineNumber:a,startColumn:l,endLineNumber:d,endColumn:c,relatedInformation:h,tags:u}=i;if(r)return a=a>0?a:1,l=l>0?l:1,d=d>=a?d:a,c=c>0?c:l,{resource:t,owner:e,code:n,severity:o,message:r,source:s,startLineNumber:a,startColumn:l,endLineNumber:d,endColumn:c,relatedInformation:h,tags:u}}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:o}=e;if((!o||o<0)&&(o=-1),t&&i){const e=this._data.get(i,t);if(e){const t=[];for(const i of e)if(MarkerService._accept(i,n)){const e=t.push(i);if(o>0&&e===o)break}return t}return[]}if(t||i){const e=this._data.values(null!=i?i:t),r=[];for(const t of e)for(const e of t)if(MarkerService._accept(e,n)){const t=r.push(e);if(o>0&&t===o)return r}return r}{const e=[];for(let t of this._data.values())for(let i of t)if(MarkerService._accept(i,n)){const t=e.push(i);if(o>0&&t===o)return e}return e}}static _accept(e,t){return void 0===t||(t&e.severity)===e.severity}static _merge(e){const t=new ResourceMap;for(let i of e)for(let e of i)t.set(e,!0);return Array.from(t.keys())}}function score(e,t,i,n,o){if(Array.isArray(e)){let r=0;for(const s of e){const e=score(s,t,i,n,o);if(10===e)return e;e>r&&(r=e)}return r}if("string"==typeof e)return n?"*"===e?5:e===i?10:0:0;if(e){const{language:r,pattern:s,scheme:a,hasAccessToAllModels:l,notebookType:d}=e;if(!n&&!l)return 0;let c=0;if(a)if(a===t.scheme)c=10;else{if("*"!==a)return 0;c=5}if(r)if(r===i)c=10;else{if("*"!==r)return 0;c=Math.max(c,5)}if(d)if(d===o)c=10;else{if("*"!==d)return 0;c=Math.max(c,5)}if(s){let e;if(e="string"==typeof s?s:Object.assign(Object.assign({},s),{base:normalize(s.base)}),e!==t.fsPath&&!match(e,t.fsPath))return 0;c=10}return c}return 0}function isExclusive(e){return"string"!=typeof e&&(Array.isArray(e)?e.every(isExclusive):!!e.exclusive)}class LanguageFeatureRegistry{constructor(e){this._notebookTypeResolver=e,this._clock=0,this._entries=[],this._onDidChange=new Emitter$1,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),toDisposable((()=>{if(i){const e=this._entries.indexOf(i);e>=0&&(this._entries.splice(e,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}}))}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e);const t=[];for(let i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e){const t=[];return this._orderedForEach(e,(e=>t.push(e.provider))),t}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,(e=>{i&&n===e._score?i.push(e.provider):(n=e._score,i=[e.provider],t.push(i))})),t}_orderedForEach(e,t){if(e){this._updateScores(e);for(const e of this._entries)e._score>0&&t(e)}}_updateScores(e){var t;const i=null===(t=this._notebookTypeResolver)||void 0===t?void 0:t.call(this,e.uri),n={uri:e.uri.toString(),language:e.getLanguageId(),notebookType:i};if(!this._lastCandidate||this._lastCandidate.language!==n.language||this._lastCandidate.uri!==n.uri||this._lastCandidate.notebookType!==n.notebookType){this._lastCandidate=n;for(let t of this._entries)if(t._score=score(t.selector,e.uri,e.getLanguageId(),shouldSynchronizeModel(e),i),isExclusive(t.selector)&&t._score>0){for(let e of this._entries)e._score=0;t._score=1e3;break}this._entries.sort(LanguageFeatureRegistry._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:e._time<t._time?1:e._time>t._time?-1:0}}class LanguageFeaturesService{constructor(){this.referenceProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.renameProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeActionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.definitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.typeDefinitionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.declarationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.implementationProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSymbolProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlayHintsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.colorProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.codeLensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.onTypeFormattingEditProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.signatureHelpProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.hoverProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentHighlightProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.selectionRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.foldingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.inlineCompletionsProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.completionProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.linkedEditingRangeProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this)),this.documentSemanticTokensProvider=new LanguageFeatureRegistry(this._score.bind(this))}_score(e){var t;return null===(t=this._notebookTypeResolver)||void 0===t?void 0:t.call(this,e)}}registerSingleton(ILanguageFeaturesService,LanguageFeaturesService,!0);var __decorate$1=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param$1=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}},__awaiter$1=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};class SimpleModel{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new Emitter$1}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let StandaloneTextModelService=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new ImmortalReference(new SimpleModel(t))):Promise.reject(new Error("Model not found"))}};StandaloneTextModelService=__decorate$1([__param$1(0,IModelService)],StandaloneTextModelService);class StandaloneEditorProgressService{show(){return StandaloneEditorProgressService.NULL_PROGRESS_RUNNER}showWhile(e,t){return __awaiter$1(this,void 0,void 0,(function*(){yield e}))}}StandaloneEditorProgressService.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};class StandaloneDialogService{confirm(e){return this.doConfirm(e).then((e=>({confirmed:e,checkboxChecked:!1})))}doConfirm(e){let t=e.message;return e.detail&&(t=t+"\n\n"+e.detail),Promise.resolve(window.confirm(t))}show(e,t,i,n){return Promise.resolve({choice:0})}}class StandaloneNotificationService{info(e){return this.notify({severity:Severity$2.Info,message:e})}warn(e){return this.notify({severity:Severity$2.Warning,message:e})}error(e){return this.notify({severity:Severity$2.Error,message:e})}notify(e){switch(e.severity){case Severity$2.Error:case Severity$2.Warning:}return StandaloneNotificationService.NO_OP}status(e,t){return Disposable.None}}StandaloneNotificationService.NO_OP=new NoOpNotification;let StandaloneCommandService=class{constructor(e){this._onWillExecuteCommand=new Emitter$1,this._onDidExecuteCommand=new Emitter$1,this.onWillExecuteCommand=this._onWillExecuteCommand.event,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=CommandsRegistry.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};StandaloneCommandService=__decorate$1([__param$1(0,IInstantiationService)],StandaloneCommandService);let StandaloneKeybindingService=class extends AbstractKeybindingService{constructor(e,t,i,n,o,r){super(e,t,i,n,o),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const s=e=>{const t=new DisposableStore;t.add(addDisposableListener(e,EventType$1.KEY_DOWN,(e=>{const t=new StandardKeyboardEvent(e);this._dispatch(t,t.target)&&(t.preventDefault(),t.stopPropagation())}))),t.add(addDisposableListener(e,EventType$1.KEY_UP,(e=>{const t=new StandardKeyboardEvent(e);this._singleModifierDispatch(t,t.target)&&t.preventDefault()}))),this._domNodeListeners.push(new DomNodeListeners(e,t))},a=e=>{for(let t=0;t<this._domNodeListeners.length;t++){const i=this._domNodeListeners[t];i.domNode===e&&(this._domNodeListeners.splice(t,1),i.dispose())}},l=e=>{e.getOption(54)||s(e.getContainerDomNode())};this._register(r.onCodeEditorAdd(l)),this._register(r.onCodeEditorRemove((e=>{e.getOption(54)||a(e.getContainerDomNode())}))),r.listCodeEditors().forEach(l);const d=e=>{s(e.getContainerDomNode())};this._register(r.onDiffEditorAdd(d)),this._register(r.onDiffEditorRemove((e=>{a(e.getContainerDomNode())}))),r.listDiffEditors().forEach(d)}addDynamicKeybinding(e,t,i,n){const o=createKeybinding(t,OS),r=new DisposableStore;return o&&(this._dynamicKeybindings.push({keybinding:o.parts,command:e,when:n,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}),r.add(toDisposable((()=>{for(let t=0;t<this._dynamicKeybindings.length;t++){if(this._dynamicKeybindings[t].command===e)return this._dynamicKeybindings.splice(t,1),void this.updateResolver({source:1})}})))),r.add(CommandsRegistry.registerCommand(e,i)),this.updateResolver({source:1}),r}updateResolver(e){this._cachedResolver=null,this._onDidUpdateKeybindings.fire(e)}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(KeybindingsRegistry.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new KeybindingResolver(e,t,(e=>this._log(e)))}return this._cachedResolver}_documentHasFocus(){return document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const o of e){const e=o.when||void 0,r=o.keybinding;if(r){const s=USLayoutResolvedKeybinding.resolveUserBinding(r,OS);for(const r of s)i[n++]=new ResolvedKeybindingItem(r,o.command,o.commandArgs,e,t,null,!1)}else i[n++]=new ResolvedKeybindingItem(void 0,o.command,o.commandArgs,e,t,null,!1)}return i}resolveKeyboardEvent(e){const t=new SimpleKeybinding(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode).toChord();return new USLayoutResolvedKeybinding(t,OS)}};StandaloneKeybindingService=__decorate$1([__param$1(0,IContextKeyService),__param$1(1,ICommandService),__param$1(2,ITelemetryService),__param$1(3,INotificationService),__param$1(4,ILogService),__param$1(5,ICodeEditorService)],StandaloneKeybindingService);class DomNodeListeners extends Disposable{constructor(e,t){super(),this.domNode=e,this._register(t)}}function isConfigurationOverrides(e){return e&&"object"==typeof e&&(!e.overrideIdentifier||"string"==typeof e.overrideIdentifier)&&(!e.resource||e.resource instanceof URI)}class StandaloneConfigurationService{constructor(){this._onDidChangeConfiguration=new Emitter$1,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._configuration=new Configuration(new DefaultConfigurationModel,new ConfigurationModel)}getValue(e,t){const i="string"==typeof e?e:void 0,n=isConfigurationOverrides(e)?e:isConfigurationOverrides(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[e,t]=n;this.getValue(e)!==t&&(this._configuration.updateValue(e,t),i.push(e))}if(i.length>0){const e=new ConfigurationChangeEvent({keys:i,overrides:[]},t,this._configuration);e.source=7,e.sourceConfig=null,this._onDidChangeConfiguration.fire(e)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}}let StandaloneResourceConfigurationService=class{constructor(e){this.configurationService=e,this._onDidChangeConfiguration=new Emitter$1,this.configurationService.onDidChangeConfiguration((e=>{this._onDidChangeConfiguration.fire({affectedKeys:e.affectedKeys,affectsConfiguration:(t,i)=>e.affectsConfiguration(i)})}))}getValue(e,t,i){const n=(Position$1.isIPosition(t)?t:null)?"string"==typeof i?i:void 0:"string"==typeof t?t:void 0;return void 0===n?this.configurationService.getValue():this.configurationService.getValue(n)}};StandaloneResourceConfigurationService=__decorate$1([__param$1(0,IConfigurationService)],StandaloneResourceConfigurationService);let StandaloneResourcePropertiesService=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&"string"==typeof i&&"auto"!==i?i:isLinux||isMacintosh?"\n":"\r\n"}};StandaloneResourcePropertiesService=__decorate$1([__param$1(0,IConfigurationService)],StandaloneResourcePropertiesService);class StandaloneTelemetryService{publicLog(e,t){return Promise.resolve(void 0)}publicLog2(e,t){return this.publicLog(e,t)}}class StandaloneWorkspaceContextService{constructor(){const e=URI.from({scheme:StandaloneWorkspaceContextService.SCHEME,authority:"model",path:"/"});this.workspace={id:"4064f6ec-cb38-4ad0-af64-ee6467e63c82",folders:[new WorkspaceFolder({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}}function updateConfigurationService(e,t,i){if(!t)return;if(!(e instanceof StandaloneConfigurationService))return;const n=[];Object.keys(t).forEach((e=>{isEditorConfigurationKey(e)&&n.push([`editor.${e}`,t[e]]),i&&isDiffEditorConfigurationKey(e)&&n.push([`diffEditor.${e}`,t[e]])})),n.length>0&&e.updateValues(n)}StandaloneWorkspaceContextService.SCHEME="inmemory";let StandaloneBulkEditService=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}apply(e,t){return __awaiter$1(this,void 0,void 0,(function*(){const t=new Map;for(let o of e){if(!(o instanceof ResourceTextEdit))throw new Error("bad edit - only text edits are supported");const e=this._modelService.getModel(o.resource);if(!e)throw new Error("bad edit - model not found");if("number"==typeof o.versionId&&e.getVersionId()!==o.versionId)throw new Error("bad state - model changed in the meantime");let i=t.get(e);i||(i=[],t.set(e,i)),i.push(EditOperation.replaceMove(Range$2.lift(o.textEdit.range),o.textEdit.text))}let i=0,n=0;for(const[e,o]of t)e.pushStackElement(),e.pushEditOperations([],o,(()=>[])),e.pushStackElement(),n+=1,i+=o.length;return{ariaSummary:format(StandaloneServicesNLS.bulkEditServiceSummary,i,n)}}))}};StandaloneBulkEditService=__decorate$1([__param$1(0,IModelService)],StandaloneBulkEditService);class StandaloneUriLabelService{getUriLabel(e,t){return"file"===e.scheme?e.fsPath:e.path}}let StandaloneContextViewService=class extends ContextViewService{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const e=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();e&&(t=e.getContainerDomNode())}return super.showContextView(e,t,i)}};StandaloneContextViewService=__decorate$1([__param$1(0,ILayoutService),__param$1(1,ICodeEditorService)],StandaloneContextViewService);class StandaloneWorkspaceTrustManagementService{constructor(){this._neverEmitter=new Emitter$1,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class StandaloneLanguageService extends LanguageService{constructor(){super()}}class StandaloneLogService extends LogService{constructor(){super(new ConsoleLogger)}}let StandaloneContextMenuService=class extends ContextMenuService{constructor(e,t,i,n,o){super(e,t,i,n,o),this.configure({blockMouse:!1})}};var StandaloneServices;StandaloneContextMenuService=__decorate$1([__param$1(0,ITelemetryService),__param$1(1,INotificationService),__param$1(2,IContextViewService),__param$1(3,IKeybindingService),__param$1(4,IThemeService)],StandaloneContextMenuService),registerSingleton(IConfigurationService,StandaloneConfigurationService),registerSingleton(ITextResourceConfigurationService,StandaloneResourceConfigurationService),registerSingleton(ITextResourcePropertiesService,StandaloneResourcePropertiesService),registerSingleton(IWorkspaceContextService,StandaloneWorkspaceContextService),registerSingleton(ILabelService,StandaloneUriLabelService),registerSingleton(ITelemetryService,StandaloneTelemetryService),registerSingleton(IDialogService,StandaloneDialogService),registerSingleton(INotificationService,StandaloneNotificationService),registerSingleton(IMarkerService,MarkerService),registerSingleton(ILanguageService,StandaloneLanguageService),registerSingleton(IStandaloneThemeService,StandaloneThemeService),registerSingleton(ILogService,StandaloneLogService),registerSingleton(IModelService,ModelService),registerSingleton(IMarkerDecorationsService,MarkerDecorationsService),registerSingleton(IContextKeyService,ContextKeyService),registerSingleton(IEditorProgressService,StandaloneEditorProgressService),registerSingleton(IStorageService,InMemoryStorageService),registerSingleton(IEditorWorkerService,EditorWorkerService),registerSingleton(IBulkEditService,StandaloneBulkEditService),registerSingleton(IWorkspaceTrustManagementService,StandaloneWorkspaceTrustManagementService),registerSingleton(ITextModelService,StandaloneTextModelService),registerSingleton(IAccessibilityService,AccessibilityService),registerSingleton(IListService,ListService),registerSingleton(ICommandService,StandaloneCommandService),registerSingleton(IKeybindingService,StandaloneKeybindingService),registerSingleton(IQuickInputService,StandaloneQuickInputService),registerSingleton(IContextViewService,StandaloneContextViewService),registerSingleton(IOpenerService,OpenerService),registerSingleton(IClipboardService,BrowserClipboardService),registerSingleton(IContextMenuService,StandaloneContextMenuService),registerSingleton(IMenuService,MenuService),function(e){const t=new ServiceCollection;for(const[o,r]of getSingletonServiceDescriptors())t.set(o,r);const i=new InstantiationService(t,!0);t.set(IInstantiationService,i),e.get=function(e){const n=t.get(e);if(!n)throw new Error("Missing service "+e);return n instanceof SyncDescriptor?i.invokeFunction((t=>t.get(e))):n};let n=!1;e.initialize=function(e){if(n)return i;n=!0;for(const[i,n]of getSingletonServiceDescriptors())t.get(i)||t.set(i,n);for(const i in e)if(e.hasOwnProperty(i)){const n=createDecorator(i);t.get(n)instanceof SyncDescriptor&&t.set(n,e[i])}return i}}(StandaloneServices||(StandaloneServices={}));var __decorate=globalThis&&globalThis.__decorate||function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},__param=globalThis&&globalThis.__param||function(e,t){return function(i,n){t(i,n,e)}};let LAST_GENERATED_COMMAND_ID=0,ariaDomNodeCreated=!1;function createAriaDomNode(e){if(!e){if(ariaDomNodeCreated)return;ariaDomNodeCreated=!0}setARIAContainer(e||document.body)}let StandaloneCodeEditor=class extends CodeEditorWidget{constructor(e,t,i,n,o,r,s,a,l,d,c,h){const u=Object.assign({},t);u.ariaLabel=u.ariaLabel||StandaloneCodeEditorNLS.editorViewAccessibleLabel,u.ariaLabel=u.ariaLabel+";"+StandaloneCodeEditorNLS.accessibilityHelpMessage,super(e,u,{},i,n,o,r,a,l,d,c,h),this._standaloneKeybindingService=s instanceof StandaloneKeybindingService?s:null,createAriaDomNode(u.ariaContainerElement)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return null;const n="DYNAMIC_"+ ++LAST_GENERATED_COMMAND_ID,o=ContextKeyExpr.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,o),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if("string"!=typeof e.id||"string"!=typeof e.label||"function"!=typeof e.run)throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return Disposable.None;const t=e.id,i=e.label,n=ContextKeyExpr.and(ContextKeyExpr.equals("editorId",this.getId()),ContextKeyExpr.deserialize(e.precondition)),o=e.keybindings,r=ContextKeyExpr.and(n,ContextKeyExpr.deserialize(e.keybindingContext)),s=e.contextMenuGroupId||null,a=e.contextMenuOrder||0,l=(t,...i)=>Promise.resolve(e.run(this,...i)),d=new DisposableStore,c=this.getId()+":"+t;if(d.add(CommandsRegistry.registerCommand(c,l)),s){const e={command:{id:c,title:i},when:n,group:s,order:a};d.add(MenuRegistry.appendMenuItem(MenuId.EditorContext,e))}if(Array.isArray(o))for(const u of o)d.add(this._standaloneKeybindingService.addDynamicKeybinding(c,u,l,r));const h=new InternalEditorAction(c,i,i,n,l,this._contextKeyService);return this._actions[t]=h,d.add(toDisposable((()=>{delete this._actions[t]}))),d}_triggerCommand(e,t){if(this._codeEditorService instanceof StandaloneCodeEditorService)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};StandaloneCodeEditor=__decorate([__param(2,IInstantiationService),__param(3,ICodeEditorService),__param(4,ICommandService),__param(5,IContextKeyService),__param(6,IKeybindingService),__param(7,IThemeService),__param(8,INotificationService),__param(9,IAccessibilityService),__param(10,ILanguageConfigurationService),__param(11,ILanguageFeaturesService)],StandaloneCodeEditor);let StandaloneEditor=class extends StandaloneCodeEditor{constructor(e,t,i,n,o,r,s,a,l,d,c,h,u,g,p){const m=Object.assign({},t);updateConfigurationService(d,m,!1);const f=a.registerEditorContainer(e);"string"==typeof m.theme&&a.setTheme(m.theme),void 0!==m.autoDetectHighContrast&&a.setAutoDetectHighContrast(Boolean(m.autoDetectHighContrast));const _=m.model;let C;if(delete m.model,super(e,m,i,n,o,r,s,a,l,c,g,p),this._configurationService=d,this._standaloneThemeService=a,this._register(f),void 0===_){const e=u.getLanguageIdByMimeType(m.language)||m.language||PLAINTEXT_LANGUAGE_ID;C=createTextModel(h,u,m.value||"",e,void 0),this._ownsModel=!0}else C=_,this._ownsModel=!1;if(this._attachModel(C),C){const e={oldModelUrl:null,newModelUrl:C.uri};this._onDidChangeModel.fire(e)}}dispose(){super.dispose()}updateOptions(e){updateConfigurationService(this._configurationService,e,!1),"string"==typeof e.theme&&this._standaloneThemeService.setTheme(e.theme),void 0!==e.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};StandaloneEditor=__decorate([__param(2,IInstantiationService),__param(3,ICodeEditorService),__param(4,ICommandService),__param(5,IContextKeyService),__param(6,IKeybindingService),__param(7,IStandaloneThemeService),__param(8,INotificationService),__param(9,IConfigurationService),__param(10,IAccessibilityService),__param(11,IModelService),__param(12,ILanguageService),__param(13,ILanguageConfigurationService),__param(14,ILanguageFeaturesService)],StandaloneEditor);let StandaloneDiffEditor=class extends DiffEditorWidget{constructor(e,t,i,n,o,r,s,a,l,d,c,h){const u=Object.assign({},t);updateConfigurationService(l,u,!0);const g=s.registerEditorContainer(e);"string"==typeof u.theme&&s.setTheme(u.theme),void 0!==u.autoDetectHighContrast&&s.setAutoDetectHighContrast(Boolean(u.autoDetectHighContrast)),super(e,u,{},h,o,n,i,r,s,a,d,c),this._configurationService=l,this._standaloneThemeService=s,this._register(g)}dispose(){super.dispose()}updateOptions(e){updateConfigurationService(this._configurationService,e,!0),"string"==typeof e.theme&&this._standaloneThemeService.setTheme(e.theme),void 0!==e.autoDetectHighContrast&&this._standaloneThemeService.setAutoDetectHighContrast(Boolean(e.autoDetectHighContrast)),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(StandaloneCodeEditor,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};function createTextModel(e,t,i,n,o){if(i=i||"",!n){const n=i.indexOf("\n");let r=i;return-1!==n&&(r=i.substring(0,n)),doCreateModel(e,i,t.createByFilepathOrFirstLine(o||null,r),o)}return doCreateModel(e,i,t.createById(n),o)}function doCreateModel(e,t,i,n){return e.createModel(t,i,n)}function create(e,t,i){return StandaloneServices.initialize(i||{}).createInstance(StandaloneEditor,e,t)}function onDidCreateEditor(e){return StandaloneServices.get(ICodeEditorService).onCodeEditorAdd((t=>{e(t)}))}function createDiffEditor(e,t,i){return StandaloneServices.initialize(i||{}).createInstance(StandaloneDiffEditor,e,t)}function createDiffNavigator(e,t){return new DiffNavigator(e,t)}function createModel(e,t,i){const n=StandaloneServices.get(ILanguageService),o=n.getLanguageIdByMimeType(t)||t;return createTextModel(StandaloneServices.get(IModelService),n,e,o,i)}function setModelLanguage(e,t){const i=StandaloneServices.get(ILanguageService);StandaloneServices.get(IModelService).setMode(e,i.createById(t))}function setModelMarkers(e,t,i){if(e){StandaloneServices.get(IMarkerService).changeOne(t,e.uri,i)}}function getModelMarkers(e){return StandaloneServices.get(IMarkerService).read(e)}function onDidChangeMarkers(e){return StandaloneServices.get(IMarkerService).onMarkerChanged(e)}function getModel(e){return StandaloneServices.get(IModelService).getModel(e)}function getModels(){return StandaloneServices.get(IModelService).getModels()}function onDidCreateModel(e){return StandaloneServices.get(IModelService).onModelAdded(e)}function onWillDisposeModel(e){return StandaloneServices.get(IModelService).onModelRemoved(e)}function onDidChangeModelLanguage(e){return StandaloneServices.get(IModelService).onModelLanguageChanged((t=>{e({model:t.model,oldLanguage:t.oldLanguageId})}))}function createWebWorker(e){return createWebWorker$1(StandaloneServices.get(IModelService),StandaloneServices.get(ILanguageConfigurationService),e)}function colorizeElement(e,t){const i=StandaloneServices.get(ILanguageService),n=StandaloneServices.get(IStandaloneThemeService);return n.registerEditorContainer(e),Colorizer.colorizeElement(n,i,e,t)}function colorize(e,t,i){const n=StandaloneServices.get(ILanguageService);return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(document.body),Colorizer.colorize(n,e,t,i)}function colorizeModelLine(e,t,i=4){return StandaloneServices.get(IStandaloneThemeService).registerEditorContainer(document.body),Colorizer.colorizeModelLine(e,t,i)}function getSafeTokenizationSupport(e){const t=TokenizationRegistry.get(e);return t||{getInitialState:()=>NullState,tokenize:(t,i,n)=>nullTokenize(e,n)}}function tokenize(e,t){TokenizationRegistry.getOrCreate(t);const i=getSafeTokenizationSupport(t),n=splitLines(e),o=[];let r=i.getInitialState();for(let s=0,a=n.length;s<a;s++){const e=n[s],t=i.tokenize(e,!0,r);o[s]=t.tokens,r=t.endState}return o}function defineTheme(e,t){StandaloneServices.get(IStandaloneThemeService).defineTheme(e,t)}function setTheme(e){StandaloneServices.get(IStandaloneThemeService).setTheme(e)}function remeasureFonts(){FontMeasurements.clearAllFontInfos()}function registerCommand(e,t){return CommandsRegistry.registerCommand({id:e,handler:t})}function createMonacoEditorAPI(){return{create:create,onDidCreateEditor:onDidCreateEditor,createDiffEditor:createDiffEditor,createDiffNavigator:createDiffNavigator,createModel:createModel,setModelLanguage:setModelLanguage,setModelMarkers:setModelMarkers,getModelMarkers:getModelMarkers,onDidChangeMarkers:onDidChangeMarkers,getModels:getModels,getModel:getModel,onDidCreateModel:onDidCreateModel,onWillDisposeModel:onWillDisposeModel,onDidChangeModelLanguage:onDidChangeModelLanguage,createWebWorker:createWebWorker,colorizeElement:colorizeElement,colorize:colorize,colorizeModelLine:colorizeModelLine,tokenize:tokenize,defineTheme:defineTheme,setTheme:setTheme,remeasureFonts:remeasureFonts,registerCommand:registerCommand,AccessibilitySupport:AccessibilitySupport,ContentWidgetPositionPreference:ContentWidgetPositionPreference,CursorChangeReason:CursorChangeReason,DefaultEndOfLine:DefaultEndOfLine,EditorAutoIndentStrategy:EditorAutoIndentStrategy,EditorOption:EditorOption,EndOfLinePreference:EndOfLinePreference,EndOfLineSequence:EndOfLineSequence,MinimapPosition:MinimapPosition,MouseTargetType:MouseTargetType,OverlayWidgetPositionPreference:OverlayWidgetPositionPreference,OverviewRulerLane:OverviewRulerLane,RenderLineNumbersType:RenderLineNumbersType,RenderMinimap:RenderMinimap,ScrollbarVisibility:ScrollbarVisibility,ScrollType:ScrollType,TextEditorCursorBlinkingStyle:TextEditorCursorBlinkingStyle,TextEditorCursorStyle:TextEditorCursorStyle,TrackedRangeStickiness:TrackedRangeStickiness,WrappingIndent:WrappingIndent,InjectedTextCursorStops:InjectedTextCursorStops,PositionAffinity:PositionAffinity,ConfigurationChangedEvent:ConfigurationChangedEvent,BareFontInfo:BareFontInfo,FontInfo:FontInfo,TextModelResolvedOptions:TextModelResolvedOptions,FindMatch:FindMatch,ApplyUpdateResult:ApplyUpdateResult,EditorType:EditorType,EditorOptions:EditorOptions}}function isArrayOf(e,t){if(!t)return!1;if(!Array.isArray(t))return!1;for(const i of t)if(!e(i))return!1;return!0}function bool(e,t){return"boolean"==typeof e?e:t}function string(e,t){return"string"==typeof e?e:t}function arrayToHash(e){const t={};for(const i of e)t[i]=!0;return t}function createKeywordMatcher(e,t=!1){t&&(e=e.map((function(e){return e.toLowerCase()})));const i=arrayToHash(e);return t?function(e){return void 0!==i[e.toLowerCase()]&&i.hasOwnProperty(e.toLowerCase())}:function(e){return void 0!==i[e]&&i.hasOwnProperty(e)}}function compileRegExp(e,t){t=t.replace(/@@/g,"");let i,n=0;do{i=!1,t=t.replace(/@(\w+)/g,(function(n,o){i=!0;let r="";if("string"==typeof e[o])r=e[o];else{if(!(e[o]&&e[o]instanceof RegExp))throw void 0===e[o]?createError(e,"language definition does not contain attribute '"+o+"', used at: "+t):createError(e,"attribute reference '"+o+"' must be a string, used at: "+t);r=e[o].source}return empty(r)?"":"(?:"+r+")"})),n++}while(i&&n<5);t=t.replace(/\x01/g,"@");const o=(e.ignoreCase?"i":"")+(e.unicode?"u":"");return new RegExp(t,o)}function selectScrutinee(e,t,i,n){if(n<0)return e;if(n<t.length)return t[n];if(n>=100){n-=100;const e=i.split(".");if(e.unshift(i),n<e.length)return e[n]}return null}function createGuard(e,t,i,n){let o=-1,r=i,s=i.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);s&&(s[3]&&(o=parseInt(s[3]),s[2]&&(o+=100)),r=s[4]);let a,l="~",d=r;if(r&&0!==r.length?/^\w*$/.test(d)?l="==":(s=r.match(/^(@|!@|~|!~|==|!=)(.*)$/),s&&(l=s[1],d=s[2])):(l="!=",d=""),"~"!==l&&"!~"!==l||!/^(\w|\|)*$/.test(d))if("@"===l||"!@"===l){const i=e[d];if(!i)throw createError(e,"the @ match target '"+d+"' is not defined, in rule: "+t);if(!isArrayOf((function(e){return"string"==typeof e}),i))throw createError(e,"the @ match target '"+d+"' must be an array of strings, in rule: "+t);const n=createKeywordMatcher(i,e.ignoreCase);a=function(e){return"@"===l?n(e):!n(e)}}else if("~"===l||"!~"===l)if(d.indexOf("$")<0){const t=compileRegExp(e,"^"+d+"$");a=function(e){return"~"===l?t.test(e):!t.test(e)}}else a=function(t,i,n,o){return compileRegExp(e,"^"+substituteMatches(e,d,i,n,o)+"$").test(t)};else if(d.indexOf("$")<0){const t=fixCase(e,d);a=function(e){return"=="===l?e===t:e!==t}}else{const t=fixCase(e,d);a=function(i,n,o,r,s){const a=substituteMatches(e,t,n,o,r);return"=="===l?i===a:i!==a}}else{const t=createKeywordMatcher(d.split("|"),e.ignoreCase);a=function(e){return"~"===l?t(e):!t(e)}}return-1===o?{name:i,value:n,test:function(e,t,i,n){return a(e,e,t,i,n)}}:{name:i,value:n,test:function(e,t,i,n){const r=selectScrutinee(e,t,i,o);return a(r||"",e,t,i,n)}}}function compileAction(e,t,i){if(i){if("string"==typeof i)return i;if(i.token||""===i.token){if("string"!=typeof i.token)throw createError(e,"a 'token' attribute must be of type string, in rule: "+t);{const n={token:i.token};if(i.token.indexOf("$")>=0&&(n.tokenSubst=!0),"string"==typeof i.bracket)if("@open"===i.bracket)n.bracket=1;else{if("@close"!==i.bracket)throw createError(e,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+t);n.bracket=-1}if(i.next){if("string"!=typeof i.next)throw createError(e,"the next state must be a string value in rule: "+t);{let o=i.next;if(!/^(@pop|@push|@popall)$/.test(o)&&("@"===o[0]&&(o=o.substr(1)),o.indexOf("$")<0&&!stateExists(e,substituteMatches(e,o,"",[],""))))throw createError(e,"the next state '"+i.next+"' is not defined in rule: "+t);n.next=o}}return"number"==typeof i.goBack&&(n.goBack=i.goBack),"string"==typeof i.switchTo&&(n.switchTo=i.switchTo),"string"==typeof i.log&&(n.log=i.log),"string"==typeof i.nextEmbedded&&(n.nextEmbedded=i.nextEmbedded,e.usesEmbedded=!0),n}}if(Array.isArray(i)){const n=[];for(let o=0,r=i.length;o<r;o++)n[o]=compileAction(e,t,i[o]);return{group:n}}if(i.cases){const n=[];for(let r in i.cases)if(i.cases.hasOwnProperty(r)){const o=compileAction(e,t,i.cases[r]);"@default"===r||"@"===r||""===r?n.push({test:void 0,value:o,name:r}):"@eos"===r?n.push({test:function(e,t,i,n){return n},value:o,name:r}):n.push(createGuard(e,t,r,o))}const o=e.defaultToken;return{test:function(e,t,i,r){for(const o of n){if(!o.test||o.test(e,t,i,r))return o.value}return o}}}throw createError(e,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+t)}return{token:""}}StandaloneDiffEditor=__decorate([__param(2,IInstantiationService),__param(3,IContextKeyService),__param(4,IEditorWorkerService),__param(5,ICodeEditorService),__param(6,IStandaloneThemeService),__param(7,INotificationService),__param(8,IConfigurationService),__param(9,IContextMenuService),__param(10,IEditorProgressService),__param(11,IClipboardService)],StandaloneDiffEditor);class Rule{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if("string"==typeof t)i=t;else{if(!(t instanceof RegExp))throw createError(e,"rules must start with a match string or regular expression: "+this.name);i=t.source}this.matchOnlyAtLineStart=i.length>0&&"^"===i[0],this.name=this.name+": "+i,this.regex=compileRegExp(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")")}setAction(e,t){this.action=compileAction(e,this.name,t)}}function compile(e,t){if(!t||"object"!=typeof t)throw new Error("Monarch: expecting a language definition object");const i={};i.languageId=e,i.includeLF=bool(t.includeLF,!1),i.noThrow=!1,i.maxStack=100,i.start="string"==typeof t.start?t.start:null,i.ignoreCase=bool(t.ignoreCase,!1),i.unicode=bool(t.unicode,!1),i.tokenPostfix=string(t.tokenPostfix,"."+i.languageId),i.defaultToken=string(t.defaultToken,"source"),i.usesEmbedded=!1;const n=t;function o(e,r,s){for(const a of s){let s=a.include;if(s){if("string"!=typeof s)throw createError(i,"an 'include' attribute must be a string at: "+e);if("@"===s[0]&&(s=s.substr(1)),!t.tokenizer[s])throw createError(i,"include target '"+s+"' is not defined at: "+e);o(e+"."+s,r,t.tokenizer[s])}else{const t=new Rule(e);if(Array.isArray(a)&&a.length>=1&&a.length<=3)if(t.setRegex(n,a[0]),a.length>=3)if("string"==typeof a[1])t.setAction(n,{token:a[1],next:a[2]});else{if("object"!=typeof a[1])throw createError(i,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+e);{const e=a[1];e.next=a[2],t.setAction(n,e)}}else t.setAction(n,a[1]);else{if(!a.regex)throw createError(i,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+e);a.name&&"string"==typeof a.name&&(t.name=a.name),a.matchOnlyAtStart&&(t.matchOnlyAtLineStart=bool(a.matchOnlyAtLineStart,!1)),t.setRegex(n,a.regex),t.setAction(n,a.action)}r.push(t)}}}if(n.languageId=e,n.includeLF=i.includeLF,n.ignoreCase=i.ignoreCase,n.unicode=i.unicode,n.noThrow=i.noThrow,n.usesEmbedded=i.usesEmbedded,n.stateNames=t.tokenizer,n.defaultToken=i.defaultToken,!t.tokenizer||"object"!=typeof t.tokenizer)throw createError(i,"a language definition must define the 'tokenizer' attribute as an object");i.tokenizer=[];for(let s in t.tokenizer)if(t.tokenizer.hasOwnProperty(s)){i.start||(i.start=s);const e=t.tokenizer[s];i.tokenizer[s]=new Array,o("tokenizer."+s,i.tokenizer[s],e)}if(i.usesEmbedded=n.usesEmbedded,t.brackets){if(!Array.isArray(t.brackets))throw createError(i,"the 'brackets' attribute must be defined as an array")}else t.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const r=[];for(let s of t.brackets){let e=s;if(e&&Array.isArray(e)&&3===e.length&&(e={token:e[2],open:e[0],close:e[1]}),e.open===e.close)throw createError(i,"open and close brackets in a 'brackets' attribute must be different: "+e.open+"\n hint: use the 'bracket' attribute if matching on equal brackets is required.");if("string"!=typeof e.open||"string"!=typeof e.token||"string"!=typeof e.close)throw createError(i,"every element in the 'brackets' array must be a '{open,close,token}' object or array");r.push({token:e.token+i.tokenPostfix,open:fixCase(i,e.open),close:fixCase(i,e.close)})}return i.brackets=r,i.noThrow=!0,i}var __awaiter=globalThis&&globalThis.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{l(n.next(e))}catch(e2){r(e2)}}function a(e){try{l(n.throw(e))}catch(e2){r(e2)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))},_a;function register(e){ModesRegistry.registerLanguage(e)}function getLanguages(){let e=[];return e=e.concat(ModesRegistry.getLanguages()),e}function getEncodedLanguageId(e){return StandaloneServices.get(ILanguageService).languageIdCodec.encodeLanguageId(e)}function onLanguage(e,t){const i=StandaloneServices.get(ILanguageService).onDidEncounterLanguage((n=>{n===e&&(i.dispose(),t())}));return i}function setLanguageConfiguration(e,t){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(e))throw new Error(`Cannot set configuration for unknown language ${e}`);return LanguageConfigurationRegistry.register(e,t,100)}class EncodedTokenizationSupportAdapter{constructor(e,t){this._languageId=e,this._actual=t}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if("function"==typeof this._actual.tokenize)return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new EncodedTokenizationResult(n.tokens,n.endState)}}class TokenizationSupportAdapter{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let o=0,r=e.length;o<r;o++){const r=e[o];let s=r.startIndex;0===o?s=0:s<n&&(s=n),i[o]=new Token$2(s,r.scopes,t),n=s}return i}static adaptTokenize(e,t,i,n){const o=t.tokenize(i,n),r=TokenizationSupportAdapter._toClassicTokens(o.tokens,e);let s;return s=o.endState.equals(n)?n:o.endState,new TokenizationResult(r,s)}tokenize(e,t,i){return TokenizationSupportAdapter.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,o=[];let r=0,s=0;for(let l=0,d=t.length;l<d;l++){const e=t[l],a=n.match(i,e.scopes);if(r>0&&o[r-1]===a)continue;let d=e.startIndex;0===l?d=0:d<s&&(d=s),o[r++]=d,o[r++]=a,s=d}const a=new Uint32Array(r);for(let l=0;l<r;l++)a[l]=o[l];return a}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),o=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let r;return r=n.endState.equals(i)?i:n.endState,new EncodedTokenizationResult(o,r)}}function isATokensProvider(e){return"function"==typeof e.getInitialState}function isEncodedTokensProvider(e){return"tokenizeEncoded"in e}function isThenable(e){return e&&"function"==typeof e.then}function setColorMap(e){const t=StandaloneServices.get(IStandaloneThemeService);if(e){const i=[null];for(let t=1,n=e.length;t<n;t++)i[t]=Color.fromHex(e[t]);t.setColorMapOverride(i)}else t.setColorMapOverride(null)}function createTokenizationSupportAdapter(e,t){return isEncodedTokensProvider(t)?new EncodedTokenizationSupportAdapter(e,t):new TokenizationSupportAdapter(e,t,StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService))}function registerTokensProviderFactory(e,t){const i={createTokenizationSupport:()=>__awaiter(this,void 0,void 0,(function*(){const i=yield Promise.resolve(t.create());return i?isATokensProvider(i)?createTokenizationSupportAdapter(e,i):new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),e,compile(e,i)):null}))};return TokenizationRegistry.registerFactory(e,i)}function setTokensProvider(e,t){if(!StandaloneServices.get(ILanguageService).isRegisteredLanguageId(e))throw new Error(`Cannot set tokens provider for unknown language ${e}`);return isThenable(t)?registerTokensProviderFactory(e,{create:()=>t}):TokenizationRegistry.register(e,createTokenizationSupportAdapter(e,t))}function setMonarchTokensProvider(e,t){return isThenable(t)?registerTokensProviderFactory(e,{create:()=>t}):TokenizationRegistry.register(e,(i=t,new MonarchTokenizer(StandaloneServices.get(ILanguageService),StandaloneServices.get(IStandaloneThemeService),e,compile(e,i))));var i}function registerReferenceProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).referenceProvider.register(e,t)}function registerRenameProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).renameProvider.register(e,t)}function registerSignatureHelpProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).signatureHelpProvider.register(e,t)}function registerHoverProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).hoverProvider.register(e,{provideHover:(e,i,n)=>{const o=e.getWordAtPosition(i);return Promise.resolve(t.provideHover(e,i,n)).then((e=>{if(e)return!e.range&&o&&(e.range=new Range$2(i.lineNumber,o.startColumn,i.lineNumber,o.endColumn)),e.range||(e.range=new Range$2(i.lineNumber,i.column,i.lineNumber,i.column)),e}))}})}function registerDocumentSymbolProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentSymbolProvider.register(e,t)}function registerDocumentHighlightProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentHighlightProvider.register(e,t)}function registerLinkedEditingRangeProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).linkedEditingRangeProvider.register(e,t)}function registerDefinitionProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).definitionProvider.register(e,t)}function registerImplementationProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).implementationProvider.register(e,t)}function registerTypeDefinitionProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).typeDefinitionProvider.register(e,t)}function registerCodeLensProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).codeLensProvider.register(e,t)}function registerCodeActionProvider(e,t,i){return StandaloneServices.get(ILanguageFeaturesService).codeActionProvider.register(e,{providedCodeActionKinds:null==i?void 0:i.providedCodeActionKinds,provideCodeActions:(e,i,n,o)=>{const r=StandaloneServices.get(IMarkerService).read({resource:e.uri}).filter((e=>Range$2.areIntersectingOrTouching(e,i)));return t.provideCodeActions(e,i,{markers:r,only:n.only},o)},resolveCodeAction:t.resolveCodeAction})}function registerDocumentFormattingEditProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentFormattingEditProvider.register(e,t)}function registerDocumentRangeFormattingEditProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentRangeFormattingEditProvider.register(e,t)}function registerOnTypeFormattingEditProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).onTypeFormattingEditProvider.register(e,t)}function registerLinkProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).linkProvider.register(e,t)}function registerCompletionItemProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).completionProvider.register(e,t)}function registerColorProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).colorProvider.register(e,t)}function registerFoldingRangeProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).foldingRangeProvider.register(e,t)}function registerDeclarationProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).declarationProvider.register(e,t)}function registerSelectionRangeProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).selectionRangeProvider.register(e,t)}function registerDocumentSemanticTokensProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentSemanticTokensProvider.register(e,t)}function registerDocumentRangeSemanticTokensProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).documentRangeSemanticTokensProvider.register(e,t)}function registerInlineCompletionsProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).inlineCompletionsProvider.register(e,t)}function registerInlayHintsProvider(e,t){return StandaloneServices.get(ILanguageFeaturesService).inlayHintsProvider.register(e,t)}function createMonacoLanguagesAPI(){return{register:register,getLanguages:getLanguages,onLanguage:onLanguage,getEncodedLanguageId:getEncodedLanguageId,setLanguageConfiguration:setLanguageConfiguration,setColorMap:setColorMap,registerTokensProviderFactory:registerTokensProviderFactory,setTokensProvider:setTokensProvider,setMonarchTokensProvider:setMonarchTokensProvider,registerReferenceProvider:registerReferenceProvider,registerRenameProvider:registerRenameProvider,registerCompletionItemProvider:registerCompletionItemProvider,registerSignatureHelpProvider:registerSignatureHelpProvider,registerHoverProvider:registerHoverProvider,registerDocumentSymbolProvider:registerDocumentSymbolProvider,registerDocumentHighlightProvider:registerDocumentHighlightProvider,registerLinkedEditingRangeProvider:registerLinkedEditingRangeProvider,registerDefinitionProvider:registerDefinitionProvider,registerImplementationProvider:registerImplementationProvider,registerTypeDefinitionProvider:registerTypeDefinitionProvider,registerCodeLensProvider:registerCodeLensProvider,registerCodeActionProvider:registerCodeActionProvider,registerDocumentFormattingEditProvider:registerDocumentFormattingEditProvider,registerDocumentRangeFormattingEditProvider:registerDocumentRangeFormattingEditProvider,registerOnTypeFormattingEditProvider:registerOnTypeFormattingEditProvider,registerLinkProvider:registerLinkProvider,registerColorProvider:registerColorProvider,registerFoldingRangeProvider:registerFoldingRangeProvider,registerDeclarationProvider:registerDeclarationProvider,registerSelectionRangeProvider:registerSelectionRangeProvider,registerDocumentSemanticTokensProvider:registerDocumentSemanticTokensProvider,registerDocumentRangeSemanticTokensProvider:registerDocumentRangeSemanticTokensProvider,registerInlineCompletionsProvider:registerInlineCompletionsProvider,registerInlayHintsProvider:registerInlayHintsProvider,DocumentHighlightKind:DocumentHighlightKind,CompletionItemKind:CompletionItemKind,CompletionItemTag:CompletionItemTag,CompletionItemInsertTextRule:CompletionItemInsertTextRule,SymbolKind:SymbolKind,SymbolTag:SymbolTag,IndentAction:IndentAction,CompletionTriggerKind:CompletionTriggerKind,SignatureHelpTriggerKind:SignatureHelpTriggerKind,InlayHintKind:InlayHintKind,InlineCompletionTriggerKind:InlineCompletionTriggerKind,FoldingRangeKind:FoldingRangeKind}}EditorOptions.wrappingIndent.defaultValue=0,EditorOptions.glyphMargin.defaultValue=!1,EditorOptions.autoIndent.defaultValue=3,EditorOptions.overviewRulerLanes.defaultValue=2,FormattingConflicts.setFormatterSelector(((e,t,i)=>Promise.resolve(e[0])));const api=createMonacoBaseAPI();api.editor=createMonacoEditorAPI(),api.languages=createMonacoLanguagesAPI();const CancellationTokenSource=api.CancellationTokenSource,Emitter=api.Emitter,KeyCode=api.KeyCode,KeyMod=api.KeyMod,Position=api.Position,Range=api.Range,Selection=api.Selection,SelectionDirection=api.SelectionDirection,MarkerSeverity=api.MarkerSeverity,MarkerTag=api.MarkerTag,Uri=api.Uri,Token=api.Token,editor=api.editor,languages=api.languages;((null===(_a=globals.MonacoEnvironment)||void 0===_a?void 0:_a.globalAPI)||"function"==typeof define&&define.amd)&&(self.monaco=api),void 0!==self.require&&"function"==typeof self.require.config&&self.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});var monaco_editor_core_star=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:CancellationTokenSource,Emitter:Emitter,KeyCode:KeyCode,KeyMod:KeyMod,Position:Position,Range:Range,Selection:Selection,SelectionDirection:SelectionDirection,MarkerSeverity:MarkerSeverity,MarkerTag:MarkerTag,Uri:Uri,Token:Token,editor:editor,languages:languages},Symbol.toStringTag,{value:"Module"})),__defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__getOwnPropNames$2=Object.getOwnPropertyNames,__hasOwnProp$2=Object.prototype.hasOwnProperty,__reExport$2=(e,t,i,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames$2(t))__hasOwnProp$2.call(e,o)||!i&&"default"===o||__defProp$2(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc$2(t,o))||n.enumerable});return e},typescriptVersion="4.5.5",monaco_editor_core_exports$2={};
/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.33.0(4b1abad427e58dbedc1215d99a0902ffc885fcd4)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/__reExport$2(monaco_editor_core_exports$2,monaco_editor_core_star);var ModuleKind=(e=>(e[e.None=0]="None",e[e.CommonJS=1]="CommonJS",e[e.AMD=2]="AMD",e[e.UMD=3]="UMD",e[e.System=4]="System",e[e.ES2015=5]="ES2015",e[e.ESNext=99]="ESNext",e))(ModuleKind||{}),JsxEmit=(e=>(e[e.None=0]="None",e[e.Preserve=1]="Preserve",e[e.React=2]="React",e[e.ReactNative=3]="ReactNative",e[e.ReactJSX=4]="ReactJSX",e[e.ReactJSXDev=5]="ReactJSXDev",e))(JsxEmit||{}),NewLineKind=(e=>(e[e.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",e[e.LineFeed=1]="LineFeed",e))(NewLineKind||{}),ScriptTarget=(e=>(e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ES2018=5]="ES2018",e[e.ES2019=6]="ES2019",e[e.ES2020=7]="ES2020",e[e.ESNext=99]="ESNext",e[e.JSON=100]="JSON",e[e.Latest=99]="Latest",e))(ScriptTarget||{}),ModuleResolutionKind=(e=>(e[e.Classic=1]="Classic",e[e.NodeJs=2]="NodeJs",e))(ModuleResolutionKind||{}),LanguageServiceDefaultsImpl$1=class{constructor(e,t,i,n){__publicField(this,"_onDidChange",new monaco_editor_core_exports$2.Emitter),__publicField(this,"_onDidExtraLibsChange",new monaco_editor_core_exports$2.Emitter),__publicField(this,"_extraLibs"),__publicField(this,"_removedExtraLibs"),__publicField(this,"_eagerModelSync"),__publicField(this,"_compilerOptions"),__publicField(this,"_diagnosticsOptions"),__publicField(this,"_workerOptions"),__publicField(this,"_onDidExtraLibsChangeTimeout"),__publicField(this,"_inlayHintsOptions"),this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(e),this.setDiagnosticsOptions(t),this.setWorkerOptions(i),this.setInlayHintsOptions(n),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(e,t){let i;if(i=void 0===t?`ts:extralib-${Math.random().toString(36).substring(2,15)}`:t,this._extraLibs[i]&&this._extraLibs[i].content===e)return{dispose:()=>{}};let n=1;return this._removedExtraLibs[i]&&(n=this._removedExtraLibs[i]+1),this._extraLibs[i]&&(n=this._extraLibs[i].version+1),this._extraLibs[i]={content:e,version:n},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let e=this._extraLibs[i];e&&e.version===n&&(delete this._extraLibs[i],this._removedExtraLibs[i]=n,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(e){for(const t in this._extraLibs)this._removedExtraLibs[t]=this._extraLibs[t].version;if(this._extraLibs=Object.create(null),e&&e.length>0)for(const t of e){const e=t.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,i=t.content;let n=1;this._removedExtraLibs[e]&&(n=this._removedExtraLibs[e]+1),this._extraLibs[e]={content:i,version:n}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){-1===this._onDidExtraLibsChangeTimeout&&(this._onDidExtraLibsChangeTimeout=window.setTimeout((()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)}),0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(e){this._compilerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(e){this._workerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(e){this._inlayHintsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(e){}setEagerModelSync(e){this._eagerModelSync=e}getEagerModelSync(){return this._eagerModelSync}},typescriptVersion2=typescriptVersion,typescriptDefaults=new LanguageServiceDefaultsImpl$1({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{}),javascriptDefaults=new LanguageServiceDefaultsImpl$1({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{}),getTypeScriptWorker=()=>getMode$1().then((e=>e.getTypeScriptWorker())),getJavaScriptWorker=()=>getMode$1().then((e=>e.getJavaScriptWorker()));function getMode$1(){return __vitePreload((()=>import("./tsMode.2c416649.js")),["assets/tsMode.2c416649.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}monaco_editor_core_exports$2.languages.typescript={ModuleKind:ModuleKind,JsxEmit:JsxEmit,NewLineKind:NewLineKind,ScriptTarget:ScriptTarget,ModuleResolutionKind:ModuleResolutionKind,typescriptVersion:typescriptVersion2,typescriptDefaults:typescriptDefaults,javascriptDefaults:javascriptDefaults,getTypeScriptWorker:getTypeScriptWorker,getJavaScriptWorker:getJavaScriptWorker},monaco_editor_core_exports$2.languages.onLanguage("typescript",(()=>getMode$1().then((e=>e.setupTypeScript(typescriptDefaults))))),monaco_editor_core_exports$2.languages.onLanguage("javascript",(()=>getMode$1().then((e=>e.setupJavaScript(javascriptDefaults)))));
/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.33.0(4b1abad427e58dbedc1215d99a0902ffc885fcd4)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__getOwnPropNames$1=Object.getOwnPropertyNames,__hasOwnProp$1=Object.prototype.hasOwnProperty,__reExport$1=(e,t,i,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames$1(t))__hasOwnProp$1.call(e,o)||!i&&"default"===o||__defProp$1(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc$1(t,o))||n.enumerable});return e},monaco_editor_core_exports$1={};__reExport$1(monaco_editor_core_exports$1,monaco_editor_core_star);var LanguageServiceDefaultsImpl=class{constructor(e,t,i){__publicField(this,"_onDidChange",new monaco_editor_core_exports$1.Emitter),__publicField(this,"_diagnosticsOptions"),__publicField(this,"_modeConfiguration"),__publicField(this,"_languageId"),this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},diagnosticDefault={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},modeConfigurationDefault={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},jsonDefaults=new LanguageServiceDefaultsImpl("json",diagnosticDefault,modeConfigurationDefault);function getMode(){return __vitePreload((()=>import("./jsonMode.b3c34aa1.js")),["assets/jsonMode.b3c34aa1.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}monaco_editor_core_exports$1.languages.json={jsonDefaults:jsonDefaults},monaco_editor_core_exports$1.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]}),monaco_editor_core_exports$1.languages.onLanguage("json",(()=>{getMode().then((e=>e.setupMode(jsonDefaults)))}));
/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.33.0(4b1abad427e58dbedc1215d99a0902ffc885fcd4)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/
var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__reExport=(e,t,i,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames(t))__hasOwnProp.call(e,o)||!i&&"default"===o||__defProp(e,o,{get:()=>t[o],enumerable:!(n=__getOwnPropDesc(t,o))||n.enumerable});return e},monaco_editor_core_exports={};__reExport(monaco_editor_core_exports,monaco_editor_core_star);var languageDefinitions={},lazyLanguageLoaders={},LazyLanguageLoader=class{constructor(e){__publicField(this,"_languageId"),__publicField(this,"_loadingTriggered"),__publicField(this,"_lazyLoadPromise"),__publicField(this,"_lazyLoadPromiseResolve"),__publicField(this,"_lazyLoadPromiseReject"),this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise(((e,t)=>{this._lazyLoadPromiseResolve=e,this._lazyLoadPromiseReject=t}))}static getOrCreate(e){return lazyLanguageLoaders[e]||(lazyLanguageLoaders[e]=new LazyLanguageLoader(e)),lazyLanguageLoaders[e]}load(){return this._loadingTriggered||(this._loadingTriggered=!0,languageDefinitions[this._languageId].loader().then((e=>this._lazyLoadPromiseResolve(e)),(e=>this._lazyLoadPromiseReject(e)))),this._lazyLoadPromise}};function registerLanguage(e){const t=e.id;languageDefinitions[t]=e,monaco_editor_core_exports.languages.register(e);const i=LazyLanguageLoader.getOrCreate(t);monaco_editor_core_exports.languages.registerTokensProviderFactory(t,{create:()=>__async(this,null,(function*(){return(yield i.load()).language}))}),monaco_editor_core_exports.languages.onLanguage(t,(()=>__async(this,null,(function*(){const e=yield i.load();monaco_editor_core_exports.languages.setLanguageConfiguration(t,e.conf)}))))}registerLanguage({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>__vitePreload((()=>import("./abap.bfbdc491.js")),[])}),registerLanguage({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>__vitePreload((()=>import("./apex.3a0bbd36.js")),[])}),registerLanguage({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>__vitePreload((()=>import("./azcli.2a21dcc8.js")),[])}),registerLanguage({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>__vitePreload((()=>import("./bat.cfc9382a.js")),[])}),registerLanguage({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>__vitePreload((()=>import("./bicep.1efc561e.js")),[])}),registerLanguage({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>__vitePreload((()=>import("./cameligo.94bd5dcf.js")),[])}),registerLanguage({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>__vitePreload((()=>import("./clojure.8543305e.js")),[])}),registerLanguage({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>__vitePreload((()=>import("./coffee.de0bee73.js")),[])}),registerLanguage({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>__vitePreload((()=>import("./cpp.2c1314ec.js")),[])}),registerLanguage({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>__vitePreload((()=>import("./cpp.2c1314ec.js")),[])}),registerLanguage({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>__vitePreload((()=>import("./csharp.3ef4312c.js")),[])}),registerLanguage({id:"csp",extensions:[],aliases:["CSP","csp"],loader:()=>__vitePreload((()=>import("./csp.078b1205.js")),[])}),registerLanguage({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>__vitePreload((()=>import("./css.28b1e2dc.js")),[])}),registerLanguage({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>__vitePreload((()=>import("./dart.72c9207c.js")),[])}),registerLanguage({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>__vitePreload((()=>import("./dockerfile.eea0f5a9.js")),[])}),registerLanguage({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>__vitePreload((()=>import("./ecl.5e0f116e.js")),[])}),registerLanguage({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>__vitePreload((()=>import("./elixir.0c870cc0.js")),[])}),registerLanguage({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>__vitePreload((()=>import("./flow9.ddcaa44f.js")),[])}),registerLanguage({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>__vitePreload((()=>import("./fsharp.637308b5.js")),[])}),registerLanguage({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagAutoInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagAngleInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagBracketInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagAngleInterpolationBracket))}),registerLanguage({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagBracketInterpolationBracket))}),registerLanguage({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagAutoInterpolationDollar))}),registerLanguage({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>__vitePreload((()=>import("./freemarker2.4e149919.js")),["assets/freemarker2.4e149919.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"]).then((e=>e.TagAutoInterpolationBracket))}),registerLanguage({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>__vitePreload((()=>import("./go.a5321182.js")),[])}),registerLanguage({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>__vitePreload((()=>import("./graphql.e74c3061.js")),[])}),registerLanguage({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>__vitePreload((()=>import("./handlebars.43f81f97.js")),["assets/handlebars.43f81f97.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>__vitePreload((()=>import("./hcl.980f5800.js")),[])}),registerLanguage({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>__vitePreload((()=>import("./html.39059aa1.js")),["assets/html.39059aa1.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>__vitePreload((()=>import("./ini.a565700d.js")),[])}),registerLanguage({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>__vitePreload((()=>import("./java.b5b4e25c.js")),[])}),registerLanguage({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>__vitePreload((()=>import("./javascript.41d4878a.js")),["assets/javascript.41d4878a.js","assets/typescript.ac4ab0b2.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>__vitePreload((()=>import("./julia.4b9526f0.js")),[])}),registerLanguage({id:"kotlin",extensions:[".kt"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>__vitePreload((()=>import("./kotlin.16b1631b.js")),[])}),registerLanguage({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>__vitePreload((()=>import("./less.dfb20244.js")),[])}),registerLanguage({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>__vitePreload((()=>import("./lexon.2174f6b1.js")),[])}),registerLanguage({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>__vitePreload((()=>import("./lua.1b53f8d4.js")),[])}),registerLanguage({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>__vitePreload((()=>import("./liquid.a9cad6e2.js")),["assets/liquid.a9cad6e2.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>__vitePreload((()=>import("./m3.467f962e.js")),[])}),registerLanguage({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>__vitePreload((()=>import("./markdown.559a7ab3.js")),[])}),registerLanguage({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>__vitePreload((()=>import("./mips.d8754138.js")),[])}),registerLanguage({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>__vitePreload((()=>import("./msdax.6f267d6f.js")),[])}),registerLanguage({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>__vitePreload((()=>import("./mysql.af01dff1.js")),[])}),registerLanguage({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>__vitePreload((()=>import("./objective-c.b75ffb36.js")),[])}),registerLanguage({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>__vitePreload((()=>import("./pascal.44875784.js")),[])}),registerLanguage({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>__vitePreload((()=>import("./pascaligo.0522f100.js")),[])}),registerLanguage({id:"perl",extensions:[".pl"],aliases:["Perl","pl"],loader:()=>__vitePreload((()=>import("./perl.a7f16129.js")),[])}),registerLanguage({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>__vitePreload((()=>import("./pgsql.e49c480b.js")),[])}),registerLanguage({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>__vitePreload((()=>import("./php.9456e17c.js")),[])}),registerLanguage({id:"pla",extensions:[".pla"],loader:()=>__vitePreload((()=>import("./pla.e446910d.js")),[])}),registerLanguage({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>__vitePreload((()=>import("./postiats.51572fcb.js")),[])}),registerLanguage({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>__vitePreload((()=>import("./powerquery.c06fb3d4.js")),[])}),registerLanguage({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>__vitePreload((()=>import("./powershell.edac1ff2.js")),[])}),registerLanguage({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>__vitePreload((()=>import("./protobuf.9ea19330.js")),[])}),registerLanguage({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>__vitePreload((()=>import("./pug.9be1efca.js")),[])}),registerLanguage({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>__vitePreload((()=>import("./python.f2fa2b69.js")),["assets/python.f2fa2b69.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>__vitePreload((()=>import("./qsharp.e9c3e37c.js")),[])}),registerLanguage({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>__vitePreload((()=>import("./r.000b11e3.js")),[])}),registerLanguage({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>__vitePreload((()=>import("./razor.31142d0f.js")),["assets/razor.31142d0f.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>__vitePreload((()=>import("./redis.fb351a5f.js")),[])}),registerLanguage({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>__vitePreload((()=>import("./redshift.facc4811.js")),[])}),registerLanguage({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>__vitePreload((()=>import("./restructuredtext.03b9c8d7.js")),[])}),registerLanguage({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>__vitePreload((()=>import("./ruby.ac07c398.js")),[])}),registerLanguage({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>__vitePreload((()=>import("./rust.7956447c.js")),[])}),registerLanguage({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>__vitePreload((()=>import("./sb.64f7ffe9.js")),[])}),registerLanguage({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>__vitePreload((()=>import("./scala.ab6b2e4b.js")),[])}),registerLanguage({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>__vitePreload((()=>import("./scheme.0a9f32af.js")),[])}),registerLanguage({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>__vitePreload((()=>import("./scss.bb5a3a95.js")),[])}),registerLanguage({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>__vitePreload((()=>import("./shell.11589447.js")),[])}),registerLanguage({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>__vitePreload((()=>import("./solidity.731be3c2.js")),[])}),registerLanguage({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>__vitePreload((()=>import("./sophia.96bd523a.js")),[])}),registerLanguage({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>__vitePreload((()=>import("./sparql.f4d727b3.js")),[])}),registerLanguage({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>__vitePreload((()=>import("./sql.ae52386d.js")),[])}),registerLanguage({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib"],aliases:["StructuredText","scl","stl"],loader:()=>__vitePreload((()=>import("./st.b8efae94.js")),[])}),registerLanguage({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>__vitePreload((()=>import("./swift.90f88698.js")),[])}),registerLanguage({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>__vitePreload((()=>import("./systemverilog.95aaa20b.js")),[])}),registerLanguage({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>__vitePreload((()=>import("./systemverilog.95aaa20b.js")),[])}),registerLanguage({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>__vitePreload((()=>import("./tcl.66c7f2d0.js")),[])}),registerLanguage({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>__vitePreload((()=>import("./twig.dc81619a.js")),[])}),registerLanguage({id:"typescript",extensions:[".ts",".tsx"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>__vitePreload((()=>import("./typescript.ac4ab0b2.js")),["assets/typescript.ac4ab0b2.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>__vitePreload((()=>import("./vb.e859ab61.js")),[])}),registerLanguage({id:"xml",extensions:[".xml",".dtd",".ascx",".csproj",".config",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>__vitePreload((()=>import("./xml.3ba09311.js")),["assets/xml.3ba09311.js","assets/index.122d1dde.js","assets/index.dd2a881a.css","assets/index.7098c4ad.js","assets/index.49b76023.css","assets/Skeleton.1e8f9381.js","assets/Skeleton.40326f50.css"])}),registerLanguage({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>__vitePreload((()=>import("./yaml.3fb67a35.js")),[])});var MonacoEditor=defineComponent({props:{code:{type:String,required:!0},onChange:{type:Function},height:{type:String,default:"260px"},readOnly:{type:Boolean,default:!1},language:{type:String,default:"json"}},setup(e){const t=useAppStore(),i=shallowRef(),n=ref();let o,r=!1;function s(e){const t=e.toUpperCase();return MonacoEditorThemeEnum[t]}return onMounted((()=>{const a=i.value=editor.create(n.value,{value:e.code,language:e.language,formatOnPaste:!0,tabSize:2,automaticLayout:!1,readOnly:e.readOnly,foldingStrategy:"indentation",contextmenu:!1,minimap:{enabled:!1},theme:s(t.theme),scrollBeyondLastLine:!1});o=a.onDidChangeModelContent((t=>{!r&&e.onChange&&e.onChange(a.getValue(),t)}))})),onBeforeUnmount((()=>{o&&o.dispose()})),watch((()=>t.theme),(e=>{const t=s(e);editor.setTheme(t)})),watch((()=>e.code),(e=>{const t=i.value,n=t.getModel();e!==n.getValue()&&(t.pushUndoStop(),r=!0,n.pushEditOperations([],[{range:n.getFullModelRange(),text:e}]),t.pushUndoStop(),r=!1)})),()=>createVNode("div",{class:"code-editor-wraper",style:{height:e.height},ref:n},null)}}),CodeEditor_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$8={class:"code-edit-box"},_hoisted_2$6={class:"code-edit-actins"},_hoisted_3$5={key:0},_hoisted_4$3={key:1},_hoisted_5$3={class:"code-edit-box"},_sfc_main$d=defineComponent({__name:"CodeEditor",props:{language:{default:"json"},code:null,title:null,onChange:null,readOnly:{type:Boolean},height:null},setup(e){const t=e,i=useAppStore(),n=reactive({visible:!1,isCopySuccess:!1}),o=e=>{t.onChange&&t.onChange(e)},r=()=>{n.visible=!0};function s(){t.code&&copyTextToClipboard(t.code),n.isCopySuccess=!0,setTimeout((()=>{n.isCopySuccess=!1}),1e3)}return(a,l)=>{const d=Button$1,c=Modal;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["code-edit-wraper",unref(i).device])},[createBaseVNode("div",_hoisted_1$8,[createVNode(unref(MonacoEditor),{code:t.code,readOnly:t.readOnly,onChange:o,height:e.height,language:e.language},null,8,["code","readOnly","height","language"])]),createBaseVNode("div",_hoisted_2$6,[createVNode(d,{class:"full-button",size:"small",onClick:r},{default:withCtx((()=>[createBaseVNode("span",null,[createVNode(unref(FullscreenOutlined$1))])])),_:1}),createVNode(d,{class:"copy-button",size:"small",onClick:s},{default:withCtx((()=>[n.isCopySuccess?(openBlock(),createElementBlock("span",_hoisted_3$5,[createVNode(unref(CheckOutlined))])):(openBlock(),createElementBlock("span",_hoisted_4$3,[createVNode(unref(CopyOutlined$1))]))])),_:1})])],2),createVNode(c,{visible:n.visible,"onUpdate:visible":l[0]||(l[0]=e=>n.visible=e),centered:"",title:t.title,width:"90%",footer:!1,bodyStyle:{padding:"10px"}},{default:withCtx((()=>[createBaseVNode("div",_hoisted_5$3,[createVNode(unref(MonacoEditor),{code:e.code,onChange:o,readOnly:e.readOnly,height:"calc(100vh - 150px)",language:e.language},null,8,["code","readOnly","language"])])])),_:1},8,["visible","title"])],64)}}});var CodeEditor=_export_sfc(_sfc_main$d,[["__scopeId","data-v-172c47ed"]]);const getCodeEditorHeight=e=>{const t=21*e.split("\n").length;return(t>300?300:t)+"px"},_hoisted_1$7={key:0},_hoisted_2$5={key:1},_hoisted_3$4={key:2},_sfc_main$c=defineComponent({__name:"Index",props:{detail:null},setup(e){const t=e,{t:i}=useI18n(),n=reactive({headerCode:"",queryCode:"",paramCode:"",responsesCode:""});return watchEffect((()=>{t.detail.param&&(n.paramCode=formatJsonCode(renderCodeJsonByParams(t.detail.param))),t.detail.query&&(n.queryCode=formatJsonCode(renderCodeJsonByParams(t.detail.query))),t.detail.responseSuccess&&(n.responsesCode=formatJsonCode(renderCodeJsonByParams(t.detail.responseSuccess))),t.detail.header&&(n.headerCode=formatJsonCode(renderCodeJsonByParams(t.detail.header)))})),(e,t)=>{const o=__unplugin_components_0;return openBlock(),createElementBlock("div",null,[n.headerCode?(openBlock(),createElementBlock("div",_hoisted_1$7,[createVNode(o,{title:unref(i)("apiPage.header.title")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.header.title"),code:n.headerCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.headerCode)},null,8,["title","code","height"])])):createCommentVNode("",!0),n.queryCode?(openBlock(),createElementBlock("div",_hoisted_2$5,[createVNode(o,{title:unref(i)("apiPage.query.title")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.query.title"),code:n.queryCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.queryCode)},null,8,["title","code","height"])])):createCommentVNode("",!0),n.paramCode?(openBlock(),createElementBlock("div",_hoisted_3$4,[createVNode(o,{title:unref(i)("apiPage.body.title")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.body.title"),code:n.paramCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.paramCode)},null,8,["title","code","height"])])):createCommentVNode("",!0),createVNode(o,{title:unref(i)("apiPage.responses")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.responses"),code:n.responsesCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.responsesCode)},null,8,["title","code","height"])])}}});function getPrefix(e,t=!1){return`${t?"export ":""}interface ${e}{\n`}function toCamelCase(e=""){return e.replace(/(-|_)([a-z])/g,(function(e){return e[1].toUpperCase()}))}function upperFirstLetter(e=""){return e.charAt(0).toUpperCase()+e.slice(1)}function pad(e=2){return" ".repeat(e)}const defaultConfig={outputIndent:2,rootName:"RootName",exportRoot:!0};function transformTsByParams(e,t){let i="",n="";const o=pad(t.outputIndent);return e&&e.length&&e.forEach((e=>{const r=e.require?"":"?";if("int"==e.type)i+=`${o}${e.name}${r}: number;\n`;else if("boolean"==e.type)i+=`${o}${e.name}${r}: boolean;\n`;else if("array"==e.type)if(e.children&&e.children.length){const s=`${upperFirstLetter(toCamelCase(e.name))}Item`;i+=`${o}${e.name}${r}: ${s}[];\n`;const a=transformTypeScript(e.children,__spreadProps(__spreadValues({},t),{rootName:s}));n+=`${a}`}else i+=`${o}${e.name}${r}: any[];\n`;else if("object"==e.type)if(e.children&&e.children.length){const s=`${upperFirstLetter(toCamelCase(e.name))}`;i+=`${o}${e.name}${r}: ${s};\n`;const a=transformTypeScript(e.children,__spreadProps(__spreadValues({},t),{rootName:s}));n+=`${a}`}else i+=`${o}${e.name}${r}: any[];\n`;else i+=`${o}${e.name}${r}: string;\n`})),[i,n]}function transformTypeScript(e,t={}){const i=__spreadValues(__spreadValues({},defaultConfig),t),n=getPrefix(i.rootName,i.exportRoot),[o,r]=transformTsByParams(e,i);return`${r}${n}${o}}\n\n`}const _hoisted_1$6={key:0},_hoisted_2$4={key:1},_sfc_main$b=defineComponent({__name:"Index",props:{detail:null},setup(e){const t=e,{t:i}=useI18n(),n=reactive({headerCode:"",queryCode:"",paramCode:"",responsesCode:""});return watchEffect((()=>{t.detail.param&&(n.paramCode=transformTypeScript(t.detail.param)),t.detail.query&&(n.queryCode=transformTypeScript(t.detail.query)),t.detail.responseSuccess&&(n.responsesCode=transformTypeScript(t.detail.responseSuccess))})),(e,t)=>{const o=__unplugin_components_0;return openBlock(),createElementBlock("div",null,[n.queryCode?(openBlock(),createElementBlock("div",_hoisted_1$6,[createVNode(o,{title:unref(i)("apiPage.query.title")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.query.title"),code:n.queryCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.queryCode),language:"typescript"},null,8,["title","code","height"])])):createCommentVNode("",!0),n.paramCode?(openBlock(),createElementBlock("div",_hoisted_2$4,[createVNode(o,{title:unref(i)("apiPage.body.title")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.body.title"),code:n.paramCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.paramCode),language:"typescript"},null,8,["title","code","height"])])):createCommentVNode("",!0),createVNode(o,{title:unref(i)("apiPage.responses")},null,8,["title"]),createVNode(unref(CodeEditor),{title:unref(i)("apiPage.responses"),code:n.responsesCode,readOnly:!0,height:unref(getCodeEditorHeight)(n.responsesCode),language:"typescript"},null,8,["title","code","height"])])}}}),_sfc_main$a=defineComponent({__name:"HeaderParams",props:{data:null},setup(e){const t=e,{t:i}=useI18n(),n=[{title:"Key",dataIndex:"name",width:200,align:"left"},{title:"Value",dataIndex:"default",itemRender:{name:"input"}},{title:i("common.desc"),dataIndex:"desc",width:150,align:"left"}];return(e,i)=>(openBlock(),createBlock(unref(EditTable),{columns:n,data:t.data,"is-add":!1,scroll:{x:"500px",y:"180px"}},null,8,["data"]))}}),_sfc_main$9=defineComponent({__name:"RouteParams",props:{data:null},setup(e){const t=e,{t:i}=useI18n(),n=[{title:"Key",dataIndex:"name",width:200,align:"left"},{title:"Value",dataIndex:"default",itemRender:{name:"input"}},{title:i("common.desc"),dataIndex:"desc",width:150,align:"left"}];return(e,i)=>(openBlock(),createBlock(unref(EditTable),{columns:n,data:t.data,"is-add":!1,scroll:{x:"500px",y:"180px"}},null,8,["data"]))}}),_sfc_main$8=defineComponent({__name:"QueryParams",props:{data:null},emits:["addRow","deleteRow"],setup(e,{emit:t}){const i=e,{t:n}=useI18n(),o=[{title:"Key",dataIndex:"name",width:200,align:"left",itemRender:{name:"input"}},{title:"Value",dataIndex:"default",itemRender:{name:"input"}},{title:n("common.require"),dataIndex:"require",width:100,align:"center",itemRender:{name:"check-status"}},{title:n("common.desc"),dataIndex:"desc",width:150,align:"left"},{title:n("common.action"),dataIndex:"id",width:70,align:"center",itemRender:{name:"delete-button"}}],r=()=>{t("addRow")},s=e=>{t("deleteRow",e)};return(e,t)=>(openBlock(),createBlock(unref(EditTable),{columns:o,data:i.data,"is-add":!0,onAddRow:r,onDeleteRow:s,scroll:{x:"700px",y:"170px"}},null,8,["data"]))}}),_sfc_main$7=defineComponent({__name:"BodyParams",props:{data:null},emits:["change","addRow","deleteRow"],setup(e,{emit:t}){const i=e,{t:n}=useI18n(),o=[{title:"Key",dataIndex:"name",width:200,align:"left",itemRender:{name:"input"}},{title:"Value",dataIndex:"default",itemRender:{name:"auto"}},{title:n("common.require"),dataIndex:"require",width:100,align:"center",itemRender:{name:"check-status"}},{title:n("common.desc"),dataIndex:"desc",width:150,align:"left"},{title:n("common.action"),dataIndex:"id",width:70,align:"center",itemRender:{name:"delete-button"}}],r=()=>{t("addRow")},s=e=>{t("deleteRow",e)},a=e=>{t("change",e)};return(e,t)=>(openBlock(),createElementBlock("div",null,["object"==typeof i.data?(openBlock(),createBlock(unref(EditTable),{key:0,columns:o,data:i.data,"is-add":!0,onAddRow:r,onDeleteRow:s,scroll:{x:"700px",y:"170px"}},null,8,["data"])):(openBlock(),createBlock(unref(CodeEditor),{key:1,title:unref(n)("apiPage.body.title"),code:i.data,readOnly:!1,height:"247px",language:"json",onChange:a},null,8,["title","code"]))]))}}),renderData=(e,t,i)=>{var n;const o=cloneDeep(e);return o&&o.length?i&&i[t]&&(null==(n=i[t])?void 0:n.length)?o.map((e=>{var n;const o=null==(n=i[t])?void 0:n.find((t=>t.name===e.name));return o&&o.value?e.default=o.value:e.mock&&(e.default=Mock.mock(e.mock)),e.id=createRandKey(),e})):o.map((e=>(e.mock&&(e.default=Mock.mock(e.mock)),e.id=createRandKey(),e))):[]},handleQueryParams=(e,t="")=>{if(!e||!e.length)return e;let i=[];return e.forEach((e=>{if("object"==e.type&&e.children&&e.children.length){let n=e.name;t&&(n=`${t}[${e.name}]`);const o=handleQueryParams(e.children,n);i=i.concat(o)}else if("array"==e.type&&e.children&&e.children.length){const t=`${e.name}[0]`,n=handleQueryParams(e.children,t);i=i.concat(n)}else t&&(e.name=`${t}[${e.name}]`),e.mock&&(e.default=Mock.mock(e.mock)),i.push(e)})),i};var ParamTypeEnum=(e=>(e.HEADER="header",e.QUERY="query",e.BODY="body",e.ROUTEPARAM="routeParam",e))(ParamTypeEnum||{});const paramTypeKeys=["header","query","body"];(()=>{const e=new Map;e.set("header","headers"),e.set("query","params"),e.set("body","data")})();const mergeGlobalParams=(e,t,i,n)=>(paramTypeKeys.forEach((o=>{var r,s;t&&t[o]&&(null==(r=t[o])?void 0:r.length)&&(null==(s=t[o])||s.forEach((t=>{!t.name||!t.value||t.appKey&&"all"!==t.appKey&&t.appKey!==n||e[o][t.name]||0==e[o][t.name]||"boolean"==typeof e[o][t.name]||(e[o][t.name]=!1!==i.HTTP.ENCODEURICOMPONENT&&o!=ParamTypeEnum.BODY?encodeURIComponent(t.value):t.value)})))})),e),formatTime=(e=new Date,t="hh:mm:ss")=>{const i={y:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};return t.replace(/(y+|M+|d+|h+|m+|s+)/g,(function(e){return((e.length>1?"0":"")+i[e.slice(-1)]).slice(-(e.length>2?e.length:2))}))},setGolbalParam=(e,t,i,n,o)=>{var r,s,a;o||(o="all");const l=useApidocOutsideStore(),d=l.globalParams;if(d&&d[e]&&(null==(r=d[e])?void 0:r.length)){const r=null==(s=d[e])?void 0:s.findIndex((e=>e.name===t)),l=d[e];"number"==typeof r&&r>-1&&l?l[r].value=i:null==(a=d[e])||a.push({id:createRandKey(),name:t,value:i,desc:n,appKey:o})}else d[e]=[{id:createRandKey(),name:t,value:i,desc:n,appKey:o}];l.setGlobalParams(d)},removeGolbalParam=(e,t)=>{var i,n;const o=useApidocOutsideStore(),r=o.globalParams;r&&r[e]&&(null==(i=r[e])?void 0:i.length)&&(r[e]=null==(n=r[e])?void 0:n.filter((e=>e.name!==t))),o.setGlobalParams(r)},feConfig=apidocFeConfig,events={setHeader:(e,t,i)=>new Promise(((n,o)=>{if(e.key){t.headers[e.key]=!1!==(null==feConfig?void 0:feConfig.HTTP.ENCODEURICOMPONENT)?encodeURIComponent(i):i;n({event:e,json:t,value:i})}else o()})),setQuery:(e,t,i)=>new Promise(((n,o)=>{if(e.key){t.params[e.key]=i;n({event:e,json:t,value:i})}else o()})),setBody:(e,t,i)=>new Promise(((n,o)=>{if(e.key){t.data[e.key]=i;n({event:e,json:t,value:i})}else o()})),clearHeader:(e,t,i)=>new Promise(((i,n)=>{if(e.key){delete t.headers[e.key];i({event:e,json:t})}else n()})),clearQuery:(e,t,i)=>new Promise(((i,n)=>{if(e.key){delete t.params[e.key];i({event:e,json:t})}else n()})),clearBody:(e,t,i)=>new Promise(((i,n)=>{if(e.key){delete t.data[e.key];i({event:e,json:t})}else n()})),setGlobalHeader:(e,t,i)=>new Promise(((n,o)=>{if(e.key){setGolbalParam("header",e.key,i,e.desc,e.appKey);n({event:e,json:t,value:i})}else o()})),setGlobalQuery:(e,t,i)=>new Promise(((n,o)=>{if(e.key){setGolbalParam("query",e.key,i,e.desc,e.appKey);n({event:e,json:t,value:i})}else o()})),setGlobalBody:(e,t,i)=>new Promise(((n,o)=>{if(e.key){setGolbalParam("body",e.key,i,e.desc,e.appKey);n({event:e,json:t,value:i})}else o()})),clearGlobalHeader:(e,t,i)=>new Promise(((i,n)=>{if(e.key){removeGolbalParam("header",e.key);i({event:e,json:t})}else n()})),clearGlobalQuery:(e,t,i)=>new Promise(((i,n)=>{if(e.key){removeGolbalParam("query",e.key);i({event:e,json:t})}else n()})),clearGlobalBody:(e,t,i)=>new Promise(((i,n)=>{if(e.key){removeGolbalParam("body",e.key);i({event:e,json:t})}else n()})),ajax(e,t){const i=t.params;return new Promise(((n,o)=>{var r,s;if(e.url){const a={method:e.method?e.method.toLowerCase():t.method,headers:{},url:e.url};e.contentType&&(a.headers["content-type"]=e.contentType);let l={},d={};if(e.value&&isArray$1(e.value))for(let t=0;t<e.value.length;t++){const n=e.value[t];if("before"===n.type){let e=n.value;n.value&&(null==(r=n.value)?void 0:r.indexOf("query."))>-1?e=getObjectValueByKey(n.value,{query:i}):n.value&&(null==(s=n.value)?void 0:s.indexOf("body."))>-1&&(e=getObjectValueByKey(n.value,{body:i})),"setQuery"===n.event?n.key?l[n.key]=e:l=e:"setBody"===n.event?n.key?d[n.key]=e:d=e:"setHeader"===n.event&&(n.key?a.headers[n.key]=encodeURIComponent(e):isObject$1(e)&&(a.headers=e))}}a.params=l,a.data=d,request(a).then((i=>{var o;if(e.value&&isArray$1(e.value))for(let n=0;n<e.value.length;n++){const r=e.value[n];if("after"===r.type){let e=r.value;r.value&&(null==(o=r.value)?void 0:o.indexOf("res."))>-1&&(e=getObjectValueByKey(r.value,{res:i})),r.key&&"setQuery"===r.event?t.params[r.key]=e:r.key&&"setBody"===r.event?t.data[r.key]=e:r.key&&"setHeader"===r.event&&(t.headers[r.key]=!1!==feConfig.HTTP.ENCODEURICOMPONENT?encodeURIComponent(e):e)}}n({event:e,result:i,json:t})})).catch((e=>{o(e)}))}}))}};function handleRequestEvent(e,t,i){return new Promise((n=>{var o,r,s;const a={status:"default",list:[],json:{}};e&&e.length||n(a);const l=[];for(let d=0;d<e.length;d++){const n=e[d];let a=n.value;n.value&&(null==(o=n.value)?void 0:o.indexOf("params."))>-1?a=getObjectValueByKey(n.value,{params:cloneDeep(t.params)}):n.value&&(null==(r=n.value)?void 0:r.indexOf("body."))>-1?a=getObjectValueByKey(n.value,{body:cloneDeep(t.data)}):n.value&&(null==(s=n.value)?void 0:s.indexOf("res."))>-1&&(a=getObjectValueByKey(n.value,{res:i})),events[n.event]&&(a&&n.handleValue&&feConfig.DEBUG_EVENTS&&feConfig.DEBUG_EVENTS[n.handleValue]&&(a=feConfig.DEBUG_EVENTS[n.handleValue](a)),l.push(events[n.event](n,t,a)))}Promise.allSettled(l).then((t=>{let i={};a.status="success";for(let n=0;n<t.length;n++){const o=t[n];if("fulfilled"===o.status){const e=o.value;i=__spreadValues(__spreadValues({},i),e.json),a.list.push(__spreadProps(__spreadValues({},e.event),{status:"success",realValue:e.value}))}else{a.status="error";const t=e[n];a.list.push({status:"error",event:t.event})}}a.json=i,n(a)})).catch((()=>{n({status:"error",list:[],json:{}})}))}))}var useDebugApi=()=>{const apidocStore=useApidocStore(),appStore=useAppStore(),{t:t}=useI18n();function handleApiUrl(e,t){let i=e;if(t&&t.length)for(let n=0;n<t.length;n++){const e=t[n],o=[`:${e.name}`,`<${e.name}>`,`<${e.name}?>`,`[:${e.name}]`,`{${e.name}}`];for(let t=0;t<o.length;t++){const n=o[t];if(i.indexOf(n)>-1){const t=new RegExp(n,"g"),o=e.default;i=i.replace(t,o)}}}return i}function renderHeaderData(e){return e.header&&e.header.length?renderData(e.header,"header",apidocStore.globalParams):[]}function renderRouteData(e){return e.routeParam&&e.routeParam.length?renderData(e.routeParam,"routeParam",{}):[]}function renderQueryData(e){if(e.query&&e.query.length){const t=renderData(e.query,"query",apidocStore.globalParams);return handleQueryParams(t)}return[]}function renderBodyData(e,t=""){const i=null==e?void 0:e.param;return"formdata"===(null==e?void 0:e.paramType)||"array"===t?renderData(i,"body",apidocStore.globalParams):formatJsonCode(renderCodeJsonByParams(i,!0))}function renderApiParams(e,t={}){const i={};return t.header&&t.header.length?i.header=t.header:e.header&&e.header.length&&(i.header=renderHeaderData(e)),t.query&&t.query.length?i.query=t.query:e.query&&e.query.length&&(i.query=renderQueryData(e)),t.body&&t.body.length?i.body=t.body:e.param&&e.param.length&&(i.body=renderBodyData(e)),t.routeParam&&t.routeParam.length?i.routeParam=t.routeParam:e.routeParam&&e.routeParam.length&&(i.routeParam=renderRouteData(e)),i}function handleRequestParams(e,t){return __async(this,arguments,(function*(e,t,i={}){return new Promise(((n,o)=>{const r=mergeGlobalParams(t,apidocStore.globalParams,appStore.feConfig,appStore.appKey);e.contentType?r.header["content-type"]=e.contentType:"formdata"===e.paramType&&(r.header["content-type"]="application/x-www-form-urlencoded");const s=appStore.appObject[appStore.appKey],a=handleApiUrl(e.url,t.routeParam);let l="GET";e.method&&"string"==typeof e.method?l=e.method.toLowerCase():e.method&&"object"==typeof e.method&&e.method.length&&(l=e.method[0]);const d=__spreadValues({url:a,method:l,headers:r.header,params:r.query,data:r.body,baseURL:s&&s.host?s.host:void 0},i);e.before&&e.before.length?handleRequestEvent(e.before,d).then((t=>{sendRequest(e,t.json).then((e=>{e.beforeEvents=t,n(e)})).catch((e=>{e.beforeEvents=t,o(e)}))})).catch((e=>{o(e)})):sendRequest(e,d).then((e=>{n(e)})).catch((e=>{o(e)}))}))}))}function sendRequest(e,t){return new Promise(((i,n)=>{const o=Date.now();request(t).then((n=>{n.responseItme=formatTime(),n.timer=Date.now()-o,e.after&&e.after.length?handleRequestEvent(e.after,t,n.data).then((e=>{n.afterEvents=e,i(n)})):i(n)})).catch((e=>{e.responseItme=formatTime(),e.timer=Date.now()-o,n(e)}))}))}function excuteDebug(apiDetail,paramsData,options={}){return new Promise(((resolve,reject)=>{const json=renderApiParams(apiDetail,paramsData);if(json.header=renderCodeJsonByParams(paramsData.header),json.query=renderCodeJsonByParams(paramsData.query),"formdata"==apiDetail.paramType){const e=new FormData;json.body.forEach((t=>{if("file"===t.type){const i=t.default;i&&i.length&&e.append(t.name,i[0])}else if("files"===t.type){const i=t.default;if(i&&i.length)for(let n=0;n<i.length;n++){const o=i[n];e.append(`${t.name}[]`,o)}}else{const i=t.default;e.append(t.name,i)}})),handleRequestParams(apiDetail,__spreadProps(__spreadValues({},json),{body:e}),options).then((e=>{resolve(e)})).catch((e=>{reject(e)}))}else if(paramsData.body)try{const paramJson=eval("("+paramsData.body+")");handleRequestParams(apiDetail,__spreadProps(__spreadValues({},json),{body:paramJson}),options).then((e=>{resolve(e)})).catch((e=>{reject(e)}))}catch(error){reject(t("apiPage.json.formatError"))}}))}return{renderApiParams:renderApiParams,excuteDebug:excuteDebug,renderHeaderData:renderHeaderData,renderQueryData:renderQueryData,renderBodyData:renderBodyData,renderRouteData:renderRouteData}};const _hoisted_1$5={style:{height:"290px"}},_sfc_main$6=defineComponent({__name:"Index",props:{detail:null},setup(e,{expose:t}){const i=e,{t:n}=useI18n(),{renderHeaderData:o,renderQueryData:r,renderBodyData:s,renderRouteData:a}=useDebugApi(),l=ref(),d=reactive({activeTab:ParamTypeEnum.BODY,headerData:[],queryData:[],bodyData:"",disabledTabs:[],routeData:[]}),c=()=>{d.queryData.push({id:createRandKey(),name:"",value:"",desc:"",require:!1,type:"string"})},h=e=>{d.queryData=d.queryData.filter((t=>t.id!=e.id))},u=()=>{"string"!=typeof d.bodyData&&d.bodyData.push({id:createRandKey(),name:"",value:"",desc:"",require:!1,type:"string"})},g=e=>{"string"!=typeof d.bodyData&&(d.bodyData=d.bodyData.filter((t=>t.id!=e.id)))},p=()=>{d.headerData=o(i.detail),d.queryData=r(i.detail),d.bodyData=s(i.detail),d.routeData=a(i.detail)};p(),i.detail.routeParam&&i.detail.routeParam.length?d.activeTab=ParamTypeEnum.ROUTEPARAM:"GET"===i.detail.method&&"string"==typeof d.bodyData&&(d.activeTab=ParamTypeEnum.QUERY);const m=()=>{"header"===d.activeTab?d.headerData=o(i.detail):"query"===d.activeTab?d.queryData=r(i.detail):"body"===d.activeTab&&(d.bodyData=s(i.detail))},f=e=>{d.bodyData=e};return t({getData:()=>({header:d.headerData,query:d.queryData,body:d.bodyData,routeParam:d.routeData}),onReloadAllParams:p}),(e,t)=>{const i=__unplugin_components_3$1,o=Button$1,r=__unplugin_components_2$1,s=Tabs;return openBlock(),createElementBlock("div",_hoisted_1$5,[createVNode(s,{activeKey:d.activeTab,"onUpdate:activeKey":t[0]||(t[0]=e=>d.activeTab=e),type:"card",size:"small"},{rightExtra:withCtx((()=>[createVNode(r,null,{default:withCtx((()=>[createVNode(o,{onClick:m},{default:withCtx((()=>[createVNode(unref(ReloadOutlined$1)),createTextVNode(toDisplayString(unref(n)("apiPage.debug.param.reload")),1)])),_:1})])),_:1})])),default:withCtx((()=>[(openBlock(),createBlock(i,{key:unref(ParamTypeEnum).HEADER,tab:unref(n)("apiPage.debug.header")},{default:withCtx((()=>[createVNode(_sfc_main$a,{ref:"headerRef",data:d.headerData},null,8,["data"])])),_:1},8,["tab"])),d.routeData&&d.routeData.length?(openBlock(),createBlock(i,{key:unref(ParamTypeEnum).ROUTEPARAM,tab:unref(n)("apiPage.debug.routeParam")},{default:withCtx((()=>[createVNode(_sfc_main$9,{ref:"routeRef",data:d.routeData},null,8,["data"])])),_:1},8,["tab"])):createCommentVNode("",!0),(openBlock(),createBlock(i,{key:unref(ParamTypeEnum).QUERY,tab:unref(n)("apiPage.debug.query")},{default:withCtx((()=>[createVNode(_sfc_main$8,{ref:"queryRef",data:d.queryData,onAddRow:c,onDeleteRow:h},null,8,["data"])])),_:1},8,["tab"])),(openBlock(),createBlock(i,{key:unref(ParamTypeEnum).BODY,disabled:d.disabledTabs.includes(unref(ParamTypeEnum).BODY),tab:unref(n)("apiPage.debug.body")},{default:withCtx((()=>[createVNode(_sfc_main$7,{ref_key:"bodyRef",ref:l,data:d.bodyData,onChange:f,onAddRow:u,onDeleteRow:g},null,8,["data"])])),_:1},8,["disabled","tab"]))])),_:1},8,["activeKey"])])}}});var index$2="";const _hoisted_1$4={class:"event-list"},_hoisted_2$3={key:0},_hoisted_3$3={key:1},_hoisted_4$2={key:0,style:{"padding-left":"84px"}},_hoisted_5$2={key:0},_hoisted_6$2={key:1},_hoisted_7$1={key:2},_sfc_main$5=defineComponent({__name:"EventTab",props:{eventList:null},setup(e){const t=e,{t:i}=useI18n();return(e,n)=>{const o=__unplugin_components_0$1,r=Badge,s=__unplugin_components_2,a=__unplugin_components_3;return openBlock(),createElementBlock("div",_hoisted_1$4,[createVNode(a,{size:"small",bordered:"","data-source":t.eventList},{renderItem:withCtx((({item:e})=>[createVNode(s,null,{default:withCtx((()=>[createVNode(r,{status:e.status?e.status:"default"},{text:withCtx((()=>[createBaseVNode("span",null,toDisplayString(unref(i)(`debug.event.${e.event}`))+"：",1),e.handleValue?(openBlock(),createElementBlock("span",_hoisted_2$3,toDisplayString(e.key)+" = "+toDisplayString(e.handleValue)+"("+toDisplayString(e.value)+")",1)):"ajax"==e.event?(openBlock(),createElementBlock("span",_hoisted_3$3,[createBaseVNode("span",null,'ajax("'+toDisplayString(e.url)+'")',1),e.value&&"object"==typeof e.value&&e.value.length?(openBlock(),createElementBlock("div",_hoisted_4$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.value,((t,n)=>(openBlock(),createElementBlock("div",{key:n,class:"mb-xs"},[createBaseVNode("span",null,[createVNode(o,{style:{width:"50px"}},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(firstToUpperCase)(t.type)),1)])),_:2},1024),createTextVNode(toDisplayString(unref(i)(`debug.event.${t.event}`))+"：",1)]),e.handleValue?(openBlock(),createElementBlock("span",_hoisted_5$2,toDisplayString(t.key)+" = "+toDisplayString(t.handleValue)+"("+toDisplayString(t.value)+")",1)):(openBlock(),createElementBlock("span",_hoisted_6$2,toDisplayString(t.key)+" "+toDisplayString(t.value?"=":"")+" "+toDisplayString(t.value),1))])))),128))])):createCommentVNode("",!0)])):(openBlock(),createElementBlock("span",_hoisted_7$1,toDisplayString(e.key)+" "+toDisplayString(e.value||e.realValue?"=":"")+" "+toDisplayString(e.realValue?e.realValue:e.value),1))])),_:2},1032,["status"])])),_:2},1024)])),_:1},8,["data-source"])])}}});var NumberBadge_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main$4=defineComponent({__name:"NumberBadge",props:{count:{default:0},type:{default:"default"}},setup(e){const t=e;return(i,n)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["number-badge",e.type])},toDisplayString(t.count),3))}});var NumberBadge=_export_sfc(_sfc_main$4,[["__scopeId","data-v-2227d6b0"]]);const _hoisted_1$3={key:0,class:"mr-xs"},_hoisted_2$2={key:1,class:"mr-xs"},_hoisted_3$2={key:2,class:"mr"},_hoisted_4$1={class:"mr"},_hoisted_5$1={key:3,class:"mr"},_hoisted_6$1={key:4},_sfc_main$3=defineComponent({__name:"ResultStatus",props:{result:null,resultStatus:null},setup(e){const t=e,{t:i}=useI18n();return(e,n)=>{const o=__unplugin_components_0$2;return t.result?(openBlock(),createBlock(o,{key:0,type:t.resultStatus,"show-icon":"",banner:""},{message:withCtx((()=>[createBaseVNode("div",null,[t.result.status&&t.result.status?(openBlock(),createElementBlock("b",_hoisted_1$3,toDisplayString(t.result.status),1)):t.result.response&&t.result.response.status?(openBlock(),createElementBlock("b",_hoisted_2$2,toDisplayString(t.result.response.status),1)):createCommentVNode("",!0),"info"==t.resultStatus?(openBlock(),createElementBlock("span",_hoisted_3$2,toDisplayString(unref(i)("apiPage.debug.notExcute")),1)):createCommentVNode("",!0),createBaseVNode("span",_hoisted_4$1,toDisplayString(t.result.message?t.result.message:t.result.statusText),1),t.result.responseItme?(openBlock(),createElementBlock("span",_hoisted_5$1,[createVNode(unref(ClockCircleOutlined$1),{class:"mr-xs"}),createBaseVNode("span",null,toDisplayString(t.result.responseItme),1)])):createCommentVNode("",!0),t.result.timer?(openBlock(),createElementBlock("span",_hoisted_6$1,[createVNode(unref(HourglassOutlined$1),{class:"mr-xs"}),createBaseVNode("span",null,toDisplayString(t.result.timer)+toDisplayString(unref(i)("common.ms")),1)])):createCommentVNode("",!0)])])),_:1},8,["type"])):createCommentVNode("",!0)}}});var Index_vue_vue_type_style_index_0_scoped_true_lang$1="";const _hoisted_1$2={key:0,class:"api-param-code"},_hoisted_2$1=["innerHTML"],_hoisted_3$1={key:1,class:"api-param-empty"},_sfc_main$2=defineComponent({__name:"Index",props:{detail:null,result:null},setup(e){const t=e,i=useAppStore(),{t:n}=useI18n(),o=reactive({events:{before:[],after:[]},activeTab:"responses",responsesCode:"",responsesHtml:"",showCodeEditor:!0,resultStatus:"info"});t.detail.before&&(o.events.before=t.detail.before),t.detail.after&&(o.events.after=t.detail.after);const r=e=>{"responses"===e&&(o.showCodeEditor=!1,setTimeout((()=>{o.showCodeEditor=!0}),10))};return watchEffect((()=>{const e=t.result;e.beforeEvents&&e.beforeEvents.list&&e.beforeEvents.list.length&&(o.events.before=e.beforeEvents.list),e.afterEvents&&e.afterEvents.list&&e.afterEvents.list.length&&(o.events.after=e.afterEvents.list),e.data&&("string"==typeof e.data?(o.responsesHtml=e.data,o.responsesCode=""):(o.responsesHtml="",o.responsesCode=formatJsonCode(e.data))),e.status||e.response?e.status>=200&&e.status<300?o.resultStatus="success":(o.resultStatus="error",e.response&&e.response.data?o.responsesCode=formatJsonCode(e.response.data):o.responsesCode=formatJsonCode(e)):o.resultStatus="info"})),(s,a)=>{const l=__unplugin_components_0$3,d=__unplugin_components_3$1,c=Tabs;return openBlock(),createElementBlock("div",null,[createVNode(c,{visible:o.activeTab,"onUpdate:visible":a[0]||(a[0]=e=>o.activeTab=e),type:"card",size:"small",class:normalizeClass([unref(i).device]),onChange:r},{rightExtra:withCtx((()=>[createVNode(_sfc_main$3,{result:t.result,resultStatus:o.resultStatus},null,8,["result","resultStatus"])])),default:withCtx((()=>[createVNode(d,{key:"responses",tab:unref(n)("apiPage.responses")},{default:withCtx((()=>[o.responsesHtml||o.responsesCode?(openBlock(),createElementBlock("div",_hoisted_1$2,[o.responsesHtml?(openBlock(),createElementBlock("div",{key:0,class:"string-code",innerHTML:o.responsesHtml},null,8,_hoisted_2$1)):createCommentVNode("",!0),o.showCodeEditor&&o.responsesCode?(openBlock(),createBlock(unref(CodeEditor),{key:1,code:o.responsesCode,readOnly:!0,title:unref(n)("apiPage.responses"),height:"300px"},null,8,["code","title"])):createCommentVNode("",!0)])):(openBlock(),createElementBlock("div",_hoisted_3$1,[createVNode(l,{description:!1})]))])),_:1},8,["tab"]),t.detail.before?(openBlock(),createBlock(d,{key:"eventBefore"},{tab:withCtx((()=>[createTextVNode(toDisplayString(unref(n)("debug.event.before"))+" ",1),createVNode(unref(NumberBadge),{count:t.detail.before.length,type:e.result.beforeEvents&&"success"==e.result.beforeEvents.status?"success":"default"},null,8,["count","type"])])),default:withCtx((()=>[createVNode(_sfc_main$5,{eventList:o.events.before},null,8,["eventList"])])),_:1})):createCommentVNode("",!0),createVNode(d,{key:"eventAfter"},{tab:withCtx((()=>{var i;return[createTextVNode(toDisplayString(unref(n)("debug.event.after"))+" ",1),createVNode(unref(NumberBadge),{count:null==(i=t.detail.after)?void 0:i.length,type:e.result.afterEvents&&"success"==e.result.afterEvents.status?"success":"default"},null,8,["count","type"])]})),default:withCtx((()=>[createVNode(_sfc_main$5,{eventList:o.events.after},null,8,["eventList"])])),_:1})])),_:1},8,["visible","class"])])}}});var Responses=_export_sfc(_sfc_main$2,[["__scopeId","data-v-84800fac"]]),Index_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1$1={class:"excute-buttons"},_sfc_main$1=defineComponent({__name:"Index",props:{detail:null,currentMethod:null},setup(e){const t=e,{t:i}=useI18n(),{excuteDebug:n}=useDebugApi(),o=ref(),r=reactive({loading:!1,resultData:{}}),s=()=>{const e=o.value.getData();n(t.detail,e,{method:t.currentMethod}).then((e=>{r.resultData=e})).catch((e=>{r.resultData=e}))},a=()=>{o.value.onReloadAllParams(),s()};return(e,n)=>{const l=Button$1;return openBlock(),createElementBlock("div",null,[createVNode(_sfc_main$6,{ref_key:"paramsRef",ref:o,detail:t.detail},null,8,["detail"]),createBaseVNode("div",_hoisted_1$1,[createVNode(l,{type:"primary",loading:r.loading,block:"",onClick:s},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(i)("apiPage.debug.excute")),1)])),_:1},8,["loading"]),createVNode(l,{type:"primary",loading:r.loading,block:"",onClick:a},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(i)("apiPage.debug.reloadParamsAndExcute")),1)])),_:1},8,["loading"])]),createVNode(Responses,{detail:t.detail,result:r.resultData},null,8,["detail","result"])])}}});var DebugTab=_export_sfc(_sfc_main$1,[["__scopeId","data-v-1c30a695"]]),index_vue_vue_type_style_index_0_scoped_true_lang="";const _hoisted_1={class:normalizeClass(["api-detail"])},_hoisted_2={key:2},_hoisted_3={class:"api-url"},_hoisted_4=["title"],_hoisted_5={class:normalizeClass(["api-url-input"])},_hoisted_6={class:"api-tabs"},_hoisted_7={key:1,class:"iconfont icon-json"},_hoisted_8={key:2,class:"iconfont icon-typescript-def"},__default__={name:"ApiDetail"},_sfc_main=defineComponent(__spreadProps(__spreadValues({},__default__),{setup(e){const t=useRoute(),i=useAppStore(),{t:n}=useI18n(),o=i.feConfig.API_DETAIL_TABS?i.feConfig.API_DETAIL_TABS:["table","json","ts","debug"],r=reactive({detail:{title:"",name:"",menuKey:"",header:[]},loading:!1,currentMethod:"",activeTab:o[0],error:{config:{},isAxiosError:!1,toJSON:()=>({}),name:"",message:""},tabs:[]}),s=computed((()=>{let e="";return r.detail.method&&"string"==typeof r.detail.method&&i.feConfig.METHOD_COLOR&&i.feConfig.METHOD_COLOR[r.detail.method]&&(e=i.feConfig.METHOD_COLOR[r.detail.method]),e})),a=()=>{copyTextToClipboard(r.detail.url),message.success(n("common.copySuccess"))},l=e=>{r.currentMethod=e};return(()=>{const e=t.query;r.loading=!0,globalApi.getApiDetail({appKey:e.appKey?e.appKey:i.appKey,path:e.key,lang:e.lang?e.lang:i.lang}).then((e=>{r.detail=e.data,r.detail.notDebug?r.tabs=o.filter((e=>"debug"!=e)):r.tabs=o,r.loading=!1;const t=r.detail.method;t&&"string"==typeof t?r.currentMethod=t:t&&"object"==typeof t&&t.length&&(r.currentMethod=t[0])})).catch((e=>{r.loading=!1,handleApidocHttpError(e).then((t=>{!1===t&&(r.error=e)}))}))})(),(e,t)=>{const i=__unplugin_components_0$1,o=SelectOption,d=__unplugin_components_2$2,c=__unplugin_components_3$1,h=Tabs;return openBlock(),createElementBlock("div",_hoisted_1,[r.loading?(openBlock(),createBlock(Skeleton,{key:0})):!r.loading&&(r.error.response&&200!=r.error.response.status||!r.error.response&&r.error.message)?(openBlock(),createBlock(unref(Error$1),{key:1,error:r.error},null,8,["error"])):(openBlock(),createElementBlock("div",_hoisted_2,[createBaseVNode("h1",null,toDisplayString(r.detail.title),1),createVNode(unref(TextGrid),{labelWidth:"auto",class:"mb-sm"},{default:withCtx((()=>[r.detail.author?(openBlock(),createBlock(unref(TextItem),{key:0,title:unref(n)("common.author"),value:r.detail.author},null,8,["title","value"])):createCommentVNode("",!0),r.detail.tag?(openBlock(),createBlock(unref(TextItem),{key:1,title:unref(n)("common.tag")},{default:withCtx((()=>[r.detail.tag&&"string"==typeof r.detail.tag?(openBlock(),createBlock(i,{key:0},{default:withCtx((()=>[createTextVNode(toDisplayString(r.detail.tag),1)])),_:1})):(openBlock(!0),createElementBlock(Fragment,{key:1},renderList(r.detail.tag,((e,t)=>(openBlock(),createBlock(i,{key:t},{default:withCtx((()=>[createTextVNode(toDisplayString(e),1)])),_:2},1024)))),128))])),_:1},8,["title"])):createCommentVNode("",!0)])),_:1}),createBaseVNode("div",_hoisted_3,[r.detail.method&&"string"==typeof r.detail.method?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["api-url-method",r.currentMethod]),style:normalizeStyle({backgroundColor:unref(s)})},toDisplayString(r.detail.method),7)):r.detail.method&&r.detail.method.length>0?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(["api-method-select"]),title:r.currentMethod},[createVNode(d,{value:r.currentMethod,style:{width:"100%"},onChange:l},{default:withCtx((()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.detail.method,(e=>(openBlock(),createBlock(o,{key:e,value:e},{default:withCtx((()=>[createTextVNode(toDisplayString(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])],8,_hoisted_4)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_5,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.detail.url=e),readonly:""},null,512),[[vModelText,r.detail.url]])]),createBaseVNode("div",{class:"api-url-copy",onClick:a},[createVNode(unref(CopyOutlined$1))])]),createBaseVNode("div",_hoisted_6,[createVNode(h,{activeKey:r.activeTab,"onUpdate:activeKey":t[1]||(t[1]=e=>r.activeTab=e)},{default:withCtx((()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.tabs,(e=>(openBlock(),createBlock(c,{key:e},{tab:withCtx((()=>[createBaseVNode("span",null,["table"==e?(openBlock(),createBlock(unref(BookOutlined$1),{key:0})):createCommentVNode("",!0),"json"==e?(openBlock(),createElementBlock("i",_hoisted_7)):createCommentVNode("",!0),"ts"==e?(openBlock(),createElementBlock("i",_hoisted_8)):createCommentVNode("",!0),"debug"==e?(openBlock(),createBlock(unref(BugOutlined$1),{key:3})):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(unref(n)(`apiPage.tabs.${e}`)),1)])])),default:withCtx((()=>["table"==e?(openBlock(),createBlock(_sfc_main$e,{key:0,detail:r.detail},null,8,["detail"])):"json"==e?(openBlock(),createBlock(_sfc_main$c,{key:1,detail:r.detail},null,8,["detail"])):"ts"==e?(openBlock(),createBlock(_sfc_main$b,{key:2,detail:r.detail},null,8,["detail"])):"debug"==e?(openBlock(),createBlock(DebugTab,{key:3,detail:r.detail,currentMethod:r.currentMethod},null,8,["detail","currentMethod"])):createCommentVNode("",!0)])),_:2},1024)))),128))])),_:1},8,["activeKey"])])]))])}}}));var index=_export_sfc(_sfc_main,[["__scopeId","data-v-2b3e125f"]]),index$1=Object.freeze(Object.defineProperty({__proto__:null,default:index},Symbol.toStringTag,{value:"Module"}));export{index$1 as i,monaco_editor_core_star as m,typescriptDefaults as t};
